## Part I Introduction to Networking
Часть I Введение в сеть   
## Chapter 1 Introduction to TCP/IP Networking
Глава 1 Введение в сеть TCP / IP   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.3 Compare physical interface and cabling types
1.3 Сравните физический интерфейс и типы кабелей   
###### 1.3.a Single-mode fiber, multimode fiber, copper
1.3.a Одномодовое волокно, многомодовое волокно, медь   
###### 1.3.b Connections (Ethernet shared media and point-to-point)
1.3.b Подключения (общая среда Ethernet и точка-точка)   
__|__
--|--
|
Welcome to the first chapter in your study for CCNA! This chapter begins Part I, which focuses on the basics of networking.|Добро пожаловать в первую главу вашего исследования CCNA! Эта глава начинается с части I, в которой основное внимание уделяется основам работы в сети.
|
Networks work correctly because the various devices and software follow the rules.|Сети работают правильно, потому что различные устройства и программное обеспечение подчиняются правилам.
Those rules come in the form of standards and protocols, which are agreements of a particular part of how a network should work.|Эти правила представлены в форме стандартов и протоколов, которые являются соглашениями о том, как должна работать сеть.
However, the sheer number of standards and protocols available can make it difficult for the average network engineer to think about and work with networks—so the world of networking has used several networking models over time.|Однако из-за огромного количества доступных стандартов и протоколов среднему сетевому инженеру сложно думать о сетях и работать с ними, поэтому в мире сетевых технологий с течением времени использовалось несколько сетевых моделей.
|
Networking models define a structure and different categories (layers) of standards and protocols.|Сетевые модели определяют структуру и различные категории (уровни) стандартов и протоколов.
|
As new standards and protocols emerge over time, networkers can think of those new details in the context of a working model.|По мере появления новых стандартов и протоколов сетевики могут рассматривать эти новые детали в контексте работающей модели.
|
You can think of a networking model as you think of a set of architectural plans for building a house.|Вы можете думать о сетевой модели, как о наборе архитектурных планов для строительства дома.
A lot of different people work on building your house, such as framers, electricians, bricklayers, painters, and so on.|Над строительством вашего дома работает множество разных людей, например, строители, электрики, каменщики, маляры и так далее.
The blueprint helps ensure that all the different pieces of the house work together as a whole.|План помогает гарантировать, что все различные части дома работают вместе как единое целое.
Similarly, the people who make networking products, and the people who use those products to build their own computer networks, follow a particular networking model.|Точно так же люди, которые создают сетевые продукты, и люди, которые используют эти продукты для построения своих собственных компьютерных сетей, следуют определенной сетевой модели.
That networking model defines rules about how each part of the network should work, as well as how the parts should work together so that the entire network functions correctly.|Эта сетевая модель определяет правила о том, как должна работать каждая часть сети, а также о том, как части должны работать вместе, чтобы вся сеть функционировала правильно.
|
Today, TCP/IP rules as the most pervasive networking model in use.|Сегодня правила TCP / IP являются наиболее распространенной сетевой моделью.
You can find support for TCP/IP on practically every computer operating system (OS) in existence today, from mobile phones to mainframe computers.|Вы можете найти поддержку TCP / IP практически во всех компьютерных операционных системах (ОС), существующих сегодня, от мобильных телефонов до мэйнфреймов.
Every network built using Cisco products today supports TCP/IP. And not surprisingly, the CCNA exam focuses heavily on TCP/IP. This chapter uses TCP/IP for one of its main purposes: to present various concepts about networking using the context of the different roles and functions in the TCP/IP model.|Каждая сеть, построенная с использованием продуктов Cisco, сегодня поддерживает TCP / IP. И неудивительно, что экзамен CCNA уделяет большое внимание TCP / IP. В этой главе TCP / IP используется для одной из основных целей: представить различные концепции сети с использованием контекста различных ролей и функций в модели TCP / IP.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
CHAPTER 1 Table 1-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|ГЛАВА 1 Таблица 1-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### Perspectives on Networking
Перспективы сетевых технологий   
### TCP/IP Networking Model
Модель сети TCP / IP   
__|__
--|--
|
Data Encapsulation Terminology 5–7 1.|Терминология инкапсуляции данных 5–7 1.
Which of the following protocols are examples of TCP/IP transport layer protocols?|Какие из следующих протоколов являются примерами протоколов транспортного уровня TCP / IP?
|
(Choose two answers.)|(Выберите два ответа.)
|
a. Ethernet b.|а. Ethernet б.
HTTP c.|HTTP c.
IP d.|IP d.
UDP e.|UDP e.
SMTP f.|SMTP f.
TCP 2.|TCP 2.
Which of the following protocols are examples of TCP/IP data-link layer protocols?|Какие из следующих протоколов являются примерами протоколов уровня канала передачи данных TCP / IP?
|
(Choose two answers.)|(Выберите два ответа.)
|
a. Ethernet b.|а. Ethernet б.
HTTP c.|HTTP c.
IP d.|IP d.
UDP e.|UDP e.
SMTP f.|SMTP f.
TCP g.|TCP g.
PPP 3.|ГЧП 3.
The process of HTTP asking TCP to send some data and making sure that it is received correctly is an example of what?|Примером чего является процесс HTTP-запроса TCP на отправку некоторых данных и проверки их правильности?
|
a. Same-layer interaction b.|а. Взаимодействие на одном уровне b.
Adjacent-layer interaction c.|Взаимодействие прилегающих слоев c.
OSI model d.|Модель OSI d.
All of these answers are correct.|Все эти ответы верны.
|
4. The process of TCP on one computer marking a TCP segment as segment 1, and the receiving computer then acknowledging the receipt of TCP segment 1 is an example of what?|4. Примером чего является процесс TCP на одном компьютере, помечающий сегмент TCP как сегмент 1, а принимающий компьютер затем подтверждает получение сегмента 1 TCP?
|
a. Data encapsulation b.|а. Инкапсуляция данных b.
Same-layer interaction c.|Взаимодействие на одном уровне c.
Adjacent-layer interaction d.|Взаимодействие соседних слоев d.
OSI model e.|Модель OSI e.
All of these answers are correct.|Все эти ответы верны.
|
5. The process of a web server adding a TCP header to the contents of a web page, followed by adding an IP header and then adding a data-link header and trailer, is an example of what?|5. Примером чего является процесс добавления веб-сервером заголовка TCP к содержимому веб-страницы с последующим добавлением заголовка IP и последующим добавлением заголовка и концевика ссылки на данные?
|
a. Data encapsulation b.|а. Инкапсуляция данных b.
Same-layer interaction c.|Взаимодействие на одном уровне c.
OSI model d.|Модель OSI d.
All of these answers are correct.|Все эти ответы верны.
|
6. Which of the following terms is used specifically to identify the entity created when encapsulating data inside data-link layer headers and trailers?|6. Какой из следующих терминов используется специально для обозначения объекта, созданного при инкапсуляции данных внутри заголовков и трейлеров канального уровня?
|
a. Data b.|а. Данные b.
Chunk c.|Чанк c.
Segment d.|Сегмент d.
Frame e.|Рамка e.
Packet 7.|Пакет 7.
Which OSI encapsulation term can be used instead of the term frame?|Какой термин инкапсуляции OSI можно использовать вместо термина фрейм?
|
a. Layer 1 PDU b.|а. PDU уровня 1 b.
Layer 2 PDU c.|PDU уровня 2 c.
Layer 3 PDU d.|PDU уровня 3 d.
Layer 5 PDU e.|PDU уровня 5 e.
Layer 7 PDU Foundation Topics Perspectives on Networking So, you are new to networking.|Основные темы PDU уровня 7 Перспективы сетевых технологий Итак, вы новичок в сетевых технологиях.
Like many people, your perspective about networks might be that of a user of the network, as opposed to the network engineer who builds networks.|Как и у многих людей, ваше видение сетей может быть взглядом пользователя сети, а не сетевого инженера, который строит сети.
|
For some, your view of networking might be based on how you use the Internet, from home, using a high-speed Internet connection like digital subscriber line (DSL) or cable TV, as shown in Figure 1-1.|Для некоторых ваше представление о сети может быть основано на том, как вы используете Интернет из дома, используя высокоскоростное Интернет-соединение, такое как цифровая абонентская линия (DSL) или кабельное телевидение, как показано на рисунке 1-1.
|
Figure 1-1 End-User Perspective on High-Speed Internet Connections 1 The top part of the figure shows a typical high-speed cable Internet user.|Рисунок 1-1. Взгляд конечного пользователя на высокоскоростное подключение к Интернету 1 В верхней части рисунка показан типичный пользователь высокоскоростного кабельного Интернета.
The PC connects to a cable modem using an Ethernet cable.|ПК подключается к кабельному модему с помощью кабеля Ethernet.
The cable modem then connects to a cable TV (CATV) outlet in the wall using a round coaxial cable—the same kind of cable used to connect your TV to the CATV wall outlet.|Затем кабельный модем подключается к розетке кабельного телевидения (CATV) в стене с помощью круглого коаксиального кабеля - того же типа кабеля, который используется для подключения вашего телевизора к розетке CATV.
Because cable Internet services provide service continuously, the user can just sit down at the PC and start sending email, browsing websites, making Internet phone calls, and using other tools and applications.|Поскольку услуги кабельного Интернета предоставляют услуги непрерывно, пользователь может просто сесть за компьютер и начать отправлять электронную почту, просматривать веб-сайты, совершать телефонные звонки в Интернете и использовать другие инструменты и приложения.
|
The lower part of the figure uses two different technologies.|В нижней части рисунка используются две разные технологии.
First, the tablet computer uses wireless technology that goes by the name wireless local-area network (wireless LAN), or Wi-Fi, instead of using an Ethernet cable.|Во-первых, планшетный компьютер использует беспроводную технологию, известную как беспроводная локальная сеть (беспроводная локальная сеть) или Wi-Fi, вместо использования кабеля Ethernet.
In this example, the router uses a different technology, DSL, to communicate with the Internet.|В этом примере маршрутизатор использует другую технологию, DSL, для связи с Интернетом.
|
Both home-based networks and networks built for use by a company make use of similar networking technologies.|И домашние сети, и сети, созданные для использования компанией, используют аналогичные сетевые технологии.
The Information Technology (IT) world refers to a network created by one corporation, or enterprise, for the purpose of allowing its employees to communicate, as an enterprise network.|Под миром информационных технологий (ИТ) понимается сеть, созданная одной корпорацией или предприятием с целью позволить своим сотрудникам общаться, как корпоративная сеть.
The smaller networks at home, when used for business purposes, often go by the name small office/home office (SOHO) networks.|Домашние сети меньшего размера, когда они используются для деловых целей, часто называются сетями малого офиса / домашнего офиса (SOHO).
|
Users of enterprise networks have some idea about the enterprise network at their company or school.|Пользователи корпоративных сетей имеют некоторое представление о корпоративной сети в своей компании или школе.
People realize that they use a network for many tasks.|Люди понимают, что они используют сеть для множества задач.
PC users might realize that their PC connects through an Ethernet cable to a matching wall outlet, as shown at the top of Figure 1-2.|Пользователи ПК могут понять, что их ПК подключается через кабель Ethernet к соответствующей розетке, как показано в верхней части рисунка 1-2.
Those same users might use wireless LANs with their laptop when going to a meeting in the conference room as well.|Те же пользователи могут использовать беспроводные локальные сети со своим ноутбуком, когда собираются на встречу в конференц-зале.
Figure 1-2 shows these two end-user perspectives on an enterprise network.|На рис. 1-2 показаны эти две точки зрения конечного пользователя в корпоративной сети.
|
Figure 1-2 Example Representation of an Enterprise Network NOTE In networking diagrams, a cloud represents a part of a network whose details are not important to the purpose of the diagram.|Рисунок 1-2 Пример представления корпоративной сети ПРИМЕЧАНИЕ На сетевых диаграммах облако представляет собой часть сети, детали которой не важны для цели диаграммы.
In this case, Figure 1-2 ignores the details of how to create an enterprise network.|В этом случае на рис. 1-2 игнорируются детали того, как создать корпоративную сеть.
|
Some users might not even have a concept of the network at all.|Некоторые пользователи могут вообще не иметь представления о сети.
Instead, these users just enjoy the functions of the network—the ability to post messages to social media sites, make phone calls, search for information on the Internet, listen to music, and download countless apps to their phones—without caring about how it works or how their favorite device connects to the network.|Вместо этого эти пользователи просто наслаждаются функциями сети - возможностью публиковать сообщения в социальных сетях, совершать телефонные звонки, искать информацию в Интернете, слушать музыку и загружать бесчисленные приложения на свои телефоны - не заботясь о том, как это работает или как их любимое устройство подключается к сети.
|
Regardless of how much you already know about how networks work, this book and the related certification help you learn how networks do their job.|Независимо от того, сколько вы уже знаете о том, как работают сети, эта книга и соответствующий сертификат помогут вам узнать, как сети выполняют свою работу.
That job is simply this:|Эта работа проста:
|
moving data from one device to another.|перенос данных с одного устройства на другое.
The rest of this chapter, and the rest of this first part of the book, reveals the basics of how to build enterprise networks so that they can deliver data between two devices.|Остальная часть этой главы и оставшаяся часть этой первой части книги раскрывают основы построения корпоративных сетей, позволяющих передавать данные между двумя устройствами.
|
TCP/IP Networking Model A networking model, sometimes also called either a networking architecture or networking blueprint, refers to a comprehensive set of documents.|Сетевая модель TCP / IP Сетевая модель, иногда также называемая сетевой архитектурой или сетевым планом, относится к исчерпывающему набору документов.
Individually, each document describes one small function required for a network; collectively, these documents define everything that should happen for a computer network to work.|По отдельности каждый документ описывает одну небольшую функцию, необходимую для сети; В совокупности эти документы определяют все, что должно происходить для работы компьютерной сети.
Some documents define a protocol, which is a set of logical rules that devices must follow to communicate.|Некоторые документы определяют протокол, который представляет собой набор логических правил, которым устройства должны следовать для связи.
Other documents define some physical requirements for networking.|В других документах определены некоторые физические требования к сети.
For example, a document could define the voltage and current levels used on a particular cable when transmitting data.|Например, документ может определять уровни напряжения и тока, используемые на конкретном кабеле при передаче данных.
|
You can think of a networking model as you think of an architectural blueprint for building a house.|Вы можете думать о сетевой модели, как об архитектурном проекте для строительства дома.
Sure, you can build a house without the blueprint.|Конечно, вы можете построить дом без чертежа.
However, the blueprint can ensure that the house has the right foundation and structure so that it will not fall down, and it has the correct hidden spaces to accommodate the plumbing, electrical, gas, and so on.|Тем не менее, план может гарантировать, что дом имеет правильный фундамент и структуру, чтобы он не упал, и в нем есть правильные скрытые пространства для размещения водопровода, электричества, газа и т. Д.
Also, the many different people that build the house using the blueprint—such as framers, electricians, bricklayers, painters, and so on—know that if they follow the blueprint, their part of the work should not cause problems for the other workers.|Кроме того, множество разных людей, которые строят дом по чертежу - например, строители, электрики, каменщики, маляры и т. Д. - знают, что, если они следуют плану, их часть работы не должна создавать проблем для других рабочих.
|
Similarly, you could build your own network—write your own software, build your own networking cards, and so on—to create a network.|Точно так же вы можете построить свою собственную сеть - написать собственное программное обеспечение, построить свои собственные сетевые карты и так далее - чтобы создать сеть.
However, it is much easier to simply buy and use products that already conform to some well-known networking model or blueprint.|Однако гораздо проще просто купить и использовать продукты, которые уже соответствуют какой-либо известной сетевой модели или плану.
|
Because the networking product vendors build their products with some networking model in mind, their products should work well together.|Поскольку поставщики сетевых продуктов создают свои продукты с учетом определенной сетевой модели, их продукты должны хорошо работать вместе.
#### History Leading to TCP/IP
История, ведущая к TCP / IP   
__|__
--|--
|
Today, the world of computer networking uses one networking model: TCP/IP. However, the world has not always been so simple.|Сегодня в мире компьютерных сетей используется одна сетевая модель: TCP / IP. Однако мир не всегда был таким простым.
Once upon a time, networking protocols didn’t exist, including TCP/IP. Vendors created the first networking protocols; these protocols supported only that vendor’s computers.|Когда-то не существовало сетевых протоколов, включая TCP / IP. Производители создали первые сетевые протоколы; эти протоколы поддерживают только компьютеры этого производителя.
|
For example, IBM, the computer company with the largest market share in many markets back in the 1970s and 1980s, published its Systems Network Architecture (SNA) networking model in 1974.|Например, IBM, компьютерная компания с самой большой долей рынка на многих рынках в 1970-х и 1980-х годах, опубликовала свою сетевую модель системной сетевой архитектуры (SNA) в 1974 году.
Other vendors also created their own proprietary networking models.|Другие производители также создали свои собственные сетевые модели.
As a result, if your company bought computers from three vendors, network engineers often had to create three different networks based on the networking models created by each company, and then somehow connect those networks, making the combined networks much more complex.|В результате, если ваша компания покупала компьютеры у трех поставщиков, сетевым инженерам часто приходилось создавать три разные сети на основе сетевых моделей, созданных каждой компанией, а затем каким-то образом соединять эти сети, что значительно усложняло объединенные сети.
The left side of Figure 1-3 shows the general idea of what a company’s enterprise network might have looked like back in the 1980s, before TCP/IP became common in enterprise internetworks.|В левой части рисунка 1-3 показано общее представление о том, как могла бы выглядеть корпоративная сеть компании в 1980-х годах, до того, как TCP / IP стал обычным явлением в корпоративных объединенных сетях.
|
Answers to the “Do I Know This Already?” quiz:|Ответы на вопрос «Знаю ли я это уже?» викторина:
|
1 D and F 2 A and G 3 B 4 B 5 A 6 D 7 B.|1 D и F 2 A и G 3 B 4 B 5 A 6 D 7 B.
|
Figure 1-3 Historical Progression: Proprietary Models to the Open TCP/IP Model Although vendor-defined proprietary networking models often worked well, having an open, vendor-neutral networking model would aid competition and reduce complexity.|Рисунок 1-3 Историческое развитие: проприетарные модели к открытой модели TCP / IP Хотя проприетарные сетевые модели, определяемые поставщиком, часто работают хорошо, наличие открытой сетевой модели, не зависящей от поставщика, может способствовать конкуренции и снизить сложность.
|
The International Organization for Standardization (ISO) took on the task to create such a model, starting as early as the late 1970s, beginning work on what would become known as the Open Systems Interconnection (OSI) networking model.|Международная организация по стандартизации (ISO) взяла на себя задачу создать такую ​​модель, начиная с конца 1970-х годов, начав работу над тем, что впоследствии стало известно как сетевая модель взаимодействия открытых систем (OSI).
ISO had a noble goal for the OSI model: to standardize data networking protocols to allow communication among all computers across the entire planet.|ИСО поставила перед моделью OSI благородную цель: стандартизировать сетевые протоколы передачи данных, чтобы обеспечить связь между всеми компьютерами по всей планете.
ISO worked toward this ambitious and noble goal, with participants from most of the technologically developed nations on Earth participating in the process.|ISO работала над достижением этой амбициозной и благородной цели, в этом процессе участвовали участники из большинства технологически развитых стран Земли.
|
A second, less-formal effort to create an open, vendor-neutral, public networking model sprouted forth from a U.S.|Вторая, менее формальная попытка создать открытую, нейтральную по отношению к поставщикам модель общедоступных сетей возникла в США.
Department of Defense (DoD) contract.|Контракт Министерства обороны (DoD).
Researchers at various universities volunteered to help further develop the protocols surrounding the original DoD work.|Исследователи из различных университетов вызвались помочь в дальнейшей разработке протоколов, относящихся к исходной работе Министерства обороны США.
These efforts resulted in a competing open networking model called TCP/IP.|Эти усилия привели к созданию конкурирующей открытой сетевой модели под названием TCP / IP.
|
During the 1990s, companies began adding OSI, TCP/IP, or both to their enterprise networks.|В течение 1990-х годов компании начали добавлять OSI, TCP / IP или и то, и другое в свои корпоративные сети.
|
However, by the end of the 1990s, TCP/IP had become the common choice, and OSI fell away.|Однако к концу 1990-х TCP / IP стал обычным выбором, и OSI отпала.
The center part of Figure 1-3 shows the general idea behind enterprise networks in that decade—still with networks built upon multiple networking models but including TCP/IP.|Центральная часть рисунка 1-3 показывает общую идею корпоративных сетей того десятилетия - сети, построенные на нескольких сетевых моделях, но включающие TCP / IP.
|
Here in the twenty-first century, TCP/IP dominates.|Здесь, в двадцать первом веке, доминирует TCP / IP.
Proprietary networking models still exist, but they have mostly been discarded in favor of TCP/IP. The OSI model, whose development suffered in part because of a slower formal standardization process as compared with TCP/IP, never succeeded in the marketplace.|Проприетарные сетевые модели все еще существуют, но в основном от них отказались в пользу TCP / IP. Модель OSI, развитие которой частично пострадало из-за более медленного формального процесса стандартизации по сравнению с TCP / IP, так и не добилось успеха на рынке.
And TCP/IP, the networking model originally created almost entirely by a bunch of volunteers, has become the most prolific network model ever, as shown on the right side of Figure 1-3.|И TCP / IP, сетевая модель, изначально созданная почти целиком группой добровольцев, стала самой плодотворной сетевой моделью за всю историю, как показано на правой стороне рисунка 1-3.
|
In this chapter, you will read about some of the basics of TCP/IP. Although you will learn some interesting facts about TCP/IP, the true goal of this chapter is to help you understand what a networking model or networking architecture really is and how it works.|В этой главе вы прочитаете о некоторых основах TCP / IP. Хотя вы узнаете некоторые интересные факты о TCP / IP, истинная цель этой главы - помочь вам понять, что на самом деле представляет собой сетевая модель или сетевая архитектура и как она работает.
|
Also in this chapter, you will learn about some of the jargon used with OSI. Will any of you ever work on a computer that is using the full OSI protocols instead of TCP/IP? Probably not.|Также в этой главе вы узнаете о некоторых жаргонах, используемых в OSI. Будет ли кто-нибудь из вас когда-нибудь работать на компьютере, который использует полные протоколы OSI вместо TCP / IP? Возможно нет.
However, you will often use terms relating to OSI.|Однако вы часто будете использовать термины, относящиеся к OSI.
#### Overview of the TCP/IP Networking Model
Обзор сетевой модели TCP / IP   
__|__
--|--
|
The TCP/IP model both defines and references a large collection of protocols that allow computers to communicate.|Модель TCP / IP определяет и ссылается на большой набор протоколов, позволяющих компьютерам обмениваться данными.
To define a protocol, TCP/IP uses documents called Requests For Comments (RFC). (You can find these RFCs using any online search engine.) The TCP/IP model also avoids repeating work already done by some other standards body or vendor consortium by simply referring to standards or protocols created by those groups.|Для определения протокола TCP / IP использует документы, называемые запросами на комментарии (RFC). (Вы можете найти эти RFC с помощью любой поисковой системы в Интернете.) Модель TCP / IP также позволяет избежать повторения работы, уже проделанной другим органом по стандартизации или консорциумом поставщиков, просто ссылаясь на стандарты или протоколы, созданные этими группами.
For example, the Institute of Electrical and Electronic Engineers (IEEE) defines Ethernet LANs; the TCP/IP model does not define Ethernet in RFCs, but refers to IEEE Ethernet as an option.|Например, Институт инженеров по электротехнике и электронике (IEEE) определяет локальные сети Ethernet; модель TCP / IP не определяет Ethernet в RFC, но в качестве опции ссылается на IEEE Ethernet.
|
The TCP/IP model creates a set of rules that allows us all to take a computer (or mobile device) out of the box, plug in all the right cables, turn it on, and connect to and use the network.|Модель TCP / IP создает набор правил, который позволяет всем нам вынуть компьютер (или мобильное устройство) из коробки, подключить все нужные кабели, включить его, подключиться к сети и использовать ее.
You can use a web browser to connect to your favorite website, use most any app, and it all works.|Вы можете использовать веб-браузер для подключения к любимому веб-сайту, использовать практически любое приложение, и все это работает.
How?|Как?
Well, the OS on the computer implements parts of the TCP/IP model.|Что ж, ОС на компьютере реализует части модели TCP / IP.
|
The Ethernet card, or wireless LAN card, built in to the computer implements some LAN standards referenced by the TCP/IP model.|Карта Ethernet или карта беспроводной локальной сети, встроенная в компьютер, реализует некоторые стандарты локальной сети, на которые ссылается модель TCP / IP.
In short, the vendors that created the hardware and software implemented TCP/IP.|Короче говоря, поставщики, создавшие аппаратное и программное обеспечение, реализовали TCP / IP.
|
To help people understand a networking model, each model breaks the functions into a small number of categories called layers.|Чтобы помочь людям понять сетевую модель, каждая модель разбивает функции на небольшое количество категорий, называемых уровнями.
Each layer includes protocols and standards that relate to that category of functions, as shown in Figure 1-4.|Каждый уровень включает протоколы и стандарты, относящиеся к этой категории функций, как показано на рисунке 1-4.
|
Figure 1-4 The TCP/IP Networking Models The TCP/IP model shows the more common terms and layers used when people talk about TCP/IP today.|Рисунок 1-4. Сетевые модели TCP / IP Модель TCP / IP показывает наиболее общие термины и уровни, которые сегодня используются, когда люди говорят о TCP / IP.
The bottom layer focuses on how to transmit bits over each individual link.|Нижний уровень фокусируется на том, как передавать биты по каждому отдельному каналу.
|
The data-link layer focuses on sending data over one type of physical link: for instance, networks use different data-link protocols for Ethernet LANs versus wireless LANs. The network layer focuses on delivering data over the entire path from the original sending computer to the final destination computer.|Уровень канала передачи данных ориентирован на отправку данных по одному типу физического канала: например, сети используют разные протоколы канала передачи данных для локальных сетей Ethernet по сравнению с беспроводными локальными сетями. Сетевой уровень ориентирован на доставку данных по всему пути от исходного компьютера-отправителя до конечного компьютера-получателя.
And the top two layers focus more on the applications that need to send and receive data.|И два верхних уровня больше ориентированы на приложения, которым необходимо отправлять и получать данные.
|
NOTE A slightly different four-layer original version of the TCP/IP model exists in RFC 1122, but for the purposes of both real networking and for today’s CCNA, use the five-layer model shown here in Figure 1-4.|ПРИМЕЧАНИЕ. Немного отличная четырехуровневая исходная версия модели TCP / IP существует в RFC 1122, но как для реальных сетей, так и для сегодняшней CCNA, используйте пятиуровневую модель, показанную здесь на рисунке 1-4.
|
Many of you will have already heard of several TCP/IP protocols, like the examples listed in Table 1-2.|Многие из вас уже слышали о нескольких протоколах TCP / IP, например о примерах, перечисленных в Таблице 1-2.
Most of the protocols and standards in this table will be explained in more detail as you work through this book.|Большинство протоколов и стандартов в этой таблице будут объяснены более подробно по мере работы с этой книгой.
Following the table, this section takes a closer look at the layers of the TCP/IP model.|Следуя таблице, в этом разделе более подробно рассматриваются уровни модели TCP / IP.
|
1 Table 1-2 TCP/IP Architectural Model and Example Protocols Table end.|1 Таблица 1-2 Архитектурная модель TCP / IP и примеры протоколов Окончание таблицы.
#### TCP/IP Application Layer
Уровень приложений TCP / IP   
__|__
--|--
|
TCP/IP application layer protocols provide services to the application software running on a computer.|Протоколы прикладного уровня TCP / IP предоставляют услуги прикладному программному обеспечению, работающему на компьютере.
The application layer does not define the application itself, but it defines services that applications need.|Уровень приложения не определяет само приложение, но определяет службы, которые необходимы приложениям.
For example, application protocol HTTP defines how web browsers can pull the contents of a web page from a web server.|Например, протокол приложения HTTP определяет, как веб-браузеры могут извлекать содержимое веб-страницы с веб-сервера.
In short, the application layer provides an interface between software running on a computer and the network itself.|Короче говоря, уровень приложений обеспечивает интерфейс между программным обеспечением, работающим на компьютере, и самой сетью.
|
Arguably, the most popular TCP/IP application today is the web browser.|Пожалуй, самым популярным приложением TCP / IP сегодня является веб-браузер.
Many major software vendors either have already changed or are changing their application software to support access from a web browser.|Многие крупные поставщики программного обеспечения либо уже изменили, либо меняют свое прикладное программное обеспечение для поддержки доступа через веб-браузер.
And thankfully, using a web browser is easy: You start a web browser on your computer and select a website by typing the name of the website, and the web page appears.|И, к счастью, использовать веб-браузер очень просто: вы запускаете веб-браузер на своем компьютере и выбираете веб-сайт, вводя имя веб-сайта, и появляется веб-страница.
##### HTTP Overview
Обзор HTTP   
__|__
--|--
|
What really happens to allow that web page to appear on your web browser?|Что на самом деле происходит, чтобы эта веб-страница отображалась в вашем браузере?
|
Imagine that Bob opens his browser.|Представьте, что Боб открывает свой браузер.
His browser has been configured to automatically ask for web server Larry’s default web page, or home page.|Его браузер был настроен так, чтобы автоматически запрашивать веб-страницу Ларри по умолчанию или домашнюю страницу.
The general logic looks like Figure 1-5.|Общая логика выглядит как рисунок 1-5.
|
Figure 1-5 Basic Application Logic to Get a Web Page So, what really happened?|Рис. 1-5 Базовая логика приложения для получения веб-страницы Итак, что же произошло на самом деле?
Bob’s initial request actually asks Larry to send his home page back to Bob.|Первоначальный запрос Боба на самом деле просит Ларри отправить его домашнюю страницу обратно Бобу.
Larry’s web server software has been configured to know that the default web page is contained in a file called home.htm.|Программное обеспечение веб-сервера Ларри настроено так, чтобы знать, что веб-страница по умолчанию содержится в файле с именем home.htm.
Bob receives the file from Larry and displays the contents of the file in Bob’s web browser window.|Боб получает файл от Ларри и отображает содержимое файла в окне веб-браузера Боба.
##### HTTP Protocol Mechanisms
Механизмы протокола HTTP   
__|__
--|--
|
Taking a closer look, this example shows how applications on each endpoint computer—specifically, the web browser application and web server application—use a TCP/IP application layer protocol.|При более внимательном рассмотрении этот пример показывает, как приложения на каждом конечном компьютере - в частности, приложение веб-браузера и приложение веб-сервера - используют протокол уровня приложений TCP / IP.
To make the request for a web page and return the contents of the web page, the applications use the Hypertext Transfer Protocol (HTTP).|Чтобы сделать запрос на веб-страницу и вернуть ее содержимое, приложения используют протокол передачи гипертекста (HTTP).
|
HTTP did not exist until Tim Berners-Lee created the first web browser and web server in the early 1990s.|HTTP не существовал до тех пор, пока Тим Бернерс-Ли не создал первый веб-браузер и веб-сервер в начале 1990-х годов.
Berners-Lee gave HTTP functionality to ask for the contents of web pages, specifically by giving the web browser the ability to request files from the server and giving the server a way to return the content of those files.|Бернерс-Ли предоставил функцию HTTP для запроса содержимого веб-страниц, в частности, предоставив веб-браузеру возможность запрашивать файлы с сервера и предоставив серверу возможность возвращать содержимое этих файлов.
The overall logic matches what was shown in Figure 1-5; Figure 1-6 shows the same idea, but with details specific to HTTP.|Общая логика соответствует тому, что показано на рис. 1-5; На рис. 1-6 показана та же идея, но с подробностями, относящимися к HTTP.
|
NOTE The full version of most web addresses—also called Uniform Resource Locators (URL) or Universal Resource Identifiers (URI)—begins with the letters http, which means that HTTP is used to transfer the web pages.|ПРИМЕЧАНИЕ. Полная версия большинства веб-адресов, также называемых унифицированными указателями ресурсов (URL) или универсальными идентификаторами ресурсов (URI), начинается с букв http, что означает, что HTTP используется для передачи веб-страниц.
|
Figure 1-6 HTTP GET Request, HTTP Reply, and One Data-Only Message To get the web page from Larry, at Step 1, Bob sends a message with an HTTP header.|Рисунок 1-6. HTTP-запрос GET, HTTP-ответ и одно сообщение только с данными. Чтобы получить веб-страницу от Ларри, на шаге 1 Боб отправляет сообщение с HTTP-заголовком.
|
Generally, protocols use headers as a place to put information used by that protocol.|Обычно протоколы используют заголовки как место для размещения информации, используемой этим протоколом.
This HTTP header includes the request to “get” a file.|Этот HTTP-заголовок включает запрос на «получение» файла.
The request typically contains the name of the file (home.htm, in this case), or if no filename is mentioned, the web server assumes that Bob wants the default web page.|Запрос обычно содержит имя файла (в данном случае home.htm) или, если имя файла не упоминается, веб-сервер предполагает, что Бобу нужна веб-страница по умолчанию.
|
Step 2 in Figure 1-6 shows the response from web server Larry.|Шаг 2 на рис. 1-6 показывает ответ веб-сервера Ларри.
The message begins with an HTTP header, with a return code (200), which means something as simple as “OK” returned in the header.|Сообщение начинается с HTTP-заголовка с кодом возврата (200), что означает что-то очень простое, например «ОК», возвращаемое в заголовке.
HTTP also defines other return codes so that the server can tell the browser whether the request worked. (Here is another example: If you ever looked for a web page that was not found, and then received an HTTP 404 “not found” error, you received an HTTP return code of 404.) The second message also includes the first part of the requested file.|HTTP также определяет другие коды возврата, чтобы сервер мог сообщить браузеру, сработал ли запрос. (Вот еще один пример: если вы когда-либо искали веб-страницу, которая не была найдена, а затем получили ошибку HTTP 404 «не найден», вы получили код возврата HTTP 404.) Второе сообщение также включает первую часть запрошенный файл.
|
Step 3 in Figure 1-6 shows another message from web server Larry to web browser Bob, but this time without an HTTP header.|Шаг 3 на рис. 1-6 показывает другое сообщение от веб-сервера Ларри веб-браузеру Бобу, но на этот раз без HTTP-заголовка.
HTTP transfers the data by sending multiple messages, each with a part of the file.|HTTP передает данные, отправляя несколько сообщений, каждое с частью файла.
Rather than wasting space by sending repeated HTTP headers that list the same information, these additional messages simply omit the header.|Вместо того, чтобы тратить место на отправку повторяющихся заголовков HTTP, содержащих ту же информацию, эти дополнительные сообщения просто опускают заголовок.
#### TCP/IP Transport Layer
Транспортный уровень TCP / IP   
__|__
--|--
|
Although many TCP/IP application layer protocols exist, the TCP/IP transport layer includes a smaller number of protocols.|Хотя существует множество протоколов прикладного уровня TCP / IP, транспортный уровень TCP / IP включает меньшее количество протоколов.
The two most commonly used transport layer protocols are the Transmission Control Protocol (TCP) and the User Datagram Protocol (UDP).|Два наиболее часто используемых протокола транспортного уровня - это протокол управления передачей (TCP) и протокол пользовательских дейтаграмм (UDP).
|
Transport layer protocols provide services to the application layer protocols that reside one layer higher in the TCP/IP model.|Протоколы транспортного уровня предоставляют услуги протоколам прикладного уровня, которые находятся на один уровень выше в модели TCP / IP.
How does a transport layer protocol provide a service to a higher-layer protocol?|Как протокол транспортного уровня предоставляет услуги протоколу более высокого уровня?
This section introduces that general concept by focusing on a single 2, includes a chapter, “Introduction to TCP/IP Transport and Applications,” which examines the transport layer.|Этот раздел вводит эту общую концепцию, сосредоточив внимание на одном 2, включает главу «Введение в транспорт и приложения TCP / IP», в которой исследуется транспортный уровень.
|
1|1
##### TCP Error Recovery Basics
Основы восстановления после ошибок TCP   
__|__
--|--
|
To appreciate what the transport layer protocols do, you must think about the layer above the transport layer, the application layer.|Чтобы понять, что делают протоколы транспортного уровня, вы должны подумать об уровне выше транспортного уровня, о прикладном уровне.
Why?|Зачем?
Well, each layer provides a service to the layer above it, like the error-recovery service provided to application layer protocols by TCP.|Что ж, каждый уровень предоставляет услугу вышестоящему уровню, подобно сервису исправления ошибок, предоставляемому протоколам прикладного уровня TCP.
|
For example, in Figure 1-5, Bob and Larry used HTTP to transfer the home page from web server Larry to Bob’s web browser.|Например, на рис. 1-5 Боб и Ларри использовали HTTP для передачи домашней страницы с веб-сервера Ларри в веб-браузер Боба.
But what would have happened if Bob’s HTTP GET request had been lost in transit through the TCP/IP network?|Но что бы произошло, если бы HTTP-запрос Боба GET был потерян при передаче через сеть TCP / IP?
Or, what would have happened if Larry’s response, which included the contents of the home page, had been lost?|Или что бы произошло, если бы ответ Ларри, который включал содержание домашней страницы, был утерян?
Well, as you might expect, in either case, the page would not have shown up in Bob’s browser.|Что ж, как и следовало ожидать, в любом случае страница не отобразилась бы в браузере Боба.
|
TCP/IP needs a mechanism to guarantee delivery of data across a network.|TCP / IP нуждается в механизме, гарантирующем доставку данных по сети.
Because many application layer protocols probably want a way to guarantee delivery of data across a network, the creators of TCP included an error-recovery feature.|Поскольку многим протоколам прикладного уровня, вероятно, нужен способ гарантировать доставку данных по сети, создатели TCP включили функцию восстановления после ошибок.
To recover from errors, TCP uses the concept of acknowledgments.|Для восстановления после ошибок TCP использует концепцию подтверждений.
Figure 1-7 outlines the basic idea behind how TCP notices lost data and asks the sender to try again.|На рис. 1-7 представлена ​​основная идея того, как TCP обнаруживает потерянные данные и просит отправителя повторить попытку.
|
Figure 1-7 TCP Error-Recovery Services as Provided to HTTP Figure 1-7 shows web server Larry sending a web page to web browser Bob, using three separate messages.|Рис. 1-7. Службы восстановления после ошибок TCP, предоставляемые HTTP. На рис. 1-7 показан веб-сервер Ларри, отправляющий веб-страницу веб-браузеру Бобу, используя три отдельных сообщения.
Note that this figure shows the same HTTP headers as Figure 1-6, but it also shows a TCP header.|Обратите внимание, что на этом рисунке показаны те же заголовки HTTP, что и на рисунке 1-6, но также показан заголовок TCP.
The TCP header shows a sequence number (SEQ) with each message.|Заголовок TCP показывает порядковый номер (SEQ) каждого сообщения.
In this example, the network has a problem, and the network fails to deliver the TCP message (called a segment) with sequence number 2.|В этом примере в сети возникла проблема, и сеть не может доставить TCP-сообщение (называемое сегментом) с порядковым номером 2.
When Bob receives messages with sequence numbers 1 and 3, but does not receive a message with sequence number 2, Bob realizes that message 2 was lost.|Когда Боб получает сообщения с порядковыми номерами 1 и 3, но не получает сообщения с порядковыми номерами 2, Боб понимает, что сообщение 2 было потеряно.
That realization by Bob’s TCP logic causes Bob to send a TCP segment back to Larry, asking Larry to send message 2 again.|Эта реализация логикой TCP Боба заставляет Боба отправить сегмент TCP обратно Ларри, прося Ларри снова отправить сообщение 2.
##### Same-Layer and Adjacent-Layer Interactions
Взаимодействие на одном и том же уровне и на смежном уровне   
__|__
--|--
|
Figure 1-7 also demonstrates a function called adjacent-layer interaction, which refers to the concepts of how adjacent layers in a networking model, on the same computer, work together.|На рисунке 1-7 также показана функция, называемая взаимодействием смежных уровней, которая относится к концепциям того, как смежные уровни в сетевой модели на одном компьютере работают вместе.
In this example, the higher-layer protocol (HTTP) wants error recovery, so it uses the next lower-layer protocol (TCP) to perform the service of error recovery; the lower layer provides a service to the layer above it.|В этом примере протокол верхнего уровня (HTTP) требует восстановления после ошибок, поэтому он использует следующий протокол нижнего уровня (TCP) для выполнения услуги восстановления после ошибок; нижний уровень обслуживает более высокий уровень.
|
Figure 1-7 also shows an example of a similar function called same-layer interaction.|На рис. 1-7 также показан пример аналогичной функции, называемой взаимодействием на одном уровне.
|
When a particular layer on one computer wants to communicate with the same layer on another computer, the two computers use headers to hold the information that they want to communicate.|Когда определенный уровень на одном компьютере хочет взаимодействовать с тем же уровнем на другом компьютере, два компьютера используют заголовки для хранения информации, которую они хотят передать.
For example, in Figure 1-7, Larry set the sequence numbers to 1, 2, and 3 so that Bob could notice when some of the data did not arrive.|Например, на рисунке 1-7 Ларри установил порядковые номера на 1, 2 и 3, чтобы Боб мог заметить, когда некоторые данные не поступают.
Larry’s TCP process created that TCP header with the sequence number; Bob’s TCP process received and reacted to the TCP segments.|Процесс TCP Ларри создал этот заголовок TCP с порядковым номером; Процесс TCP Боба получил и отреагировал на сегменты TCP.
|
Table 1-3 summarizes the key points about how adjacent layers work together on a single computer and how one layer on one computer works with the same networking layer on another computer.|В Таблице 1-3 обобщены ключевые моменты того, как смежные уровни работают вместе на одном компьютере и как один уровень на одном компьютере работает с одним и тем же сетевым уровнем на другом компьютере.
|
Table 1-3 Summary: Same-Layer and Adjacent-Layer Interactions Table end.|Таблица 1-3 Сводка: Взаимодействие на одном и том же и прилегающем уровнях Конец таблицы.
#### TCP/IP Network Layer
Сетевой уровень TCP / IP   
__|__
--|--
|
The application layer includes many protocols.|Уровень приложений включает в себя множество протоколов.
The transport layer includes fewer protocols, most notably, TCP and UDP. The TCP/IP network layer includes a small number of protocols, but only one major protocol: the Internet Protocol (IP). In fact, the name TCP/IP is simply the names of the two most common protocols (TCP and IP) separated by a /.|Транспортный уровень включает меньше протоколов, в первую очередь TCP и UDP. Сетевой уровень TCP / IP включает небольшое количество протоколов, но только один основной протокол: Интернет-протокол (IP). Фактически, имя TCP / IP - это просто имена двух наиболее распространенных протоколов (TCP и IP), разделенные знаком /.
|
IP provides several features, most importantly, addressing and routing.|IP предоставляет несколько функций, в первую очередь адресацию и маршрутизацию.
This section begins by comparing IP’s addressing and routing with another commonly known system that uses addressing and routing: the postal service.|Этот раздел начинается со сравнения IP-адресации и маршрутизации с другой широко известной системой, использующей адресацию и маршрутизацию: почтовой службой.
Following that, this section introduces IP addressing and routing. (More details follow in Chapter 3, “Fundamentals of WANs and IP Routing.”)|После этого в этом разделе рассказывается об IP-адресации и маршрутизации. (Более подробная информация представлена ​​в главе 3 «Основы WAN и IP-маршрутизации».)
##### Internet Protocol and the Postal Service
Интернет-протокол и почтовая служба   
__|__
--|--
|
Imagine that you just wrote two letters: one to a friend on the other side of the country and one to a friend on the other side of town.|Представьте, что вы только что написали два письма: одно другу на другом конце страны и одно другу на другом конце города.
You addressed the envelopes and put on the stamps, so both are ready to give to the postal service.|Вы адресовали конверты и ставили марки, так что оба готовы отдать на почту.
Is there much difference in how you treat each letter?|Есть ли разница в том, как вы относитесь к каждой букве?
Not really.|На самом деле, нет.
Typically, you would just put them in the same mailbox and expect the postal service to deliver both letters.|Обычно вы просто кладете их в один почтовый ящик и ожидаете, что почтовая служба доставит оба письма.
|
The postal service, however, must think about each letter separately, and then make a decision of where to send each letter so that it is delivered.|Почтовая служба, однако, должна думать о каждом письме отдельно, а затем принимать решение о том, куда отправить каждое письмо, чтобы оно было доставлено.
For the letter sent across town, the people in the local post office probably just need to put the letter on another truck.|Что касается письма, отправленного через город, людям в местном почтовом отделении, вероятно, нужно просто положить письмо в другой грузовик.
|
For the letter that needs to go across the country, the postal service sends the letter to another post office, then another, and so on, until the letter gets delivered across the country.|Для письма, которое необходимо пересечь страну, почтовая служба отправляет письмо в другое почтовое отделение, затем в другое и так далее, пока письмо не будет доставлено по всей стране.
At each post office, the postal service must process the letter and choose where to send it next.|В каждом почтовом отделении почтовая служба должна обработать письмо и выбрать, куда его отправить дальше.
|
To make it all work, the postal service has regular routes for small trucks, large trucks, planes, boats, and so on, to move letters between postal service sites.|Чтобы все это работало, у почтовой службы есть регулярные маршруты для небольших грузовиков, больших грузовиков, самолетов, лодок и т. Д. Для перемещения писем между сайтами почтовых служб.
The service must be able to receive and forward the letters, and it must make good decisions about where to send each letter next, as shown in Figure 1-8.|Служба должна иметь возможность получать и пересылать письма, и она должна принимать правильные решения о том, куда отправлять каждое письмо в следующий раз, как показано на рисунке 1-8.
|
Figure 1-8 Postal Service Forwarding (Routing) Letters Still thinking about the postal service, consider the difference between the person sending the letter and the work that the postal service does.|Рис. 1-8. Пересылка (маршрутизация) писем почтовой службой. Продолжая думать о почтовой службе, рассмотрите разницу между человеком, отправляющим письмо, и работой, которую выполняет почтовая служба.
The person sending the letters expects that the postal service will deliver the letter most of the time.|Человек, отправляющий письма, ожидает, что почтовая служба будет доставить письмо большую часть времени.
However, the person sending the letter does not need to know the details of exactly what path the letters take.|Однако человеку, отправляющему письмо, необязательно знать подробности того, по какому пути идут письма.
In contrast, the postal service does not create the letter, but it accepts the letter from the customer.|Почтовая служба, напротив, не создает письмо, но принимает письмо от клиента.
|
Then, the postal service must know the details about addresses and postal codes that group addresses into larger groups, and it must have the ability to deliver the letters.|Затем почтовая служба должна знать подробности об адресах и почтовых индексах, которые объединяют адреса в более крупные группы, и иметь возможность доставлять письма.
|
The TCP/IP application and transport layers act like the person sending letters through the postal service.|Приложение TCP / IP и транспортный уровень действуют как человек, отправляющий письма через почтовую службу.
These upper layers work the same way regardless of whether the endpoint host computers are on the same LAN or are separated by the entire Internet.|Эти верхние уровни работают одинаково независимо от того, находятся ли хост-компьютеры конечных точек в одной локальной сети или разделены всем Интернетом.
To send a message, these upper layers ask the layer below them, the network layer, to deliver the message.|Чтобы отправить сообщение, эти верхние уровни запрашивают уровень ниже, сетевой уровень, чтобы доставить сообщение.
|
The lower layers of the TCP/IP model act more like the postal service to deliver those messages to the correct destinations.|Нижние уровни модели TCP / IP действуют больше как почтовая служба, доставляя эти сообщения по правильным адресатам.
To do so, these lower layers must understand the underlying physical network because they must choose how to best deliver the data from one host to another.|Для этого эти нижние уровни должны понимать базовую физическую сеть, поскольку они должны выбирать, как лучше всего доставлять данные от одного хоста к другому.
|
So, what does this all matter to networking?|Итак, какое все это имеет значение для сетей?
Well, the network layer of the TCP/IP networking model, primarily defined by the Internet Protocol (IP), works much like the postal service.|Что ж, сетевой уровень сетевой модели TCP / IP, в первую очередь определяемый Интернет-протоколом (IP), работает во многом как почтовая служба.
|
IP defines that each host computer should have a different IP address, just as the postal service defines addressing that allows unique addresses for each house, apartment, and business.|IP определяет, что каждый хост-компьютер должен иметь другой IP-адрес, так же как почтовая служба определяет адресацию, которая позволяет использовать уникальные адреса для каждого дома, квартиры или предприятия.
|
Similarly, IP defines the process of routing so that devices called routers can work like the post office, forwarding packets of data so that they are delivered to the correct destinations.|Точно так же IP определяет процесс маршрутизации, так что устройства, называемые маршрутизаторами, могут работать как почтовое отделение, пересылая пакеты данных, чтобы они доставлялись в правильные места назначения.
|
Just as the postal service created the necessary infrastructure to deliver letters—post offices, sorting machines, trucks, planes, and personnel—the network layer defines the details of how a network infrastructure should be created so that the network can deliver data to all computers in the network.|Подобно тому, как почтовая служба создала необходимую инфраструктуру для доставки писем - почтовые отделения, сортировочные машины, грузовики, самолеты и персонал, - сетевой уровень определяет детали того, как должна быть создана сетевая инфраструктура, чтобы сеть могла доставлять данные на все компьютеры. в сети.
##### Internet Protocol Addressing Basics
Основы адресации интернет-протокола   
__|__
--|--
|
IP defines addresses for several important reasons.|IP определяет адреса по нескольким важным причинам.
First, each device that uses TCP/IP—each TCP/IP host—needs a unique address so that it can be identified in the network.|Во-первых, каждому устройству, использующему TCP / IP - каждому узлу TCP / IP - нужен уникальный адрес, чтобы его можно было идентифицировать в сети.
IP also defines how to group addresses together, just like the postal system groups addresses based on postal codes (like ZIP codes in the United States).|IP также определяет, как группировать адреса вместе, точно так же, как почтовая система группирует адреса на основе почтовых индексов (например, почтовые индексы в США).
|
To understand the basics, examine Figure 1-9, which shows the familiar web server Larry and web browser Bob; but now, instead of ignoring the network between these two computers, part of the network infrastructure is included.|Чтобы понять основы, изучите рисунок 1-9, на котором показаны знакомый веб-сервер Ларри и веб-браузер Боб; но теперь, вместо того, чтобы игнорировать сеть между этими двумя компьютерами, включена часть сетевой инфраструктуры.
|
Figure 1-9 Simple TCP/IP Network: Three Routers with IP Addresses Grouped First, note that Figure 1-9 shows some sample IP addresses.|Рисунок 1-9 Простая сеть TCP / IP: сначала сгруппированы три маршрутизатора с IP-адресами, обратите внимание, что на Рисунке 1-9 показаны некоторые примеры IP-адресов.
Each IP address has four numbers, separated by periods.|Каждый IP-адрес имеет четыре числа, разделенных точками.
In this case, Larry uses IP address 1.1.1.1, and Bob uses 2.2.2.2.|В этом случае Ларри использует IP-адрес 1.1.1.1, а Боб - 2.2.2.2.
|
This style of number is called a dotted-decimal notation (DDN).|Этот стиль чисел называется десятичной системой с разделительными точками (DDN).
|
Figure 1-9 also shows three groups of addresses.|На рисунке 1-9 также показаны три группы адресов.
In this example, all IP addresses that begin with 1 must be on the upper left, as shown in shorthand in the figure as 1.__.__.__.|В этом примере все IP-адреса, начинающиеся с 1, должны находиться в верхнем левом углу, как показано в сокращении на рисунке как 1 .__.__.__.
|
All addresses that begin with 2 must be on the right, as shown in shorthand as 2.__.__.__.|Все адреса, начинающиеся с 2, должны быть справа, как показано в сокращении как 2 .__.__.__.
|
Finally, all IP addresses that begin with 3 must be at the bottom of the figure.|Наконец, все IP-адреса, начинающиеся с 3, должны быть внизу рисунка.
|
In addition, Figure 1-9 introduces icons that represent IP routers.|Кроме того, на рис. 1-9 представлены значки, представляющие IP-маршрутизаторы.
Routers are networking devices that connect the parts of the TCP/IP network together for the purpose of routing (forwarding) IP packets to the correct destination.|Маршрутизаторы - это сетевые устройства, которые соединяют части сети TCP / IP вместе с целью маршрутизации (пересылки) IP-пакетов в правильное место назначения.
Routers do the equivalent of the work done by each post office site: They receive IP packets on various physical interfaces, make decisions based on the IP address included with the packet, and then physically forward the packet out some other network interface.|Маршрутизаторы выполняют эквивалент работы, выполняемой каждым узлом почтового отделения: они получают IP-пакеты на различных физических интерфейсах, принимают решения на основе IP-адреса, включенного в пакет, а затем физически пересылают пакет через какой-либо другой сетевой интерфейс.
##### IP Routing Basics
Основы IP-маршрутизации   
__|__
--|--
|
The TCP/IP network layer, using the IP protocol, provides a service of forwarding IP packets from one device to another.|Сетевой уровень TCP / IP, использующий протокол IP, предоставляет услугу пересылки IP-пакетов от одного устройства к другому.
Any device with an IP address can connect to the TCP/IP network and send packets.|Любое устройство с IP-адресом может подключаться к сети TCP / IP и отправлять пакеты.
This section shows a basic IP routing example for perspective.|В этом разделе для перспективы показан базовый пример IP-маршрутизации.
|
NOTE The term IP host refers to any device, regardless of size or power, that has an IP address and connects to any TCP/IP network.|ПРИМЕЧАНИЕ Термин IP-хост относится к любому устройству, независимо от размера или мощности, которое имеет IP-адрес и подключается к любой сети TCP / IP.
|
Figure 1-10 repeats the familiar case in which web server Larry wants to send part of a web page to Bob, but now with details related to IP. On the lower left, note that server Larry has the familiar application data, HTTP header, and TCP header ready to send.|На рис. 1-10 повторяется знакомый случай, когда веб-сервер Ларри хочет отправить часть веб-страницы Бобу, но теперь с деталями, связанными с IP. В левом нижнем углу обратите внимание, что на сервере Ларри есть уже знакомые данные приложения, заголовок HTTP и заголовок TCP, готовые к отправке.
In addition, the message now contains an IP header.|Кроме того, сообщение теперь содержит заголовок IP.
The IP header includes a source IP address of Larry’s IP address (1.1.1.1) and a destination IP address of Bob’s IP address (2.2.2.2).|Заголовок IP включает в себя исходный IP-адрес IP-адреса Ларри (1.1.1.1) и IP-адрес назначения IP-адреса Боба (2.2.2.2).
|
Figure 1-10 Basic Routing Example Step 1, on the left of Figure 1-10, begins with Larry being ready to send an IP packet.|Рисунок 1-10. Базовый пример маршрутизации Шаг 1 слева на рисунке 1-10 начинается с того, что Ларри готов отправить IP-пакет.
|
Larry’s IP process chooses to send the packet to some router—a nearby router on the same LAN—with the expectation that the router will know how to forward the packet. (This logic is much like you or me sending all our letters by putting them in a nearby mailbox.) Larry doesn’t need to know anything more about the topology or the other routers.|IP-процесс Ларри решает отправить пакет на какой-то маршрутизатор - ближайший маршрутизатор в той же локальной сети, - ожидая, что маршрутизатор будет знать, как пересылать пакет. (Эта логика очень похожа на то, как мы с вами отправляем все наши письма, складывая их в ближайший почтовый ящик.) Ларри не нужно больше ничего знать о топологии или других маршрутизаторах.
|
At Step 2, Router R1 receives the IP packet, and R1’s IP process makes a decision.|На шаге 2 маршрутизатор R1 получает IP-пакет, а IP-процесс R1 принимает решение.
R1 looks at the destination address (2.2.2.2), compares that address to its known IP routes, and chooses to forward the packet to Router R2. This process of forwarding the IP packet is called IP routing (or simply routing).|R1 смотрит на адрес назначения (2.2.2.2), сравнивает этот адрес со своими известными IP-маршрутами и выбирает пересылку пакета на маршрутизатор R2. Этот процесс пересылки IP-пакета называется IP-маршрутизацией (или просто маршрутизацией).
|
At Step 3, Router R2 repeats the same kind of logic used by Router R1. R2’s IP process will compare the packet’s destination IP address (2.2.2.2) to R2’s known IP routes and make a choice to forward the packet to the right, on to Bob.|На шаге 3 маршрутизатор R2 повторяет ту же логику, что и маршрутизатор R1. IP-процесс R2 сравнивает IP-адрес назначения пакета (2.2.2.2) с известными IP-маршрутами R2 и выбирает пересылку пакета направо, Бобу.
|
You will learn IP in more depth than any other protocol while preparing for CCNA. More than half the chapters in this book discuss some feature that relates to addressing, IP routing, and how routers perform routing.|Вы изучите IP глубже, чем любой другой протокол, при подготовке к CCNA. Более чем в половине глав этой книги обсуждаются некоторые особенности, связанные с адресацией, IP-маршрутизацией и тем, как маршрутизаторы выполняют маршрутизацию.
#### TCP/IP Data-Link and Physical Layers
Канал передачи данных TCP / IP и физические уровни   
__|__
--|--
|
The TCP/IP model’s data-link and physical layers define the protocols and hardware required to deliver data across some physical network.|Канальный и физический уровни модели TCP / IP определяют протоколы и оборудование, необходимые для доставки данных по какой-либо физической сети.
The two work together quite closely; in fact, some standards define both the data-link and physical layer functions.|Эти двое работают вместе довольно тесно; фактически, некоторые стандарты определяют функции как канала передачи данных, так и физического уровня.
The physical layer defines the cabling and energy (for example, electrical signals) that flow over the cables.|Физический уровень определяет кабели и энергию (например, электрические сигналы), которые проходят по кабелям.
|
Some rules and conventions exist when sending data over the cable; however, those rules exist in the data-link layer of the TCP/IP model.|При передаче данных по кабелю существуют некоторые правила и соглашения; однако эти правила существуют на канальном уровне модели TCP / IP.
|
Focusing on the data-link layer for a moment, just like every layer in any networking model, the TCP/IP data-link layer provides services to the layer above it in the model (the network layer).|Сосредоточившись на уровне канала передачи данных на мгновение, как и каждый уровень в любой сетевой модели, уровень канала передачи данных TCP / IP предоставляет услуги вышестоящему уровню модели (сетевой уровень).
When a host’s or router’s IP process chooses to send an IP packet to another router or host, that host or router then uses link-layer details to send that packet to the next host/|Когда IP-процесс хоста или маршрутизатора решает отправить IP-пакет другому маршрутизатору или хосту, этот хост или маршрутизатор затем использует данные канального уровня для отправки этого пакета на следующий хост /
|
router.|роутер.
|
Because each layer provides a service to the layer above it, take a moment to think about the IP logic related to Figure 1-10.|Поскольку каждый уровень предоставляет услуги вышестоящему уровню, подумайте о логике IP, показанной на рис. 1-10.
In that example, host Larry’s IP logic chooses to send the IP packet to a nearby router (R1).|В этом примере логика IP хоста Ларри решает отправить IP-пакет на ближайший маршрутизатор (R1).
However, while Figure 1-10 shows a simple line between Larry and router R1, that drawing means that some Ethernet LAN sits between the two.|Однако, хотя на рис. 1-10 показана простая линия между Ларри и маршрутизатором R1, этот рисунок означает, что некоторая локальная сеть Ethernet находится между ними.
Figure 1-11 shows four steps of what occurs at the link layer to allow Larry to send the IP packet to R1.|На рис. 1-11 показаны четыре шага того, что происходит на канальном уровне, чтобы Ларри мог отправить IP-пакет на маршрутизатор R1.
|
Larry|Ларри
###### 1.1.1.1
1.1.1.1   
__|__
--|--
|
Ethernet IP Packet Eth.|Ethernet IP Packet Eth.
|
IP Packet 1 Encapsulate 2 Transmit 3 IP Packet 4 De-encapsulate Receive R1 Header Trailer Ethernet IP Packet Eth.|IP-пакет 1 Инкапсуляция 2 Передача 3 IP-пакет 4 Деинкапсуляция Прием R1 Заголовок Прицеп Ethernet IP-пакет Eth.
|
Figure 1-11 Larry Using Ethernet to Forward an IP Packet to Router R1 NOTE Figure 1-11 depicts the Ethernet as a series of lines.|Рисунок 1-11. Ларри, использующий Ethernet для пересылки IP-пакета на маршрутизатор R1. ПРИМЕЧАНИЕ. Рисунок 1-11 изображает Ethernet как серию линий.
Networking diagrams often use this convention when drawing Ethernet LANs, in cases where the actual LAN cabling and LAN devices are not important to some discussion, as is the case here.|Сетевые схемы часто используют это соглашение при рисовании локальных сетей Ethernet, в случаях, когда фактические кабели и устройства локальной сети не важны для обсуждения, как здесь.
The LAN would have cables and devices, like LAN switches, which are not shown in this figure.|В локальной сети будут кабели и устройства, такие как коммутаторы локальной сети, которые не показаны на этом рисунке.
|
Figure 1-11 shows four steps.|На рисунке 1-11 показаны четыре шага.
The first two occur on Larry, and the last two occur on Router R1, as follows:|Первые два происходят на Ларри, а последние два - на маршрутизаторе R1, а именно:
|
Step 1.|Шаг 1.
Larry encapsulates the IP packet between an Ethernet header and Ethernet trailer, creating an Ethernet frame.|Ларри инкапсулирует IP-пакет между заголовком Ethernet и концом Ethernet, создавая кадр Ethernet.
|
Step 2.|Шаг 2.
Larry physically transmits the bits of this Ethernet frame, using electricity flowing over the Ethernet cabling.|Ларри физически передает биты этого кадра Ethernet, используя электричество, протекающее по кабелям Ethernet.
|
Step 3.|Шаг 3.
Router R1 physically receives the electrical signal over a cable and re-creates the same bits by interpreting the meaning of the electrical signals.|Маршрутизатор R1 физически принимает электрический сигнал по кабелю и воссоздает те же биты, интерпретируя значение электрических сигналов.
|
Step 4.|Шаг 4.
Router R1 de-encapsulates the IP packet from the Ethernet frame by removing and discarding the Ethernet header and trailer.|Маршрутизатор R1 деинкапсулирует IP-пакет из кадра Ethernet, удаляя и отбрасывая заголовок и трейлер Ethernet.
|
By the end of this process, Larry and R1 have worked together to deliver the packet from Larry to Router R1.|К концу этого процесса Ларри и R1 работали вместе, чтобы доставить пакет от Ларри к маршрутизатору R1.
|
NOTE Protocols define both headers and trailers for the same general reason, but headers exist at the beginning of the message and trailers exist at the end.|ПРИМЕЧАНИЕ Протоколы определяют как заголовки, так и трейлеры по одной и той же общей причине, но заголовки существуют в начале сообщения, а трейлеры - в конце.
|
The data-link and physical layers include a large number of protocols and standards.|Канальный и физический уровни включают большое количество протоколов и стандартов.
For example, the link layer includes all the variations of Ethernet protocols and wireless LAN protocols discussed throughout this book.|Например, канальный уровень включает в себя все варианты протоколов Ethernet и протоколов беспроводной локальной сети, обсуждаемые в этой книге.
|
1 In short, the TCP/IP physical and data-link layers include two distinct functions, respectively:|1 Короче говоря, физический уровень TCP / IP и уровень канала передачи данных включают две различные функции, соответственно:
|
functions related to the physical transmission of the data, plus the protocols and rules that control the use of the physical media.|функции, связанные с физической передачей данных, а также протоколы и правила, управляющие использованием физических носителей.
### Data Encapsulation Terminology
Терминология инкапсуляции данных   
__|__
--|--
|
As you can see from the explanations of how HTTP, TCP, IP, and Ethernet do their jobs, when sending data, each layer adds its own header (and for data-link protocols, also a trailer)|Как вы можете видеть из объяснений того, как HTTP, TCP, IP и Ethernet выполняют свою работу, при отправке данных каждый уровень добавляет свой собственный заголовок (а для протоколов передачи данных также трейлер)
|
to the data supplied by the higher layer.|к данным, предоставленным более высоким уровнем.
The term encapsulation refers to the process of putting headers (and sometimes trailers) around some data.|Термин инкапсуляция относится к процессу размещения заголовков (а иногда и трейлеров) вокруг некоторых данных.
|
Many of the examples in this chapter show the encapsulation process.|Многие примеры в этой главе показывают процесс инкапсуляции.
For example, web server Larry encapsulated the contents of the home page inside an HTTP header in Figure 1-6.|Например, веб-сервер Ларри инкапсулировал содержимое домашней страницы в заголовок HTTP на рис. 1-6.
The TCP layer encapsulated the HTTP headers and data inside a TCP header in Figure 1-7.|Уровень TCP инкапсулировал заголовки и данные HTTP внутри заголовка TCP, показанного на рисунке 1-7.
IP encapsulated the TCP headers and the data inside an IP header in Figure 1-10.|IP инкапсулировал заголовки TCP и данные внутри заголовка IP на рис. 1-10.
Finally, the Ethernet link layer encapsulated the IP packets inside both a header and a trailer in Figure 1-11.|Наконец, канальный уровень Ethernet инкапсулировал IP-пакеты как в заголовке, так и в конце, как показано на рисунке 1-11.
|
The process by which a TCP/IP host sends data can be viewed as a five-step process.|Процесс, посредством которого хост TCP / IP отправляет данные, можно рассматривать как пятиэтапный процесс.
The first four steps relate to the encapsulation performed by the four TCP/IP layers, and the last step is the actual physical transmission of the data by the host.|Первые четыре шага относятся к инкапсуляции, выполняемой четырьмя уровнями TCP / IP, а последний шаг - это фактическая физическая передача данных хостом.
In fact, if you use the fivelayer TCP/IP model, one step corresponds to the role of each layer.|Фактически, если вы используете пятиуровневую модель TCP / IP, один шаг соответствует роли каждого уровня.
The steps are summarized in the following list:|Шаги приведены в следующем списке:
|
Step 1.|Шаг 1.
Create and encapsulate the application data with any required application layer headers.|Создайте и инкапсулируйте данные приложения с любыми необходимыми заголовками уровня приложения.
For example, the HTTP OK message can be returned in an HTTP header, followed by part of the contents of a web page.|Например, сообщение HTTP OK может быть возвращено в заголовке HTTP, за которым следует часть содержимого веб-страницы.
|
Step 2.|Шаг 2.
Encapsulate the data supplied by the application layer inside a transport layer header.|Инкапсулируйте данные, предоставленные прикладным уровнем, внутри заголовка транспортного уровня.
For end-user applications, a TCP or UDP header is typically used.|Для приложений конечного пользователя обычно используется заголовок TCP или UDP.
|
Step 3.|Шаг 3.
Encapsulate the data supplied by the transport layer inside a network layer (IP) header.|Инкапсулируйте данные, предоставленные транспортным уровнем, внутри заголовка сетевого уровня (IP).
IP defines the IP addresses that uniquely identify each computer.|IP определяет IP-адреса, которые однозначно идентифицируют каждый компьютер.
|
Step 4.|Шаг 4.
Encapsulate the data supplied by the network layer inside a data-link layer header and trailer.|Инкапсулируйте данные, предоставленные сетевым уровнем, внутри заголовка и трейлера уровня канала данных.
This layer uses both a header and a trailer.|Этот слой использует как заголовок, так и трейлер.
|
Step 5.|Шаг 5.
Transmit the bits.|Передайте биты.
The physical layer encodes a signal onto the medium to transmit the frame.|Физический уровень кодирует сигнал на носителе для передачи кадра.
|
The numbers in Figure 1-12 correspond to the five steps in this list, graphically showing the same concepts.|Цифры на рис. 1-12 соответствуют пяти шагам в этом списке, графически демонстрируя те же концепции.
Note that because the application layer often does not need to add a header, the figure does not show a specific application layer header, but the application layer will also at times add a header as well.|Обратите внимание, что, поскольку на уровне приложения часто не требуется добавлять заголовок, на рисунке не показан конкретный заголовок уровня приложения, но уровень приложения также иногда добавляет заголовок.
|
Figure 1-12 Five Steps of Data Encapsulation: TCP/IP|Рисунок 1-12 Пять шагов инкапсуляции данных: TCP / IP
#### Names of TCP/IP Messages
Имена сообщений TCP / IP   
__|__
--|--
|
One reason this chapter takes the time to show the encapsulation steps in detail has to do with terminology.|Одна из причин, по которой в этой главе уделено время подробному описанию этапов инкапсуляции, связана с терминологией.
When talking and writing about networking, people use segment, packet, and frame to refer to the messages shown in Figure 1-13 and the related list.|Когда говорят и пишут о сети, люди используют сегмент, пакет и фрейм для ссылки на сообщения, показанные на рис. 1-13, и связанный список.
Each term has a specific meaning, referring to the headers (and possibly trailers) defined by a particular layer and the data encapsulated following that header.|Каждый термин имеет определенное значение, относящееся к заголовкам (и, возможно, трейлерам), определенным конкретным уровнем, и данным, инкапсулированным после этого заголовка.
Each term, however, refers to a different layer: segment for the transport layer, packet for the network layer, and frame for the link layer.|Однако каждый термин относится к разному уровню: сегменту для транспортного уровня, пакету для сетевого уровня и кадру для канального уровня.
Figure 1-13 shows each layer along with the associated term.|На рис. 1-13 показан каждый уровень вместе с соответствующим термином.
|
Figure 1-13 Perspectives on Encapsulation and “Data”1 1 The letters LH and LT stand for link header and link trailer, respectively, and refer to the data-link layer header and trailer.|Рисунок 1-13 Перспективы инкапсуляции и «данных» 1 1 Буквы LH и LT обозначают заголовок ссылки и концевую часть ссылки, соответственно, и относятся к заголовку и завершению уровня звена данных.
|
Figure 1-13 also shows the encapsulated data as simply “data.” When focusing on the work done by a particular layer, the encapsulated data typically is unimportant.|На рис. 1-13 также показаны инкапсулированные данные как просто «данные». Если сосредоточиться на работе, выполняемой определенным уровнем, инкапсулированные данные обычно не важны.
For example, an IP packet can indeed have a TCP header after the IP header, an HTTP header after the TCP header, and data for a web page after the HTTP header.|Например, IP-пакет действительно может иметь заголовок TCP после заголовка IP, заголовок HTTP после заголовка TCP и данные для веб-страницы после заголовка HTTP.
However, when discussing IP, you probably just care about the IP header, so everything after the IP header is just called data.|Однако, обсуждая IP, вы, вероятно, заботитесь только о заголовке IP, поэтому все, что находится после заголовка IP, просто называется данными.
|
So, when drawing IP packets, everything after the IP header is typically shown simply as data.|Таким образом, при отрисовке IP-пакетов все, что находится после IP-заголовка, обычно отображается просто как данные.
#### OSI Networking Model and Terminology
Сетевая модель и терминология OSI   
__|__
--|--
|
At one point in the history of the OSI model, many people thought that OSI would win the battle of the networking models discussed earlier.|В какой-то момент истории модели OSI многие люди думали, что OSI выиграет битву сетевых моделей, обсуждавшихся ранее.
If that had occurred, instead of running TCP/IP on every computer in the world, those computers would be running with OSI.|Если бы это произошло, вместо запуска TCP / IP на каждом компьютере в мире эти компьютеры работали бы с OSI.
|
1 However, OSI did not win that battle.|1 Однако OSI не выиграла эту битву.
In fact, OSI no longer exists as a networking model that could be used instead of TCP/IP, although some of the original protocols referenced by the OSI model still exist.|Фактически, OSI больше не существует как сетевая модель, которую можно было бы использовать вместо TCP / IP, хотя некоторые из исходных протоколов, на которые ссылается модель OSI, все еще существуют.
|
So, why is OSI even in this book?|Итак, почему OSI даже в этой книге?
Terminology.|Терминология.
During those years in which many people thought the OSI model would become commonplace in the world of networking (mostly in the late 1980s and early 1990s), many vendors and protocol documents started using terminology from the OSI model.|В те годы, когда многие думали, что модель OSI станет обычным явлением в мире сетей (в основном в конце 1980-х - начале 1990-х годов), многие поставщики и протоколы начали использовать терминологию модели OSI.
That terminology remains today.|Эта терминология сохраняется и сегодня.
So, while you will never need to work with a computer that uses OSI, to understand modern networking terminology, you need to understand something about OSI.|Итак, хотя вам никогда не придется работать с компьютером, использующим OSI, для понимания современной сетевой терминологии вам необходимо кое-что понять об OSI.
##### Comparing OSI and TCP/IP Layer Names and Numbers
Сравнение имен и номеров уровней OSI и TCP / IP   
__|__
--|--
|
The OSI model has many similarities to the TCP/IP model from a basic conceptual perspective.|Модель OSI имеет много общего с моделью TCP / IP с базовой концептуальной точки зрения.
|
It has layers, and each layer defines a set of typical networking functions.|Он имеет уровни, и каждый уровень определяет набор типичных сетевых функций.
As with TCP/|Как и в случае с TCP /
|
IP, the OSI layers each refer to multiple protocols and standards that implement the functions specified by each layer.|IP, каждый уровень OSI относится к нескольким протоколам и стандартам, которые реализуют функции, указанные на каждом уровне.
In other cases, just as for TCP/IP, the OSI committees did not create new protocols or standards, but instead referenced other protocols that were already defined.|В других случаях, как и в случае TCP / IP, комитеты OSI не создавали новые протоколы или стандарты, а вместо этого ссылались на другие протоколы, которые уже были определены.
|
For example, the IEEE defines Ethernet standards, so the OSI committees did not waste time specifying a new type of Ethernet; it simply referred to the IEEE Ethernet standards.|Например, IEEE определяет стандарты Ethernet, поэтому комитеты OSI не тратили время на определение нового типа Ethernet; он просто ссылался на стандарты IEEE Ethernet.
|
Today, the OSI model can be used as a standard of comparison to other networking models.|Сегодня модель OSI может использоваться как стандарт для сравнения с другими сетевыми моделями.
|
Figure 1-14 compares the seven-layer OSI model with both the four-layer and five-layer TCP/IP models.|На рисунке 1-14 сравнивается семиуровневая модель OSI с четырехуровневой и пятиуровневой моделями TCP / IP.
|
Figure 1-14 OSI Model Compared to the Two TCP/IP Models Note that the TCP/IP model in use today, on the right side of the figure, uses the exact same layer names as OSI at the lower layers.|Рисунок 1-14 Модель OSI в сравнении с двумя моделями TCP / IP Обратите внимание, что в модели TCP / IP, используемой сегодня, в правой части рисунка, используются те же имена уровней, что и в OSI на нижних уровнях.
The functions generally match as well, so for the purpose of discussing networking, and reading networking documentation, think of the bottom four layers as equivalent, in name, in number, and in meaning.|Функции, как правило, также совпадают, поэтому при обсуждении сети и чтении сетевой документации подумайте о нижних четырех уровнях как о эквивалентных по названию, количеству и значению.
|
Even though the world uses TCP/IP today rather than OSI, we tend to use the numbering from the OSI layer.|Хотя сегодня в мире используется TCP / IP, а не OSI, мы склонны использовать нумерацию уровня OSI.
For instance, when referring to an application layer protocol in a TCP/IP network, the world still refers to the protocol as a “Layer 7 protocol.” Also, while TCP/IP includes more functions at its application layer, OSI breaks those intro session, presentation, and application layers.|Например, когда речь идет о протоколе прикладного уровня в сети TCP / IP, мир по-прежнему называет этот протокол «протоколом уровня 7». Кроме того, в то время как TCP / IP включает больше функций на уровне приложений, OSI нарушает эти вводные сеансы, представления и уровни приложений.
Most of the time, no one cares much about the distinction, so you will see references like “Layer 5–7 protocol,” again using OSI numbering.|В большинстве случаев никто не заботится о различиях, поэтому вы увидите такие ссылки, как «Протокол уровня 5–7», опять же с использованием нумерации OSI.
|
For the purposes of this book, know the mapping between the five-layer TCP/IP model and the seven-layer OSI model shown in Figure 1-14, and know that layer number references to Layer 7 really do match the application layer of TCP/IP as well.|Для целей этой книги необходимо знать соответствие между пятиуровневой моделью TCP / IP и семиуровневой моделью OSI, показанной на рис. 1-14, и знать, что ссылки на номер уровня на уровень 7 действительно соответствуют прикладному уровню TCP. / IP тоже.
##### OSI Data Encapsulation Terminology
Терминология инкапсуляции данных OSI   
__|__
--|--
|
Like TCP/IP, each OSI layer asks for services from the next lower layer.|Как и TCP / IP, каждый уровень OSI запрашивает услуги у следующего нижнего уровня.
To provide the services, each layer makes use of a header and possibly a trailer.|Для предоставления услуг каждый уровень использует заголовок и, возможно, трейлер.
The lower layer encapsulates the higher layer’s data behind a header.|Нижний уровень инкапсулирует данные верхнего уровня за заголовком.
|
OSI uses a more generic term to refer to messages, rather than frame, packet, and segment.|OSI использует более общий термин для обозначения сообщений, а не кадра, пакета и сегмента.
|
OSI uses the term protocol data unit (PDU). A PDU represents the bits that include the headers and trailers for that layer, as well as the encapsulated data.|OSI использует термин блок данных протокола (PDU). PDU представляет биты, которые включают заголовки и трейлеры для этого уровня, а также инкапсулированные данные.
For example, an IP packet, as shown in Figure 1-13, using OSI terminology, is a PDU, more specifically a Layer 3 PDU (abbreviated L3PDU) because IP is a Layer 3 protocol.|Например, IP-пакет, как показано на рис. 1-13, используя терминологию OSI, является PDU, а точнее PDU уровня 3 (сокращенно L3PDU), поскольку IP является протоколом уровня 3.
OSI simply refers to the Layer x PDU (LxPDU), with x referring to the number of the layer being discussed, as shown in Figure 1-15.|OSI просто относится к PDU уровня x (LxPDU), где x относится к номеру обсуждаемого уровня, как показано на рисунке 1-15.
|
Figure 1-15 OSI Encapsulation and Protocol Data Units|Рисунок 1-15 Инкапсуляция OSI и блоки данных протокола
### Chapter Review
Обзор главы   
__|__
--|--
|
The “Your Study Plan” element, just before Chapter 1, discusses how you should study and practice the content and skills for each chapter before moving on to the next chapter.|Элемент «Ваш учебный план», расположенный непосредственно перед главой 1, обсуждает, как вы должны изучать и практиковать содержание и навыки для каждой главы, прежде чем переходить к следующей главе.
That element introduces the tools used here at the end of each chapter.|Этот элемент знакомит с инструментами, используемыми здесь, в конце каждой главы.
If you haven’t already done so, take a few minutes to read that section.|Если вы еще этого не сделали, уделите несколько минут, чтобы прочитать этот раздел.
Then come back here and do the useful work of reviewing the chapter to help lock into memory what you just read.|Затем вернитесь сюда и проделайте полезную работу по просмотру главы, чтобы закрепить в памяти то, что вы только что прочитали.
|
Review this chapter’s material using either the tools in the book or the interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты в книге или интерактивные инструменты для того же материала, которые можно найти на сопутствующем веб-сайте книги.
Table 1-4 outlines the key review elements and where you can find them.|В Таблице 1-4 представлены основные элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
1 Table 1-4 Chapter Review Tracking Table end.|1 Таблица 1-4. Конец таблицы отслеживания обзора главы.
|
Review All the Key Topics Key Terms You Should Know adjacent-layer interaction, de-encapsulation, encapsulation, frame, networking model, packet, protocol data unit (PDU), same-layer interaction, segment|Ознакомьтесь со всеми ключевыми темами. Ключевые термины, которые вы должны знать. Взаимодействие на смежном уровне, деинкапсуляция, инкапсуляция, кадр, сетевая модель, пакет, блок данных протокола (PDU), взаимодействие на одном уровне, сегмент.
## Chapter 2 Fundamentals of Ethernet LANs
Глава 2 Основы локальных сетей Ethernet   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.1 Explain the role and function of network components
1.1 Объясните роль и функции сетевых компонентов   
###### 1.1.b L2 and L3 Switches
1.1.b Коммутаторы L2 и L3   
###### 1.2 Describe characteristics of network topology architectures
1.2 Описание характеристик архитектур топологии сети   
###### 1.2.e Small office/home office (SOHO)
1.2.e Малый офис / домашний офис (SOHO)   
###### 1.3 Compare physical interface and cabling types
1.3 Сравните физический интерфейс и типы кабелей   
###### 1.3.a Single-mode fiber, multimode fiber, copper
1.3.a Одномодовое волокно, многомодовое волокно, медь   
###### 1.3.b Connections (Ethernet shared media and point-to-point)
1.3.b Подключения (общая среда Ethernet и точка-точка)   
__|__
--|--
|
Most enterprise computer networks can be separated into two general types of technology:|Большинство корпоративных компьютерных сетей можно разделить на два основных типа технологий:
|
local-area networks (LANs) and wide-area networks (WANs).|локальные сети (LAN) и глобальные сети (WAN).
LANs typically connect nearby devices: devices in the same room, in the same building, or in a campus of buildings.|К локальным сетям обычно подключаются соседние устройства: устройства в одной комнате, в одном здании или в комплексе зданий.
|
In contrast, WANs connect devices that are typically relatively far apart.|Напротив, глобальные сети соединяют устройства, которые обычно находятся на относительно большом расстоянии друг от друга.
Together, LANs and WANs create a complete enterprise computer network, working together to do the job of a computer network: delivering data from one device to another.|Вместе локальные и глобальные сети создают законченную компьютерную сеть предприятия, работая вместе, чтобы выполнять работу компьютерной сети: доставлять данные от одного устройства к другому.
|
Many types of LANs have existed over the years, but today’s networks use two general types of LANs: Ethernet LANs and wireless LANs. Ethernet LANs happen to use cables for the links between nodes, and because many types of cables use copper wires, Ethernet LANs are often called wired LANs. Ethernet LANs also make use of fiber-optic cabling, which includes a fiberglass core that devices use to send data using light.|На протяжении многих лет существовало множество типов локальных сетей, но современные сети используют два основных типа локальных сетей: локальные сети Ethernet и беспроводные локальные сети. В локальных сетях Ethernet используются кабели для связи между узлами, и поскольку многие типы кабелей используют медные провода, локальные сети Ethernet часто называют проводными локальными сетями. В локальных сетях Ethernet также используются волоконно-оптические кабели, которые включают в себя стекловолоконную сердцевину, которую устройства используют для передачи данных с помощью света.
In comparison to Ethernet, wireless LANs do not use wires or cables, instead using radio waves for the links between nodes; Part V of this book discusses Wireless LANs at length.|По сравнению с Ethernet, в беспроводных локальных сетях не используются провода или кабели, вместо этого используются радиоволны для связи между узлами; В части V этой книги подробно рассматриваются беспроводные локальные сети.
|
This chapter introduces Ethernet LANs, with more detailed coverage in Parts II and III of this book.|В этой главе представлены локальные сети Ethernet с более подробным описанием в частях II и III этой книги.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
CHAPTER 2 Table 2-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|ГЛАВА 2 Таблица 2-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### An Overview of LANs
Обзор локальных сетей   
__|__
--|--
|
Building Physical Ethernet LANs with UTP 3–4 Building Physical Ethernet LANs with Fiber 5 Sending Data in Ethernet Networks 6–9 1.|Создание физических локальных сетей Ethernet с использованием UTP 3–4 Создание физических локальных сетей Ethernet с использованием оптоволокна 5 Отправка данных в сетях Ethernet 6–9 1.
In the LAN for a small office, some user devices connect to the LAN using a cable, while others connect using wireless technology (and no cable).|В локальной сети для небольшого офиса некоторые пользовательские устройства подключаются к локальной сети с помощью кабеля, а другие подключаются с помощью беспроводной технологии (без кабеля).
Which of the following is true regarding the use of Ethernet in this LAN?|Что из следующего верно относительно использования Ethernet в этой локальной сети?
|
a. Only the devices that use cables are using Ethernet.|а. Только устройства, которые используют кабели, используют Ethernet.
|
b. Only the devices that use wireless are using Ethernet.|б. Только устройства, использующие беспроводную связь, используют Ethernet.
|
c. Both the devices using cables and those using wireless are using Ethernet.|c. И устройства, использующие кабели, и устройства, использующие беспроводную связь, используют Ethernet.
|
d. None of the devices are using Ethernet.|d. Ни одно из устройств не использует Ethernet.
|
2. Which of the following Ethernet standards defines Gigabit Ethernet over UTP cabling?|2. Какой из следующих стандартов Ethernet определяет кабели Gigabit Ethernet через UTP?
|
a. 10GBASE-T b. 100BASE-T c. 1000BASE-T d.|а. 10GBASE-T б. 100BASE-T c. 1000BASE-T d.
None of the other answers is correct.|Ни один из других ответов не верен.
|
3. Which of the following is true about Ethernet crossover cables for Fast Ethernet?|3. Что из следующего верно относительно кроссоверных кабелей Ethernet для Fast Ethernet?
|
a. Pins 1 and 2 are reversed on the other end of the cable.|а. Контакты 1 и 2 на другом конце кабеля переставлены.
|
b. Pins 1 and 2 on one end of the cable connect to pins 3 and 6 on the other end of the cable.|б. Контакты 1 и 2 на одном конце кабеля подключаются к контактам 3 и 6 на другом конце кабеля.
|
c. Pins 1 and 2 on one end of the cable connect to pins 3 and 4 on the other end of the cable.|c. Контакты 1 и 2 на одном конце кабеля подключаются к контактам 3 и 4 на другом конце кабеля.
|
d. The cable can be up to 1000 meters long to cross over between buildings.|d. Кабель может быть длиной до 1000 метров для перехода между зданиями.
|
e. None of the other answers is correct.|е. Ни один из других ответов не верен.
|
4. Each answer lists two types of devices used in a 100BASE-T network.|4. В каждом ответе перечислены два типа устройств, используемых в сети 100BASE-T.
If these devices were connected with UTP Ethernet cables, which pairs of devices would require a straight-through cable? (Choose three answers.)|Если бы эти устройства были подключены с помощью кабелей UTP Ethernet, для каких пар устройств потребовался бы прямой кабель? (Выберите три ответа.)
|
a. PC and router b.|а. ПК и маршрутизатор b.
PC and switch c.|ПК и коммутатор c.
Hub and switch d.|Концентратор и переключатель d.
Router and hub e.|Маршрутизатор и концентратор e.
Wireless access point (Ethernet port) and switch 5.|Точка беспроводного доступа (порт Ethernet) и коммутатор 5.
Which of the following are advantages of using multimode fiber for an Ethernet link instead of UTP or single-mode fiber?|Каковы преимущества использования многомодового волокна для канала Ethernet вместо UTP или одномодового волокна?
|
a. To achieve the longest distance possible for that single link.|а. Для достижения максимально возможного расстояния для этого одиночного звена.
|
b. To extend the link beyond 100 meters while keeping initial costs as low as possible.|б. Расширить линию связи более чем на 100 метров при минимально возможных начальных затратах.
|
c. To make use of an existing stock of laser-based SFP/SFP+ modules.|c. Чтобы использовать существующий запас лазерных модулей SFP / SFP +.
|
d. To make use of an existing stock of LED-based SFP/SFP+ modules.|d. Чтобы использовать существующий запас модулей SFP / SFP + на основе светодиодов.
|
6. Which of the following is true about the CSMA/CD algorithm?|6. Что из следующего верно об алгоритме CSMA / CD?
|
a. The algorithm never allows collisions to occur.|а. Алгоритм никогда не допускает возникновения коллизий.
|
b. Collisions can happen, but the algorithm defines how the computers should notice a collision and how to recover.|б. Коллизии могут происходить, но алгоритм определяет, как компьютеры должны замечать коллизию и как восстанавливаться.
|
c. The algorithm works with only two devices on the same Ethernet.|c. Алгоритм работает только с двумя устройствами в одном Ethernet.
|
d. None of the other answers is correct.|d. Ни один из других ответов не верен.
|
7. Which of the following is true about the Ethernet FCS field?|7. Что из следующего верно о поле Ethernet FCS?
|
a. Ethernet uses FCS for error recovery.|а. Ethernet использует FCS для устранения ошибок.
|
b. It is 2 bytes long.|б. Его длина составляет 2 байта.
|
c. It resides in the Ethernet trailer, not the Ethernet header.|c. Он находится в трейлере Ethernet, а не в заголовке Ethernet.
|
d. It is used for encryption.|d. Он используется для шифрования.
|
8. Which of the following are true about the format of Ethernet addresses? (Choose three answers.)|8. Что из следующего является верным относительно формата адресов Ethernet? (Выберите три ответа.)
|
a. Each manufacturer puts a unique OUI code into the first 2 bytes of the address.|а. Каждый производитель помещает уникальный код OUI в первые 2 байта адреса.
|
b. Each manufacturer puts a unique OUI code into the first 3 bytes of the address.|б. Каждый производитель помещает уникальный код OUI в первые 3 байта адреса.
|
c. Each manufacturer puts a unique OUI code into the first half of the address.|c. Каждый производитель помещает уникальный код OUI в первую половину адреса.
|
d. The part of the address that holds this manufacturer’s code is called the MAC.|d. Часть адреса, содержащая код этого производителя, называется MAC.
|
e. The part of the address that holds this manufacturer’s code is called the OUI.|е. Часть адреса, содержащая код этого производителя, называется OUI.
|
f. The part of the address that holds this manufacturer’s code has no specific name.|f. Часть адреса, содержащая код этого производителя, не имеет конкретного названия.
|
9. Which of the following terms describe Ethernet addresses that can be used to send one frame that is delivered to multiple devices on the LAN? (Choose two answers.)|9. Какие из следующих терминов описывают адреса Ethernet, которые можно использовать для отправки одного кадра, который доставляется на несколько устройств в локальной сети? (Выберите два ответа.)
|
a. Burned-in address b.|а. Выгоревший адрес b.
Unicast address c.|Одноадресный адрес c.
Broadcast address d.|Адрес трансляции d.
Multicast address Foundation Topics An Overview of LANs The term Ethernet refers to a family of LAN standards that together define the physical and data-link layers of the world’s most popular wired LAN technology.|Основные темы многоадресного адреса Обзор LAN Термин Ethernet относится к семейству стандартов LAN, которые вместе определяют физический уровень и уровень канала передачи данных самой популярной в мире технологии проводных LAN.
The standards, defined by the Institute of Electrical and Electronics Engineers (IEEE), define the cabling, the connectors on the ends of the cables, the protocol rules, and everything else required to create an Ethernet LAN.|Стандарты, определенные Институтом инженеров по электротехнике и электронике (IEEE), определяют кабели, разъемы на концах кабелей, правила протокола и все остальное, необходимое для создания локальной сети Ethernet.
#### Typical SOHO LANs
Типичные локальные сети SOHO   
__|__
--|--
|
To begin, first think about a small office/home office (SOHO) LAN today, specifically a LAN that uses only Ethernet LAN technology.|Для начала сначала подумайте о ЛВС небольшого офиса / домашнего офиса (SOHO) сегодня, особенно о ЛВС, в которой используется только технология ЛВС Ethernet.
First, the LAN needs a device called an Ethernet LAN switch, which provides many physical ports into which cables can be connected.|Во-первых, для локальной сети требуется устройство, называемое коммутатором локальной сети Ethernet, который предоставляет множество физических портов, к которым можно подключать кабели.
|
An Ethernet uses Ethernet cables, which is a general reference to any cable that conforms to any of several Ethernet standards.|Ethernet использует кабели Ethernet, которые являются общим обозначением любого кабеля, который соответствует любому из нескольких стандартов Ethernet.
The LAN uses Ethernet cables to connect different Ethernet devices or nodes to one of the switch’s Ethernet ports.|В локальной сети используются кабели Ethernet для подключения различных устройств или узлов Ethernet к одному из портов Ethernet коммутатора.
|
Figure 2-1 shows a drawing of a SOHO Ethernet LAN. The figure shows a single LAN switch, five cables, and five other Ethernet nodes: three PCs, a printer, and one network device called a router. (The router connects the LAN to the WAN, in this case to the Internet.).|На Рис. 2-1 показан чертеж локальной сети Ethernet SOHO. На рисунке показан один коммутатор LAN, пять кабелей и пять других узлов Ethernet: три ПК, принтер и одно сетевое устройство, называемое маршрутизатором. (Маршрутизатор соединяет локальную сеть с глобальной сетью, в данном случае с Интернетом).
|
Figure 2-1 Typical Small Ethernet-Only SOHO LAN Although Figure 2-1 shows the switch and router as separate devices, many SOHO Ethernet LANs today combine the router and switch into a single device.|Рис. 2-1 Типичная небольшая локальная сеть SOHO только для Ethernet Хотя на рис. 2-1 коммутатор и маршрутизатор показаны как отдельные устройства, сегодня многие локальные сети Ethernet для SOHO объединяют маршрутизатор и коммутатор в одно устройство.
Vendors sell consumer-grade integrated networking devices that work as a router and Ethernet switch, as well as doing other functions.|Продавцы продают интегрированные сетевые устройства потребительского уровня, которые работают как маршрутизатор и коммутатор Ethernet, а также выполняют другие функции.
These devices typically have “router” on the packaging, but many models also have four-port or eight-port Ethernet LAN switch ports built in to the device.|Эти устройства обычно имеют «маршрутизатор» на упаковке, но многие модели также имеют порты коммутатора LAN с четырьмя или восемью портами, встроенные в устройство.
|
Typical SOHO LANs today also support wireless LAN connections.|Типичные локальные сети SOHO сегодня также поддерживают подключения к беспроводной локальной сети.
You can build a single SOHO LAN that includes both Ethernet LAN technology as well as wireless LAN technology, which is also defined by the IEEE. Wireless LANs, defined by the IEEE using standards that begin with 802.11, use radio waves to send the bits from one node to the next.|Вы можете построить одну локальную сеть SOHO, которая включает как технологию локальной сети Ethernet, так и технологию беспроводной локальной сети, которая также определена IEEE. Беспроводные локальные сети, определенные IEEE с использованием стандартов, начинающихся с 802.11, используют радиоволны для передачи битов от одного узла к другому.
|
Most wireless LANs rely on yet another networking device: a wireless LAN access point (AP). The AP acts somewhat like an Ethernet switch, in that all the wireless LAN nodes communicate with the wireless AP. If the network uses an AP that is a separate physical device, the AP then needs a single Ethernet link to connect the AP to the Ethernet LAN, as shown in Figure 2-2.|Большинство беспроводных локальных сетей полагаются на еще одно сетевое устройство: точку доступа (AP) беспроводной локальной сети. Точка доступа действует как коммутатор Ethernet, поскольку все узлы беспроводной локальной сети обмениваются данными с беспроводной точкой доступа. Если в сети используется точка доступа, которая является отдельным физическим устройством, тогда этой точке доступа потребуется один канал Ethernet для подключения точки доступа к локальной сети Ethernet, как показано на рисунке 2-2.
|
Note that Figure 2-2 shows the router, Ethernet switch, and wireless LAN access point as three separate devices so that you can better understand the different roles.|Обратите внимание, что на Рис. 2-2 маршрутизатор, коммутатор Ethernet и точка доступа к беспроводной локальной сети показаны как три отдельных устройства, чтобы вы могли лучше понять различные роли.
However, most SOHO networks today would use a single device, often labeled as a “wireless router,” that does all these functions.|Однако в большинстве сетей SOHO сегодня используется одно устройство, часто обозначаемое как «беспроводной маршрутизатор», которое выполняет все эти функции.
|
Figure 2-2 Typical Small Wired and Wireless SOHO LAN|Рисунок 2-2 Типичная небольшая проводная и беспроводная локальная сеть SOHO.
#### Typical Enterprise LANs
Типичные корпоративные локальные сети   
__|__
--|--
|
Enterprise networks have similar needs compared to a SOHO network, but on a much larger scale.|У корпоративных сетей аналогичные потребности по сравнению с сетью SOHO, но в гораздо большем масштабе.
For example, enterprise Ethernet LANs begin with LAN switches installed in a wiring closet behind a locked door on each floor of a building.|Например, корпоративные локальные сети Ethernet начинаются с коммутаторов локальной сети, установленных в коммутационном шкафу за запертой дверью на каждом этаже здания.
The electricians install the Ethernet cabling from that wiring closet to cubicles and conference rooms where devices might need to connect to the LAN. At the same time, most enterprises also support wireless LANs in the same space, to allow people to roam around and still work and to support a growing number of devices that do not have an Ethernet LAN interface.|Электрики устанавливают кабели Ethernet от этого коммутационного шкафа до кабинетов и конференц-залов, где устройствам может потребоваться подключение к локальной сети. В то же время большинство предприятий также поддерживают беспроводные локальные сети в том же пространстве, чтобы люди могли перемещаться и продолжать работать, а также для поддержки растущего числа устройств, не имеющих интерфейса Ethernet LAN.
|
Figure 2-3 shows a conceptual view of a typical enterprise LAN in a three-story building.|На рис. 2-3 показано концептуальное представление типичной корпоративной локальной сети в трехэтажном здании.
Each floor has an Ethernet LAN switch and a wireless LAN AP. To allow communication between floors, each per-floor switch connects to one centralized distribution switch.|На каждом этаже есть коммутатор локальной сети Ethernet и точка доступа беспроводной локальной сети. Для обеспечения связи между этажами каждый этажный коммутатор подключается к одному централизованному распределительному коммутатору.
For example, PC3 can send data to PC2, but it would first flow through switch SW3 to the first floor to the distribution switch (SWD) and then back up through switch SW2 on the second floor.|Например, ПК3 может отправлять данные на ПК2, но сначала они будут проходить через переключатель SW3 на первый этаж к распределительному переключателю (SWD), а затем обратно через переключатель SW2 на втором этаже.
|
Figure 2-3 Single-Building Enterprise Wired and Wireless LAN Answers to the “Do I Know This Already?” quiz:|Рис. 2-3. Проводная и беспроводная локальная сеть в одном здании. Ответы на вопрос «Знаю ли я это уже?» викторина:
|
1 A 2 C 3 B 4 B, D, and E 5 B 6 B 7 C 8 B, C, and E 9 C and D The figure also shows the typical way to connect a LAN to a WAN using a router.|1 A 2 C 3 B 4 B, D и E 5 B 6 B 7 C 8 B, C и E 9 C и D На рисунке также показан типичный способ подключения LAN к WAN с помощью маршрутизатора.
LAN switches and wireless access points work to create the LAN itself.|Коммутаторы LAN и точки беспроводного доступа создают саму LAN.
Routers connect to both the LAN and the WAN. To connect to the LAN, the router simply uses an Ethernet LAN interface and an Ethernet cable, as shown on the lower right of Figure 2-3.|Маршрутизаторы подключаются как к локальной, так и к глобальной сети. Для подключения к локальной сети маршрутизатор просто использует интерфейс локальной сети Ethernet и кабель Ethernet, как показано в правом нижнем углу рисунка 2-3.
|
The rest of this chapter focuses on Ethernet in particular.|Остальная часть этой главы посвящена, в частности, Ethernet.
#### The Variety of Ethernet Physical Layer Standards
Разнообразие стандартов физического уровня Ethernet   
__|__
--|--
|
The term Ethernet refers to an entire family of standards.|Термин Ethernet относится к целому семейству стандартов.
Some standards define the specifics of how to send data over a particular type of cabling, and at a particular speed.|Некоторые стандарты определяют особенности передачи данных по определенному типу кабеля и с определенной скоростью.
Other standards define protocols, or rules, that the Ethernet nodes must follow to be a part of an Ethernet LAN. All these Ethernet standards come from the IEEE and include the number 802.3 as the beginning part of the standard name.|Другие стандарты определяют протоколы или правила, которым должны следовать узлы Ethernet, чтобы стать частью локальной сети Ethernet. Все эти стандарты Ethernet исходят от IEEE и включают номер 802.3 в начале названия стандарта.
|
Ethernet supports a large variety of options for physical Ethernet links given its long history over the last 40 or so years.|Ethernet поддерживает большое количество вариантов физических каналов Ethernet, учитывая его долгую историю за последние 40 лет или около того.
Today, Ethernet includes many standards for different kinds of optical and copper cabling, and for speeds from 10 megabits per second (Mbps) up to 400 gigabits per second (Gbps).|Сегодня Ethernet включает множество стандартов для различных типов оптических и медных кабелей, а также для скоростей от 10 мегабит в секунду (Мбит / с) до 400 гигабит в секунду (Гбит / с).
The standards also differ as far as the types and length of the cables.|Стандарты также различаются по типам и длине кабелей.
|
The most fundamental cabling choice has to do with the materials used inside the cable for the physical transmission of bits: either copper wires or glass fibers.|Самый важный выбор кабеля связан с материалами, используемыми внутри кабеля для физической передачи битов: либо медные провода, либо стеклянные волокна.
Devices using UTP cabling transmit data over electrical circuits via the copper wires inside the cable.|Устройства, использующие кабели UTP, передают данные по электрическим цепям через медные провода внутри кабеля.
Fiber-optic cabling, the more expensive alternative, allows Ethernet nodes to send light over glass fibers in the center of the cable.|Оптоволоконный кабель, более дорогая альтернатива, позволяет узлам Ethernet передавать свет по стеклянным волокнам в центре кабеля.
Although more expensive, optical cables typically allow longer cabling distances between nodes.|Хотя оптические кабели более дорогие, они обычно позволяют прокладывать большие расстояния между узлами.
|
To be ready to choose the products to purchase for a new Ethernet LAN, a network engineer must know the names and features of the different Ethernet standards supported in Ethernet products.|Чтобы быть готовым выбрать продукты для покупки для новой локальной сети Ethernet, сетевой инженер должен знать названия и особенности различных стандартов Ethernet, поддерживаемых в продуктах Ethernet.
The IEEE defines Ethernet physical layer standards using a couple of naming conventions.|IEEE определяет стандарты физического уровня Ethernet, используя несколько соглашений об именах.
|
The formal name begins with 802.3 followed by some suffix letters.|Официальное имя начинается с 802.3, за которым следуют несколько букв суффикса.
The IEEE also uses more meaningful shortcut names that identify the speed, as well as a clue about whether the cabling is UTP (with a suffix that includes T) or fiber (with a suffix that includes X).|IEEE также использует более понятные имена, определяющие скорость, а также подсказку о том, является ли проводка UTP (с суффиксом, включающим T) или оптоволоконным (с суффиксом, включающим X).
|
Table 2-2 lists a few Ethernet physical layer standards.|В таблице 2-2 перечислены несколько стандартов физического уровня Ethernet.
First, the table lists enough names so that you get a sense of the IEEE naming conventions.|Во-первых, в таблице перечислено достаточно имен, чтобы вы могли понять соглашения об именах IEEE.
|
Table 2-2 Examples of Types of Ethernet Table end.|Таблица 2-2 Примеры типов конца таблицы Ethernet.
|
NOTE Fiber-optic cabling contains long thin strands of fiberglass.|ПРИМЕЧАНИЕ. Волоконно-оптические кабели содержат длинные тонкие жилы из стекловолокна.
The attached Ethernet nodes send light over the glass fiber in the cable, encoding the bits as changes in the light.|Подключенные узлы Ethernet посылают свет по стекловолокну в кабеле, кодируя биты как изменения света.
|
NOTE You might expect that a standard that began at the IEEE almost 40 years ago would be stable and unchanging, but the opposite is true.|ПРИМЕЧАНИЕ. Можно было ожидать, что стандарт, появившийся в IEEE почти 40 лет назад, будет стабильным и неизменным, но верно обратное.
The IEEE, along with active industry partners, continues to develop new Ethernet standards with longer distances, different cabling options, and faster speeds.|IEEE вместе с активными отраслевыми партнерами продолжает разрабатывать новые стандарты Ethernet с более длинными расстояниями, различными вариантами кабелей и более высокими скоростями.
Check out the Ethernet Alliance web page (www.EthernetAlliance.org) and look for the roadmap for some great graphics and tables about the latest happenings with Ethernet.|Посетите веб-страницу Ethernet Alliance (www.EthernetAlliance.org) и поищите дорожную карту с отличными графиками и таблицами о последних событиях в области Ethernet.
#### Consistent Behavior over All Links Using the Ethernet Data-Link Layer
Согласованное поведение по всем каналам с использованием уровня канала передачи данных Ethernet   
__|__
--|--
|
Although Ethernet includes many physical layer standards, Ethernet acts like a single LAN technology because it uses the same data-link layer standard over all types of Ethernet physical links.|Хотя Ethernet включает в себя множество стандартов физического уровня, Ethernet действует как технология единой локальной сети, поскольку использует один и тот же стандарт уровня канала передачи данных для всех типов физических каналов Ethernet.
That standard defines a common Ethernet header and trailer. (As a reminder, the header and trailer are bytes of overhead data that Ethernet uses to do its job of sending data over a LAN.) No matter whether the data flows over a UTP cable or any kind of fiber cable, and no matter the speed, the data-link header and trailer use the same format.|Этот стандарт определяет общий заголовок и трейлер Ethernet. (Напоминаем, что заголовок и трейлер представляют собой байты служебных данных, которые Ethernet использует для выполнения своей работы по отправке данных по локальной сети.) Независимо от того, передаются ли данные по кабелю UTP или любому типу оптоволоконного кабеля, и speed, заголовок и трейлер канала передачи данных используют один и тот же формат.
|
While the physical layer standards focus on sending bits over a cable, the Ethernet data-link protocols focus on sending an Ethernet frame from source to destination Ethernet node.|В то время как стандарты физического уровня сосредоточены на отправке битов по кабелю, протоколы передачи данных Ethernet сосредоточены на отправке кадра Ethernet от источника к узлу Ethernet назначения.
|
From a data-link perspective, nodes build and forward frames.|С точки зрения канала передачи данных узлы создают и пересылают кадры.
As first defined in Chapter 1, “Introduction to TCP/IP Networking,” the term frame specifically refers to the header and trailer of a data-link protocol, plus the data encapsulated inside that header and trailer.|Как впервые было определено в главе 1 «Введение в сеть TCP / IP», термин «фрейм» конкретно относится к заголовку и завершению протокола канала передачи данных, а также к данным, инкапсулированным внутри этого заголовка и конечного элемента.
The various Ethernet nodes simply forward the frame, over all the required links, to deliver the frame to the correct destination.|Различные узлы Ethernet просто пересылают кадр по всем необходимым каналам, чтобы доставить кадр в нужное место назначения.
|
Figure 2-4 shows an example of the process.|На рис. 2-4 показан пример процесса.
In this case, PC1 sends an Ethernet frame to PC3. The frame travels over a UTP link to Ethernet switch SW1, then over fiber links to Ethernet switches SW2 and SW3, and finally over another UTP link to PC3. Note that the bits actually travel at four different speeds in this example: 10 Mbps, 1 Gbps, 10 Gbps, and 100 Mbps, respectively.|В этом случае ПК1 отправляет кадр Ethernet на ПК3. Кадр передается по каналу UTP к коммутатору Ethernet SW1, затем по оптоволоконным каналам к коммутаторам Ethernet SW2 и SW3 и, наконец, по другому каналу UTP к ПК3. Обратите внимание, что в этом примере биты фактически передаются с четырьмя разными скоростями: 10 Мбит / с, 1 Гбит / с, 10 Гбит / с и 100 Мбит / с соответственно.
|
Figure 2-4 Ethernet LAN Forwards a Data-Link Frame over Many Types of Links So, what is an Ethernet LAN? It is a combination of user devices, LAN switches, and different kinds of cabling.|Рисунок 2-4 Ethernet LAN пересылает кадр канала данных по многим типам каналов Итак, что такое локальная сеть Ethernet? Это комбинация пользовательских устройств, коммутаторов LAN и различных типов кабелей.
Each link can use different types of cables, at different speeds.|Каждое соединение может использовать разные типы кабелей с разной скоростью.
|
However, they all work together to deliver Ethernet frames from the one device on the LAN to some other device.|Однако все они работают вместе, чтобы доставлять кадры Ethernet от одного устройства в локальной сети к другому устройству.
|
The rest of this chapter takes these concepts a little deeper.|В оставшейся части этой главы эти концепции рассматриваются немного глубже.
The next section examines how to build a physical Ethernet network using UTP cabling, followed by a similar look at using fiber cabling to build Ethernet LANs. The chapter ends with some discussion of the rules for forwarding frames through an Ethernet LAN.|В следующем разделе исследуется, как построить физическую сеть Ethernet с использованием кабеля UTP, а затем аналогичным образом рассматривается использование оптоволоконного кабеля для построения локальных сетей Ethernet. Глава заканчивается обсуждением правил пересылки кадров через локальную сеть Ethernet.
### Building Physical Ethernet LANs with UTP
Создание физических локальных сетей Ethernet с UTP   
__|__
--|--
|
The next section of this chapter focuses on the individual physical links between any two Ethernet nodes, specifically those that use Unshielded Twisted Pair (UTP) cabling.|Следующий раздел этой главы посвящен отдельным физическим каналам между любыми двумя узлами Ethernet, особенно тем, которые используют кабели с неэкранированной витой парой (UTP).
Before the Ethernet network as a whole can send Ethernet frames between user devices, each node must be ready and able to send data over an individual physical link.|Прежде чем сеть Ethernet в целом сможет отправлять кадры Ethernet между пользовательскими устройствами, каждый узел должен быть готов и способен отправлять данные по отдельному физическому каналу.
|
This section focuses on the three most commonly used Ethernet standards: 10BASE-T (Ethernet), 100BASE-T (Fast Ethernet, or FE), and 1000BASE-T (Gigabit Ethernet, or GE).|В этом разделе рассматриваются три наиболее часто используемых стандарта Ethernet: 10BASE-T (Ethernet), 100BASE-T (Fast Ethernet или FE) и 1000BASE-T (Gigabit Ethernet или GE).
|
Specifically, this section looks at the details of sending data in both directions over a UTP cable.|В частности, в этом разделе рассматриваются детали отправки данных в обоих направлениях по кабелю UTP.
It then examines the specific wiring of the UTP cables used for 10-Mbps, 100-Mbps, and 1000-Mbps Ethernet.|Затем он исследует конкретную проводку кабелей UTP, используемых для 10-Мбит / с, 100-Мбит / с и 1000-Мбит / с Ethernet.
#### Transmitting Data Using Twisted Pairs
Передача данных с использованием витой пары   
__|__
--|--
|
While it is true that Ethernet sends data over UTP cables, the physical means to send the data uses electricity that flows over the wires inside the UTP cable.|Хотя это правда, что Ethernet отправляет данные по кабелям UTP, физические средства передачи данных используют электричество, которое течет по проводам внутри кабеля UTP.
To better understand how Ethernet sends data using electricity, break the idea down into two parts: how to create an electrical circuit and then how to make that electrical signal communicate 1s and 0s.|Чтобы лучше понять, как Ethernet передает данные, используя электричество, разделите идею на две части: как создать электрическую цепь, а затем как заставить этот электрический сигнал передавать единицы и нули.
|
First, to create one electrical circuit, Ethernet defines how to use the two wires inside a single twisted pair of wires, as shown in Figure 2-5.|Во-первых, для создания одной электрической цепи Ethernet определяет, как использовать два провода внутри одной витой пары проводов, как показано на рис. 2-5.
The figure does not show a UTP cable between two nodes, but instead shows two individual wires that are inside the UTP cable.|На рисунке не показан кабель UTP между двумя узлами, а показаны два отдельных провода, которые находятся внутри кабеля UTP.
|
An electrical circuit requires a complete loop, so the two nodes, using circuitry on their Ethernet ports, connect the wires in one pair to complete a loop, allowing electricity to flow.|Для электрической цепи требуется замкнутая петля, поэтому два узла, используя схемы на своих портах Ethernet, соединяют провода в одну пару, образуя петлю, позволяющую течь электричеству.
|
Figure 2-5 Creating One Electrical Circuit over One Pair to Send in One Direction To send data, the two devices follow some rules called an encoding scheme.|Рисунок 2-5. Создание одной электрической цепи по одной паре для отправки в одном направлении. Для отправки данных два устройства следуют некоторым правилам, называемым схемой кодирования.
The idea works a lot like when two people talk using the same language: The speaker says some words in a particular language, and the listener, because she speaks the same language, can understand the spoken words.|Идея во многом срабатывает, когда два человека говорят на одном языке: говорящий произносит несколько слов на определенном языке, а слушатель, поскольку он говорит на одном языке, может понимать произносимые слова.
With an encoding scheme, the transmitting node changes the electrical signal over time, while the other node, the receiver, using the same rules, interprets those changes as either 0s or 1s. (For example, 10BASE-T uses an encoding scheme that encodes a binary 0 as a transition from higher voltage to lower voltage during the middle of a 1/10,000,000th-of-a-second interval.)|При использовании схемы кодирования передающий узел изменяет электрический сигнал с течением времени, в то время как другой узел, приемник, используя те же правила, интерпретирует эти изменения как 0 или 1. (Например, 10BASE-T использует схему кодирования, которая кодирует двоичный 0 как переход от более высокого напряжения к более низкому напряжению в середине интервала 1/10 000 000-й секунды.)
|
Note that in an actual UTP cable, the wires will be twisted together, instead of being parallel as shown in Figure 2-5.|Обратите внимание, что в реальном кабеле UTP провода будут скручены вместе, а не параллельны, как показано на Рисунке 2-5.
The twisting helps solve some important physical transmission issues.|Скручивание помогает решить некоторые важные проблемы физической передачи.
When electrical current passes over any wire, it creates electromagnetic interference (EMI) that interferes with the electrical signals in nearby wires, including the wires in the same cable. (EMI between wire pairs in the same cable is called crosstalk.) Twisting the wire pairs together helps cancel out most of the EMI, so most networking physical links that use copper wires use twisted pairs.|Когда электрический ток проходит по любому проводу, он создает электромагнитные помехи (EMI), которые мешают электрическим сигналам в соседних проводах, включая провода в том же кабеле. (Электромагнитные помехи между парами проводов в одном кабеле называются перекрестными помехами.) Скручивание пар проводов вместе помогает нейтрализовать большую часть электромагнитных помех, поэтому в большинстве сетевых физических соединений, в которых используются медные провода, используются витые пары.
#### Breaking Down a UTP Ethernet Link
Разрыв соединения UTP Ethernet   
__|__
--|--
|
The term Ethernet link refers to any physical cable between two Ethernet nodes.|Термин «канал Ethernet» относится к любому физическому кабелю между двумя узлами Ethernet.
To learn about how a UTP Ethernet link works, it helps to break down the physical link into those basic pieces, as shown in Figure 2-6: the cable itself, the connectors on the ends of the cable, and the matching ports on the devices into which the connectors will be inserted.|Чтобы узнать, как работает канал Ethernet UTP, можно разбить физический канал на эти основные части, как показано на рис. 2-6: сам кабель, разъемы на концах кабеля и соответствующие порты на устройства, в которые будут вставляться разъемы.
|
Figure 2-6 Basic Components of an Ethernet Link First, think about the UTP cable itself.|Рисунок 2-6 Основные компоненты канала Ethernet Сначала подумайте о самом кабеле UTP.
The cable holds some copper wires, grouped as twisted pairs.|Кабель содержит несколько медных проводов, сгруппированных в виде витых пар.
The 10BASE-T and 100BASE-T standards require two pairs of wires, while the 1000BASE-T standard requires four pairs.|Стандарты 10BASE-T и 100BASE-T требуют двух пар проводов, а стандарт 1000BASE-T требует четырех пар.
Each wire has a color-coded plastic coating, with the wires in a pair having a color scheme.|Каждый провод имеет пластиковое покрытие с цветовой кодировкой, при этом пары проводов имеют цветовую схему.
For example, for the blue wire pair, one wire’s coating is all blue, while the other wire’s coating is blue-and-white striped.|Например, для синей пары проводов покрытие одного провода полностью синее, а покрытие другого провода - сине-белыми полосами.
|
Many Ethernet UTP cables use an RJ-45 connector on both ends.|Многие кабели Ethernet UTP используют разъем RJ-45 на обоих концах.
The RJ-45 connector has eight physical locations into which the eight wires in the cable can be inserted, called pin positions, or simply pins.|Разъем RJ-45 имеет восемь физических мест, в которые можно вставить восемь проводов кабеля, которые называются позициями контактов или просто контактами.
These pins create a place where the ends of the copper wires can touch the electronics inside the nodes at the end of the physical link so that electricity can flow.|Эти контакты создают место, где концы медных проводов могут соприкасаться с электроникой внутри узлов в конце физического соединения, так что электричество может течь.
|
NOTE If available, find a nearby Ethernet UTP cable and examine the connectors closely.|ПРИМЕЧАНИЕ. Если возможно, найдите ближайший кабель Ethernet UTP и внимательно осмотрите разъемы.
|
Look for the pin positions and the colors of the wires in the connector.|Обратите внимание на расположение контактов и цвета проводов в разъеме.
|
To complete the physical link, the nodes each need an RJ-45 Ethernet port that matches the RJ-45 connectors on the cable so that the connectors on the ends of the cable can connect to each node.|Для завершения физического соединения каждому узлу необходим порт Ethernet RJ-45, который соответствует разъемам RJ-45 на кабеле, чтобы разъемы на концах кабеля могли подключаться к каждому узлу.
PCs often include this RJ-45 Ethernet port as part of a network interface card (NIC), which can be an expansion card on the PC or can be built in to the system itself.|ПК часто включают этот порт Ethernet RJ-45 как часть сетевой карты (NIC), которая может быть картой расширения на ПК или может быть встроена в саму систему.
|
Switches typically have many RJ-45 ports because switches give user devices a place to connect to the Ethernet LAN. Figure 2-7 shows photos of the cables, connectors, and ports.|Коммутаторы обычно имеют много портов RJ-45, потому что коммутаторы предоставляют пользовательским устройствам место для подключения к локальной сети Ethernet. На Рис. 2-7 показаны фотографии кабелей, разъемов и портов.
|
Figure 2-7 RJ-45 Connectors and Ports (Ethernet NIC © Oleg Begunenko/123RF, RJ-45 Connector © Anton Samsonov/123RF)|Рисунок 2-7 Разъемы и порты RJ-45 (Ethernet NIC © Олег Бегуненко / 123RF, разъем RJ-45 © Антон Самсонов / 123RF)
|
The figure shows a connector on the left and ports on the right.|На рисунке слева показан разъем, а справа - порты.
The left shows the eight pin positions in the end of the RJ-45 connector.|Слева показаны восемь позиций контактов на конце разъема RJ-45.
The upper right shows an Ethernet NIC that is not yet installed in a computer.|В правом верхнем углу показана сетевая карта Ethernet, которая еще не установлена ​​на компьютере.
The lower-right part of the figure shows the side of a Cisco switch, with multiple RJ-45 ports, allowing multiple devices to easily connect to the Ethernet network.|В нижней правой части рисунка показана сторона коммутатора Cisco с несколькими портами RJ-45, что позволяет нескольким устройствам легко подключаться к сети Ethernet.
|
Finally, while RJ-45 connectors with UTP cabling can be common, Cisco LAN switches often support other types of connectors as well.|Наконец, хотя разъемы RJ-45 с кабелями UTP могут быть обычным явлением, коммутаторы Cisco LAN часто поддерживают и другие типы разъемов.
When you buy one of the many models of Cisco switches, you need to think about the mix and numbers of each type of physical ports you want on the switch.|Когда вы покупаете одну из множества моделей коммутаторов Cisco, вам необходимо подумать о сочетании и количестве физических портов каждого типа, которые вы хотите использовать в коммутаторе.
|
To give its customers flexibility as to the type of Ethernet links, even after the customer has bought the switch, Cisco switches include some physical ports whose port hardware (the transceiver) can be changed later, after you purchase the switch.|Чтобы предоставить своим клиентам гибкость в отношении типа каналов Ethernet, даже после того, как заказчик купил коммутатор, коммутаторы Cisco включают некоторые физические порты, оборудование портов которых (приемопередатчик) может быть изменено позже, после покупки коммутатора.
|
For example, Figure 2-8 shows a photo of a Cisco switch with one of the swappable transceivers.|Например, на рис. 2-8 показана фотография коммутатора Cisco с одним из заменяемых трансиверов.
|
In this case, the figure shows an enhanced small form-factor pluggable (SFP+) transceiver, which runs at 10 Gbps, just outside two SFP+ slots on a Cisco 3560CX switch.|В этом случае на рисунке показан расширенный съемный приемопередатчик малого форм-фактора (SFP +), который работает на скорости 10 Гбит / с, сразу за двумя слотами SFP + на коммутаторе Cisco 3560CX.
The SFP+ itself is the silver-colored part below the switch, with a black cable connected to it.|Сам SFP + представляет собой серебристую часть под коммутатором, к которой подключен черный кабель.
|
Cable SFP+|Кабель SFP +
|
Figure 2-8 10-Gbps SFP+ with Cable Sitting Just Outside a Catalyst 3560CX Switch Gigabit Ethernet Interface Converter (GBIC): The original form factor for a removable transceiver for Gigabit interfaces; larger than SFPs Small Form Pluggable (SFP): The replacement for GBICs, used on Gigabit interfaces, with a smaller size, taking less space on the side of the networking card or switch.|Рисунок 2-8 10-Гбит / с SFP + с кабелем, проложенным непосредственно за пределами коммутатора Catalyst 3560CX Преобразователь интерфейса Gigabit Ethernet (GBIC): исходный форм-фактор съемного трансивера для интерфейсов Gigabit Ethernet; больше, чем SFP Small Form Pluggable (SFP): замена GBIC, используемых на гигабитных интерфейсах, с меньшим размером, занимающим меньше места на стороне сетевой карты или коммутатора.
|
Small Form Pluggable Plus (SFP+): Same size as the SFP, but used on 10-Gbps interfaces.|Small Form Pluggable Plus (SFP +): тот же размер, что и SFP, но используется на интерфейсах 10 Гбит / с.
|
(The Plus refers to the increase in speed compared to SFPs.)|(Плюс означает увеличение скорости по сравнению с SFP.)
#### UTP Cabling Pinouts for 10BASE-T and 100BASE-T
Выводы кабелей UTP для 10BASE-T и 100BASE-T   
__|__
--|--
|
So far in this section, you have learned about the equivalent of how to drive a truck on a 1000-acre ranch: You could drive the truck all over the ranch, any place you wanted to go, and the police would not mind.|До сих пор в этом разделе вы узнали о том, как водить грузовик на ранчо площадью 1000 акров: вы можете проехать на грузовике по всему ранчо, в любое место, куда хотите, и полиция не будет возражать.
However, as soon as you get on the public roads, the police want you to behave and follow the rules.|Однако, как только вы выезжаете на дорогу общего пользования, полиция требует, чтобы вы вели себя хорошо и соблюдали правила.
Similarly, so far this chapter has discussed the general principles of how to send data, but it has not yet detailed some important rules for Ethernet cabling: the rules of the road so that all the devices send data using the right wires inside the cable.|Точно так же до сих пор в этой главе обсуждались общие принципы отправки данных, но еще не были подробно описаны некоторые важные правила для кабельной разводки Ethernet: правила дорожного движения, согласно которым все устройства отправляют данные, используя правильные провода внутри кабеля.
|
This next topic discusses some of those rules, specifically for the 10-Mbps 10BASE-T and the 100-Mbps 100BASE-T.|В следующем разделе обсуждаются некоторые из этих правил, особенно для 10BASE-T со скоростью 10 Мбит / с и 100BASE-T со скоростью 100 Мбит / с.
Both use UTP cabling in similar ways (including the use of only two wire pairs).|Оба используют кабели UTP аналогичным образом (включая использование только двух пар проводов).
A short comparison of the wiring for 1000BASE-T (Gigabit Ethernet), which uses four pairs, follows.|Ниже приводится краткое сравнение проводки 1000BASE-T (Gigabit Ethernet), в которой используются четыре пары.
##### Straight-Through Cable Pinout
Распиновка прямого кабеля   
__|__
--|--
|
10BASE-T and 100BASE-T use two pairs of wires in a UTP cable, one for each direction, as shown in Figure 2-9.|10BASE-T и 100BASE-T используют две пары проводов в кабеле UTP, по одной для каждого направления, как показано на Рисунке 2-9.
The figure shows four wires, all of which sit inside a single UTP cable that connects a PC and a LAN switch.|На рисунке показаны четыре провода, каждый из которых проложен внутри одного кабеля UTP, соединяющего ПК и коммутатор LAN.
In this example, the PC on the left transmits using the top pair, and the switch on the right transmits using the bottom pair.|В этом примере ПК слева передает с использованием верхней пары, а переключатель справа передает с использованием нижней пары.
|
Figure 2-9 Using One Pair for Each Transmission Direction with 10- and 100-Mbps Ethernet For correct transmission over the link, the wires in the UTP cable must be connected to the correct pin positions in the RJ-45 connectors.|Рисунок 2-9 Использование одной пары для каждого направления передачи с Ethernet 10 и 100 Мбит / с. Для правильной передачи по каналу провода кабеля UTP должны быть подключены к правильным позициям контактов в разъемах RJ-45.
For example, in Figure 2-9, the transmitter on the PC on the left must know the pin positions of the two wires it should use to transmit.|Например, на рис. 2-9 передатчик на ПК слева должен знать положения контактов двух проводов, которые он должен использовать для передачи.
|
Those two wires must be connected to the correct pins in the RJ-45 connector on the switch so that the switch’s receiver logic can use the correct wires.|Эти два провода должны быть подключены к правильным контактам в разъеме RJ-45 на коммутаторе, чтобы логика приемника коммутатора могла использовать правильные провода.
|
To understand the wiring of the cable—which wires need to be in which pin positions on both ends of the cable—you need to first understand how the NICs and switches work.|Чтобы понять проводку кабеля - какие провода должны быть в каких положениях контактов на обоих концах кабеля - вам нужно сначала понять, как работают сетевые адаптеры и коммутаторы.
As a rule, Ethernet NIC transmitters use the pair connected to pins 1 and 2; the NIC receivers use a pair of wires at pin positions 3 and 6.|Как правило, передатчики Ethernet NIC используют пару, подключенную к контактам 1 и 2; приемники NIC используют пару проводов с контактами 3 и 6.
LAN switches, knowing those facts about what Ethernet NICs do, do the opposite: Their receivers use the wire pair at pins 1 and 2, and their transmitters use the wire pair at pins 3 and 6.|Коммутаторы LAN, зная эти факты о том, что делают сетевые адаптеры Ethernet, поступают наоборот: их приемники используют пару проводов на контактах 1 и 2, а их передатчики используют пару проводов на контактах 3 и 6.
|
To allow a PC NIC to communicate with a switch, the UTP cable must also use a straightthrough cable pinout.|Чтобы сетевой адаптер ПК мог обмениваться данными с коммутатором, в кабеле UTP также должна использоваться прямая разводка выводов кабеля.
The term pinout refers to the wiring of which color wire is placed in each of the eight numbered pin positions in the RJ-45 connector.|Термин «распиновка» относится к разводке, цветной провод которой помещается в каждую из восьми пронумерованных позиций контактов в разъеме RJ-45.
An Ethernet straightthrough cable connects the wire at pin 1 on one end of the cable to pin 1 at the other end of the cable; the wire at pin 2 needs to connect to pin 2 on the other end of the cable; pin 3 on one end connects to pin 3 on the other, and so on, as seen in Figure 2-10.|Прямой кабель Ethernet соединяет провод на контакте 1 на одном конце кабеля с контактом 1 на другом конце кабеля; провод на контакте 2 необходимо подключить к контакту 2 на другом конце кабеля; контакт 3 на одном конце соединяется с контактом 3 на другом и так далее, как показано на рисунке 2-10.
Also, it uses the wires in one wire pair at pins 1 and 2, and another pair at pins 3 and 6.|Кроме того, он использует провода одной пары проводов на выводах 1 и 2, а другой пары - на выводах 3 и 6.
|
Ports 1 2 3 4 5 6 7 8 1 2 3 4 5 6 7 8 1 2 3 4 5 6 7 8 1 2 3 4 5 6 7 8 Connectors Figure 2-10 10BASE-T and 100BASE-T Straight-Through Cable Pinout Figure 2-11 shows one final perspective on the straight-through cable pinout.|Порты 1 2 3 4 5 6 7 8 1 2 3 4 5 6 7 8 1 2 3 4 5 6 7 8 1 2 3 4 5 6 7 8 Разъемы Рисунок 2-10 Схема контактов прямого кабеля 10BASE-T и 100BASE-T На Рис. 2-11 показан последний вид распиновки прямого кабеля.
In this case, PC Larry connects to a LAN switch.|В этом случае ПК Ларри подключается к коммутатору локальной сети.
Note that the figure again does not show the UTP cable, but instead shows the wires that sit inside the cable, to emphasize the idea of wire pairs and pins.|Обратите внимание, что на рисунке снова не показан кабель UTP, а вместо этого показаны провода, которые находятся внутри кабеля, чтобы подчеркнуть идею пар проводов и контактов.
|
Figure 2-11 Ethernet Straight-Through Cable Concept A straight-through cable works correctly when the nodes use opposite pairs for transmitting data.|Рисунок 2-11 Концепция прямого кабеля Ethernet Прямой кабель работает правильно, когда узлы используют противоположные пары для передачи данных.
However, when two like devices connect to an Ethernet link, they both transmit on the same pins.|Однако, когда два одинаковых устройства подключаются к каналу Ethernet, они оба передают данные на одних и тех же контактах.
In that case, you then need another type of cabling pinout called a crossover cable.|В этом случае вам понадобится другой тип разводки выводов, называемый перекрестным кабелем.
The crossover cable pinout crosses the pair at the transmit pins on each device to the receive pins on the opposite device.|Распиновка перекрестного кабеля пересекает пару выводов передачи на каждом устройстве с выводами приема на противоположном устройстве.
|
While that previous sentence is true, this concept is much clearer with a figure such as Figure 2-12.|Несмотря на то, что предыдущее предложение верно, эта концепция намного яснее с фигурами, такими как рис. 2-12.
The figure shows what happens on a link between two switches.|На рисунке показано, что происходит при соединении двух коммутаторов.
The two switches both transmit on the pair at pins 3 and 6, and they both receive on the pair at pins 1 and 2.|Оба переключателя передают данные по паре на контакты 3 и 6, и оба получают сигнал на паре на контактах 1 и 2.
|
So, the cable must connect a pair at pins 3 and 6 on each side to pins 1 and 2 on the other side, connecting to the other node’s receiver logic.|Таким образом, кабель должен соединить пару контактов 3 и 6 на каждой стороне с контактами 1 и 2 на другой стороне, подключаясь к логике приемника другого узла.
The top of the figure shows the literal pinouts, and the bottom half shows a conceptual diagram.|Вверху рисунка показаны буквальные распиновки, а в нижней половине - концептуальная схема.
|
Figure 2-12 Crossover Ethernet Cable|Рисунок 2-12 Перекрестный кабель Ethernet
##### Choosing the Right Cable Pinouts
Выбор правильных выводов кабеля   
__|__
--|--
|
For the exam, you should be well prepared to choose which type of cable (straight-through or crossover) is needed in each part of the network.|К экзамену вы должны быть хорошо подготовлены к тому, чтобы выбрать, какой тип кабеля (прямой или перекрестный) необходим в каждой части сети.
The key is to know whether a device acts like a PC NIC, transmitting at pins 1 and 2, or like a switch, transmitting at pins 3 and 6.|Ключ в том, чтобы знать, действует ли устройство как сетевая карта ПК, передавая сигналы на выводах 1 и 2, или как переключатель, передавая сигналы на выводах 3 и 6.
|
Then, just apply the following logic:|Затем просто примените следующую логику:
|
Crossover cable: If the endpoints transmit on the same pin pair Straight-through cable: If the endpoints transmit on different pin pairs Table 2-3 lists the devices and the pin pairs they use, assuming that they use 10BASE-T and 100BASE-T.|Перекрестный кабель: если конечные точки осуществляют передачу по одной и той же паре контактов. Прямой кабель: если конечные точки осуществляют передачу на разных парах контактов. В таблице 2-3 перечислены устройства и пары контактов, которые они используют, при условии, что они используют 10BASE-T и 100BASE-T .
|
Table 2-3 A 10BASE-T and 100BASE-T Pin Pairs Used Table end.|Таблица 2-3 Используемые пары контактов 10BASE-T и 100BASE-T Конец таблицы.
|
For example, Figure 2-13 shows a campus LAN in a single building.|Например, на рис. 2-13 показана локальная сеть кампуса в одном здании.
In this case, several straight-through cables are used to connect PCs to switches.|В этом случае для подключения ПК к коммутаторам используется несколько прямых кабелей.
In addition, the cables connecting the switches require crossover cables.|Кроме того, для кабелей, соединяющих коммутаторы, требуются перекрестные кабели.
|
Figure 2-13 Typical Uses for Straight-Through and Crossover Ethernet Cables NOTE If you have some experience with installing LANs, you might be thinking that you have used the wrong cable before (straight-through or crossover), but the cable worked.|Рис. 2-13 Типичное использование прямых и перекрестных кабелей Ethernet ПРИМЕЧАНИЕ Если у вас есть опыт установки локальных сетей, вы можете подумать, что раньше использовали неправильный кабель (прямой или перекрестный), но кабель работал.
|
Cisco switches have a feature called auto-mdix that notices when the wrong cable is used and automatically changes its logic to make the link work.|Коммутаторы Cisco имеют функцию auto-mdix, которая замечает, когда используется неправильный кабель, и автоматически изменяет свою логику, чтобы соединение работало.
However, for the exams, be ready to identify whether the correct cable is shown in the figures.|Однако перед экзаменом будьте готовы определить, правильный ли кабель показан на рисунках.
#### UTP Cabling Pinouts for 1000BASE-T
Выводы кабелей UTP для 1000BASE-T   
__|__
--|--
|
1000BASE-T (Gigabit Ethernet) differs from 10BASE-T and 100BASE-T as far as the cabling and pinouts.|1000BASE-T (Gigabit Ethernet) отличается от 10BASE-T и 100BASE-T кабельной разводкой и распиновкой.
First, 1000BASE-T requires four wire pairs.|Во-первых, для 1000BASE-T требуется четыре пары проводов.
Second, it uses more advanced electronics that allow both ends to transmit and receive simultaneously on each wire pair.|Во-вторых, он использует более совершенную электронику, которая позволяет обоим концам одновременно передавать и принимать по каждой паре проводов.
|
However, the wiring pinouts for 1000BASE-T work almost identically to the earlier standards, adding details for the additional two pairs.|Тем не менее, разводка выводов для 1000BASE-T работает почти так же, как и в более ранних стандартах, с добавлением деталей для дополнительных двух пар.
|
The straight-through cable for 1000BASE-T uses the four wire pairs to create four circuits, but the pins need to match.|Прямой кабель для 1000BASE-T использует четыре пары проводов для создания четырех цепей, но контакты должны совпадать.
It uses the same pinouts for two pairs as do the 10BASE-T and 100BASE-T standards, and it adds a pair at pins 4 and 5 and the final pair at pins 7 and 8, as shown in Figure 2-14.|Он использует те же выводы для двух пар, что и стандарты 10BASE-T и 100BASE-T, и добавляет пару к контактам 4 и 5 и последнюю пару к контактам 7 и 8, как показано на рисунке 2-14.
|
Figure 2-14 Four-Pair Straight-Through Cable to 1000BASE-T The Gigabit Ethernet crossover cable crosses the same two-wire pairs as the crossover cable for the other types of Ethernet (the pairs at pins 1,2 and 3,6).|Рисунок 2-14 Четырехпарный прямой кабель для 1000BASE-T Перекрестный кабель Gigabit Ethernet пересекает те же двухпроводные пары, что и перекрестный кабель для других типов Ethernet (пары на контактах 1,2 и 3,6) .
It also crosses the two new pairs as well (the pair at pins 4,5 with the pair at pins 7,8).|Он также пересекает две новые пары (пара на контактах 4,5 с парой на контактах 7,8).
### Building Physical Ethernet LANs with Fiber
Создание физических локальных сетей Ethernet с использованием оптоволокна   
__|__
--|--
|
The capability of many UTP-based Ethernet standards to use a cable length up to 100 meters means that the majority of Ethernet cabling in an enterprise uses UTP cables.|Способность многих стандартов Ethernet на основе UTP использовать кабель длиной до 100 метров означает, что большинство кабелей Ethernet на предприятии используют кабели UTP.
The distance from an Ethernet switch to every endpoint on the floor of a building will likely be less than 100m.|Расстояние от коммутатора Ethernet до каждой конечной точки на этаже здания, вероятно, будет менее 100 м.
In some cases, however, an engineer might prefer to use fiber cabling for some links in an Ethernet LAN, first to reach greater distances, but for other reasons as well.|Однако в некоторых случаях инженер может предпочесть использовать оптоволоконные кабели для некоторых каналов в локальной сети Ethernet, сначала для достижения больших расстояний, но также и по другим причинам.
This next section examines a few of the tradeoffs after discussing the basics of how to transmit data over fiber cabling.|В следующем разделе рассматриваются некоторые компромиссы после обсуждения основ передачи данных по оптоволоконным кабелям.
#### Fiber Cabling Transmission Concepts
Концепции передачи по оптоволоконным кабелям   
__|__
--|--
|
Fiber-optic cabling uses glass as the medium through which light passes, varying that light over time to encode 0s and 1s.|В волоконно-оптических кабелях стекло используется в качестве среды, через которую проходит свет, изменяя этот свет с течением времени, чтобы кодировать нули и единицы.
It might seem strange at first to use glass given that most of us think of glass in windows.|Сначала может показаться странным использование стекла, учитывая, что большинство из нас думает о стекле в окнах.
Window glass is hard, unbending, and if you hit or bend it enough, the glass will probably shatter—all bad characteristics for a cabling material.|Оконное стекло твердое, негнущееся, и если вы сильно ударите или согнете его, оно, вероятно, разобьется - все это плохие характеристики для материала кабельной разводки.
|
Instead, fiber-optic cables use fiberglass, which allows a manufacturer to spin a long thin string (fiber) of flexible glass.|Вместо этого в волоконно-оптических кабелях используется стекловолокно, которое позволяет производителю прядать длинную тонкую нить (волокно) из гибкого стекла.
A fiber-optic cable holds the fiber in the middle of the cable, allowing the light to pass through the glass—which is a very important attribute for the purposes of sending data.|Волоконно-оптический кабель удерживает волокно в середине кабеля, позволяя свету проходить через стекло, что является очень важным атрибутом при передаче данных.
|
Although sending data through a glass fiber works well, the glass fiber by itself needs some help.|Хотя отправка данных через стекловолокно работает хорошо, стекловолокно само по себе требует некоторой помощи.
The glass could break, so the glass fiber needs some protection and strengthening.|Стекло может разбиться, поэтому стекловолокну необходимо защитить и укрепить.
|
Figure 2-15 shows a cutout with the components of a fiber cable for perspective.|На Рис. 2-15 показан разрез с компонентами оптоволоконного кабеля для обзора.
|
Figure 2-15 Components of a Fiber-Optic Cable The three outer layers of the cable protect the interior of the cable and make the cables easier to install and manage, while the inner cladding and core work together to create the environment to allow transmission of light over the cable.|Рисунок 2-15 Компоненты волоконно-оптического кабеля Три внешних слоя кабеля защищают внутреннюю часть кабеля и упрощают установку и управление кабелями, в то время как внутренняя оболочка и сердечник работают вместе, создавая среду, позволяющую передавать свет над кабелем.
A light source, called the optical transmitter, shines a light into the core.|Источник света, называемый оптическим передатчиком, направляет свет на сердечник.
Light can pass through the core; however, light reflects off the cladding back into the core.|Свет может проходить через сердцевину; однако свет отражается от оболочки обратно в сердцевину.
Figure 2-16 shows an example with a light emitting diode (LED) transmitter.|На рисунке 2-16 показан пример передатчика на светодиодах (LED).
You can see how the cladding reflects the light back into the core as it travels through the core.|Вы можете видеть, как оболочка отражает свет обратно в сердцевину, когда он проходит через сердцевину.
|
Figure 2-16 Transmission on Multimode Fiber with Internal Reflection The figure shows the normal operation of a multimode fiber, characterized by the fact that the cable allows for multiple angles (modes) of light waves entering the core.|Рисунок 2-16 Передача по многомодовому волокну с внутренним отражением На рисунке показана нормальная работа многомодового волокна, характеризующаяся тем, что кабель допускает попадание световых волн в сердцевину под разными углами (модами).
|
In contrast, single-mode fiber uses a smaller-diameter core, around one-fifth the diameter of common multimode cables (see Figure 2-17).|В отличие от этого, в одномодовом волокне используется сердцевина меньшего диаметра, примерно в пятую часть диаметра обычных многомодовых кабелей (см. Рисунок 2-17).
To transmit light into a much smaller core, a laser-based transmitter sends light at a single angle (hence the name single-mode).|Чтобы передать свет в ядро ​​гораздо меньшего размера, лазерный передатчик излучает свет под одним углом (отсюда и название - одномодовый).
|
Figure 2-17 Transmission on Single-Mode Fiber with Laser Transmitter Both multimode and single-mode cabling have important roles in Ethernet and meet different needs.|Рисунок 2-17 Передача по одномодовому оптоволокну с лазерным передатчиком Как многомодовые, так и одномодовые кабели играют важную роль в Ethernet и удовлетворяют различные потребности.
Multimode improves the maximum distances over UTP, and it uses less expensive transmitters as compared with single-mode.|Многомодовый улучшает максимальные расстояния по UTP и использует менее дорогие передатчики по сравнению с одномодовым.
Standards do vary; for instance, the standards for 10 Gigabit Ethernet over Fiber allow for distances up to 400m, which would often allow for connection of devices in different buildings in the same office park.|Стандарты действительно различаются; например, стандарты для 10 Gigabit Ethernet по оптоволокну допускают расстояния до 400 м, что часто позволяет подключать устройства в разных зданиях в одном офисном парке.
Single-mode allows distances into the tens of kilometers, but with slightly more expensive SFP/SFP+ hardware.|Одномодовый режим позволяет использовать расстояния до десятков километров, но с немного более дорогим оборудованием SFP / SFP +.
|
To transmit between two devices, you need two cables, one for each direction, as shown in Figure 2-18.|Для передачи между двумя устройствами вам понадобятся два кабеля, по одному для каждого направления, как показано на Рисунке 2-18.
The concept works much like having two electrical circuits with the original UTP Ethernet standards.|Эта концепция очень похожа на две электрические цепи с оригинальными стандартами UTP Ethernet.
Note that the transmit port on one device connects to a cable that connects to a receive port on the other device, and vice versa with the other cable.|Обратите внимание, что порт передачи на одном устройстве подключается к кабелю, который подключается к порту приема на другом устройстве, и наоборот, с другим кабелем.
|
Figure 2-18 Two Fiber Cables with Tx Connected to Rx on Each Cable|Рисунок 2-18 Два оптоволоконных кабеля с передатчиком, подключенным к приемнику на каждом кабеле
#### Using Fiber with Ethernet
Использование волокна с Ethernet   
__|__
--|--
|
To use fiber with Ethernet switches, you need to use a switch with either built-in ports that support a particular optical Ethernet standard, or a switch with modular ports that allow you to change the Ethernet standard used on the port.|Чтобы использовать оптоволокно с коммутаторами Ethernet, необходимо использовать коммутатор либо со встроенными портами, поддерживающими определенный оптический стандарт Ethernet, либо коммутатор с модульными портами, которые позволяют изменять стандарт Ethernet, используемый для порта.
Refer back to Figure 2-8, which shows a photo of a switch with two SFP+ ports, into which you could insert any of the supported SFP+ modules.|Вернитесь к рис. 2-8, на котором показана фотография коммутатора с двумя портами SFP +, в которые можно вставить любой из поддерживаемых модулей SFP +.
Those SFP+ ports support a variety of 10-Gbps standards like those listed in Table 2-4.|Эти порты SFP + поддерживают различные стандарты 10 Гбит / с, например, перечисленные в Таблице 2-4.
|
Table 2-4 A Sampling of IEEE 802.3 10-Gbps Fiber Standards Table end.|Таблица 2-4 Выборка стандартов волокна IEEE 802.3 10 Гбит / с Конец таблицы.
|
1 The maximum distances are based on the IEEE standards with no repeaters.|1 Максимальные расстояния основаны на стандартах IEEE без повторителей.
|
For instance, to build an Ethernet LAN in an office park, you might need to use some multimode and single-mode fiber links.|Например, для создания локальной сети Ethernet в офисном парке вам может потребоваться несколько многомодовых и одномодовых оптоволоконных линий.
In fact, many office parks might already have fiber cabling installed for the expected future use by the tenants in the buildings.|Фактически, во многих офисных парках уже могут быть проложены оптоволоконные кабели для предполагаемого использования в зданиях арендаторами в будущем.
If each building was within a few hundred meters of at least one other building, you could use multimode fiber between the buildings and connect switches to create your LAN.|Если каждое здание находится в пределах нескольких сотен метров от хотя бы одного другого здания, вы можете использовать многомодовое оптоволокно между зданиями и подключать коммутаторы для создания вашей локальной сети.
|
NOTE Outside the need to study for CCNA, if you need to look more deeply at fiber Ethernet and SFP/SFP+, check out tmgmatrix.cisco.com as a place to search for and learn about compatible SFP/SFP+ hardware from Cisco.|ПРИМЕЧАНИЕ Помимо необходимости изучения CCNA, если вам нужно более глубоко изучить оптоволоконный Ethernet и SFP / SFP +, посетите tmgmatrix.cisco.com как место для поиска и изучения совместимого оборудования SFP / SFP + от Cisco.
|
Although distance might be the first criterion to consider when thinking about whether to use UTP or fiber cabling, a few other tradeoffs exist as well.|Хотя расстояние может быть первым критерием, который следует учитывать при размышлениях о том, использовать ли UTP или оптоволоконный кабель, существует также несколько других компромиссов.
UTP wins again on cost, because the cost goes up as you move from UTP, to multimode, and then to single-mode, due to the extra cost for the transmitters like the SFP and SFP+ modules.|UTP снова выигрывает по стоимости, потому что стоимость увеличивается при переходе от UTP к многомодовой, а затем к одномодовой из-за дополнительных затрат на передатчики, такие как модули SFP и SFP +.
UTP has some negatives, however.|Однако у UTP есть и недостатки.
First, UTP might work poorly in some electrically noisy environments such as factories, because UTP can be affected by electromagnetic interference (EMI). Also, UTP cables emit a faint signal outside the cable, so highly secure networks may choose to use fiber, which does not create similar emissions, to make the network more secure.|Во-первых, UTP может плохо работать в некоторых электрически шумных средах, таких как фабрики, потому что на UTP могут влиять электромагнитные помехи (EMI). Кроме того, кабели UTP излучают слабый сигнал за пределами кабеля, поэтому высокозащищенные сети могут использовать оптоволокно, которое не создает подобных излучений, чтобы сделать сеть более безопасной.
Table 2-5 summarizes these tradeoffs.|Таблица 2-5 суммирует эти компромиссы.
|
Table 2-5 Comparisons Between UTP, MM, and SM Ethernet Cabling Table end.|Таблица 2-5 Сравнение кабелей Ethernet UTP, MM и SM Конец таблицы.
### Sending Data in Ethernet Networks
Отправка данных в сетях Ethernet   
__|__
--|--
|
Although physical layer standards vary quite a bit, other parts of the Ethernet standards work the same regardless of the type of physical Ethernet link.|Хотя стандарты физического уровня довольно сильно различаются, другие части стандартов Ethernet работают одинаково, независимо от типа физического канала Ethernet.
Next, this final major section of this chapter looks at several protocols and rules that Ethernet uses regardless of the type of link.|Далее, в этом последнем основном разделе этой главы рассматриваются несколько протоколов и правил, которые использует Ethernet независимо от типа канала.
In particular, this section examines the details of the Ethernet data-link layer protocol, plus how Ethernet nodes, switches, and hubs forward Ethernet frames through an Ethernet LAN.|В частности, в этом разделе подробно рассматривается протокол уровня канала передачи данных Ethernet, а также то, как узлы, коммутаторы и концентраторы Ethernet пересылают кадры Ethernet через локальную сеть Ethernet.
#### Ethernet Data-Link Protocols
Протоколы передачи данных Ethernet   
__|__
--|--
|
One of the most significant strengths of the Ethernet family of protocols is that these protocols use the same data-link standard.|Одна из самых сильных сторон семейства протоколов Ethernet состоит в том, что в этих протоколах используется один и тот же стандарт передачи данных.
In fact, the core parts of the data-link standard date back to the original Ethernet standards.|Фактически, основные части стандарта канала передачи данных восходят к исходным стандартам Ethernet.
|
The Ethernet data-link protocol defines the Ethernet frame: an Ethernet header at the front, the encapsulated data in the middle, and an Ethernet trailer at the end.|Протокол канала передачи данных Ethernet определяет фрейм Ethernet: заголовок Ethernet в передней части, инкапсулированные данные в середине и трейлер Ethernet в конце.
Ethernet actually defines a few alternate formats for the header, with the frame format shown in Figure 2-19 being commonly used today.|Ethernet фактически определяет несколько альтернативных форматов для заголовка, при этом формат кадра, показанный на рис. 2-19, обычно используется сегодня.
|
Figure 2-19 Commonly Used Ethernet Frame Format While all the fields in the frame matter, some matter more to the topics discussed in this book.|Рис. 2-19. Обычно используемый формат кадра Ethernet Хотя все поля кадра имеют значение, некоторые имеют большее значение для тем, обсуждаемых в этой книге.
Table 2-6 lists the fields in the header and trailer and a brief description for reference, with the upcoming pages including more detail about a few of these fields.|В таблице 2-6 перечислены поля в заголовке и трейлере, а также краткое описание для справки, а на следующих страницах приведены более подробные сведения о некоторых из этих полей.
|
Table 2-6 IEEE 802.3 Ethernet Header and Trailer Fields Table end.|Таблица 2-6 Поля заголовка и трейлера Ethernet IEEE 802.3 Конец таблицы.
|
1 The IEEE 802.3 specification limits the data portion of the 802.3 frame to a minimum of 46 and a maximum of 1500 bytes.|1 Спецификация IEEE 802.3 ограничивает часть данных кадра 802.3 минимум 46 и максимум 1500 байтами.
The term maximum transmission unit (MTU) defines the maximum Layer 3 packet that can be sent over a medium.|Термин максимальный блок передачи (MTU) определяет максимальный пакет уровня 3, который может быть отправлен по среде.
Because the Layer 3 packet rests inside the data portion of an Ethernet frame, 1500 bytes is the largest IP MTU allowed over an Ethernet.|Поскольку пакет уровня 3 находится внутри части данных кадра Ethernet, 1500 байтов - это наибольший размер IP MTU, разрешенный для Ethernet.
##### Ethernet Addressing
Адресация Ethernet   
__|__
--|--
|
The source and destination Ethernet address fields play a huge role in how Ethernet LANs work.|Поля адресов Ethernet источника и назначения играют огромную роль в работе локальных сетей Ethernet.
The general idea for each is relatively simple: the sending node puts its own address in the source address field and the intended Ethernet destination device’s address in the destination address field.|Общая идея для каждого из них относительно проста: отправляющий узел помещает свой собственный адрес в поле адреса источника и адрес предполагаемого устройства назначения Ethernet в поле адреса назначения.
The sender transmits the frame, expecting that the Ethernet LAN, as a whole, will deliver the frame to that correct destination.|Отправитель передает кадр, ожидая, что локальная сеть Ethernet в целом доставит его в правильное место назначения.
|
Ethernet addresses, also called Media Access Control (MAC) addresses, are 6-byte-long (48-bit-long) binary numbers.|Адреса Ethernet, также называемые адресами управления доступом к среде (MAC), представляют собой двоичные числа длиной 6 байт (48 бит).
For convenience, most computers list MAC addresses as 12-digit hexadecimal numbers.|Для удобства большинство компьютеров указывают MAC-адреса в виде 12-значных шестнадцатеричных чисел.
Cisco devices typically add some periods to the number for easier readability as well; for example, a Cisco switch might list a MAC address as 0000.0C12.3456.|Устройства Cisco обычно добавляют несколько точек к числу для облегчения чтения; например, коммутатор Cisco может указать MAC-адрес как 0000.0C12.3456.
|
Most MAC addresses represent a single NIC or other Ethernet port, so these addresses are often called a unicast Ethernet address.|Большинство MAC-адресов представляют собой один сетевой адаптер или другой порт Ethernet, поэтому эти адреса часто называют одноадресными адресами Ethernet.
The term unicast is simply a formal way to refer to the fact that the address represents one interface to the Ethernet LAN. (This term also contrasts with two other types of Ethernet addresses, broadcast and multicast, which will be defined later in this section.)|Термин одноадресная передача - это просто формальный способ обозначить тот факт, что адрес представляет один интерфейс к локальной сети Ethernet. (Этот термин также контрастирует с двумя другими типами адресов Ethernet, широковещательными и многоадресными, которые будут определены позже в этом разделе.)
|
The entire idea of sending data to a destination unicast MAC address works well, but it works only if all the unicast MAC addresses are unique.|Сама идея отправки данных на одноадресный MAC-адрес назначения работает хорошо, но работает только в том случае, если все одноадресные MAC-адреса уникальны.
If two NICs tried to use the same MAC address, there could be confusion. (The problem would be like the confusion caused to the postal service if you and I both tried to use the same mailing address—would the postal service deliver mail to your house or mine?) If two PCs on the same Ethernet tried to use the same MAC address, to which PC should frames sent to that MAC address be delivered?|Если два сетевых адаптера попытаются использовать один и тот же MAC-адрес, может возникнуть путаница. (Проблема была бы похожа на путаницу, вызванную почтовой службой, если бы вы и я оба попытались использовать один и тот же почтовый адрес - будет ли почтовая служба доставлять почту в ваш дом или в мой?) Если два компьютера в одном Ethernet попытаются использовать тот же MAC-адрес, на какой компьютер следует доставлять кадры, отправленные на этот MAC-адрес?
|
Ethernet solves this problem using an administrative process so that, at the time of manufacture, all Ethernet devices are assigned a universally unique MAC address.|Ethernet решает эту проблему с помощью административного процесса, так что во время производства всем устройствам Ethernet назначается универсальный уникальный MAC-адрес.
Before a manufacturer can build Ethernet products, it must ask the IEEE to assign the manufacturer a universally unique 3-byte code, called the organizationally unique identifier (OUI). The manufacturer agrees to give all NICs (and other Ethernet products) a MAC address that begins with its assigned 3-byte OUI. The manufacturer also assigns a unique value for the last 3 bytes, a number that manufacturer has never used with that OUI. As a result, the MAC address of every device in the universe is unique.|Прежде чем производитель сможет создавать продукты Ethernet, он должен попросить IEEE назначить производителю универсально уникальный 3-байтовый код, называемый уникальным идентификатором организации (OUI). Производитель соглашается предоставить всем сетевым адаптерам (и другим продуктам Ethernet) MAC-адрес, который начинается с назначенного ему 3-байтового OUI. Производитель также присваивает уникальное значение последним 3 байтам, число, которое производитель никогда не использовал с этим OUI. В результате MAC-адрес каждого устройства во вселенной уникален.
|
NOTE The IEEE also calls these universal MAC addresses global MAC addresses.|ПРИМЕЧАНИЕ IEEE также называет эти универсальные MAC-адреса глобальными MAC-адресами.
|
Figure 2-20 shows the structure of the unicast MAC address, with the OUI.|На рисунке 2-20 показана структура одноадресного MAC-адреса с OUI.
|
Figure 2-20 Structure of Unicast Ethernet Addresses Ethernet addresses go by many names: LAN address, Ethernet address, hardware address, burned-in address, physical address, universal address, or MAC address.|Рисунок 2-20 Структура одноадресных адресов Ethernet Адреса Ethernet имеют множество имен: адрес LAN, адрес Ethernet, аппаратный адрес, встроенный адрес, физический адрес, универсальный адрес или MAC-адрес.
For example, the term burned-in address (BIA) refers to the idea that a permanent MAC address has been encoded (burned into) the ROM chip on the NIC. As another example, the IEEE uses the term universal address to emphasize the fact that the address assigned to a NIC by a manufacturer should be unique among all MAC addresses in the universe.|Например, термин записанный адрес (BIA) относится к идее, что постоянный MAC-адрес был закодирован (записан в) микросхему ПЗУ на сетевой карте. В качестве другого примера IEEE использует термин универсальный адрес, чтобы подчеркнуть тот факт, что адрес, присвоенный сетевой карте производителем, должен быть уникальным среди всех MAC-адресов во вселенной.
|
In addition to unicast addresses, Ethernet also uses group addresses.|В дополнение к одноадресным адресам Ethernet также использует групповые адреса.
Group addresses identify more than one LAN interface card.|Групповые адреса идентифицируют более одной интерфейсной карты LAN.
A frame sent to a group address might be delivered to a small set of devices on the LAN, or even to all devices on the LAN. In fact, the IEEE defines two general categories of group addresses for Ethernet:|Кадр, отправленный на групповой адрес, может быть доставлен на небольшой набор устройств в локальной сети или даже на все устройства в локальной сети. Фактически, IEEE определяет две общие категории групповых адресов для Ethernet:
|
Broadcast address: Frames sent to this address should be delivered to all devices on the Ethernet LAN. It has a value of FFFF.FFFF.FFFF.|Широковещательный адрес: кадры, отправленные на этот адрес, должны быть доставлены на все устройства в локальной сети Ethernet. Он имеет значение FFFF.FFFF.FFFF.
|
Multicast addresses: Frames sent to a multicast Ethernet address will be copied and forwarded to a subset of the devices on the LAN that volunteers to receive frames sent to a specific multicast address.|Многоадресные адреса: кадры, отправленные на многоадресный адрес Ethernet, будут скопированы и перенаправлены на подмножество устройств в локальной сети, которые добровольно соглашаются принимать кадры, отправленные на конкретный адрес многоадресной рассылки.
|
Table 2-7 summarizes most of the details about MAC addresses.|Таблица 2-7 суммирует большинство деталей о MAC-адресах.
|
Table 2-7 LAN MAC Address Terminology and Features Table end.|Таблица 2-7 Терминология и характеристики MAC-адресов LAN Конец таблицы.
##### Identifying Network Layer Protocols with the Ethernet Type Field
Идентификация протоколов сетевого уровня с помощью поля типа Ethernet   
__|__
--|--
|
While the Ethernet header’s address fields play an important and more obvious role in Ethernet LANs, the Ethernet Type field plays a much less obvious role.|В то время как поля адреса заголовка Ethernet играют важную и более очевидную роль в локальных сетях Ethernet, поле типа Ethernet играет гораздо менее очевидную роль.
The Ethernet Type field, or EtherType, sits in the Ethernet data-link layer header, but its purpose is to directly help the network processing on routers and hosts.|Поле Ethernet Type, или EtherType, находится в заголовке уровня канала передачи данных Ethernet, но его цель состоит в том, чтобы напрямую помочь сетевой обработке на маршрутизаторах и хостах.
Basically, the Type field identifies the type of network layer (Layer 3) packet that sits inside the Ethernet frame.|По сути, поле Type определяет тип пакета сетевого уровня (Layer 3), который находится внутри кадра Ethernet.
|
First, think about what sits inside the data part of the Ethernet frame shown earlier in Figure 2-14.|Сначала подумайте, что находится внутри части данных кадра Ethernet, показанной ранее на рис. 2-14.
Typically, it holds the network layer packet created by the network layer protocol on some device in the network.|Как правило, он содержит пакет сетевого уровня, созданный протоколом сетевого уровня на каком-либо устройстве в сети.
Over the years, those protocols have included IBM Systems Network Architecture (SNA), Novell NetWare, Digital Equipment Corporation’s DECnet, and Apple Computer’s AppleTalk.|На протяжении многих лет эти протоколы включали IBM Systems Network Architecture (SNA), Novell NetWare, DECnet корпорации Digital Equipment и AppleTalk Apple Computer.
Today, the most common network layer protocols are both from TCP/IP: IP version 4 (IPv4) and IP version 6 (IPv6).|Сегодня наиболее распространенными протоколами сетевого уровня являются протоколы TCP / IP: IP версии 4 (IPv4) и IP версии 6 (IPv6).
|
The original host has a place to insert a value (a hexadecimal number) to identify the type of packet encapsulated inside the Ethernet frame.|На исходном хосте есть место для вставки значения (шестнадцатеричного числа) для идентификации типа пакета, инкапсулированного внутри кадра Ethernet.
However, what number should the sender put in the header to identify an IPv4 packet as the type?|Однако какое число отправитель должен указать в заголовке, чтобы идентифицировать пакет IPv4 как тип?
Or an IPv6 packet?|Или пакет IPv6?
As it turns out, the IEEE manages a list of EtherType values, so that every network layer protocol that needs a unique EtherType value can have a number.|Как оказалось, IEEE управляет списком значений EtherType, так что каждый протокол сетевого уровня, которому требуется уникальное значение EtherType, может иметь номер.
The sender just has to know the list. (Anyone can view the list; just go to www.ieee.org and search for EtherType.)|Отправителю просто нужно знать список. (Кто угодно может просмотреть список; просто перейдите на www.ieee.org и выполните поиск по EtherType.)
|
For example, a host can send one Ethernet frame with an IPv4 packet and the next Ethernet frame with an IPv6 packet.|Например, хост может отправить один кадр Ethernet с пакетом IPv4, а следующий кадр Ethernet - с пакетом IPv6.
Each frame would have a different Ethernet Type field value, using the values reserved by the IEEE, as shown in Figure 2-21.|Каждый кадр будет иметь различное значение поля Ethernet Type с использованием значений, зарезервированных IEEE, как показано на рисунке 2-21.
|
Figure 2-21 Use of Ethernet Type Field|Рисунок 2-21 Использование поля типа Ethernet
##### Error Detection with FCS
Обнаружение ошибок с помощью FCS   
__|__
--|--
|
Ethernet also defines a way for nodes to find out whether a frame’s bits changed while crossing over an Ethernet link. (Usually, the bits could change because of some kind of electrical interference, or a bad NIC.) Ethernet, like most data-link protocols, uses a field in the datalink trailer for the purpose of error detection.|Ethernet также определяет способ, с помощью которого узлы узнают, изменились ли биты кадра при переходе по каналу Ethernet. (Обычно биты могут измениться из-за каких-либо электрических помех или неисправной сетевой карты.) Ethernet, как и большинство протоколов передачи данных, использует поле в трейлере канала передачи данных для обнаружения ошибок.
|
The Ethernet Frame Check Sequence (FCS) field in the Ethernet trailer—the only field in the Ethernet trailer—gives the receiving node a way to compare results with the sender, to discover whether errors occurred in the frame.|Поле Ethernet Frame Check Sequence (FCS) в трейлере Ethernet - единственное поле в трейлере Ethernet - дает принимающему узлу способ сравнить результаты с отправителем, чтобы определить, произошли ли ошибки в кадре.
The sender applies a complex math formula to the frame before sending it, storing the result of the formula in the FCS field.|Отправитель применяет сложную математическую формулу к кадру перед его отправкой, сохраняя результат формулы в поле FCS.
The receiver applies the same math formula to the received frame.|Получатель применяет ту же математическую формулу к полученному кадру.
The receiver then compares its own results with the sender’s results.|Затем получатель сравнивает свои результаты с результатами отправителя.
If the results are the same, the frame did not change; otherwise, an error occurred, and the receiver discards the frame.|Если результаты совпадают, рамка не изменилась; в противном случае произошла ошибка, и получатель отбрасывает кадр.
|
Note that error detection does not also mean error recovery.|Обратите внимание, что обнаружение ошибок также не означает исправление ошибок.
Ethernet defines that the errored frame should be discarded, but Ethernet does not attempt to recover the lost frame.|Ethernet определяет, что ошибочный кадр следует отбросить, но Ethernet не пытается восстановить потерянный кадр.
Other protocols, notably TCP, recover the lost data by noticing that it is lost and sending the data again.|Другие протоколы, в частности TCP, восстанавливают потерянные данные, замечая, что они потеряны, и отправляя данные снова.
#### Sending Ethernet Frames with Switches and Hubs
Отправка кадров Ethernet с помощью коммутаторов и концентраторов   
__|__
--|--
|
Ethernet LANs behave slightly differently depending on whether the LAN has mostly modern devices, in particular, LAN switches instead of some older LAN devices called LAN hubs.|Локальные сети Ethernet ведут себя немного по-разному в зависимости от того, есть ли в локальной сети в основном современные устройства, в частности коммутаторы локальной сети вместо некоторых старых устройств локальной сети, называемых концентраторами локальной сети.
Basically, the use of more modern switches allows the use of full-duplex logic, which is much faster and simpler than half-duplex logic, which is required when using hubs.|По сути, использование более современных коммутаторов позволяет использовать полнодуплексную логику, которая намного быстрее и проще, чем полудуплексная логика, которая требуется при использовании концентраторов.
The final topic in this chapter looks at these basic differences.|В последней теме этой главы рассматриваются эти основные различия.
##### Sending in Modern Ethernet LANs Using Full Duplex
Отправка в современных локальных сетях Ethernet с использованием полного дуплекса   
__|__
--|--
|
Modern Ethernet LANs use a variety of Ethernet physical standards, but with standard Ethernet frames that can flow over any of these types of physical links.|В современных локальных сетях Ethernet используются различные физические стандарты Ethernet, но со стандартными кадрами Ethernet, которые могут передаваться по любому из этих типов физических каналов.
Each individual link can run at a different speed, but each link allows the attached nodes to send the bits in the frame to the next node.|Каждая отдельная ссылка может работать с разной скоростью, но каждая ссылка позволяет подключенным узлам отправлять биты в кадре следующему узлу.
They must work together to deliver the data from the sending Ethernet node to the destination node.|Они должны работать вместе, чтобы доставить данные от отправляющего узла Ethernet к узлу назначения.
|
The process is relatively simple, on purpose; the simplicity lets each device send a large number of frames per second.|Процесс относительно простой, специально; простота позволяет каждому устройству отправлять большое количество кадров в секунду.
Figure 2-22 shows an example in which PC1 sends an Ethernet frame to PC2.|На рис. 2-22 показан пример, в котором ПК1 отправляет кадр Ethernet на ПК2.
|
Figure 2-22 Example of Sending Data in a Modern Ethernet LAN Following the steps in the figure:|Рисунок 2-22 Пример отправки данных в современной локальной сети Ethernet Следуйте инструкциям на рисунке:
|
1. PC1 builds and sends the original Ethernet frame, using its own MAC address as the source address and PC2’s MAC address as the destination address.|1. ПК1 создает и отправляет исходный кадр Ethernet, используя свой собственный MAC-адрес в качестве адреса источника и MAC-адрес ПК2 в качестве адреса назначения.
|
2. Switch SW1 receives and forwards the Ethernet frame out its G0/1 interface (short for Gigabit interface 0/1) to SW2.|2. Коммутатор SW1 принимает и пересылает кадр Ethernet через свой интерфейс G0 / 1 (сокращение от Gigabit interface 0/1) на SW2.
|
3. Switch SW2 receives and forwards the Ethernet frame out its F0/2 interface (short for Fast Ethernet interface 0/2) to PC2.|3. Коммутатор SW2 принимает и пересылает кадр Ethernet через интерфейс F0 / 2 (сокращение от Fast Ethernet interface 0/2) на ПК2.
|
4. PC2 receives the frame, recognizes the destination MAC address as its own, and processes the frame.|4. ПК2 принимает кадр, распознает MAC-адрес назначения как свой собственный и обрабатывает кадр.
|
The Ethernet network in Figure 2-22 uses full duplex on each link, but the concept might be difficult to see.|Сеть Ethernet на рис. 2-22 использует полнодуплексный режим на каждом канале, но эту концепцию трудно понять.
|
Full duplex means that that the NIC or switch port has no half-duplex restrictions.|Полный дуплекс означает, что для сетевого адаптера или порта коммутатора нет ограничений на полудуплекс.
So, to understand full duplex, you need to understand half duplex, as follows:|Итак, чтобы понять полный дуплекс, вам нужно понимать полудуплекс следующим образом:
|
Half duplex: The device must wait to send if it is currently receiving a frame; in other words, it cannot send and receive at the same time.|Полудуплекс: устройство должно дождаться отправки, если оно в данный момент принимает кадр; Другими словами, он не может отправлять и получать одновременно.
|
Full duplex: The device does not have to wait before sending; it can send and receive at the same time.|Полный дуплекс: устройству не нужно ждать перед отправкой; он может отправлять и получать одновременно.
|
So, with all PCs and LAN switches, and no LAN hubs, all the nodes can use full duplex.|Таким образом, со всеми ПК и коммутаторами LAN и без концентраторов LAN все узлы могут использовать полнодуплексный режим.
All nodes can send and receive on their port at the same instant in time.|Все узлы могут отправлять и получать через свой порт в один и тот же момент времени.
For example, in Figure 2-22, PC1 and PC2 could send frames to each other simultaneously, in both directions, without any half-duplex restrictions.|Например, на рис. 2-22 ПК1 и ПК2 могут отправлять кадры друг другу одновременно в обоих направлениях без каких-либо полудуплексных ограничений.
##### Using Half Duplex with LAN Hubs
Использование полудуплекса с концентраторами LAN   
__|__
--|--
|
To understand the need for half-duplex logic in some cases, you have to understand a little about an older type of networking device called a LAN hub.|Чтобы понять необходимость полудуплексной логики в некоторых случаях, вам нужно немного узнать о более старом типе сетевого устройства, называемом концентратором LAN.
When the IEEE first introduced 10BASE-T in 1990, Ethernet switches did not exist yet; instead, networks used a device called a LAN hub.|Когда IEEE впервые представил 10BASE-T в 1990 году, коммутаторов Ethernet еще не существовало; вместо этого в сети использовалось устройство, называемое концентратором LAN.
Like a switch, a LAN hub provided a number of RJ-45 ports as a place to connect links to PCs; however, hubs used different rules for forwarding data.|Подобно коммутатору, концентратор локальной сети предоставляет несколько портов RJ-45 в качестве места для подключения каналов к ПК; однако концентраторы использовали другие правила пересылки данных.
|
LAN hubs forward data using physical layer standards rather than data-link standards and are therefore considered to be Layer 1 devices.|Концентраторы LAN пересылают данные, используя стандарты физического уровня, а не стандарты канала передачи данных, и поэтому считаются устройствами уровня 1.
When an electrical signal comes in one hub port, the hub repeats that electrical signal out all other ports (except the incoming port).|Когда электрический сигнал поступает в один порт концентратора, концентратор повторяет этот электрический сигнал на все другие порты (кроме входящего порта).
By doing so, the data reaches all the rest of the nodes connected to the hub, so the data hopefully reaches the correct destination.|Таким образом, данные достигают всех остальных узлов, подключенных к концентратору, поэтому мы надеемся, что данные достигнут правильного места назначения.
The hub has no concept of Ethernet frames, of addresses, making decisions based on those addresses, and so on.|Концентратор не имеет понятия о кадрах Ethernet, адресах, принятии решений на основе этих адресов и т. Д.
|
The downside of using LAN hubs is that if two or more devices transmitted a signal at the same instant, the electrical signal collides and becomes garbled.|Обратной стороной использования концентраторов LAN является то, что если два или более устройства передают сигнал в один и тот же момент, электрический сигнал сталкивается и становится искаженным.
The hub repeats all received electrical signals, even if it receives multiple signals at the same time.|Концентратор повторяет все полученные электрические сигналы, даже если он принимает несколько сигналов одновременно.
For example, Figure 2-23 shows the idea, with PCs Archie and Bob sending an electrical signal at the same instant of time (at Steps 1A and 1B) and the hub repeating both electrical signals out toward Larry on the left (Step 2).|Например, на рис. 2-23 показана идея, в которой ПК Арчи и Боб посылают электрический сигнал в один и тот же момент времени (на шагах 1A и 1B), а концентратор повторяет оба электрических сигнала в направлении Ларри слева (шаг 2). .
|
Figure 2-23 Collision Occurring Because of LAN Hub Behavior NOTE For completeness, note that the hub floods each frame out all other ports (except the incoming port).|Рисунок 2-23 Коллизия, возникающая из-за поведения концентратора LAN ПРИМЕЧАНИЕ. Для полноты картины обратите внимание, что концентратор лавинно отправляет каждый кадр из всех других портов (кроме входящего порта).
So, Archie’s frame goes to both Larry and Bob; Bob’s frame goes to Larry and Archie.|Итак, фрейм Арчи достается и Ларри, и Бобу; Фрейм Боба достается Ларри и Арчи.
|
If you replace the hub in Figure 2-23 with a LAN switch, the switch prevents the collision on the left.|Если вы замените концентратор на Рисунке 2-23 на коммутатор LAN, коммутатор предотвратит столкновение слева.
The switch operates as a Layer 2 device, meaning that it looks at the data-link header and trailer.|Коммутатор работает как устройство уровня 2, что означает, что он просматривает заголовок и трейлер канала передачи данных.
A switch would look at the MAC addresses, and even if the switch needed to forward both frames to Larry on the left, the switch would send one frame and queue the other frame until the first frame was finished.|Коммутатор будет смотреть на MAC-адреса, и даже если коммутатору необходимо переадресовать оба кадра Ларри слева, коммутатор отправит один кадр и поставит другой кадр в очередь до тех пор, пока не будет завершен первый кадр.
|
Now back to the issue created by the hub’s logic: collisions.|Теперь вернемся к проблеме, созданной логикой хаба: коллизиям.
To prevent these collisions, the Ethernet nodes must use half-duplex logic instead of full-duplex logic.|Чтобы предотвратить эти коллизии, узлы Ethernet должны использовать полудуплексную логику вместо полнодуплексной логики.
A problem occurs only when two or more devices send at the same time; half-duplex logic tells the nodes that if someone else is sending, wait before sending.|Проблема возникает только тогда, когда два или более устройства отправляют одновременно; полудуплексная логика сообщает узлам, что если отправляет кто-то другой, подождите перед отправкой.
|
For example, back in Figure 2-23, imagine that Archie began sending his frame early enough so that Bob received the first bits of that frame before Bob tried to send his own frame.|Например, вернувшись к рисунку 2-23, представьте, что Арчи начал отправлять свой кадр достаточно рано, так что Боб получил первые биты этого кадра до того, как Боб попытался отправить свой собственный кадр.
Bob, at Step 1B, would notice that he was receiving a frame from someone else, and using halfduplex logic, would simply wait to send the frame listed at Step 1B.|Боб на шаге 1B заметил бы, что он получает кадр от кого-то еще, и, используя полудуплексную логику, просто ждал бы отправки кадра, указанного на шаге 1B.
|
Nodes that use half-duplex logic actually use a relatively well-known algorithm called carrier sense multiple access with collision detection (CSMA/CD). The algorithm takes care of the obvious cases but also the cases caused by unfortunate timing.|Узлы, которые используют полудуплексную логику, фактически используют относительно хорошо известный алгоритм, называемый множественным доступом с контролем несущей и обнаружением коллизий (CSMA / CD). Алгоритм учитывает очевидные случаи, но также и случаи, вызванные неудачным расчетом времени.
For example, two nodes could check for an incoming frame at the exact same instant, both realize that no other node is sending, and both send their frames at the exact same instant, causing a collision.|Например, два узла могут проверять входящий кадр в один и тот же момент, оба понимают, что никакой другой узел не отправляет, и оба отправляют свои кадры в один и тот же момент, вызывая коллизию.
CSMA/|CSMA /
|
CD covers these cases as well, as follows:|CD охватывает и эти случаи, а именно:
|
Step 1.|Шаг 1.
A device with a frame to send listens until the Ethernet is not busy.|Устройство с кадром для отправки слушает, пока Ethernet не будет занят.
|
Step 2.|Шаг 2.
When the Ethernet is not busy, the sender begins sending the frame.|Когда Ethernet не занят, отправитель начинает отправку кадра.
|
Step 3.|Шаг 3.
The sender listens while sending to discover whether a collision occurs; collisions might be caused by many reasons, including unfortunate timing.|Отправитель слушает во время отправки, чтобы определить, возникает ли конфликт; Столкновения могут быть вызваны многими причинами, в том числе неудачным временем.
If a collision occurs, all currently sending nodes do the following:|Если происходит коллизия, все отправляющие в данный момент узлы делают следующее:
|
A. They send a jamming signal that tells all nodes that a collision happened.|A. Они посылают сигнал глушения, который сообщает всем узлам, что произошло столкновение.
|
B. They independently choose a random time to wait before trying again, to avoid unfortunate timing.|Б. Они самостоятельно выбирают случайное время ожидания перед повторной попыткой, чтобы избежать неудачного выбора времени.
|
C. The next attempt starts again at Step 1.|C. Следующая попытка снова начинается с шага 1.
|
Although most modern LANs do not often use hubs and therefore do not need to use half duplex, enough old hubs still exist in enterprise networks so that you need to be ready to understand duplex issues.|Хотя большинство современных локальных сетей не часто используют концентраторы и, следовательно, не нуждаются в использовании полудуплекса, в корпоративных сетях все еще существует достаточно старых концентраторов, поэтому вам нужно быть готовым понять проблемы дуплекса.
Each NIC and switch port has a duplex setting.|Каждая сетевая карта и порт коммутатора имеют настройку дуплекса.
For all links between PCs and switches, or between switches, use full duplex.|Для всех каналов связи между ПК и коммутаторами или между коммутаторами используйте полнодуплексный режим.
However, for any link connected to a LAN hub, the connected LAN switch and NIC port should use half duplex.|Однако для любого канала, подключенного к концентратору LAN, подключенный коммутатор LAN и порт NIC должны использовать полудуплекс.
Note that the hub itself does not use half-duplex logic, instead just repeating incoming signals out every other port.|Обратите внимание, что сам концентратор не использует полудуплексную логику, а просто повторяет входящие сигналы через каждый другой порт.
|
Figure 2-24 shows an example, with full-duplex links on the left and a single LAN hub on the right.|На Рис. 2-24 показан пример с полнодуплексными каналами слева и одним концентратором LAN справа.
The hub then requires SW2’s F0/2 interface to use half-duplex logic, along with the PCs connected to the hub.|Затем концентратору требуется интерфейс F0 / 2 SW2 для использования полудуплексной логики вместе с ПК, подключенными к концентратору.
|
Figure 2-24 Full and Half Duplex in an Ethernet LAN Before closing the chapter, note that the discussion of full and half duplex connects to two specific terms from CCNA exam topic 1.3.b, but those connections may not be obvious.|Рисунок 2-24 Полнодуплексный и полудуплексный режим в локальной сети Ethernet Перед закрытием главы обратите внимание, что обсуждение полного и полудуплексного режима связано с двумя конкретными терминами из темы 1.3.b экзамена CCNA, но эти соединения могут быть неочевидными.
|
First, the term Ethernet shared media (from the exam topic) refers to designs that use hubs, require CSMA/CD, and therefore share the bandwidth.|Во-первых, термин совместно используемый носитель Ethernet (из темы экзамена) относится к проектам, которые используют концентраторы, требуют CSMA / CD и, следовательно, совместно используют полосу пропускания.
The idea behind the term comes from the fact that the devices connected to the hub share the network because they must use CSMA/CD, and CSMA/CD enforces rules that allow only one device to successfully send a frame at any point in time.|Идея этого термина исходит из того факта, что устройства, подключенные к концентратору, совместно используют сеть, потому что они должны использовать CSMA / CD, а CSMA / CD обеспечивает соблюдение правил, которые позволяют только одному устройству успешно отправлять кадр в любой момент времени.
|
By contrast, the term Ethernet point-to-point in that same exam topic emphasizes the fact that in a network built with switches, each (point-to-point) link works independently of the others.|Напротив, термин «точка-точка» Ethernet в той же теме экзамена подчеркивает тот факт, что в сети, построенной с использованием коммутаторов, каждое (точка-точка) соединение работает независимо от других.
Because of the full-duplex logic discussed in this section, a frame can be sent on every point-to-point link in an Ethernet at the same time.|Из-за полнодуплексной логики, обсуждаемой в этом разделе, кадр может быть отправлен по каждому каналу точка-точка в Ethernet одновременно.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element for more details.|Обратитесь к элементу «Ваш учебный план» для получения более подробной информации.
Table 2-8 outlines the key review elements and where you can find them.|В Таблице 2-8 перечислены ключевые элементы обзора и указаны места, где их можно найти.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 2-8 Chapter Review Tracking Table end.|Таблица 2-8. Конец таблицы отслеживания обзора главы.
|
Review All the Key Topics Key Terms You Should Know Ethernet, IEEE, wired LAN, wireless LAN, Ethernet frame, 10BASE-T, 100BASE-T, 1000BASE-T, Fast Ethernet, Gigabit Ethernet, Ethernet link, RJ-45, Ethernet port, network interface card (NIC), straight-through cable, crossover cable, Ethernet address, MAC address, unicast address, broadcast address, Frame Check Sequence, transceiver, Multimode (MM), single-mode (SM), electromagnetic Interference (EMI), core, cladding, fiber-optic cable|Ознакомьтесь со всеми ключевыми темами. Ключевые термины, которые вы должны знать Ethernet, IEEE, проводная локальная сеть, беспроводная локальная сеть, рамка Ethernet, 10BASE-T, 100BASE-T, 1000BASE-T, Fast Ethernet, Gigabit Ethernet, канал Ethernet, RJ-45, порт Ethernet. , сетевая карта (NIC), прямой кабель, перекрестный кабель, адрес Ethernet, MAC-адрес, одноадресный адрес, широковещательный адрес, последовательность проверки кадров, приемопередатчик, многомодовый (MM), одномодовый (SM), электромагнитные помехи (EMI) ), жила, оболочка, оптоволоконный кабель
## Chapter 3 Fundamentals of WANs and IP Routing
Глава 3 Основы WAN и IP-маршрутизации   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.1 Explain the role and function of network components
1.1 Объясните роль и функции сетевых компонентов   
###### 1.1.a Routers
1.1.a Маршрутизаторы   
###### 1.2 Describe characteristics of network topology architectures
1.2 Описание характеристик архитектур топологии сети   
###### 1.2.d WAN
1.2.d WAN   
__|__
--|--
|
This chapter introduces WANs and the various features of the TCP/IP network layer.|В этой главе представлены глобальные сети и различные функции сетевого уровня TCP / IP.
|
First, for WANs, note that the current CCNA blueprint does not examine WANs in detail as an end to themselves.|Во-первых, что касается глобальных сетей, обратите внимание, что текущая схема CCNA не рассматривает глобальные сети подробно как самоцель.
However, to understand IP routing, you need to understand the basics of the two types of WAN links introduced in the first major section of this chapter: serial links and Ethernet WAN links.|Однако для понимания IP-маршрутизации необходимо понимать основы двух типов каналов WAN, представленных в первом основном разделе этой главы: последовательные каналы и каналы Ethernet WAN.
In their most basic form, these WAN links connect routers that sit at sites that can be miles to hundreds of miles apart, allowing communications between remote sites.|В своей самой простой форме эти каналы глобальной сети соединяют маршрутизаторы, расположенные на сайтах, которые могут находиться на расстоянии от нескольких миль до сотен миль, обеспечивая связь между удаленными сайтами.
|
The rest of the chapter then turns to the TCP/IP Network layer, with IP as the center of the discussion.|Остальная часть главы переходит к сетевому уровню TCP / IP, в центре внимания которого - IP.
The second section of the chapter discusses the major features of IP: routing, addressing, and routing protocols.|Во втором разделе главы обсуждаются основные функции IP: маршрутизация, адресация и протоколы маршрутизации.
The final section of the chapter examines a few protocols other than IP that also help the TCP/IP Network layer create a network that allows end-toend communication between endpoints.|В последнем разделе главы рассматриваются несколько протоколов, отличных от IP, которые также помогают сетевому уровню TCP / IP создавать сеть, обеспечивающую сквозную связь между конечными точками.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 3-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 3-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### Wide-Area Networks
Глобальные сети   
__|__
--|--
|
IP Routing 3–6 Other Network Layer Functions 7 CHAPTER 3 1.|IP-маршрутизация 3–6 Другие функции сетевого уровня 7 ГЛАВА 3 1.
Which of the following fields in the HDLC header used by Cisco routers does Cisco add, beyond the ISO standard HDLC?|Какие из следующих полей в заголовке HDLC, используемом маршрутизаторами Cisco, добавляет Cisco помимо стандартного ISO HDLC?
|
a. Flag b.|а. Флаг b.
Type c.|Тип c.
Address d.|Адрес д.
FCS 2.|FCS 2.
Two routers, R1 and R2, connect using an Ethernet over MPLS service.|Два маршрутизатора, R1 и R2, подключаются с помощью службы Ethernet через MPLS.
The service provides point-to-point service between these two routers only, as a Layer 2 Ethernet service.|Служба обеспечивает двухточечную службу только между этими двумя маршрутизаторами в качестве службы Ethernet уровня 2.
Which of the following are the most likely to be true about this WAN?|Что из следующего, скорее всего, будет правдой об этой глобальной сети?
|
(Choose two answers.)|(Выберите два ответа.)
|
a. R1 will connect to a physical Ethernet link, with the other end of the cable connected to R2.|а. R1 подключится к физическому каналу Ethernet, а другой конец кабеля будет подключен к R2.
|
b. R1 will connect to a physical Ethernet link, with the other end of the cable connected to a device at the WAN service provider point of presence.|б. R1 подключается к физическому каналу Ethernet, а другой конец кабеля подключается к устройству в точке присутствия поставщика услуг глобальной сети.
|
c. R1 will forward data-link frames to R2 using an HDLC header/trailer.|c. R1 пересылает кадры канала данных на R2, используя заголовок / трейлер HDLC.
|
d. R1 will forward data-link frames to R2 using an Ethernet header/trailer.|d. R1 пересылает кадры канала данных на R2, используя заголовок / трейлер Ethernet.
|
3. Imagine a network with two routers that are connected with a point-to-point HDLC serial link.|3. Представьте сеть с двумя маршрутизаторами, соединенными последовательным каналом HDLC «точка-точка».
Each router has an Ethernet, with PC1 sharing the Ethernet with Router1 and PC2 sharing the Ethernet with Router2.|У каждого маршрутизатора есть Ethernet, при этом ПК1 совместно использует Ethernet с Router1, а ПК2 использует Ethernet с Router2.
When PC1 sends data to PC2, which of the following is true?|Когда ПК1 отправляет данные на ПК2, что из следующего верно?
|
a. Router1 strips the Ethernet header and trailer off the frame received from PC1, never to be used again.|а. Router1 удаляет заголовок и трейлер Ethernet из кадра, полученного от ПК1, чтобы никогда не использовать его снова.
|
b. Router1 encapsulates the Ethernet frame inside an HDLC header and sends the frame to Router2, which extracts the Ethernet frame for forwarding to PC2.|б. Маршрутизатор 1 инкапсулирует кадр Ethernet внутри заголовка HDLC и отправляет кадр маршрутизатору 2, который извлекает кадр Ethernet для пересылки на ПК2.
|
c. Router1 strips the Ethernet header and trailer off the frame received from PC1, which is exactly re-created by Router2 before forwarding data to PC2.|c. Router1 удаляет заголовок и трейлер Ethernet из кадра, полученного от ПК1, который точно воссоздается Router2 перед пересылкой данных на ПК2.
|
d. Router1 removes the Ethernet, IP, and TCP headers and rebuilds the appropriate headers before forwarding the packet to Router2.|d. Router1 удаляет заголовки Ethernet, IP и TCP и перестраивает соответствующие заголовки перед пересылкой пакета на Router2.
|
4. Which of the following does a router normally use when making a decision about routing TCP/IP packets?|4. Что из следующего маршрутизатор обычно использует при принятии решения о маршрутизации пакетов TCP / IP?
|
a. Destination MAC address b.|а. MAC-адрес назначения b.
Source MAC address c.|MAC-адрес источника c.
Destination IP address d.|IP-адрес назначения d.
Source IP address e.|Исходный IP-адрес e.
Destination MAC and IP addresses 5.|MAC- и IP-адреса назначения 5.
Which of the following are true about a LAN-connected TCP/IP host and its IP routing (forwarding) choices?|Что из следующего является верным о подключенном к локальной сети узле TCP / IP и его вариантах IP-маршрутизации (пересылки)?
|
a. The host always sends packets to its default gateway.|а. Хост всегда отправляет пакеты на свой шлюз по умолчанию.
|
b. The host never sends packets to its default gateway.|б. Хост никогда не отправляет пакеты на свой шлюз по умолчанию.
|
c. The host sends packets to its default gateway if the destination IP address is in a different subnet than the host.|c. Хост отправляет пакеты на свой шлюз по умолчанию, если IP-адрес назначения находится в другой подсети, чем хост.
|
d. The host sends packets to its default gateway if the destination IP address is in the same subnet as the host.|d. Хост отправляет пакеты на свой шлюз по умолчанию, если IP-адрес назначения находится в той же подсети, что и хост.
|
6. Which of the following are functions of a routing protocol? (Choose two answers.)|6. Что из перечисленного является функциями протокола маршрутизации? (Выберите два ответа.)
|
a. Advertising known routes to neighboring routers b.|а. Реклама известных маршрутов к соседним маршрутизаторам b.
Learning routes for subnets directly connected to the router c.|Изучение маршрутов для подсетей, напрямую подключенных к маршрутизатору c.
Learning routes and putting those routes into the routing table for routes advertised to the router by its neighboring routers d.|Изучение маршрутов и занесение этих маршрутов в таблицу маршрутизации для маршрутов, объявляемых маршрутизатору его соседними маршрутизаторами d.
Forwarding IP packets based on a packet’s destination IP address 7.|Пересылка IP-пакетов на основе IP-адреса назначения пакета 7.
A company implements a TCP/IP network, with PC1 sitting on an Ethernet LAN.|Компания реализует сеть TCP / IP, при этом ПК1 находится в локальной сети Ethernet.
|
Which of the following protocols and features requires PC1 to learn information from some other server device?|Для каких из следующих протоколов и функций ПК1 должен получать информацию от другого серверного устройства?
|
a. ARP b. ping c.|а. ARP б. пинг c.
DNS d.|DNS d.
None of these answers is correct.|Ни один из этих ответов не является правильным.
|
Foundation Topics Wide-Area Networks Imagine a typical day at the branch office at some enterprise.|Основные темы Глобальные сети Представьте себе обычный день в филиале на каком-то предприятии.
The user sits at some endpoint device: a PC, tablet, phone, and so on.|Пользователь сидит на каком-то оконечном устройстве: ПК, планшете, телефоне и т. Д.
It connects to a LAN, either via an Ethernet cable or using a wireless LAN. However, the user happens to be checking information on a website, and that web server sits at the home office of the company.|Он подключается к локальной сети с помощью кабеля Ethernet или беспроводной локальной сети. Однако случается, что пользователь проверяет информацию на веб-сайте, и этот веб-сервер находится в домашнем офисе компании.
To make that work, the data travels over one or more wide-area network (WAN) links.|Чтобы это работало, данные передаются по одному или нескольким каналам глобальной сети (WAN).
|
WAN technologies define the physical (Layer 1) standards and data-link (Layer 2) protocols used to communicate long distances.|Технологии WAN определяют физические стандарты (уровень 1) и протоколы передачи данных (уровень 2), используемые для связи на больших расстояниях.
This first section examines two such technologies:|В этом первом разделе рассматриваются две такие технологии:
|
leased-line WANs and Ethernet WANs. Leased-line WANs have been an option for networks for half a century, are becoming much less common today, but you may still see some leased-line WAN links in the exam.|выделенные линии WAN и Ethernet WAN. Глобальные сети с выделенной линией были вариантом для сетей в течение полувека, сегодня они становятся гораздо менее распространенными, но вы все еще можете увидеть некоторые каналы глобальной сети по выделенной линии на экзамене.
Ethernet WAN links do use the same data-link protocols as Ethernet LANs, but they use additional features to make the links work over the much longer distances required for WANs. The next few pages examine leased-line WANs first, followed by Ethernet WANs.|В каналах Ethernet WAN используются те же протоколы передачи данных, что и в локальных сетях Ethernet, но в них используются дополнительные функции, позволяющие каналам работать на гораздо больших расстояниях, необходимых для глобальных сетей. На следующих нескольких страницах сначала исследуются глобальные сети с выделенными линиями, а затем - сети Ethernet.
#### Leased-Line WANs
WAN с выделенной линией   
__|__
--|--
|
To connect LANs using a WAN, the internetwork uses a router connected to each LAN, with a WAN link between the routers.|Для подключения локальных сетей с помощью глобальной сети межсетевое взаимодействие использует маршрутизатор, подключенный к каждой локальной сети, с каналом глобальной сети между маршрутизаторами.
First, the enterprise’s network engineer would order some kind of WAN link.|Во-первых, сетевой инженер предприятия заказывал какое-то соединение WAN.
A router at each site connects to both the WAN link and the LAN, as shown in Figure 3-1.|Маршрутизатор на каждом сайте подключается как к каналу WAN, так и к локальной сети, как показано на рисунке 3-1.
Note that a crooked line between the routers is the common way to represent a leased line when the drawing does not need to show any of the physical details of the line.|Обратите внимание, что кривая линия между маршрутизаторами является обычным способом представления выделенной линии, когда на чертеже не требуется отображать какие-либо физические детали линии.
|
Figure 3-1 Small Enterprise Network with One Leased Line This section begins by examining the physical details of leased lines, followed by a discussion of the default data-link protocol for leased lines (HDLC).|Рис. 3-1. Сеть малого предприятия с одной выделенной линией. Этот раздел начинается с изучения физических деталей выделенных линий, за которым следует обсуждение протокола передачи данных по умолчанию для выделенных линий (HDLC).
##### Physical Details of Leased Lines
Физические характеристики арендованных линий   
__|__
--|--
|
The leased line service delivers bits in both directions, at a predetermined speed, using fullduplex logic.|Услуга выделенной линии передает биты в обоих направлениях с заданной скоростью с использованием полнодуплексной логики.
In fact, conceptually it acts as if you had a full-duplex crossover Ethernet link between two routers, as shown in Figure 3-2.|Фактически, концептуально это действует так, как если бы между двумя маршрутизаторами был установлен полнодуплексный перекрестный канал Ethernet, как показано на рисунке 3-2.
The leased line uses two pairs of wires, one pair for each direction of sending data, which allows full-duplex operation.|В выделенной линии используются две пары проводов, по одной паре для каждого направления передачи данных, что позволяет работать в полнодуплексном режиме.
|
Figure 3-2 Conceptual View of the Leased-Line Service Of course, leased lines have many differences compared to an Ethernet crossover cable.|Рис. 3-2. Концептуальный вид услуги выделенной линии. Конечно, выделенные линии имеют много отличий от перекрестного кабеля Ethernet.
To create such possibly long links, or circuits, a leased line does not actually exist as a single long cable between the two sites.|Для создания таких возможно длинных соединений или цепей выделенная линия фактически не существует как один длинный кабель между двумя объектами.
Instead, the telephone company (telco) that creates the leased line installs a large network of cables and specialized switching devices to create its own computer network.|Вместо этого телефонная компания (телекоммуникационная компания), которая создает выделенную линию, устанавливает большую сеть кабелей и специализированных коммутационных устройств, чтобы создать свою собственную компьютерную сеть.
The telco network creates a service that acts like a crossover cable between two points, but the physical reality is hidden from the customer.|Сеть телекоммуникационной компании создает услугу, которая действует как перекрестный кабель между двумя точками, но физическая реальность скрыта от клиента.
|
Leased lines come with their own set of terminology as well.|Выделенные линии также имеют свой собственный набор терминологии.
First, the term leased line refers to the fact that the company using the leased line does not own the line but instead pays a monthly lease fee to use it.|Во-первых, термин «арендованная линия» относится к тому факту, что компания, использующая арендованную линию, не владеет линией, а вместо этого платит ежемесячную арендную плату за ее использование.
Table 3-2 lists some of the many names for leased lines, mainly so that in a networking job, you have a chance to translate from the terms each person uses with a basic description as to the meaning of the name.|В таблице 3-2 перечислены некоторые из множества имен выделенных линий, в основном для того, чтобы при работе в сети у вас была возможность перевести термины, которые использует каждый человек, с базовым описанием значения имени.
|
Table 3-2 Different Names for a Leased Line Table end.|Таблица 3-2. Различные имена для конца таблицы выделенных линий.
|
To create a leased line, some physical path must exist between the two routers on the ends of the link.|Чтобы создать выделенную линию, между двумя маршрутизаторами на концах линии должен существовать какой-то физический путь.
The physical cabling must leave the customer buildings where each router sits.|Физические кабели должны покидать здания заказчика, где находится каждый маршрутизатор.
|
However, the telco does not simply install one cable between the two buildings.|Однако телекоммуникационная компания не просто прокладывает один кабель между двумя зданиями.
Instead, it uses what is typically a large and complex network that creates the appearance of a cable between the two routers.|Вместо этого он использует то, что обычно представляет собой большую и сложную сеть, которая создает видимость кабеля между двумя маршрутизаторами.
|
Figure 3-3 gives a little insight into the cabling that could exist inside the telco for a short leased line.|Рисунок 3-3 дает небольшое представление о кабельной разводке, которая может существовать внутри телекоммуникационной компании для короткой выделенной линии.
Telcos put their equipment in buildings called central offices (CO). The telco installs cables from the CO to most every other building in the city, expecting to sell services to the people in those buildings one day.|Телекоммуникационные компании размещают свое оборудование в зданиях, называемых центральными офисами (CO). Телефонная компания прокладывает кабели от центральной станции к почти всем зданиям в городе, ожидая когда-нибудь продавать услуги людям в этих зданиях.
The telco would then configure its switches to use some of the capacity on each cable to send data in both directions, creating the equivalent of a crossover cable between the two routers.|Затем телекоммуникационная компания настраивала свои коммутаторы на использование некоторой емкости каждого кабеля для передачи данных в обоих направлениях, создавая эквивалент перекрестного кабеля между двумя маршрутизаторами.
|
Figure 3-3 Possible Cabling Inside a Telco for a Short Leased Line Answers to the “Do I Know This Already?” quiz:|Рисунок 3-3 Возможная прокладка кабеля внутри телефонной компании для короткой выделенной линии Ответы на вопрос «Знаю ли я это уже?» викторина:
|
1 B 2 B, D 3 A 4 C 5 C 6 A, C 7 C Although the customer does not need to know all the details of how a telco creates a particular leased line, enterprise engineers do need to know about the parts of the link that exist inside the customer’s building at the router.|1 B 2 B, D 3 A 4 C 5 C 6 A, C 7 C Хотя заказчику не нужно знать все детали того, как телекоммуникационная компания создает конкретную выделенную линию, инженеры предприятия должны знать о частях ссылки, которые существуют внутри здания клиента на маршрутизаторе.
However, for the purposes of CCNA, you can think of any serial link as a point-to-point connection between two routers.|Однако для целей CCNA вы можете думать о любом последовательном канале как о двухточечном соединении между двумя маршрутизаторами.
##### HDLC Data-Link Details of Leased Lines
Подробная информация о канале передачи данных HDLC по выделенным линиям   
__|__
--|--
|
A leased line provides a Layer 1 service.|Выделенная линия предоставляет услугу уровня 1.
In other words, it promises to deliver bits between the devices connected to the leased line.|Другими словами, он обещает передавать биты между устройствами, подключенными к выделенной линии.
However, the leased line itself does not define a data-link layer protocol to be used on the leased line.|Однако сама выделенная линия не определяет протокол уровня канала передачи данных, который будет использоваться на выделенной линии.
|
Because leased lines define only the Layer 1 transmission service, many companies and standards organizations have created data-link protocols to control and use leased lines.|Поскольку выделенные линии определяют только службу передачи уровня 1, многие компании и организации по стандартизации создали протоколы каналов передачи данных для управления и использования выделенных линий.
Today, the two most popular data-link layer protocols used for leased lines between two routers are High-Level Data Link Control (HDLC) and Point-to-Point Protocol (PPP).|Сегодня два самых популярных протокола канального уровня, используемых для выделенных линий между двумя маршрутизаторами, - это высокоуровневое управление каналом передачи данных (HDLC) и двухточечный протокол (PPP).
|
All data-link protocols perform a similar role: to control the correct delivery of data over a physical link of a particular type.|Все протоколы каналов передачи данных выполняют аналогичную роль: контролируют правильную доставку данных по физическому каналу определенного типа.
For example, the Ethernet data-link protocol uses a destination address field to identify the correct device that should receive the data and an FCS field that allows the receiving device to determine whether the data arrived correctly.|Например, протокол канала передачи данных Ethernet использует поле адреса назначения для идентификации правильного устройства, которое должно принимать данные, и поле FCS, которое позволяет принимающему устройству определять, правильно ли поступили данные.
HDLC provides similar functions.|HDLC предоставляет аналогичные функции.
|
HDLC has less work to do than Ethernet because of the simple point-to-point topology of a leased line.|У HDLC меньше работы, чем у Ethernet, из-за простой топологии выделенной линии «точка-точка».
When one router sends an HDLC frame, the frame can go only one place: to the other end of the link.|Когда один маршрутизатор отправляет кадр HDLC, он может идти только в одном месте: на другой конец канала.
So, while HDLC has an address field, the destination is implied, and the actual address is unimportant.|Таким образом, хотя HDLC имеет поле адреса, пункт назначения подразумевается, а фактический адрес не имеет значения.
The idea is sort of like when I have lunch with my friend Gary, and only Gary.|Идея вроде как когда я обедаю с моим другом Гэри, и только Гэри.
I do not need to start every sentence with “Hey, Gary”—he knows I am talking to him.|Мне не нужно начинать каждое предложение со слов «Привет, Гэри» - он знает, что я говорю с ним.
|
HDLC has other fields and functions similar to Ethernet as well.|HDLC также имеет другие поля и функции, аналогичные Ethernet.
Table 3-3 lists the HDLC fields, with the similar Ethernet header/trailer field, just for the sake of learning HDLC based on something you have already learned about (Ethernet).|В Таблице 3-3 перечислены поля HDLC с аналогичным полем заголовка / концевой части Ethernet, просто для того, чтобы изучить HDLC на основе того, о чем вы уже узнали (Ethernet).
|
Table 3-3 Comparing HDLC Header Fields to Ethernet Table end.|Таблица 3-3 Сравнение полей заголовка HDLC с концом таблицы Ethernet.
|
HDLC exists today as a standard of the International Organization for Standardization (ISO), the same organization that brought us the OSI model.|HDLC существует сегодня как стандарт Международной организации по стандартизации (ISO), той же организации, которая представила нам модель OSI.
However, ISO standard HDLC does not have a Type field, and routers need to know the type of packet inside the frame.|Однако стандарт ISO HDLC не имеет поля типа, и маршрутизаторам необходимо знать тип пакета внутри кадра.
So, Cisco routers use a Cisco-proprietary variation of HDLC that adds a Type field, as shown in Figure 3-4.|Итак, маршрутизаторы Cisco используют собственный вариант протокола HDLC, который добавляет поле Type, как показано на рисунке 3-4.
|
Figure 3-4 HDLC Framing|Рисунок 3-4 Кадрирование HDLC
##### How Routers Use a WAN Data Link
Как маршрутизаторы используют канал передачи данных WAN   
__|__
--|--
|
Leased lines connect to routers, and routers focus on delivering packets to a destination host.|Выделенные линии подключаются к маршрутизаторам, и маршрутизаторы сосредоточены на доставке пакетов на хост назначения.
|
However, routers physically connect to both LANs and WANs, with those LANs and WANs requiring that data be sent inside data-link frames.|Однако маршрутизаторы физически подключаются как к локальным, так и к глобальным сетям, причем для этих локальных и глобальных сетей требуется, чтобы данные передавались внутри кадров канала передачи данных.
So, now that you know a little about HDLC, it helps to think about how routers use the HDLC protocol when sending data.|Итак, теперь, когда вы немного знаете о HDLC, это помогает подумать о том, как маршрутизаторы используют протокол HDLC при отправке данных.
|
First, the TCP/IP network layer focuses on forwarding IP packets from the sending host to the destination host.|Во-первых, сетевой уровень TCP / IP фокусируется на пересылке IP-пакетов от хоста-отправителя к хосту назначения.
The underlying LANs and WANs just act as a way to move the packets to the next router or end-user device.|Базовые сети LAN и WAN просто служат способом пересылки пакетов на следующий маршрутизатор или устройство конечного пользователя.
Figure 3-5 shows that network layer perspective.|Рисунок 3-5 показывает перспективу сетевого уровня.
|
Figure 3-5 IP Routing Logic over LANs and WANs Following the steps in the figure, for a packet sent by PC1 to PC2’s IP address:|Рисунок 3-5 Логика IP-маршрутизации в локальных и глобальных сетях Следуя шагам, показанным на рисунке, для пакета, отправленного ПК1 на IP-адрес ПК2:
|
1. PC1’s network layer (IP) logic tells it to send the packet to a nearby router (R1).|1. Логика сетевого уровня (IP) ПК1 сообщает ему об отправке пакета ближайшему маршрутизатору (R1).
|
2. Router R1’s network layer logic tells it to forward (route) the packet out the leased line to Router R2 next.|2. Логика сетевого уровня маршрутизатора R1 указывает ему пересылать (маршрутизировать) пакет по выделенной линии на маршрутизатор R2 следующим.
|
3. Router R2’s network layer logic tells it to forward (route) the packet out the LAN link to PC2 next.|3. Логика сетевого уровня маршрутизатора R2 указывает ему пересылать (маршрутизировать) пакет по LAN-каналу на ПК2.
|
While Figure 3-5 shows the network layer logic, the PCs and routers must rely on the LANs and WANs in the figure to actually move the bits in the packet.|Хотя на рис. 3-5 показана логика сетевого уровня, ПК и маршрутизаторы должны полагаться на локальные и глобальные сети, показанные на рисунке, для фактического перемещения битов в пакете.
Figure 3-6 shows the same figure, with the same packet, but this time showing some of the data-link layer logic used by the hosts and routers.|На рис. 3-6 показан тот же рисунок с тем же пакетом, но на этот раз показана логика уровня канала передачи данных, используемая хостами и маршрутизаторами.
Basically, three separate data-link layer steps encapsulate the packet, inside a data-link frame, over three hops through the internetwork: from PC1 to R1, from R1 to R2, and from R2 to PC2.|По сути, три отдельных шага уровня звена данных инкапсулируют пакет внутри кадра звена данных по трем переходам через объединенную сеть: от ПК1 к R1, от R1 к R2 и от R2 к ПК2.
|
Figure 3-6 General Concept of Routers De-encapsulating and Re-encapsulating IP Packets Following the steps in the figure, again for a packet sent by PC1 to PC2’s IP address:|Рисунок 3-6 Общая концепция деинкапсуляции и повторной инкапсуляции IP-пакетов маршрутизаторами Следуя шагам на рисунке, снова для пакета, отправленного ПК1 на IP-адрес ПК2:
|
1. To send the IP packet to Router R1 next, PC1 encapsulates the IP packet in an Ethernet frame that has the destination MAC address of R1.|1. Чтобы затем отправить IP-пакет маршрутизатору R1, ПК1 инкапсулирует IP-пакет в кадр Ethernet, который имеет MAC-адрес назначения R1.
|
2. Router R1 de-encapsulates (removes) the IP packet from the Ethernet frame, encapsulates the packet into an HDLC frame using an HDLC header and trailer, and forwards the HDLC frame to Router R2 next.|2. Маршрутизатор R1 деинкапсулирует (удаляет) IP-пакет из кадра Ethernet, инкапсулирует пакет в кадр HDLC, используя заголовок и трейлер HDLC, а затем пересылает кадр HDLC на маршрутизатор R2.
|
3. Router R2 de-encapsulates (removes) the IP packet from the HDLC frame, encapsulates the packet into an Ethernet frame that has the destination MAC address of PC2, and forwards the Ethernet frame to PC2.|3. Маршрутизатор R2 деинкапсулирует (удаляет) IP-пакет из кадра HDLC, инкапсулирует пакет в кадр Ethernet, который имеет MAC-адрес назначения ПК2, и пересылает кадр Ethernet на ПК2.
|
In summary, a leased line with HDLC creates a WAN link between two routers so that they can forward packets for the devices on the attached LANs. The leased line itself provides the physical means to transmit the bits, in both directions.|Таким образом, выделенная линия с HDLC создает канал WAN между двумя маршрутизаторами, чтобы они могли пересылать пакеты для устройств в подключенных локальных сетях. Сама выделенная линия предоставляет физические средства для передачи битов в обоих направлениях.
The HDLC frames provide the means to encapsulate the network layer packet correctly so that it crosses the link between routers.|Кадры HDLC предоставляют средства для правильной инкапсуляции пакета сетевого уровня, чтобы он пересекал канал между маршрутизаторами.
|
Leased lines have many benefits that have led to their relatively long life in the WAN marketplace.|У выделенных линий есть много преимуществ, которые привели к их относительно долгой жизни на рынке WAN.
|
These lines are simple for the customer, are widely available, are of high quality, and are private.|Эти линии просты для покупателя, широко доступны, имеют высокое качество и являются частными.
However, they do have some negatives as well compared to newer WAN technologies, including a higher cost and typically longer lead times to get the service installed.|Однако у них есть и некоторые недостатки по сравнению с новыми технологиями WAN, включая более высокую стоимость и, как правило, более длительные сроки установки службы.
|
Additionally, by today’s standards, leased-line LANs are slow, with faster speeds in the tens of megabits per second (Mbps).|Кроме того, по сегодняшним стандартам ЛВС с выделенной линией медленные, с более высокими скоростями до десятков мегабит в секунду (Мбит / с).
New faster WAN technology has been replacing leased lines for a long time, including the second WAN technology discussed in this book: Ethernet.|Новая более быстрая технология WAN уже давно заменяет выделенные линии, включая вторую технологию WAN, обсуждаемую в этой книге: Ethernet.
#### Ethernet as a WAN Technology
Ethernet как технология WAN   
__|__
--|--
|
For the first several decades of the existence of Ethernet, Ethernet was only appropriate for LANs. The restrictions on cable lengths and devices might allow a LAN that stretched a kilometer or two, to support a campus LAN, but that was the limit.|В течение первых нескольких десятилетий существования Ethernet Ethernet подходил только для локальных сетей. Ограничения на длину кабелей и устройства могут позволить ЛВС протяженностью один-два километра поддерживать ЛВС кампуса, но это был предел.
|
As time passed, the IEEE improved Ethernet standards in ways that made Ethernet a reasonable WAN technology.|Со временем IEEE улучшил стандарты Ethernet, сделав Ethernet разумной технологией WAN.
For example, the 1000BASE-LX standard uses single-mode fiber cabling, with support for a 5-km cable length; the 1000BASE-ZX standard supports an even longer 70-km cable length.|Например, стандарт 1000BASE-LX использует одномодовый оптоволоконный кабель с поддержкой кабеля длиной 5 км; стандарт 1000BASE-ZX поддерживает даже более длинный кабель длиной 70 км.
As time went by, and as the IEEE improved cabling distances for fiber Ethernet links, Ethernet became a reasonable WAN technology.|Шло время, и по мере того, как IEEE увеличивал длину кабелей для волоконно-оптических линий Ethernet, Ethernet стал разумной технологией WAN.
|
Today, many WAN service providers (SP) offer WAN services that take advantage of Ethernet.|Сегодня многие поставщики услуг WAN (SP) предлагают услуги WAN, которые используют преимущества Ethernet.
SPs offer a wide variety of these Ethernet WAN services, with many different names.|SP предлагают широкий спектр этих услуг Ethernet WAN с множеством разных имен.
But all of them use a similar model, with Ethernet used between the customer site and the SP’s network, as shown in Figure 3-7.|Но все они используют схожую модель с Ethernet, используемым между сайтом клиента и сетью SP, как показано на рисунке 3-7.
|
Figure 3-7 Fiber Ethernet Link to Connect a CPE Router to a Service Provider’s WAN The model shown in Figure 3-7 has many of the same ideas of how a telco creates a leased line, as shown earlier in Figure 3-3, but now with Ethernet links and devices.|Рисунок 3-7 Волоконно-оптический канал Ethernet для подключения CPE-маршрутизатора к глобальной сети поставщика услуг Модель, показанная на Рисунке 3-7, имеет многие из тех же идей того, как телекоммуникационная компания создает выделенную линию, как показано ранее на Рисунке 3-3, но теперь со связями и устройствами Ethernet.
The customer connects to an Ethernet link using a router interface.|Клиент подключается к каналу Ethernet с помощью интерфейса маршрутизатора.
The (fiber) Ethernet link leaves the customer building and connects to some nearby SP location called a point of presence (PoP). Instead of a telco switch as shown in Figure 3-3, the SP uses an Ethernet switch.|(Волоконный) канал Ethernet выходит из здания клиента и подключается к некоторому ближайшему местоположению SP, называемому точкой присутствия (PoP). Вместо коммутатора телефонной компании, как показано на рис. 3-3, SP использует коммутатор Ethernet.
Inside the SP’s network, the SP uses any technology that it wants to create the specific Ethernet WAN services.|Внутри сети SP использует любую технологию, которая нужна ему для создания определенных сервисов Ethernet WAN.
##### Ethernet WANs That Create a Layer 2 Service
Сети Ethernet WAN, которые создают сервис уровня 2   
__|__
--|--
|
Ethernet WAN services include a variety of specific services that vary in ways that change how routers use those services.|Услуги Ethernet WAN включают в себя множество конкретных услуг, которые различаются способами, которые меняют способ использования этих услуг маршрутизаторами.
However, for the purposes of CCNA, you just need to understand the most basic Ethernet WAN service, one that works much like an Ethernet crossover cable—just over a WAN. In other words:|Однако для целей CCNA вам просто нужно понять самую базовую услугу Ethernet WAN, которая работает во многом как перекрестный кабель Ethernet - только через WAN. Другими словами:
###### Logically, behaves like a point-to-point connection between two routers
Логически ведет себя как соединение точка-точка между двумя маршрутизаторами.   
###### Physically, behaves as if a physical fiber Ethernet link existed between the two routers
Физически ведет себя так, как если бы между двумя маршрутизаторами существовал физический оптоволоконный канал Ethernet.   
__|__
--|--
|
NOTE For perspective about the broad world of the service provider network shown in Figure 3-7, look for more information about the Cisco CCNA, CCNP Service Provider, and CCIE Service Provider certifications.|ПРИМЕЧАНИЕ. Чтобы получить представление о широком мире сети поставщиков услуг, показанной на рис. 3-7, поищите дополнительную информацию о сертификатах Cisco CCNA, CCNP Service Provider и CCIE Service Provider.
See www.cisco.com/go/certifications for more details.|См. Www.cisco.com/go/certifications для получения дополнительных сведений.
|
This book refers to this particular Ethernet WAN service with a couple of the common names:|В этой книге этот конкретный сервис Ethernet WAN упоминается под несколькими общими названиями:
|
Ethernet WAN: A generic name to differentiate it from an Ethernet LAN.|Ethernet WAN: общее название, позволяющее отличить его от локальной сети Ethernet.
|
Ethernet Line Service (E-Line): A term from the Metro Ethernet Forum (MEF) for the kind of point-to-point Ethernet WAN service shown throughout this book.|Ethernet Line Service (E-Line): термин из форума Metro Ethernet Forum (MEF) для типа двухточечной услуги Ethernet WAN, показанной в этой книге.
|
Ethernet emulation: A term emphasizing that the link is not a literal Ethernet link from end to end.|Эмуляция Ethernet: термин, подчеркивающий, что соединение не является буквальным соединением Ethernet от конца до конца.
|
Ethernet over MPLS (EoMPLS): A term that refers to Multiprotocol Label Switching (MPLS), a technology that can be used to create the Ethernet service for the customer.|Ethernet через MPLS (EoMPLS): термин, относящийся к многопротокольной коммутации по меткам (MPLS), технологии, которая может использоваться для создания услуги Ethernet для клиента.
|
So, if you can imagine two routers, with a single Ethernet link between the two routers, you understand what this particular EoMPLS service does, as shown in Figure 3-8.|Итак, если вы можете представить себе два маршрутизатора с одним каналом Ethernet между двумя маршрутизаторами, вы поймете, что делает эта конкретная служба EoMPLS, как показано на рисунке 3-8.
In this case, the two routers, R1 and R2, connect with an EoMPLS service instead of a serial link.|В этом случае два маршрутизатора, R1 и R2, подключаются к службе EoMPLS вместо последовательного канала.
The routers use Ethernet interfaces, and they can send data in both directions at the same time.|Маршрутизаторы используют интерфейсы Ethernet и могут отправлять данные в обоих направлениях одновременно.
|
Physically, each router actually connects to some SP PoP, as shown earlier in Figure 3-7, but logically, the two routers can send Ethernet frames to each other over the link.|Физически каждый маршрутизатор фактически подключается к некоторому SP PoP, как показано ранее на рисунке 3-7, но логически два маршрутизатора могут отправлять кадры Ethernet друг другу по каналу.
|
Figure 3-8 EoMPLS Acting Like a Simple Ethernet Link Between Two Routers|Рисунок 3-8 EoMPLS, действующий как простой канал Ethernet между двумя маршрутизаторами
##### How Routers Route IP Packets Using Ethernet Emulation
Как маршрутизаторы маршрутизируют IP-пакеты с помощью эмуляции Ethernet   
__|__
--|--
|
WANs, by their very nature, give IP routers a way to forward IP packets from a LAN at one site, over the WAN, and to another LAN at another site.|Глобальные сети по самой своей природе дают IP-маршрутизаторам возможность пересылать IP-пакеты из локальной сети на одном сайте, через глобальную сеть и в другую локальную сеть на другом сайте.
Routing over an EoMPLS WAN link still uses the WAN like a WAN, as a way to forward IP packets from one site to another.|Маршрутизация по каналу EoMPLS WAN по-прежнему использует WAN, как WAN, как способ пересылки IP-пакетов от одного сайта к другому.
|
However, the WAN link happens to use the same Ethernet protocols as the Ethernet LAN links at each site.|Однако канал WAN использует те же протоколы Ethernet, что и каналы Ethernet LAN на каждом сайте.
|
The EoMPLS link uses Ethernet for both Layer 1 and Layer 2 functions.|Канал EoMPLS использует Ethernet как для функций уровня 1, так и для функций уровня 2.
That means the link uses the same familiar Ethernet header and trailer, as shown in the middle of Figure 3-9.|Это означает, что ссылка использует те же знакомые заголовок и трейлер Ethernet, как показано в середине рисунка 3-9.
Note that the figure shows a small cloud over the Ethernet link as a way to tell us that the link is an Ethernet WAN link, rather than an Ethernet LAN link.|Обратите внимание, что на рисунке показано небольшое облако по каналу Ethernet, чтобы сообщить нам, что этот канал является каналом Ethernet WAN, а не каналом Ethernet LAN.
|
Figure 3-9 Routing over an EoMPLS Link NOTE The 802.3 headers/trailers in the figure are different at each stage!|Рисунок 3-9 Маршрутизация по каналу EoMPLS ПРИМЕЧАНИЕ Заголовки / трейлеры 802.3 на рисунке различны на каждом этапе!
Make sure to notice the reasons in the step-by-step explanations that follow.|Обязательно укажите причины в следующих пошаговых объяснениях.
|
The figure shows the same three routing steps as shown with the serial link in the earlier Figure 3-6.|На рисунке показаны те же три шага маршрутизации, что и для последовательного канала на предыдущем рисунке 3-6.
In this case, all three routing steps use the same Ethernet (802.3) protocol.|В этом случае все три шага маршрутизации используют один и тот же протокол Ethernet (802.3).
|
However, note that each frame’s data-link header and trailer are different.|Однако обратите внимание, что заголовок и трейлер канала передачи данных у каждого кадра разные.
Each router discards the old data-link header/trailer and adds a new set, as described in these steps.|Каждый маршрутизатор отбрасывает старый заголовок / трейлер канала передачи данных и добавляет новый набор, как описано в этих шагах.
|
Focus mainly on Step 2, because compared to the similar example shown in Figure 3-6, Steps 1 and 3 are unchanged:|Сосредоточьтесь в основном на шаге 2, потому что по сравнению с аналогичным примером, показанным на рисунке 3-6, шаги 1 и 3 не изменились:
|
1. To send the IP packet to Router R1 next, PC1 encapsulates the IP packet in an Ethernet frame that has the destination MAC address of R1.|1. Чтобы затем отправить IP-пакет маршрутизатору R1, ПК1 инкапсулирует IP-пакет в кадр Ethernet, который имеет MAC-адрес назначения R1.
|
2. Router R1 de-encapsulates (removes) the IP packet from the Ethernet frame and encapsulates the packet into a new Ethernet frame, with a new Ethernet header and trailer.|2. Маршрутизатор R1 деинкапсулирует (удаляет) IP-пакет из кадра Ethernet и инкапсулирует пакет в новый кадр Ethernet с новым заголовком и концом Ethernet.
|
The destination MAC address is R2’s G0/0 MAC address, and the source MAC address is R1’s G0/1 MAC address.|MAC-адрес назначения - это MAC-адрес G0 / 0 R2, а MAC-адрес источника - это MAC-адрес G0 / 1 R1.
R1 forwards this frame over the EoMPLS service to R2 next.|R1 пересылает этот кадр через службу EoMPLS следующему маршрутизатору R2.
|
3. Router R2 de-encapsulates (removes) the IP packet from the Ethernet frame, encapsulates the packet into an Ethernet frame that has the destination MAC address of PC2, and forwards the Ethernet frame to PC2.|3. Маршрутизатор R2 деинкапсулирует (удаляет) IP-пакет из кадра Ethernet, инкапсулирует пакет в кадр Ethernet, который имеет MAC-адрес назначения ПК2, и пересылает кадр Ethernet на ПК2.
|
Throughout this book, the WAN links (serial and Ethernet) will connect routers as shown here, with the focus being on the LANs and IP routing.|В этой книге каналы WAN (последовательные и Ethernet) будут соединять маршрутизаторы, как показано здесь, с упором на локальные сети и IP-маршрутизацию.
The rest of the chapter turns our attention to a closer look at IP routing.|Остальная часть главы посвящена более подробному рассмотрению IP-маршрутизации.
### IP Routing
IP-маршрутизация   
__|__
--|--
|
Many protocol models have existed over the years, but today the TCP/IP model dominates.|Многие модели протоколов существовали на протяжении многих лет, но сегодня модель TCP / IP доминирует.
|
And at the network layer of TCP/IP, two options exist for the main protocol around which all other network layer functions revolve: IP version 4 (IPv4) and IP version 6 (IPv6).|А на сетевом уровне TCP / IP существует два варианта основного протокола, вокруг которого вращаются все другие функции сетевого уровня: IP версии 4 (IPv4) и IP версии 6 (IPv6).
Both IPv4 and IPv6 define the same kinds of network layer functions, but with different details.|И IPv4, и IPv6 определяют одни и те же виды функций сетевого уровня, но с разными деталями.
This chapter introduces these network layer functions for IPv4.|В этой главе представлены функции сетевого уровня для IPv4.
|
NOTE All references to IP in this chapter refer to the older and more established IPv4.|ПРИМЕЧАНИЕ. Все ссылки на IP в этой главе относятся к более старому и более устоявшемуся IPv4.
|
Internet Protocol (IP) focuses on the job of routing data, in the form of IP packets, from the source host to the destination host.|Интернет-протокол (IP) фокусируется на работе по маршрутизации данных в форме IP-пакетов от исходного хоста к целевому.
IP does not concern itself with the physical transmission of data, instead relying on the lower TCP/IP layers to do the physical transmission of the data.|IP не занимается физической передачей данных, вместо этого полагаясь на нижние уровни TCP / IP для физической передачи данных.
|
Instead, IP concerns itself with the logical details, rather than physical details, of delivering data.|Вместо этого IP занимается скорее логическими, чем физическими деталями доставки данных.
In particular, the network layer specifies how packets travel end to end over a TCP/IP network, even when the packet crosses many different types of LAN and WAN links.|В частности, сетевой уровень определяет, как пакеты передаются из конца в конец по сети TCP / IP, даже когда пакет пересекает множество различных типов каналов LAN и WAN.
|
This next major section of the chapter examines IP routing in more depth.|В следующем основном разделе главы IP-маршрутизация рассматривается более подробно.
First, IP defines what it means to route an IP packet from sending host to destination host, while using successive data-link protocols.|Во-первых, IP определяет, что означает маршрутизация IP-пакета от узла-отправителя к узлу назначения при использовании последовательных протоколов передачи данных.
This section then examines how IP addressing rules help to make IP routing much more efficient by grouping addresses into subnets.|Затем в этом разделе исследуется, как правила IP-адресации помогают сделать IP-маршрутизацию намного более эффективной за счет группировки адресов в подсети.
This section closes by looking at the role of IP routing protocols, which give routers a means by which to learn routes to all the IP subnets in an internetwork.|Этот раздел завершается рассмотрением роли протоколов IP-маршрутизации, которые дают маршрутизаторам средства для изучения маршрутов ко всем IP-подсетям в объединенной сети.
#### Network Layer Routing (Forwarding) Logic
Логика маршрутизации (пересылки) сетевого уровня   
__|__
--|--
|
Routers and end-user computers (called hosts in a TCP/IP network) work together to perform IP routing.|Маршрутизаторы и компьютеры конечных пользователей (называемые хостами в сети TCP / IP) работают вместе для выполнения IP-маршрутизации.
The host operating system (OS) has TCP/IP software, including the software that implements the network layer.|Операционная система хоста (ОС) имеет программное обеспечение TCP / IP, включая программное обеспечение, реализующее сетевой уровень.
Hosts use that software to choose where to send IP packets, often to a nearby router.|Хосты используют это программное обеспечение, чтобы выбирать, куда отправлять IP-пакеты, часто на ближайший маршрутизатор.
Those routers make choices of where to send the IP packet next.|Эти маршрутизаторы выбирают, куда послать IP-пакет следующим.
|
Together, the hosts and routers deliver the IP packet to the correct destination, as shown in the example in Figure 3-10.|Вместе хосты и маршрутизаторы доставляют IP-пакет в правильное место назначения, как показано в примере на рисунке 3-10.
|
Figure 3-10 Routing Logic: PC1 Sending an IP Packet to PC2 The IP packet, created by PC1, goes from the top of the figure all the way to PC2 at the bottom of the figure.|Рисунок 3-10 Логика маршрутизации: ПК1 Отправка IP-пакета на ПК2 IP-пакет, созданный ПК1, идет от верхней части рисунка до ПК2 в нижней части рисунка.
The next few pages discuss the network layer routing logic used by each device along the path.|На следующих нескольких страницах обсуждается логика маршрутизации сетевого уровня, используемая каждым устройством на пути.
|
NOTE The term path selection is sometimes used to refer to the routing process shown in Figure 3-10.|ПРИМЕЧАНИЕ. Термин «выбор пути» иногда используется для обозначения процесса маршрутизации, показанного на рисунке 3-10.
At other times, it refers to routing protocols, specifically how routing protocols select the best route among the competing routes to the same destination.|В других случаях это относится к протоколам маршрутизации, в частности к тому, как протоколы маршрутизации выбирают лучший маршрут среди конкурирующих маршрутов к тому же месту назначения.
##### Host Forwarding Logic: Send the Packet to the Default Router
Логика пересылки хоста: отправьте пакет маршрутизатору по умолчанию   
__|__
--|--
|
In this example, PC1 does some basic analysis and then chooses to send the IP packet to the router so that the router will forward the packet.|В этом примере ПК1 выполняет базовый анализ, а затем решает отправить IP-пакет на маршрутизатор, чтобы маршрутизатор пересылал пакет.
PC1 analyzes the destination address and realizes that PC2’s address (150.150.4.10) is not on the same LAN as PC1. So PC1’s logic tells it to send the packet to a device whose job it is to know where to route data: a nearby router, on the same LAN, called PC1’s default router.|ПК1 анализирует адрес назначения и понимает, что адрес ПК2 (150.150.4.10) не находится в той же локальной сети, что и ПК1. Таким образом, логика ПК1 предписывает ему отправить пакет устройству, задача которого - знать, куда направлять данные: ближайший маршрутизатор в той же локальной сети, который называется маршрутизатором ПК1 по умолчанию.
|
To send the IP packet to the default router, the sender sends a data-link frame across the medium to the nearby router; this frame includes the packet in the data portion of the frame.|Чтобы отправить IP-пакет маршрутизатору по умолчанию, отправитель отправляет кадр канала данных через среду на ближайший маршрутизатор; этот кадр включает пакет в информационную часть кадра.
|
That frame uses data-link layer (Layer 2) addressing in the data-link header to ensure that the nearby router receives the frame.|Этот кадр использует адресацию уровня канала данных (уровень 2) в заголовке канала данных, чтобы гарантировать, что ближайший маршрутизатор получит кадр.
|
NOTE The default router is also referred to as the default gateway.|ПРИМЕЧАНИЕ Маршрутизатор по умолчанию также называется шлюзом по умолчанию.
##### R1 and R2’s Logic: Routing Data Across the Network
Логика R1 и R2: маршрутизация данных по сети   
__|__
--|--
|
All routers use the same general process to route the packet.|Все маршрутизаторы используют один и тот же общий процесс для маршрутизации пакета.
Each router keeps an IP routing table.|Каждый маршрутизатор ведет таблицу IP-маршрутизации.
This table lists IP address groupings, called IP networks and IP subnets.|В этой таблице перечислены группы IP-адресов, называемые IP-сетями и IP-подсетями.
When a router receives a packet, it compares the packet’s destination IP address to the entries in the routing table and makes a match.|Когда маршрутизатор получает пакет, он сравнивает IP-адрес назначения пакета с записями в таблице маршрутизации и находит совпадение.
This matching entry also lists directions that tell the router where to forward the packet next.|В этой совпадающей записи также перечислены направления, которые сообщают маршрутизатору, куда пересылать пакет дальше.
|
In Figure 3-10, R1 would have matched the destination address (150.150.4.10) to a routing table entry, which in turn told R1 to send the packet to R2 next.|На рис. 3-10 R1 сопоставил бы адрес назначения (150.150.4.10) с записью в таблице маршрутизации, которая, в свою очередь, сообщила R1 о необходимости отправки пакета R2.
Similarly, R2 would have matched a routing table entry that told R2 to send the packet, over an Ethernet WAN link, to R3 next.|Точно так же R2 должен сопоставить запись в таблице маршрутизации, которая предписывает R2 послать пакет по каналу Ethernet WAN на R3.
|
The routing concept works a little like driving down the freeway when approaching a big interchange.|Концепция маршрутизации немного похожа на движение по автостраде при приближении к большой развязке.
|
You look up and see signs for nearby towns, telling you which exits to take to go to each town.|Вы смотрите вверх и видите знаки близлежащих городов, которые сообщают вам, по каким выходам нужно пройти в каждый город.
Similarly, the router looks at the IP routing table (the equivalent of the road signs)|Точно так же роутер смотрит на таблицу IP-маршрутизации (эквивалент дорожных знаков)
|
and directs each packet over the correct next LAN or WAN link (the equivalent of a road).|и направляет каждый пакет по правильному следующему каналу LAN или WAN (эквивалент дороги).
##### R3’s Logic: Delivering Data to the End Destination
Логика R3: доставка данных в конечный пункт назначения   
__|__
--|--
|
The final router in the path, R3, uses almost the same logic as R1 and R2, but with one minor difference.|Последний маршрутизатор на пути, R3, использует почти ту же логику, что и R1 и R2, но с одним незначительным отличием.
R3 needs to forward the packet directly to PC2, not to some other router.|R3 необходимо переслать пакет непосредственно на ПК2, а не на какой-либо другой маршрутизатор.
On the surface, that difference seems insignificant.|На первый взгляд эта разница кажется незначительной.
In the next section, when you read about how the network layer uses LANs and WANs, the significance of the difference will become obvious.|В следующем разделе, когда вы прочитаете о том, как сетевой уровень использует локальные и глобальные сети, важность различия станет очевидной.
#### How Network Layer Routing Uses LANs and WANs
Как при маршрутизации на сетевом уровне используются локальные и глобальные сети   
__|__
--|--
|
While the network layer routing logic ignores the physical transmission details, the bits still have to be transmitted.|Хотя логика маршрутизации сетевого уровня игнорирует физические детали передачи, биты все же должны быть переданы.
To do that work, the network layer logic in a host or router must hand off the packet to the data-link layer protocols, which, in turn, ask the physical layer to actually send the data.|Для выполнения этой работы логика сетевого уровня в хосте или маршрутизаторе должна передать пакет протоколам канального уровня, которые, в свою очередь, запрашивают физический уровень для фактической отправки данных.
The data-link layer adds the appropriate header and trailer to the packet, creating a frame, before sending the frames over each physical network.|Уровень канала передачи данных добавляет к пакету соответствующий заголовок и трейлер, создавая кадр, прежде чем отправлять кадры по каждой физической сети.
|
The routing process forwards the network layer packet from end to end through the network, while each data-link frame only takes a smaller part of the trip.|В процессе маршрутизации пакет сетевого уровня пересылается из конца в конец по сети, в то время как каждый кадр канала данных занимает лишь меньшую часть пути.
Each successive datalink layer frame moves the packet to the next device that thinks about network layer logic.|Каждый последующий кадр уровня канала данных перемещает пакет к следующему устройству, которое учитывает логику сетевого уровня.
|
In short, the network layer thinks about the bigger view of the goal, like “Send this packet to the specified next router or host…,” while the data-link layer thinks about the specifics, like “Encapsulate the packet in a data-link frame and transmit it.” The following list summarizes the major steps in a router’s internal network layer routing for each packet beginning with the a frame arriving in a router interface:|Короче говоря, сетевой уровень думает о более широком видении цели, например, «Отправить этот пакет указанному следующему маршрутизатору или хосту…», в ​​то время как уровень канала данных думает о деталях, например «Инкапсулировать пакет в данные- связать кадр и передать его ». В следующем списке перечислены основные этапы внутренней маршрутизации сетевого уровня маршрутизатора для каждого пакета, начиная с кадра, поступающего в интерфейс маршрутизатора:
|
Step 1.|Шаг 1.
Use the data-link Frame Check Sequence (FCS) field to ensure that the frame had no errors; if errors occurred, discard the frame.|Используйте поле «Последовательность проверки кадра (FCS) канала передачи данных», чтобы убедиться, что в кадре нет ошибок; если произошли ошибки, отбросьте фрейм.
|
Step 2.|Шаг 2.
Assuming that the frame was not discarded at Step 1, discard the old data-link header and trailer, leaving the IP packet.|Предполагая, что кадр не был отброшен на шаге 1, отбросьте старый заголовок и трейлер канала передачи данных, оставив IP-пакет.
|
Step 3.|Шаг 3.
Compare the IP packet’s destination IP address to the routing table, and find the route that best matches the destination address.|Сравните IP-адрес назначения IP-пакета с таблицей маршрутизации и найдите маршрут, который лучше всего соответствует адресу назначения.
This route identifies the outgoing interface of the router and possibly the next-hop router IP address.|Этот маршрут идентифицирует исходящий интерфейс маршрутизатора и, возможно, IP-адрес маршрутизатора следующего перехода.
|
Step 4.|Шаг 4.
Encapsulate the IP packet inside a new data-link header and trailer, appropriate for the outgoing interface, and forward the frame.|Инкапсулируйте IP-пакет в новый заголовок и трейлер канала передачи данных, соответствующий исходящему интерфейсу, и пересылайте кадр.
|
Figure 3-11 works through a repeat example of a packet sent by PC1 to PC2, followed by a detailed analysis of each device’s routing logic.|На рис. 3-11 представлен повторный пример пакета, отправленного ПК1 на ПК2, с последующим подробным анализом логики маршрутизации каждого устройства.
Each explanation includes the details about how PC1 and each of the three routers builds the appropriate new data-link headers.|Каждое объяснение включает подробности о том, как ПК1 и каждый из трех маршрутизаторов создают соответствующие новые заголовки канала передачи данных.
|
Figure 3-11 Network Layer and Data-Link Layer Encapsulation The following list explains the forwarding logic at each router, focusing on how the routing integrates with the data link.|Рисунок 3-11 Сетевой уровень и инкапсуляция уровня канала передачи данных В следующем списке объясняется логика пересылки на каждом маршрутизаторе, уделяя особое внимание тому, как маршрутизация интегрируется с каналом передачи данных.
|
Step A.|Шаг А.
PC1 sends the packet to its default router.|ПК1 отправляет пакет своему маршрутизатору по умолчанию.
PC1’s network layer logic builds the IP packet, with a destination address of PC2’s IP address (150.150.4.10).|Логика сетевого уровня ПК1 создает IP-пакет с целевым адресом IP-адреса ПК2 (150.150.4.10).
|
The network layer also performs the analysis to decide that 150.150.4.10 is not in the local IP subnet, so PC1 needs to send the packet to R1 (PC1’s default router).|Сетевой уровень также выполняет анализ, чтобы решить, что 150.150.4.10 не находится в локальной IP-подсети, поэтому ПК1 должен отправить пакет на R1 (маршрутизатор ПК1 по умолчанию).
PC1 places the IP packet into an Ethernet data-link frame, with a destination Ethernet address of R1’s Ethernet address.|ПК1 помещает IP-пакет в кадр канала передачи данных Ethernet с целевым адресом Ethernet или адресом Ethernet маршрутизатора R1.
PC1 sends the frame on to the Ethernet.|ПК1 отправляет кадр в Ethernet.
|
Step B.|Шаг Б.
R1 processes the incoming frame and forwards the packet to R2. Because the incoming Ethernet frame has a destination MAC of R1’s Ethernet MAC, R1 decides to process the frame.|R1 обрабатывает входящий кадр и пересылает пакет R2. Поскольку входящий кадр Ethernet имеет MAC-адрес назначения, равный MAC-адресу Ethernet маршрутизатора R1, маршрутизатор R1 решает обработать кадр.
R1 checks the frame’s FCS for errors, and if none, R1 discards the Ethernet header and trailer.|R1 проверяет FCS кадра на наличие ошибок, и если их нет, R1 отбрасывает заголовок и трейлер Ethernet.
Next, R1 compares the packet’s destination address (150.150.4.10) to its routing table and finds the entry for subnet 150.150.4.0.|Затем R1 сравнивает адрес назначения пакета (150.150.4.10) со своей таблицей маршрутизации и находит запись для подсети 150.150.4.0.
Because the destination address of 150.150.4.10 is in that subnet, R1 forwards the packet out the interface listed in that matching route (Serial0) to next-hop Router R2 (150.150.2.7).|Поскольку адрес назначения 150.150.4.10 находится в этой подсети, R1 пересылает пакет из интерфейса, указанного в этом совпадающем маршруте (Serial0), на маршрутизатор следующего перехода R2 (150.150.2.7).
R1 must first encapsulate the IP packet into an HDLC frame.|R1 должен сначала инкапсулировать IP-пакет в кадр HDLC.
|
Step C.|Шаг C.
R2 processes the incoming frame and forwards the packet to R3. R2 repeats the same general process as R1 when R2 receives the HDLC frame.|R2 обрабатывает входящий кадр и пересылает пакет R3. R2 повторяет тот же общий процесс, что и R1, когда R2 принимает кадр HDLC.
R2 checks the FCS field and finds that no errors occurred and then discards the HDLC header and trailer.|R2 проверяет поле FCS и обнаруживает, что ошибок не произошло, а затем отбрасывает заголовок и трейлер HDLC.
Next, R2 compares the packet’s destination address (150.150.4.10) to its routing table and finds the entry for subnet 150.150.4.0, a route that directs R2 to send the packet out interface Fast Ethernet 0/0 to next-hop router 150.150.3.1 (R3).|Затем R2 сравнивает адрес назначения пакета (150.150.4.10) со своей таблицей маршрутизации и находит запись для подсети 150.150.4.0, маршрут, который указывает R2 отправить интерфейс передачи пакетов Fast Ethernet 0/0 на маршрутизатор следующего перехода 150.150. 3.1 (R3).
But first, R2 must encapsulate the packet in an Ethernet header.|Но сначала R2 должен инкапсулировать пакет в заголовок Ethernet.
That header uses R2’s MAC address and R3’s MAC address on the Ethernet WAN link as the source and destination MAC address, respectively.|Этот заголовок использует MAC-адрес R2 и MAC-адрес R3 в канале Ethernet WAN в качестве MAC-адреса источника и назначения соответственно.
|
Step D.|Шаг D.
R3 processes the incoming frame and forwards the packet to PC2. Like R1 and R2, R3 checks the FCS, discards the old data-link header and trailer, and matches its own route for subnet 150.150.4.0.|R3 обрабатывает входящий кадр и пересылает пакет на ПК2. Подобно R1 и R2, R3 проверяет FCS, отбрасывает старый заголовок и трейлер канала передачи данных и сопоставляет свой собственный маршрут для подсети 150.150.4.0.
R3’s routing table entry for 150.150.4.0 shows that the outgoing interface is R3’s Ethernet interface, but there is no next-hop router because R3 is connected directly to subnet 150.150.4.0.|Запись таблицы маршрутизации R3 для 150.150.4.0 показывает, что исходящий интерфейс является интерфейсом Ethernet R3, но маршрутизатора следующего перехода нет, поскольку R3 подключен непосредственно к подсети 150.150.4.0.
All R3 has to do is encapsulate the packet inside a new Ethernet header and trailer, but with a destination Ethernet address of PC2’s MAC address.|Все, что нужно сделать R3, - это инкапсулировать пакет в новый заголовок и трейлер Ethernet, но с целевым Ethernet-адресом MAC-адреса ПК2.
|
Because the routers build new data-link headers and trailers, and because the new headers contain data-link addresses, the PCs and routers must have some way to decide what datalink addresses to use.|Поскольку маршрутизаторы создают новые заголовки и трейлеры каналов данных, и поскольку новые заголовки содержат адреса каналов данных, ПК и маршрутизаторы должны иметь какой-то способ решить, какие адреса каналов данных использовать.
An example of how the router determines which data-link address to use is the IP Address Resolution Protocol (ARP). ARP dynamically learns the data-link address of an IP host connected to a LAN. For example, at the last step, at the bottom of Figure 3-11, Router R3 would use ARP once to learn PC2’s MAC address before sending any packets to PC2.|Примером того, как маршрутизатор определяет, какой адрес канала передачи данных использовать, является протокол разрешения IP-адресов (ARP). ARP динамически изучает адрес канала передачи данных IP-хоста, подключенного к локальной сети. Например, на последнем шаге в нижней части рисунка 3-11 маршрутизатор R3 будет использовать ARP один раз, чтобы узнать MAC-адрес ПК2 перед отправкой любых пакетов на ПК2.
#### How IP Addressing Helps IP Routing
Как IP-адресация помогает IP-маршрутизации   
__|__
--|--
|
IP defines network layer addresses that identify any host or router interface that connects to a TCP/IP network.|IP определяет адреса сетевого уровня, которые идентифицируют любой интерфейс хоста или маршрутизатора, который подключается к сети TCP / IP.
The idea basically works like a postal address: Any interface that expects to receive IP packets needs an IP address, just like you need a postal address before receiving mail from the postal service.|Идея в основном работает как почтовый адрес: любому интерфейсу, который ожидает получения IP-пакетов, нужен IP-адрес, точно так же, как вам нужен почтовый адрес перед получением почты от почтовой службы.
This next short topic introduces the idea of IP networks and subnets, which are the groups of addresses defined by IP.|В следующем коротком разделе представлена ​​идея IP-сетей и подсетей, которые представляют собой группы адресов, определяемые IP.
|
NOTE IP defines the word network to mean a very specific concept.|ПРИМЕЧАНИЕ IP определяет слово «сеть» как очень конкретное понятие.
To avoid confusion when writing about IP addressing, this book (and others) often avoids using the term network for other uses.|Чтобы избежать путаницы при написании об IP-адресации, в этой (и других) книгах часто избегают использования термина «сеть» для других целей.
In particular, this book uses the term internetwork to refer more generally to a network made up of routers, switches, cables, and other equipment.|В частности, в этой книге термин «объединенная сеть» используется для более общего обозначения сети, состоящей из маршрутизаторов, коммутаторов, кабелей и другого оборудования.
##### Rules for Groups of IP Addresses (Networks and Subnets)
Правила для групп IP-адресов (сетей и подсетей)   
__|__
--|--
|
TCP/IP groups IP addresses together so that IP addresses used on the same physical network are part of the same group.|TCP / IP группирует IP-адреса вместе, так что IP-адреса, используемые в одной физической сети, являются частью одной группы.
IP calls these address groups an IP network or an IP subnet.|IP называет эти группы адресов IP-сетью или IP-подсетью.
|
Using that same postal service analogy, each IP network and IP subnet works like a postal code (or in the United States, a ZIP code).|Используя ту же аналогию с почтовой службой, каждая IP-сеть и IP-подсеть работают как почтовый индекс (или в Соединенных Штатах, как почтовый индекс).
All nearby postal addresses are in the same postal code (ZIP code), while all nearby IP addresses must be in the same IP network or IP subnet.|Все ближайшие почтовые адреса имеют один и тот же почтовый индекс (почтовый индекс), в то время как все ближайшие IP-адреса должны находиться в одной IP-сети или IP-подсети.
|
IP defines specific rules about which IP address should be in the same IP network or IP subnet.|IP определяет определенные правила о том, какой IP-адрес должен находиться в той же IP-сети или IP-подсети.
|
Numerically, the addresses in the same group have the same value in the first part of the addresses.|Численно адреса в одной группе имеют одинаковое значение в первой части адресов.
For example, Figures 3-10 and 3-11 could have used the following conventions:|Например, на рисунках 3-10 и 3-11 могли использоваться следующие условные обозначения:
###### Hosts on the top Ethernet: Addresses start with 150.150.1
Хосты наверху Ethernet: адреса начинаются с 150.150.1   
###### Hosts on the R1–R2 serial link: Addresses start with 150.150.2
Хосты на последовательном канале R1 – R2: адреса начинаются с 150.150.2.   
###### Hosts on the R2–R3 EoMPLS link: Addresses start with 150.150.3
Хосты по ссылке EoMPLS R2 – R3: адреса начинаются с 150.150.3.   
###### Hosts on the bottom Ethernet: Addresses start with 150.150.4
Хосты в нижнем Ethernet: адреса начинаются с 150.150.4   
__|__
--|--
|
From the perspective of IP routing, the grouping of IP addresses means that the routing table can be much smaller.|С точки зрения IP-маршрутизации группировка IP-адресов означает, что таблица маршрутизации может быть намного меньше.
A router can list one routing table entry for each IP network or subnet, instead of one entry for every single IP address.|Маршрутизатор может указать одну запись в таблице маршрутизации для каждой IP-сети или подсети вместо одной записи для каждого IP-адреса.
|
While the list shows just one example of how IP addresses may be grouped, the rules for how to group addresses using subnets will require some work to master the concepts and math.|Хотя в списке показан только один пример того, как могут быть сгруппированы IP-адреса, правила группировки адресов с использованием подсетей потребуют некоторой работы для усвоения концепций и математики.
Part III of this book details IP addressing and subnetting, and you can find other subnetting video and practice products listed in the Introduction to the book.|В части III этой книги подробно описываются IP-адресация и разбиение на подсети, а во введении к книге вы можете найти другие видеоматериалы и практические продукты для разбиения на подсети.
However, the brief version of two of the foundational rules of subnetting can be summarized as follows:|Однако краткую версию двух основополагающих правил разбиения на подсети можно резюмировать следующим образом:
###### Two IP addresses, not separated from each other by a router, must be in the same group
Два IP-адреса, не отделенных друг от друга маршрутизатором, должны быть в одной группе.   
__|__
--|--
|
(subnet).|(подсеть).
###### Two IP addresses, separated from each other by at least one router, must be in different
Два IP-адреса, отделенные друг от друга хотя бы одним маршрутизатором, должны находиться в разных   
__|__
--|--
|
groups (subnets).|группы (подсети).
|
It’s similar to the USPS ZIP code system and how it requires local governments to assign addresses to new buildings.|Он похож на систему почтовых индексов USPS и требует от местных органов власти присваивать адреса новым зданиям.
It would be ridiculous to have two houses next door to each other, whose addresses had different postal/ZIP codes.|Было бы смешно иметь два дома рядом друг с другом, адреса которых имели разные почтовые индексы.
Similarly, it would be silly to have people who live on opposite sides of the country to have addresses with the same postal/|Точно так же было бы глупо иметь людей, живущих на разных концах страны, с одинаковыми почтовыми адресами.
|
ZIP code.|Индекс.
##### The IP Header
Заголовок IP   
__|__
--|--
|
The routing process also makes use of the IPv4 header, as shown in Figure 3-12.|В процессе маршрутизации также используется заголовок IPv4, как показано на рисунке 3-12.
The header lists a 32-bit source IP address, as well as a 32-bit destination IP address.|В заголовке указывается 32-битный IP-адрес источника, а также 32-битный IP-адрес назначения.
The header, of course, has other fields, a few of which matter for other discussions in this book.|В заголовке, конечно же, есть и другие поля, некоторые из которых имеют значение для других обсуждений в этой книге.
The book will refer to this figure as needed, but otherwise, be aware of the 20-byte IP header and the existence of the source and destination IP address fields.|Книга будет ссылаться на этот рисунок по мере необходимости, но в остальном помните о 20-байтовом IP-заголовке и существовании полей IP-адреса источника и назначения.
Note that in the examples so far in this chapter, while routers remove and add data-link headers each time it routes a packet, the IP header remains, with the IP addresses unchanged by the IP routing process.|Обратите внимание, что в примерах, приведенных до сих пор в этой главе, хотя маршрутизаторы удаляют и добавляют заголовки канала передачи данных каждый раз, когда он направляет пакет, заголовок IP остается, а IP-адреса не меняются в процессе маршрутизации IP.
|
Figure 3-12 IPv4 Header, Organized as 4 Bytes Wide for a Total of 20 Bytes|Рисунок 3-12 Заголовок IPv4, организованный как 4 байта, всего 20 байтов
#### How IP Routing Protocols Help IP Routing
Как протоколы IP-маршрутизации помогают IP-маршрутизации   
__|__
--|--
|
For routing logic to work on both hosts and routers, each host and router needs to know something about the TCP/IP internetwork.|Чтобы логика маршрутизации работала как на хостах, так и на маршрутизаторах, каждый хост и маршрутизатор должны кое-что знать об объединенной сети TCP / IP.
Hosts need to know the IP address of their default router so that hosts can send packets to remote destinations.|Хосты должны знать IP-адрес своего маршрутизатора по умолчанию, чтобы хосты могли отправлять пакеты удаленным адресатам.
Routers, however, need to know routes so they forward packets to each and every reachable IP network and IP subnet.|Однако маршрутизаторам необходимо знать маршруты, чтобы они пересылали пакеты в каждую доступную IP-сеть и IP-подсеть.
|
The best method for routers to know all the useful routes is to configure the routers to use the same IP routing protocol.|Лучший способ узнать все полезные маршруты маршрутизаторам - это настроить маршрутизаторы на использование одного и того же протокола IP-маршрутизации.
Alternately, a network engineer could configure (type) all the required routes, on every router.|В качестве альтернативы сетевой инженер может настроить (ввести) все необходимые маршруты на каждом маршрутизаторе.
However, if you enable the same routing protocol on all the routers in a TCP/IP internetwork, with the correct settings, the routers will send routing protocol messages to each other.|Однако, если вы включите один и тот же протокол маршрутизации на всех маршрутизаторах в объединенной сети TCP / IP с правильными настройками, маршрутизаторы будут отправлять сообщения протокола маршрутизации друг другу.
As a result, all the routers will learn routes for all the IP networks and subnets in the TCP/IP internetwork.|В результате все маршрутизаторы узнают маршруты для всех IP-сетей и подсетей в объединенной сети TCP / IP.
|
IP supports a small number of different IP routing protocols.|IP поддерживает небольшое количество различных протоколов IP-маршрутизации.
All use some similar ideas and processes to learn IP routes, but different routing protocols do have some internal differences;|Все они используют схожие идеи и процессы для изучения IP-маршрутов, но разные протоколы маршрутизации имеют некоторые внутренние различия;
|
otherwise, you would not need more than one routing protocol.|в противном случае вам не потребуется более одного протокола маршрутизации.
However, many routing protocols use the same general steps for learning routes:|Однако многие протоколы маршрутизации используют одни и те же общие шаги для изучения маршрутов:
|
Step 1.|Шаг 1.
Each router, independent of the routing protocol, adds a route to its routing table for each subnet directly connected to the router.|Каждый маршрутизатор, независимо от протокола маршрутизации, добавляет маршрут в свою таблицу маршрутизации для каждой подсети, напрямую подключенной к маршрутизатору.
|
Step 2.|Шаг 2.
Each router’s routing protocol tells its neighbors about the routes in its routing table, including the directly connected routes and routes learned from other routers.|Протокол маршрутизации каждого маршрутизатора сообщает своим соседям о маршрутах в своей таблице маршрутизации, включая напрямую подключенные маршруты и маршруты, полученные от других маршрутизаторов.
|
Step 3.|Шаг 3.
After learning a new route from a neighbor, the router’s routing protocol adds a route to its IP routing table, with the next-hop router of that route typically being the neighbor from which the route was learned.|После изучения нового маршрута от соседа протокол маршрутизации маршрутизатора добавляет маршрут в свою таблицу IP-маршрутизации, при этом маршрутизатор следующего перехода этого маршрута обычно является соседом, от которого был получен маршрут.
|
Also, note that at the final step, routers may have to choose between multiple routes to reach a single subnet.|Также обратите внимание, что на последнем этапе маршрутизаторам, возможно, придется выбирать между несколькими маршрутами, чтобы достичь одной подсети.
When that happens, routers place the best currently available route to reach a subnet (based on a measurement called a metric) into the routing table.|Когда это происходит, маршрутизаторы помещают лучший из доступных на данный момент маршрутов для достижения подсети (на основе измерения, называемого метрикой) в таблице маршрутизации.
|
Figure 3-13 shows an example of how a routing protocol works, using the same diagram as in Figures 3-10 and 3-11.|На рисунке 3-13 показан пример того, как работает протокол маршрутизации, с использованием той же схемы, что и на рисунках 3-10 и 3-11.
In this case, IP subnet 150.150.4.0, which consists of all addresses that begin with 150.150.4.0, sits on the Ethernet at the bottom of the figure.|В этом случае IP-подсеть 150.150.4.0, которая состоит из всех адресов, начинающихся с 150.150.4.0, находится в Ethernet в нижней части рисунка.
The figure shows the advertisement of routes for subnet 150.150.4.0 from bottom to top, as described in detail following the figure.|На рисунке показано объявление маршрутов для подсети 150.150.4.0 снизу вверх, как подробно описано после рисунка.
|
Figure 3-13 Example of How Routing Protocols Advertise About Networks and Subnets Follow items A through F shown in the figure to see how each router learns its route to 150.150.4.0.|Рисунок 3-13 Пример того, как протоколы маршрутизации объявляют о сетях и подсетях Следуйте пунктам от A до F, показанным на рисунке, чтобы увидеть, как каждый маршрутизатор изучает свой маршрут к 150.150.4.0.
|
Step A.|Шаг А.
Subnet 150.150.4.0 exists as a subnet at the bottom of the figure, connected to Router R3.|Подсеть 150.150.4.0 существует как подсеть в нижней части рисунка, подключенная к маршрутизатору R3.
|
Step B.|Шаг Б.
R3 adds a connected route for 150.150.4.0 to its IP routing table; this happens without help from the routing protocol.|R3 добавляет подключенный маршрут для 150.150.4.0 в свою таблицу IP-маршрутизации; это происходит без помощи протокола маршрутизации.
|
Step C.|Шаг C.
R3 sends a routing protocol message, called a routing update, to R2, causing R2 to learn about subnet 150.150.4.0.|R3 отправляет сообщение протокола маршрутизации, называемое обновлением маршрутизации, на R2, в результате чего R2 узнает о подсети 150.150.4.0.
|
Step D.|Шаг D.
R2 adds a route for subnet 150.150.4.0 to its routing table.|R2 добавляет маршрут для подсети 150.150.4.0 в свою таблицу маршрутизации.
|
Step E.|Шаг E.
R2 sends a similar routing update to R1, causing R1 to learn about subnet 150.150.4.0.|R2 отправляет аналогичное обновление маршрутизации R1, в результате чего R1 узнает о подсети 150.150.4.0.
|
Step F.|Шаг F.
R1 adds a route for subnet 150.150.4.0 to its routing table.|R1 добавляет маршрут для подсети 150.150.4.0 в свою таблицу маршрутизации.
The route lists R1’s own Serial0 as the outgoing interface and R2 as the next-hop router IP address (150.150.2.7).|Маршрут указывает собственный Serial0 маршрутизатора R1 в качестве исходящего интерфейса, а R2 - в качестве IP-адреса маршрутизатора следующего перехода (150.150.2.7).
### Other Network Layer Features
Другие функции сетевого уровня   
__|__
--|--
|
The TCP/IP network layer defines many functions beyond IP. Sure, IP plays a huge role in networking today, defining IP addressing and IP routing.|Сетевой уровень TCP / IP определяет множество функций помимо IP. Несомненно, IP сегодня играет огромную роль в сетевых технологиях, определяя IP-адресацию и IP-маршрутизацию.
However, other protocols and standards, defined in other Requests For Comments (RFC), play an important role for network layer functions as well.|Однако другие протоколы и стандарты, определенные в других запросах на комментарии (RFC), также играют важную роль для функций сетевого уровня.
For example, routing protocols like Open Shortest Path First (OSPF)|Например, протоколы маршрутизации, такие как Open Shortest Path First (OSPF)
|
exist as separate protocols, defined in separate RFCs.|существуют как отдельные протоколы, определенные в отдельных RFC.
|
This last short section of the chapter introduces three other network layer features that should be helpful to you when reading through the rest of this book.|В этом последнем коротком разделе главы представлены три другие функции сетевого уровня, которые должны быть вам полезны при чтении остальной части этой книги.
These last three topics just help fill in a few holes, helping to give you some perspective and helping you make sense of later discussions as well.|Эти последние три темы просто помогают заполнить несколько пробелов, помогая дать вам некоторую перспективу и помочь вам разобраться в более поздних обсуждениях.
The three topics are|Три темы
###### Domain Name System (DNS)
Система доменных имен (DNS)   
###### Address Resolution Protocol (ARP)
Протокол разрешения адресов (ARP)   
###### Ping
пинг   
#### Using Names and the Domain Name System
Использование имен и системы доменных имен   
__|__
--|--
|
Can you imagine a world in which every time you used an application, you had to refer to it by IP address?|Можете ли вы представить себе мир, в котором каждый раз, когда вы использовали приложение, вам приходилось обращаться к нему по IP-адресу?
Instead of using easy names like google.com or facebook.com, you would have to remember and type IP addresses, like 64.233.177.100. (At press time, 64.233.177.100 was an address used by Google, and you could reach Google’s website by typing that address in a browser.) Certainly, asking users to remember IP addresses would not be user friendly and could drive some people away from using computers at all.|Вместо использования простых имен, таких как google.com или facebook.com, вам нужно запомнить и ввести IP-адреса, например 64.233.177.100. (На момент публикации 64.233.177.100 был адресом, используемым Google, и вы могли попасть на веб-сайт Google, набрав этот адрес в браузере.) Конечно, просить пользователей запомнить IP-адреса было бы неудобно для пользователя и могло бы оттолкнуть некоторых людей от используя компьютеры вообще.
|
Thankfully, TCP/IP defines a way to use hostnames to identify other computers.|К счастью, TCP / IP определяет способ использования имен хостов для идентификации других компьютеров.
The user either never thinks about the other computer or refers to the other computer by name.|Пользователь либо никогда не думает о другом компьютере, либо обращается к нему по имени.
Then, protocols dynamically discover all the necessary information to allow communications based on that name.|Затем протоколы динамически обнаруживают всю необходимую информацию, чтобы разрешить обмен данными на основе этого имени.
|
For example, when you open a web browser and type in the hostname www.google.com, your computer does not send an IP packet with destination IP address www.google.com; it sends an IP packet to an IP address used by the web server for Google.|Например, когда вы открываете веб-браузер и вводите имя хоста www.google.com, ваш компьютер не отправляет IP-пакет с целевым IP-адресом www.google.com; он отправляет IP-пакет на IP-адрес, используемый веб-сервером для Google.
TCP/IP needs a way to let a computer find the IP address used by the listed hostname, and that method uses the Domain Name System (DNS).|TCP / IP необходим способ, позволяющий компьютеру находить IP-адрес, используемый указанным именем хоста, и этот метод использует систему доменных имен (DNS).
|
Enterprises use the DNS process to resolve names into the matching IP address, as shown in the example in Figure 3-14.|Предприятия используют процесс DNS для преобразования имен в соответствующий IP-адрес, как показано в примере на рис. 3-14.
In this case, PC11, on the left, needs to connect to a server named Server1.|В этом случае ПК11 слева должен подключиться к серверу с именем Server1.
At some point, the user either types in the name Server1 or some application on PC11 refers to that server by name.|В какой-то момент пользователь либо вводит имя Server1, либо какое-то приложение на PC11 обращается к этому серверу по имени.
At Step 1, PC11 sends a DNS message—a DNS query—to the DNS server.|На шаге 1 ПК11 отправляет DNS-сообщение - DNS-запрос - DNS-серверу.
At Step 2, the DNS server sends back a DNS reply that lists Server1’s IP address.|На шаге 2 DNS-сервер отправляет ответ DNS, в котором указывается IP-адрес Server1.
At Step 3, PC11 can now send an IP packet to destination address|На шаге 3 ПК11 теперь может отправить IP-пакет на адрес назначения.
###### 10.1.2.3, the address used by Server1.
10.1.2.3, адрес, используемый Server1.   
__|__
--|--
|
Figure 3-14 Basic DNS Name Resolution Request Note that the example in Figure 3-14 shows a cloud for the TCP/IP network because the details of the network, including routers, do not matter to the name resolution process.|Рисунок 3-14 Базовый запрос разрешения имени DNS Обратите внимание, что в примере на рисунке 3-14 показано облако для сети TCP / IP, поскольку детали сети, включая маршрутизаторы, не имеют значения для процесса разрешения имени.
|
Routers treat the DNS messages just like any other IP packet, routing them based on the destination IP address.|Маршрутизаторы обрабатывают сообщения DNS так же, как любой другой IP-пакет, маршрутизируя их на основе IP-адреса назначения.
For example, at Step 1 in the figure, the DNS query will list the DNS server’s IP address as the destination address, which any routers will use to forward the packet.|Например, на шаге 1 на рисунке в запросе DNS будет указан IP-адрес DNS-сервера в качестве адреса назначения, который любой маршрутизатор будет использовать для пересылки пакета.
|
Finally, DNS defines much more than just a few messages.|Наконец, DNS определяет гораздо больше, чем просто несколько сообщений.
DNS defines protocols, as well as standards for the text names used throughout the world, and a worldwide set of distributed DNS servers.|DNS определяет протоколы, а также стандарты для текстовых имен, используемых во всем мире, и всемирный набор распределенных DNS-серверов.
The domain names that people use every day when web browsing, which look like www.example.com, follow the DNS naming standards.|Доменные имена, которые люди используют каждый день при просмотре веб-страниц, которые выглядят как www.example.com, соответствуют стандартам именования DNS.
Also, no single DNS server knows all the names and matching IP addresses, but the information is distributed across many DNS servers.|Кроме того, ни один DNS-сервер не знает все имена и соответствующие IP-адреса, но информация распределяется по многим DNS-серверам.
So, the DNS servers of the world work together, forwarding queries to each other, until the server that knows the answer supplies the desired IP address information.|Итак, мировые DNS-серверы работают вместе, пересылая запросы друг другу, пока сервер, который знает ответ, не предоставит желаемую информацию об IP-адресе.
#### The Address Resolution Protocol
Протокол разрешения адресов   
__|__
--|--
|
As discussed in depth throughout this chapter, IP routing logic requires that hosts and routers encapsulate IP packets inside data-link layer frames.|Как подробно обсуждается в этой главе, логика IP-маршрутизации требует, чтобы хосты и маршрутизаторы инкапсулировали IP-пакеты внутри кадров уровня канала данных.
For Ethernet interfaces, how does a router know what MAC address to use for the destination?|Для интерфейсов Ethernet, как маршрутизатор узнает, какой MAC-адрес использовать для назначения?
It uses ARP.|Он использует ARP.
|
On Ethernet LANs, whenever a host or router needs to encapsulate an IP packet in a new Ethernet frame, the host or router knows all the important facts to build that header—except for the destination MAC address.|В локальных сетях Ethernet, когда хосту или маршрутизатору необходимо инкапсулировать IP-пакет в новый кадр Ethernet, хост или маршрутизатор знает все важные факты для построения этого заголовка, за исключением MAC-адреса назначения.
The host knows the IP address of the next device, either another host IP address or the default router IP address.|Хосту известен IP-адрес следующего устройства, либо IP-адрес другого хоста, либо IP-адрес маршрутизатора по умолчанию.
A router knows the IP route used for forwarding the IP packet, which lists the next router’s IP address.|Маршрутизатору известен IP-маршрут, используемый для пересылки IP-пакета, в котором указан IP-адрес следующего маршрутизатора.
However, the hosts and routers do not know those neighboring devices’ MAC addresses beforehand.|Однако хосты и маршрутизаторы заранее не знают MAC-адреса этих соседних устройств.
|
TCP/IP defines the Address Resolution Protocol (ARP) as the method by which any host or router on a LAN can dynamically learn the MAC address of another IP host or router on the same LAN. ARP defines a protocol that includes the ARP Request, which is a message that makes the simple request “if this is your IP address, please reply with your MAC address.”|TCP / IP определяет протокол разрешения адресов (ARP) как метод, с помощью которого любой хост или маршрутизатор в локальной сети может динамически узнавать MAC-адрес другого IP-хоста или маршрутизатора в той же локальной сети. ARP определяет протокол, который включает запрос ARP, который представляет собой сообщение, которое делает простой запрос «если это ваш IP-адрес, ответьте, указав свой MAC-адрес».
|
ARP also defines the ARP Reply message, which indeed lists both the original IP address and the matching MAC address.|ARP также определяет ответное сообщение ARP, в котором действительно перечислены как исходный IP-адрес, так и соответствующий MAC-адрес.
|
Figure 3-15 shows an example that uses the same router and host from the bottom part of the earlier Figure 3-13.|На рис. 3-15 показан пример, в котором используются тот же маршрутизатор и хост, что и в нижней части предыдущего рисунка 3-13.
The figure shows the ARP Request sent by router R3, on the left of the figure, as a LAN broadcast.|На рисунке слева показан запрос ARP, отправленный маршрутизатором R3, в виде широковещательной рассылки по локальной сети.
All devices on the LAN will then process the received frame.|После этого все устройства в локальной сети обработают полученный кадр.
|
On the right, at Step 2, host PC2 sends back an ARP Reply, identifying PC2’s MAC address.|Справа, на шаге 2, хост ПК2 отправляет ответ ARP, идентифицируя MAC-адрес ПК2.
|
The text beside each message shows the contents inside the ARP message itself, which lets PC2 learn R3’s IP address and matching MAC address, and R3 learn PC2’s IP address and matching MAC address.|Текст рядом с каждым сообщением показывает содержимое самого сообщения ARP, что позволяет ПК2 узнать IP-адрес R3 и соответствующий MAC-адрес, а R3 узнать IP-адрес ПК2 и соответствующий MAC-адрес.
|
Note that hosts and routers remember the ARP results, keeping the information in their ARP cache or ARP table.|Обратите внимание, что хосты и маршрутизаторы запоминают результаты ARP, сохраняя информацию в своем кэше ARP или таблице ARP.
A host or router only needs to use ARP occasionally, to build the ARP cache the first time.|Хосту или маршрутизатору необходимо использовать ARP только время от времени, чтобы создать кэш ARP в первый раз.
Each time a host or router needs to send a packet encapsulated in an Ethernet frame, it first checks its ARP cache for the correct IP address and matching MAC address.|Каждый раз, когда хосту или маршрутизатору необходимо отправить пакет, инкапсулированный в кадр Ethernet, он сначала проверяет свой ARP-кеш на предмет правильного IP-адреса и соответствующего MAC-адреса.
Hosts and routers will let ARP cache entries time out to clean up the table, so occasional ARP Requests can be seen.|Хосты и маршрутизаторы позволят записям кэша ARP истечь время для очистки таблицы, поэтому могут быть видны случайные запросы ARP.
|
Figure 3-15 Sample ARP Process NOTE You can see the contents of the ARP cache on most PC operating systems by using the arp -a command from a command prompt.|Рисунок 3-15 Пример процесса ARP ПРИМЕЧАНИЕ. Вы можете увидеть содержимое кэша ARP в большинстве операционных систем ПК, используя команду arp -a из командной строки.
#### ICMP Echo and the ping Command
ICMP Echo и команда ping   
__|__
--|--
|
After you have implemented a TCP/IP internetwork, you need a way to test basic IP connectivity without relying on any applications to be working.|После того, как вы внедрили объединенную сеть TCP / IP, вам понадобится способ проверить базовое IP-соединение, не полагаясь на какие-либо работающие приложения.
The primary tool for testing basic network connectivity is the ping command.|Основным инструментом для проверки базового сетевого подключения является команда ping.
|
Ping (Packet Internet Groper) uses the Internet Control Message Protocol (ICMP), sending a message called an ICMP echo request to another IP address.|Ping (Packet Internet Groper) использует протокол управляющих сообщений Интернета (ICMP), отправляя сообщение, называемое эхо-запросом ICMP, на другой IP-адрес.
The computer with that IP address should reply with an ICMP echo reply.|Компьютер с этим IP-адресом должен ответить эхо-ответом ICMP.
If that works, you successfully have tested the IP network.|Если это работает, вы успешно протестировали IP-сеть.
In other words, you know that the network can deliver a packet from one host to the other and back.|Другими словами, вы знаете, что сеть может доставить пакет от одного хоста к другому и обратно.
ICMP does not rely on any application, so it really just tests basic IP connectivity—Layers 1, 2, and 3 of the OSI model.|ICMP не полагается на какое-либо приложение, поэтому на самом деле он просто проверяет базовое IP-соединение - уровни 1, 2 и 3 модели OSI.
Figure 3-16 outlines the basic process.|На рис. 3-16 показан основной процесс.
|
Figure 3-16 Sample Network, ping Command Note that while the ping command uses ICMP, ICMP does much more.|Рисунок 3-16. Пример сети, команда ping Обратите внимание, что хотя команда ping использует ICMP, ICMP делает гораздо больше.
ICMP defines many messages that devices can use to help manage and control the IP network.|ICMP определяет множество сообщений, которые устройства могут использовать для управления и контроля IP-сети.
### Chapter Review
Обзор главы   
__|__
--|--
|
The “Your Study Plan” element, just before Chapter 1, discusses how you should study and practice the content and skills for each chapter before moving on to the next chapter.|Элемент «Ваш учебный план», расположенный непосредственно перед главой 1, обсуждает, как вы должны изучать и практиковать содержание и навыки для каждой главы, прежде чем переходить к следующей главе.
That element introduces the tools used here at the end of each chapter.|Этот элемент знакомит с инструментами, используемыми здесь, в конце каждой главы.
If you haven’t already done so, take a few minutes to read that section.|Если вы еще этого не сделали, уделите несколько минут, чтобы прочитать этот раздел.
Then come back here and do the useful work of reviewing the chapter to help lock into memory what you just read.|Затем вернитесь сюда и проделайте полезную работу по просмотру главы, чтобы закрепить в памяти то, что вы только что прочитали.
|
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Table 3-4 outlines the key review elements and where you can find them.|В Таблице 3-4 представлены ключевые элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 3-4 Chapter Review Tracking Table end.|Таблица 3-4 Окончание таблицы отслеживания главы обзора.
|
Review All the Key Topics Table 3-5 Key Topics for Chapter 3 Table end.|Просмотрите все ключевые темы Таблица 3-5 Ключевые темы в конце таблицы 3 главы.
|
leased line, wide-area network (WAN), telco, serial interface, HDLC, Ethernet over MPLS, Ethernet Line Service (E-Line), default router (default gateway), routing table, IP network, IP subnet, IP packet, routing protocol, dotted-decimal notation (DDN), IPv4 address, unicast IP address, subnetting, hostname, DNS, ARP, ping|выделенная линия, глобальная сеть (WAN), телекоммуникационная компания, последовательный интерфейс, HDLC, Ethernet через MPLS, линия Ethernet (E-Line), маршрутизатор по умолчанию (шлюз по умолчанию), таблица маршрутизации, IP-сеть, IP-подсеть, IP-пакет, протокол маршрутизации, десятичное представление с точками (DDN), IPv4-адрес, одноадресный IP-адрес, подсети, имя хоста, DNS, ARP, ping
## Part I Review
Часть I Обзор   
__|__
--|--
|
Keep track of your part review progress with the checklist shown in Table P1-1.|Следите за ходом проверки деталей с помощью контрольного списка, приведенного в Таблице P1-1.
Details on each task follow the table.|Подробности по каждой задаче приведены в таблице.
|
Table P1-1 Part I Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Repeat All DIKTA Questions For this task, answer the “Do I Know This Already?” questions again for the chapters in this part of the book, using the PTP software.|Таблица P1-1. Контрольный список части I. Действие 1-я дата завершения 2-я дата завершения Повторить все вопросы по DIKTA Ответить на вопросы по части Обзор ключевых тем Повторить все вопросы DIKTA. еще раз задайте вопросы к главам этой части книги, используя программное обеспечение PTP.
Refer to the Introduction to this book, the section titled “How to View Only DIKTA Questions by Chapter or Part,” for help with how to make the PTP software show you DIKTA questions for this part only.|Обратитесь к введению к этой книге, раздел под названием «Как просмотреть только вопросы DIKTA по главам или частям», чтобы узнать, как заставить программное обеспечение PTP отображать вам вопросы DIKTA только для этой части.
|
Answer Part Review Questions For this task, answer the Part Review questions for this part of the book, using the PTP software.|Ответить на вопросы обзора части Для этой задачи ответьте на вопросы обзора части для этой части книги, используя программное обеспечение PTP.
Refer to the Introduction to this book, the section titled “How to View Part Review Questions,” for help with how to make the PTP software show you Part Review questions for this part only. (Note that if you use the questions but then want even more, get the Premium Edition of the book, as detailed in the Introduction, in the section “Other Features,” under the item labeled “eBook.”)|Обратитесь к введению к этой книге, раздел под названием «Как просматривать вопросы для проверки деталей», чтобы узнать, как заставить программное обеспечение PTP отображать вам вопросы проверки деталей только для этой части. (Обратите внимание, что если вы задали вопросы, но затем захотели еще большего, получите премиум-издание книги, как подробно описано во Введении в разделе «Другие функции», в пункте «Электронная книга».)
|
Review Key Topics Browse back through the chapters and look for the Key Topic icons.|Обзор ключевых тем Просмотрите главы и найдите значки ключевых тем.
If you do not remember some details, take the time to reread those topics, or use the Key Topics application(s)|Если вы не помните некоторые детали, найдите время, чтобы перечитать эти темы, или воспользуйтесь приложением (ями) Key Topics
|
found on the companion website.|найдено на сопутствующем сайте.
|
Use Per-Chapter Interactive Review Elements Using the companion website, browse through the interactive review elements, like memory tables and key term flashcards, to review the content from each chapter.|Использование элементов интерактивного обзора по главам Используя сопутствующий веб-сайт, просмотрите интерактивные элементы обзора, такие как таблицы памяти и карточки с ключевыми терминами, чтобы просмотреть содержание каждой главы.
|
Part I provided a broad look at the fundamentals of all parts of networking, focusing on Ethernet LANs, WANs, and IP routing.|В части I был дан общий обзор основ всех частей сети с упором на локальные сети Ethernet, глобальные сети и IP-маршрутизацию.
Parts II and III now drill into depth about the details of Ethernet, which was introduced in Chapter 2, “Fundamentals of Ethernet LANs.”|В частях II и III подробно рассматриваются детали Ethernet, которые были представлены в главе 2 «Основы локальных сетей Ethernet».
|
Part II begins that journey by discussing the basics of building a small Ethernet LAN with Cisco Catalyst switches.|В части II этот путь начинается с обсуждения основ построения небольшой локальной сети Ethernet с коммутаторами Cisco Catalyst.
The journey begins by showing how to access the user interface of a Cisco switch so that you can see evidence of what the switch is doing and configure the switch to act in the ways you want it to act.|Путешествие начинается с демонстрации того, как получить доступ к пользовательскому интерфейсу коммутатора Cisco, чтобы вы могли видеть доказательства того, что делает коммутатор, и настраивать коммутатор, чтобы он действовал так, как вы хотите.
At this point, you should start using whatever lab practice option you chose in the “Your Study Plan” section that preceded Chapter 1, “Introduction to TCP/IP Networking.” (And if you have not yet finalized your plan for how to practice your hands-on skills, now is the time.)|На этом этапе вам следует начать использовать любой вариант лабораторной практики, который вы выбрали в разделе «Ваш план обучения», который предшествовал главе 1 «Введение в сеть TCP / IP». (И если вы еще не завершили свой план, как практиковать свои практические навыки, сейчас самое время.)
|
After you complete Chapter 4 and see how to get into the command-line interface (CLI)|После того, как вы завершите главу 4 и увидите, как войти в интерфейс командной строки (CLI)
|
of a switch, the next three chapters step through some important foundations of how to implement LANs—foundations used by every company that builds LANs with Cisco gear.|Что касается коммутатора, то в следующих трех главах рассматриваются некоторые важные основы реализации локальных сетей - основы, используемые каждой компанией, строящей локальные сети с использованием оборудования Cisco.
|
Chapter 5 takes a close look at Ethernet switching—that is, the logic used by a switch—and how to know what a particular switch is doing.|В главе 5 подробно рассматривается коммутация Ethernet, то есть логика, используемая коммутатором, и то, как узнать, что делает конкретный коммутатор.
Chapter 6 shows the ways to configure a switch for remote access with Telnet and Secure Shell (SSH), along with a variety of other useful commands that will help you when you work with any real lab gear, simulator, or any other practice tools.|В главе 6 показаны способы настройки коммутатора для удаленного доступа с помощью Telnet и Secure Shell (SSH), а также множество других полезных команд, которые помогут вам при работе с любым реальным лабораторным оборудованием, симулятором или любыми другими инструментами для практики.
Chapter 7, the final chapter in Part II, shows how to configure and verify the operation of switch interfaces for several important features, including speed, duplex, and autonegotiation.|В главе 7, заключительной главе части II, показано, как настроить и проверить работу интерфейсов коммутатора для нескольких важных функций, включая скорость, дуплекс и автосогласование.
## Part II Implementing Ethernet LANs
Часть II Реализация локальных сетей Ethernet   
__|__
--|--
|
Part II Review|Часть II Обзор
## Chapter 4 Using the Command-Line Interface
Глава 4 Использование интерфейса командной строки   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
|
None This chapter explains foundational skills required before you can learn about the roughly 15 exam topics that use the verbs configure and verify.|Нет В этой главе объясняются базовые навыки, необходимые для изучения примерно 15 экзаменационных тем, в которых используются глаголы configure и verify.
However, Cisco does not list the foundational skills described in this chapter as a separate exam topic, so there are no specific exam topics included in this chapter.|Однако Cisco не перечисляет основные навыки, описанные в этой главе, в качестве отдельной темы экзамена, поэтому в эту главу не включены конкретные темы экзамена.
|
To create an Ethernet LAN, network engineers start by planning.|Чтобы создать локальную сеть Ethernet, сетевые инженеры начинают с планирования.
They consider the requirements, create a design, buy the switches, contract to install cables, and configure the switches to use the right features.|Они рассматривают требования, создают дизайн, покупают коммутаторы, заключают договор на установку кабелей и настраивают коммутаторы для использования нужных функций.
|
The CCNA exam focuses on skills like understanding how LANs work, configuring different switch features, verifying that those features work correctly, and finding the root cause of the problem when a feature is not working correctly.|Экзамен CCNA фокусируется на таких навыках, как понимание того, как работают локальные сети, настройка различных функций коммутатора, проверка правильности работы этих функций и обнаружение основной причины проблемы, когда функция работает неправильно.
The first skill you need to learn before doing all the configuration and verification tasks is to learn how to access and use the user interface of the switch, called the command-line interface (CLI).|Первый навык, который вам необходимо освоить перед выполнением всех задач настройки и проверки, - это узнать, как получить доступ и использовать пользовательский интерфейс коммутатора, называемый интерфейсом командной строки (CLI).
|
This chapter begins that process by showing the basics of how to access the switch’s CLI.|В этой главе этот процесс начинается с демонстрации основ доступа к интерфейсу командной строки коммутатора.
|
These skills include how to access the CLI and how to issue verification commands to check on the status of the LAN. This chapter also includes the processes of how to configure the switch and how to save that configuration.|Эти навыки включают в себя доступ к интерфейсу командной строки и запуск команд проверки для проверки состояния локальной сети. В этой главе также описаны процессы настройки коммутатора и сохранения этой конфигурации.
|
Note that this chapter focuses on processes that provide a foundation for most every exam topic that includes the verbs configure and/or verify.|Обратите внимание, что в этой главе основное внимание уделяется процессам, которые составляют основу практически каждой темы экзамена, включающей команды configure и / или verify.
Most of the rest of the chapters in Parts II and III of this book then go on to include details of the particular commands you can use to verify and configure different switch features.|В остальных главах частей II и III этой книги подробно описываются команды, которые можно использовать для проверки и настройки различных функций коммутатора.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 4-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 4-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### Accessing the Cisco Catalyst Switch CLI
Доступ к интерфейсу командной строки коммутатора Cisco Catalyst   
__|__
--|--
|
Configuring Cisco IOS Software 4–6 CHAPTER 4 1.|Настройка программного обеспечения Cisco IOS 4–6 ГЛАВА 4 1.
In what modes can you type the command show mac address-table and expect to get a response with MAC table entries? (Choose two answers.)|В каких режимах вы можете ввести команду show mac address-table и ожидать ответа с записями таблицы MAC? (Выберите два ответа.)
|
a. User mode b.|а. Пользовательский режим b.
Enable mode c.|Включить режим c.
Global configuration mode d.|Режим глобальной конфигурации d.
Interface configuration mode 2.|Режим настройки интерфейса 2.
In which of the following modes of the CLI could you type the command reload and expect the switch to reboot?|В каком из следующих режимов интерфейса командной строки вы могли бы ввести команду reload и ожидать, что коммутатор перезагрузится?
|
a. User mode b.|а. Пользовательский режим b.
Enable mode c.|Включить режим c.
Global configuration mode d.|Режим глобальной конфигурации d.
Interface configuration mode 3.|Режим настройки интерфейса 3.
Which of the following is a difference between Telnet and SSH as supported by a Cisco switch?|В чем разница между Telnet и SSH, поддерживаемыми коммутатором Cisco?
|
a. SSH encrypts the passwords used at login, but not other traffic; Telnet encrypts nothing.|а. SSH шифрует пароли, используемые при входе в систему, но не другой трафик; Telnet ничего не шифрует.
|
b. SSH encrypts all data exchange, including login passwords; Telnet encrypts nothing.|б. SSH шифрует весь обмен данными, включая пароли для входа; Telnet ничего не шифрует.
|
c. Telnet is used from Microsoft operating systems, and SSH is used from UNIX and Linux operating systems.|c. Telnet используется в операционных системах Microsoft, а SSH используется в операционных системах UNIX и Linux.
|
d. Telnet encrypts only password exchanges; SSH encrypts all data exchanges.|d. Telnet шифрует только обмен паролями; SSH шифрует все обмены данными.
|
4. What type of switch memory is used to store the configuration used by the switch when it is up and working?|4. Какой тип памяти коммутатора используется для хранения конфигурации, используемой коммутатором, когда он включен и работает?
|
a. RAM b.|а. RAM b.
ROM c.|ROM c.
Flash d.|Вспышка d.
NVRAM e.|NVRAM e.
Bubble 5.|Пузырь 5.
What command copies the configuration from RAM into NVRAM?|Какая команда копирует конфигурацию из RAM в NVRAM?
|
a. copy running-config tftp b. copy tftp running-config c. copy running-config start-up-config d. copy start-up-config running-config e. copy startup-config running-config f. copy running-config startup-config 6.|а. скопировать running-config tftp b. скопируйте tftp running-config c. скопировать рабочую конфигурацию start-up-config d. скопировать start-up-config, running-config e. скопировать start-config, running-config f. скопировать running-config startup-config 6.
A switch user is currently in console line configuration mode.|Пользователь коммутатора в настоящее время находится в режиме конфигурации линии консоли.
Which of the following would place the user in enable mode? (Choose two answers.)|Что из следующего переведет пользователя в режим включения? (Выберите два ответа.)
|
a. Using the exit command once b.|а. Однократное использование команды выхода b.
Using the end command once c.|Однократное использование команды завершения c.
Pressing the Ctrl+Z key sequence once d.|Однократное нажатие комбинации клавиш Ctrl + Z d.
Using the quit command Foundation Topics Accessing the Cisco Catalyst Switch CLI Cisco uses the concept of a command-line interface (CLI) with its router products and most of its Catalyst LAN switch products.|Использование команды quit Основные темы Доступ к интерфейсу командной строки коммутатора Cisco Catalyst Cisco использует концепцию интерфейса командной строки (CLI) в своих маршрутизаторах и большинстве коммутаторов Catalyst LAN.
The CLI is a text-based interface in which the user, typically a network engineer, enters a text command and presses Enter.|CLI - это текстовый интерфейс, в котором пользователь, обычно сетевой инженер, вводит текстовую команду и нажимает Enter.
Pressing Enter sends the command to the switch, which tells the device to do something.|Нажатие Enter отправляет команду на коммутатор, который говорит устройству что-то сделать.
The switch does what the command says, and in some cases, the switch replies with some messages stating the results of the command.|Коммутатор выполняет то, что говорит команда, и в некоторых случаях коммутатор отвечает некоторыми сообщениями, в которых указываются результаты выполнения команды.
|
Cisco Catalyst switches also support other methods to both monitor and configure a switch.|Коммутаторы Cisco Catalyst также поддерживают другие методы как для мониторинга, так и для настройки коммутатора.
|
For example, a switch can provide a web interface so that an engineer can open a web browser to connect to a web server running in the switch.|Например, коммутатор может предоставлять веб-интерфейс, чтобы инженер мог открыть веб-браузер для подключения к веб-серверу, работающему в коммутаторе.
Switches also can be controlled and operated using network management software.|Коммутаторами также можно управлять с помощью программного обеспечения для управления сетью.
|
This book discusses only Cisco Catalyst enterprise-class switches, and in particular, how to use the Cisco CLI to monitor and control these switches.|В этой книге обсуждаются только коммутаторы Cisco Catalyst корпоративного класса, и в частности, как использовать Cisco CLI для мониторинга и управления этими коммутаторами.
This first major section of the chapter first examines these Catalyst switches in more detail and then explains how a network engineer can get access to the CLI to issue commands.|В этом первом основном разделе главы сначала рассматриваются эти коммутаторы Catalyst более подробно, а затем объясняется, как сетевой инженер может получить доступ к интерфейсу командной строки для выполнения команд.
#### Cisco Catalyst Switches
Коммутаторы Cisco Catalyst   
__|__
--|--
|
Within the Cisco Catalyst brand of LAN switches, Cisco produces a wide variety of switch series or families.|В рамках торговой марки коммутаторов LAN Cisco Catalyst Cisco производит широкий выбор серий или семейств коммутаторов.
Each switch series includes several specific models of switches that have similar features, similar price-versus-performance tradeoffs, and similar internal components.|Каждая серия коммутаторов включает в себя несколько конкретных моделей коммутаторов, которые имеют схожие характеристики, одинаковое соотношение цены и производительности и аналогичные внутренние компоненты.
|
For example, at the time this book was published, the Cisco 2960-XR series of switches was a current switch model series.|Например, на момент публикации этой книги серия коммутаторов Cisco 2960-XR была текущей серией моделей коммутаторов.
Cisco positions the 2960-XR series (family) of switches as full-featured, low-cost wiring closet switches for enterprises.|Cisco позиционирует коммутаторы серии 2960-XR как полнофункциональные недорогие коммутаторы для коммутационных шкафов для предприятий.
That means that you would expect to use 2960-XR switches as access switches in a typical campus LAN design.|Это означает, что вы ожидаете использовать коммутаторы 2960-XR в качестве коммутаторов доступа в типичной конструкции локальной сети кампуса.
|
Figure 4-1 shows a photo of 10 different models from the 2960-XR switch model series from Cisco.|На рис. 4-1 показаны фотографии 10 различных моделей коммутаторов серии 2960-XR от Cisco.
Each switch series includes several models, with a mix of features.|Каждая серия переключателей включает в себя несколько моделей со множеством функций.
For example, some of the switches have 48 RJ-45 unshielded twisted-pair (UTP) 10/100/1000 ports, meaning that these ports can autonegotiate the use of 10BASE-T (10 Mbps), 100BASE-T (100 Mbps), or 1000BASE-T (1 Gbps) Ethernet.|Например, некоторые из коммутаторов имеют 48 портов неэкранированной витой пары (UTP) RJ-45 10/100/1000, что означает, что эти порты могут автоматически согласовывать использование 10BASE-T (10 Мбит / с), 100BASE-T (100 Мбит / с). или 1000BASE-T (1 Гбит / с) Ethernet.
|
Figure 4-1 Cisco 2960-XR Catalyst Switch Series Cisco refers to a switch’s physical connectors as either interfaces or ports, with an interface type and interface number.|Рис. 4-1. Коммутаторы серии Cisco 2960-XR Catalyst Cisco называет физические разъемы коммутатора интерфейсами или портами с указанием типа и номера интерфейса.
The interface type, as used in commands on the switch, is either Ethernet, Fast Ethernet, Gigabit Ethernet, and so on for faster speeds.|Тип интерфейса, используемый в командах на коммутаторе, - Ethernet, Fast Ethernet, Gigabit Ethernet и т. Д. Для более высоких скоростей.
For Ethernet interfaces that support running at multiple speeds, the permanent name for the interface refers to the fastest supported speed.|Для интерфейсов Ethernet, которые поддерживают работу на нескольких скоростях, постоянное имя интерфейса относится к максимальной поддерживаемой скорости.
For example, a 10/100/1000 interface (that is, an interface that runs at 10 Mbps, 100 Mbps, or 1000 Mbps) would be called Gigabit Ethernet no matter what speed is currently in use.|Например, интерфейс 10/100/1000 (то есть интерфейс, работающий на скорости 10, 100 или 1000 Мбит / с) будет называться Gigabit Ethernet независимо от того, какая скорость используется в настоящее время.
|
To uniquely number each different interface, some Catalyst switches use a two-digit interface number (x/y), while others have a three-digit number (x/y/z).|Чтобы однозначно пронумеровать каждый интерфейс, некоторые коммутаторы Catalyst используют двузначный номер интерфейса (x / y), а другие - трехзначный номер (x / y / z).
For instance, two 10/100/1000 ports on many older Cisco Catalyst switches would be called GigabitEthernet 0/0 and GigabitEthernet 0/1, while on the newer 2960-XR series, two interfaces would be GigabitEthernet 1/0/1 and GigabitEthernet 1/0/2.|Например, два порта 10/100/1000 на многих старых коммутаторах Cisco Catalyst будут называться GigabitEthernet 0/0 и GigabitEthernet 0/1, в то время как в более новой серии 2960-XR два интерфейса будут называться GigabitEthernet 1/0/1 и GigabitEthernet. 1/0/2.
#### Accessing the Cisco IOS CLI
Доступ к интерфейсу командной строки Cisco IOS   
__|__
--|--
|
Like any other piece of computer hardware, Cisco switches need some kind of operating system software.|Как и любому другому компьютерному оборудованию, коммутаторам Cisco требуется какое-то программное обеспечение операционной системы.
Cisco calls this OS the Internetwork Operating System (IOS).|Cisco называет эту ОС Межсетевой операционной системой (IOS).
|
Cisco IOS Software for Catalyst switches implements and controls logic and functions performed by a Cisco switch.|Программное обеспечение Cisco IOS для коммутаторов Catalyst реализует и контролирует логику и функции, выполняемые коммутатором Cisco.
Besides controlling the switch’s performance and behavior, Cisco IOS also defines an interface for humans called the CLI. The Cisco IOS CLI allows the user to use a terminal emulation program, which accepts text entered by the user.|Помимо управления производительностью и поведением коммутатора, Cisco IOS также определяет интерфейс для людей, называемый CLI. Интерфейс командной строки Cisco IOS позволяет пользователю использовать программу эмуляции терминала, которая принимает текст, введенный пользователем.
When the user presses Enter, the terminal emulator sends that text to the switch.|Когда пользователь нажимает Enter, эмулятор терминала отправляет этот текст коммутатору.
The switch processes the text as if it is a command, does what the command says, and sends text back to the terminal emulator.|Коммутатор обрабатывает текст, как будто это команда, выполняет то, что команда говорит, и отправляет текст обратно в эмулятор терминала.
|
The switch CLI can be accessed through three popular methods—the console, Telnet, and Secure Shell (SSH). Two of these methods (Telnet and SSH) use the IP network in which the switch resides to reach the switch.|Доступ к интерфейсу командной строки коммутатора можно получить с помощью трех популярных методов - консоли, Telnet и Secure Shell (SSH). Два из этих методов (Telnet и SSH) используют IP-сеть, в которой находится коммутатор, для достижения коммутатора.
The console is a physical port built specifically to allow access to the CLI. Figure 4-2 depicts the options.|Консоль - это физический порт, созданный специально для доступа к CLI. На рис. 4-2 показаны варианты.
|
Figure 4-2 CLI Access Options Console access requires both a physical connection between a PC (or other user device) and the switch’s console port, as well as some software on the PC. Telnet and SSH require software on the user’s device, but they rely on the existing TCP/IP network to transmit data.|Рис. 4-2 Параметры доступа через интерфейс командной строки Для доступа к консоли требуется физическое соединение между ПК (или другим пользовательским устройством) и консольным портом коммутатора, а также некоторое программное обеспечение на ПК. Telnet и SSH требуют наличия программного обеспечения на устройстве пользователя, но для передачи данных они полагаются на существующую сеть TCP / IP.
The next few pages detail how to connect the console and set up the software for each method to access the CLI.|На следующих нескольких страницах подробно описано, как подключить консоль и настроить программное обеспечение для каждого метода доступа к интерфейсу командной строки.
##### Cabling the Console Connection
Кабельное соединение с консолью   
__|__
--|--
|
The physical console connection, both old and new, uses three main components: the physical console port on the switch, a physical serial port on the PC, and a cable that works with the console and serial ports.|Физическое консольное соединение, как старое, так и новое, использует три основных компонента: физический консольный порт на коммутаторе, физический последовательный порт на ПК и кабель, который работает с консолью и последовательными портами.
However, the physical cabling details have changed slowly over time, mainly because of advances and changes with serial interfaces on PC hardware.|Однако детали физических кабелей со временем менялись медленно, в основном из-за достижений и изменений в последовательных интерфейсах на оборудовании ПК.
For this next topic, the text looks at three cases: newer connectors on both the PC and the switch, older connectors on both, and a third case with the newer (USB) connector on the PC but with an older connector on the switch.|В этой следующей теме в тексте рассматриваются три случая: более новые разъемы на ПК и коммутаторе, более старые разъемы на обоих и третий случай с более новым (USB) разъемом на ПК, но со старым разъемом на коммутаторе.
|
Most PCs today use a familiar standard USB cable for the console connection.|В большинстве современных ПК для подключения консоли используется знакомый стандартный USB-кабель.
Cisco has been including USB ports as console ports in newer routers and switches as well.|Cisco также включает порты USB в качестве консольных портов в новые маршрутизаторы и коммутаторы.
All you have to do is look at the switch to make sure you have the correct style of USB cable end to match the USB console port.|Все, что вам нужно сделать, это посмотреть на коммутатор, чтобы убедиться, что у вас правильный тип конца USB-кабеля, соответствующий консольному порту USB.
In the simplest form, you can use any USB port on the PC, with a USB cable, connected to the USB console port on the switch or router, as shown on the far right side of Figure 4-3.|В простейшей форме вы можете использовать любой порт USB на ПК с помощью кабеля USB, подключенного к консольному порту USB на коммутаторе или маршрутизаторе, как показано в правой части рисунка 4-3.
|
Figure 4-3 Console Connection to a Switch Older console connections use a PC serial port that pre-dates USB, a UTP cable, and an RJ-45 console port on the switch, as shown on the left side of Figure 4-3.|Рисунок 4-3 Подключение консоли к коммутатору В старых версиях консольных подключений используется последовательный порт ПК, предшествующий USB, кабель UTP и консольный порт RJ-45 на коммутаторе, как показано в левой части рисунка 4-3.
The PC serial port typically has a D-shell connector (roughly rectangular) with nine pins (often called a DB-9).|Последовательный порт ПК обычно имеет D-образный разъем (примерно прямоугольной формы) с девятью контактами (часто называемый DB-9).
|
The console port looks like any Ethernet RJ-45 port (but is typically colored in blue and with the word console beside it on the switch).|Консольный порт выглядит как любой порт Ethernet RJ-45 (но обычно окрашен в синий цвет, а рядом с ним на коммутаторе написано слово console).
|
The cabling for this older-style console connection can be simple or require some effort, depending on what cable you use.|Кабели для этого консольного подключения старого типа могут быть простыми или потребовать некоторых усилий, в зависимости от того, какой кабель вы используете.
You can use the purpose-built console cable that ships with new Cisco switches and routers and not think about the details.|Вы можете использовать специальный консольный кабель, который поставляется с новыми коммутаторами и маршрутизаторами Cisco, и не думать о деталях.
However, you can make Answers to the “Do I Know This Already?” quiz:|Однако вы можете ответить на вопрос «Знаю ли я это уже?» викторина:
|
1 A, B 2 B 3 B 4 A 5 F 6 B, C your own cable with a standard serial cable (with a connector that matches the PC), a standard RJ-45 to DB-9 converter plug, and a UTP cable.|1 A, B 2 B 3 B 4 A 5 F 6 B, C собственный кабель со стандартным последовательным кабелем (с разъемом, который соответствует компьютеру), стандартный переходник RJ-45 в DB-9 и кабель UTP .
However, the UTP cable does not use the same pinouts as Ethernet; instead, the cable uses rollover cable pinouts rather than any of the standard Ethernet cabling pinouts.|Однако кабель UTP не использует те же выводы, что и Ethernet; вместо этого в кабеле используются выводы переключаемого кабеля, а не какие-либо стандартные выводы кабелей Ethernet.
The rollover pinout uses eight wires, rolling the wire at pin 1 to pin 8, pin 2 to pin 7, pin 3 to pin 6, and so on.|Распиновка для опрокидывания использует восемь проводов, наматывающих провод от контакта 1 к контакту 8, от контакта 2 к контакту 7, контакта 3 к контакту 6 и так далее.
|
As it turns out, USB ports became common on PCs before Cisco began commonly using USB for its console ports.|Как оказалось, порты USB стали обычным явлением на ПК до того, как Cisco начала широко использовать USB для своих консольных портов.
So, you also have to be ready to use a PC that has only a USB port and not an old serial port, but a router or switch that has the older RJ-45 console port (and no USB console port).|Таким образом, вы также должны быть готовы к использованию ПК, у которого есть только порт USB, а не старый последовательный порт, а маршрутизатор или коммутатор с более старым консольным портом RJ-45 (и без консольного порта USB).
The center of Figure 4-3 shows that case.|В центре рисунка 4-3 показан этот случай.
To connect such a PC to a router or switch console, you need a USB converter that converts from the older console cable to a USB connector, and a rollover UTP cable, as shown in the middle of Figure 4-3.|Чтобы подключить такой ПК к маршрутизатору или консоли коммутатора, вам понадобится USB-преобразователь, который преобразует старый консольный кабель в USB-разъем, и переключаемый кабель UTP, как показано в середине рисунка 4-3.
|
NOTE When using the USB options, you typically also need to install a software driver so that your PC’s OS knows that the device on the other end of the USB connection is the console of a Cisco device.|ПРИМЕЧАНИЕ. При использовании опций USB обычно также необходимо установить драйвер программного обеспечения, чтобы ОС вашего ПК знала, что устройство на другом конце USB-соединения является консолью устройства Cisco.
Also, you can easily find photos of these cables and components online, with searches like “cisco console cable,” “cisco usb console cable,” or “console cable converter.”|Кроме того, вы можете легко найти фотографии этих кабелей и компонентов в Интернете по запросу «консольный кабель cisco», «консольный кабель cisco usb» или «преобразователь консольного кабеля».
|
The 2960-XR series, for instance, supports both the older RJ-45 console port and a USB console port.|Например, серия 2960-XR поддерживает как старый консольный порт RJ-45, так и консольный порт USB.
Figure 4-4 points to the two console ports; you would use only one or the other.|Рисунок 4-4 указывает на два консольных порта; вы бы использовали только один или другой.
Note that the USB console port uses a mini-B port rather than the more commonly seen rectangular standard USB Type A port.|Обратите внимание, что для консольного порта USB используется порт mini-B, а не более часто встречающийся прямоугольный стандартный порт USB типа A.
|
Figure 4-4 A Part of a 2960-XR Switch with Console Ports Shown After the PC is physically connected to the console port, a terminal emulator software package must be installed and configured on the PC. The terminal emulator software treats all data as text.|Рисунок 4-4. Показана часть коммутатора 2960-XR с консольными портами. После того, как ПК физически подключен к консольному порту, на ПК должен быть установлен и настроен программный пакет эмулятора терминала. Программное обеспечение эмулятора терминала обрабатывает все данные как текст.
It accepts the text typed by the user and sends it over the console connection to the switch.|Он принимает текст, введенный пользователем, и отправляет его через консольное соединение на коммутатор.
Similarly, any bits coming into the PC over the console connection are displayed as text for the user to read.|Точно так же любые биты, поступающие в ПК через консольное соединение, отображаются в виде текста для чтения пользователем.
|
The emulator must be configured to use the PC’s serial port to match the settings on the switch’s console port settings.|Эмулятор должен быть настроен на использование последовательного порта ПК в соответствии с настройками консольного порта коммутатора.
The default console port settings on a switch are as follows.|Настройки консольного порта по умолчанию на коммутаторе следующие.
|
Note that the last three parameters are referred to collectively as 8N1:|Обратите внимание, что последние три параметра вместе называются 8N1:
###### 9600 bits/second
9600 бит / сек   
###### No hardware flow control
Нет аппаратного управления потоком   
###### 8-bit ASCII
8-битный ASCII   
###### No parity bits
Нет битов четности   
###### 1 stop bit
1 стоповый бит   
__|__
--|--
|
Figure 4-5 shows one such terminal emulator.|На рис. 4-5 показан один из таких эмуляторов терминала.
The image shows the window created by the emulator software in the background, with some output of a show command.|На изображении показано окно, созданное программным обеспечением эмулятора в фоновом режиме, с некоторыми выходными данными команды show.
The foreground, in the upper right, shows a settings window that lists the default console settings as listed just before this paragraph.|На переднем плане в правом верхнем углу показано окно настроек, в котором перечислены настройки консоли по умолчанию, перечисленные непосредственно перед этим абзацем.
|
Figure 4-5 Terminal Settings for Console Access|Рисунок 4-5 Настройки терминала для консольного доступа
##### Accessing the CLI with Telnet and SSH
Доступ к CLI с помощью Telnet и SSH   
__|__
--|--
|
For many years, terminal emulator applications have supported far more than the ability to communicate over a serial port to a local device (like a switch’s console).|В течение многих лет приложения-эмуляторы терминала поддерживали гораздо больше, чем просто возможность связи через последовательный порт с локальным устройством (например, с консолью коммутатора).
Terminal emulators support a variety of TCP/IP applications as well, including Telnet and SSH. Telnet and SSH both allow the user to connect to another device’s CLI, but instead of connecting through a console cable to the console port, the traffic flows over the same IP network that the networking devices are helping to create.|Эмуляторы терминала также поддерживают множество приложений TCP / IP, включая Telnet и SSH. Telnet и SSH позволяют пользователю подключаться к интерфейсу командной строки другого устройства, но вместо подключения через консольный кабель к консольному порту трафик проходит по той же IP-сети, которую сетевые устройства помогают создать.
|
Telnet uses the concept of a Telnet client (the terminal application) and a Telnet server (the switch in this case).|Telnet использует концепцию клиента Telnet (терминальное приложение) и сервера Telnet (в данном случае коммутатора).
A Telnet client, the device that sits in front of the user, accepts keyboard input and sends those commands to the Telnet server.|Клиент Telnet, устройство, которое находится перед пользователем, принимает ввод с клавиатуры и отправляет эти команды на сервер Telnet.
The Telnet server accepts the text, interprets the text as a command, and replies back.|Сервер Telnet принимает текст, интерпретирует текст как команду и отвечает в ответ.
|
Cisco Catalyst switches enable a Telnet server by default, but switches need a few more configuration settings before you can successfully use Telnet to connect to a switch.|Коммутаторы Cisco Catalyst включают сервер Telnet по умолчанию, но коммутаторам требуется еще несколько параметров конфигурации, прежде чем вы сможете успешно использовать Telnet для подключения к коммутатору.
Chapter 6, “Configuring Basic Switch Management,” covers switch configuration to support Telnet and SSH in detail.|В главе 6 «Настройка базового управления коммутатором» подробно рассматривается настройка коммутатора для поддержки Telnet и SSH.
|
Using Telnet in a lab today makes sense, but Telnet poses a significant security risk in production networks.|Использование Telnet в лабораторных условиях сегодня имеет смысл, но Telnet представляет собой значительную угрозу безопасности в производственных сетях.
Telnet sends all data (including any username and password for login to the switch) as clear-text data.|Telnet отправляет все данные (включая любое имя пользователя и пароль для входа в коммутатор) в виде данных в открытом виде.
SSH gives us a much better option.|SSH дает нам гораздо лучший вариант.
|
Think of SSH as the much more secure Telnet cousin.|Думайте о SSH как о гораздо более безопасном родственнике Telnet.
Outwardly, you still open a terminal emulator, connect to the switch’s IP address, and see the switch CLI, no matter whether you use Telnet or SSH. The differences exist behind the scenes: SSH encrypts the contents of all messages, including the passwords, avoiding the possibility of someone capturing packets in the network and stealing the password to network devices.|Внешне вы по-прежнему открываете эмулятор терминала, подключаетесь к IP-адресу коммутатора и видите интерфейс командной строки коммутатора, независимо от того, используете ли вы Telnet или SSH. Различия существуют за кулисами: SSH шифрует содержимое всех сообщений, включая пароли, избегая возможности перехвата пакетов в сети и кражи пароля к сетевым устройствам.
##### User and Enable \(Privileged\) Modes
Пользовательский и Включить \ (Привилегированные \) режимы   
__|__
--|--
|
All three CLI access methods covered so far (console, Telnet, and SSH) place the user in an area of the CLI called user EXEC mode.|Все три метода доступа к интерфейсу командной строки, рассмотренные до сих пор (консоль, Telnet и SSH), помещают пользователя в область интерфейса командной строки, называемую режимом пользовательского EXEC.
User EXEC mode, sometimes also called user mode, allows the user to look around but not break anything.|Пользовательский режим EXEC, иногда также называемый пользовательским режимом, позволяет пользователю смотреть вокруг, но ничего не ломать.
The “EXEC mode” part of the name refers to the fact that in this mode, when you enter a command, the switch executes the command and then displays messages that describe the command’s results.|Часть имени «EXEC mode» относится к тому факту, что в этом режиме, когда вы вводите команду, коммутатор выполняет команду, а затем отображает сообщения, описывающие результаты команды.
|
NOTE If you have not used the CLI before, you might want to experiment with the CLI from the Sim Lite product, or view the video about CLI basics.|ПРИМЕЧАНИЕ. Если вы раньше не использовали интерфейс командной строки, возможно, вы захотите поэкспериментировать с интерфейсом командной строки из продукта Sim Lite или просмотреть видео об основах интерфейса командной строки.
You can find these resources on the companion website as mentioned in the Introduction.|Вы можете найти эти ресурсы на сопутствующем веб-сайте, как указано во введении.
|
Cisco IOS supports a more powerful EXEC mode called enable mode (also known as privileged mode or privileged EXEC mode).|Cisco IOS поддерживает более мощный режим EXEC, называемый режимом включения (также известный как привилегированный режим или привилегированный режим EXEC).
Enable mode gets its name from the enable command, which moves the user from user mode to enable mode, as shown in Figure 4-6.|Режим включения получил свое название от команды enable, которая переводит пользователя из пользовательского режима в режим включения, как показано на рисунке 4-6.
The other name for this mode, privileged mode, refers to the fact that powerful (or privileged)|Другое название этого режима, привилегированный режим, относится к тому факту, что мощный (или привилегированный)
|
commands can be executed there.|команды могут быть выполнены там.
For example, you can use the reload command, which tells the switch to reinitialize or reboot Cisco IOS, only from enable mode.|Например, вы можете использовать команду reload, которая сообщает коммутатору о необходимости повторной инициализации или перезагрузки Cisco IOS только из режима включения.
|
NOTE If the command prompt lists the hostname followed by a >, the user is in user mode;|ПРИМЕЧАНИЕ. Если в командной строке указано имя хоста, за которым следует>, пользователь находится в пользовательском режиме;
|
if it is the hostname followed by the #, the user is in enable mode.|если это имя хоста, за которым следует #, пользователь находится в режиме включения.
|
Figure 4-6 User and Privileged Modes Example 4-1 demonstrates the differences between user and enable modes.|Рис. 4-6 Пользовательский и привилегированный режимы Пример 4-1 демонстрирует различия между пользовательским и активным режимами.
The example shows the output that you could see in a terminal emulator window, for instance, when connecting from the console.|В примере показан вывод, который вы могли видеть в окне эмулятора терминала, например, при подключении с консоли.
In this case, the user sits at the user mode prompt (“Certskills1>”)|В этом случае пользователь сидит в приглашении пользовательского режима («Certskills1>»).
|
and tries the reload command.|и пытается выполнить команду перезагрузки.
The reload command tells the switch to reinitialize or reboot Cisco IOS, so IOS allows this powerful command to be used only from enable mode.|Команда reload сообщает коммутатору о необходимости повторной инициализации или перезагрузки Cisco IOS, поэтому IOS позволяет использовать эту мощную команду только в режиме включения.
IOS rejects the reload command when used in user mode.|IOS отклоняет команду перезагрузки при использовании в пользовательском режиме.
Then the user moves to enable mode—|Затем пользователь переходит в режим включения -
|
also called privileged mode—(using the enable EXEC command).|также называется привилегированным режимом - (с помощью команды enable EXEC).
At that point, IOS accepts the reload command now that the user is in enable mode.|В этот момент IOS принимает команду перезагрузки теперь, когда пользователь находится в режиме включения.
|
Example 4-1 Example of Privileged Mode Commands Being Rejected in User Mode Example end.|Пример 4-1. Пример отклонения команд привилегированного режима в пользовательском режиме. Пример конец.
|
NOTE The commands that can be used in either user (EXEC) mode or enable (EXEC)|ПРИМЕЧАНИЕ Команды, которые можно использовать в пользовательском (EXEC) режиме или разрешающем (EXEC) режиме.
|
mode are called EXEC commands.|mode называются командами EXEC.
|
This example is the first instance of this book showing you the output from the CLI, so it is worth noting a few conventions.|Этот пример является первым экземпляром в этой книге, показывающим результаты работы интерфейса командной строки, поэтому стоит отметить несколько соглашений.
The bold text represents what the user typed, and the nonbold text is what the switch sent back to the terminal emulator.|Полужирный текст представляет то, что набрал пользователь, а жирный текст - это то, что коммутатор отправил обратно в эмулятор терминала.
Also, the typed passwords do not show up on the screen for security purposes.|Кроме того, введенные пароли не отображаются на экране в целях безопасности.
Finally, note that this switch has been preconfigured with a hostname of Certskills1, so the command prompt on the left shows that hostname on each line.|Наконец, обратите внимание, что этот переключатель был предварительно настроен с именем хоста Certskills1, поэтому в командной строке слева отображается это имя хоста в каждой строке.
##### Password Security for CLI Access from the Console
Защита паролем для доступа через интерфейс командной строки из консоли   
__|__
--|--
|
A Cisco switch, with default settings, remains relatively secure when locked inside a wiring closet, because by default, a switch allows console access only.|Коммутатор Cisco с настройками по умолчанию остается относительно безопасным, когда он заблокирован внутри коммутационного шкафа, поскольку по умолчанию коммутатор разрешает доступ только к консоли.
By default, the console requires no password at all, and no password to reach enable mode for users that happened to connect from the console.|По умолчанию консоль вообще не требует пароля и пароля для перехода в режим включения для пользователей, которые подключились с консоли.
The reason is that if you have access to the physical console port of the switch, you already have pretty much complete control over the switch.|Причина в том, что если у вас есть доступ к физическому консольному порту коммутатора, у вас уже есть практически полный контроль над коммутатором.
You could literally get out your screwdriver and walk off with it, or you could unplug the power, or follow well-published procedures to go through password recovery to break into the CLI and then configure anything you want to configure.|Вы можете буквально достать отвертку и уйти с ней, или вы можете отключить питание, или следовать хорошо опубликованным процедурам, чтобы пройти восстановление пароля, чтобы взломать CLI, а затем настроить все, что вы хотите настроить.
|
However, many people go ahead and set up simple password protection for console users.|Однако многие люди устанавливают простую защиту паролем для пользователей консоли.
|
Simple passwords can be configured at two points in the login process from the console:|Простые пароли можно настроить на двух этапах процесса входа в систему с консоли:
|
when the user connects from the console, and when any user moves to enable mode (using the enable EXEC command).|когда пользователь подключается с консоли, и когда любой пользователь переходит в режим включения (с помощью команды enable EXEC).
You may have noticed that back in Example 4-1, the user saw a password prompt at both points.|Возможно, вы заметили, что в примере 4-1 пользователь видел запрос пароля в обеих точках.
|
Example 4-2 shows the additional configuration commands that were configured prior to collecting the output in Example 4-1.|В примере 4-2 показаны дополнительные команды конфигурации, которые были настроены до сбора выходных данных в примере 4-1.
The output holds an excerpt from the EXEC command show running-config, which lists the current configuration in the switch.|Выходные данные содержат отрывок из команды EXEC show running-config, в которой отображается текущая конфигурация коммутатора.
|
Example 4-2 Nondefault Basic Configuration Example end.|Пример 4-2 Пример базовой конфигурации нестандартной конфигурации конец.
|
Working from top to bottom, note that the first configuration command listed by the show running-config command sets the switch’s hostname to Certskills1.|Работая сверху вниз, обратите внимание, что первая команда настройки, указанная в команде show running-config, устанавливает имя хоста коммутатора Certskills1.
You might have noticed that the command prompts in Example 4-1 all began with Certskills1, and that’s why the command prompt begins with the hostname of the switch.|Вы могли заметить, что все командные запросы в примере 4-1 начинались с Certskills1, и поэтому командная строка начинается с имени хоста коммутатора.
|
Next, note that the lines with a ! in them are comment lines, both in the text of this book and in the real switch CLI.|Затем обратите внимание, что строки с символом! в них есть строки комментариев, как в тексте этой книги, так и в реальном CLI коммутатора.
|
The enable secret love configuration command defines the password that all users must use to reach enable mode.|Команда настройки enable secret love определяет пароль, который должны использовать все пользователи для перехода в режим включения.
So, no matter whether users connect from the console, Telnet, or SSH, they would use the password love when prompted for a password after typing the enable EXEC command.|Таким образом, независимо от того, подключаются ли пользователи через консоль, Telnet или SSH, они будут использовать пароль love при запросе пароля после ввода команды enable EXEC.
|
Finally, the last three lines configure the console password.|Наконец, последние три строки настраивают пароль консоли.
The first line (line console 0) is the command that identifies the console, basically meaning “these next commands apply to the console only.” The login command tells IOS to perform simple password checking (at the console).|Первая строка (строка console 0) - это команда, которая идентифицирует консоль, в основном это означает, что «следующие команды применяются только к консоли». Команда входа в систему указывает IOS выполнить простую проверку пароля (на консоли).
Remember, by default, the switch does not ask for a password for console users.|Помните, что по умолчанию коммутатор не запрашивает пароль для пользователей консоли.
|
Finally, the password faith command defines the password the console user must type when prompted.|И, наконец, команда password trust определяет пароль, который пользователь консоли должен вводить при появлении запроса.
|
This example just scratches the surface of the kinds of security configuration you might choose to configure on a switch, but it does give you enough detail to configure switches in your lab and get started (which is the reason I put these details in this first chapter of Part II). Note that Chapter 6 shows the configuration steps to add support for Telnet and SSH Volume 2, “Securing Network Devices,” shows additional security configuration as well.|Этот пример лишь поверхностно описывает типы конфигурации безопасности, которые вы можете выбрать для настройки на коммутаторе, но он дает вам достаточно подробностей для настройки коммутаторов в вашей лаборатории и начала работы (поэтому я поместил эти подробности в эту первую главу). части II). Обратите внимание, что в главе 6 показаны шаги настройки для добавления поддержки Telnet и SSH. В томе 2 «Защита сетевых устройств» также показаны дополнительные настройки безопасности.
#### CLI Help Features
Функции справки CLI   
__|__
--|--
|
If you printed the Cisco IOS Command Reference documents, you would end up with a stack of paper several feet tall.|Если бы вы распечатали справочные документы по командам Cisco IOS, у вас получилась бы стопка бумаги высотой в несколько футов.
No one should expect to memorize all the commands—and no one does.|Никто не должен запоминать все команды - и никто этого не делает.
You can use several very easy, convenient tools to help remember commands and save time typing.|Вы можете использовать несколько очень простых и удобных инструментов, которые помогут запомнить команды и сэкономить время на вводе текста.
As you progress through your Cisco certifications, the exams will cover progressively more commands.|По мере прохождения сертификации Cisco экзамены будут охватывать все больше команд.
However, you should know the methods of getting command help.|Однако вы должны знать методы получения справки по командам.
|
Table 4-2 summarizes command-recall help options available at the CLI. Note that, in the first column, command represents any command.|В таблице 4-2 приведены параметры справки по вызову команд, доступные в интерфейсе командной строки. Обратите внимание, что в первом столбце команда представляет любую команду.
Likewise, parm represents a command’s parameter.|Точно так же parm представляет параметр команды.
For example, the second row lists command ?, which means that commands such as show ? and copy ? would list help for the show and copy commands, respectively.|Например, во второй строке перечислены команды?, Что означает, что такие команды, как show? и скопировать? будет отображать справку по командам show и copy соответственно.
|
Table 4-2 Cisco IOS Software Command Help Table end.|Таблица 4-2 Конец таблицы справки по командам программного обеспечения Cisco IOS.
|
When you enter the ?, the Cisco IOS CLI reacts immediately; that is, you don’t need to press the Enter key or any other keys.|Когда вы вводите?, Интерфейс командной строки Cisco IOS реагирует немедленно; то есть вам не нужно нажимать клавишу Enter или какие-либо другие клавиши.
The device running Cisco IOS also redisplays what you entered before the ? to save you some keystrokes.|Устройство под управлением Cisco IOS также повторно отображает то, что вы ввели до? чтобы сэкономить несколько нажатий клавиш.
If you press Enter immediately after the ?, Cisco IOS tries to execute the command with only the parameters you have entered so far.|Если вы нажмете Enter сразу после?, Cisco IOS попытается выполнить команду только с теми параметрами, которые вы ввели до сих пор.
|
The information supplied by using help depends on the CLI mode.|Информация, предоставляемая с помощью справки, зависит от режима интерфейса командной строки.
For example, when ? is entered in user mode, the commands allowed in user mode are displayed, but commands available only in enable mode (not in user mode) are not displayed.|Например, когда? вводится в пользовательском режиме, отображаются команды, разрешенные в пользовательском режиме, но команды, доступные только в активном режиме (не в пользовательском режиме), не отображаются.
Also, help is available in configuration mode, which is the mode used to configure the switch.|Кроме того, справка доступна в режиме конфигурации, который используется для настройки коммутатора.
In fact, configuration mode has many different subconfiguration modes, as explained in the section “Configuration Submodes and Contexts,” later in this chapter.|Фактически, режим конфигурации имеет много различных режимов подконфигурации, как объясняется в разделе «Подрежимы и контексты конфигурации» далее в этой главе.
So, you can get help for the commands available in each configuration submode as well. (Note that this might be a good time to use the free Sim Lite product on the companion website—open any lab, use the question mark, and try some commands.)|Таким образом, вы также можете получить справку по командам, доступным в каждом подрежиме конфигурации. (Обратите внимание, что сейчас самое время использовать бесплатный продукт Sim Lite на сопутствующем веб-сайте - откройте любую лабораторию, используйте знак вопроса и попробуйте несколько команд.)
|
Cisco IOS stores the commands that you enter in a history buffer, storing ten commands by default.|Cisco IOS хранит команды, которые вы вводите, в буфере истории, по умолчанию сохраняя десять команд.
The CLI allows you to move backward and forward in the historical list of commands and then edit the command before reissuing it.|Интерфейс командной строки позволяет перемещаться вперед и назад по историческому списку команд, а затем редактировать команду перед ее повторным вводом.
These key sequences can help you use the CLI more quickly on the exams.|Эти последовательности клавиш могут помочь вам быстрее использовать интерфейс командной строки на экзаменах.
Table 4-3 lists the commands used to manipulate previously entered commands.|В таблице 4-3 перечислены команды, используемые для управления ранее введенными командами.
|
Table 4-3 Key Sequences for Command Edit and Recall Table end.|Таблица 4-3 Последовательности клавиш для редактирования команд и вызова таблицы конец.
#### The debug and show Commands
Команды debug и show   
__|__
--|--
|
By far, the single most popular Cisco IOS command is the show command.|Безусловно, самая популярная команда Cisco IOS - это команда show.
The show command has a large variety of options, and with those options, you can find the status of almost every feature of Cisco IOS. Essentially, the show command lists the currently known facts about the switch’s operational status.|Команда show имеет большое количество параметров, и с помощью этих параметров вы можете узнать состояние почти каждой функции Cisco IOS. По сути, команда show перечисляет известные на данный момент факты о рабочем состоянии коммутатора.
The only work the switch does in reaction to show commands is to find the current status and list the information in messages sent to the user.|Единственная работа, которую коммутатор выполняет в ответ на команды show, - это найти текущий статус и перечислить информацию в сообщениях, отправленных пользователю.
|
For example, consider the output from the show mac address-table dynamic command listed in Example 4-3.|Например, рассмотрим выходные данные динамической команды show mac address-table, перечисленные в Примере 4-3.
This show command, issued from user mode, lists the table the switch uses to make forwarding decisions.|Эта команда show, выданная из пользовательского режима, перечисляет таблицу, которую коммутатор использует для принятия решений о пересылке.
A switch’s MAC address table basically lists the data a switch uses to do its primary job.|Таблица MAC-адресов коммутатора в основном перечисляет данные, которые коммутатор использует для выполнения своей основной работы.
|
Example 4-3 Nondefault Basic Configuration Example end.|Пример 4-3 Пример базовой конфигурации не по умолчанию.
|
The debug command also tells the user details about the operation of the switch.|Команда отладки также сообщает пользователю подробную информацию о работе переключателя.
However, while the show command lists status information at one instant of time—more like a photograph—|Однако, хотя команда show выводит информацию о состоянии в один момент времени - больше похоже на фотографию -
|
the debug command acts more like a live video camera feed.|команда отладки больше похожа на прямую трансляцию с видеокамеры.
Once you issue a debug command, IOS remembers, issuing messages that any switch user can choose to see.|Когда вы вводите команду отладки, IOS запоминает, выдавая сообщения, которые может просмотреть любой пользователь коммутатора.
The console sees these messages by default.|Консоль видит эти сообщения по умолчанию.
Most of the commands used throughout this book to verify operation of switches and routers are show commands.|Большинство команд, используемых в этой книге для проверки работы коммутаторов и маршрутизаторов, являются командами show.
### Configuring Cisco IOS Software
Настройка программного обеспечения Cisco IOS   
__|__
--|--
|
You will want to configure every switch in an Enterprise network, even though the switches will forward traffic even with default configuration.|Вам нужно настроить каждый коммутатор в корпоративной сети, даже если коммутаторы будут пересылать трафик даже с конфигурацией по умолчанию.
This section covers the basic configuration processes, including the concept of a configuration file and the locations in which the configuration files can be stored.|В этом разделе рассматриваются основные процессы конфигурации, включая концепцию файла конфигурации и места, в которых файлы конфигурации могут храниться.
Although this section focuses on the configuration process, and not on the configuration commands themselves, you should know all the commands covered in this chapter for the exams, in addition to the configuration processes.|Хотя в этом разделе основное внимание уделяется процессу настройки, а не самим командам настройки, вы должны знать все команды, описанные в этой главе для экзаменов, в дополнение к процессам настройки.
|
Configuration mode is another mode for the Cisco CLI, similar to user mode and privileged mode.|Режим конфигурации - это еще один режим для интерфейса командной строки Cisco, аналогичный пользовательскому режиму и привилегированному режиму.
User mode lets you issue nondisruptive commands and displays some information.|Пользовательский режим позволяет выполнять команды без прерывания работы и отображать некоторую информацию.
|
Privileged mode supports a superset of commands compared to user mode, including commands that might disrupt switch operations.|Привилегированный режим поддерживает расширенный набор команд по сравнению с пользовательским режимом, включая команды, которые могут нарушить операции переключения.
However, not one of the commands in user or privileged mode changes the switch’s configuration.|Однако ни одна из команд в пользовательском или привилегированном режиме не изменяет конфигурацию коммутатора.
Configuration mode accepts configuration commands—commands that tell the switch the details of what to do and how to do it.|Режим настройки принимает команды настройки - команды, которые сообщают коммутатору подробную информацию о том, что делать и как это делать.
Figure 4-7 illustrates the relationships among configuration mode, user EXEC mode, and privileged EXEC mode.|На рис. 4-7 показаны отношения между режимом конфигурации, пользовательским режимом EXEC и привилегированным режимом EXEC.
|
Figure 4-7 CLI Configuration Mode Versus EXEC Modes Commands entered in configuration mode update the active configuration file.|Рис. 4-7 Сравнение режима конфигурации CLI и режимов EXEC. Команды, введенные в режиме конфигурации, обновляют активный файл конфигурации.
These changes to the configuration occur immediately each time you press the Enter key at the end of a command.|Эти изменения конфигурации происходят немедленно каждый раз, когда вы нажимаете клавишу Enter в конце команды.
Be careful when you enter a configuration command!|Будьте осторожны при вводе команды настройки!
#### Configuration Submodes and Contexts
Подрежимы и контексты конфигурации   
__|__
--|--
|
Configuration mode itself contains a multitude of commands.|Сам режим настройки содержит множество команд.
To help organize the configuration, IOS groups some kinds of configuration commands together.|Чтобы помочь организовать конфигурацию, IOS группирует некоторые виды команд конфигурации вместе.
To do that, when using configuration mode, you move from the initial mode—global configuration mode—into subcommand modes.|Для этого при использовании режима конфигурации вы переходите из начального режима - режима глобальной конфигурации - в режим подкоманд.
Context-setting commands move you from one configuration subcommand mode, or context, to another.|Команды настройки контекста переводят вас из одного режима подкоманд конфигурации или контекста в другой.
These context-setting commands tell the switch the topic about which you will enter the next few configuration commands.|Эти команды настройки контекста сообщают коммутатору тему, по которой вы будете вводить следующие несколько команд конфигурации.
More importantly, the context tells the switch the topic you care about right now, so when you use the ? to get help, the switch gives you help about that topic only.|Что еще более важно, контекст подсказывает переключателю, какая тема для вас сейчас важна, поэтому, когда вы используете? чтобы получить помощь, переключатель дает вам справку только по этой теме.
|
NOTE Context-setting is not a Cisco term.|ПРИМЕЧАНИЕ. Настройка контекста - это не термин Cisco.
It is just a description used here to help make sense of configuration mode.|Это просто описание, используемое здесь, чтобы помочь понять режим конфигурации.
|
The best way to learn about configuration submodes is to use them, but first, take a look at these upcoming examples.|Лучший способ узнать о подрежимах конфигурации - использовать их, но сначала взгляните на следующие примеры.
For instance, the interface command is one of the most commonly used context-setting configuration commands.|Например, команда интерфейса - одна из наиболее часто используемых команд настройки контекста.
For example, the CLI user could enter interface configuration mode by entering the interface FastEthernet 0/1 configuration command.|Например, пользователь CLI может войти в режим настройки интерфейса, введя команду настройки интерфейса FastEthernet 0/1.
|
Asking for help in interface configuration mode displays only commands that are useful when configuring Ethernet interfaces.|При запросе помощи в режиме настройки интерфейса отображаются только команды, которые полезны при настройке интерфейсов Ethernet.
Commands used in this context are called subcommands—|Команды, используемые в этом контексте, называются подкомандами -
|
or, in this specific case, interface subcommands.|или, в данном конкретном случае, подкоманды интерфейса.
When you begin practicing with the CLI with real equipment, the navigation between modes can become natural.|Когда вы начнете практиковаться с CLI на реальном оборудовании, переход между режимами станет естественным.
For now, consider Example 4-4, which shows the following:|А пока рассмотрим пример 4-4, который показывает следующее:
###### Movement from enable mode to global configuration mode by using the configure
Переход из режима включения в режим глобальной конфигурации с помощью команды configure   
__|__
--|--
|
terminal EXEC command|команда терминала EXEC
###### Using a hostname Fred global configuration command to configure the switch’s name
Использование команды глобальной конфигурации hostname Fred для настройки имени коммутатора   
###### Movement from global configuration mode to console line configuration mode (using the
Переход из режима глобальной настройки в режим настройки линии консоли (с помощью   
__|__
--|--
|
line console 0 command)|строка консоли 0 команда)
###### Setting the console’s simple password to hope (using the password hope line
Установка простого пароля консоли на надежду (с помощью строки пароля надежды   
__|__
--|--
|
subcommand)|подкоманда)
###### Movement from console configuration mode to interface configuration mode (using the
Переход из режима настройки консоли в режим настройки интерфейса (с помощью   
__|__
--|--
|
interface type number command)|команда номера типа интерфейса)
###### Setting the speed to 100 Mbps for interface Fa0/1 (using the speed 100 interface
Установка скорости на 100 Мбит / с для интерфейса Fa0 / 1 (при использовании интерфейса speed 100   
__|__
--|--
|
subcommand)|подкоманда)
###### Movement from interface configuration mode back to global configuration mode (using
Переход из режима конфигурации интерфейса обратно в режим глобальной конфигурации (с использованием   
__|__
--|--
|
the exit command)|команда выхода)
|
Example 4-4 Navigating Between Different Configuration Modes Example end.|Пример 4-4 Перемещение между различными режимами конфигурации Пример конец.
|
The text inside parentheses in the command prompt identifies the configuration mode.|Текст в круглых скобках в командной строке определяет режим конфигурации.
For example, the first command prompt after you enter configuration mode lists (config), meaning global configuration mode.|Например, первая командная строка после входа в режим конфигурации списки (config), что означает режим глобальной конфигурации.
After the line console 0 command, the text expands to (config-|После команды line console 0 текст расширяется до (config-
|
line), meaning line configuration mode.|line), что означает режим конфигурации линии.
Each time the command prompt changes within config mode, you have moved to another configuration mode.|Каждый раз, когда командная строка изменяется в режиме конфигурации, вы переходите в другой режим конфигурации.
|
Table 4-4 shows the most common command prompts in configuration mode, the names of those modes, and the context-setting commands used to reach those modes.|В таблице 4-4 показаны наиболее распространенные командные запросы в режиме конфигурации, названия этих режимов и команды настройки контекста, используемые для доступа к этим режимам.
|
Table 4-4 Common Switch Configuration Modes Table end.|Таблица 4-4 Общие режимы конфигурации коммутатора Конец таблицы.
|
You should practice until you become comfortable moving between the different configuration modes, back to enable mode, and then back into the configuration modes.|Вы должны практиковаться, пока не научитесь комфортно перемещаться между различными режимами конфигурации, обратно в режим включения, а затем обратно в режимы конфигурации.
However, you can learn these skills just doing labs about the topics in later chapters of the book.|Однако вы можете освоить эти навыки, просто выполняя лабораторные работы по темам из следующих глав книги.
For now, Figure 4-8 shows most of the navigation between global configuration mode and the four configuration submodes listed in Table 4-4.|На данный момент на рис. 4-8 показана большая часть навигации между режимом глобальной конфигурации и четырьмя подрежимами конфигурации, перечисленными в таблице 4-4.
|
NOTE You can also move directly from one configuration submode to another, without first using the exit command to move back to global configuration mode.|ПРИМЕЧАНИЕ. Вы также можете перейти непосредственно из одного подрежима конфигурации в другой, не используя предварительно команду выхода, чтобы вернуться в режим глобальной конфигурации.
Just use the commands listed in bold in the center of the figure.|Просто используйте команды, выделенные жирным шрифтом в центре рисунка.
|
Figure 4-8 Navigation In and Out of Switch Configuration Modes You really should stop and try navigating around these configuration modes.|Рис. 4-8. Переход в режимы конфигурации коммутатора и выход из него. Вам действительно следует остановиться и попробовать перемещаться по этим режимам конфигурации.
If you have not yet decided on a lab strategy, install the Pearson Sim Lite software from the companion website.|Если вы еще не определились с лабораторной стратегией, установите программное обеспечение Pearson Sim Lite с сопутствующего веб-сайта.
|
It includes the simulator and a couple of lab exercises.|Он включает тренажер и несколько лабораторных упражнений.
Start any lab, ignore the instructions, and just get into configuration mode and move around between the configuration modes shown in Figure 4-8.|Запустите любую лабораторную работу, игнорируйте инструкции и просто войдите в режим конфигурации и переходите между режимами конфигурации, показанными на рисунке 4-8.
|
No set rules exist for what commands are global commands or subcommands.|Не существует установленных правил для того, какие команды являются глобальными командами или подкомандами.
Generally, however, when multiple instances of a parameter can be set in a single switch, the command used to set the parameter is likely a configuration subcommand.|Как правило, однако, когда несколько экземпляров параметра могут быть установлены в одном переключателе, команда, используемая для установки параметра, скорее всего, является подкомандой конфигурации.
Items that are set once for the entire switch are likely global commands.|Элементы, которые устанавливаются один раз для всего коммутатора, скорее всего, являются глобальными командами.
For example, the hostname command is a global command because there is only one hostname per switch.|Например, команда hostname является глобальной командой, потому что для каждого коммутатора существует только одно имя хоста.
Conversely, the speed command is an interface subcommand that applies to each switch interface that can run at different speeds, so it is a subcommand, applying to the particular interface under which it is configured.|И наоборот, команда скорости - это подкоманда интерфейса, которая применяется к каждому интерфейсу коммутатора, который может работать на разных скоростях, поэтому это подкоманда, применяемая к конкретному интерфейсу, для которого она настроена.
#### Storing Switch Configuration Files
Хранение файлов конфигурации коммутатора   
__|__
--|--
|
When you configure a switch, it needs to use the configuration.|Когда вы настраиваете коммутатор, он должен использовать эту конфигурацию.
It also needs to be able to retain the configuration in case the switch loses power.|Он также должен иметь возможность сохранять конфигурацию в случае отключения питания коммутатора.
Cisco switches contain randomaccess memory (RAM) to store data while Cisco IOS is using it, but RAM loses its contents when the switch loses power or is reloaded.|Коммутаторы Cisco содержат оперативную память (RAM) для хранения данных, пока ее использует Cisco IOS, но RAM теряет свое содержимое, когда коммутатор теряет питание или перезагружается.
To store information that must be retained when the switch loses power or is reloaded, Cisco switches use several types of more permanent memory, none of which has any moving parts.|Для хранения информации, которую необходимо сохранить, когда коммутатор теряет питание или перезагружается, коммутаторы Cisco используют несколько типов более постоянной памяти, ни одна из которых не имеет движущихся частей.
By avoiding components with moving parts (such as traditional disk drives), switches can maintain better uptime and availability.|Избегая компонентов с движущимися частями (таких как традиционные дисковые накопители), коммутаторы могут поддерживать время безотказной работы и доступность.
|
The following list details the four main types of memory found in Cisco switches, as well as the most common use of each type:|В следующем списке подробно описаны четыре основных типа памяти в коммутаторах Cisco, а также наиболее распространенное использование каждого типа:
###### RAM: Sometimes called DRAM, for dynamic random-access memory, RAM is used
RAM: иногда называется DRAM, для динамической памяти с произвольным доступом используется RAM   
__|__
--|--
|
by the switch just as it is used by any other computer: for working storage.|переключателем, как и на любом другом компьютере: для рабочей памяти.
The running (active) configuration file is stored here.|Здесь хранится текущий (активный) файл конфигурации.
###### Flash memory: Either a chip inside the switch or a removable memory card, flash memory
Флэш-память: либо микросхема внутри коммутатора, либо съемная карта памяти, флэш-память.   
__|__
--|--
|
stores fully functional Cisco IOS images and is the default location where the switch gets its Cisco IOS at boot time.|хранит полнофункциональные образы Cisco IOS и является местом по умолчанию, куда коммутатор получает Cisco IOS во время загрузки.
Flash memory also can be used to store any other files, including backup copies of configuration files.|Флэш-память также может использоваться для хранения любых других файлов, включая резервные копии файлов конфигурации.
###### ROM: Read-only memory (ROM) stores a bootstrap (or boothelper) program that is loaded
ПЗУ: постоянное запоминающее устройство (ПЗУ) хранит загруженную программу начальной загрузки (или загрузчика).   
__|__
--|--
|
when the switch first powers on.|при первом включении переключателя.
This bootstrap program then finds the full Cisco IOS image and manages the process of loading Cisco IOS into RAM, at which point Cisco IOS takes over operation of the switch.|Затем эта программа начальной загрузки находит полный образ Cisco IOS и управляет процессом загрузки Cisco IOS в RAM, после чего Cisco IOS берет на себя работу коммутатора.
###### NVRAM: Nonvolatile RAM (NVRAM) stores the initial or startup configuration file that
NVRAM: энергонезависимая RAM (NVRAM) хранит файл начальной или начальной конфигурации, который   
__|__
--|--
|
is used when the switch is first powered on and when the switch is reloaded.|используется при первом включении коммутатора и при повторной загрузке коммутатора.
|
Figure 4-9 summarizes this same information in a briefer and more convenient form for memorization and study.|На рис. 4-9 эта же информация суммирована в более краткой и удобной форме для запоминания и изучения.
|
Figure 4-9 Cisco Switch Memory Types Cisco IOS stores the collection of configuration commands in a configuration file.|Рис. 4-9 Типы памяти коммутатора Cisco Cisco IOS хранит набор команд конфигурации в файле конфигурации.
In fact, switches use multiple configuration files—one file for the initial configuration used when powering on, and another configuration file for the active, currently used running configuration as stored in RAM. Table 4-5 lists the names of these two files, their purpose, and their storage location.|Фактически, коммутаторы используют несколько файлов конфигурации - один файл для начальной конфигурации, используемой при включении, и другой файл конфигурации для активной, используемой в настоящее время рабочей конфигурации, хранящейся в ОЗУ. В Таблице 4-5 перечислены имена этих двух файлов, их назначение и место хранения.
|
Table 4-5 Names and Purposes of the Two Main Cisco IOS Configuration Files Table end.|Таблица 4-5 Имена и назначение двух основных файлов конфигурации Cisco IOS Конец таблицы.
|
Essentially, when you use configuration mode, you change only the running-config file.|По сути, когда вы используете режим конфигурации, вы изменяете только файл рабочей конфигурации.
This means that the configuration example earlier in this chapter (Example 4-4) updates only the running-config file.|Это означает, что в примере конфигурации ранее в этой главе (Пример 4-4) обновляется только файл рабочей конфигурации.
However, if the switch lost power right after that example, all that configuration would be lost.|Однако, если коммутатор потеряет питание сразу после этого примера, вся эта конфигурация будет потеряна.
If you want to keep that configuration, you have to copy the running-config file into NVRAM, overwriting the old startup-config file.|Если вы хотите сохранить эту конфигурацию, вам необходимо скопировать файл рабочей конфигурации в NVRAM, перезаписав старый файл начальной конфигурации.
|
Example 4-5 demonstrates that commands used in configuration mode change only the running configuration in RAM. The example shows the following concepts and steps:|Пример 4-5 демонстрирует, что команды, используемые в режиме конфигурации, изменяют только текущую конфигурацию в ОЗУ. В примере показаны следующие концепции и шаги:
|
Step 1.|Шаг 1.
The example begins with both the running and startup-config having the same hostname, per the hostname hannah command.|Пример начинается с того, что как запущенная, так и конфигурация запуска имеют одно и то же имя хоста в соответствии с командой hostname hannah.
|
Step 2.|Шаг 2.
The hostname is changed in configuration mode using the hostname harold command.|Имя хоста изменяется в режиме конфигурации с помощью команды hostname harold.
|
Step 3.|Шаг 3.
The show running-config and show startup-config commands show the fact that the hostnames are now different, with the hostname harold command found only in the running-config.|Команды show running-config и show startup-config показывают тот факт, что имена хостов теперь разные, а команда harold hostname находится только в файле running-config.
|
Example 4-5 How Configuration Mode Commands Change the Running-Config File, Example end.|Пример 4-5. Как команды режима конфигурации изменяют файл рабочей конфигурации, пример end.
#### Copying and Erasing Configuration Files
Копирование и стирание файлов конфигурации   
__|__
--|--
|
The configuration process updates the running-config file, which is lost if the router loses power or is reloaded.|В процессе настройки обновляется файл рабочей конфигурации, который теряется, если маршрутизатор теряет питание или перезагружается.
Clearly, IOS needs to provide us a way to copy the running configuration so that it will not be lost, so it will be used the next time the switch reloads or powers on.|Ясно, что IOS должна предоставить нам возможность скопировать текущую конфигурацию, чтобы она не была потеряна и использовалась при следующей перезагрузке или включении коммутатора.
For instance, Example 4-5 ended with a different running configuration (with the hostname harold command) versus the startup configuration.|Например, пример 4-5 завершился другой рабочей конфигурацией (с командой harold имени хоста) по сравнению с конфигурацией запуска.
|
In short, the EXEC command copy running-config startup-config backs up the runningconfig to the startup-config file.|Короче говоря, команда EXEC copy running-config startup-config создает резервную копию файла runningconfig в файле конфигурации запуска.
This command overwrites the current startup-config file with what is currently in the running-configuration file.|Эта команда перезаписывает текущий файл начальной конфигурации тем, что находится в текущем файле конфигурации.
|
In addition, in the lab, you may want to just get rid of all existing configuration and start over with a clean configuration.|Кроме того, в лабораторной работе вы можете просто избавиться от всей существующей конфигурации и начать заново с чистой конфигурации.
To do that, you can erase the startup-config file using three different commands:|Для этого вы можете стереть файл начальной конфигурации, используя три разные команды:
|
write erase erase startup-config erase nvram:|записать стереть стереть start-config стереть nvram:
|
Once the startup-config file is erased, you can reload or power off/on the switch, and it will boot with the now-empty startup configuration.|После стирания файла начальной конфигурации вы можете перезагрузить или выключить / включить коммутатор, и он загрузится с пустой загрузочной конфигурацией.
|
Note that Cisco IOS does not have a command that erases the contents of the runningconfig file.|Обратите внимание, что в Cisco IOS нет команды, стирающей содержимое файла runningconfig.
To clear out the running-config file, simply erase the startup-config file, and then reload the switch, and the running-config will be empty at the end of the process.|Чтобы очистить файл рабочей конфигурации, просто сотрите файл конфигурации запуска, а затем перезагрузите коммутатор, и в конце процесса рабочая конфигурация будет пустой.
|
NOTE Cisco uses the term reload to refer to what most PC operating systems call rebooting or restarting.|ПРИМЕЧАНИЕ Cisco использует термин перезагрузка для обозначения того, что большинство операционных систем ПК называют перезагрузкой или перезапуском.
In each case, it is a re-initialization of the software.|В каждом случае это повторная инициализация программного обеспечения.
The reload EXEC command causes a switch to reload.|Команда reload EXEC вызывает перезагрузку коммутатора.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or on the book’s companion website.|Просмотрите материал этой главы, используя инструменты в книге или на сопутствующем веб-сайте книги.
|
Refer to the “Your Study Plan” element section titled “Step 2: Build Your Study Habits Around the Chapter” for more details.|Обратитесь к разделу элемента «Ваш учебный план», озаглавленному «Шаг 2: выработайте учебу вокруг главы» для получения более подробной информации.
Table 4-6 outlines the key review elements and where you can find them.|В Таблице 4-6 представлены ключевые элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 4-6 Chapter Review Tracking Table end.|Таблица 4-6 Окончание таблицы отслеживания обзора главы.
|
Review All the Key Topics Key Terms You Should Know command-line interface (CLI), Telnet, Secure Shell (SSH), enable mode, user mode, configuration mode, startup-config file, running-config file Command References Tables 4-8 and 4-9 list configuration and verification commands used in this chapter, respectively.|Ознакомьтесь со всеми ключевыми темами. Ключевые термины, которые вы должны знать интерфейс командной строки (CLI), Telnet, Secure Shell (SSH), режим включения, пользовательский режим, режим конфигурации, файл конфигурации запуска, файл рабочей конфигурации Ссылки на команды Таблицы 4-8 и 4-9 перечисляют команды настройки и проверки, используемые в этой главе, соответственно.
|
As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.|В качестве простого упражнения на повторение закройте левый столбец таблицы, прочтите правый столбец и попытайтесь вспомнить команду, не глядя.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Затем повторите упражнение, охватывая правый столбец, и попытайтесь вспомнить, что делает команда.
|
Table 4-8 Chapter 4 Configuration Commands Table end.|Таблица 4-8 Глава 4 Команды конфигурации Конец таблицы.
|
Table 4-9 Chapter 4 EXEC Command Reference Table end.|Таблица 4-9 Глава 4 Справочник команд EXEC Конец таблицы.
## Chapter 5 Analyzing Ethernet LAN Switching
Глава 5 Анализ коммутации Ethernet LAN   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.1 Explain the role and function of network components
1.1 Объясните роль и функции сетевых компонентов   
###### 1.1.b L2 and L3 Switches
1.1.b Коммутаторы L2 и L3   
###### 1.13 Describe switching concepts
1.13 Описание концепций переключения   
###### 1.13.a MAC learning and aging
1.13.a Изучение MAC и старение   
###### 1.13.b Frame switching
1.13.b Переключение кадров   
###### 1.13.c Frame flooding
1.13.c Фрейм флуд   
###### 1.13.d MAC address table
1.13.d Таблица MAC-адресов   
###### 2.0 Network Access
2.0 Доступ к сети   
###### 2.5 Describe the need for and basic operations of Rapid PVST+ Spanning Tree Protocol
2.5. Опишите необходимость и основные операции Rapid PVST + Spanning Tree Protocol.   
__|__
--|--
|
and identify basic operations When you buy a Cisco Catalyst Ethernet switch, the switch is ready to work.|и определение основных операций. Когда вы покупаете коммутатор Cisco Catalyst Ethernet, он готов к работе.
All you have to do is take it out of the box, power on the switch by connecting the power cable to the switch and a power outlet, and connect hosts to the switch using the correct unshielded twisted-pair (UTP) cables.|Все, что вам нужно сделать, это вынуть его из коробки, включить коммутатор, подключив кабель питания к коммутатору и розетке питания, и подключить хосты к коммутатору с помощью правильных кабелей неэкранированной витой пары (UTP).
You do not have to configure anything else, or connect to the console and login, or do anything: the switch just starts forwarding Ethernet frames.|Вам не нужно ничего настраивать, подключаться к консоли и входить в систему, или что-то делать: коммутатор просто начинает пересылку кадров Ethernet.
|
In Part II of this book, you will learn how to build, configure, and verify the operation of Ethernet LANs. In Chapter 4, “Using the Command-Line Interface,” you learned how to move around in the CLI, issue commands, and configure the switch.|В части II этой книги вы узнаете, как создавать, настраивать и проверять работу локальных сетей Ethernet. В главе 4 «Использование интерфейса командной строки» вы узнали, как перемещаться по интерфейсу командной строки, вводить команды и настраивать коммутатор.
This chapter takes a short but important step in that journey by explaining the logic a switch uses when forwarding Ethernet frames.|В этой главе делается короткий, но важный шаг на этом пути, объясняется логика, которую коммутатор использует при пересылке кадров Ethernet.
|
This chapter breaks the content into two major sections.|В этой главе содержание разбито на два основных раздела.
The first reviews and then further develops the concepts behind LAN switching, which were first introduced back in Chapter 2, “Fundamentals of Ethernet LANs.” The second section then uses IOS show commands to verify that Cisco switches actually learned the MAC addresses, built the MAC address table, and forwarded frames.|В первом обзоре, а затем дальнейшее развитие концепций коммутации LAN, которые были впервые представлены еще в главе 2 «Основы сетей Ethernet». Затем во втором разделе используются команды show IOS для проверки того, что коммутаторы Cisco действительно узнали MAC-адреса, создали таблицу MAC-адресов и пересылали кадры.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
CHAPTER 5 Table 5-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|ГЛАВА 5 Таблица 5-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### LAN Switching Concepts
Концепции коммутации LAN   
__|__
--|--
|
Verifying and Analyzing Ethernet Switching 5–6 1.|Проверка и анализ коммутации Ethernet 5–6 1.
Which of the following statements describes part of the process of how a switch decides to forward a frame destined for a known unicast MAC address?|Какое из следующих утверждений описывает часть процесса принятия коммутатором решения о пересылке кадра, предназначенного для известного одноадресного MAC-адреса?
|
a. It compares the unicast destination address to the bridging, or MAC address, table.|а. Он сравнивает адрес назначения одноадресной рассылки с таблицей мостовых или MAC-адресов.
|
b. It compares the unicast source address to the bridging, or MAC address, table.|б. Он сравнивает адрес источника одноадресной передачи с таблицей мостовых или MAC-адресов.
|
c. It forwards the frame out all interfaces in the same VLAN except for the incoming interface.|c. Он пересылает кадр на все интерфейсы в той же VLAN, за исключением входящего интерфейса.
|
d. It compares the destination IP address to the destination MAC address.|d. Он сравнивает IP-адрес назначения с MAC-адресом назначения.
|
e. It compares the frame’s incoming interface to the source MAC entry in the MAC address table.|е. Он сравнивает входящий интерфейс кадра с записью MAC-адреса источника в таблице MAC-адресов.
|
2. Which of the following statements describes part of the process of how a LAN switch decides to forward a frame destined for a broadcast MAC address?|2. Какое из следующих утверждений описывает часть процесса принятия коммутатором локальной сети решения о пересылке кадра, предназначенного для широковещательного MAC-адреса?
|
a. It compares the unicast destination address to the bridging, or MAC address, table.|а. Он сравнивает адрес назначения одноадресной рассылки с таблицей мостовых или MAC-адресов.
|
b. It compares the unicast source address to the bridging, or MAC address, table.|б. Он сравнивает адрес источника одноадресной передачи с таблицей мостовых или MAC-адресов.
|
c. It forwards the frame out all interfaces in the same VLAN except for the incoming interface.|c. Он пересылает кадр на все интерфейсы в той же VLAN, за исключением входящего интерфейса.
|
d. It compares the destination IP address to the destination MAC address.|d. Он сравнивает IP-адрес назначения с MAC-адресом назначения.
|
e. It compares the frame’s incoming interface to the source MAC entry in the MAC address table.|е. Он сравнивает входящий интерфейс кадра с записью MAC-адреса источника в таблице MAC-адресов.
|
3. Which of the following statements best describes what a switch does with a frame destined for an unknown unicast address?|3. Какое из следующих утверждений лучше всего описывает, что коммутатор делает с кадром, предназначенным для неизвестного одноадресного адреса?
|
a. It forwards out all interfaces in the same VLAN except for the incoming interface.|а. Он перенаправляет все интерфейсы в той же VLAN, за исключением входящего интерфейса.
|
b. It forwards the frame out the one interface identified by the matching entry in the MAC address table.|б. Он пересылает кадр через один интерфейс, идентифицированный соответствующей записью в таблице MAC-адресов.
|
c. It compares the destination IP address to the destination MAC address.|c. Он сравнивает IP-адрес назначения с MAC-адресом назначения.
|
d. It compares the frame’s incoming interface to the source MAC entry in the MAC address table.|d. Он сравнивает входящий интерфейс кадра с записью MAC-адреса источника в таблице MAC-адресов.
|
4. Which of the following comparisons does a switch make when deciding whether a new MAC address should be added to its MAC address table?|4. Какое из следующих сравнений делает коммутатор при принятии решения о добавлении нового MAC-адреса в его таблицу MAC-адресов?
|
a. It compares the unicast destination address to the bridging, or MAC address, table.|а. Он сравнивает адрес назначения одноадресной рассылки с таблицей мостовых или MAC-адресов.
|
b. It compares the unicast source address to the bridging, or MAC address, table.|б. Он сравнивает адрес источника одноадресной передачи с таблицей мостовых или MAC-адресов.
|
c. It compares the VLAN ID to the bridging, or MAC address, table.|c. Он сравнивает идентификатор VLAN с таблицей моста или MAC-адресов.
|
d. It compares the destination IP address’s ARP cache entry to the bridging, or MAC address, table.|d. Он сравнивает запись кэша ARP IP-адреса назначения с таблицей мостовых или MAC-адресов.
|
5. A Cisco Catalyst switch has 24 10/100 ports, numbered 0/1 through 0/24.|5. Коммутатор Cisco Catalyst имеет 24 порта 10/100, пронумерованных от 0/1 до 0/24.
Ten PCs connect to the 10 lowest numbered ports, with those PCs working and sending data over the network.|Десять компьютеров подключаются к 10 портам с наименьшими номерами, и эти компьютеры работают и отправляют данные по сети.
The other ports are not connected to any device.|Остальные порты не подключены ни к какому устройству.
Which of the following answers lists facts displayed by the show interfaces status command?|В каком из следующих ответов перечислены факты, отображаемые командой show interfaces status?
|
a. Port Ethernet 0/1 is in a connected state.|а. Порт Ethernet 0/1 находится в подключенном состоянии.
|
b. Port Fast Ethernet 0/11 is in a connected state.|б. Порт Fast Ethernet 0/11 находится в подключенном состоянии.
|
c. Port Fast Ethernet 0/5 is in a connected state.|c. Порт Fast Ethernet 0/5 находится в подключенном состоянии.
|
d. Port Ethernet 0/15 is in a notconnected state.|d. Порт Ethernet 0/15 находится в неподключенном состоянии.
|
6. Consider the following output from a Cisco Catalyst switch:|6. Рассмотрим следующие выходные данные коммутатора Cisco Catalyst:
|
SW1# show mac address-table dynamic Mac Address Table|SW1 # показать таблицу MAC-адресов динамическую таблицу Mac-адресов
------------------------------------------- 
Порты типа Vlan Mac-адреса   
__|__
--|--
|
Vlan Mac Address Type Ports|
---- ----------- -------- -----
----------- -------- -----   
__|__
--|--
|
1 02AA.AAAA.AAAA DYNAMIC Gi0/1 1 02BB.BBBB.BBBB DYNAMIC Gi0/2 1 02CC.CCCC.CCCC DYNAMIC Gi0/3 Total Mac Addresses for this criterion: 3 Which of the following answers is true about this switch?|1 02AA.AAAA.AAAA DYNAMIC Gi0 / 1 1 02BB.BBBB.BBBB DYNAMIC Gi0 / 2 1 02CC.CCCC.CCCC DYNAMIC Gi0 / 3 Общее количество Mac-адресов для этого критерия: 3 Какой из следующих ответов верен об этом переключателе?
|
a. The output proves that port Gi0/2 connects directly to a device that uses address 02BB.BBBB.BBBB.|а. Выходные данные подтверждают, что порт Gi0 / 2 напрямую подключается к устройству, которое использует адрес 02BB.BBBB.BBBB.
|
b. The switch has learned three MAC addresses since the switch powered on.|б. Коммутатор запомнил три MAC-адреса с момента включения коммутатора.
|
c. The three listed MAC addresses were learned based on the destination MAC address of frames forwarded by the switch.|c. Три перечисленных MAC-адреса были изучены на основе MAC-адреса назначения кадров, пересылаемых коммутатором.
|
d. 02CC.CCCC.CCCC was learned from the source MAC address of a frame that entered port Gi0/3.|d. 02CC.CCCC.CCCC был получен из MAC-адреса источника кадра, поступившего в порт Gi0 / 3.
|
Foundation Topics LAN Switching Concepts A modern Ethernet LAN connects user devices as well as servers into some switches, with the switches then connecting to each other, sometimes in a design like Figure 5-1.|Основные темы Концепции коммутации LAN Современная локальная сеть Ethernet соединяет пользовательские устройства, а также серверы в некоторые коммутаторы, при этом коммутаторы затем подключаются друг к другу, иногда в конструкции, подобной рис.
Part of the LAN, called a campus LAN, supports the end-user population as shown on the left of the figure.|Часть LAN, называемая LAN кампуса, поддерживает конечных пользователей, как показано на рисунке слева.
End-user devices connect to LAN switches, which in turn connect to other switches so that a path exists to the rest of the network.|Устройства конечных пользователей подключаются к коммутаторам LAN, которые, в свою очередь, подключаются к другим коммутаторам, так что существует путь к остальной части сети.
The campus LAN switches sit in wiring closets close to the end users.|Коммутаторы локальной сети кампуса располагаются в коммутационных шкафах рядом с конечными пользователями.
On the right, the servers used to provide information to the users also connect to the LAN. Those servers and switches often sit in a closed room called a data center, with connections to the campus LAN to support traffic to/from the users.|Справа серверы, используемые для предоставления информации пользователям, также подключаются к локальной сети. Эти серверы и коммутаторы часто находятся в закрытом помещении, называемом центром обработки данных, с подключениями к локальной сети кампуса для поддержки трафика к / от пользователей.
|
To forward traffic from a user device to a server and back, each switch performs the same kind of logic, independently from each other.|Для пересылки трафика с пользовательского устройства на сервер и обратно каждый коммутатор выполняет одну и ту же логику независимо друг от друга.
The first half of this chapter examines the logic: how a switch chooses to forward an Ethernet frame, when the switch chooses to not forward the frame, and so on.|В первой половине этой главы исследуется логика: как коммутатор выбирает пересылку кадра Ethernet, когда коммутатор предпочитает не пересылать кадр и т. Д.
|
Figure 5-1 Campus LAN and Data Center LAN, Conceptual Drawing|Рисунок 5-1 ЛВС кампуса и ЛВС центра обработки данных, концептуальный чертеж
#### Overview of Switching Logic
Обзор логики переключения   
__|__
--|--
|
Ultimately, the role of a LAN switch is to forward Ethernet frames.|В конечном счете, роль коммутатора LAN заключается в пересылке кадров Ethernet.
LANs exist as a set of user devices, servers, and other devices that connect to switches, with the switches connected to each other.|ЛВС существуют как набор пользовательских устройств, серверов и других устройств, которые подключаются к коммутаторам, причем коммутаторы подключены друг к другу.
The LAN switch has one primary job: to forward frames to the correct destination (MAC) address.|Коммутатор LAN выполняет одну основную задачу: пересылать кадры на правильный адрес назначения (MAC).
And to achieve that goal, switches use logic—logic based on the source and destination MAC address in each frame’s Ethernet header.|И для достижения этой цели коммутаторы используют логику - логику, основанную на MAC-адресах источника и назначения в заголовке Ethernet каждого кадра.
|
LAN switches receive Ethernet frames and then make a switching decision: either forward the frame out some other ports or ignore the frame.|Коммутаторы LAN получают кадры Ethernet, а затем принимают решение о коммутации: либо перенаправить кадр на другие порты, либо игнорировать кадр.
To accomplish this primary mission, switches perform three actions:|Для выполнения этой основной задачи коммутаторы выполняют три действия:
|
1. Deciding when to forward a frame or when to filter (not forward) a frame, based on the destination MAC address 2.|1. Решение, когда пересылать кадр или когда фильтровать (не пересылать) кадр, на основе MAC-адреса назначения 2.
Preparing to forward frames by learning MAC addresses by examining the source MAC address of each frame received by the switch 3.|Подготовка к пересылке кадров путем изучения MAC-адресов путем изучения исходного MAC-адреса каждого кадра, полученного коммутатором 3.
Preparing to forward only one copy of the frame to the destination by creating a (Layer 2) loop-free environment with other switches by using Spanning Tree Protocol (STP)|Подготовка к пересылке только одной копии кадра в пункт назначения путем создания среды (уровня 2) без петель с другими коммутаторами с использованием протокола связующего дерева (STP)
|
The first action is the switch’s primary job, whereas the other two items are overhead functions.|Первое действие - это основная задача коммутатора, а два других элемента - служебные.
|
NOTE Throughout this book’s discussion of LAN switches, the terms switch port and switch interface are synonymous.|ПРИМЕЧАНИЕ. В этой книге, посвященной коммутаторам LAN, термины "порт коммутатора" и "интерфейс коммутатора" являются синонимами.
|
Although Chapter 2’s section titled “Ethernet Data-Link Protocols” already discussed the frame format, this discussion of Ethernet switching is pretty important, so reviewing the Ethernet frame at this point might be helpful.|Хотя в разделе главы 2, озаглавленном «Протоколы канала передачи данных Ethernet», уже обсуждался формат кадра, это обсуждение коммутации Ethernet очень важно, поэтому рассмотрение кадра Ethernet на этом этапе может оказаться полезным.
Figure 5-2 shows one popular format for an Ethernet frame.|На рис. 5-2 показан один из популярных форматов кадра Ethernet.
Basically, a switch would take the frame shown in the figure, make a decision of where to forward the frame, and send the frame out that other interface.|По сути, коммутатор берет кадр, показанный на рисунке, принимает решение о том, куда пересылать кадр, и отправляет его через этот другой интерфейс.
|
Figure 5-2 IEEE 802.3 Ethernet Frame (One Variation)|Рисунок 5-2 Кадр Ethernet IEEE 802.3 (один вариант)
|
Most of the upcoming discussions and figures about Ethernet switching focus on the use of the destination and source MAC address fields in the header.|Большинство предстоящих обсуждений и цифр о коммутации Ethernet сосредоточены на использовании полей MAC-адреса назначения и источника в заголовке.
All Ethernet frames have both a destination and source MAC address.|Все кадры Ethernet имеют MAC-адрес назначения и источника.
Both are 6-bytes long (represented as 12 hex digits in the book) and are a key part of the switching logic discussed in this section.|Оба имеют длину 6 байтов (в книге представлены 12 шестнадцатеричными цифрами) и являются ключевой частью логики переключения, обсуждаемой в этом разделе.
Refer back to Chapter 2’s discussion of the header in detail for more info on the rest of the Ethernet frame.|Вернитесь к подробному обсуждению заголовка в главе 2 для получения дополнительной информации об остальной части кадра Ethernet.
|
NOTE The companion website includes a video that explains the basics of Ethernet switching.|ПРИМЕЧАНИЕ На сопутствующем веб-сайте есть видео, в котором объясняются основы коммутации Ethernet.
|
Now on to the details of how Ethernet switching works!|А теперь подробнее о том, как работает коммутация Ethernet!
#### Forwarding Known Unicast Frames
Пересылка известных одноадресных кадров   
__|__
--|--
|
To decide whether to forward a frame, a switch uses a dynamically built table that lists MAC addresses and outgoing interfaces.|Чтобы решить, следует ли пересылать кадр, коммутатор использует динамически построенную таблицу, в которой перечислены MAC-адреса и исходящие интерфейсы.
Switches compare the frame’s destination MAC address to this table to decide whether the switch should forward a frame or simply ignore it.|Коммутаторы сравнивают MAC-адрес назначения кадра с этой таблицей, чтобы решить, должен ли коммутатор пересылать кадр или просто игнорировать его.
For example, consider the simple network shown in Figure 5-3, with Fred sending a frame to Barney.|Например, рассмотрим простую сеть, показанную на рисунке 5-3, в которой Фред отправляет кадр Барни.
|
In this figure, Fred sends a frame with destination address 0200.2222.2222 (Barney’s MAC address).|На этом рисунке Фред отправляет кадр с адресом назначения 0200.2222.2222 (MAC-адрес Барни).
The switch compares the destination MAC address (0200.2222.2222) to the MAC address table, matching the bold table entry.|Коммутатор сравнивает MAC-адрес назначения (0200.2222.2222) с таблицей MAC-адресов, соответствующей записи в таблице, выделенной жирным шрифтом.
That matched table entry tells the switch to forward the frame out port F0/2, and only port F0/2.|Эта совпадающая запись в таблице сообщает коммутатору, что нужно перенаправить порт вывода кадра F0 / 2 и только порт F0 / 2.
|
Answers to the “Do I Know This Already?” quiz:|Ответы на вопрос «Знаю ли я это уже?» викторина:
|
1 A 2 C 3 A 4 B 5 C 6 D NOTE A switch’s MAC address table is also called the switching table, or bridging table, or even the Content-Addressable Memory (CAM) table, in reference to the type of physical memory used to store the table.|1 A 2 C 3 A 4 B 5 C 6 D ПРИМЕЧАНИЕ Таблица MAC-адресов коммутатора также называется таблицей коммутации, таблицей мостов или даже таблицей адресуемой памяти (CAM) в зависимости от типа используемой физической памяти. для хранения таблицы.
|
Figure 5-3 Sample Switch Forwarding and Filtering Decision A switch’s MAC address table lists the location of each MAC relative to that one switch.|Рисунок 5-3 Пример решения о пересылке и фильтрации коммутатора В таблице MAC-адресов коммутатора указано расположение каждого MAC-адреса относительно этого коммутатора.
In LANs with multiple switches, each switch makes an independent forwarding decision based on its own MAC address table.|В локальных сетях с несколькими коммутаторами каждый коммутатор принимает независимое решение о пересылке на основе своей собственной таблицы MAC-адресов.
Together, they forward the frame so that it eventually arrives at the destination.|Вместе они пересылают кадр, чтобы он в конечном итоге прибыл в пункт назначения.
|
For example, Figure 5-4 shows the first switching decision in a case in which Fred sends a frame to Wilma, with destination MAC 0200.3333.3333.|Например, на рис. 5-4 показано первое решение о переключении в случае, когда Фред отправляет кадр в Wilma с MAC-адресом назначения 0200.3333.3333.
The topology has changed versus the previous figure, this time with two switches, and Fred and Wilma connected to two different switches.|Топология изменилась по сравнению с предыдущим рисунком, на этот раз с двумя коммутаторами, а Фред и Вильма подключены к двум разным коммутаторам.
Figure 5-3 shows the first switch’s logic, in reaction to Fred sending the original frame.|На рис. 5-3 показана логика первого переключателя в ответ на отправку Фредом исходного кадра.
Basically, the switch receives the frame in port F0/1, finds the destination MAC (0200.3333.3333) in the MAC address table, sees the outgoing port of G0/1, so SW1 forwards the frame out its G0/1 port.|По сути, коммутатор получает кадр в порту F0 / 1, находит MAC-адрес назначения (0200.3333.3333) в таблице MAC-адресов, видит исходящий порт G0 / 1, поэтому SW1 пересылает кадр на свой порт G0 / 1.
|
F0/2 Fred Barney 0200.2222.2222 F0/1 Dest 0200.2222.2222 G0/1 F0/4 F0/3 Wilma 0200.3333.3333 Betty 0200.4444.4444 MAC Address F0/1 F0/2 G0/1 G0/1 0200.1111.1111 0200.2222.2222 0200.3333.3333 0200.4444.4444 Output SW1 Address Table MAC Address G0/2 G0/2 F0/3 F0/4 0200.1111.1111 0200.2222.2222 0200.3333.3333 0200.4444.4444 Output SW2 Address Table G0/2 1) Frame Entered F0/1...|F0 / 2 Fred Barney 0200.2222.2222 F0 / 1 Dest 0200.2222.2222 G0 / 1 F0 / 4 F0 / 3 Wilma 0200.3333.3333 Betty 0200.4444.4444 MAC-адрес F0 / 1 F0 / 2 G0 / 1 G0 / 1 0200.1111.1111 0200.2222 .2222 0200.3333.3333 0200.4444.4444 Таблица адресов выходного SW1 MAC-адрес G0 / 2 G0 / 2 F0 / 3 F0 / 4 0200.1111.1111 0200.2222.2222 0200.3333.3333 0200.4444.4444 Таблица адресов выходного SW2 G0 / 2 1) Введенный кадр F0 / 1 ...
|
Figure 5-4 Forwarding Decision with Two Switches: First Switch That same frame next arrives at switch SW2, entering SW2’s G0/2 interface.|Рис. 5-4. Решение о пересылке с двумя коммутаторами: первый коммутатор. Затем тот же самый кадр поступает на коммутатор SW2, входя в интерфейс G0 / 2 SW2.
As shown in Figure 5-5, SW2 uses the same logic steps, but using SW2’s table.|Как показано на Рисунке 5-5, SW2 использует те же логические шаги, но с использованием таблицы SW2.
The MAC table lists the forwarding instructions for that switch only.|В таблице MAC перечислены инструкции по пересылке только для этого коммутатора.
In this case, switch SW2 forwards the frame out its F0/3 port, based on SW2’s MAC address table.|В этом случае коммутатор SW2 пересылает кадр на свой порт F0 / 3 на основе таблицы MAC-адресов SW2.
|
F0/2 Fred Barney 0200.2222.2222 F0/1 Dest 0200.3333.3333 G0/1 F0/4 F0/3 Wilma 0200.3333.3333 Betty 0200.4444.4444 MAC Address F0/1 F0/2 G0/1 G0/1 0200.1111.1111 0200.2222.2222 0200.3333.3333 0200.4444.4444 Output SW1 Address Table MAC Address G0/2 G0/2 F0/3 F0/4 0200.1111.1111 0200.2222.2222 0200.3333.3333 0200.4444.4444 Output SW2 Address Table G0/2 1) Frame Entered G0/2...|F0 / 2 Fred Barney 0200.2222.2222 F0 / 1 Dest 0200.3333.3333 G0 / 1 F0 / 4 F0 / 3 Wilma 0200.3333.3333 Betty 0200.4444.4444 MAC-адрес F0 / 1 F0 / 2 G0 / 1 G0 / 1 0200.1111.1111 0200.2222 .2222 0200.3333.3333 0200.4444.4444 Таблица адресов выходного SW1 MAC-адрес G0 / 2 G0 / 2 F0 / 3 F0 / 4 0200.1111.1111 0200.2222.2222 0200.3333.3333 0200.4444.4444 Таблица адресов выходного SW2 G0 / 2 1) Введенный кадр G0 / 2 ...
|
Figure 5-5 Forwarding Decision with Two Switches: Second Switch NOTE The forwarding choice by a switch was formerly called a forward-versus-filter decision, because the switch also chooses to not forward (to filter) frames, not sending the frame out some ports.|Рисунок 5-5 Решение о пересылке с двумя коммутаторами: второй коммутатор ПРИМЕЧАНИЕ. Выбор пересылки коммутатором ранее назывался решением о пересылке или фильтрации, потому что коммутатор также предпочитает не пересылать (фильтровать) кадры, не отправляя кадр из некоторых порты.
|
The examples so far use switches that happen to have a MAC table with all the MAC addresses listed.|В примерах до сих пор используются переключатели, у которых есть таблица MAC со всеми перечисленными MAC-адресами.
As a result, the destination MAC address in the frame is known to the switch.|В результате MAC-адрес назначения в кадре известен коммутатору.
The frames are called known unicast frames, or simply known unicasts, because the destination address is a unicast address, and the destination is known.|Эти кадры называются известными одноадресными кадрами или просто известными одноадресными передачами, потому что адрес назначения является адресом одноадресной передачи, а пункт назначения известен.
As shown in these examples, switches forward known unicast frames out one port: the port as listed in the MAC table entry for that MAC address.|Как показано в этих примерах, коммутаторы пересылают известные одноадресные кадры на один порт: порт, указанный в записи таблицы MAC-адресов для этого MAC-адреса.
#### Learning MAC Addresses
Изучение MAC-адресов   
__|__
--|--
|
Thankfully, the networking staff does not have to type in all those MAC table entries.|К счастью, сетевому персоналу не нужно вводить все эти записи в таблице MAC-адресов.
|
Instead, each switch does its second main function: to learn the MAC addresses and interfaces to put into its address table.|Вместо этого каждый коммутатор выполняет свою вторую основную функцию: изучает MAC-адреса и интерфейсы, которые необходимо поместить в свою таблицу адресов.
With a complete MAC address table, the switch can make accurate forwarding and filtering decisions as just discussed.|Имея полную таблицу MAC-адресов, коммутатор может принимать точные решения по пересылке и фильтрации, как только что обсуждалось.
|
Switches build the address table by listening to incoming frames and examining the source MAC address in the frame.|Коммутаторы создают таблицу адресов, прослушивая входящие кадры и проверяя MAC-адрес источника в кадре.
If a frame enters the switch and the source MAC address is not in the MAC address table, the switch creates an entry in the table.|Если кадр поступает в коммутатор, а MAC-адрес источника отсутствует в таблице MAC-адресов, коммутатор создает запись в таблице.
That table entry lists the interface from which the frame arrived.|В этой записи таблицы указан интерфейс, из которого пришел фрейм.
Switch learning logic is that simple.|Логика обучения переключению настолько проста.
|
Figure 5-6 depicts the same single-switch topology network as Figure 5-3, but before the switch has built any address table entries.|На рис. 5-6 изображена та же топология сети с одним коммутатором, что и на рис. 5-3, но до того, как коммутатор создал какие-либо записи в таблице адресов.
The figure shows the first two frames sent in this network—first a frame from Fred, addressed to Barney, and then Barney’s response, addressed to Fred.|На рисунке показаны первые два кадра, отправленные в этой сети - сначала кадр от Фреда, адресованный Барни, а затем ответ Барни, адресованный Фреду.
|
Figure 5-6 Switch Learning: Empty Table and Adding Two Entries (Figure 5-6 depicts the MAC learning process only, and ignores the forwarding process and therefore ignores the destination MAC addresses.)|Рисунок 5-6 Обучение коммутатора: пустая таблица и добавление двух записей (Рисунок 5-6 отображает только процесс обучения MAC, игнорируя процесс пересылки и, следовательно, игнорирует MAC-адреса назначения.)
|
Focus on the learning process and how the MAC table grows at each step as shown on the right side of the figure.|Сосредоточьтесь на процессе обучения и на том, как таблица MAC растет на каждом этапе, как показано в правой части рисунка.
The switch begins with an empty MAC table, as shown in the upperright part of the figure.|Коммутатор начинается с пустой таблицы MAC-адресов, как показано в правой верхней части рисунка.
Then Fred sends his first frame (labeled “1”) to Barney, so the switch adds an entry for 0200.1111.1111, Fred’s MAC address, associated with interface F0/1.|Затем Фред отправляет свой первый кадр (помеченный «1») Барни, поэтому коммутатор добавляет запись для 0200.1111.1111, MAC-адреса Фреда, связанного с интерфейсом F0 / 1.
Why F0/1?|Почему F0 / 1?
The frame sent by Fred entered the switch’s F0/1 port.|Фрейм, посланный Фредом, поступил в порт F0 / 1 коммутатора.
SW1’s logic runs something like this: “The source is MAC 0200.1111.1111, the frame entered F0/1, so from my perspective, 0200.1111.1111 must be reachable out my port F0/1.”|Логика SW1 выглядит примерно так: «Источник - MAC 0200.1111.1111, кадр вошел в F0 / 1, поэтому, с моей точки зрения, 0200.1111.1111 должен быть доступен через мой порт F0 / 1».
|
Continuing the example, when Barney replies in Step 2, the switch adds a second entry, this one for 0200.2222.2222, Barney’s MAC address, along with interface F0/2.|Продолжая пример, когда Барни отвечает на шаге 2, коммутатор добавляет вторую запись, на этот раз для 0200.2222.2222, MAC-адреса Барни, вместе с интерфейсом F0 / 2.
Why F0/2?|Почему F0 / 2?
The frame Barney sent entered the switch’s F0/2 interface.|Фрейм, посланный Барни, вошел в интерфейс F0 / 2 коммутатора.
Learning always occurs by looking at the source MAC address in the frame and adds the incoming interface as the associated port.|Обучение всегда происходит путем просмотра исходного MAC-адреса в кадре и добавления входящего интерфейса в качестве связанного порта.
#### Flooding Unknown Unicast and Broadcast Frames
Заливка неизвестных одноадресных и широковещательных кадров   
__|__
--|--
|
Now again turn your attention to the forwarding process, using the topology in Figure 5-5.|Теперь снова обратим ваше внимание на процесс пересылки, используя топологию на рисунке 5-5.
|
What do you suppose the switch does with Fred’s first frame, the one that occurred when there were no entries in the MAC address table?|Как вы думаете, что коммутатор делает с первым кадром Фреда, который произошел, когда в таблице MAC-адресов не было записей?
As it turns out, when there is no matching entry in the table, switches forward the frame out all interfaces (except the incoming interface)|Оказывается, когда в таблице нет соответствующей записи, переключатели пересылают кадр из всех интерфейсов (кроме входящего интерфейса)
|
using a process called flooding.|с помощью процесса, называемого наводнением.
And the frame whose destination address is unknown to the switch is called an unknown unicast frame, or simply an unknown unicast.|И кадр, адрес назначения которого неизвестен коммутатору, называется неизвестным одноадресным кадром или просто неизвестным одноадресным.
|
Switches flood unknown unicast frames.|Коммутаторы лавинно рассылают неизвестные одноадресные кадры.
Flooding means that the switch forwards copies of the frame out all ports, except the port on which the frame was received.|Флудинг означает, что коммутатор пересылает копии кадра на все порты, кроме порта, на котором кадр был получен.
The idea is simple:|Идея проста:
|
if you do not know where to send it, send it everywhere, to deliver the frame.|если не знаете, куда его отправить, отправьте его везде, чтобы доставить рамку.
And, by the way, that device will likely then send a reply—and then the switch can learn that device’s MAC address and forward future frames out one port as a known unicast frame.|И, кстати, это устройство, скорее всего, затем отправит ответ, а затем коммутатор сможет узнать MAC-адрес этого устройства и пересылать будущие кадры через один порт как известный одноадресный кадр.
|
Switches also flood LAN broadcast frames (frames destined to the Ethernet broadcast address of FFFF.FFFF.FFFF) because this process helps deliver a copy of the frame to all devices in the LAN.|Коммутаторы также рассылают широковещательные кадры LAN (кадры, предназначенные для широковещательного адреса Ethernet FFFF.FFFF.FFFF), потому что этот процесс помогает доставить копию кадра на все устройства в LAN.
|
For example, Figure 5-7 shows the same first frame sent by Fred, when the switch’s MAC table is empty.|Например, на рис. 5-7 показан тот же самый первый кадр, отправленный Фредом, когда таблица MAC-адресов коммутатора пуста.
At step 1, Fred sends the frame.|На шаге 1 Фред отправляет фрейм.
At step 2, the switch sends a copy of the frame out all three of the other interfaces.|На шаге 2 коммутатор отправляет копию кадра на все три других интерфейса.
|
Figure 5-7 Switch Flooding: Unknown Unicast Arrives, Floods Out Other Ports|Рисунок 5-7 Переполнение коммутатора: прибывает неизвестная одноадресная рассылка, затопление других портов
#### Avoiding Loops Using Spanning Tree Protocol
Избежание циклов с помощью протокола связующего дерева   
__|__
--|--
|
The third primary feature of LAN switches is loop prevention, as implemented by Spanning Tree Protocol (STP). Without STP, any flooded frames would loop for an indefinite period of time in Ethernet networks with physically redundant links.|Третьей основной функцией коммутаторов LAN является предотвращение петель, реализованное протоколом Spanning Tree Protocol (STP). Без STP любые лавинные кадры будут зацикливаться в течение неопределенного периода времени в сетях Ethernet с физически избыточными каналами.
To prevent looping frames, STP blocks some ports from forwarding frames so that only one active path exists between any pair of LAN segments.|Чтобы предотвратить зацикливание кадров, STP блокирует пересылку кадров некоторыми портами, поэтому между любой парой сегментов LAN существует только один активный путь.
|
The result of STP is good: frames do not loop infinitely, which makes the LAN usable.|Результат STP хороший: кадры не зацикливаются бесконечно, что делает LAN пригодной для использования.
|
However, STP has negative features as well, including the fact that it takes some work to balance traffic across the redundant alternate links.|Однако у STP есть и отрицательные особенности, в том числе то, что требуется некоторая работа для балансировки трафика через резервные альтернативные каналы.
|
A simple example makes the need for STP more obvious.|Простой пример делает необходимость STP более очевидной.
Remember, switches flood unknown unicast frames and broadcast frames.|Помните, что коммутаторы лавинно рассылают неизвестные одноадресные и широковещательные кадры.
Figure 5-8 shows an unknown unicast frame, sent by Larry to Bob, which loops forever because the network has redundancy but no STP.|На рисунке 5-8 показан неизвестный одноадресный кадр, отправленный Ларри Бобу, который зацикливается навсегда, потому что в сети есть избыточность, но нет STP.
|
Note that the figure shows one direction of the looping frame only, just to reduce clutter, but a copy of the frame would also loop the other direction.|Обратите внимание, что на рисунке показано только одно направление зацикленного кадра, чтобы уменьшить беспорядок, но копия кадра также зацикливается в другом направлении.
|
Figure 5-8 Network with Redundant Links but Without STP: The Frame Loops Forever The flooding of this frame would result in the frame repeatedly rotating around the three switches, because none of the switches list Bob’s MAC address in their address tables—so each switch floods the frame.|Рис. 5-8 Сеть с избыточными ссылками, но без STP: цикл кадра вечно Заливка этого кадра приведет к тому, что кадр будет постоянно вращаться вокруг трех переключателей, потому что ни один из коммутаторов не перечисляет MAC-адрес Боба в своих адресных таблицах, поэтому каждый коммутатор заливает кадр.
And while the flooding process is a good mechanism for forwarding unknown unicasts and broadcasts, the continual flooding of traffic frames as in the figure can completely congest the LAN to the point of making it unusable.|И хотя процесс лавинной рассылки является хорошим механизмом для пересылки неизвестных одноадресных и широковещательных рассылок, непрерывная лавинная рассылка кадров трафика, как показано на рисунке, может полностью перегружать LAN до такой степени, что она становится непригодной для использования.
|
A topology like Figure 5-8, with redundant links, is good, but we need to prevent the bad effect of those looping frames.|Топология, подобная рис. 5-8, с избыточными ссылками, хороша, но нам нужно предотвратить плохой эффект этих циклических кадров.
To avoid Layer 2 loops, all switches need to use STP. STP causes each interface on a switch to settle into either a blocking state or a forwarding state.|Чтобы избежать петель уровня 2, все коммутаторы должны использовать протокол STP. STP заставляет каждый интерфейс на коммутаторе переходить либо в состояние блокировки, либо в состояние пересылки.
|
Blocking means that the interface cannot forward or receive data frames, while forwarding means that the interface can send and receive data frames.|Блокировка означает, что интерфейс не может пересылать или получать кадры данных, в то время как пересылка означает, что интерфейс может отправлять и получать кадры данных.
If a correct subset of the interfaces is blocked, only a single currently active logical path exists between each pair of LANs.|Если правильное подмножество интерфейсов заблокировано, между каждой парой локальных сетей существует только один активный в настоящий момент логический путь.
|
NOTE STP behaves identically for a transparent bridge and a switch.|ПРИМЕЧАНИЕ STP ведет себя одинаково для прозрачного моста и коммутатора.
Therefore, the terms bridge, switch, and bridging device all are used interchangeably when discussing STP.|Таким образом, при обсуждении протокола STP термины «мост», «коммутатор» и «мостовое устройство» используются как взаимозаменяемые.
|
Chapter 9 of this book, “Spanning Tree Protocol Concepts,” examines STP in depth, including how STP prevents loops.|В главе 9 этой книги «Концепции протокола связующего дерева» подробно рассматривается протокол STP, в том числе то, как STP предотвращает образование петель.
#### LAN Switching Summary
Обзор коммутации LAN   
__|__
--|--
|
Switches use Layer 2 logic, examining the Ethernet data-link header to choose how to process frames.|Коммутаторы используют логику уровня 2, исследуя заголовок канала передачи данных Ethernet, чтобы выбрать способ обработки кадров.
In particular, switches make decisions to forward and filter frames, learn MAC addresses, and use STP to avoid loops, as follows:|В частности, коммутаторы принимают решения о пересылке и фильтрации кадров, изучении MAC-адресов и использовании протокола STP для предотвращения петель следующим образом:
|
Step 1.|Шаг 1.
Switches forward frames based on the destination MAC address:|Переключает пересылку кадров на основе MAC-адреса назначения:
|
A. If the destination MAC address is a broadcast, multicast, or unknown destination unicast (a unicast not listed in the MAC table), the switch floods the frame.|A. Если MAC-адрес назначения является широковещательной, многоадресной или одноадресной рассылкой неизвестного назначения (одноадресная передача, не указанная в таблице MAC-адресов), коммутатор лавинно рассылает кадр.
|
B. If the destination MAC address is a known unicast address (a unicast address found in the MAC table):|B. Если MAC-адрес назначения является известным одноадресным адресом (одноадресный адрес, указанный в таблице MAC):
|
i. If the outgoing interface listed in the MAC address table is different from the interface in which the frame was received, the switch forwards the frame out the outgoing interface.|я. Если исходящий интерфейс, указанный в таблице MAC-адресов, отличается от интерфейса, в котором был получен кадр, коммутатор пересылает этот кадр из исходящего интерфейса.
|
ii.|II.
If the outgoing interface is the same as the interface in which the frame was received, the switch filters the frame, meaning that the switch simply ignores the frame and does not forward it.|Если исходящий интерфейс совпадает с интерфейсом, в котором был получен кадр, коммутатор фильтрует кадр, что означает, что коммутатор просто игнорирует кадр и не пересылает его.
|
Step 2.|Шаг 2.
Switches use the following logic to learn MAC address table entries:|Коммутаторы используют следующую логику для изучения записей таблицы MAC-адресов:
|
A. For each received frame, examine the source MAC address and note the interface from which the frame was received.|A. Для каждого полученного кадра проверьте MAC-адрес источника и обратите внимание на интерфейс, с которого был получен кадр.
|
B. If it is not already in the table, add the MAC address and interface it was learned on.|B. Если его еще нет в таблице, добавьте MAC-адрес и интерфейс, на котором он был изучен.
|
Step 3.|Шаг 3.
Switches use STP to prevent loops by causing some interfaces to block, meaning that they do not send or receive frames.|Коммутаторы используют протокол STP для предотвращения петель, вызывая блокировку некоторых интерфейсов, что означает, что они не отправляют и не принимают фреймы.
### Verifying and Analyzing Ethernet Switching
Проверка и анализ коммутации Ethernet   
__|__
--|--
|
A Cisco Catalyst switch comes from the factory ready to switch frames.|Коммутатор Cisco Catalyst поставляется с завода готовым к переключению кадров.
All you have to do is connect the power cable, plug in the Ethernet cables, and the switch starts switching incoming frames.|Все, что вам нужно сделать, это подключить кабель питания, подключить кабели Ethernet, и коммутатор начнет переключение входящих кадров.
Connect multiple switches together, and they are ready to forward frames between the switches as well.|Соедините несколько коммутаторов вместе, и они также готовы пересылать кадры между коммутаторами.
And the big reason behind this default behavior has to do with the default settings on the switches.|И основная причина такого поведения по умолчанию связана с настройками переключателей по умолчанию.
|
Cisco Catalyst switches come ready to get busy switching frames because of settings like these:|Коммутаторы Cisco Catalyst готовы принять занятые кадры коммутации из-за таких настроек:
###### The interfaces are enabled by default, ready to start working once a cable is connected.
Интерфейсы включены по умолчанию и готовы начать работу после подключения кабеля.   
###### All interfaces are assigned to VLAN 1.
Все интерфейсы назначены VLAN 1.   
###### 10/100 and 10/100/1000 interfaces use autonegotiation by default.
Интерфейсы 10/100 и 10/100/1000 по умолчанию используют автосогласование.   
###### The MAC learning, forwarding, flooding logic all works by default.
Логика обучения MAC, пересылки и лавинной рассылки работает по умолчанию.   
###### STP is enabled by default.
По умолчанию протокол STP включен.   
__|__
--|--
|
This second section of the chapter examines how switches will work with these default settings, showing how to verify the Ethernet learning and forwarding process.|Во втором разделе главы исследуется, как коммутаторы будут работать с этими настройками по умолчанию, и показано, как проверить процесс обучения и пересылки Ethernet.
#### Demonstrating MAC Learning
Демонстрация обучения MAC   
__|__
--|--
|
To see a switch’s MAC address table, use the show mac address-table command.|Чтобы просмотреть таблицу MAC-адресов коммутатора, используйте команду show mac address-table.
With no additional parameters, this command lists all known MAC addresses in the MAC table, including some overhead static MAC addresses that you can ignore.|Без дополнительных параметров эта команда перечисляет все известные MAC-адреса в таблице MAC-адресов, включая некоторые служебные статические MAC-адреса, которые можно игнорировать.
To see all the dynamically learned MAC addresses only, instead use the show mac address-table dynamic command.|Чтобы увидеть только все динамически полученные MAC-адреса, используйте вместо этого динамическую команду show mac address-table dynamic.
|
The examples in this chapter use almost no configuration, as if you just unboxed the switch when you first purchased it.|Примеры в этой главе почти не используют конфигурацию, как если бы вы только что распаковали коммутатор, когда впервые купили его.
For the examples, the switches have no configuration other than the hostname command to set a meaningful hostname.|В примерах переключатели не имеют конфигурации, кроме команды hostname для установки значимого имени хоста.
Note that to do this in lab, all I did was|Обратите внимание: чтобы сделать это в лаборатории, я всего лишь
###### Use the erase startup-config EXEC command to erase the startup-config file
Используйте команду EXEC erase startup-config, чтобы стереть файл конфигурации запуска.   
###### Use the delete vlan.dat EXEC command to delete the VLAN configuration details
Используйте команду EXEC delete vlan.dat, чтобы удалить детали конфигурации VLAN.   
###### Use the reload EXEC command to reload the switch (thereby using the empty startupconfig,
Используйте команду reload EXEC, чтобы перезагрузить коммутатор (тем самым используя пустой файл startupconfig,   
__|__
--|--
|
with no VLAN information configured)|без настроенной информации о VLAN)
###### Configure the hostname SW1 command to set the switch hostname
Настройте команду hostname SW1, чтобы установить имя хоста коммутатора.   
__|__
--|--
|
Once done, the switch starts forwarding and learning MAC addresses, as demonstrated in Example 5-1.|После этого коммутатор начинает пересылку и изучение MAC-адресов, как показано в Примере 5-1.
|
Example 5-1 Show mac address-table dynamic for Figure 5-7 Example end.|Пример 5-1. Показать динамическую таблицу MAC-адресов для рисунка 5-7. Конец примера.
|
First, focus on two columns of the table: the MAC Address and Ports columns of the table.|Сначала сфокусируйтесь на двух столбцах таблицы: столбцах MAC-адреса и портов.
|
The values should look familiar: they match the earlier single-switch example, as repeated here as Figure 5-9.|Значения должны выглядеть знакомыми: они соответствуют более раннему примеру с одним переключателем, как показано на рисунке 5-9.
Note the four MAC addresses listed, along with their matching ports, as shown in the figure.|Обратите внимание на четыре перечисленных MAC-адреса и соответствующие им порты, как показано на рисунке.
|
Figure 5-9 Single Switch Topology Used in Verification Section Next, look at the Type field in the heading of the output table.|Рис. 5-9 Топология с одним коммутатором, используемая в разделе проверки. Затем посмотрите на поле Type в заголовке выходной таблицы.
The column tells us how the switch learned the MAC address as described earlier in this chapter; in this case, the switch learned all MAC addresses dynamically.|Столбец сообщает нам, как коммутатор узнал MAC-адрес, как описано ранее в этой главе; в этом случае коммутатор запоминал все MAC-адреса динамически.
You can also statically predefine MAC table entries using a couple of different features, including port security, and those would appear as Static in the Type column.|Вы также можете статически предопределить записи таблицы MAC-адресов, используя несколько различных функций, включая безопасность порта, и они будут отображаться как статические в столбце Тип.
|
Finally, the VLAN column of the output gives us a chance to briefly discuss how VLANs impact switching logic.|Наконец, столбец VLAN в выходных данных дает нам возможность кратко обсудить, как VLAN влияют на логику коммутации.
LAN switches forward Ethernet frames inside a VLAN. What that means is if a frame enters via a port in VLAN 1, then the switch will forward or flood that frame out other ports in VLAN 1 only, and not out any ports that happen to be assigned to another VLAN. Chapter 8, “Implementing Ethernet Virtual LANs,” looks at all the details of how switches forward frames when using VLANs.|Коммутаторы LAN пересылают кадры Ethernet внутри VLAN. Это означает, что если фрейм поступает через порт в VLAN 1, то коммутатор будет перенаправлять или лавировать этот фрейм только для других портов в VLAN 1, а не из каких-либо портов, которые были назначены другой VLAN. Глава 8 «Реализация виртуальных локальных сетей Ethernet» рассматривает все детали того, как коммутаторы пересылают кадры при использовании виртуальных локальных сетей.
#### Switch Interfaces
Коммутатор Интерфейсы   
__|__
--|--
|
The first example assumes that you installed the switch and cabling correctly, and that the switch interfaces work.|В первом примере предполагается, что вы правильно установили коммутатор и кабели и что интерфейсы коммутатора работают.
Once you do the installation and connect to the Console, you can easily check the status of those interfaces with the show interfaces status command, as shown in Example 5-2.|После того, как вы выполните установку и подключитесь к консоли, вы можете легко проверить состояние этих интерфейсов с помощью команды show interfaces status, как показано в примере 5-2.
|
Example 5-2 Show interfaces status on Switch SW1 Example end.|Пример 5-2 Показать статус интерфейсов на переключателе SW1 Пример конец.
|
Focus on the port column for a moment.|Сосредоточьтесь на колонке портов на мгновение.
As a reminder, Cisco Catalyst switches name their ports based on the fastest specification supported, so in this case, the switch has 24 interfaces named FastEthernet, and two named GigabitEthernet.|Напоминаем, что коммутаторы Cisco Catalyst называют свои порты на основе самой быстрой из поддерживаемых спецификаций, поэтому в этом случае коммутатор имеет 24 интерфейса с именем FastEthernet и два с именем GigabitEthernet.
Many commands abbreviate those terms, this time as Fa for FastEthernet and Gi for GigabitEthernet. (The example happens to come from a Cisco Catalyst switch that has 24 10/100 ports and two 10/100/1000 ports.)|Многие команды сокращают эти термины, на этот раз как Fa для FastEthernet и Gi для GigabitEthernet. (Примером является коммутатор Cisco Catalyst, который имеет 24 порта 10/100 и два порта 10/100/1000.)
|
The Status column, of course, tells us the status or state of the port.|Столбец Status, конечно же, сообщает нам статус или состояние порта.
In this case, the lab switch had cables and devices connected to ports F0/1–F0/4 only, with no other cables connected.|В этом случае лабораторный коммутатор имел кабели и устройства, подключенные только к портам F0 / 1 – F0 / 4, без других подключенных кабелей.
|
As a result, those first four ports have a state of connected, meaning that the ports have a cable and are functional.|В результате эти первые четыре порта находятся в состоянии «подключено», что означает, что порты имеют кабель и работают.
The notconnect state means that the port is not yet functioning.|Состояние notconnect означает, что порт еще не работает.
|
It may mean that there is no cable installed, but other problems may exist as well. (The section “Analyzing Switch Interface Status and Statistics,” in Chapter 7, “Configuring and Verifying Switch Interfaces,” works through the details of what causes a switch interface to fail.)|Это может означать, что кабель не установлен, но могут существовать и другие проблемы. (В разделе «Анализ состояния и статистики интерфейса коммутатора» главы 7 «Настройка и проверка интерфейсов коммутатора» подробно рассматриваются причины сбоя интерфейса коммутатора.)
|
NOTE You can see the status for a single interface in a couple of ways.|ПРИМЕЧАНИЕ. Вы можете увидеть состояние отдельного интерфейса двумя способами.
For instance, for F0/1, the command show interfaces f0/1 status lists the status in a single line of output as in Example 5-2.|Например, для F0 / 1 команда show interfaces f0 / 1 status перечисляет состояние в одной строке вывода, как в примере 5-2.
The show interfaces f0/1 command (without the status keyword) displays a detailed set of messages about the interface.|Команда show interfaces f0 / 1 (без ключевого слова status) отображает подробный набор сообщений об интерфейсе.
|
The show interfaces command has a large number of options.|Команда show interfaces имеет большое количество параметров.
One particular option, the counters option, lists statistics about incoming and outgoing frames on the interfaces.|Одна конкретная опция, опция счетчиков, перечисляет статистику о входящих и исходящих кадрах на интерфейсах.
In particular, it lists the number of unicast, multicast, and broadcast frames (both the in and out directions), and a total byte count for those frames.|В частности, он перечисляет количество одноадресных, многоадресных и широковещательных кадров (как входящие, так и исходящие), а также общее количество байтов для этих кадров.
Example 5-3 shows an example, again for interface F0/1.|В примере 5-3 показан пример снова для интерфейса F0 / 1.
|
Example 5-3 Show interfaces f0/1 counters on Switch SW1 Example end.|Пример 5-3 Показать интерфейсы счетчиков f0 / 1 на коммутаторе SW1 Пример конец.
#### Finding Entries in the MAC Address Table
Поиск записей в таблице MAC-адресов   
__|__
--|--
|
With a single switch and only four hosts connected to it, you can just read the details of the MAC address table and find the information you want to see.|С одним коммутатором и подключенными к нему всего четырьмя хостами, вы можете просто прочитать детали таблицы MAC-адресов и найти информацию, которую хотите увидеть.
However, in real networks, with lots of interconnected hosts and switches, just reading the output to find one MAC address can be hard to do.|Однако в реальных сетях с большим количеством взаимосвязанных хостов и коммутаторов просто прочитать выходные данные, чтобы найти один MAC-адрес, может быть сложно.
You might have hundreds of entries—page after page of output—|У вас могут быть сотни записей - страница за страницей вывода -
|
with each MAC address looking like a random string of hex characters. (The book uses easyto-|где каждый MAC-адрес выглядит как случайная строка шестнадцатеричных символов. (В книге используется легкое-
|
recognize MAC addresses to make it easier to learn.)|распознавать MAC-адреса, чтобы облегчить изучение.)
|
Thankfully, Cisco IOS supplies several more options on the show mac address-table command to make it easier to find individual entries.|К счастью, Cisco IOS предоставляет несколько дополнительных опций для команды show mac address-table, чтобы упростить поиск отдельных записей.
First, if you know the MAC address, you can search for it—just type in the MAC address at the end of the command, as shown in Example 5-4.|Во-первых, если вам известен MAC-адрес, вы можете найти его - просто введите MAC-адрес в конце команды, как показано в примере 5-4.
All you have to do is include the address keyword, followed by the actual MAC address.|Все, что вам нужно сделать, это включить ключевое слово адреса, за которым следует фактический MAC-адрес.
If the address exists, the output lists the address.|Если адрес существует, в выходных данных указан адрес.
Note that the output lists the exact same information in the exact same format, but it lists only the line for the matching MAC address.|Обратите внимание, что вывод содержит точно такую ​​же информацию в том же формате, но содержит только строку для совпадающего MAC-адреса.
|
Example 5-4 Show mac address-table dynamic with the address Keyword Example end.|Пример 5-4 Показать динамическую таблицу MAC-адресов с концом примера ключевого слова адреса.
|
While this information is useful, often the engineer troubleshooting a problem does not know the MAC addresses of the devices connected to the network.|Хотя эта информация полезна, часто инженер, решающий проблему, не знает MAC-адреса устройств, подключенных к сети.
Instead, the engineer has a topology diagram, knowing which switch ports connect to other switches and which connect to endpoint devices.|Вместо этого у инженера есть схема топологии, зная, какие порты коммутатора подключаются к другим коммутаторам, а какие - к конечным устройствам.
|
Sometimes you might be troubleshooting while looking at a network topology diagram and want to look at all the MAC addresses learned off a particular port.|Иногда вы можете устранять неполадки, глядя на диаграмму топологии сети и желая просмотреть все MAC-адреса, полученные от определенного порта.
IOS supplies that option with the show mac address-table dynamic interface command.|IOS предоставляет эту опцию с помощью команды динамического интерфейса show mac address-table.
Example 5-5 shows one example, for switch SW1’s F0/1 interface.|В примере 5-5 показан один из примеров интерфейса F0 / 1 переключателя SW1.
|
Example 5-5 Show mac address-table dynamic with the interface Keyword Example end.|Пример 5-5. Показ динамической таблицы MAC-адресов с интерфейсом Keyword Example end.
|
Finally, you may also want to find the MAC address table entries for one VLAN. You guessed it—you can add the vlan parameter, followed by the VLAN number.|Наконец, вы также можете найти записи в таблице MAC-адресов для одной VLAN. Как вы уже догадались - вы можете добавить параметр vlan, а затем номер VLAN.
Example 5-6 shows two such examples from the same switch SW1 from Figure 5-7—one for VLAN 1, where all four devices reside, and one for a nonexistent VLAN 2.|В примере 5-6 показаны два таких примера для одного и того же коммутатора SW1 из рисунка 5-7 - один для VLAN 1, где находятся все четыре устройства, и один для несуществующей VLAN 2.
|
Example 5-6 The show mac address-table vlan Command Example end.|Пример 5-6 Пример команды show mac address-table vlan end.
#### Managing the MAC Address Table (Aging, Clearing)
Управление таблицей MAC-адресов (устаревание, очистка)   
__|__
--|--
|
This chapter closes with a few comments about how switches manage their MAC address tables.|Эта глава завершается несколькими комментариями о том, как коммутаторы управляют своими таблицами MAC-адресов.
Switches do learn MAC addresses, but those MAC addresses do not remain in the table indefinitely.|Коммутаторы изучают MAC-адреса, но эти MAC-адреса не остаются в таблице на неопределенный срок.
The switch will remove the entries due to age, due to the table filling, and you can remove entries using a command.|Переключатель удалит записи из-за возраста, из-за заполнения таблицы, и вы можете удалить записи с помощью команды.
|
First, for aging out MAC table entries, switches remove entries that have not been used for a defined number of seconds (default of 300 seconds on many switches).|Во-первых, для устаревания записей таблицы MAC-адресов коммутаторы удаляют записи, которые не использовались в течение определенного количества секунд (по умолчанию 300 секунд на многих коммутаторах).
To do that, switches look at every incoming frame and every source MAC address, and do something related to learning.|Для этого коммутаторы просматривают каждый входящий кадр и каждый исходный MAC-адрес и делают что-то, связанное с обучением.
If it is a new MAC address, the switch adds the correct entry to the table, of course.|Если это новый MAC-адрес, коммутатор, конечно, добавляет правильную запись в таблицу.
However, if that entry already exists, the switch still does something: it resets the inactivity timer back to 0 for that entry.|Однако, если эта запись уже существует, переключатель все равно что-то делает: он сбрасывает таймер бездействия обратно на 0 для этой записи.
Each entry’s timer counts upward over time to measure how long the entry has been in the table.|Таймер каждой записи ведет отсчет в возрастающем порядке, чтобы измерить, как долго запись находилась в таблице.
The switch times out (removes) any entries whose timer reaches the defined aging time.|Коммутатор отключает (удаляет) все записи, таймер которых достигает заданного времени устаревания.
|
Example 5-7 shows the aging timer setting for the entire switch.|В примере 5-7 показана установка таймера старения для всего коммутатора.
The aging time can be configured to a different time, globally and per-VLAN using the mac address-table aging-time time-in-seconds [vlan vlan-number] global configuration command.|Время устаревания может быть настроено на другое время, глобально и для каждой VLAN, с помощью команды глобальной настройки mac-address-table age-time-time-in-seconds [vlan vlan-number].
The example shows a case with all defaults, with the global setting of 300 seconds, and no per-VLAN overrides.|В примере показан случай со всеми значениями по умолчанию, с глобальным значением 300 секунд и без переопределений для каждой VLAN.
|
Example 5-7 The MAC Address Default Aging Timer Displayed Example end.|Пример 5-7 Отображаемый таймер устаревания MAC-адреса по умолчанию Пример конец.
|
Each switch also removes the oldest table entries, even if they are younger than the aging time setting, if the table fills.|Каждый переключатель также удаляет самые старые записи таблицы, даже если они моложе установленного времени устаревания, если таблица заполняется.
The MAC address table uses content-addressable memory (CAM), a physical memory that has great table lookup capabilities.|Таблица MAC-адресов использует память с адресацией по содержимому (CAM), физическую память, которая имеет отличные возможности поиска в таблице.
However, the size of the table depends on the size of the CAM in a particular model of switch and based on some configurable settings in the switch.|Однако размер таблицы зависит от размера CAM в конкретной модели коммутатора и от некоторых настраиваемых параметров коммутатора.
When a switch tries to add a new MAC table entry and finds the table full, the switch times out (removes) the oldest table entry to make space.|Когда коммутатор пытается добавить новую запись в таблицу MAC-адресов и обнаруживает, что таблица заполнена, коммутатор отключает (удаляет) самую старую запись таблицы, чтобы освободить место.
For perspective, the end of Example 5-7 lists the size of a Cisco Catalyst switch’s MAC table at about 8000 entries—the same four existing entries from the earlier examples, with space for 7299 more.|Для сравнения, в конце примера 5-7 указан размер таблицы MAC-адресов коммутатора Cisco Catalyst примерно в 8000 записей - те же четыре существующие записи из предыдущих примеров, с пространством для дополнительных 7299 записей.
|
Finally, you can remove the dynamic entries from the MAC address table with the clear mac address-table dynamic command.|Наконец, вы можете удалить динамические записи из таблицы MAC-адресов с помощью динамической команды clear mac address-table dynamic.
Note that the show commands in this chapter can be executed from user and enable mode, but the clear command happens to be an enable mode command.|Обратите внимание, что команды show в этой главе могут выполняться из режима пользователя и режима включения, но команда clear оказывается командой режима включения.
The command also allows parameters to limit the types of entries cleared, as follows:|Команда также позволяет параметрам ограничивать типы очищаемых записей следующим образом:
###### By VLAN: clear mac address-table dynamic vlan vlan-number
По VLAN: очистить таблицу MAC-адресов, динамический vlan, номер vlan   
###### By Interface: clear mac address-table dynamic interface interface-id
По интерфейсу: очистить идентификатор интерфейса динамического интерфейса таблицы MAC-адресов   
###### By MAC address: clear mac address-table dynamic address mac-address
По MAC-адресу: очистить таблицу MAC-адресов, динамический MAC-адрес   
#### MAC Address Tables with Multiple Switches
Таблицы MAC-адресов с несколькими коммутаторами   
__|__
--|--
|
Finally, to complete the discussion, it helps to think about an example with multiple switches, just to emphasize how MAC learning, forwarding, and flooding happen independently on each LAN switch.|Наконец, чтобы завершить обсуждение, полезно подумать о примере с несколькими коммутаторами, просто чтобы подчеркнуть, как изучение MAC, пересылка и лавинная рассылка происходят независимо на каждом коммутаторе LAN.
|
Consider the topology in Figure 5-10, and pay close attention to the port numbers.|Рассмотрим топологию на рисунке 5-10 и обратите особое внимание на номера портов.
The ports were purposefully chosen so that neither switch used any of the same ports for this example.|Порты были выбраны специально, чтобы ни один из коммутаторов не использовал одни и те же порты в этом примере.
That is, switch SW2 does have a port F0/1 and F0/2, but I did not plug any devices into those ports when making this example.|То есть у коммутатора SW2 есть порты F0 / 1 и F0 / 2, но я не подключал к этим портам какие-либо устройства при создании этого примера.
Also note that all ports are in VLAN 1, and as with the other examples in this chapter, all default configuration is used other than the hostname on the switches.|Также обратите внимание, что все порты находятся в VLAN 1, и, как и в других примерах в этой главе, на коммутаторах используется вся конфигурация по умолчанию, кроме имени хоста.
|
Figure 5-10 Two-Switch Topology Example Think about a case in which both switches learn all four MAC addresses.|Рисунок 5-10 Пример топологии с двумя коммутаторами Подумайте о случае, когда оба коммутатора узнают все четыре MAC-адреса.
For instance, that would happen if the hosts on the left communicate with the hosts on the right.|Например, это произойдет, если хосты слева будут общаться с хостами справа.
SW1’s MAC address table would list SW1’s own port numbers (F0/1, F0/2, and G0/1) because SW1 uses that information to decide where SW1 should forward frames.|В таблице MAC-адресов SW1 будут перечислены собственные номера портов SW1 (F0 / 1, F0 / 2 и G0 / 1), поскольку SW1 использует эту информацию, чтобы решить, куда SW1 должен пересылать кадры.
Similarly, SW2’s MAC table lists SW2’s port numbers (F0/3, F0/4, G0/2 in this example).|Точно так же в таблице MAC SW2 перечислены номера портов SW2 (F0 / 3, F0 / 4, G0 / 2 в этом примере).
Example 5-8 shows the MAC address tables on both switches for that scenario.|В примере 5-8 показаны таблицы MAC-адресов на обоих коммутаторах для этого сценария.
|
Example 5-8 The MAC Address Table on Two Switches Example end.|Пример 5-8 Таблица MAC-адресов на двух коммутаторах Пример конец.
### Chapter Review
Обзор главы   
__|__
--|--
|
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Table 5-2 outlines the key review elements and where you can find them.|В Таблице 5-2 представлены основные элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 5-2 Chapter Review Tracking Table end.|Таблица 5-2. Конец таблицы отслеживания обзора главы.
|
Review All the Key Topics Do Labs The Sim Lite software is a version of Pearson’s full simulator learning product with a subset of the labs, included free with this book.|Просмотрите все ключевые темы. Выполните лабораторные работы. Программное обеспечение Sim Lite - это версия полного учебного продукта Pearson на симуляторах с подмножеством лабораторных работ, бесплатно включенных в эту книгу.
The subset of labs mostly relate to this part of the book, so take the time to try some of the labs.|Подмножество лабораторных работ в основном относится к этой части книги, поэтому найдите время, чтобы попробовать некоторые из них.
|
As always, also check the author’s blog site pages for configuration exercises (Config Labs)|Как всегда, также проверьте страницы блога автора на предмет упражнений по настройке (Лаборатория конфигурации)
|
at http://blog.certskills.com.|на http://blog.certskills.com.
|
Key Terms You Should Know broadcast frame, known unicast frame, Spanning Tree Protocol (STP), unknown unicast frame, MAC address table, forward, flood Command References Table 5-4 lists the verification commands used in this chapter.|Ключевые термины, которые вы должны знать: широковещательный кадр, известный одноадресный кадр, протокол связующего дерева (STP), неизвестный одноадресный кадр, таблица MAC-адресов, пересылка, лавинная рассылка. Ссылки на команды В таблице 5-4 перечислены команды проверки, используемые в этой главе.
As an easy review exercise, cover the left column, read the right, and try to recall the command without looking.|В качестве простого упражнения на повторение закройте левый столбец, прочтите правый и попытайтесь вспомнить команду, не глядя.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Затем повторите упражнение, охватывая правый столбец, и попытайтесь вспомнить, что делает команда.
|
Table 5-4 Chapter 5 EXEC Command Reference Table end.|Таблица 5-4 Глава 5 Справочник команд EXEC Конец таблицы.
|
Note that this chapter also includes reference to one configuration command, so it does not call for the use of a separate table.|Обратите внимание, что эта глава также включает ссылку на одну команду конфигурации, поэтому она не требует использования отдельной таблицы.
For review, the command is mac address-table aging-time time-in-seconds [vlan vlan-number]|Для обзора, команда - это время-время-время-старение таблицы MAC-адресов в секундах [vlan-номер-vlan]
## Chapter 6 Configuring Basic Switch Management
Глава 6 Настройка базового управления коммутатором   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.6 Configure and verify IPv4 addressing and subnetting
1.6 Настройка и проверка адресации IPv4 и подсетей   
###### 4.0 IP Services
4.0 IP-услуги   
###### 4.6 Configure and verify DHCP client and relay
4.6 Настройка и проверка DHCP-клиента и ретранслятора   
###### 4.8 Configure network devices for remote access using SSH
4.8 Настройка сетевых устройств для удаленного доступа по SSH   
###### 5.0 Security Fundamentals
5.0 Основы безопасности   
###### 5.3 Configure device access control using local passwords
5.3 Настройка контроля доступа к устройствам с использованием локальных паролей   
__|__
--|--
|
The work performed by a networking device can be divided into three broad categories.|Работу, выполняемую сетевым устройством, можно разделить на три большие категории.
The first and most obvious, called the data plane, is the work a switch does to forward frames generated by the devices connected to the switch.|Первая и наиболее очевидная, называемая плоскостью данных, - это работа, выполняемая коммутатором по пересылке кадров, генерируемых устройствами, подключенными к коммутатору.
In other words, the data plane is the main purpose of the switch.|Другими словами, плоскость данных - основное назначение коммутатора.
Second, the control plane refers to the configuration and processes that control and change the choices made by the switch’s data plane.|Во-вторых, плоскость управления относится к конфигурации и процессам, которые контролируют и изменяют выбор, сделанный плоскостью данных коммутатора.
The network engineer can control which interfaces are enabled and disabled, which ports run at which speeds, how Spanning Tree blocks some ports to prevent loops, and so on.|Сетевой инженер может контролировать, какие интерфейсы включены и отключены, какие порты работают с какой скоростью, как Spanning Tree блокирует некоторые порты для предотвращения петель и т. Д.
|
The third category, the management plane, is the topic of this chapter.|Третья категория, уровень управления, является темой данной главы.
The management plane deals with managing the device itself, rather than controlling what the device is doing.|Уровень управления имеет дело с управлением самим устройством, а не с контролем того, что оно делает.
In particular, this chapter looks at the most basic management features that can be configured in a Cisco switch.|В частности, в этой главе рассматриваются самые основные функции управления, которые можно настроить в коммутаторе Cisco.
The first section of the chapter works through the configuration of different kinds of login security.|Первый раздел главы посвящен настройке различных видов безопасности входа.
The second section shows how to configure IPv4 settings on a switch so it can be remotely managed.|Во втором разделе показано, как настроить параметры IPv4 на коммутаторе, чтобы им можно было управлять удаленно.
The last (short) section then explains a few practical matters that can make your life in the lab a little easier.|В последнем (коротком) разделе объясняются несколько практических вопросов, которые могут немного облегчить вашу жизнь в лаборатории.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
CHAPTER 6 Table 6-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|ГЛАВА 6 Таблица 6-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### Securing the Switch CLI
Защита интерфейса командной строки коммутатора   
__|__
--|--
|
Enabling IP for Remote Access 4–5 Miscellaneous Settings Useful in Lab 6 1.|Включение IP для удаленного доступа 4–5 Прочие настройки, полезные в лабораторной работе 6 1.
Imagine that you have configured the enable secret command, followed by the enable password command, from the console.|Представьте, что вы настроили в консоли команду enable secret, за которой следует команда enable password.
You log out of the switch and log back in at the console.|Вы выходите из коммутатора и снова входите в систему с консоли.
Which command defines the password that you had to enter to access privileged mode?|Какая команда определяет пароль, который вам нужно было ввести для доступа к привилегированному режиму?
|
a. enable password b. enable secret c.|а. включить пароль b. включить секрет c.
Neither d.|Ни d.
The password command, if it is configured 2.|Команда пароля, если она настроена 2.
An engineer wants to set up simple password protection with no usernames for some switches in a lab, for the purpose of keeping curious coworkers from logging in to the lab switches from their desktop PCs. Which of the following commands would be a useful part of that configuration?|Инженер хочет установить простую защиту паролем без имен пользователей для некоторых коммутаторов в лаборатории, чтобы не дать любопытным коллегам войти в лабораторные коммутаторы со своих настольных компьютеров. Какая из следующих команд была бы полезной частью этой конфигурации?
|
a. A login vty mode subcommand b.|а. Подкоманда входа в режим VTY b.
A password password console subcommand c.|Подкоманда консоли пароль пароль c.
A login local vty subcommand d.|Подкоманда login local vty d.
A transport input ssh vty subcommand 3.|Подкоманда транспортного ввода ssh vty 3.
An engineer had formerly configured a Cisco 2960 switch to allow Telnet access so that the switch expected a password of mypassword from the Telnet user.|Инженер ранее настроил коммутатор Cisco 2960 для разрешения доступа через Telnet, чтобы коммутатор ожидал ввода пароля mypassword от пользователя Telnet.
The engineer then changed the configuration to support Secure Shell.|Затем инженер изменил конфигурацию для поддержки Secure Shell.
Which of the following commands could have been part of the new configuration? (Choose two answers.)|Какая из следующих команд могла быть частью новой конфигурации? (Выберите два ответа.)
|
a. A username name secret password vty mode subcommand b.|а. Подкоманда vty mode секретного пароля имени пользователя b.
A username name secret password global configuration command c.|Команда глобальной настройки имени пользователя, секретного пароля c.
A login local vty mode subcommand d.|Подкоманда входа в локальный режим VTY d.
A transport input ssh global configuration command 4.|Команда глобальной конфигурации транспортного входа ssh 4.
An engineer’s desktop PC connects to a switch at the main site.|Настольный компьютер инженера подключается к коммутатору на главном объекте.
A router at the main site connects to each branch office through a serial link, with one small router and switch at each branch.|Маршрутизатор на главном сайте подключается к каждому филиалу через последовательный канал с одним небольшим маршрутизатором и коммутатором в каждом филиале.
Which of the following commands must be configured on the branch office switches, in the listed configuration mode, to allow the engineer to telnet to the branch office switches and supply only a password to login? (Choose three answers.)|Какая из следующих команд должна быть настроена на коммутаторах филиала в указанном режиме конфигурации, чтобы позволить инженеру подключаться к коммутаторам филиала по telnet и предоставлять только пароль для входа? (Выберите три ответа.)
|
a. The ip address command in interface configuration mode b.|а. Команда ip address в режиме настройки интерфейса b.
The ip address command in global configuration mode c.|Команда ip address в режиме глобальной конфигурации c.
The ip default-gateway command in VLAN configuration mode d.|Команда ip default-gateway в режиме конфигурации VLAN d.
The ip default-gateway command in global configuration mode e.|Команда ip default-gateway в режиме глобальной конфигурации e.
The password command in console line configuration mode f.|Команда пароля в режиме настройки строки консоли f.
The password command in vty line configuration mode 5.|Команда пароля в режиме конфигурации vty line 5.
A Layer 2 switch configuration places all its physical ports into VLAN 2.|Конфигурация коммутатора уровня 2 помещает все свои физические порты в сеть VLAN 2.
The IP addressing plan shows that address 172.16.2.250 (with mask 255.255.255.0) is reserved for use by this new LAN switch and that 172.16.2.254 is already configured on the router connected to that same VLAN. The switch needs to support SSH connections into the switch from any subnet in the network.|План IP-адресации показывает, что адрес 172.16.2.250 (с маской 255.255.255.0) зарезервирован для использования этим новым коммутатором LAN и что 172.16.2.254 уже настроен на маршрутизаторе, подключенном к той же VLAN. Коммутатор должен поддерживать SSH-подключения к коммутатору из любой подсети в сети.
Which of the following commands are part of the required configuration in this case? (Choose two answers.)|Какие из следующих команд являются частью необходимой конфигурации в этом случае? (Выберите два ответа.)
|
a. The ip address 172.16.2.250 255.255.255.0 command in interface vlan 1 configuration mode.|а. Команда ip address 172.16.2.250 255.255.255.0 в режиме настройки интерфейса vlan 1.
|
b. The ip address 172.16.2.250 255.255.255.0 command in interface vlan 2 configuration mode.|б. Команда ip address 172.16.2.250 255.255.255.0 в режиме настройки интерфейса vlan 2.
|
c. The ip default-gateway 172.16.2.254 command in global configuration mode.|c. Команда ip default-gateway 172.16.2.254 в режиме глобальной конфигурации.
|
d. The switch cannot support SSH because all its ports connect to VLAN 2, and the IP address must be configured on interface VLAN 1.|d. Коммутатор не может поддерживать SSH, потому что все его порты подключаются к VLAN 2, а IP-адрес должен быть настроен на интерфейсе VLAN 1.
|
6. Which of the following line subcommands tells a switch to wait until a show command’s output has completed before displaying log messages on the screen?|6. Какая из следующих подкоманд в строке указывает коммутатору дождаться завершения вывода команды show перед отображением сообщений журнала на экране?
|
a. logging synchronous b. no ip domain-lookup c. exec-timeout 0 0 d. history size 15 Foundation Topics Securing the Switch CLI By default, a Cisco Catalyst switch allows anyone to connect to the console port, access user mode, and then move on to enable and configuration modes without any kind of security.|а. регистрация синхронная b. нет IP-поиска домена c. exec-timeout 0 0 d. размер истории 15 Основные темы Защита интерфейса командной строки коммутатора По умолчанию коммутатор Cisco Catalyst позволяет любому подключиться к консольному порту, получить доступ к пользовательскому режиму, а затем перейти к включению и настройке режимов без какой-либо защиты.
|
That default makes sense, given that if you can get to the console port of the switch, you already have control over the switch physically.|Это значение по умолчанию имеет смысл, учитывая, что если вы можете получить доступ к консольному порту коммутатора, у вас уже есть физический контроль над коммутатором.
However, everyone needs to operate switches remotely, and the first step in that process is to secure the switch so that only the appropriate users can access the switch command-line interface (CLI).|Однако всем необходимо управлять коммутаторами удаленно, и первым шагом в этом процессе является защита коммутатора, чтобы только соответствующие пользователи могли получить доступ к интерфейсу командной строки коммутатора (CLI).
|
This first topic in the chapter examines how to configure login security for a Cisco Catalyst switch.|В этом первом разделе главы рассматривается, как настроить безопасность входа в систему для коммутатора Cisco Catalyst.
Securing the CLI includes protecting access to enable mode, because from enable mode, an attacker could reload the switch or change the configuration.|Защита интерфейса командной строки включает в себя защиту доступа в активный режим, поскольку из этого режима злоумышленник может перезагрузить коммутатор или изменить конфигурацию.
Protecting user mode is also important, because attackers can see the status of the switch, learn about the network, and find new ways to attack the network.|Защита пользовательского режима также важна, потому что злоумышленники могут видеть состояние коммутатора, узнавать о сети и находить новые способы атаки на сеть.
|
Note that all remote access and management protocols require that the switch IP configuration be completed and working.|Обратите внимание, что все протоколы удаленного доступа и управления требуют, чтобы IP-конфигурация коммутатора была завершена и работала.
A switch’s IPv4 configuration has nothing to do with how a Layer 2 switch forwards Ethernet frames (as discussed in Chapter 5, “Analyzing Ethernet LAN Switching”).|Конфигурация IPv4 коммутатора не имеет ничего общего с тем, как коммутатор уровня 2 пересылает кадры Ethernet (как описано в главе 5 «Анализ коммутации Ethernet LAN»).
Instead, to support Telnet and Secure Shell (SSH) into a switch, the switch needs to be configured with an IP address.|Вместо этого для поддержки Telnet и Secure Shell (SSH) в коммутаторе необходимо настроить коммутатор с IP-адресом.
This chapter also shows how to configure a switch’s IPv4 settings in the upcoming section “Enabling IPv4 for Remote Access.”|В этой главе также показано, как настроить параметры IPv4 коммутатора в следующем разделе «Включение IPv4 для удаленного доступа».
|
In particular, this section covers the following login security topics:|В частности, в этом разделе рассматриваются следующие темы безопасности входа в систему:
###### Securing user mode and privileged mode with simple passwords
Защита пользовательского режима и привилегированного режима с помощью простых паролей   
###### Securing user mode access with local usernames
Обеспечение доступа в пользовательском режиме с помощью локальных имен пользователей   
###### Securing user mode access with external authentication servers
Обеспечение доступа в пользовательском режиме с помощью внешних серверов аутентификации   
###### Securing remote access with Secure Shell (SSH)
Обеспечение удаленного доступа с помощью Secure Shell (SSH)   
#### Securing User Mode and Privileged Mode with Simple Passwords
Защита пользовательского режима и привилегированного режима с помощью простых паролей   
__|__
--|--
|
By default, Cisco Catalyst switches allow full access from the console but no access via Telnet or SSH. Using default settings, a console user can move into user mode and then privileged mode with no passwords required; however, default settings prevent remote users from accessing even user mode.|По умолчанию коммутаторы Cisco Catalyst разрешают полный доступ с консоли, но не разрешают доступ через Telnet или SSH. Используя настройки по умолчанию, пользователь консоли может перейти в пользовательский режим, а затем в привилегированный режим без необходимости ввода пароля; однако настройки по умолчанию не позволяют удаленным пользователям получить доступ даже к пользовательскому режиму.
|
The defaults work great for a brand new switch, but in production, you will want to secure access through the console as well as enable remote login via Telnet and/or SSH so you can sit at your desk and log in to all the switches in the LAN. Keep in mind, however, that you should not open the switch for just anyone to log in and change the configuration, so some type of secure login should be used.|Значения по умолчанию отлично подходят для нового коммутатора, но на производстве вам потребуется обеспечить безопасный доступ через консоль, а также включить удаленный вход через Telnet и / или SSH, чтобы вы могли сидеть за своим столом и входить на все коммутаторы. ЛВС. Однако имейте в виду, что вы не должны открывать переключатель, чтобы кто-либо мог войти в систему и изменить конфигурацию, поэтому следует использовать какой-либо тип безопасного входа.
|
Most people use a simple shared password for access to lab gear.|Большинство людей используют простой общий пароль для доступа к лабораторному оборудованию.
This method uses a password only—with no username—with one password for console users and a different password for Telnet users.|В этом методе используется только пароль - без имени пользователя - с одним паролем для пользователей консоли и другим паролем для пользователей Telnet.
Console users must supply the console password, as configured in console line configuration mode.|Пользователи консоли должны указать пароль консоли, настроенный в режиме конфигурации строки консоли.
Telnet users must supply the Telnet password, also called the vty password, so called because the configuration sits in vty line configuration mode.|Пользователи Telnet должны предоставить пароль Telnet, также называемый паролем vty, так называемый, потому что конфигурация находится в режиме конфигурации линии vty.
|
Figure 6-1 summarizes these options for using shared passwords from the perspective of the user logging in to the switch.|На рис. 6-1 показаны эти варианты использования общих паролей с точки зрения входа пользователя в коммутатор.
|
Figure 6-1 Simple Password Security Concepts NOTE This section refers to several passwords as shared passwords.|Рисунок 6-1 Простые концепции защиты паролей ПРИМЕЧАНИЕ В этом разделе несколько паролей называются общими паролями.
Users share these passwords in that all users must know and use that same password.|Пользователи разделяют эти пароли, поскольку все пользователи должны знать и использовать один и тот же пароль.
In other words, each user does not have a unique username/password to use, but rather, all the appropriate staff knows and uses the same password.|Другими словами, у каждого пользователя нет уникального имени пользователя / пароля для использования, скорее, весь соответствующий персонал знает и использует один и тот же пароль.
|
In addition, Cisco switches protect enable mode (also called privileged mode) with yet another shared password called the enable password.|Кроме того, коммутаторы Cisco защищают режим включения (также называемый привилегированным режимом) еще одним общим паролем, который называется паролем включения.
From the perspective of the network engineer connecting to the CLI of the switch, once in user mode, the user types the enable EXEC command.|С точки зрения сетевого инженера, подключающегося к интерфейсу командной строки коммутатора, в пользовательском режиме пользователь вводит команду enable EXEC.
|
This command prompts the user for this enable password; if the user types the correct password, IOS moves the user to enable mode.|Эта команда запрашивает у пользователя этот пароль включения; если пользователь вводит правильный пароль, IOS переводит пользователя в режим включения.
|
Example 6-1 shows an example of the user experience of logging in to a switch from the console when the shared console password and the shared enable password have both been set.|В примере 6-1 показан пример пользовательского опыта входа в систему на коммутаторе с консоли, когда были установлены как пароль общей консоли, так и общий пароль включения.
Note that before this example began, the user started the terminal emulator, physically connected a laptop to the console cable, and then pressed the Return key to make the switch respond as shown at the top of the example.|Обратите внимание, что до того, как этот пример начался, пользователь запустил эмулятор терминала, физически подключил портативный компьютер к консольному кабелю, а затем нажал клавишу Return, чтобы переключатель сработал, как показано в верхней части примера.
|
Example 6-1 Console Login and Movement to Enable Mode Example end.|Пример 6-1. Вход в консоль и переход в режим включения. Пример конец.
|
Note that the example shows the password text as if typed (faith and love), along with the enable command that moves the user from user mode to enable mode.|Обратите внимание, что в примере показан текст пароля, как если бы он был введен (вера и любовь), вместе с командой enable, которая переводит пользователя из режима пользователя в режим включения.
In reality, the switch hides the passwords when typed, to prevent someone from reading over your shoulder to see the passwords.|На самом деле переключатель скрывает пароли при вводе, чтобы никто не прочитал через ваше плечо, чтобы увидеть пароли.
|
To configure the shared passwords for the console, Telnet, and for enable mode, you need to configure several commands.|Чтобы настроить общие пароли для консоли, Telnet и для режима включения, вам необходимо настроить несколько команд.
However, the parameters of the commands can be pretty intuitive.|Однако параметры команд могут быть довольно интуитивно понятными.
|
Figure 6-2 shows the configuration of all three of these passwords.|На рис. 6-2 показана конфигурация всех трех паролей.
|
The configuration for these three passwords does not require a lot of work.|Настройка этих трех паролей не требует много работы.
First, the console and vty password configuration sets the password based on the context: console mode for the console (line con 0), and vty line configuration mode for the Telnet password (line vty 0 15).|Во-первых, конфигурация консоли и пароля vty устанавливает пароль на основе контекста: режим консоли для консоли (строка con 0) и режим конфигурации строки vty для пароля Telnet (строка vty 0 15).
|
Figure 6-2 Simple Password Security Configuration The configured enable password, shown on the right side of the figure, applies to all users, no matter whether they connect to user mode via the console, Telnet, or otherwise.|Рис. 6-2 Конфигурация безопасности с простым паролем. Сконфигурированный пароль включения, показанный в правой части рисунка, применяется ко всем пользователям, независимо от того, подключаются ли они к пользовательскому режиму через консоль, Telnet или иначе.
The command to configure the enable password is a global configuration command: enable secret password-value.|Команда для настройки пароля включения является командой глобальной конфигурации: enable secret password-value.
|
NOTE Older IOS versions used the command enable password password-value to set the enable password, and that command still exists in IOS. However, the enable secret command is much more secure.|ПРИМЕЧАНИЕ. В более ранних версиях IOS для установки пароля включения использовалась команда enable password password-value, и эта команда все еще существует в IOS. Однако команда enable secret намного безопаснее.
In real networks, use enable secret.|В реальных сетях используйте enable secret.
Chapter 5, “Securing Network security levels of various password mechanisms, including a comparison of the enable secret and enable password commands.|Глава 5, «Обеспечение уровней безопасности сети различных механизмов паролей, включая сравнение команд enable secret и enable password.
|
To help you follow the process, and for easier study later, use the configuration checklist before the example.|Чтобы помочь вам следить за процессом и облегчить дальнейшее изучение, используйте контрольный список конфигурации перед примером.
The configuration checklist collects the required and optional steps to configure a feature as described in this book.|В контрольном списке конфигурации собраны необходимые и дополнительные шаги для настройки функции, как описано в этой книге.
The configuration checklist for shared passwords for the console, Telnet, and enable passwords is Step 1.|Контрольный список конфигурации для общих паролей для консоли, Telnet и паролей включения - это Шаг 1.
Configure the enable password with the enable secret password-value command.|Настройте пароль включения с помощью команды enable secret password-value.
|
Step 2.|Шаг 2.
Configure the console password:|Настройте пароль консоли:
|
A. Use the line con 0 command to enter console configuration mode.|A. Используйте команду line con 0 для входа в режим настройки консоли.
|
B. Use the password password-value subcommand to set the value of the console password.|B. Используйте подкоманду password password-value, чтобы установить значение пароля консоли.
|
C. Use the login subcommand to enable console password security using a simple password.|C. Используйте подкоманду login, чтобы включить защиту паролем консоли с помощью простого пароля.
|
Config Checklist Step 3.|Контрольный список конфигурации Шаг 3.
Configure the Telnet (vty) password:|Настройте пароль Telnet (vty):
|
A. Use the line vty 0 15 command to enter vty configuration mode for all 16 vty lines (numbered 0 through 15).|A. Используйте команду line vty 0 15, чтобы войти в режим конфигурации VTY для всех 16 линий VTY (пронумерованных от 0 до 15).
|
B. Use the password password-value subcommand to set the value of the console password.|B. Используйте подкоманду password password-value, чтобы установить значение пароля консоли.
|
C. Use the login subcommand to enable console password security using a simple password.|C. Используйте подкоманду login, чтобы включить защиту паролем консоли с помощью простого пароля.
|
Example 6-2 shows the configuration process as noted in the configuration checklist, along with setting the enable secret password.|В примере 6-2 показан процесс настройки, указанный в контрольном списке конфигурации, а также установка секретного пароля включения.
Note that the lines which begin with a ! are comment lines; they are there to guide you through the configuration.|Обратите внимание, что строки, начинающиеся с символа! строки комментариев; они помогут вам в настройке.
|
Example 6-2 Configuring Basic Passwords Example end.|Пример 6-2 Настройка основных паролей Пример конец.
|
Example 6-3 shows the resulting configuration in the switch per the show running-config command.|В примере 6-3 показана результирующая конфигурация коммутатора для команды show running-config.
The gray lines highlight the new configuration.|Серые линии выделяют новую конфигурацию.
Note that many unrelated lines of output have been deleted from the output to keep focused on the password configuration.|Обратите внимание, что многие несвязанные строки вывода были удалены из вывода, чтобы сосредоточиться на конфигурации пароля.
|
Example 6-3 Resulting Running-Config File (Subset) Per Example 6-2 Configuration Example end.|Пример 6-3 Полученный файл рабочей конфигурации (подмножество) Согласно примеру 6-2 Пример конфигурации конец.
|
NOTE For historical reasons, the output of the show running-config command, in the last six lines of Example 6-3, separates the first five vty lines (0 through 4) from the rest (5 through 15).|ПРИМЕЧАНИЕ. По историческим причинам выходные данные команды show running-config в последних шести строках примера 6-3 отделяют первые пять строк vty (с 0 по 4) от остальных (с 5 по 15).
#### Securing User Mode Access with Local Usernames and Passwords
Защита доступа в режиме пользователя с помощью локальных имен пользователей и паролей   
__|__
--|--
|
Cisco switches support two other login security methods that both use per-user username/|Коммутаторы Cisco поддерживают два других метода безопасности входа в систему, которые используют для каждого пользователя имя пользователя /
|
password pairs instead of a shared password with no username.|пары паролей вместо общего пароля без имени пользователя.
One method, referred to as local usernames and passwords, configures the username/password pairs locally—that is, in the switch’s configuration.|Один метод, называемый локальными именами пользователей и паролями, настраивает пары имя пользователя / пароль локально, то есть в конфигурации коммутатора.
Switches support this local username/password option for the console, for Telnet, and even for SSH, but do not replace the enable password used to reach enable mode.|Коммутаторы поддерживают этот параметр локального имени пользователя и пароля для консоли, для Telnet и даже для SSH, но не заменяют пароль включения, используемый для перехода в режим включения.
|
The configuration to migrate from using the simple shared passwords to instead using local usernames/passwords requires only some small configuration changes, as shown in Figure 6-3.|Конфигурация для перехода от использования простых общих паролей к использованию локальных имен пользователей / паролей требует лишь некоторых небольших изменений конфигурации, как показано на рисунке 6-3.
|
Figure 6-3 Configuring Switches to Use Local Username Login Authentication Working through the configuration in the figure, first, the switch of course needs to know the list of username/password pairs.|Рис. 6-3 Настройка коммутаторов для использования аутентификации при входе в систему с локальным именем пользователя Работая с конфигурацией, показанной на рисунке, сначала коммутатор, конечно, должен знать список пар имя пользователя / пароль.
To create these, repeatedly use the username name secret password global configuration command.|Для их создания несколько раз используйте команду глобальной конфигурации username name secret password.
Then, to enable this different type of console or Telnet security, simply enable this login security method with the login local line.|Затем, чтобы включить этот другой тип консоли или безопасности Telnet, просто включите этот метод безопасности входа в систему с помощью локальной линии входа.
|
Basically, this command means “use the local list of usernames for login.” You can also use the no password command (without even typing in the password) to clean up any remaining password subcommands from console or vty mode because these commands are not needed when using local usernames and passwords.|По сути, эта команда означает «использовать локальный список имен пользователей для входа». Вы также можете использовать команду no password (даже не вводя пароль) для очистки любых оставшихся подкоманд пароля из режима консоли или vty, поскольку эти команды не нужны при использовании локальных имен пользователей и паролей.
|
The following checklist details the commands to configure local username login, mainly as a method for easier study and review:|В следующем контрольном списке подробно описаны команды для настройки входа в систему с локальным именем пользователя, в основном как метод для облегчения изучения и проверки:
|
Step 1.|Шаг 1.
Use the username name secret password global configuration command to add one or more username/password pairs on the local switch.|Используйте команду глобальной конфигурации username name secret password, чтобы добавить одну или несколько пар имя пользователя / пароль на локальном коммутаторе.
|
Step 2.|Шаг 2.
Configure the console to use locally configured username/password pairs:|Настройте консоль для использования локально настроенных пар имени пользователя и пароля:
|
A. Use the line con 0 command to enter console configuration mode.|A. Используйте команду line con 0 для входа в режим настройки консоли.
|
B. Use the login local subcommand to enable the console to prompt for both username and password, checked versus the list of local usernames/passwords.|B. Используйте подкоманду login local, чтобы консоль запрашивала как имя пользователя, так и пароль, проверенные по сравнению со списком локальных имен пользователей / паролей.
|
C. (Optional) Use the no password subcommand to remove any existing simple shared passwords, just for good housekeeping of the configuration file.|C. (Необязательно) Используйте подкоманду no password, чтобы удалить все существующие простые общие пароли, просто для хорошего обслуживания файла конфигурации.
|
Step 3.|Шаг 3.
Configure Telnet (vty) to use locally configured username/password pairs.|Настройте Telnet (vty) для использования локально настроенных пар имя пользователя / пароль.
|
A. Use the line vty 0 15 command to enter vty configuration mode for all 16 vty lines (numbered 0 through 15).|A. Используйте команду line vty 0 15, чтобы войти в режим конфигурации VTY для всех 16 линий VTY (пронумерованных от 0 до 15).
|
B. Use the login local subcommand to enable the switch to prompt for both username and password for all inbound Telnet users, checked versus the list of local usernames/passwords.|B. Используйте подкоманду login local, чтобы коммутатор запрашивал имя пользователя и пароль для всех входящих пользователей Telnet, проверенных по сравнению со списком локальных имен пользователей / паролей.
|
C. (Optional) Use the no password subcommand to remove any existing simple shared passwords, just for good housekeeping of the configuration file.|C. (Необязательно) Используйте подкоманду no password, чтобы удалить все существующие простые общие пароли, просто для хорошего обслуживания файла конфигурации.
|
Config Checklist When a Telnet user connects to the switch configured as shown in Figure 6-3, the user will be prompted first for a username and then for a password, as shown in Example 6-4.|Контрольный список конфигурации Когда пользователь Telnet подключается к коммутатору, настроенному, как показано на рисунке 6-3, пользователю сначала будет предложено ввести имя пользователя, а затем пароль, как показано в примере 6-4.
The username/password pair must be from the list of local usernames; otherwise, the login is rejected.|Пара имя пользователя / пароль должна быть из списка локальных имен пользователей; в противном случае вход в систему отклоняется.
|
Example 6-4 Telnet Login Process After Applying Configuration in Figure 6-3 Example end.|Пример 6-4. Процесс входа в Telnet после применения конфигурации, показанной на рисунке 6-3. Конец примера.
|
NOTE Example 6-4 does not show the password value as having been typed because Cisco switches do not display the typed password for security reasons.|ПРИМЕЧАНИЕ. Пример 6-4 не показывает значение пароля как введенное, поскольку коммутаторы Cisco не отображают введенный пароль по соображениям безопасности.
#### Securing User Mode Access with External Authentication Servers
Защита доступа в режиме пользователя с помощью внешних серверов аутентификации   
__|__
--|--
|
The end of Example 6-4 points out one of the many security improvements when requiring each user to log in with their own username.|В конце примера 6-4 указано на одно из многих улучшений безопасности, когда от каждого пользователя требуется входить под своим именем.
The end of the example shows the user entering configuration mode (configure terminal) and then immediately leaving (end).|В конце примера показано, как пользователь входит в режим конфигурации (терминал настройки), а затем немедленно выходит (конец).
Note that when a user exits configuration mode, the switch generates a log message.|Обратите внимание, что когда пользователь выходит из режима конфигурации, коммутатор генерирует сообщение журнала.
If the user logged in with a username, the log message identifies that username; note the “wendell” in the log message.|Если пользователь вошел в систему с именем пользователя, сообщение журнала идентифицирует это имя пользователя; обратите внимание на «wendell» в сообщении журнала.
|
However, using a username/password configured directly on the switch causes some administrative headaches.|Однако использование имени пользователя и пароля, настроенного непосредственно на коммутаторе, вызывает некоторые административные проблемы.
For instance, every switch and router needs the configuration for all users who might need to log in to the devices.|Например, каждому коммутатору и маршрутизатору требуется конфигурация для всех пользователей, которым может потребоваться вход на устройства.
Then, when any changes need to happen, like an occasional change to the passwords for good security practices, the configuration of all devices must be changed.|Затем, когда должны произойти какие-либо изменения, например, случайное изменение паролей для надлежащей практики безопасности, необходимо изменить конфигурацию всех устройств.
|
A better option would be to use tools like those used for many other IT login functions.|Лучшим вариантом было бы использовать инструменты, подобные тем, которые используются для многих других функций входа в систему.
|
Those tools allow for a central place to securely store all username/password pairs, with tools to make users change their passwords regularly, tools to revoke users when they leave their current jobs, and so on.|Эти инструменты представляют собой централизованное место для безопасного хранения всех пар имени пользователя и пароля, с инструментами, позволяющими пользователям регулярно менять свои пароли, инструментами для отзыва пользователей, когда они покидают свою текущую работу, и так далее.
|
Cisco switches allow exactly that option using an external server called an authentication, authorization, and accounting (AAA) server.|Коммутаторы Cisco позволяют использовать именно этот вариант с использованием внешнего сервера, называемого сервером аутентификации, авторизации и учета (AAA).
These servers hold the usernames/passwords.|На этих серверах хранятся имена пользователей / пароли.
|
Typically, these servers allow users to do self-service and forced maintenance to their passwords.|Обычно эти серверы позволяют пользователям выполнять самообслуживание и принудительное обслуживание своих паролей.
|
Many production networks use AAA servers for their switches and routers today.|Сегодня многие производственные сети используют серверы AAA для своих коммутаторов и маршрутизаторов.
|
The underlying login process requires some additional work on the part of the switch for each user login, but once set up, the username/password administration is much less.|Базовый процесс входа в систему требует некоторой дополнительной работы со стороны коммутатора для каждого входа пользователя в систему, но после настройки администрирование имени пользователя / пароля намного меньше.
When using a AAA server for authentication, the switch (or router) simply sends a message to the AAA server asking whether the username and password are allowed, and the AAA server replies.|При использовании сервера AAA для аутентификации коммутатор (или маршрутизатор) просто отправляет сообщение серверу AAA, спрашивая, разрешены ли имя пользователя и пароль, и сервер AAA отвечает.
Figure 6-4 shows an example, with the user first supplying a username/password, the switch asking the AAA server, and the server replying to the switch stating that the username/|На рис. 6-4 показан пример, в котором пользователь сначала вводит имя пользователя / пароль, коммутатор запрашивает сервер AAA, а сервер отвечает коммутатору, заявляя, что имя пользователя /
|
password is valid.|пароль действителен.
|
Figure 6-4 Basic Authentication Process with an External AAA Server While the figure shows the general idea, note that the information flows with a couple of different protocols.|Рис. 6-4. Базовый процесс аутентификации с внешним сервером AAA Хотя на рисунке показана общая идея, обратите внимание, что информация передается по нескольким различным протоколам.
On the left, the connection between the user and the switch or router uses Telnet or SSH. On the right, the switch and AAA server typically use either the RADIUS or TACACS+ protocol, both of which encrypt the passwords as they traverse the network.|Слева соединение между пользователем и коммутатором или маршрутизатором использует Telnet или SSH. Справа коммутатор и сервер AAA обычно используют протокол RADIUS или TACACS +, оба из которых шифруют пароли при прохождении через сеть.
#### Securing Remote Access with Secure Shell
Защита удаленного доступа с помощью Secure Shell   
__|__
--|--
|
So far, this chapter has focused on the console and on Telnet, mostly ignoring SSH. Telnet has one serious disadvantage: all data in the Telnet session flows as clear text, including the password exchanges.|До сих пор в этой главе основное внимание уделялось консоли и Telnet, в основном игнорируя SSH. У Telnet есть один серьезный недостаток: все данные в сеансе Telnet передаются в виде открытого текста, включая обмен паролями.
So, anyone that can capture the messages between the user and the switch (in what is called a man-in-the-middle attack) can see the passwords.|Таким образом, любой, кто может перехватывать сообщения между пользователем и коммутатором (в так называемой атаке «человек посередине»), может видеть пароли.
SSH encrypts all data transmitted between the SSH client and server, protecting the data and passwords.|SSH шифрует все данные, передаваемые между SSH-клиентом и сервером, защищая данные и пароли.
|
SSH can use the same local login authentication method as Telnet, with the locally configured username and password. (SSH cannot rely on authentication methods that do not include a username, like shared passwords.) So, the configuration to support local usernames for Telnet, as shown previously in Figure 6-3, also enables local username authentication for incoming SSH connections.|SSH может использовать тот же метод локальной аутентификации при входе, что и Telnet, с локально настроенными именем пользователя и паролем. (SSH не может полагаться на методы аутентификации, которые не включают имя пользователя, например общие пароли.) Таким образом, конфигурация для поддержки локальных имен пользователей для Telnet, как показано ранее на рис. 6-3, также включает аутентификацию локального имени пользователя для входящих SSH-соединений.
|
Figure 6-5 shows one example configuration of what is required to support SSH. The figure repeats the local username configuration as shown earlier in Figure 6-3, as used for Telnet.|На рис. 6-5 показан один пример конфигурации того, что требуется для поддержки SSH. На рисунке повторяется конфигурация локального имени пользователя, показанная ранее на рисунке 6-3, использованная для Telnet.
|
Figure 6-5 shows three additional commands required to complete the configuration of SSH on the switch.|На рис. 6-5 показаны три дополнительные команды, необходимые для завершения настройки SSH на коммутаторе.
|
Figure 6-5 Adding SSH Configuration to Local Username Configuration IOS uses the three SSH-specific configuration commands in the figure to create the SSH encryption keys.|Рис. 6-5. Добавление конфигурации SSH к конфигурации локального имени пользователя IOS использует три команды конфигурации, специфичные для SSH, показанные на рисунке, для создания ключей шифрования SSH.
The SSH server uses the fully qualified domain name (FQDN) of the switch as input to create that key.|Сервер SSH использует полное доменное имя (FQDN) коммутатора в качестве входных данных для создания этого ключа.
The switch creates the FQDN from the hostname and domain name of the switch.|Коммутатор создает полное доменное имя из имени хоста и имени домена коммутатора.
Figure 6-5 begins by setting both values (just in case they are not already configured).|Рисунок 6-5 начинается с установки обоих значений (на случай, если они еще не настроены).
Then the third command, the crypto key generate rsa command, generates the SSH encryption keys.|Затем третья команда, команда crypto key generate rsa, генерирует ключи шифрования SSH.
|
The configuration in Figure 6-5 relies on two default settings that the figure therefore conveniently ignored.|Конфигурация на Рисунке 6-5 основана на двух настройках по умолчанию, которые поэтому удобно игнорировать.
IOS runs an SSH server by default.|IOS по умолчанию запускает SSH-сервер.
In addition, IOS allows SSH connections into the vty lines by default.|Кроме того, IOS по умолчанию разрешает SSH-подключения к линиям VTY.
|
Seeing the configuration happen in configuration mode, step by step, can be particularly helpful with SSH configuration.|Наблюдение за тем, как настройка происходит в режиме настройки, шаг за шагом, может быть особенно полезно при настройке SSH.
Note in particular that in this example, the crypto key command prompts the user for the key modulus; you could also add the parameters modulus modulus-value to the end of the crypto key command to add this setting on the command.|В частности, обратите внимание, что в этом примере команда криптографического ключа запрашивает у пользователя модуль ключа; вы также можете добавить параметры модуля значение модуля в конец команды криптографического ключа, чтобы добавить этот параметр в команду.
|
Example 6-5 shows the commands in Figure 6-5 being configured, with the encryption key as the final step.|В примере 6-5 показаны настраиваемые команды на рис. 6-5 с ключом шифрования в качестве последнего шага.
|
Example 6-5 SSH Configuration Process to Match Figure 6-5 Example end.|Пример 6-5. Процесс настройки SSH в соответствии с рисунком 6-5. Конец примера.
|
Earlier, I mentioned that one useful default was that the switch defaults to support both SSH and Telnet on the vty lines.|Ранее я упоминал, что одним полезным значением по умолчанию было то, что по умолчанию коммутатор поддерживает как SSH, так и Telnet на линиях VTY.
However, because Telnet is a security risk, you could disable Telnet to enforce a tighter security policy. (For that matter, you can disable SSH support and allow Telnet on the vty lines as well.)|Однако, поскольку Telnet представляет собой угрозу безопасности, вы можете отключить Telnet, чтобы обеспечить более жесткую политику безопасности. (В этом отношении вы можете отключить поддержку SSH и разрешить Telnet на линиях VTY.)
|
To control which protocols a switch supports on its vty lines, use the transport input {all ||Чтобы контролировать, какие протоколы поддерживает коммутатор на своих линиях VTY, используйте транспортный вход {all |
|
none | telnet | ssh} vty subcommand in vty mode, with the following options:|нет | телнет | ssh} подкоманда vty в режиме vty со следующими параметрами:
|
transport input all or transport input telnet ssh: Support both Telnet and SSH transport input none: Support neither transport input telnet: Support only Telnet transport input ssh: Support only SSH To complete this section about SSH, the following configuration checklist details the steps for one method to configure a Cisco switch to support SSH using local usernames. (SSH support in IOS can be configured in several ways; this checklist shows one simple way to configure it.) The process shown here ends with a comment to configure local username support on vty lines, as was discussed earlier in the section titled “Securing User Mode Access with Local Usernames and Passwords.”|транспортный ввод все или транспортный ввод telnet ssh: Поддерживает как Telnet, так и SSH транспортный ввод нет: Не поддерживает ни один транспортный ввод telnet: Поддерживает только транспортный ввод Telnet ssh: Поддерживает только SSH Чтобы заполнить этот раздел о SSH, в следующем контрольном списке конфигурации подробно описаны шаги для одного метод настройки коммутатора Cisco для поддержки SSH с использованием локальных имен пользователей. (Поддержка SSH в IOS может быть настроена несколькими способами; в этом контрольном списке показан один простой способ ее настройки.) Показанный здесь процесс заканчивается комментарием для настройки поддержки локального имени пользователя в строках vty, как обсуждалось ранее в разделе под названием «Защита Доступ в пользовательском режиме с локальными именами пользователей и паролями ».
|
Step 1.|Шаг 1.
Configure the switch to generate a matched public and private key pair to use for encryption:|Настройте коммутатор для создания согласованной пары открытого и закрытого ключей для использования для шифрования:
|
A. If not already configured, use the hostname name in global configuration mode to configure a hostname for this switch.|A. Если еще не настроен, используйте имя хоста в режиме глобальной конфигурации, чтобы настроить имя хоста для этого коммутатора.
|
Config Checklist B.|Контрольный список конфигурации B.
If not already configured, use the ip domain-name name in global configuration mode to configure a domain name for the switch, completing the switch’s FQDN.|Если это еще не было настроено, используйте имя домена ip в режиме глобальной конфигурации, чтобы настроить имя домена для коммутатора, заполнив его полное доменное имя.
|
C. Use the crypto key generate rsa command in global configuration mode (or the crypto key generate rsa modulus modulus-value command to avoid being prompted for the key modulus) to generate the keys. (Use at least a 768-bit key to support SSH version 2.)|C. Используйте команду crypto key generate rsa в режиме глобальной конфигурации (или команду crypto key generate rsa modulus-value, чтобы не запрашивать модуль ключа) для генерации ключей. (Используйте как минимум 768-битный ключ для поддержки SSH версии 2.)
|
Step 2. (Optional) Use the ip ssh version 2 command in global configuration mode to override the default of supporting both versions 1 and 2, so that only SSHv2 connections are allowed.|Шаг 2. (Необязательно) Используйте команду ip ssh version 2 в режиме глобальной конфигурации, чтобы изменить значение по умолчанию, поддерживающее обе версии 1 и 2, чтобы были разрешены только соединения SSHv2.
|
Step 3. (Optional) If not already configured with the setting you want, configure the vty lines to accept SSH and whether to also allow Telnet:|Шаг 3. (Необязательно) Если желаемый параметр еще не настроен, настройте линии VTY для приема SSH и разрешения Telnet:
|
A. Use the transport input ssh command in vty line configuration mode to allow SSH only.|A. Используйте команду transport input ssh в режиме конфигурации VTY, чтобы разрешить только SSH.
|
B. Use the transport input all command (default) or transport input telnet ssh command in vty line configuration mode to allow both SSH and Telnet.|B. Используйте команду transport input all (по умолчанию) или команду transport input telnet ssh в режиме конфигурации линии vty, чтобы разрешить использование SSH и Telnet.
|
Step 4.|Шаг 4.
Use various commands in vty line configuration mode to configure local username login authentication as discussed earlier in this chapter.|Используйте различные команды в режиме конфигурации линии VTY для настройки аутентификации при входе в систему с локальным именем пользователя, как обсуждалось ранее в этой главе.
|
NOTE Cisco routers often default to transport input none, so you must add the transport input line subcommand to enable Telnet and/or SSH into a router.|ПРИМЕЧАНИЕ. Маршрутизаторы Cisco часто по умолчанию не используют транспортный ввод, поэтому необходимо добавить подкоманду транспортной строки ввода, чтобы включить Telnet и / или SSH в маршрутизатор.
|
Two key commands give some information about the status of SSH on the switch.|Две ключевые команды дают некоторую информацию о состоянии SSH на коммутаторе.
First, the show ip ssh command lists status information about the SSH server itself.|Во-первых, команда show ip ssh выводит информацию о состоянии самого SSH-сервера.
The show ssh command then lists information about each SSH client currently connected into the switch.|Затем команда show ssh выводит информацию о каждом SSH-клиенте, который в данный момент подключен к коммутатору.
|
Example 6-6 shows samples of each, with user wendell currently connected to the switch.|В примере 6-6 показаны образцы каждого из них, когда пользователь Венделл в настоящее время подключен к коммутатору.
|
Example 6-6 Displaying SSH Status Example end.|Пример 6-6 Отображение статуса SSH Пример конец.
### Enabling IPv4 for Remote Access
Включение IPv4 для удаленного доступа   
__|__
--|--
|
To allow Telnet or SSH access to the switch, and to allow other IP-based management protocols (for example, Simple Network Management Protocol, or SNMP) to function as intended, the switch needs an IP address, as well as a few other related settings.|Чтобы разрешить доступ Telnet или SSH к коммутатору и разрешить другим протоколам управления на основе IP (например, Simple Network Management Protocol или SNMP) функционировать должным образом, коммутатору необходим IP-адрес, а также несколько других связанных настройки.
The IP address has nothing to do with how switches forward Ethernet frames; it simply exists to support overhead management traffic.|IP-адрес не имеет ничего общего с тем, как коммутаторы пересылают кадры Ethernet; он просто существует для поддержки служебного трафика управления.
|
This next topic begins by explaining the IPv4 settings needed on a switch, followed by the configuration.|Следующая тема начинается с объяснения настроек IPv4, необходимых для коммутатора, а затем с настройки.
Note that although switches can be configured with IPv6 addresses with commands similar to those shown in this chapter, this chapter focuses solely on IPv4.|Обратите внимание, что хотя коммутаторы могут быть настроены с адресами IPv6 с помощью команд, аналогичных тем, которые показаны в этой главе, эта глава посвящена исключительно IPv4.
All references to IP in this chapter imply IPv4.|Все ссылки на IP в этой главе подразумевают IPv4.
#### Host and Switch IP Settings
Настройки хоста и коммутатора IP   
__|__
--|--
|
A switch needs the same kind of IP settings as a PC with a single Ethernet interface.|Коммутатор требует таких же настроек IP, как и ПК с одним интерфейсом Ethernet.
For perspective, a PC has a CPU, with the operating system running on the CPU. It has an Ethernet network interface card (NIC). The OS configuration includes an IP address associated with the NIC, either configured or learned dynamically with DHCP.|Для сравнения: у ПК есть центральный процессор, на котором работает операционная система. Он имеет сетевую карту Ethernet (NIC). Конфигурация ОС включает IP-адрес, связанный с сетевой картой, настроенный или полученный динамически с помощью DHCP.
|
A switch uses the same ideas, except that the switch needs to use a virtual NIC inside the switch.|Коммутатор использует те же идеи, за исключением того, что коммутатор должен использовать виртуальную сетевую карту внутри коммутатора.
Like a PC, a switch has a real CPU, running an OS (called IOS). The switch obviously has lots of Ethernet ports, but instead of assigning its management IP address to any of those ports, the switch then uses a NIC-like concept called a switched virtual interface (SVI), or more commonly, a VLAN interface, that acts like the switch’s own NIC. Then the settings on the switch look something like a host, with the switch configuration assigning IP settings, like an IP address, to this VLAN interface, as shown in Figure 6-6.|Как и ПК, коммутатор имеет реальный ЦП, работающий под управлением ОС (называемой IOS). Коммутатор, очевидно, имеет множество портов Ethernet, но вместо того, чтобы назначать свой управляющий IP-адрес любому из этих портов, коммутатор затем использует концепцию, похожую на сетевую карту, называемую коммутируемым виртуальным интерфейсом (SVI), или, чаще, интерфейсом VLAN, который действует как собственный сетевой адаптер коммутатора. Тогда настройки на коммутаторе будут выглядеть примерно как хост, а конфигурация коммутатора назначает IP-настройки, такие как IP-адрес, этому интерфейсу VLAN, как показано на рис. 6-6.
|
Figure 6-6 Switch Virtual Interface (SVI) Concept Inside a Switch By using interface VLAN 1 for the IP configuration, the switch can then send and receive frames on any of the ports in VLAN 1.|Рисунок 6-6 Концепция виртуального интерфейса коммутатора (SVI) внутри коммутатора Используя интерфейс VLAN 1 для конфигурации IP, коммутатор может затем отправлять и получать кадры на любом из портов в VLAN 1.
In a Cisco switch, by default, all ports are assigned to VLAN 1.|В коммутаторе Cisco по умолчанию все порты назначены на VLAN 1.
|
In most networks, switches configure many VLANs, so the network engineer has a choice of where to configure the IP address.|В большинстве сетей коммутаторы настраивают множество VLAN, поэтому сетевой инженер может выбрать, где настроить IP-адрес.
That is, the management IP address does not have to be configured on the VLAN 1 interface (as configured with the interface vlan 1 command seen in Figure 6-6).|То есть IP-адрес управления не нужно настраивать на интерфейсе VLAN 1 (как настроено с помощью команды interface vlan 1, показанной на рис. 6-6).
|
A Layer 2 Cisco LAN switch needs only one IP address for management purposes.|Коммутатору Cisco LAN уровня 2 для управления нужен только один IP-адрес.
However, you can choose to use any VLAN to which the switch connects.|Однако вы можете использовать любую VLAN, к которой подключается коммутатор.
The configuration then includes a VLAN interface for that VLAN number, with an appropriate IP address.|Затем конфигурация включает интерфейс VLAN для этого номера VLAN с соответствующим IP-адресом.
|
For example, Figure 6-7 shows a Layer 2 switch with some physical ports in two different VLANs (VLANs 1 and 2).|Например, на рис. 6-7 показан коммутатор уровня 2 с некоторыми физическими портами в двух разных VLAN (VLAN 1 и 2).
The figure also shows the subnets used on those VLANs. The network engineer could choose to use either|На рисунке также показаны подсети, используемые в этих VLAN. Сетевой инженер может использовать либо
###### Interface VLAN 1, with an IP address in subnet 192.168.1.0
Интерфейс VLAN 1, с IP-адресом в подсети 192.168.1.0   
###### Interface VLAN 2, with an IP address in subnet 192.168.2.0.
Интерфейс VLAN 2 с IP-адресом в подсети 192.168.2.0.   
__|__
--|--
|
Figure 6-7 Choosing One VLAN on Which to Configure a Switch IP Address Note that you should not try to use a VLAN interface for which there are no physical ports assigned to the same VLAN. If you do, the VLAN interface will not reach an up/up state, and the switch will not have the physical ability to communicate outside the switch.|Рисунок 6-7 Выбор одной VLAN для настройки IP-адреса коммутатора Обратите внимание, что вам не следует пытаться использовать интерфейс VLAN, для которого нет физических портов, назначенных той же VLAN. Если вы это сделаете, интерфейс VLAN не перейдет в рабочее состояние, и у коммутатора не будет физической возможности взаимодействовать с ним вне коммутатора.
|
NOTE Some Cisco switches can be configured to act as either a Layer 2 switch or a Layer 3 switch.|ПРИМЕЧАНИЕ. Некоторые коммутаторы Cisco можно настроить для работы в качестве коммутатора уровня 2 или уровня 3.
When acting as a Layer 2 switch, a switch forwards Ethernet frames as discussed in depth in Chapter 5, “Analyzing Ethernet LAN Switching.” Alternatively, a switch can also act as a multilayer switch or Layer 3 switch, which means the switch can do both Layer 2 switching and Layer 3 IP routing of IP packets, using the Layer 3 logic normally used by routers.|При работе в качестве коммутатора уровня 2 коммутатор пересылает кадры Ethernet, как подробно описано в главе 5 «Анализ коммутации Ethernet LAN». В качестве альтернативы коммутатор также может действовать как многоуровневый коммутатор или коммутатор уровня 3, что означает, что коммутатор может выполнять как коммутацию уровня 2, так и IP-маршрутизацию уровня 3 IP-пакетов, используя логику уровня 3, обычно используемую маршрутизаторами.
This chapter assumes all switches are Layer 2 switches.|В этой главе предполагается, что все коммутаторы являются коммутаторами уровня 2.
Chapter 17, “IP Routing in the LAN,” discusses Layer 3 switching in depth along with using multiple VLAN interfaces at the same time.|В главе 17 «IP-маршрутизация в локальной сети» подробно рассматривается коммутация уровня 3 и одновременное использование нескольких интерфейсов VLAN.
|
Configuring the IP address (and mask) on one VLAN interface allows the switch to send and receive IP packets with other hosts in a subnet that exists on that VLAN; however, the switch cannot communicate outside the local subnet without another configuration setting called the default gateway.|Настройка IP-адреса (и маски) на одном интерфейсе VLAN позволяет коммутатору отправлять и получать IP-пакеты с другими узлами в подсети, которая существует в этой VLAN; однако коммутатор не может взаимодействовать за пределами локальной подсети без другого параметра конфигурации, который называется шлюзом по умолчанию.
The reason a switch needs a default gateway setting is the same reason that hosts need the same setting—because of how hosts think when sending IP packets.|Причина, по которой коммутатору нужна настройка шлюза по умолчанию, совпадает с той, по которой хостам нужны такие же настройки - из-за того, как хосты думают при отправке IP-пакетов.
|
Specifically:|В частности:
###### To send IP packets to hosts in the same subnet, send them directly
Чтобы отправлять IP-пакеты на хосты в той же подсети, отправьте их напрямую   
###### To send IP packets to hosts in a different subnet, send them to the local router; that is, the
Чтобы отправить IP-пакеты на хосты в другой подсети, отправьте их на локальный маршрутизатор; это   
__|__
--|--
|
default gateway Figure 6-8 shows the ideas.|шлюз по умолчанию На рис. 6-8 показаны идеи.
In this case, the switch (on the right) will use IP address 192.168.1.200 as configured on interface VLAN 1.|В этом случае коммутатор (справа) будет использовать IP-адрес 192.168.1.200, как настроено на интерфейсе VLAN 1.
However, to communicate with host A, on the far left of the figure, the switch must use Router R1 (the default gateway) to forward IP packets to host A.|Однако для связи с хостом A в крайнем левом углу рисунка коммутатор должен использовать маршрутизатор R1 (шлюз по умолчанию) для пересылки IP-пакетов на хост A.
To make that work, the switch needs to configure a default gateway setting, pointing to Router R1’s IP address (192.168.1.1 in this case).|Для этого коммутатору необходимо настроить шлюз по умолчанию, указав IP-адрес маршрутизатора R1 (в данном случае 192.168.1.1).
Note that the switch and router both use the same mask, 255.255.255.0, which puts the addresses in the same subnet.|Обратите внимание, что коммутатор и маршрутизатор используют одну и ту же маску 255.255.255.0, которая помещает адреса в одну подсеть.
|
Figure 6-8 The Need for a Default Gateway|Рисунок 6-8 Необходимость в шлюзе по умолчанию
#### Configuring IPv4 on a Switch
Настройка IPv4 на коммутаторе   
__|__
--|--
|
A switch configures its IPv4 address and mask on this special NIC-like VLAN interface.|Коммутатор настраивает свой IPv4-адрес и маску на этом специальном сетевом интерфейсе VLAN.
The following steps list the commands used to configure IPv4 on a switch, assuming that the IP address is configured to be in VLAN 1, with Example 6-7 that follows showing an example configuration.|В следующих шагах перечислены команды, используемые для настройки IPv4 на коммутаторе, при условии, что IP-адрес настроен для VLAN 1, а в следующем примере 6-7 показан пример конфигурации.
|
Step 1.|Шаг 1.
Use the interface vlan 1 command in global configuration mode to enter interface VLAN 1 configuration mode.|Используйте команду interface vlan 1 в режиме глобальной конфигурации, чтобы войти в режим конфигурации интерфейса VLAN 1.
|
Step 2.|Шаг 2.
Use the ip address ip-address mask command in interface configuration mode to assign an IP address and mask.|Используйте команду ip address ip-address mask в режиме настройки интерфейса, чтобы назначить IP-адрес и маску.
|
Step 3.|Шаг 3.
Use the no shutdown command in interface configuration mode to enable the VLAN 1 interface if it is not already enabled.|Используйте команду no shutdown в режиме настройки интерфейса, чтобы включить интерфейс VLAN 1, если он еще не включен.
|
Step 4.|Шаг 4.
Add the ip default-gateway ip-address command in global configuration mode to configure the default gateway.|Добавьте команду ip default-gateway ip-address в режиме глобальной конфигурации, чтобы настроить шлюз по умолчанию.
|
Step 5. (Optional) Add the ip name-server ip-address1 ip-address2 … command in global configuration mode to configure the switch to use Domain Name System (DNS) to resolve names into their matching IP address.|Шаг 5. (Необязательно) Добавьте команду ip name-server ip-address1 ip-address2… в режиме глобальной конфигурации, чтобы настроить коммутатор на использование системы доменных имен (DNS) для преобразования имен в соответствующие IP-адреса.
|
Example 6-7 Switch Static IP Address Configuration Example end.|Пример 6-7 Конфигурация статического IP-адреса коммутатора Конец примера.
|
On a side note, this example shows a particularly important and common command: the [no] shutdown command.|Кстати, в этом примере показана особенно важная и распространенная команда: команда [no] shutdown.
To administratively enable an interface on a switch, use the no shutdown interface subcommand; to disable an interface, use the shutdown interface subcommand.|Чтобы административно включить интерфейс на коммутаторе, используйте подкоманду no shutdown interface; чтобы отключить интерфейс, используйте подкоманду shutdown interface.
This command can be used on the physical Ethernet interfaces that the switch uses to switch Ethernet messages in addition to the VLAN interface shown here in this example.|Эту команду можно использовать на физических интерфейсах Ethernet, которые коммутатор использует для переключения сообщений Ethernet, в дополнение к интерфейсу VLAN, показанному здесь в этом примере.
|
Also, pause long enough to look at the messages that appear just below the no shutdown command in Example 6-7.|Кроме того, сделайте паузу достаточно долго, чтобы просмотреть сообщения, которые появляются сразу под командой no shutdown в примере 6-7.
Those messages are syslog messages generated by the switch stating that the switch did indeed enable the interface.|Эти сообщения представляют собой сообщения системного журнала, созданные коммутатором, в которых говорится, что коммутатор действительно включил интерфейс.
Switches (and routers) generate syslog messages in response to a variety of events, and by default, those messages appear at the console.|Коммутаторы (и маршрутизаторы) генерируют сообщения системного журнала в ответ на различные события, и по умолчанию эти сообщения появляются на консоли.
Chapter 9, “Device Management Protocols,” in the CCNA 200-301 Official Cert Guide, Volume 2, discusses syslog messages in more detail.|В главе 9 «Протоколы управления устройствами» в официальном руководстве по сертификации CCNA 200-301, том 2, сообщения системного журнала рассматриваются более подробно.
#### Configuring a Switch to Learn Its IP Address with DHCP
Настройка коммутатора для определения его IP-адреса с помощью DHCP   
__|__
--|--
|
The switch can also use Dynamic Host Configuration Protocol (DHCP) to dynamically learn its IPv4 settings.|Коммутатор также может использовать протокол динамической конфигурации хоста (DHCP) для динамического изучения настроек IPv4.
Basically, all you have to do is tell the switch to use DHCP on the interface and enable the interface.|По сути, все, что вам нужно сделать, это указать коммутатору использовать DHCP на интерфейсе и включить интерфейс.
Assuming that DHCP works in this network, the switch will learn all its settings.|Предполагая, что DHCP работает в этой сети, коммутатор узнает все его настройки.
The following list details the steps, again assuming the use of interface VLAN 1, with Example 6-8 that follows showing an example:|В следующем списке подробно описаны шаги, снова предполагая использование интерфейса VLAN 1, в следующем примере 6-8 показан пример:
|
Step 1.|Шаг 1.
Enter VLAN 1 configuration mode using the interface vlan 1 global configuration command, and enable the interface using the no shutdown command as necessary.|Войдите в режим конфигурации VLAN 1 с помощью команды глобальной конфигурации interface vlan 1 и включите интерфейс, используя команду no shutdown, если необходимо.
|
Step 2.|Шаг 2.
Assign an IP address and mask using the ip address dhcp interface subcommand.|Назначьте IP-адрес и маску с помощью подкоманды ip address dhcp interface.
|
Example 6-8 Switch Dynamic IP Address Configuration with DHCP Example end.|Пример 6-8 Переключить конфигурацию динамического IP-адреса с DHCP Пример конец.
#### Verifying IPv4 on a Switch
Проверка IPv4 на коммутаторе   
__|__
--|--
|
The switch IPv4 configuration can be checked in several places.|Конфигурацию IPv4 коммутатора можно проверить в нескольких местах.
First, you can always look at the current configuration using the show running-config command.|Во-первых, вы всегда можете посмотреть текущую конфигурацию с помощью команды show running-config.
Second, you can look at the IP address and mask information using the show interfaces vlan x command, which shows detailed status information about the VLAN interface in VLAN x.|Во-вторых, вы можете посмотреть информацию об IP-адресе и маске с помощью команды show interfaces vlan x, которая показывает подробную информацию о состоянии интерфейса VLAN в VLAN x.
Finally, if using DHCP, use the show dhcp lease command to see the (temporarily) leased IP address and other parameters. (Note that the switch does not store the DHCP-learned IP configuration in Config Checklist the running-config file.) Example 6-9 shows sample output from these commands to match the configuration in Example 6-8.|Наконец, при использовании DHCP используйте команду show dhcp lease, чтобы увидеть (временно) арендованный IP-адрес и другие параметры. (Обратите внимание, что коммутатор не сохраняет IP-конфигурацию, полученную с помощью DHCP, в контрольном списке конфигурации в файле рабочей конфигурации.) В примере 6-9 показан пример выходных данных этих команд, соответствующий конфигурации в примере 6-8.
|
Example 6-9 Verifying DHCP-Learned Information on a Switch Example end.|Пример 6-9 Проверка полученной DHCP информации на конце примера коммутатора.
|
The output of the show interfaces vlan 1 command lists two very important details related to switch IP addressing.|В выходных данных команды show interfaces vlan 1 перечислены две очень важные детали, относящиеся к IP-адресации коммутатора.
First, this show command lists the interface status of the VLAN 1 interface—in this case, “up and up.” If the VLAN 1 interface is not up, the switch cannot use its IP address to send and receive management traffic.|Во-первых, эта команда show перечисляет статус интерфейса интерфейса VLAN 1 - в данном случае «работает и работает». Если интерфейс VLAN 1 не работает, коммутатор не может использовать свой IP-адрес для отправки и получения трафика управления.
Notably, if you forget to issue the no shutdown command, the VLAN 1 interface remains in its default shutdown state and is listed as “administratively down” in the show command output.|Примечательно, что если вы забудете ввести команду no shutdown, интерфейс VLAN 1 останется в состоянии выключения по умолчанию и будет указан как «административно отключен» в выходных данных команды show.
|
Second, note that the output lists the interface’s IP address on the third line.|Во-вторых, обратите внимание, что вывод показывает IP-адрес интерфейса в третьей строке.
If you statically configure the IP address, as in Example 6-7, the IP address will always be listed; however, if you use DHCP and DHCP fails, the show interfaces vlan x command will not list an IP address here.|Если вы статически настраиваете IP-адрес, как в Примере 6-7, IP-адрес всегда будет указан; однако, если вы используете DHCP и DHCP не работает, команда show interfaces vlan x не будет указывать здесь IP-адрес.
When DHCP works, you can see the IP address with the show interfaces vlan 1 command, but that output does not remind you whether the address is either statically configured or DHCP leased.|Когда DHCP работает, вы можете увидеть IP-адрес с помощью команды show interfaces vlan 1, но эти выходные данные не напоминают вам, является ли адрес статическим или арендованным DHCP.
So it does take a little extra effort to make sure you know whether the address is statically configured or DHCP-learned on the VLAN interface.|Таким образом, требуется немного дополнительных усилий, чтобы убедиться, что вы знаете, является ли адрес статическим или полученным с помощью DHCP на интерфейсе VLAN.
### Miscellaneous Settings Useful in the Lab
Разные настройки, полезные в лаборатории   
__|__
--|--
|
This last short section of the chapter touches on a couple of commands that can help you be a little more productive when practicing in a lab.|Этот последний короткий раздел главы касается пары команд, которые могут помочь вам быть немного более продуктивными при занятиях в лаборатории.
#### History Buffer Commands
Команды буфера истории   
__|__
--|--
|
When you enter commands from the CLI, the switch saves the last several commands in the history buffer.|Когда вы вводите команды из CLI, коммутатор сохраняет последние несколько команд в буфере истории.
Then, as mentioned in Chapter 4, “Using the Command-Line Interface,” you can use the up-arrow key or press Ctrl+P to move back in the history buffer to retrieve a command you entered a few commands ago.|Затем, как упоминалось в главе 4 «Использование интерфейса командной строки», вы можете использовать клавишу со стрелкой вверх или нажать Ctrl + P, чтобы вернуться в буфер истории и получить команду, которую вы вводили несколько команд назад.
This feature makes it very easy and fast to use a set of commands repeatedly.|Эта функция позволяет очень легко и быстро многократно использовать набор команд.
Table 6-2 lists some of the key commands related to the history buffer.|В таблице 6-2 перечислены некоторые ключевые команды, относящиеся к буферу истории.
|
Table 6-2 Commands Related to the History Buffer Table end.|Таблица 6-2 Команды, относящиеся к концу таблицы буфера истории.
#### The logging synchronous, exec-timeout, and no ip domain-lookup Commands
Команды logging synchronous, exec-timeout и no ip domain-lookup   
__|__
--|--
|
Commands These next three configuration commands have little in common, other than the fact that they can be useful settings to reduce your frustration when using the console of a switch or router.|Команды Эти следующие три команды настройки имеют мало общего, кроме того факта, что они могут быть полезными настройками, чтобы уменьшить ваше разочарование при использовании консоли коммутатора или маршрутизатора.
|
The console automatically receives copies of all unsolicited syslog messages on a switch.|Консоль автоматически получает копии всех нежелательных сообщений системного журнала на коммутаторе.
The idea is that if the switch needs to tell the network administrator some important and possibly urgent information, the administrator might be at the console and might notice the message.|Идея состоит в том, что если коммутатору необходимо сообщить сетевому администратору какую-то важную и, возможно, срочную информацию, администратор может находиться у консоли и может заметить это сообщение.
|
Unfortunately, IOS (by default) displays these syslog messages on the console’s screen at any time—including right in the middle of a command you are entering, or in the middle of the output of a show command.|К сожалению, IOS (по умолчанию) отображает эти сообщения системного журнала на экране консоли в любое время, в том числе прямо в середине вводимой вами команды или в середине вывода команды show.
Having a bunch of text show up unexpectedly can be a bit annoying.|Неожиданное появление кучи текста может немного раздражать.
|
You could simply disable the feature that sends these messages to the console and then reenable the feature later using the no logging console and logging console global configuration commands.|Вы можете просто отключить функцию, которая отправляет эти сообщения на консоль, а затем повторно включить эту функцию позже, используя команды глобальной конфигурации консоли no logging и logging console.
For example, when working from the console, if you want to temporarily not be bothered by log messages, you can disable the display of these messages with the no logging console global configuration command, and then when finished, enable them again.|Например, при работе с консоли, если вы хотите временно не беспокоиться о сообщениях журнала, вы можете отключить отображение этих сообщений с помощью команды глобальной конфигурации консоли без ведения журнала, а затем, когда закончите, включить их снова.
|
However, IOS supplies a reasonable compromise, telling the switch to display syslog messages only at more convenient times, such as at the end of output from a show command.|Однако IOS предлагает разумный компромисс, сообщая коммутатору отображать сообщения системного журнала только в более удобное время, например, в конце вывода команды show.
To do so, just configure the logging synchronous console line subcommand, which basically tells IOS to synchronize the syslog message display with the messages requested using show commands.|Для этого просто настройте подкоманду logging synchronous console line, которая в основном сообщает IOS синхронизировать отображение сообщения системного журнала с сообщениями, запрошенными с помощью команд show.
|
Another way to improve the user experience at the console is to control timeouts of the login session from the console or when using Telnet or SSH. By default, the switch automatically disconnects console and vty (Telnet and SSH) users after 5 minutes of inactivity.|Еще один способ улучшить взаимодействие с пользователем на консоли - управлять таймаутами сеанса входа в систему с консоли или при использовании Telnet или SSH. По умолчанию коммутатор автоматически отключает пользователей консоли и vty (Telnet и SSH) после 5 минут бездействия.
The exec-timeout minutes seconds line subcommand enables you to set the length of that inactivity timer.|Подкоманда строки exec-timeout minutes seconds позволяет вам установить длительность этого таймера неактивности.
In the lab (but not in production), you might want to use the special value of 0 minutes and 0 seconds meaning “never time out.”|В лабораторных условиях (но не в производстве) вы можете использовать специальное значение 0 минут и 0 секунд, означающее «никогда не истекло время ожидания».
|
Finally, IOS has an interesting combination of features that can make you wait for a minute or so when you mistype a command.|Наконец, в IOS есть интересная комбинация функций, которая может заставить вас подождать минуту или около того, если вы ошиблись в команде.
First, IOS tries to use DNS name resolution on IP hostnames—a generally useful feature.|Во-первых, IOS пытается использовать разрешение DNS-имен для IP-имен хостов - это обычно полезная функция.
If you mistype a command, however, IOS thinks you want to telnet to a host by that name.|Однако, если вы ошиблись при вводе команды, IOS сочтет, что вы хотите подключиться к хосту с таким именем по telnet.
With all default settings in the switch, the switch tries to resolve the hostname, cannot find a DNS server, and takes about a minute to time out and give you control of the CLI again.|Со всеми настройками по умолчанию в коммутаторе коммутатор пытается разрешить имя хоста, не может найти DNS-сервер, и требуется около минуты, чтобы тайм-аут и снова дать вам контроль над CLI.
|
To avoid this problem, configure the no ip domain-lookup global configuration command, which disables IOS’s attempt to resolve the hostname into an IP address.|Чтобы избежать этой проблемы, настройте команду глобальной конфигурации no ip domain-lookup, которая отключает попытки IOS преобразовать имя хоста в IP-адрес.
|
Example 6-10 collects all these commands into a single example, as a template for some good settings to add in a lab switch to make you more productive.|В примере 6-10 все эти команды собраны в один пример в качестве шаблона для некоторых хороших настроек, которые можно добавить в лабораторный переключатель, чтобы сделать вас более продуктивным.
|
Example 6-10 Commands Often Used in the Lab to Increase Productivity Example end.|Пример 6-10 Команды, часто используемые в лабораторной работе для повышения производительности Пример end.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element section titled “Step 2: Build Your Study Habits Around the Chapter” for more details.|Обратитесь к разделу элемента «Ваш учебный план», озаглавленному «Шаг 2: выработайте учебу вокруг главы» для получения более подробной информации.
Table 6-3 outlines the key review elements and where you can find them.|В Таблице 6-3 перечислены ключевые элементы обзора и указаны места, где их можно найти.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 6-3 Chapter Review Tracking Table end.|Таблица 6-3 Окончание таблицы отслеживания обзора главы.
|
Review All the Key Topics Key Terms You Should Know Telnet, Secure Shell (SSH), local username, AAA, AAA server, enable mode, default gateway, VLAN interface, history buffer, DNS, name resolution, log message Do Labs The Sim Lite software is a version of Pearson’s full simulator learning product with a subset of the labs, included with this book for free.|Ознакомьтесь со всеми ключевыми темами. Ключевые термины, которые вы должны знать Telnet, Secure Shell (SSH), локальное имя пользователя, AAA, сервер AAA, режим включения, шлюз по умолчанию, интерфейс VLAN, буфер истории, DNS, разрешение имен, сообщение журнала. Do Labs The Sim Lite Программное обеспечение представляет собой версию полного учебного продукта на симуляторах Pearson с подмножеством лабораторных работ, бесплатно включенных в эту книгу.
The subset of labs mostly relate to this part.|Подмножество лабораторных работ в основном относится к этой части.
|
Take the time to try some of the labs.|Найдите время, чтобы попробовать некоторые из лабораторных работ.
As always, also check the author’s blog site pages for configuration exercises (Config Labs) at https://blog.certskills.com.|Как всегда, также проверьте страницы блога автора на предмет упражнений по настройке (Лаборатория конфигурирования) по адресу https://blog.certskills.com.
|
Command References Tables 6-5, 6-6, 6-7, and 6-8 list configuration and verification commands used in this chapter.|Ссылки на команды В таблицах 6-5, 6-6, 6-7 и 6-8 перечислены команды настройки и проверки, используемые в этой главе.
|
As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.|В качестве простого упражнения на повторение закройте левый столбец таблицы, прочтите правый столбец и попытайтесь вспомнить команду, не глядя.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Затем повторите упражнение, охватывая правый столбец, и попытайтесь вспомнить, что делает команда.
|
Table 6-5 Login Security Commands Table end.|Таблица 6-5 Команды безопасности входа в систему Конец таблицы.
|
Table 6-6 Switch IPv4 Configuration Table end.|Таблица 6-6. Конец таблицы конфигурации IPv4 коммутатора.
|
Table 6-7 Other Switch Configuration Table end.|Таблица 6-7. Конец таблицы конфигурации других коммутаторов.
|
Table 6-8 Chapter 6 EXEC Command Reference Table end.|Таблица 6-8 Глава 6 Справочник команд EXEC Конец таблицы.
## Chapter 7 Configuring and Verifying Switch Interfaces
Глава 7 Настройка и проверка интерфейсов коммутатора   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.1 Explain the role and function of network components
1.1 Объясните роль и функции сетевых компонентов   
###### 1.1.b L2 and L3 switches
1.1.b Коммутаторы L2 и L3   
###### 1.4 Describe switching concepts
1.4 Описание концепций переключения   
__|__
--|--
|
So far in this part, you have learned the skills to navigate the command-line interface (CLI)|До сих пор в этой части вы изучили навыки навигации по интерфейсу командной строки (CLI).
|
and use commands that configure and verify switch features.|и использовать команды для настройки и проверки функций коммутатора.
You learned about the primary purpose of a switch—forwarding Ethernet frames—and learned how to see that process in action by looking at the switch MAC address table.|Вы узнали об основной цели коммутатора - пересылке кадров Ethernet - и узнали, как увидеть этот процесс в действии, просмотрев таблицу MAC-адресов коммутатора.
After learning about the switch data plane in Chapter 5, “Analyzing Ethernet LAN Switching,” you learned a few management plane features in Chapter 6, “Configuring Basic Switch Management,” like how to configure the switch to support Telnet and Secure Shell (SSH) by configuring IP address and login security.|Изучив плоскость данных коммутатора в главе 5 «Анализ коммутации локальной сети Ethernet», вы узнали несколько функций плоскости управления в главе 6 «Настройка базового управления коммутатором», например, как настроить коммутатор для поддержки Telnet и Secure Shell (SSH ) путем настройки IP-адреса и безопасности входа.
|
This chapter focuses on switch interfaces in two major sections.|Эта глава посвящена интерфейсам коммутатора в двух основных разделах.
The first section shows how you can configure and change the operation of switch interfaces: how to change the speed, duplex, or even disable the interface.|В первом разделе показано, как можно настроить и изменить работу интерфейсов коммутатора: как изменить скорость, дуплекс или даже отключить интерфейс.
The second half then focuses on how to use show commands on a switch to verify switch interface status and how to interpret the output to find some of the more common issues with switch interfaces.|Вторая половина затем фокусируется на том, как использовать команды show на коммутаторе для проверки состояния интерфейса коммутатора и как интерпретировать вывод, чтобы найти некоторые из наиболее распространенных проблем с интерфейсами коммутатора.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 7-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 7-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### Configuring Switch Interfaces
Настройка интерфейсов коммутатора   
__|__
--|--
|
Analyzing Switch Interface Status and Statistics 4–6 CHAPTER 7 1.|Анализ состояния и статистики интерфейса коммутатора 4–6 ГЛАВА 7 1.
Which of the following describes a way to disable IEEE standard autonegotiation on a 10/100 port on a Cisco switch?|Что из следующего описывает способ отключения стандартного автосогласования IEEE на порту 10/100 коммутатора Cisco?
|
a. Configure the negotiate disable interface subcommand b.|а. Настройте подкоманду согласования отключения интерфейса b.
Configure the no negotiate interface subcommand c.|Настройте подкоманду без согласования интерфейса c.
Configure the speed 100 interface subcommand d.|Настройте подкоманду интерфейса speed 100 d.
Configure the duplex half interface subcommand e.|Настройте подкоманду дуплексного полуинтерфейса e.
Configure the duplex full interface subcommand f.|Настройте подкоманду дуплексного полного интерфейса f.
Configure the speed 100 and duplex full interface subcommands 2.|Настройте подкоманды speed 100 и duplex full interface 2.
In which of the following modes of the CLI could you configure the duplex setting for interface Fast Ethernet 0/5?|В каком из следующих режимов интерфейса командной строки вы можете настроить дуплексный режим для интерфейса Fast Ethernet 0/5?
|
a. User mode b.|а. Пользовательский режим b.
Enable mode c.|Включить режим c.
Global configuration mode d.|Режим глобальной конфигурации d.
VLAN mode e.|Режим VLAN e.
Interface configuration mode 3.|Режим настройки интерфейса 3.
A Cisco Catalyst switch connects with its Gigabit0/1 port to an end user’s PC. The end user, thinking the user is helping, manually sets the PC’s OS to use a speed of 1000 Mbps and to use full duplex, and disables the use of autonegotiation.|Коммутатор Cisco Catalyst подключается через порт Gigabit0 / 1 к ПК конечного пользователя. Конечный пользователь, думая, что пользователь помогает, вручную настраивает ОС ПК на скорость 1000 Мбит / с и полный дуплекс, а также отключает использование автосогласования.
The switch’s G0/1 port has default settings for speed and duplex.|Порт G0 / 1 коммутатора имеет настройки по умолчанию для скорости и дуплекса.
What speed and duplex settings will the switch decide to use? (Choose two answers.)|Какие настройки скорости и дуплексного режима выберет коммутатор? (Выберите два ответа.)
|
a. Full duplex b.|а. Полный дуплекс b.
Half duplex c. 10 Mbps d. 1000 Mbps 4.|Полудуплекс c. 10 Мбит / с d. 1000 Мбит / с 4.
The output of the show interfaces status command on a 2960 switch shows interface Fa0/1 in a “disabled” state.|Выходные данные команды show interfaces status на коммутаторе 2960 показывают интерфейс Fa0 / 1 в «отключенном» состоянии.
Which of the following is true about interface Fa0/1?|Что из следующего верно об интерфейсе Fa0 / 1?
|
(Choose three answers.)|(Выберите три ответа.)
|
a. The interface is configured with the shutdown command.|а. Интерфейс настраивается с помощью команды выключения.
|
b. The show interfaces fa0/1 command will list the interface with two status codes of administratively down and line protocol down.|б. Команда show interfaces fa0 / 1 выведет список интерфейсов с двумя кодами состояния: административно отключен и линейный протокол отключен.
|
c. The show interfaces fa0/1 command will list the interface with two status codes of up and down.|c. Команда show interfaces fa0 / 1 выведет список интерфейсов с двумя кодами состояния: up и down.
|
d. The interface cannot currently be used to forward frames.|d. В настоящее время интерфейс не может использоваться для пересылки кадров.
|
e. The interface can currently be used to forward frames.|е. В настоящее время интерфейс можно использовать для пересылки кадров.
|
5. Switch SW1 uses its Gigabit 0/1 interface to connect to switch SW2’s Gigabit 0/2 interface.|5. Коммутатор SW1 использует интерфейс Gigabit 0/1 для подключения к интерфейсу Gigabit 0/2 коммутатора SW2.
|
SW2’s Gi0/2 interface is configured with the speed 1000 and duplex full commands.|Интерфейс Gi0 / 2 SW2 настроен на скорость 1000 и команды полного дуплексного режима.
|
SW1 uses all defaults for interface configuration commands on its Gi0/1 interface.|SW1 использует все значения по умолчанию для команд настройки интерфейса на своем интерфейсе Gi0 / 1.
|
Which of the following are true about the link after it comes up? (Choose two answers.)|Что из следующего является верным относительно ссылки после того, как она появится? (Выберите два ответа.)
|
a. The link works at 1000 Mbps (1 Gbps).|а. Ссылка работает на скорости 1000 Мбит / с (1 Гбит / с).
|
b. SW1 attempts to run at 10 Mbps because SW2 has effectively disabled IEEE standard autonegotiation.|б. SW1 пытается работать на скорости 10 Мбит / с, поскольку SW2 фактически отключил стандартное автосогласование IEEE.
|
c. The link runs at 1 Gbps, but SW1 uses half duplex and SW2 uses full duplex.|c. Канал работает со скоростью 1 Гбит / с, но SW1 использует полудуплекс, а SW2 - полный дуплекс.
|
d. Both switches use full duplex.|d. Оба коммутатора используют полный дуплекс.
|
6. Switch SW1 connects via a cable to switch SW2’s G0/1 port.|6. Коммутатор SW1 подключается кабелем к порту G0 / 1 переключателя SW2.
Which of the following conditions is the most likely to cause SW1’s late collision counter to continue to increment?|Какое из следующих условий с наибольшей вероятностью приведет к тому, что счетчик поздних столкновений SW1 будет продолжать увеличиваться?
|
a. SW2’s G0/1 has been configured with a shutdown interface subcommand.|а. G0 / 1 SW2 настроен с помощью подкоманды интерфейса выключения.
|
b. The two switches have been configured with different values on the speed interface subcommand.|б. Два переключателя настроены с разными значениями подкоманды интерфейса скорости.
|
c. A duplex mismatch exists with SW1 set to full duplex.|c. Несоответствие дуплексного режима существует с SW1, установленным на полный дуплекс.
|
d. A duplex mismatch exists with SW1 set to half duplex.|d. Несоответствие дуплексного режима существует с SW1, установленным в полудуплексный режим.
|
Foundation Topics Configuring Switch Interfaces IOS uses the term interface to refer to physical ports used to forward data to and from other devices.|Основные темы Настройка интерфейсов коммутатора IOS использует термин интерфейс для обозначения физических портов, используемых для пересылки данных на другие устройства и от них.
Each interface can be configured with several settings, each of which might differ from interface to interface.|Для каждого интерфейса можно настроить несколько параметров, каждый из которых может отличаться от интерфейса к интерфейсу.
IOS uses interface subcommands to configure these settings.|IOS использует подкоманды интерфейса для настройки этих параметров.
|
Each of these settings may be different from one interface to the next, so you would first identify the specific interface, and then configure the specific setting.|Каждая из этих настроек может отличаться от одного интерфейса к другому, поэтому вы должны сначала определить конкретный интерфейс, а затем настроить конкретный параметр.
|
This section begins with a discussion of three relatively basic per-interface settings: the port speed, duplex, and a text description.|Этот раздел начинается с обсуждения трех относительно базовых настроек интерфейса: скорость порта, дуплекс и текстовое описание.
Following that, the text takes a short look at a pair of the most common interface subcommands: the shutdown and no shutdown commands, which administratively disable and enable the interface, respectively.|После этого в тексте дается краткий обзор пары наиболее распространенных подкоманд интерфейса: команды выключения и отсутствия выключения, которые административно отключают и включают интерфейс соответственно.
This section ends with a discussion about autonegotiation concepts, which in turn dictates what settings a switch chooses to use when using autonegotiation.|Этот раздел заканчивается обсуждением концепций автосогласования, которые, в свою очередь, определяют, какие настройки коммутатор выбирает для использования при использовании автосогласования.
#### Configuring Speed, Duplex, and Description
Настройка скорости, дуплекса и описания   
__|__
--|--
|
Switch interfaces that support multiple speeds (10/100 and 10/100/1000 interfaces), by default, will autonegotiate what speed to use.|Интерфейсы коммутатора, поддерживающие несколько скоростей (интерфейсы 10/100 и 10/100/1000), по умолчанию будут автоматически согласовывать, какую скорость использовать.
However, you can configure the speed and duplex settings with the duplex {auto | full | half} and speed {auto | 10 | 100 | 1000} interface subcommands.|Однако вы можете настроить скорость и параметры дуплекса с помощью дуплекса {auto | полный | половина} и скорость {авто | 10 | 100 | 1000} интерфейсные подкоманды.
Simple enough.|Достаточно просто.
|
Most of the time, using autonegotiation makes good sense, so when you set the duplex and speed manually using these commands, you typically have a good reason to do so.|В большинстве случаев использование автосогласования имеет смысл, поэтому, когда вы вручную устанавливаете дуплекс и скорость с помощью этих команд, у вас обычно есть веская причина для этого.
For instance, maybe you want to set the speed to the fastest possible on links between switches just to avoid the chance that autonegotiation chooses a slower speed.|Например, может быть, вы хотите установить максимально возможную скорость на каналах между коммутаторами, чтобы избежать шанса, что автосогласование выберет более низкую скорость.
|
The description text interface subcommand lets you add a text description to the interface.|Подкоманда description text interface позволяет добавить текстовое описание к интерфейсу.
|
For instance, if you have good reason to configure the speed and duplex on a port, maybe add a description that says why you did.|Например, если у вас есть веская причина для настройки скорости и дуплекса на порту, возможно, добавьте описание, в котором объясняется, почему вы это сделали.
Example 7-1 shows how to configure duplex and speed, as well as the description command, which is simply a text description that can be configured by the administrator.|В примере 7-1 показано, как настроить дуплекс и скорость, а также команду description, которая представляет собой просто текстовое описание, которое может быть настроено администратором.
|
Example 7-1 Configuring speed, duplex, and description on Switch Emma Example end.|Пример 7-1 Настройка скорости, дуплекса и описания на Switch Emma. Пример конец.
|
First, focus on the mechanics of moving around in configuration mode again by looking closely at the command prompts.|Во-первых, снова сосредоточьтесь на механике перемещения в режиме настройки, внимательно посмотрев на командные строки.
The various interface commands move the user from global mode into interface configuration mode for a specific interface.|Различные команды интерфейса переводят пользователя из глобального режима в режим конфигурации интерфейса для конкретного интерфейса.
For instance, the example configures the duplex, speed, and description commands all just after the interface FastEthernet 0/1 command, which means that all three of those configuration settings apply to interface Fa0/1, and not to the other interfaces.|Например, в этом примере команды дуплекса, скорости и описания настраиваются сразу после команды interface FastEthernet 0/1, что означает, что все три из этих параметров конфигурации применяются к интерфейсу Fa0 / 1, а не к другим интерфейсам.
|
The show interfaces status command lists much of the detail configured in Example 7-1, even with only one line of output per interface.|Команда show interfaces status перечисляет большую часть деталей, настроенных в примере 7-1, даже с одной строкой вывода на интерфейс.
Example 7-2 shows an example, just after the configuration in Example 7-1 was added to the switch.|В примере 7-2 показан пример сразу после того, как к коммутатору была добавлена ​​конфигурация из примера 7-1.
|
Example 7-2 Displaying Interface Status Example end.|Пример 7-2 Отображение статуса интерфейса Пример конец.
|
Working through the output in the example:|Работаем с выводом в примере:
|
FastEthernet 0/1 (Fa0/1): This output lists the first few characters of the configured description.|FastEthernet 0/1 (Fa0 / 1): в этих выходных данных перечислены первые несколько символов настроенного описания.
It also lists the configured speed of 100 and duplex full per the speed and duplex commands in Example 7-1.|В нем также перечислены настроенная скорость 100 и полный дуплекс для команд скорости и дуплекса в Примере 7-1.
However, it also states that Fa0/1 has a status of notconnect, meaning that the interface is not currently working. (That switch port did not have a cable connected when collecting this example, on purpose.)|Однако в нем также говорится, что Fa0 / 1 имеет статус notconnect, что означает, что интерфейс в настоящее время не работает. (К этому порту коммутатора специально не был подключен кабель при сборе этого примера.)
|
FastEthernet 0/2 (Fa0/2): Example 7-1 did not configure this port at all.|FastEthernet 0/2 (Fa0 / 2): в примере 7-1 этот порт вообще не настраивался.
This port had all default configuration.|У этого порта была вся конфигурация по умолчанию.
Note that the “auto” text under the speed and duplex heading means that this port will attempt to autonegotiate both settings when the port comes up.|Обратите внимание, что текст «auto» под заголовком «Скорость и дуплекс» означает, что этот порт попытается выполнить автосогласование обоих параметров при подключении порта.
However, this port also does not have a cable connected (again on purpose, for comparison).|Однако к этому порту также не подключен кабель (опять же специально для сравнения).
|
FastEthernet 0/4 (Fa0/4): Like Fa0/2, this port has all default configuration but was cabled to another working device to give yet another contrasting example.|FastEthernet 0/4 (Fa0 / 4): Как и Fa0 / 2, этот порт имеет всю конфигурацию по умолчанию, но был подключен к другому рабочему устройству, чтобы дать еще один контрастный пример.
This device completed the autonegotiation process, so instead of “auto” under the speed and duplex headings, the output lists the negotiated speed and duplex (a-full and a-100).|Это устройство завершило процесс автосогласования, поэтому вместо «авто» под заголовками скорости и дуплекса в выходных данных указывается согласованная скорость и дуплекс (a-full и a-100).
Note that the text includes the a- to mean that the listed speed and duplex values were autonegotiated.|Обратите внимание, что в тексте есть символ «-», означающий, что перечисленные значения скорости и дуплексного режима согласованы автоматически.
#### Configuring Multiple Interfaces with the interface range Command
Настройка нескольких интерфейсов с помощью команды interface range   
__|__
--|--
|
The bottom of the configuration in Example 7-1 shows a way to shorten your configuration work when making the same setting on multiple consecutive interfaces.|В нижней части конфигурации в примере 7-1 показан способ сократить вашу работу по настройке при выполнении одинаковых настроек для нескольких последовательных интерфейсов.
To do so, use the interface range command.|Для этого используйте команду interface range.
In the example, the interface range FastEthernet 0/11 - 20 command tells IOS that the next subcommand(s) apply to interfaces Fa0/11 through Fa0/20.|В этом примере команда interface range FastEthernet 0/11–20 сообщает IOS, что следующая подкоманда (-ы) применяется к интерфейсам с Fa0 / 11 по Fa0 / 20.
You can define a range as long as all interfaces are the same type and are numbered consecutively.|Вы можете определить диапазон, если все интерфейсы одного типа и пронумерованы последовательно.
|
NOTE This book spells out all parameters fully to avoid confusion.|ПРИМЕЧАНИЕ В этой книге полностью описаны все параметры, чтобы избежать путаницы.
However, most everyone abbreviates what they type in the CLI to the shortest unique abbreviation.|Однако почти все сокращают то, что они вводят в CLI, до самого короткого уникального сокращения.
For instance, the configuration commands int f0/1 and int ran f0/11 - 20 would also be acceptable.|Например, команды конфигурации int f0 / 1 и int ran f0 / 11-20 также будут приемлемы.
|
IOS does not actually put the interface range command into the configuration.|IOS фактически не помещает команду диапазона интерфейса в конфигурацию.
Instead, it acts as if you had typed the subcommand under every single interface in the specified Answers to the “Do I Know This Already?” quiz:|Вместо этого он действует так, как если бы вы ввели подкоманду под каждым интерфейсом в указанных ответах на вопрос «Знаю ли я это уже?» викторина:
|
1 F 2 E 3 A, D 4 A, B, D 5 A, D 6 D range.|1 F 2 E 3 A, D 4 A, B, D 5 A, D 6 D. Диапазон.
Example 7-3 shows an excerpt from the show running-config command, listing the configuration of interfaces F0/11–12 from the configuration in Example 7-1.|В примере 7-3 показан отрывок из команды show running-config, в котором перечислена конфигурация интерфейсов F0 / 11–12 из конфигурации в примере 7-1.
The example shows the same description command on both interfaces; to save space, the example does not bother to show all 10 interfaces that have the same description text.|В примере показана одна и та же команда описания для обоих интерфейсов; для экономии места в примере не показаны все 10 интерфейсов с одинаковым текстом описания.
|
Example 7-3 How IOS Expands the Subcommands Typed After interface range Example end.|Пример 7-3. Как IOS расширяет подкоманды, введенные после диапазона интерфейса. Пример end.
#### Administratively Controlling Interface State with shutdown
Административное управление состоянием интерфейса с выключением   
__|__
--|--
|
As you might imagine, network engineers need a way to bring down an interface without having to travel to the switch and remove a cable.|Как вы можете себе представить, сетевым инженерам нужен способ вывести из строя интерфейс, не прибегая к коммутатору и отсоединяя кабель.
In short, we need to be able to decide which ports should be enabled and which should be disabled.|Короче говоря, нам нужно решить, какие порты должны быть включены, а какие - отключены.
|
In an odd turn of phrase, Cisco uses two interface subcommands to configure the idea of administratively enabling and disabling an interface: the shutdown command (to disable) and the no shutdown command (to enable).|Как ни странно, Cisco использует две подкоманды интерфейса для настройки идеи административного включения и отключения интерфейса: команда shutdown (для отключения) и команда no shutdown (для включения).
While the no shutdown command might seem like an odd command to enable an interface at first, you will use this command a lot in the lab, and it will become second nature. (Most people, in fact, use the abbreviations shut and no shut.)|Хотя поначалу команда no shutdown может показаться странной командой для включения интерфейса, вы будете часто использовать эту команду в лаборатории, и она станет вашей второй натурой. (Фактически, большинство людей используют сокращения закрытый и не закрытый.)
|
Example 7-4 shows an example of disabling an interface using the shutdown interface subcommand.|В примере 7-4 показан пример отключения интерфейса с помощью подкоманды shutdown interface.
|
In this case, switch SW1 has a working interface F0/1.|В этом случае переключатель SW1 имеет рабочий интерфейс F0 / 1.
The user connects at the console and disables the interface.|Пользователь подключается к консоли и отключает интерфейс.
IOS generates a log message each time an interface fails or recovers, and log messages appear at the console, as shown in the example.|IOS генерирует сообщение журнала каждый раз, когда интерфейс выходит из строя или восстанавливается, и сообщения журнала появляются на консоли, как показано в примере.
|
Example 7-4 Administratively Disabling an Interface with shutdown Example end.|Пример 7-4 Административное отключение интерфейса с выключением Пример конец.
|
To bring the interface back up again, all you have to do is follow the same process but use the no shutdown command instead.|Чтобы снова запустить интерфейс, все, что вам нужно сделать, это выполнить тот же процесс, но вместо этого использовать команду no shutdown.
|
Before leaving the simple but oddly named shutdown/no shutdown commands, take a look at two important show commands that list the status of a shutdown interface.|Прежде чем оставить простые, но странно названные команды shutdown / no shutdown, взгляните на две важные команды show, в которых отображается статус интерфейса завершения работы.
The show interfaces status command lists one line of output per interface, and when shut down, lists the interface status as “disabled.” That makes logical sense to most people.|Команда show interfaces status перечисляет одну строку вывода для каждого интерфейса, а при выключении отображает состояние интерфейса как «отключено». Для большинства людей это имеет логический смысл.
The show interfaces command (without the status keyword) lists many lines of output per interface, giving a much more detailed picture of interface status and statistics.|Команда show interfaces (без ключевого слова status) перечисляет множество строк вывода для каждого интерфейса, давая гораздо более подробную картину состояния и статистики интерфейса.
With that command, the interface status comes in two parts, with one part using the phrase “administratively down,” matching the highlighted log message in Example 7-4.|С помощью этой команды состояние интерфейса состоит из двух частей, в одной части используется фраза «административно отключена», что соответствует выделенному сообщению журнала в примере 7-4.
|
Example 7-5 shows an example of each of these commands.|В примере 7-5 показан пример каждой из этих команд.
Note that both examples also use the F0/1 parameter (short for Fast Ethernet0/1), which limits the output to the messages about F0/1 only.|Обратите внимание, что в обоих примерах также используется параметр F0 / 1 (сокращение от Fast Ethernet0 / 1), который ограничивает вывод только сообщениями о F0 / 1.
Also note that F0/1 is still shut down at this point.|Также обратите внимание, что F0 / 1 все еще отключен в этот момент.
|
Example 7-5 The Different Status Information About Shutdown in Two Different show Example end.|Пример 7-5. Различная информация о состоянии выключения в двух разных вариантах.
#### Removing Configuration with the no Command
Удаление конфигурации с помощью команды no   
__|__
--|--
|
One purpose for the specific commands shown in Part II of the book is to teach you about that command.|Одна из целей конкретных команд, показанных во второй части книги, - научить вас этой команде.
In some cases, the commands are not the end goal, and the text is attempting to teach you something about how the CLI works.|В некоторых случаях команды не являются конечной целью, и текст пытается научить вас чему-то о том, как работает CLI.
This next short topic is more about the process than about the commands.|Следующая короткая тема больше о процессе, чем о командах.
|
With some IOS configuration commands (but not all), you can revert to the default setting by issuing a no version of the command.|С некоторыми командами конфигурации IOS (но не всеми) вы можете вернуться к настройкам по умолчанию, введя no версию команды.
What does that mean?|Что это значит?
Let me give you a few examples:|Приведу несколько примеров:
###### If you earlier had configured speed 100 on an interface, the no speed command on that
Если вы ранее настроили скорость 100 на интерфейсе, команда no speed на этом   
__|__
--|--
|
same interface reverts to the default speed setting (which happens to be speed auto).|тот же интерфейс возвращается к настройке скорости по умолчанию (которая оказывается автоматической).
###### Same idea with the duplex command: an earlier configuration of duplex half or duplex
Та же идея с командой дуплекса: более ранняя конфигурация дуплексного полу- или дуплексного режима   
__|__
--|--
|
full, followed by no duplex on the same interface, reverts the configuration back to the default of duplex auto.|полный, за которым следует отсутствие дуплекса на том же интерфейсе, возвращает конфигурацию обратно к автоматическому дуплексному режиму по умолчанию.
###### If you had configured a description command with some text, to go back to the default
Если вы настроили команду описания с некоторым текстом, чтобы вернуться к значениям по умолчанию   
__|__
--|--
|
state of having no description command at all for that interface, use the no description command.|состояние отсутствия команды описания для этого интерфейса, используйте команду no description.
|
Example 7-6 shows the process.|Пример 7-6 показывает процесс.
In this case, switch SW1’s F0/2 port has been configured with speed 100, duplex half, description link to 2901-2, and shutdown.|В этом случае порт F0 / 2 коммутатора SW1 настроен на скорость 100, полудуплексный режим, ссылку описания на 2901-2 и отключение.
You can see evidence of all four settings in the command that begins the example. (This command lists the running-config, but only the part for that one interface.) The example then shows the no versions of those commands and closes with a confirmation that all the commands have reverted to default.|Вы можете увидеть подтверждение всех четырех настроек в команде, с которой начинается пример. (Эта команда перечисляет рабочую конфигурацию, но только часть для этого интерфейса.) Затем пример показывает, что версии этих команд отсутствуют, и закрывается с подтверждением того, что все команды вернулись к значениям по умолчанию.
|
Example 7-6 Removing Various Configuration Settings Using the no Command Example end.|Пример 7-6 Удаление различных настроек конфигурации с помощью команды no Пример end.
|
NOTE The show running-config and show startup-config commands typically do not display default configuration settings, so the absence of commands listed under interface F0/2 at the end of the example means that those commands now use default values.|ПРИМЕЧАНИЕ. Команды show running-config и show startup-config обычно не отображают параметры конфигурации по умолчанию, поэтому отсутствие команд, перечисленных в интерфейсе F0 / 2 в конце примера, означает, что эти команды теперь используют значения по умолчанию.
#### Autonegotiation
Автосогласование   
__|__
--|--
|
For any 10/100 or 10/100/1000 interfaces—that is, interfaces that can run at different speeds—Cisco Catalyst switches default to a setting of duplex auto and speed auto.|Для любых интерфейсов 10/100 или 10/100/1000, т. Е. Интерфейсов, которые могут работать на разных скоростях, коммутаторы Cisco Catalyst по умолчанию используют автоматический дуплексный режим и автоматический режим скорости.
As a result, those interfaces attempt to automatically determine the speed and duplex setting to use.|В результате эти интерфейсы пытаются автоматически определить используемую скорость и настройку дуплекса.
Alternatively, you can configure most devices, switch interfaces included, to use a specific speed and/or duplex.|В качестве альтернативы вы можете настроить большинство устройств, включая интерфейсы коммутатора, на использование определенной скорости и / или дуплекса.
|
In practice, using autonegotiation is easy: just leave the speed and duplex at the default setting, and let the switch port negotiate what settings to use on each port.|На практике использовать автосогласование просто: просто оставьте скорость и дуплекс по умолчанию и позвольте порту коммутатора согласовать, какие настройки использовать для каждого порта.
However, problems can occur due to unfortunate combinations of configuration.|Однако проблемы могут возникнуть из-за неудачных комбинаций конфигурации.
Therefore, this next topic walks through more detail about the concepts behind autonegotiation, so you know better how to interpret the meaning of the switch show commands and when to choose to use a particular configuration setting.|Таким образом, в следующем разделе более подробно рассматриваются концепции автосогласования, чтобы вы лучше знали, как интерпретировать значение команд show switch и когда использовать тот или иной параметр конфигурации.
#### Autonegotiation Under Working Conditions
Автосогласование в рабочих условиях   
__|__
--|--
|
Ethernet devices on the ends of a link must use the same standard; otherwise, they cannot correctly send data.|Устройства Ethernet на концах канала должны использовать один и тот же стандарт; в противном случае они не смогут правильно отправить данные.
For example, a NIC cannot use 100BASE-T, which uses a two-pair UTP cable with a 100-Mbps speed, while the switch port on the other end of the link uses 1000BASE-T.|Например, сетевая карта не может использовать 100BASE-T, который использует двухпарный кабель UTP со скоростью 100 Мбит / с, в то время как порт коммутатора на другом конце канала использует 1000BASE-T.
Even if you used a cable that works with Gigabit Ethernet, the link would not work with one end trying to send at 100 Mbps while the other tried to receive the data at 1000 Mbps.|Даже если вы использовали кабель, который работает с Gigabit Ethernet, соединение не будет работать, если один конец будет пытаться отправить со скоростью 100 Мбит / с, а другой попытается получить данные со скоростью 1000 Мбит / с.
|
Upgrading to new and faster Ethernet standards becomes a problem because both ends have to use the same standard.|Обновление до новых и более быстрых стандартов Ethernet становится проблемой, потому что оба конца должны использовать один и тот же стандарт.
For example, if you replace an old PC with a new one, the old one might have been using 100BASE-T while the new one uses 1000BASE-T.|Например, если вы заменяете старый компьютер на новый, старый может использовать 100BASE-T, а новый - 1000BASE-T.
The switch port on the other end of the link needs to now use 1000BASE-T, so you upgrade the switch.|Порт коммутатора на другом конце канала должен теперь использовать 1000BASE-T, поэтому вы обновите коммутатор.
If that switch had ports that would use only 1000BASE-T, you would need to upgrade all the other PCs connected to the switch.|Если бы у этого коммутатора были порты, которые использовали бы только 1000BASE-T, вам необходимо было бы обновить все остальные ПК, подключенные к коммутатору.
So, having both PC network interface cards (NIC) and switch ports that support multiple standards/speeds makes it much easier to migrate to the next better standard.|Таким образом, наличие как сетевых карт (NIC) ПК, так и портов коммутатора, поддерживающих несколько стандартов / скоростей, значительно упрощает переход на следующий лучший стандарт.
|
The IEEE autonegotiation protocol helps makes it much easier to operate a LAN when NICs and switch ports support multiple speeds.|Протокол автосогласования IEEE помогает значительно упростить работу в локальной сети, когда сетевые адаптеры и порты коммутатора поддерживают несколько скоростей.
IEEE autonegotiation (IEEE standard 802.3u)|Автосогласование IEEE (стандарт IEEE 802.3u)
|
defines a protocol that lets the two UTP-based Ethernet nodes on a link negotiate so that they each choose to use the same speed and duplex settings.|определяет протокол, который позволяет двум узлам Ethernet на основе UTP на канале согласовывать свои действия, чтобы каждый из них мог использовать одну и ту же скорость и настройки дуплекса.
The protocol messages flow outside the normal Ethernet electrical frequencies as out-of-band signals over the UTP cable.|Сообщения протокола передаются за пределы обычных электрических частот Ethernet как внеполосные сигналы по кабелю UTP.
|
Basically, each node states what it can do, and then each node picks the best options that both nodes support: the fastest speed and the best duplex setting, with full duplex being better than half duplex.|По сути, каждый узел заявляет, что он может делать, а затем каждый узел выбирает лучшие варианты, которые поддерживают оба узла: максимальную скорость и лучшую настройку дуплекса, причем полный дуплекс лучше, чем полудуплекс.
|
NOTE Autonegotiation relies on the fact that the IEEE uses the same wiring pinouts for 10BASE-T and 100BASE-T, and that 1000BASE-T simply adds to those pinouts, adding two pairs.|ПРИМЕЧАНИЕ. Автосогласование основывается на том факте, что IEEE использует одинаковые выводы разводки для 10BASE-T и 100BASE-T, а 1000BASE-T просто добавляет к этим выводам, добавляя две пары.
|
Many networks use autonegotiation every day, particularly between user devices and the access layer LAN switches, as shown in Figure 7-1.|Многие сети используют автосогласование каждый день, особенно между пользовательскими устройствами и коммутаторами LAN уровня доступа, как показано на рисунке 7-1.
The company installed four-pair cabling of the right quality to support 1000BASE-T, to be ready to support Gigabit Ethernet.|Компания установила четырехпарный кабель надлежащего качества для поддержки 1000BASE-T, чтобы быть готовым к поддержке Gigabit Ethernet.
As a result, the wiring supports 10-Mbps, 100-Mbps, and 1000-Mbps Ethernet options.|В результате проводка поддерживает варианты Ethernet со скоростью 10, 100 и 1000 Мбит / с.
Both nodes on each link send autonegotiation messages to each other.|Оба узла на каждом канале отправляют друг другу сообщения автосогласования.
The switch in this case has all 10/100/1000 ports, while the PC NICs support different options.|Коммутатор в этом случае имеет все порты 10/100/1000, а сетевые адаптеры ПК поддерживают различные параметры.
|
Figure 7-1 IEEE Autonegotiation Results with Both Nodes Working Correctly The following list breaks down the logic, one PC at a time:|Рисунок 7-1 Результаты автосогласования IEEE при правильной работе обоих узлов В следующем списке представлена ​​логическая разбивка по одному ПК за раз:
|
PC1: The switch port claims it can go as fast as 1000 Mbps, but PC1’s NIC claims a top speed of 10 Mbps.|PC1: порт коммутатора утверждает, что он может работать со скоростью до 1000 Мбит / с, но сетевая карта PC1 утверждает, что максимальная скорость составляет 10 Мбит / с.
Both the PC and the switch choose the fastest speed that each supports (10 Mbps) and the best duplex that each supports (full).|И ПК, и коммутатор выбирают максимальную скорость, которую поддерживает каждый (10 Мбит / с), и лучший дуплекс, который поддерживает каждый (полный).
|
PC2: PC2 claims a best speed of 100 Mbps, which means it can use 10BASE-T or 100BASE-T.|PC2: PC2 заявляет о максимальной скорости 100 Мбит / с, что означает, что он может использовать 10BASE-T или 100BASE-T.
The switch port and NIC negotiate to use the best speed of 100 Mbps and full duplex.|Порт коммутатора и сетевая карта согласовывают использование максимальной скорости 100 Мбит / с и полного дуплекса.
|
PC3: It uses a 10/100/1000 NIC, supporting all three speeds and standards, so both the NIC and switch port choose 1000 Mbps and full duplex.|PC3: в нем используется сетевая карта 10/100/1000, поддерживающая все три скорости и стандарта, поэтому и сетевая карта, и порт коммутатора выбирают 1000 Мбит / с и полнодуплексный режим.
##### Autonegotiation Results When Only One Node Uses
Результаты автосогласования при использовании только одного узла   
__|__
--|--
|
Figure 7-1 shows the IEEE autonegotiation results when both nodes use the process.|На рисунке 7-1 показаны результаты автосогласования IEEE, когда оба узла используют процесс.
|
However, most Ethernet devices can disable autonegotiation, so it is just as important to know what happens when a node tries to use autonegotiation but the node gets no response.|Однако большинство устройств Ethernet могут отключить автосогласование, поэтому не менее важно знать, что происходит, когда узел пытается использовать автосогласование, но не получает ответа.
|
Disabling autonegotiation is not always a bad idea.|Отключение автосогласования - не всегда плохая идея.
For instance, many network engineers disable autonegotiation on links between switches and simply configure the desired speed and duplex on both switches.|Например, многие сетевые инженеры отключают автосогласование на каналах между коммутаторами и просто настраивают желаемую скорость и дуплекс на обоих коммутаторах.
However, mistakes can happen when one device on an Ethernet predefines speed and duplex (and disables autonegotiation), while the device on the other end attempts autonegotiation.|Однако ошибки могут произойти, когда одно устройство в сети Ethernet заранее определяет скорость и дуплекс (и отключает автосогласование), в то время как устройство на другом конце пытается выполнить автосогласование.
In that case, the link might not work at all, or it might just work poorly.|В этом случае ссылка может не работать вообще или просто работать плохо.
|
NOTE Configuring both the speed and duplex on a Cisco Catalyst switch interface disables autonegotiation.|ПРИМЕЧАНИЕ. Настройка скорости и дуплексного режима на интерфейсе коммутатора Cisco Catalyst отключает автосогласование.
|
IEEE autonegotiation defines some rules (defaults) that nodes should use as defaults when autonegotiation fails—that is, when a node tries to use autonegotiation but hears nothing from the device.|Автосогласование IEEE определяет некоторые правила (значения по умолчанию), которые узлы должны использовать по умолчанию, когда автосогласование не удается, то есть когда узел пытается использовать автосогласование, но ничего не слышит от устройства.
The rules:|Правила:
###### Speed: Use your slowest supported speed (often 10 Mbps).
Скорость: используйте самую низкую из поддерживаемых скоростей (часто 10 Мбит / с).   
###### Duplex: If your speed = 10 or 100, use half duplex; otherwise, use full duplex.
Дуплекс: если ваша скорость = 10 или 100, используйте полудуплекс; в противном случае используйте полный дуплекс.   
__|__
--|--
|
Cisco switches can make a better choice than that base IEEE speed default because Cisco switches can actually sense the speed used by other nodes, even without IEEE autonegotiation.|Коммутаторы Cisco могут сделать лучший выбор, чем базовая скорость по умолчанию IEEE, поскольку коммутаторы Cisco действительно могут определять скорость, используемую другими узлами, даже без автосогласования IEEE.
|
As a result, Cisco switches use this slightly different logic to choose the speed when autonegotiation fails:|В результате коммутаторы Cisco используют эту несколько иную логику для выбора скорости при сбое автосогласования:
###### Speed: Sense the speed (without using autonegotiation), but if that fails, use the IEEE
Скорость: определите скорость (без использования автосогласования), но если это не удается, используйте IEEE   
__|__
--|--
|
default (slowest supported speed, often 10 Mbps).|по умолчанию (самая низкая поддерживаемая скорость, часто 10 Мбит / с).
###### Duplex: Use the IEEE defaults: If speed = 10 or 100, use half duplex; otherwise, use full
Дуплекс: используйте значения по умолчанию IEEE: если скорость = 10 или 100, используйте полудуплекс; в противном случае используйте полный   
__|__
--|--
|
duplex.|дуплекс.
|
NOTE Ethernet interfaces using speeds faster than 1 Gbps always use full duplex.|ПРИМЕЧАНИЕ Интерфейсы Ethernet, использующие скорости выше 1 Гбит / с, всегда используют полнодуплексный режим.
|
Figure 7-2 shows three examples in which three users change their NIC settings and disable autonegotiation, while the switch (with all 10/100/1000 ports) attempts autonegotiation.|На рис. 7-2 показаны три примера, в которых три пользователя изменяют настройки своей сетевой карты и отключают автосогласование, в то время как коммутатор (со всеми портами 10/100/1000) пытается выполнить автосогласование.
|
That is, the switch ports all default to speed auto and duplex auto.|То есть все порты коммутатора по умолчанию работают в автоматическом режиме и в дуплексном режиме.
The top of the figure shows the configured settings on each PC NIC, with the choices made by the switch listed next to each switch port.|В верхней части рисунка показаны сконфигурированные параметры для каждой сетевой карты ПК, причем варианты, сделанные коммутатором, перечислены рядом с каждым портом коммутатора.
|
Figure 7-2 IEEE Autonegotiation Results with Autonegotiation Disabled on One Side Reviewing each link, left to right:|Рисунок 7-2 Результаты автосогласования IEEE с отключенным автосогласованием на одной стороне Просмотр каждой ссылки слева направо:
###### PC1: The switch receives no autonegotiation messages, so it senses the electrical signal
ПК1: коммутатор не получает сообщений автосогласования, поэтому он воспринимает электрический сигнал.   
__|__
--|--
|
to learn that PC1 is sending data at 100 Mbps.|чтобы узнать, что ПК1 отправляет данные со скоростью 100 Мбит / с.
The switch uses the IEEE default duplex based on the 100 Mbps speed (half duplex).|Коммутатор использует дуплексный режим по умолчанию IEEE на основе скорости 100 Мбит / с (полудуплекс).
###### PC2: The switch uses the same steps and logic as with the link to PC1, except that the
ПК2: коммутатор использует те же шаги и логику, что и связь с ПК1, за исключением того, что   
__|__
--|--
|
switch chooses to use full duplex because the speed is 1000 Mbps.|Коммутатор выбирает полный дуплекс, потому что скорость составляет 1000 Мбит / с.
###### PC3: The user picks poorly, choosing the slower speed (10 Mbps) and the worse duplex
PC3: пользователь плохо выбирает, выбирая меньшую скорость (10 Мбит / с) и худший дуплекс   
__|__
--|--
|
setting (half).|установка (половина).
However, the Cisco switch senses the speed without using IEEE autonegotiation and then uses the IEEE duplex default for 10-Mbps links (half duplex).|Однако коммутатор Cisco определяет скорость без использования автосогласования IEEE, а затем использует дуплексный режим IEEE по умолчанию для каналов со скоростью 10 Мбит / с (полудуплекс).
|
PC1 shows a classic and unfortunately common end result: a duplex mismatch.|PC1 показывает классический и, к сожалению, общий конечный результат: несовпадение дуплексных параметров.
The two nodes (PC1 and SW1’s port G0/1) both use 100 Mbps, so they can send data.|Оба узла (ПК1 и порт G0 / 1 SW1) оба используют 100 Мбит / с, поэтому они могут отправлять данные.
However, PC1, using full duplex, does not attempt to use carrier sense multiple access with collision detection (CSMA/CD) logic and sends frames at any time.|Однако ПК1, использующий полнодуплексный режим, не пытается использовать множественный доступ с контролем несущей и логикой обнаружения коллизий (CSMA / CD) и отправляет кадры в любое время.
Switch port F0/1, with half duplex, does use CSMA/CD. As a result, switch port F0/1 will believe collisions occur on the link, even if none physically occur.|Порт коммутатора F0 / 1 с полудуплексным режимом использует CSMA / CD. В результате порт коммутатора F0 / 1 будет считать, что на канале возникают конфликты, даже если их не происходит физически.
The switch port will stop transmitting, back off, resend frames, and so on.|Порт коммутатора прекратит передачу, отключается, повторно отправляет кадры и т. Д.
As a result, the link is up, but it performs poorly.|В результате канал работает, но работает плохо.
The upcoming section titled “Interface Speed and Duplex Issues” will revisit this problem with a focus on how to recognize the symptoms of a duplex mismatch.|В следующем разделе, озаглавленном «Проблемы со скоростью интерфейса и дуплексным режимом», мы еще раз рассмотрим эту проблему с упором на то, как распознать симптомы несоответствия дуплексного режима.
##### Autonegotiation and LAN Hubs
Автосогласование и концентраторы LAN   
__|__
--|--
|
LAN hubs also impact how autonegotiation works.|Концентраторы LAN также влияют на работу автосогласования.
Basically, hubs do not react to autonegotiation messages, and they do not forward the messages.|По сути, концентраторы не реагируют на сообщения автосогласования и не пересылают сообщения.
As a result, devices connected to a hub must use the IEEE rules for choosing default settings, which often results in the devices using 10 Mbps and half duplex.|В результате устройства, подключенные к концентратору, должны использовать правила IEEE для выбора настроек по умолчанию, что часто приводит к тому, что устройства используют 10 Мбит / с и полудуплекс.
|
Figure 7-3 shows an example of a small Ethernet LAN that uses a 20-year-old 10BASE-T hub.|На рис. 7-3 показан пример небольшой локальной сети Ethernet, в которой используется концентратор 10BASE-T 20-летней давности.
In this LAN, all devices and switch ports are 10/100/1000 ports.|В этой локальной сети все устройства и порты коммутатора являются портами 10/100/1000.
The hub supports only 10BASE-T.|Концентратор поддерживает только 10BASE-T.
|
Figure 7-3 IEEE Autonegotiation with a LAN Hub Note that the devices on the right need to use half duplex because the hub requires the use of the CSMA/CD algorithm to avoid collisions.|Рис. 7-3. Автосогласование IEEE с концентратором LAN Обратите внимание, что устройства справа должны использовать полудуплекс, потому что концентратор требует использования алгоритма CSMA / CD, чтобы избежать коллизий.
|
NOTE If you would like to learn more about collision domains and the impact of these older LAN hubs, look to the companion website for Appendix K, “Analyzing Ethernet LAN Designs,” to the section titled “Ethernet Collision Domains.”|ПРИМЕЧАНИЕ. Если вы хотите узнать больше о доменах коллизий и влиянии этих старых концентраторов LAN, загляните на сопутствующий веб-сайт, где вы найдете Приложение K, «Анализ схем локальной сети Ethernet», к разделу «Домены коллизий Ethernet».
### Analyzing Switch Interface Status and Statistics
Анализ состояния и статистики интерфейса коммутатора   
__|__
--|--
|
Now that you have seen some of the ways to configure switch interfaces, the rest of the chapter takes a closer look at how to verify the interfaces work correctly.|Теперь, когда вы ознакомились с некоторыми способами настройки интерфейсов коммутатора, в оставшейся части главы более подробно рассматривается, как проверить правильность работы интерфейсов.
This section also looks at those more unusual cases in which the interface is working but not working well, as revealed by different interface status codes and statistics.|В этом разделе также рассматриваются более необычные случаи, когда интерфейс работает, но не работает должным образом, о чем свидетельствуют различные коды состояния интерфейса и статистика.
#### Interface Status Codes and Reasons for Nonworking States
Коды состояния интерфейса и причины нерабочего состояния   
__|__
--|--
|
Cisco switches actually use two different sets of interface status codes—one set of two codes (words) that use the same conventions as do router interface status codes, and another set with a single code (word).|Коммутаторы Cisco фактически используют два разных набора кодов состояния интерфейса: один набор из двух кодов (слов), которые используют те же соглашения, что и коды состояния интерфейса маршрутизатора, а другой набор с одним кодом (словом).
Both sets of status codes can determine whether an interface is working.|Оба набора кодов состояния могут определять, работает ли интерфейс.
|
The switch show interfaces and show interfaces description commands list the two-code status named the line status and protocol status.|Команды switch show interfaces и show interfaces description перечисляют состояние с двумя кодами, называемое состоянием линии и состоянием протокола.
The line status generally refers to whether Layer 1 is working, with protocol status generally referring to whether Layer 2 is working.|Статус линии обычно указывает, работает ли уровень 1, а статус протокола обычно указывает, работает ли уровень 2.
|
NOTE This book refers to these two status codes in shorthand by just listing the two codes with a slash between them, such as up/up.|ПРИМЕЧАНИЕ В этой книге эти два кода состояния обозначаются сокращенно, просто перечисляя два кода с косой чертой между ними, например, вверх / вверх.
|
The single-code interface status corresponds to different combinations of the traditional two-code interface status codes and can be easily correlated to those codes.|Состояние однокодового интерфейса соответствует различным комбинациям традиционных кодов состояния двухкодового интерфейса и может быть легко сопоставлено с этими кодами.
For example, the show interfaces status command lists a single-word state of connected state for working interfaces, with the same meaning as the two-word up/up state seen with the show interfaces and show interfaces description commands.|Например, команда show interfaces status перечисляет состояние подключения из одного слова для рабочих интерфейсов с тем же значением, что и состояние подключения из двух слов, наблюдаемое с командами show interfaces и show interfaces description.
Table 7-2 lists the code combinations and some root causes that could have caused a particular interface status.|В таблице 7-2 перечислены кодовые комбинации и некоторые основные причины, которые могли вызвать определенное состояние интерфейса.
|
Table 7-2 LAN Switch Interface Status Codes Table end.|Таблица 7-2 Коды состояния интерфейса коммутатора LAN Конец таблицы.
|
Examining the notconnect state for a moment, note that this state has many causes that have been mentioned through this book.|Рассматривая на мгновение состояние отсутствия соединения, обратите внимание, что у этого состояния много причин, упомянутых в этой книге.
For example, using incorrect cabling pinouts, instead of the correct pinouts explained in Chapter 2, “Fundamentals of Ethernet LANs,” causes a problem.|Например, использование неправильных выводов кабелей вместо правильных выводов, описанных в главе 2 «Основы локальных сетей Ethernet», вызывает проблему.
However, one topic can be particularly difficult to troubleshoot—the possibility for both speed and duplex mismatches, as explained in the next section.|Однако одна тема может быть особенно сложной для устранения неполадок - возможность несовпадения скорости и дуплексного режима, как объясняется в следующем разделе.
|
As you can see in the table, having a bad cable is just one of many reasons for the down/down state (or notconnect, per the show interfaces status command).|Как вы можете видеть в таблице, плохой кабель - это лишь одна из многих причин неработающего / неработающего состояния (или отсутствия соединения согласно команде show interfaces status).
Some examples of the root causes of cabling problems include the following:|Вот некоторые примеры основных причин проблем с кабелями:
###### The installation of any equipment that uses electricity, even non-IT equipment, can interfere
Установка любого оборудования, которое использует электричество, даже не ИТ-оборудования, может помешать   
__|__
--|--
|
with the transmission on the cabling and make the link fail.|с передачей по кабелю и отключите связь.
###### The cable could be damaged, for example, if it lies under carpet. If the user’s chair keeps
Кабель может быть поврежден, например, если он пролегает под ковром. Если стул пользователя остается   
__|__
--|--
|
squashing the cable, eventually the electrical signal can degrade.|сдавливание кабеля может привести к ухудшению электрического сигнала.
###### Although optical cables do not suffer from electromagnetic interference (EMI), someone
Хотя оптические кабели не страдают от электромагнитных помех (EMI), кто-то   
__|__
--|--
|
can try to be helpful and move a fiber-optic cable out of the way—bending it too much.|может попытаться помочь и убрать с пути оптоволоконный кабель - слишком сильно его согнуть.
|
A bend into too tight a shape can prevent the cable from transmitting bits (called macrobending).|Слишком плотный изгиб может помешать кабелю передавать биты (это называется макроизгибом).
|
For the other interface states listed in Table 7-2, only the up/up (connected) state needs more discussion.|Для других состояний интерфейса, перечисленных в Таблице 7-2, более подробного обсуждения требует только состояние "включено" / "включено".
An interface can be in a working state, and it might really be working—or it might be working in a degraded state.|Интерфейс может быть в рабочем состоянии, и он может действительно работать - или он может работать в ухудшенном состоянии.
The next few topics discuss how to examine an up/up (connected) interface to find out whether it is working well or having problems.|В следующих нескольких темах обсуждается, как проверить подключенный интерфейс, чтобы выяснить, хорошо ли он работает или есть проблемы.
#### Interface Speed and Duplex Issues
Скорость интерфейса и проблемы с дуплексом   
__|__
--|--
|
To discuss some of the speed and duplex issues, first consider the output from the show interfaces status and show interfaces commands as demonstrated in Example 7-7.|Чтобы обсудить некоторые проблемы скорости и дуплекса, сначала рассмотрим выходные данные команд show interfaces status и show interfaces, как показано в Примере 7-7.
The first of these commands lists a one-line summary of the interface status, while the second command gives many details—but surprisingly, the briefer show interfaces status command tells us more about autonegotiation.|Первая из этих команд перечисляет однострочную сводку состояния интерфейса, а вторая дает много деталей - но, что удивительно, более короткая команда show interfaces status сообщает нам больше об автосогласовании.
|
Example 7-7 Displaying Speed and Duplex Settings on Switch Interfaces Example end.|Пример 7-7 Отображение настроек скорости и дуплексного режима на интерфейсах коммутатора Конец примера.
|
Although both commands in the example can be useful, only the show interfaces status command implies how the switch determined the speed and duplex settings.|Хотя обе команды в примере могут быть полезны, только команда show interfaces status показывает, как коммутатор определил скорость и параметры дуплекса.
The command output lists autonegotiated settings with a prefix of a- and the manually set values without the a- prefix.|В выходных данных команды перечислены параметры автосогласования с префиксом a- и значения, установленные вручную без префикса a-.
|
For example, consider ports Fa0/12 and Fa0/13 in the output of the show interfaces status command.|Например, рассмотрите порты Fa0 / 12 и Fa0 / 13 в выходных данных команды show interfaces status.
For Fa0/13, a-full means full duplex as autonegotiated, whereas half on Fa0/12 means half duplex but as manually configured.|Для Fa0 / 13 полный означает полный дуплекс с автосогласованием, тогда как половина в Fa0 / 12 означает полудуплекс, но настроенный вручную.
The example shades the command output that implies that the switch’s Fa0/12 interface’s speed and duplex were not found through autonegotiation, but Fa0/13 did use autonegotiation.|В примере затемнен вывод команды, который подразумевает, что скорость и дуплексный режим интерфейса Fa0 / 12 коммутатора не были обнаружены посредством автосогласования, но Fa0 / 13 действительно использовал автосогласование.
|
In comparison, note that the show interfaces fa0/13 command (without the status option)|Для сравнения обратите внимание, что команда show interfaces fa0 / 13 (без параметра состояния)
|
simply lists the speed and duplex for interface Fast Ethernet 0/13, with nothing implying that the values were learned through autonegotiation.|просто перечисляет скорость и дуплекс для интерфейса Fast Ethernet 0/13, при этом ничего не подразумевает, что значения были получены посредством автосогласования.
|
When the IEEE autonegotiation process works on both devices—that is, both are sending autonegotiation messages—both devices agree to the fastest speed and best duplex supported by both devices.|Когда процесс автосогласования IEEE работает на обоих устройствах, то есть оба отправляют сообщения автосогласования, оба устройства соглашаются на максимальную скорость и лучший дуплекс, поддерживаемые обоими устройствами.
However, when one device uses autonegotiation and the other disables it, the first device must resort to default settings as detailed earlier in section “Autonegotiation Results When Only One Node Uses Autonegotiation.” As a reminder, those defaults are|Однако, когда одно устройство использует автосогласование, а другое отключает его, первое устройство должно прибегнуть к настройкам по умолчанию, как подробно описано ранее в разделе «Результаты автосогласования, когда только один узел использует автосогласование». Напоминаем, что по умолчанию
###### Speed: Sense the speed (without using autonegotiation), but if that fails, use the IEEE
Скорость: определите скорость (без использования автосогласования), но если это не удается, используйте IEEE   
__|__
--|--
|
default (slowest supported speed, often 10 Mbps).|по умолчанию (самая низкая поддерживаемая скорость, часто 10 Мбит / с).
###### Duplex: Use the IEEE defaults: If speed = 10 or 100, use half duplex; otherwise, use full
Дуплекс: используйте значения по умолчанию IEEE: если скорость = 10 или 100, используйте полудуплекс; в противном случае используйте полный   
__|__
--|--
|
duplex.|дуплекс.
|
When a switch must use its defaults, it should get the speed correct, but it may choose the wrong duplex setting, creating a duplex mismatch.|Когда коммутатор должен использовать свои настройки по умолчанию, он должен получить правильную скорость, но он может выбрать неправильную настройку дуплекса, создавая несоответствие дуплексного режима.
|
For example, in Figure 7-4, imagine that SW2’s Gi0/2 interface was configured with the speed 100 and duplex full commands (these settings are not recommended on a Gigabitcapable interface, by the way).|Например, на рис. 7-4 представьте, что интерфейс Gi0 / 2 SW2 был настроен на скорость 100 и дуплексные полные команды (кстати, эти настройки не рекомендуются для интерфейса с гигабитным интерфейсом).
On Cisco switches, configuring both the speed and duplex commands disables IEEE autonegotiation on that port.|На коммутаторах Cisco настройка команд скорости и дуплекса отключает автосогласование IEEE для этого порта.
If SW1’s Gi0/1 interface tries to use autonegotiation, SW1 would also use a speed of 100 Mbps, but default to use half duplex.|Если интерфейс Gi0 / 1 SW1 пытается использовать автосогласование, SW1 также будет использовать скорость 100 Мбит / с, но по умолчанию будет использовать полудуплекс.
|
Example 7-8 shows the results of this specific case on SW1.|В примере 7-8 показаны результаты этого конкретного случая на SW1.
|
Figure 7-4 Conditions to Create a Duplex Mismatch Between SW1 and SW2 Example 7-8 Confirming Duplex Mismatch on Switch SW1 Example end.|Рисунок 7-4 Условия для создания дуплексного несоответствия между SW1 и SW2 Пример 7-8 Подтверждение дуплексного несоответствия на переключателе SW1 Пример окончен.
|
First, note that even though SW1 had to use an autonegotiation default, the show interfaces status command still shows the speed and duplex with the a- prefix.|Во-первых, обратите внимание, что хотя SW1 должен был использовать по умолчанию автосогласование, команда show interfaces status все еще показывает скорость и дуплекс с префиксом a-.
SW2’s port was manually set to 100/Full, so SW1 sensed the speed and runs at 100 Mbps; however, the autonegotiation rules then tell SW1 to use half duplex, as confirmed by the output in Example 7-8.|Порт SW2 был вручную установлен на 100 / Full, поэтому SW1 определил скорость и работал со скоростью 100 Мбит / с; однако правила автосогласования затем указывают SW1 использовать полудуплекс, что подтверждается выходными данными в примере 7-8.
|
The output does not identify the duplex mismatch in any way; in fact, finding a duplex mismatch can be much more difficult than finding a speed mismatch.|Выходные данные никоим образом не определяют несоответствие дуплексного режима; Фактически, обнаружение несоответствия дуплексных параметров может быть намного сложнее, чем обнаружение несоответствия скорости.
For instance, if you purposefully set the speed on the link in Figure 7-4 to be 10 Mbps on one switch and 100 Mbps on the other, both switches would list the port in a down/down or notconnect state.|Например, если вы целенаправленно установите скорость канала на рисунке 7-4, равную 10 Мбит / с на одном коммутаторе и 100 Мбит / с на другом, оба коммутатора будут указывать порт в состоянии неработающего / неактивного или неподключенного состояния.
|
However, in the case shown in Example 7-8, with a duplex mismatch, if the duplex settings do not match on the ends of an Ethernet segment, the switch interface will still be in a connected (up/up) or connected state.|Однако в случае, показанном в Примере 7-8, с несоответствием дуплексного режима, если настройки дуплекса не совпадают на концах сегмента Ethernet, интерфейс коммутатора все равно будет находиться в подключенном (вверх / вверх) или подключенном состоянии.
|
Not only does the show command give an appearance that the link has no issues, but the link will likely work poorly, with symptoms of intermittent problems.|Команда show не только создает видимость того, что ссылка не имеет проблем, но она, скорее всего, будет работать плохо с признаками периодических проблем.
The reason is that the device using half duplex (SW1 in this case) uses carrier sense multiple access collision detect (CSMA/CD) logic, waiting to send when receiving a frame, believing collisions occur when they physically do not—and actually stopping sending a frame because the switch thinks a collision occurred.|Причина в том, что устройство, использующее полудуплекс (в данном случае SW1), использует логику обнаружения коллизий множественного доступа с контролем несущей (CSMA / CD), ожидая отправки при получении кадра, полагая, что коллизии возникают, когда их физически не происходит, и фактически прекращает отправку. кадр, потому что коммутатор считает, что произошло столкновение.
With enough traffic load, the interface could be in a connect state, but it’s extremely inefficient for passing traffic.|При достаточной загрузке трафика интерфейс может находиться в состоянии подключения, но он крайне неэффективен для передачи трафика.
|
To identify duplex mismatch problems, check the duplex setting on each end of the link to see if the values mismatch.|Чтобы определить проблемы несоответствия дуплексного режима, проверьте настройки дуплексного режима на каждом конце ссылки, чтобы увидеть, не совпадают ли значения.
You can also watch for incrementing collision and late collision counters, as explained in the next section.|Вы также можете следить за увеличением счетчиков столкновений и поздних столкновений, как описано в следующем разделе.
#### Common Layer 1 Problems on Working Interfaces
Распространенные проблемы уровня 1 на рабочих интерфейсах   
__|__
--|--
|
When the interface reaches the connect (up/up) state, the switch considers the interface to be working.|Когда интерфейс достигает состояния подключения (up / up), коммутатор считает, что интерфейс работает.
The switch, of course, tries to use the interface, and at the same time, the switch keeps various interface counters.|Коммутатор, конечно, пытается использовать интерфейс, и в то же время коммутатор поддерживает различные счетчики интерфейса.
These interface counters can help identify problems that can occur even though the interface is in a connect state, like issues related to the duplex mismatch problem that was just described.|Эти счетчики интерфейса могут помочь выявить проблемы, которые могут возникнуть, даже если интерфейс находится в состоянии подключения, например проблемы, связанные с проблемой несоответствия дуплексного режима, которая была только что описана.
This section explains some of the related concepts and a few of the most common problems.|В этом разделе объясняются некоторые связанные концепции и некоторые из наиболее распространенных проблем.
|
Whenever the physical transmission has problems, the receiving device might receive a frame whose bits have changed values.|Если при физической передаче возникают проблемы, принимающее устройство может получить кадр, биты которого изменили значения.
These frames do not pass the error detection logic as implemented in the FCS field in the Ethernet trailer, as covered in Chapter 2.|Эти кадры не проходят логику обнаружения ошибок, реализованную в поле FCS в трейлере Ethernet, как описано в главе 2.
The receiving device discards the frame and counts it as some kind of input error.|Принимающее устройство отбрасывает фрейм и считает его ошибкой ввода.
Cisco switches list this error as a CRC error, as highlighted in Example 7-9. (Cyclic redundancy check [CRC] is a term related to how the frame check sequence [FCS] math detects an error.)|Коммутаторы Cisco перечисляют эту ошибку как ошибку CRC, как показано в Примере 7-9. (Циклический контроль избыточности [CRC] - это термин, связанный с тем, как математическая последовательность проверки кадра [FCS] обнаруживает ошибку.)
|
Example 7-9 Interface Counters for Layer 1 Problems Example end.|Пример 7-9 Интерфейсные счетчики для проблем уровня 1 Пример конец.
|
The number of input errors and the number of CRC errors are just a few of the counters in the output of the show interfaces command.|Количество ошибок ввода и количество ошибок CRC - это лишь некоторые из счетчиков в выходных данных команды show interfaces.
The challenge is to decide which counters you need to think about, which ones show that a problem is happening, and which ones are normal and of no concern.|Задача состоит в том, чтобы решить, о каких счетчиках вам следует подумать, какие из них показывают, что проблема возникает, а какие являются нормальными и не вызывают беспокойства.
|
The example highlights several of the counters as examples so that you can start to understand which ones point to problems and which ones are just counting normal events that are not problems.|В примере выделено несколько счетчиков в качестве примеров, чтобы вы могли начать понимать, какие из них указывают на проблемы, а какие просто подсчитывают нормальные события, которые не являются проблемами.
The following list shows a short description of each highlighted counter, in the order shown in the example:|В следующем списке показано краткое описание каждого выделенного счетчика в порядке, показанном в примере:
|
Runts: Frames that did not meet the minimum frame size requirement (64 bytes, including the 18-byte destination MAC, source MAC, type, and FCS). Can be caused by collisions.|Рунты: кадры, которые не соответствуют требованиям к минимальному размеру кадра (64 байта, включая 18-байтовый MAC-адрес назначения, исходный MAC-адрес, тип и FCS). Может быть вызвано столкновениями.
|
Giants: Frames that exceed the maximum frame size requirement (1518 bytes, including the 18-byte destination MAC, source MAC, type, and FCS).|Giants: кадры, превышающие требования к максимальному размеру кадра (1518 байтов, включая 18-байтовый MAC-адрес назначения, исходный MAC-адрес, тип и FCS).
|
Input Errors: A total of many counters, including runts, giants, no buffer, CRC, frame, overrun, and ignored counts.|Ошибки ввода: всего много счетчиков, включая ранты, гиганты, отсутствие буфера, CRC, фрейм, переполнение и проигнорированные счетчики.
|
CRC: Received frames that did not pass the FCS math; can be caused by collisions.|CRC: полученные кадры, которые не прошли математику FCS; могут быть вызваны столкновениями.
|
Frame: Received frames that have an illegal format, for example, ending with a partial byte; can be caused by collisions.|Кадр: принятые кадры с недопустимым форматом, например, заканчивающиеся неполным байтом; могут быть вызваны столкновениями.
|
Packets Output: Total number of packets (frames) forwarded out the interface.|Вывод пакетов: общее количество пакетов (кадров), отправленных через интерфейс.
|
Output Errors: Total number of packets (frames) that the switch port tried to transmit, but for which some problem occurred.|Ошибки вывода: общее количество пакетов (кадров), которые порт коммутатора пытался передать, но для которых возникла проблема.
|
Collisions: Counter of all collisions that occur when the interface is transmitting a frame.|Коллизии: счетчик всех коллизий, возникающих при передаче кадра интерфейсом.
|
Late Collisions: The subset of all collisions that happen after the 64th byte of the frame has been transmitted. (In a properly working Ethernet LAN, collisions should occur within the first 64 bytes; late collisions today often point to a duplex mismatch.)|Поздние коллизии: подмножество всех коллизий, которые происходят после передачи 64-го байта кадра. (В правильно работающей локальной сети Ethernet коллизии должны происходить в пределах первых 64 байтов; поздние коллизии сегодня часто указывают на несоответствие дуплексного режима.)
|
Note that many of these counters occur as part of the CSMA/CD process used when half duplex is enabled.|Обратите внимание, что многие из этих счетчиков возникают как часть процесса CSMA / CD, используемого при включении полудуплекса.
Collisions occur as a normal part of the half-duplex logic imposed by CSMA/CD, so a switch interface with an increasing collisions counter might not even have a problem.|Коллизии возникают как нормальная часть полудуплексной логики, налагаемой CSMA / CD, поэтому интерфейс коммутатора с увеличивающимся счетчиком коллизий может даже не иметь проблем.
However, one problem, called late collisions, points to the classic duplex mismatch problem.|Однако одна проблема, называемая поздними коллизиями, указывает на классическую проблему несоответствия дуплексного режима.
|
If a LAN design follows cabling guidelines, all collisions should occur by the end of the 64th byte of any frame.|Если при проектировании ЛВС соблюдаются рекомендации по прокладке кабелей, все конфликты должны происходить к концу 64-го байта любого кадра.
When a switch has already sent 64 bytes of a frame, and the switch receives a frame on that same interface, the switch senses a collision.|Когда коммутатор уже отправил 64 байта кадра, и коммутатор получает кадр на том же интерфейсе, коммутатор обнаруживает коллизию.
In this case, the collision is a late collision, and the switch increments the late collision counter in addition to the usual CSMA/CD actions to send a jam signal, wait a random time, and try again.|В этом случае коллизия является поздней коллизией, и коммутатор увеличивает счетчик поздних коллизий в дополнение к обычным действиям CSMA / CD для отправки сигнала блокировки, ожидания случайного времени и повторной попытки.
|
With a duplex mismatch, like the mismatch between SW1 and SW2 in Figure 7-4, the halfduplex interface will likely see the late collisions counter increment.|При несовпадении дуплексного режима, таком как несоответствие между SW1 и SW2 на рис. 7-4, полудуплексный интерфейс, вероятно, увидит приращение счетчика поздних коллизий.
Why?|Зачем?
The half-duplex interface sends a frame (SW1), but the full-duplex neighbor (SW2) sends at any time, even after the 64th byte of the frame sent by the half-duplex switch.|Полудуплексный интерфейс отправляет кадр (SW1), но полнодуплексный сосед (SW2) отправляет в любое время, даже после 64-го байта кадра, отправленного полудуплексным коммутатором.
So, just keep repeating the show interfaces command, and if you see the late collisions counter incrementing on a halfduplex interface, you might have a duplex mismatch problem.|Итак, просто продолжайте повторять команду show interfaces, и если вы видите, что счетчик поздних столкновений увеличивается на полудуплексном интерфейсе, у вас может быть проблема несоответствия дуплексного режима.
|
A working interface (in an up/up state) can still suffer from issues related to the physical cabling as well.|Рабочий интерфейс (в активном / активном состоянии) все еще может страдать от проблем, связанных с физической кабельной разводкой.
The cabling problems might not be bad enough to cause a complete failure, but the transmission failures result in some frames failing to pass successfully over the cable.|Проблемы с кабелем могут быть недостаточно серьезными, чтобы вызвать полный отказ, но сбои передачи приводят к тому, что некоторые кадры не могут успешно пройти по кабелю.
|
For example, excessive interference on the cable can cause the various input error counters to keep growing larger, especially the CRC counter.|Например, чрезмерные помехи в кабеле могут привести к увеличению различных счетчиков ошибок ввода, особенно счетчика CRC.
In particular, if the CRC errors grow, but the collisions counters do not, the problem might simply be interference on the cable. (The switch counts each collided frame as one form of input error as well.)|В частности, если ошибки CRC растут, а счетчики коллизий - нет, проблема может заключаться в помехах в кабеле. (Коммутатор также считает каждый столкнувшийся кадр как одну из форм ошибки ввода.)
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element section titled “Step 2: Build Your Study Habits Around the Chapter” for more details.|Обратитесь к разделу элемента «Ваш учебный план», озаглавленному «Шаг 2: выработайте учебу вокруг главы» для получения более подробной информации.
Table 7-3 outlines the key review elements and where you can find them.|В Таблице 7-3 представлены основные элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 7-3 Chapter Review Tracking Table end.|Таблица 7-3 Окончание таблицы отслеживания обзора главы.
|
Review All the Key Topics Key Terms You Should Know port security, autonegotiation, full duplex, half duplex, 10/100, 10/100/1000 Do Labs The Sim Lite software is a version of Pearson’s full simulator learning product with a subset of the labs, included free with this book.|Ознакомьтесь со всеми ключевыми темами. Ключевые термины, которые вы должны знать. Безопасность портов, автосогласование, полный дуплекс, полудуплекс, 10/100, 10/100/1000. Выполните лабораторные работы. Программное обеспечение Sim Lite - это версия продукта для обучения на полном симуляторе Pearson с подмножеством лаборатории, бесплатно включенные в эту книгу.
The subnet of labs mostly relate to this part.|Подсеть лабораторий в основном относится к этой части.
Take the time to try some of the labs.|Найдите время, чтобы попробовать некоторые из лабораторных работ.
As always, also check the author’s blog site pages for configuration exercises (Config Labs) at https://blog.certskills.com.|Как всегда, также проверьте страницы блога автора на предмет упражнений по настройке (Лаборатория конфигурирования) по адресу https://blog.certskills.com.
|
Command References Tables 7-5 and 7-6 list configuration and verification commands used in this chapter.|Ссылки на команды В таблицах 7-5 и 7-6 перечислены команды настройки и проверки, используемые в этой главе.
As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.|В качестве простого упражнения на повторение закройте левый столбец таблицы, прочтите правый столбец и попытайтесь вспомнить команду, не глядя.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Затем повторите упражнение, охватывая правый столбец, и попытайтесь вспомнить, что делает команда.
|
Table 7-5 Switch Interface Configuration Table end.|Таблица 7-5 Конец таблицы конфигурации интерфейса коммутатора.
|
Table 7-6 Chapter 7 EXEC Command Reference Table end.|Таблица 7-6 Глава 7 Справочник команд EXEC Конец таблицы.
|
Keep track of your part review progress with the checklist shown in Table P2-1.|Следите за ходом проверки деталей с помощью контрольного списка, приведенного в Таблице P2-1.
Details on each task follow the table.|Подробности по каждой задаче приведены в таблице.
|
Table P2-1 Part II Part Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Do Labs Review Appendix P on the Companion Website Videos Repeat All DIKTA Questions For this task, answer the “Do I Know This Already?” questions again for the chapters in this part of the book, using the PCPT software.|Таблица P2-1. Контрольный список проверки части II. Действие 1-я дата завершения 2-я дата завершения Повторить все вопросы DIKTA Ответить на вопросы проверки части Пересмотреть ключевые темы Проверьте ли лаборатория Приложение P на сопутствующем веб-сайте Видео Повторите все вопросы DIKTA Для этой задачи ответьте на вопрос «Могу ли я Уже знаете это? » снова задайте вопросы к главам этой части книги, используя программное обеспечение PCPT.
|
Answer Part Review Questions For this task, answer the Part Review questions for this part of the book, using the PTP software.|Ответить на вопросы обзора части Для этой задачи ответьте на вопросы обзора части для этой части книги, используя программное обеспечение PTP.
|
Review Key Topics Review all key topics in all chapters in this part, either by browsing the chapters or by using the Key Topics application on the companion website.|Обзор ключевых тем. Просмотрите все ключевые темы во всех главах этой части, просматривая главы или используя приложение «Ключевые темы» на сопутствующем веб-сайте.
|
Labs Depending on your chosen lab tool, here are some suggestions for what to do in lab:|Лабораторные работы В зависимости от выбранного вами лабораторного инструмента, вот несколько советов о том, что делать в лаборатории:
|
Pearson Network Simulator: If you use the full Pearson ICND1 or CCNA simulator, focus more on the configuration scenario and troubleshooting scenario labs associated with the topics in this part of the book.|Симулятор сети Pearson: если вы используете полный симулятор Pearson ICND1 или CCNA, уделите больше внимания сценарию конфигурации и лабораторным работам по сценарию устранения неполадок, связанным с темами в этой части книги.
These types of labs include a larger set of topics and work well as Part Review activities. (See the Introduction for some details about how to find which labs are about topics in this part of the book.)|Эти типы лабораторных работ включают более широкий набор тем и хорошо подходят для работы с обзором деталей. (См. Введение, чтобы узнать, как найти лабораторные работы по темам в этой части книги.)
|
Blog: Config Labs: The author’s blog includes a series of configuration-focused labs that you can do on paper, each in 10–15 minutes.|Блог: Config Labs: блог автора включает в себя серию лабораторных работ по настройке, которые вы можете выполнить на бумаге, каждая из которых занимает 10–15 минут.
Review and perform the labs for this part of the book, as found at http://blog.certskills.com.|Просмотрите и выполните лабораторные работы для этой части книги, которые можно найти на http://blog.certskills.com.
Then navigate to the Hands-on Config labs.|Затем перейдите к практическим занятиям по настройке.
## Part II Review
Часть II Обзор   
__|__
--|--
|
Other: If using other lab tools, as a few suggestions: Make sure to experiment heavily with VLAN configuration and VLAN trunking configuration.|Другое: Если вы используете другие лабораторные инструменты, в качестве нескольких предложений: Обязательно поэкспериментируйте с конфигурацией VLAN и конфигурацией транкинга VLAN.
Also, spend some time changing interface settings like speed and duplex on a link between two switches, to make sure that you understand which cases would result in a duplex mismatch.|Кроме того, потратьте некоторое время на изменение настроек интерфейса, таких как скорость и дуплекс на линии между двумя коммутаторами, чтобы убедиться, что вы понимаете, в каких случаях может возникнуть несоответствие дуплексного режима.
|
Review Appendix P on the Companion Website The previous edition of the CCNA exam blueprint included the word “troubleshoot”|См. Приложение P на сопутствующем веб-сайте. В предыдущем выпуске плана экзамена CCNA было слово «устранение неполадок».
|
as applied to Ethernet and VLANs, while the current CCNA exam blueprint does not.|применительно к Ethernet и VLAN, тогда как текущий план экзамена CCNA - нет.
|
Appendix P on the companion website contains a chapter from the previous edition of the book that focused on troubleshooting.|Приложение P на сопутствующем веб-сайте содержит главу из предыдущего издания книги, посвященную поиску и устранению неисправностей.
That appendix, named “LAN Troubleshooting,” can be useful as a tool to review the topics in this part of the book. (Note that if you use this extra appendix, you can ignore the mentions of Port Security until you have reached that Watch Videos Chapters 4 and 5 each recommend a video that can be helpful to anyone who is just learning about the Cisco CLI and basic switching concepts.|Это приложение, названное «Устранение неполадок LAN», может быть полезно в качестве инструмента для ознакомления с темами в этой части книги. (Обратите внимание, что если вы используете это дополнительное приложение, вы можете игнорировать упоминания о безопасности порта, пока не дойдете до того, что Смотреть видео, главы 4 и 5, каждая рекомендует видео, которое может быть полезно для всех, кто только изучает Cisco CLI и основы коммутации. концепции.
If you have not watched those videos yet, take a moment to navigate to the companion website and watch the videos (listed under Chapters 4 and 5).|Если вы еще не смотрели эти видеоролики, найдите время, чтобы перейти на сопутствующий веб-сайт и посмотреть видеоролики (перечисленные в главах 4 и 5).
|
Part II of this book introduces the basics of Ethernet LANs, both in concept and in how to implement the features.|Часть II этой книги знакомит с основами сетей Ethernet как в концепции, так и в том, как реализовать эти функции.
However, the two primary features discussed in Part III of this book—Virtual LANs (VLANs) and Spanning Tree Protocol (STP)—impact almost everything you have learned about Ethernet so far.|Однако две основные особенности, обсуждаемые в части III этой книги - виртуальные локальные сети (VLAN) и протокол связующего дерева (STP) - влияют почти на все, что вы узнали об Ethernet до сих пор.
VLANs allow a network engineer to create separate Ethernet LANs through simple configuration choices.|Сети VLAN позволяют сетевому инженеру создавать отдельные локальные сети Ethernet с помощью простых вариантов конфигурации.
The ability to separate some switch ports into one VLAN and other switch ports into another VLAN gives network designers a powerful tool for creating networks.|Возможность разделить некоторые порты коммутатора в одну VLAN, а другие порты коммутатора в другую VLAN дает разработчикам сетей мощный инструмент для создания сетей.
Once created, VLANs also have a huge impact on how a switch works, which then impacts how you verify and troubleshoot the operation of a campus LAN.|После создания виртуальные локальные сети также оказывают огромное влияние на работу коммутатора, что затем влияет на то, как вы проверяете и устраняете неполадки в работе локальной сети кампуса.
|
STP—and the related and similar Rapid STP (RSTP)—acts to prevent frames from looping around a LAN. Without STP or RSTP, in LANs with redundant links, broadcasts and some other frames would be forwarded around and around the LAN, eventually clogging the LAN so much as to make it unusable.|STP - и связанный с ним Rapid STP (RSTP) - предотвращает зацикливание кадров в локальной сети. Без STP или RSTP в локальных сетях с избыточными ссылками широковещательные сообщения и некоторые другие кадры будут пересылаться по локальной сети и вокруг нее, в конечном итоге засоряя локальную сеть настолько, что она становится непригодной для использования.
|
The current CCNA 200-301 exam blueprint includes exam topics for the configuration and verification of VLANs and related topics.|Текущий план экзамена CCNA 200-301 включает темы экзаменов по настройке и проверке сетей VLAN и связанные темы.
However, the CCNA exam topics only mention RSTP concepts rather than configuration/verification.|Однако в темах экзамена CCNA упоминаются только концепции RSTP, а не настройка / проверка.
To that end, Part III opens with Chapter 8, which goes to the configuration/verification depth with VLAN topics, followed by Chapter 9, which introduces the concepts of STP and RSTP.|С этой целью часть III открывается главой 8, в которой подробно рассказывается о конфигурации / проверке с темами о VLAN, за которой следует глава 9, в которой представлены концепции STP и RSTP.
|
Part III closes with Chapter 10, which includes some RSTP configuration, along with Layer 2 EtherChannel configuration.|Часть III завершается главой 10, которая включает в себя некоторую конфигурацию RSTP, а также конфигурацию EtherChannel уровня 2.
|
Other Resources As one additional suggestion for those who intend to move on to CCNP Enterprise, consider skimming or reading Appendix P, “LAN Troubleshooting,” found on the online companion website.|Другие ресурсы В качестве еще одного предложения для тех, кто намеревается перейти на CCNP Enterprise, рассмотрите возможность беглого просмотра или чтения Приложения P «Устранение неполадок LAN», которое можно найти на сопутствующем веб-сайте.
This appendix, a copy of a chapter from the previous edition of the book, takes a troubleshooting approach to many of the topics found in Parts II and III of this book.|В этом приложении, являющемся копией главы из предыдущего издания книги, используется подход к поиску и устранению неисправностей по многим темам, содержащимся в частях II и III этой книги.
Although Cisco completely removed the word troubleshoot from the CCNA exam blueprint in its current CCNA 200-301 version, the topics still remain relevant and can be a help for reviewing and refining what you learned in Parts II and III of this book.|Несмотря на то, что Cisco полностью удалила слово «устранение неполадок» из плана экзамена CCNA в своей текущей версии CCNA 200-301, темы по-прежнему остаются актуальными и могут быть полезны при рассмотрении и уточнении того, что вы узнали в частях II и III этой книги.
## Part III Implementing VLANs and STP
Часть III. Реализация сетей VLAN и STP.   
__|__
--|--
|
Part III Review|Часть III Обзор
## Chapter 8 Implementing Ethernet Virtual LANs
Глава 8 Реализация виртуальных локальных сетей Ethernet   
__|__
--|--
|
LANs This chapter covers the following exam topics:|Локальные сети В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.13 Describe switching concepts
1.13 Описание концепций переключения   
###### 1.13.a MAC learning and aging
1.13.a Изучение MAC и старение   
###### 1.13.b Frame switching
1.13.b Переключение кадров   
###### 1.13.c Frame flooding
1.13.c Фрейм флуд   
###### 1.13.d MAC address table
1.13.d Таблица MAC-адресов   
###### 2.0 Network Access
2.0 Доступ к сети   
###### 2.1 Configure and verify VLANs (normal range) spanning multiple switches
2.1 Настройка и проверка сетей VLAN (нормальный диапазон), охватывающих несколько коммутаторов   
###### 2.1.a Access ports (data and voice)
2.1.a Порты доступа (данные и голос)   
###### 2.1.b Default VLAN
2.1.b VLAN по умолчанию   
###### 2.1.c Connectivity
2.1.c Связь   
###### 2.2 Configure and verify interswitch connectivity
2.2 Настройка и проверка межкоммутаторного подключения   
###### 2.2.a Trunk ports
2.2.a Магистральные порты   
###### 2.2.b 802.1Q
2.2.b 802.1Q   
###### 2.2.c Native VLAN
2.2.c Собственная VLAN   
__|__
--|--
|
So far in this book, you have learned that Ethernet switches receive Ethernet frames, make decisions, and then forward (switch) those Ethernet frames.|До сих пор из этой книги вы узнали, что коммутаторы Ethernet получают кадры Ethernet, принимают решения, а затем пересылают (переключают) эти кадры Ethernet.
That core logic revolves around MAC addresses, the interface in which the frame arrives, and the interfaces out which the switch forwards the frame.|Эта основная логика вращается вокруг MAC-адресов, интерфейса, в который поступает кадр, и интерфейсов, через которые коммутатор пересылает кадр.
|
While true, that logic omits any consideration of virtual LANs (VLANs).|Хотя это правда, эта логика не учитывает виртуальные локальные сети (VLAN).
VLANs impact the switching logic for each frame because each VLAN acts as a subset of the switch ports in an Ethernet LAN. Switches believe each Ethernet frame to be received in an identifiable VLAN, forwarded based on MAC table entries for that VLAN, and forwarded out ports in that VLAN. This chapter explores those concepts and others related to VLANs.|Сети VLAN влияют на логику коммутации для каждого кадра, поскольку каждая VLAN действует как подмножество портов коммутатора в локальной сети Ethernet. Коммутаторы полагают, что каждый кадр Ethernet принимается в идентифицируемой VLAN, пересылается на основе записей таблицы MAC для этой VLAN и перенаправляется на порты в этой VLAN. В этой главе рассматриваются эти и другие концепции, относящиеся к VLAN.
|
As for the organization of the chapter, the first major section of the chapter explains the core concepts.|Что касается организации главы, первый основной раздел главы объясняет основные концепции.
These concepts include how VLANs work on a single switch, how to use VLAN trunking to create VLANs that span across multiple switches, and how to forward traffic between VLANs using a router.|Эти концепции включают в себя то, как VLAN работают на одном коммутаторе, как использовать транкинг VLAN для создания VLAN, охватывающих несколько коммутаторов, и как пересылать трафик между VLAN с помощью маршрутизатора.
The second major section shows how to configure VLANs and VLAN trunks: how to statically assign interfaces to a VLAN. The final major section discusses some issues that can arise when using VLANs and trunks and how to avoid those issues.|Во втором основном разделе показано, как настроить VLAN и магистрали VLAN: как статически назначить интерфейсы для VLAN. В последнем основном разделе обсуждаются некоторые проблемы, которые могут возникнуть при использовании виртуальных локальных сетей и магистралей, и способы их устранения.
|
CHAPTER 8|ГЛАВА 8
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 8-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 8-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### Virtual LAN Concepts
Концепции виртуальной локальной сети   
__|__
--|--
|
VLAN and VLAN Trunking Configuration and Verification 4–6 Troubleshooting VLANs and VLAN Trunks 7–8 1.|Конфигурация и проверка VLAN и VLAN Trunking 4–6 Устранение неисправностей VLAN и VLAN Trunks 7–8 1.
In a LAN, which of the following terms best equates to the term VLAN?|Какой из следующих терминов лучше всего соответствует термину VLAN в локальной сети?
|
a. Collision domain b.|а. Домен коллизий b.
Broadcast domain c.|Домен вещания c.
Subnet d.|Подсеть d.
Single switch e.|Одиночный переключатель e.
Trunk 2.|Багажник 2.
Imagine a switch with three configured VLANs. How many IP subnets are required, assuming that all hosts in all VLANs want to use TCP/IP?|Представьте себе коммутатор с тремя настроенными сетями VLAN. Сколько IP-подсетей требуется, если предположить, что все хосты во всех VLAN хотят использовать TCP / IP?
|
a. 0 b. 1 c. 2 d. 3 e.|а. 0 б. 1 в. 2 дн. 3 е.
You cannot tell from the information provided.|Вы не можете сказать из предоставленной информации.
|
3. Switch SW1 sends a frame to switch SW2 using 802.1Q trunking.|3. Коммутатор SW1 отправляет кадр коммутатору SW2, используя транкинг 802.1Q.
Which of the answers describes how SW1 changes or adds to the Ethernet frame before forwarding the frame to SW2?|Какой из ответов описывает, как SW1 изменяет или добавляет фрейм Ethernet перед пересылкой фрейма в SW2?
|
a. Inserts a 4-byte header and does change the MAC addresses b.|а. Вставляет 4-байтовый заголовок и меняет MAC-адреса. B.
Inserts a 4-byte header and does not change the MAC addresses c.|Вставляет 4-байтовый заголовок и не изменяет MAC-адреса c.
Encapsulates the original frame behind an entirely new Ethernet header d.|Инкапсулирует исходный кадр за совершенно новым заголовком Ethernet d.
None of the other answers are correct 4.|Все остальные ответы неверны 4.
Imagine that you are told that switch 1 is configured with the dynamic auto parameter for trunking on its Fa0/5 interface, which is connected to switch 2.|Представьте, что вам сообщили, что коммутатор 1 настроен с динамическим параметром auto для транкинга на его интерфейсе Fa0 / 5, который подключен к коммутатору 2.
You have to configure switch 2.|Вам необходимо настроить переключатель 2.
Which of the following settings for trunking could allow trunking to work? (Choose two answers.)|Какие из следующих настроек транкинга могут позволить транкинг работать? (Выберите два ответа.)
|
a. on b. dynamic auto c. dynamic desirable d. access e.|а. на б. динамический авто c. динамический желательно d. доступ e.
None of the other answers are correct.|Все остальные ответы неверны.
|
5. A switch has just arrived from Cisco.|5. Только что прибыл коммутатор от Cisco.
The switch has never been configured with any VLANs, but VTP has been disabled.|Коммутатор никогда не настраивался с какими-либо VLAN, но VTP был отключен.
An engineer configures the vlan 22 and name Hannahs-VLAN commands and then exits configuration mode.|Инженер настраивает команды vlan 22 и name Hannahs-VLAN, а затем выходит из режима конфигурации.
Which of the following are true? (Choose two answers.)|Что из следующего верно? (Выберите два ответа.)
|
a. VLAN 22 is listed in the output of the show vlan brief command.|а. Сеть VLAN 22 указана в выходных данных команды show vlan Short.
|
b. VLAN 22 is listed in the output of the show running-config command.|б. Сеть VLAN 22 указана в выходных данных команды show running-config.
|
c. VLAN 22 is not created by this process.|c. VLAN 22 этим процессом не создается.
|
d. VLAN 22 does not exist in that switch until at least one interface is assigned to that VLAN.|d. VLAN 22 не существует в этом коммутаторе до тех пор, пока для этой VLAN не будет назначен хотя бы один интерфейс.
|
6. Which of the following commands identify switch interfaces as being trunking interfaces:|6. Какие из следующих команд определяют интерфейсы коммутатора как транкинговые интерфейсы:
|
interfaces that currently operate as VLAN trunks? (Choose two answers.)|интерфейсы, которые в настоящее время работают как магистрали VLAN? (Выберите два ответа.)
|
a. show interfaces b. show interfaces switchport c. show interfaces trunk d. show trunks 7.|а. показать интерфейсы b. показать интерфейсы switchport c. показать магистраль интерфейсов d. показать стволы 7.
In a switch that disables VTP, an engineer configures the commands vlan 30 and shutdown vlan 30.|В коммутаторе, отключающем VTP, инженер настраивает команды vlan 30 и shutdown vlan 30.
Which answers should be true about this switch? (Choose two answers.)|Какие ответы должны быть верными об этом переключателе? (Выберите два ответа.)
|
a. The show vlan brief command should list VLAN 30.|а. Команда show vlan Short должна отобразить VLAN 30.
|
b. The show running-config command should list VLAN 30.|б. Команда show running-config должна отобразить VLAN 30.
|
c. The switch should forward frames that arrive in access ports in VLAN 30.|c. Коммутатор должен пересылать кадры, которые поступают в порты доступа в VLAN 30.
|
d. The switch should forward frames that arrive in trunk ports tagged with VLAN 30.|d. Коммутатор должен пересылать кадры, которые поступают в магистральные порты, помеченные VLAN 30.
|
8. The show interfaces g0/1 trunk command provides three lists of VLAN IDs. Which items would limit the VLANs that appear in the first of the three lists of VLANs?|8. Команда транка show interfaces g0 / 1 предоставляет три списка идентификаторов VLAN. Какие элементы будут ограничивать VLAN, которые появляются в первом из трех списков VLAN?
|
a. A shutdown vlan 30 global command b.|а. Глобальная команда выключения vlan 30 b.
A switchport trunk allowed vlan interface subcommand c.|Транк коммутатора разрешил подкоманду интерфейса vlan c.
An STP choice to block on G0/1 d.|Выбор STP для блокировки на G0 / 1 d.
A no vlan 30 global command Foundation Topics Virtual LAN Concepts Before understanding VLANs, you must first have a specific understanding of the definition of a LAN. For example, from one perspective, a LAN includes all the user devices, servers, switches, routers, cables, and wireless access points in one location.|Глобальная команда no vlan 30 Основные темы Основные понятия о виртуальных локальных сетях Прежде чем разбираться в виртуальных локальных сетях, вы должны сначала иметь конкретное понимание определения локальной сети. Например, с одной точки зрения, ЛВС включает в себя все пользовательские устройства, серверы, коммутаторы, маршрутизаторы, кабели и точки беспроводного доступа в одном месте.
However, an alternative narrower definition of a LAN can help in understanding the concept of a virtual LAN:|Однако альтернативное более узкое определение LAN может помочь в понимании концепции виртуальной LAN:
|
A LAN includes all devices in the same broadcast domain.|ЛВС включает все устройства в одном широковещательном домене.
|
A broadcast domain includes the set of all LAN-connected devices, so that when any of the devices sends a broadcast frame, all the other devices get a copy of the frame.|Широковещательный домен включает в себя набор всех устройств, подключенных к локальной сети, так что, когда какое-либо из устройств отправляет широковещательный кадр, все другие устройства получают его копию.
So, from one perspective, you can think of a LAN and a broadcast domain as being basically the same thing.|Итак, с одной точки зрения, вы можете рассматривать локальную сеть и широковещательный домен как одно и то же.
|
Using only default settings, a switch considers all its interfaces to be in the same broadcast domain.|Используя только настройки по умолчанию, коммутатор считает, что все его интерфейсы находятся в одном широковещательном домене.
That is, for one switch, when a broadcast frame entered one switch port, the switch forwards that broadcast frame out all other ports.|То есть для одного коммутатора, когда широковещательный кадр поступает на один порт коммутатора, коммутатор пересылает этот широковещательный кадр на все другие порты.
With that logic, to create two different LAN broadcast domains, you had to buy two different Ethernet LAN switches, as shown in Figure 8-1.|При такой логике для создания двух разных широковещательных доменов LAN вам пришлось купить два разных коммутатора Ethernet LAN, как показано на рис. 8-1.
|
Figure 8-1 Creating Two Broadcast Domains with Two Physical Switches and No VLANs By using two VLANs, a single switch can accomplish the same goals of the design in Figure 8-1—to create two broadcast domains—with a single switch.|Рис. 8-1. Создание двух широковещательных доменов с двумя физическими коммутаторами и без виртуальных локальных сетей. Используя две виртуальные локальные сети, один коммутатор может достичь тех же целей, что и на рисунке 8-1, - создать два широковещательных домена - с одним коммутатором.
With VLANs, a switch can configure some interfaces into one broadcast domain and some into another, creating multiple broadcast domains.|С помощью виртуальных локальных сетей коммутатор может настроить некоторые интерфейсы на один широковещательный домен, а некоторые на другой, создавая несколько широковещательных доменов.
These individual broadcast domains created by the switch are called virtual LANs (VLAN).|Эти отдельные широковещательные домены, созданные коммутатором, называются виртуальными локальными сетями (VLAN).
|
For example, in Figure 8-2, the single switch creates two VLANs, treating the ports in each VLAN as being completely separate.|Например, на рис. 8-2 один коммутатор создает две сети VLAN, обрабатывая порты в каждой VLAN как полностью отдельные.
The switch would never forward a frame sent by Dino (in VLAN 1) over to either Wilma or Betty (in VLAN 2).|Коммутатор никогда не пересылает кадр, отправленный Dino (в VLAN 1), ни Wilma, ни Betty (в VLAN 2).
|
Figure 8-2 Creating Two Broadcast Domains Using One Switch and VLANs Designing campus LANs to use more VLANs, each with a smaller number of devices, often helps improve the LAN in many ways.|Рис. 8-2. Создание двух широковещательных доменов с использованием одного коммутатора и виртуальных локальных сетей. Проектирование кампусных локальных сетей для использования большего количества виртуальных локальных сетей, каждая из которых имеет меньшее количество устройств, часто помогает улучшить локальную сеть во многих отношениях.
For example, a broadcast sent by one host in a VLAN will be received and processed by all the other hosts in the VLAN—but not by hosts in a different VLAN. Limiting the number of hosts that receive a single broadcast frame reduces the number of hosts that waste effort processing unneeded broadcasts.|Например, широковещательная рассылка, отправленная одним хостом в VLAN, будет приниматься и обрабатываться всеми другими хостами в VLAN, но не хостами в другой VLAN. Ограничение количества хостов, получающих один широковещательный фрейм, уменьшает количество хостов, которые тратят усилия на обработку ненужных широковещательных сообщений.
It also reduces security risks because fewer hosts see frames sent by any one host.|Это также снижает риски безопасности, потому что меньшее количество хостов видит кадры, отправленные одним хостом.
These are just a few reasons for separating hosts into different VLANs. The following list summarizes the most common reasons for choosing to create smaller broadcast domains (VLANs):|Это всего лишь несколько причин для разделения хостов на разные VLAN. В следующем списке перечислены наиболее распространенные причины создания небольших широковещательных доменов (VLAN):
###### To reduce CPU overhead on each device, improving host performance, by reducing the
Чтобы уменьшить нагрузку на ЦП на каждом устройстве, повысить производительность хоста за счет уменьшения   
__|__
--|--
|
number of devices that receive each broadcast frame|количество устройств, получающих каждый широковещательный кадр
###### To reduce security risks by reducing the number of hosts that receive copies of frames
Снижение рисков безопасности за счет уменьшения количества хостов, получающих копии фреймов.   
__|__
--|--
|
that the switches flood (broadcasts, multicasts, and unknown unicasts)|что коммутаторы наводняют (широковещательные, многоадресные и неизвестные одноадресные)
###### To improve security for hosts through the application of different security policies per
Для повышения безопасности хостов за счет применения различных политик безопасности на   
__|__
--|--
|
VLAN|VLAN
###### To create more flexible designs that group users by department, or by groups that work
Для создания более гибких дизайнов, группирующих пользователей по отделам или по группам, которые работают   
__|__
--|--
|
together, instead of by physical location|вместе, а не по физическому местонахождению
###### To solve problems more quickly, because the failure domain for many problems is the
Чтобы решать проблемы быстрее, потому что область отказа для многих проблем - это   
__|__
--|--
|
same set of devices as those in the same broadcast domain|тот же набор устройств, что и в том же широковещательном домене
###### To reduce the workload for the Spanning Tree Protocol (STP) by limiting a VLAN to a
Чтобы уменьшить рабочую нагрузку на протокол связующего дерева (STP), ограничив VLAN до   
__|__
--|--
|
single access switch The rest of this chapter looks closely at the mechanics of how VLANs work across multiple Cisco switches, including the required configuration.|единый коммутатор доступа В оставшейся части этой главы подробно рассматривается механизм работы VLAN на нескольких коммутаторах Cisco, включая требуемую конфигурацию.
To that end, the next section examines VLAN trunking, a feature required when installing a VLAN that exists on more than one LAN switch.|С этой целью в следующем разделе исследуется транкинг VLAN, функция, необходимая при установке VLAN, которая существует более чем на одном коммутаторе LAN.
#### Creating Multiswitch VLANs Using Trunking
Создание сетей VLAN с несколькими коммутаторами с использованием транкинга   
__|__
--|--
|
Configuring VLANs on a single switch requires only a little effort: you simply configure each port to tell it the VLAN number to which the port belongs.|Для настройки VLAN на одном коммутаторе требуется совсем немного усилий: вы просто настраиваете каждый порт, чтобы сообщить ему номер VLAN, к которому он принадлежит.
With multiple switches, you have to consider additional concepts about how to forward traffic between the switches.|При использовании нескольких коммутаторов необходимо учитывать дополнительные концепции перенаправления трафика между коммутаторами.
|
When you are using VLANs in networks that have multiple interconnected switches, the switches need to use VLAN trunking on the links between the switches.|Когда вы используете VLAN в сетях, которые имеют несколько взаимосвязанных коммутаторов, коммутаторы должны использовать транкинг VLAN на каналах между коммутаторами.
VLAN trunking causes the switches to use a process called VLAN tagging, by which the sending switch adds another header to the frame before sending it over the trunk.|Транкинг VLAN заставляет коммутаторы использовать процесс, называемый тегированием VLAN, с помощью которого передающий коммутатор добавляет другой заголовок к кадру перед его отправкой по магистрали.
This extra trunking header includes a VLAN identifier (VLAN ID) field so that the sending switch can associate the frame with a particular VLAN ID, and the receiving switch can then know in what VLAN each frame belongs.|Этот дополнительный заголовок транкинга включает поле идентификатора VLAN (VLAN ID), чтобы отправляющий коммутатор мог связать кадр с конкретным идентификатором VLAN, а затем принимающий коммутатор мог знать, к какой VLAN принадлежит каждый кадр.
|
Figure 8-3 shows an example that demonstrates VLANs that exist on multiple switches, but it does not use trunking.|На рис. 8-3 показан пример, демонстрирующий сети VLAN, существующие на нескольких коммутаторах, но не использующие транкинг.
First, the design uses two VLANs: VLAN 10 and VLAN 20.|Во-первых, в проекте используются две VLAN: VLAN 10 и VLAN 20.
Each switch has two ports assigned to each VLAN, so each VLAN exists in both switches.|Каждый коммутатор имеет два порта, назначенных каждой VLAN, поэтому каждая VLAN существует в обоих коммутаторах.
To forward traffic in VLAN 10 between the two switches, the design includes a link between switches, with that link fully inside VLAN 10.|Для пересылки трафика в VLAN 10 между двумя коммутаторами конструкция включает канал между коммутаторами, причем этот канал полностью находится внутри VLAN 10.
Likewise, to support VLAN 20 traffic between switches, the design uses a second link between switches, with that link inside VLAN 20.|Аналогичным образом, для поддержки трафика VLAN 20 между коммутаторами в проекте используется второй канал между коммутаторами, причем этот канал находится внутри VLAN 20.
|
The design in Figure 8-3 functions perfectly.|Дизайн на Рисунке 8-3 работает идеально.
For example, PC11 (in VLAN 10) can send a frame to PC14.|Например, ПК11 (в VLAN 10) может отправить кадр на ПК14.
The frame flows into SW1, over the top link (the one that is in VLAN 10)|Кадр перетекает в SW1 по верхнему каналу (тот, который находится в VLAN 10).
|
and over to SW2.|и перейти к SW2.
|
Figure 8-3 Multiswitch VLAN Without VLAN Trunking The design shown in Figure 8-3 works, but it simply does not scale very well.|Рисунок 8-3 Многокоммутаторная VLAN без транкинга VLAN Конструкция, показанная на Рисунке 8-3, работает, но она просто не очень хорошо масштабируется.
It requires one physical link between switches to support every VLAN. If a design needed 10 or 20 VLANs, you would need 10 or 20 links between switches, and you would use 10 or 20 switch ports (on each switch) for those links.|Для поддержки каждой VLAN требуется одно физическое соединение между коммутаторами. Если для проекта требуется 10 или 20 VLAN, вам потребуется 10 или 20 каналов между коммутаторами, и вы должны использовать 10 или 20 портов коммутатора (на каждом коммутаторе) для этих каналов.
##### VLAN Tagging Concepts
Концепции тегов VLAN   
__|__
--|--
|
VLAN trunking creates one link between switches that supports as many VLANs as you need.|Транкинг VLAN создает одно соединение между коммутаторами, которое поддерживает столько VLAN, сколько вам нужно.
As a VLAN trunk, the switches treat the link as if it were a part of all the VLANs. At the same time, the trunk keeps the VLAN traffic separate, so frames in VLAN 10 would not go to devices in VLAN 20, and vice versa, because each frame is identified by VLAN number as it crosses the trunk.|В качестве магистрали VLAN коммутаторы рассматривают канал так, как если бы он был частью всех VLAN. В то же время магистраль разделяет трафик VLAN, поэтому кадры в VLAN 10 не будут поступать на устройства в VLAN 20, и наоборот, потому что каждый кадр идентифицируется номером VLAN при пересечении магистрали.
Figure 8-4 shows the idea, with a single physical link between the two switches.|На рис. 8-4 показана идея с одной физической связью между двумя коммутаторами.
|
Figure 8-4 Multiswitch VLAN with Trunking The use of trunking allows switches to forward frames from multiple VLANs over a single physical connection by adding a small header to the Ethernet frame.|Рис. 8-4 Многокоммутаторная VLAN с транкингом Использование транкинга позволяет коммутаторам пересылать кадры из нескольких VLAN по одному физическому соединению, добавляя небольшой заголовок к кадру Ethernet.
For example, Figure 8-5 shows PC11 sending a broadcast frame on interface Fa0/1 at Step 1.|Например, на рис. 8-5 показано, что ПК11 отправляет широковещательный кадр по интерфейсу Fa0 / 1 на шаге 1.
To flood the frame, switch SW1 needs to forward the broadcast frame to switch SW2. However, SW1 needs to let SW2 know that the frame is part of VLAN 10, so that after the frame is received, SW2 will flood the frame only into VLAN 10, and not into VLAN 20.|Для лавинной рассылки кадра коммутатор SW1 должен переслать широковещательный кадр коммутатору SW2. Однако SW1 должен сообщить SW2, что фрейм является частью VLAN 10, так что после того, как фрейм будет получен, SW2 направит его только в VLAN 10, а не во VLAN 20.
So, as shown at Step 2, before sending the frame, SW1 adds a VLAN header to the original Ethernet frame, with the VLAN header listing a VLAN ID of 10 in this case.|Итак, как показано на шаге 2, перед отправкой кадра SW1 добавляет заголовок VLAN к исходному кадру Ethernet, причем в этом случае заголовок VLAN содержит идентификатор VLAN, равный 10.
|
Figure 8-5 VLAN Trunking Between Two Switches When SW2 receives the frame, it understands that the frame is in VLAN 10.|Рисунок 8-5 Транкинг VLAN между двумя коммутаторами Когда SW2 получает кадр, он понимает, что кадр находится в VLAN 10.
SW2 then removes the VLAN header, forwarding the original frame out its interfaces in VLAN 10 (Step 3).|Затем SW2 удаляет заголовок VLAN, перенаправляя исходный кадр из своих интерфейсов в VLAN 10 (шаг 3).
|
For another example, consider the case when PC21 (in VLAN 20) sends a broadcast.|В качестве другого примера рассмотрим случай, когда PC21 (в VLAN 20) отправляет широковещательную рассылку.
|
SW1 sends the broadcast out port Fa0/4 (because that port is in VLAN 20) and out Gi0/1 (because it is a trunk, meaning that it supports multiple different VLANs).|SW1 отправляет широковещательный выходной порт Fa0 / 4 (потому что этот порт находится в VLAN 20) и выводит Gi0 / 1 (поскольку это транк, что означает, что он поддерживает несколько разных VLAN).
SW1 adds a trunking header to the frame, listing a VLAN ID of 20.|SW1 добавляет к кадру заголовок транкинга, в котором указан идентификатор VLAN 20.
SW2 strips off the trunking header after determining that the frame is part of VLAN 20, so SW2 knows to forward the frame out only ports Fa0/3 and Fa0/4, because they are in VLAN 20, and not out ports Fa0/1 and Fa0/2, because they are in VLAN 10.|SW2 удаляет заголовок транкинга после определения того, что кадр является частью VLAN 20, поэтому SW2 знает, что следует пересылать кадр только через порты Fa0 / 3 и Fa0 / 4, потому что они находятся в VLAN 20, а не из портов Fa0 / 1 и Fa0 / 2, потому что они находятся в VLAN 10.
##### The 802.1Q and ISL VLAN Trunking Protocols
Протоколы транкинга VLAN 802.1Q и ISL   
__|__
--|--
|
Cisco has supported two different trunking protocols over the years: Inter-Switch Link (ISL)|Cisco поддерживает два разных транкинговых протокола на протяжении многих лет: Inter-Switch Link (ISL)
|
and IEEE 802.1Q.|и IEEE 802.1Q.
Cisco created the ISL years before 802.1Q, in part because the IEEE had not yet defined a VLAN trunking standard.|Cisco создала ISL за несколько лет до 802.1Q, отчасти потому, что IEEE еще не определил стандарт транкинга VLAN.
Today, 802.1Q has become the more popular trunking protocol, with Cisco not even bothering to support ISL in many of its switch models today.|Сегодня 802.1Q стал более популярным протоколом транкинга, и Cisco даже не позаботилась о поддержке ISL во многих своих моделях коммутаторов.
|
While both ISL and 802.1Q tag each frame with the VLAN ID, the details differ. 802.1Q inserts an extra 4-byte 802.1Q VLAN header into the original frame’s Ethernet header, as shown at the top of Figure 8-6.|Хотя и ISL, и 802.1Q помечают каждый кадр идентификатором VLAN, детали различаются. 802.1Q вставляет дополнительный 4-байтовый заголовок 802.1Q VLAN в заголовок Ethernet исходного кадра, как показано в верхней части рисунка 8-6.
As for the fields in the 802.1Q header, only the 12-bit VLAN ID field inside the 802.1Q header matters for topics discussed in this book.|Что касается полей в заголовке 802.1Q, то только 12-битное поле VLAN ID внутри заголовка 802.1Q имеет значение для тем, обсуждаемых в этой книге.
This 12-bit field supports a theoretical maximum of 212 (4096) VLANs, but in practice it supports a maximum of 4094. (Both 802.1Q and ISL use 12 bits to tag the VLAN ID, with two reserved values [0 and 4095].)|Это 12-битное поле поддерживает теоретический максимум 212 (4096) VLAN, но на практике оно поддерживает максимум 4094. (И 802.1Q, и ISL используют 12 бит для маркировки идентификатора VLAN с двумя зарезервированными значениями [0 и 4095] .)
|
Cisco switches break the range of VLAN IDs (1–4094) into two ranges: the normal range and the extended range.|Коммутаторы Cisco разбивают диапазон идентификаторов VLAN (1–4094) на два диапазона: нормальный диапазон и расширенный диапазон.
All switches can use normal-range VLANs with values from 1 to 1005.|Все коммутаторы могут использовать VLAN нормального диапазона со значениями от 1 до 1005.
|
Only some switches can use extended-range VLANs with VLAN IDs from 1006 to 4094.|Только некоторые коммутаторы могут использовать VLAN расширенного диапазона с идентификаторами VLAN от 1006 до 4094.
|
The rules for which switches can use extended-range VLANs depend on the configuration of the VLAN Trunking Protocol (VTP), which is discussed briefly in the section “VLAN Trunking Configuration,” later in this chapter.|Правила, по которым коммутаторы могут использовать VLAN с расширенным диапазоном, зависят от конфигурации протокола VLAN Trunking Protocol (VTP), который кратко обсуждается в разделе «Конфигурация транкинга VLAN» далее в этой главе.
|
802.1Q Dest.|802.1Q Dest.
Address Source Address Tag Type Data FCS Type Priority Flag VLAN ID (12 Bits)|Адрес Источник Адрес Тип тега Данные Тип FCS Флаг приоритета Идентификатор VLAN (12 бит)
|
Figure 8-6 802.1Q Trunking 802.1Q also defines one special VLAN ID on each trunk as the native VLAN (defaulting to use VLAN 1).|Рис. 8-6. Транкинг 802.1Q 802.1Q также определяет один специальный идентификатор VLAN для каждого транка в качестве собственной VLAN (по умолчанию используется VLAN 1).
By definition, 802.1Q simply does not add an 802.1Q header to frames in the native VLAN. When the switch on the other side of the trunk receives a frame that does not have an 802.1Q header, the receiving switch knows that the frame is part of the native VLAN. Note that because of this behavior, both switches must agree on which VLAN is the native VLAN.|По определению 802.1Q просто не добавляет заголовок 802.1Q к кадрам в собственной VLAN. Когда коммутатор на другой стороне магистрали получает кадр, не имеющий заголовка 802.1Q, принимающий коммутатор знает, что кадр является частью собственной VLAN. Обратите внимание, что из-за такого поведения оба коммутатора должны согласовать, какая VLAN является собственной VLAN.
|
The 802.1Q native VLAN provides some interesting functions, mainly to support connections to devices that do not understand trunking.|Собственная VLAN 802.1Q предоставляет некоторые интересные функции, в основном для поддержки подключений к устройствам, которые не поддерживают транкинг.
For example, a Cisco switch could be cabled to a switch that does not understand 802.1Q trunking.|Например, коммутатор Cisco может быть подключен кабелем к коммутатору, который не поддерживает транкинг 802.1Q.
The Cisco switch could send frames in the native VLAN—meaning that the frame has no trunking header—so that the other switch would understand the frame.|Коммутатор Cisco может отправлять кадры в собственной VLAN - это означает, что кадр не имеет транкинг-заголовка, - чтобы другой коммутатор понял кадр.
The native VLAN concept gives switches the capability of at least passing traffic in one VLAN (the native VLAN), which can allow some basic functions, like reachability to telnet into a switch.|Концепция собственной VLAN дает коммутаторам возможность, по крайней мере, передавать трафик в одной VLAN (собственная VLAN), что позволяет использовать некоторые базовые функции, такие как доступность telnet в коммутатор.
#### Forwarding Data Between VLANs
Пересылка данных между VLAN   
__|__
--|--
|
If you create a campus LAN that contains many VLANs, you typically still need all devices to be able to send data to all other devices.|Если вы создаете локальную сеть кампуса, содержащую множество виртуальных локальных сетей, вам, как правило, все равно нужно, чтобы все устройства могли отправлять данные на все другие устройства.
This next topic discusses some concepts about how to route data between those VLANs.|В следующем разделе обсуждаются некоторые концепции маршрутизации данных между этими VLAN.
##### The Need for Routing Between VLANs
Необходимость маршрутизации между VLAN   
__|__
--|--
|
LAN switches that forward data based on Layer 2 logic, as discussed so far in this book, often go by the name Layer 2 switch.|Коммутаторы LAN, которые пересылают данные на основе логики уровня 2, как обсуждалось до сих пор в этой книге, часто называют коммутатором уровня 2.
For example, Chapter 5, “Analyzing Ethernet LAN Switching,” discussed how LAN switches receive Ethernet frames (a Layer 2 concept), look at the destination Ethernet MAC address (a Layer 2 address), and forward the Ethernet frame out some other interface.|Например, в главе 5 «Анализ коммутации Ethernet LAN» обсуждалось, как коммутаторы LAN получают кадры Ethernet (концепция уровня 2), смотрят на MAC-адрес назначения Ethernet (адрес уровня 2) и пересылают кадр Ethernet на какой-либо другой интерфейс. .
All those concepts are defined by Layer 2 protocols, hence the name Layer 2 switch.|Все эти концепции определены протоколами уровня 2, отсюда и название коммутатора уровня 2.
|
Layer 2 switches perform their logic per VLAN. For example, in Figure 8-7, the two PCs on the left sit in VLAN 10, in subnet 10.|Коммутаторы уровня 2 выполняют свою логику для каждой VLAN. Например, на рисунке 8-7 два компьютера слева находятся в сети VLAN 10, в подсети 10.
The two PCs on the right sit in a different VLAN (20), with a different subnet (20).|Два компьютера справа находятся в другой VLAN (20) с другой подсетью (20).
Note that the figure repeats earlier Figure 8-2, but with the switch broken into halves, to emphasize the point that Layer 2 switches will not forward data between two VLANs.|Обратите внимание, что рисунок повторяется ранее, рисунок 8-2, но с коммутатором, разбитым пополам, чтобы подчеркнуть, что коммутаторы уровня 2 не будут пересылать данные между двумя VLAN.
|
As shown in the figure, when configured with some ports in VLAN 10 and others in VLAN 20, the switch acts like two separate switches in which it will forward traffic.|Как показано на рисунке, при настройке некоторых портов в VLAN 10 и других в VLAN 20 коммутатор действует как два отдельных коммутатора, в которых он будет пересылать трафик.
In fact, one goal of VLANs is to separate traffic in one VLAN from another, preventing frames in one VLAN from leaking over to other VLANs. For example, when Dino (in VLAN 10) sends any Ethernet frame, if SW1 is a Layer 2 switch, that switch will not forward the frame to the PCs on the right in VLAN 20.|Фактически, одна из целей VLAN - отделить трафик в одной VLAN от другой, предотвращая утечку кадров из одной VLAN в другие VLAN. Например, когда Dino (в VLAN 10) отправляет любой кадр Ethernet, если SW1 является коммутатором уровня 2, этот коммутатор не будет пересылать кадр на ПК справа в VLAN 20.
|
Figure 8-7 Layer 2 Switch Does Not Route Between the VLANs|Рисунок 8-7 Коммутатор уровня 2 не выполняет маршрутизацию между VLAN
##### Routing Packets Between VLANs with a Router
Маршрутизация пакетов между VLAN с помощью маршрутизатора   
__|__
--|--
|
When including VLANs in a campus LAN design, the devices in a VLAN need to be in the same subnet.|При включении сетей VLAN в проект LAN кампуса устройства в VLAN должны находиться в одной подсети.
Following the same design logic, devices in different VLANs need to be in different subnets.|Следуя одинаковой логике проектирования, устройства в разных VLAN должны находиться в разных подсетях.
|
To forward packets between VLANs, the network must use a device that acts as a router.|Для пересылки пакетов между VLAN сеть должна использовать устройство, которое действует как маршрутизатор.
You can use an actual router, as well as some other switches that can perform some functions like a router.|Вы можете использовать настоящий маршрутизатор, а также некоторые другие коммутаторы, которые могут выполнять некоторые функции, такие как маршрутизатор.
These switches that also perform Layer 3 routing functions go by the name multilayer switch or Layer 3 switch.|Эти коммутаторы, которые также выполняют функции маршрутизации уровня 3, называются многоуровневыми коммутаторами или коммутаторами уровня 3.
This section first discusses how to forward data between VLANs when using Layer 2 switches and ends with a brief discussion of how to use Layer 3 switches.|В этом разделе сначала обсуждается, как пересылать данные между VLAN при использовании коммутаторов уровня 2, а в конце кратко обсуждается, как использовать коммутаторы уровня 3.
|
For example, Figure 8-8 shows a router that can route packets between subnets 10 and 20.|Например, на рисунке 8-8 показан маршрутизатор, который может маршрутизировать пакеты между подсетями 10 и 20.
|
The figure shows the same Layer 2 switch as shown in Figure 8-7, with the same perspective of the switch being split into parts with two different VLANs, and with the same PCs in the same VLANs and subnets.|На рисунке показан тот же коммутатор уровня 2, что и на рисунке 8-7, с той же перспективой разделения коммутатора на части с двумя разными VLAN и с одними и теми же компьютерами в тех же VLAN и подсетях.
Now Router R1 has one LAN physical interface connected to the switch and assigned to VLAN 10, and a second physical interface connected to the switch and assigned to VLAN 20.|Теперь у маршрутизатора R1 есть один физический интерфейс LAN, подключенный к коммутатору и назначенный VLAN 10, а второй физический интерфейс, подключенный к коммутатору и назначенный VLAN 20.
With an interface connected to each subnet, the Layer 2 switch can keep doing its job—forwarding frames inside a VLAN, while the router can do its job—|С интерфейсом, подключенным к каждой подсети, коммутатор уровня 2 может продолжать выполнять свою работу - пересылать кадры внутри VLAN, в то время как маршрутизатор может выполнять свою работу -
|
routing IP packets between the subnets.|маршрутизация IP-пакетов между подсетями.
|
Figure 8-8 Routing Between Two VLANs on Two Physical Interfaces The figure shows an IP packet being routed from Fred, which sits in one VLAN/subnet, to Betty, which sits in the other.|Рисунок 8-8 Маршрутизация между двумя VLAN на двух физических интерфейсах На рисунке показан IP-пакет, маршрутизируемый от Фреда, который находится в одной VLAN / подсети, к Бетти, которая находится в другой.
The Layer 2 switch forwards two different Layer 2 Ethernet frames: one in VLAN 10, from Fred to R1’s F0/0 interface, and the other in VLAN 20, from R1’s F0/1 interface to Betty.|Коммутатор уровня 2 пересылает два разных кадра Ethernet уровня 2: один в VLAN 10 от Фреда к интерфейсу F0 / 0 маршрутизатора R1, а другой - к VLAN 20 от интерфейса F0 / 1 маршрутизатора R1 к Бетти.
From a Layer 3 perspective, Fred sends the IP packet to its default router (R1), and R1 routes the packet out another interface (F0/1) into another subnet where Betty resides.|С точки зрения уровня 3 Фред отправляет IP-пакет своему маршрутизатору по умолчанию (R1), а R1 направляет пакет через другой интерфейс (F0 / 1) в другую подсеть, где проживает Бетти.
|
The design in Figure 8-8 works, but there are several different solutions for routing packets between VLANs. This chapter shows the option of using a separate physical router, with a separate link per VLAN, because it can be the easiest of the options to understand and visualize.|Схема на рис. 8-8 работает, но есть несколько различных решений для маршрутизации пакетов между VLAN. В этой главе показан вариант использования отдельного физического маршрутизатора с отдельной ссылкой для каждой VLAN, поскольку это самый простой для понимания и визуализации вариант.
|
Chapter 17, “IP Routing in the LAN,” works through those other features for routing packets between VLANs.|Глава 17 «IP-маршрутизация в локальной сети» использует эти другие функции для маршрутизации пакетов между сетями VLAN.
### VLAN and VLAN Trunking Configuration and Verification
Конфигурация и проверка VLAN и VLAN Trunking   
__|__
--|--
|
Verification Cisco switches do not require any configuration to work.|Проверка Коммутаторы Cisco не требуют настройки для работы.
You can purchase Cisco switches, install devices with the correct cabling, turn on the switches, and they work.|Вы можете приобрести коммутаторы Cisco, установить устройства с правильной разводкой кабелей, включить коммутаторы, и они будут работать.
You would never need to configure the switch, and it would work fine, even if you interconnected switches, until you needed more than one VLAN. But if you want to use VLANs—and most enterprise networks do—you need to add some configuration.|Вам никогда не потребуется настраивать коммутатор, и он будет работать нормально, даже если вы соедините коммутаторы между собой, пока вам не понадобится более одной VLAN. Но если вы хотите использовать VLAN - а это делает большинство корпоративных сетей - вам нужно добавить некоторую конфигурацию.
|
This chapter separates the VLAN configuration details into two major sections.|В этой главе детали конфигурации VLAN разделены на два основных раздела.
The first section looks at how to configure static access interfaces: switch interfaces configured to be in one VLAN only, therefore not using VLAN trunking.|В первом разделе рассматривается, как настроить статические интерфейсы доступа: интерфейсы коммутатора настроены для работы только в одной VLAN, поэтому не используются транкинг VLAN.
The second part shows how to configure interfaces that do use VLAN trunking.|Во второй части показано, как настроить интерфейсы, которые действительно используют транкинг VLAN.
#### Creating VLANs and Assigning Access VLANs to an Interface
Создание сетей VLAN и назначение сетей доступа VLAN интерфейсу   
__|__
--|--
|
This section shows how to create a VLAN, give the VLAN a name, and assign interfaces to a VLAN. To focus on these basic details, this section shows examples using a single switch, so VLAN trunking is not needed.|В этом разделе показано, как создать VLAN, присвоить этой VLAN имя и назначить интерфейсы для VLAN. Чтобы сосредоточиться на этих основных деталях, в этом разделе показаны примеры использования одного коммутатора, поэтому транкинг VLAN не требуется.
|
For a Cisco switch to forward frames in a particular VLAN, the switch must be configured to believe that the VLAN exists.|Чтобы коммутатор Cisco пересылал кадры в определенной VLAN, коммутатор должен быть настроен так, чтобы полагать, что VLAN существует.
In addition, the switch must have nontrunking interfaces (called access interfaces, or static access interfaces) assigned to the VLAN, and/or trunks that support the VLAN. The configuration steps for access interfaces are as follows:|Кроме того, в коммутаторе должны быть неуправляемые интерфейсы (называемые интерфейсами доступа или статическими интерфейсами доступа), назначенные для VLAN, и / или транки, поддерживающие VLAN. Шаги настройки интерфейсов доступа следующие:
|
Step 1.|Шаг 1.
To configure a new VLAN, follow these steps:|Чтобы настроить новую VLAN, выполните следующие действия:
|
A. From configuration mode, use the vlan vlan-id command in global configuration mode to create the VLAN and to move the user into VLAN configuration mode.|A. В режиме конфигурации используйте команду vlan vlan-id в режиме глобальной конфигурации, чтобы создать VLAN и переместить пользователя в режим конфигурации VLAN.
|
B. (Optional) Use the name name command in VLAN configuration mode to list a name for the VLAN. If not configured, the VLAN name is VLANZZZZ, where ZZZZ is the four-digit decimal VLAN ID.|B. (Необязательно) Используйте команду name name в режиме конфигурации VLAN, чтобы указать имя для VLAN. Если не настроено, имя VLAN - VLANZZZZ, где ZZZZ - четырехзначный десятичный идентификатор VLAN.
|
Step 2.|Шаг 2.
For each access interface, follow these steps:|Для каждого интерфейса доступа выполните следующие действия:
|
A. Use the interface type number command in global configuration mode to move into interface configuration mode for each desired interface.|A. Используйте команду номера типа интерфейса в режиме глобальной конфигурации, чтобы перейти в режим конфигурации интерфейса для каждого желаемого интерфейса.
|
B. Use the switchport access vlan id-number command in interface configuration mode to specify the VLAN number associated with that interface.|B. Используйте команду switchport access vlan id-number в режиме настройки интерфейса, чтобы указать номер VLAN, связанный с этим интерфейсом.
|
C. (Optional) Use the switchport mode access command in interface configuration mode to make this port always operate in access mode (that is, to not trunk).|C. (Необязательно) Используйте команду switchport mode access в режиме настройки интерфейса, чтобы этот порт всегда работал в режиме доступа (то есть не в магистральном режиме).
|
While the list might look a little daunting, the process on a single switch is actually pretty simple.|Хотя список может показаться немного устрашающим, процесс с одним переключателем на самом деле довольно прост.
For example, if you want to put the switch’s ports in three VLANs—11, 12, and Config Checklist 13—you first add three vlan commands: vlan 11, vlan 12, and vlan 13.|Например, если вы хотите поместить порты коммутатора в три VLAN - 11, 12 и контрольный список конфигурации 13 - вы сначала добавляете три команды vlan: vlan 11, vlan 12 и vlan 13.
Then, for each interface, add a switchport access vlan 11 (or 12 or 13) command to assign that interface to the proper VLAN.|Затем для каждого интерфейса добавьте команду switchport access vlan 11 (или 12, или 13), чтобы назначить этот интерфейс соответствующей VLAN.
|
NOTE The term default VLAN (as shown in the exam topics) refers to the default setting on the switchport access vlan vlan-id command, and that default is VLAN ID 1.|ПРИМЕЧАНИЕ Термин VLAN по умолчанию (как показано в темах экзамена) относится к настройке по умолчанию для команды switchport access vlan vlan-id, и этим значением по умолчанию является VLAN ID 1.
In other words, by default, each port is assigned to access VLAN 1.|Другими словами, по умолчанию каждый порт назначен для доступа к VLAN 1.
##### VLAN Configuration Example 1: Full VLAN Configuration
Пример конфигурации VLAN 1: Полная конфигурация VLAN   
__|__
--|--
|
Examples 8-1, 8-2, and 8-3 work through one scenario with VLAN configuration and verification.|Примеры 8-1, 8-2 и 8-3 работают через один сценарий с настройкой и проверкой VLAN.
|
To begin, Example 8-1 begins by showing the VLANs in switch SW1 in Figure 8-9, with all default settings related to VLANs.|Для начала Пример 8-1 начинается с отображения VLAN в коммутаторе SW1 на Рисунке 8-9 со всеми настройками по умолчанию, относящимися к VLAN.
|
Figure 8-9 Network with One Switch and Three VLANs Example 8-1 Configuring VLANs and Assigning VLANs to Interfaces Example end.|Рис. 8-9. Сеть с одним коммутатором и тремя VLAN. Пример 8-1. Настройка VLAN и назначение VLAN интерфейсам. Пример конец.
|
The example begins with the show vlan brief command, confirming the default settings of five nondeletable VLANs, with all interfaces assigned to VLAN 1.|Пример начинается с команды show vlan Short, подтверждающей настройки по умолчанию для пяти не удаляемых VLAN, при этом все интерфейсы назначены VLAN 1.
VLAN 1 cannot be deleted but can be used.|VLAN 1 нельзя удалить, но можно использовать.
VLANs 1002–1005 cannot be deleted and cannot be used as access VLANs today.|Сети VLAN 1002–1005 не могут быть удалены и не могут использоваться в качестве VLAN доступа сегодня.
In particular, note that this 2960 switch has 24 Fast Ethernet ports (Fa0/1–|В частности, обратите внимание, что этот коммутатор 2960 имеет 24 порта Fast Ethernet (Fa0 / 1–
|
Fa0/24) and two Gigabit Ethernet ports (Gi0/1 and Gi0/2), all of which are listed as being in VLAN 1 per that first command’s output, confirming that by default, Cisco switches assign all ports to VLAN 1.|Fa0 / 24) и два порта Gigabit Ethernet (Gi0 / 1 и Gi0 / 2), все из которых указаны как находящиеся в VLAN 1 в выходных данных первой команды, подтверждая, что по умолчанию коммутаторы Cisco назначают все порты VLAN 1.
|
Next, Example 8-2 shows steps that mirror the VLAN configuration checklist, namely the configuration of VLAN 2, plus the assignment of VLAN 2 as the access VLAN on two ports: Fa0/13 and Fa0/14.|Затем в примере 8-2 показаны шаги, которые отражают контрольный список конфигурации VLAN, а именно конфигурацию VLAN 2, а также назначение VLAN 2 в качестве VLAN доступа на двух портах: Fa0 / 13 и Fa0 / 14.
|
Example 8-2 Configuring VLANs and Assigning VLANs to Interfaces Example end.|Пример 8-2. Настройка VLAN и назначение VLAN интерфейсам. Пример конец.
|
Take a moment to compare the output of the show vlan brief commands in Example 8-2 (after adding the configuration) versus Example 8-1.|Найдите минутку, чтобы сравнить выходные данные команд show vlan short в примере 8-2 (после добавления конфигурации) с примером 8-1.
Example 8-2 shows new information about VLAN 2, with ports Fa0/13 and Fa0/14 no longer being listed with VLAN 1, but now listed as assigned to VLAN 2.|В примере 8-2 показана новая информация о VLAN 2, при этом порты Fa0 / 13 и Fa0 / 14 больше не отображаются в VLAN 1, но теперь указаны как назначенные для VLAN 2.
|
To complete this scenario, Example 8-3 shows a little more detail about the VLAN itself.|Чтобы завершить этот сценарий, в Примере 8-3 показано немного больше деталей о самой VLAN.
|
First, the show running-config command lists both the vlan 2 and switchport access vlan 2 commands as configured in Example 8-2.|Во-первых, команда show running-config перечисляет команды vlan 2 и switchport access vlan 2, как настроено в примере 8-2.
Also, note that earlier Example 8-2 uses the interface range command, with one instance of the switchport access vlan 2 interface subcommand.|Также обратите внимание, что в предыдущем примере 8-2 используется команда interface range с одним экземпляром подкоманды интерфейса switchport access vlan 2.
However, Example 8-3 shows how the switch actually applied that command to both Fa0/13 and Fa0/14.|Однако в примере 8-3 показано, как коммутатор фактически применил эту команду к Fa0 / 13 и Fa0 / 14.
Example 8-3 ends with the show vlan id 2 command, which confirms the operational status that ports Fa0/13 and Fa0/14 are assigned to VLAN 2.|Пример 8-3 заканчивается командой show vlan id 2, которая подтверждает рабочее состояние, при котором порты Fa0 / 13 и Fa0 / 14 назначены VLAN 2.
|
Example 8-3 Configuring VLANs and Assigning VLANs to Interfaces Example end.|Пример 8-3 Настройка VLAN и назначение VLAN интерфейсам Окончание примера.
|
The example surrounding Figure 8-9 uses six switch ports, all of which need to operate as access ports.|Пример на рис. 8-9 использует шесть портов коммутатора, каждый из которых должен работать как порты доступа.
That is, each port should not use trunking but instead should be assigned to a single VLAN, as assigned by the switchport access vlan vlan-id command.|То есть каждый порт не должен использовать транкинг, а должен быть назначен одной VLAN, как это назначается командой switchport access vlan vlan-id.
For ports that should always act as access ports, add the optional interface subcommand switchport mode access.|Для портов, которые всегда должны действовать как порты доступа, добавьте необязательную подкоманду interface switchport mode access.
This command tells the switch to always be an access interface and disables the protocol that negotiates trunking (Dynamic Trunking Protocol [DTP]) with the device on the other end of the link. (The upcoming section “VLAN Trunking Configuration” discusses more details about the commands that allow a port to negotiate whether it should use trunking.)|Эта команда указывает коммутатору, что он всегда должен быть интерфейсом доступа, и отключает протокол, который согласовывает транкинг (Dynamic Trunking Protocol [DTP]) с устройством на другом конце канала. (В следующем разделе «Конфигурация транкинга VLAN» обсуждаются более подробные сведения о командах, которые позволяют порту согласовывать, следует ли использовать транкинг.)
|
NOTE The book includes a video that works through a different VLAN configuration example as well.|ПРИМЕЧАНИЕ В книге есть видео, которое также работает с другим примером конфигурации VLAN.
You can find the video on the companion website.|Вы можете найти видео на сопутствующем веб-сайте.
##### VLAN Configuration Example 2: Shorter VLAN Configuration
Пример конфигурации VLAN 2: более короткая конфигурация VLAN   
__|__
--|--
|
Example 8-2 shows how to configure a VLAN and add two ports to the VLAN as access ports.|В примере 8-2 показано, как настроить VLAN и добавить два порта к VLAN в качестве портов доступа.
Example 8-4 does the same, this time with VLAN 3, and this time with a much briefer alternative configuration.|Пример 8-4 делает то же самое, на этот раз с VLAN 3, но на этот раз с гораздо более короткой альтернативной конфигурацией.
The configuration completes the configuration of the design shown in Figure 8-9, by adding two ports to VLAN 3.|Конфигурация завершает настройку схемы, показанной на рисунке 8-9, путем добавления двух портов к VLAN 3.
|
Example 8-4 Shorter VLAN Configuration Example (VLAN 3)|Пример 8-4 Пример конфигурации более короткой VLAN (VLAN 3)
|
Example end.|Пример конец.
|
Example 8-2 shows how a switch can dynamically create a VLAN—the equivalent of the vlan vlan-id global config command—when the switchport access vlan interface subcommand refers to a currently unconfigured VLAN. This example begins with SW1 not knowing about VLAN 3.|В примере 8-2 показано, как коммутатор может динамически создавать VLAN - эквивалент команды глобальной конфигурации vlan vlan-id - когда подкоманда интерфейса vlan для доступа к порту коммутатора относится к ненастроенной в настоящее время VLAN. Этот пример начинается с того, что SW1 не знает о VLAN 3.
With the addition of the switchport access vlan 3 interface subcommand, the switch realized that VLAN 3 did not exist, and as noted in the shaded message in the example, the switch created VLAN 3, using a default name (VLAN0003).|С добавлением подкоманды интерфейса switchport access vlan 3 коммутатор понял, что VLAN 3 не существует, и, как отмечено в затененном сообщении в примере, коммутатор создал VLAN 3, используя имя по умолчанию (VLAN0003).
The engineer did not need to type the vlan 3 global command to create VLAN 3; the switch did that automatically.|Инженеру не нужно было вводить глобальную команду vlan 3 для создания VLAN 3; переключатель сделал это автоматически.
|
No other steps are required to create the VLAN. At the end of the process, VLAN 3 exists in the switch, and interfaces Fa0/15 and Fa0/16 are in VLAN 3, as noted in the shaded part of the show vlan brief command output.|Никаких других шагов для создания VLAN не требуется. В конце процесса VLAN 3 существует в коммутаторе, а интерфейсы Fa0 / 15 и Fa0 / 16 находятся в VLAN 3, как отмечено в затененной части выходных данных команды show vlan Short.
#### VLAN Trunking Protocol
Протокол транкинга VLAN   
__|__
--|--
|
Before showing more configuration examples, you also need to know something about a Cisco protocol and tool called the VLAN Trunking Protocol (VTP). VTP is a Cisco proprietary tool on Cisco switches that advertises each VLAN configured in one switch (with the vlan number command) so that all the other switches in the campus learn about that VLAN.|Прежде чем показывать дополнительные примеры конфигурации, вам также необходимо кое-что узнать о протоколе Cisco и инструменте, который называется протоколом VLAN Trunking Protocol (VTP). VTP - это проприетарный инструмент Cisco на коммутаторах Cisco, который объявляет каждую VLAN, настроенную на одном коммутаторе (с помощью команды номера vlan), чтобы все остальные коммутаторы в кампусе узнали об этой VLAN.
|
This book does not discuss VTP as an end to itself for a few different reasons.|В этой книге VTP не рассматривается как самоцель по нескольким причинам.
First, the current CCNA 200-301 exam blueprint ignores VTP, as do the CCNP Enterprise Core and CCNP Enterprise Advanced Routing blueprints.|Во-первых, текущая схема экзамена CCNA 200-301 игнорирует VTP, как и схемы CCNP Enterprise Core и CCNP Enterprise Advanced Routing.
Additionally, many enterprises choose to disable VTP.|Кроме того, многие предприятия предпочитают отключать VTP.
|
Also, you can easily disable VTP so that it has no impact on your switches in the lab, which is exactly what I did when building all the examples in this book.|Кроме того, вы можете легко отключить VTP, чтобы он не повлиял на работу ваших коммутаторов в лаборатории, что я и сделал при создании всех примеров в этой книге.
|
However, VTP has some small impact on how every Cisco Catalyst switch works, even if you do not try to use VTP. This brief section introduces enough details of VTP so that you can see these small differences in VTP that cannot be avoided.|Однако VTP оказывает небольшое влияние на работу каждого коммутатора Cisco Catalyst, даже если вы не пытаетесь использовать VTP. В этом кратком разделе представлено достаточно подробностей о VTP, чтобы вы могли увидеть эти небольшие различия в VTP, которых невозможно избежать.
|
First, all examples in this book (and in Volume 2) use switches that disable VTP in some way.|Во-первых, во всех примерах в этой книге (и в томе 2) используются переключатели, которые каким-либо образом отключают VTP.
|
Interestingly, for much of VTP’s decades of existence, most switches did not allow VTP to be disabled completely; on those switches, to effectively disable VTP, the engineer would set the switch to use VTP transparent mode (with the vtp mode transparent global command).|Интересно, что на протяжении большей части десятилетий существования VTP большинство коммутаторов не позволяли полностью отключить VTP; на этих коммутаторах, чтобы эффективно отключить VTP, инженер установил бы коммутатор на использование прозрачного режима VTP (с помощью глобальной команды vtp mode transparent).
|
Some switches now have an option to disable VTP completely with the vtp mode off global command.|Некоторые коммутаторы теперь имеют возможность полностью отключить VTP с помощью глобальной команды vtp mode off.
For the purposes of this book, configuring a switch with either transparent mode or off mode disables VTP.|Для целей этой книги настройка коммутатора либо в прозрачном, либо в выключенном режиме отключает VTP.
|
Note that both transparent and off modes prevent VTP from learning and advertising about VLAN configuration.|Обратите внимание, что как прозрачный, так и выключенный режимы не позволяют VTP узнавать и рекламировать конфигурацию VLAN.
Those modes allow a switch to configure all VLANs, including standard-|Эти режимы позволяют коммутатору настраивать все VLAN, включая стандартные -
|
and extended-range VLANs. Additionally, switches using transparent or off modes list the vlan configuration commands in the running-config file.|и сети VLAN с расширенным диапазоном. Кроме того, коммутаторы, использующие прозрачный или выключенный режимы, перечисляют команды конфигурации vlan в файле рабочей конфигурации.
|
Finally, on a practical note, if you happen to do lab exercises with real switches or with simulators, and you see unusual results with VLANs, check the VTP status with the show vtp status command.|Наконец, практическое замечание: если вы выполняете лабораторные упражнения с настоящими коммутаторами или симуляторами и видите необычные результаты с VLAN, проверьте статус VTP с помощью команды show vtp status.
If your switch uses VTP server or client mode, you will find|Если ваш коммутатор использует режим VTP-сервера или клиента, вы найдете
###### The server switches can configure VLANs in the standard range only (1–1005).
Серверные коммутаторы могут настраивать VLAN только в стандартном диапазоне (1–1005).   
###### The client switches cannot configure VLANs.
Клиентские коммутаторы не могут настраивать VLAN.   
###### Both servers and clients may be learning new VLANs from other switches and seeing
И серверы, и клиенты могут изучать новые VLAN от других коммутаторов и видеть   
__|__
--|--
|
their VLANs deleted by other switches because of VTP.|их VLAN удалены другими коммутаторами из-за VTP.
###### The show running-config command does not list any vlan commands; you must use
Команда show running-config не отображает никаких команд vlan; ты должен использовать   
__|__
--|--
|
other show commands to find out about the configured VLANs.|другие команды show, чтобы узнать о настроенных VLAN.
|
If possible in the lab, switch to disable VTP and ignore VTP for your switch configuration practice until you decide to learn more about VTP for other purposes.|Если это возможно в лабораторных условиях, отключите VTP и игнорируйте VTP при настройке коммутатора, пока вы не решите больше узнать о VTP для других целей.
|
NOTE Do not change VTP settings on any switch that also connects to the production network until you know how VTP works and you talk with experienced colleagues.|ПРИМЕЧАНИЕ. Не изменяйте настройки VTP на любом коммутаторе, который также подключается к производственной сети, пока вы не узнаете, как работает VTP, и не поговорите с опытными коллегами.
Doing so can cause real harm to your LAN. For example, if the switch you configure connects to other switches, which in turn connect to switches used in the production LAN, you could accidentally change the VLAN configuration in other switches with serious impact to the operation of the network.|Это может нанести серьезный вред вашей локальной сети. Например, если настраиваемый коммутатор подключается к другим коммутаторам, которые, в свою очередь, подключаются к коммутаторам, используемым в производственной локальной сети, вы можете случайно изменить конфигурацию VLAN в других коммутаторах, что серьезно повлияет на работу сети.
You could delete VLANs and cause outages.|Вы можете удалить сети VLAN и вызвать сбои в работе.
Be careful and never experiment with VTP settings on a switch unless it and the other switches connected to it have absolutely no physical links connected to the production LAN.|Будьте осторожны и никогда не экспериментируйте с настройками VTP на коммутаторе, если он и другие подключенные к нему коммутаторы не имеют абсолютно никаких физических каналов, подключенных к производственной локальной сети.
#### VLAN Trunking Configuration
Конфигурация транкинга VLAN   
__|__
--|--
|
Trunking configuration between two Cisco switches can be very simple if you just statically configure trunking.|Конфигурация транкинга между двумя коммутаторами Cisco может быть очень простой, если вы просто статически настроите транкинг.
For example, most Cisco Catalyst switches today support only 802.1Q and not ISL. You could literally add one interface subcommand for the switch interface on each side of the link (switchport mode trunk), and you would create a VLAN trunk that supported all the VLANs known to each switch.|Например, большинство коммутаторов Cisco Catalyst сегодня поддерживают только 802.1Q, но не ISL. Вы можете буквально добавить одну подкоманду интерфейса для интерфейса коммутатора на каждой стороне канала (магистраль режима порта коммутатора) и создать магистраль VLAN, которая поддерживает все сети VLAN, известные каждому коммутатору.
|
However, trunking configuration on Cisco switches includes many more options, including several options for dynamically negotiating various trunking settings.|Однако конфигурация транкинга на коммутаторах Cisco включает гораздо больше опций, в том числе несколько опций для динамического согласования различных настроек транкинга.
The configuration can either predefine different settings or tell the switch to negotiate the settings, as follows:|Конфигурация может либо предопределять различные настройки, либо указывать коммутатору на согласование настроек следующим образом:
###### The type of trunking: IEEE 802.1Q, ISL, or negotiate which one to use, on switches that
Тип транкинга: IEEE 802.1Q, ISL или согласовать, какой из них использовать, на коммутаторах, которые   
__|__
--|--
|
support both types of trunking.|поддерживают оба типа транкинга.
###### The administrative mode: Whether to always trunk, always not trunk, or negotiate
Административный режим: всегда ли транк, всегда не транк, или согласовывать   
__|__
--|--
|
whether to trunk or not.|в багажник или нет.
|
First, consider the type of trunking.|Сначала рассмотрим тип транкинга.
Cisco switches that support ISL and 802.1Q can negotiate which type to use, using the Dynamic Trunking Protocol (DTP). If both switches support both protocols, they use ISL; otherwise, they use the protocol that both support.|Коммутаторы Cisco, поддерживающие ISL и 802.1Q, могут согласовывать, какой тип использовать, с помощью протокола динамического транкинга (DTP). Если оба коммутатора поддерживают оба протокола, они используют ISL; в противном случае они используют протокол, который поддерживают оба.
Today, many Cisco switches do not support the older ISL trunking protocol.|Сегодня многие коммутаторы Cisco не поддерживают старый протокол транкинга ISL.
Switches that support both types of trunking use the switchport trunk encapsulation {dot1q | isl | negotiate} interface subcommand to either configure the type or allow DTP to negotiate the type.|Коммутаторы, поддерживающие оба типа транкинга, используют инкапсуляцию транка порта коммутатора {dot1q | isl | gotiate}, чтобы настроить тип или разрешить DTP согласовывать тип.
|
DTP can also negotiate whether the two devices on the link agree to trunk at all, as guided by the local switch port’s administrative mode.|DTP может также согласовывать, согласны ли два устройства в канале на транк вообще, в соответствии с административным режимом порта локального коммутатора.
The administrative mode refers to the configuration setting for whether trunking should be used.|Под административным режимом понимается настройка конфигурации, указывающая, следует ли использовать транкинг.
Each interface also has an operational mode, which refers to what is currently happening on the interface and might have been chosen by DTP’s negotiation with the other device.|У каждого интерфейса также есть рабочий режим, который относится к тому, что в данный момент происходит на интерфейсе, и мог быть выбран при согласовании DTP с другим устройством.
Cisco switches use the switchport mode interface subcommand to define the administrative trunking mode, as listed in Table 8-2.|Коммутаторы Cisco используют подкоманду интерфейса switchport mode для определения административного режима транкинга, как указано в Таблице 8-2.
|
Table 8-2 Trunking Administrative Mode Options with the switchport mode Command Table end.|Таблица 8-2 Параметры административного режима транкинга с таблицей команд режима switchport end.
|
For example, consider the two switches shown in Figure 8-10.|Например, рассмотрим два переключателя, показанных на рисунке 8-10.
This figure expands the design shown earlier in Figure 8-9, with a trunk to a new switch (SW2) and with parts of VLANs 1 and 3 on ports attached to SW2. The two switches use a Gigabit Ethernet link for the trunk.|Этот рисунок расширяет схему, показанную ранее на Рисунке 8-9, с магистралью к новому коммутатору (SW2) и частями VLAN 1 и 3 на портах, подключенных к SW2. Два коммутатора используют канал Gigabit Ethernet для магистрали.
|
In this case, the trunk does not dynamically form by default because both (2960) switches default to an administrative mode of dynamic auto, meaning that neither switch initiates the trunk negotiation process.|В этом случае магистраль не формируется динамически по умолчанию, потому что оба переключателя (2960) по умолчанию переходят в административный режим динамического автоматического режима, что означает, что ни один из коммутаторов не инициирует процесс согласования магистрали.
When one switch is changed to use dynamic desirable mode, which does initiate the negotiation, the switches negotiate to use trunking, specifically 802.1Q because the 2960s support only 802.1Q.|Когда один коммутатор переключается на использование динамического желательного режима, который инициирует согласование, коммутаторы согласовывают использование транкинга, в частности 802.1Q, поскольку 2960 поддерживают только 802.1Q.
|
Figure 8-10 Network with Two Switches and Three VLANs Example 8-5 begins with SW1 configured as shown in Examples 8-2 and 8-4—that is, SW1 has two ports each assigned to VLANs 1, 2, and 3.|Рис. 8-10 Сеть с двумя коммутаторами и тремя VLAN. Пример 8-5 начинается с SW1, настроенного, как показано в примерах 8-2 и 8-4, то есть SW1 имеет два порта, каждый из которых назначен для VLAN 1, 2 и 3.
However, both SW1 and SW2 currently have all default settings on the interfaces that connect the two switches.|Однако и SW1, и SW2 в настоящее время имеют все настройки по умолчанию на интерфейсах, которые соединяют два переключателя.
With the default setting of switchport mode dynamic auto, the two switches do not trunk.|При настройке по умолчанию динамического автоматического режима порта коммутатора два коммутатора не соединяются.
|
Example 8-5 Initial Default State: Not Trunking Between SW1 and SW2 Example end.|Пример 8-5 Исходное состояние по умолчанию: не транкинг между SW1 и SW2 Пример конец.
|
First, focus on the highlighted items from the output of the show interfaces switchport command at the beginning of Example 8-3.|Во-первых, сфокусируйтесь на выделенных элементах из выходных данных команды show interfaces switchport в начале примера 8-3.
The output lists the default administrative mode setting of dynamic auto.|В выходных данных перечислены настройки административного режима по умолчанию - динамический автоматический.
Because SW2 also defaults to dynamic auto, the command lists SW1’s operational status as “access,” meaning that it is not trunking. (“Dynamic auto” tells both switches to sit there and wait on the other switch to start the negotiations.) The third shaded line points out the only supported type of trunking (802.1Q). (On a switch that supports both ISL and 802.1Q, this value would by default list “negotiate,” to mean that the type of encapsulation is negotiated.) Finally, the operational trunking type is listed as “native,”|Поскольку SW2 также по умолчанию использует динамический автоматический режим, команда указывает рабочее состояние SW1 как «доступ», что означает, что он не является транкинговым. («Динамический автоматический» указывает обоим коммутаторам сидеть и ждать на другом коммутаторе, чтобы начать переговоры.) Третья заштрихованная линия указывает на единственный поддерживаемый тип транкинга (802.1Q). (На коммутаторе, который поддерживает как ISL, так и 802.1Q, для этого значения по умолчанию будет указано «согласование», что означает, что тип инкапсуляции согласован.) И наконец, рабочий тип транкинга указан как «собственный»,
|
which is a reference to the 802.1Q native VLAN.|который является ссылкой на собственную сеть VLAN 802.1Q.
|
The end of the example shows the output of the show interfaces trunk command, but with no output.|В конце примера показан вывод команды show interfaces trunk, но без вывода.
This command lists information about all interfaces that currently operationally trunk; that is, it lists interfaces that currently use VLAN trunking.|Эта команда выводит информацию обо всех интерфейсах, которые в настоящее время работают через транкинг; то есть в нем перечислены интерфейсы, которые в настоящее время используют транкинг VLAN.
With no interfaces listed, this command also confirms that the link between switches is not trunking.|При отсутствии в списке интерфейсов эта команда также подтверждает, что канал между коммутаторами не является транкинговым.
|
Next, consider Example 8-6, which shows the new configuration that enables trunking.|Затем рассмотрим пример 8-6, в котором показана новая конфигурация, разрешающая транкинг.
In this case, SW1 is configured with the switchport mode dynamic desirable command, which asks the switch to both negotiate as well as to begin the negotiation process, rather than waiting on the other device.|В этом случае SW1 сконфигурирован с помощью команды switchport mode dynamic желательно, которая просит коммутатор как согласовать, так и начать процесс согласования, а не ждать на другом устройстве.
The example shows that as soon as the command is issued, log messages appear showing that the interface goes down and then back up again, which happens when the interface transitions from access mode to trunk mode.|В примере показано, что как только команда выдается, появляются сообщения журнала, показывающие, что интерфейс отключается, а затем снова включается, что происходит, когда интерфейс переходит из режима доступа в режим магистрали.
|
Example 8-6 SW1 Changes from Dynamic Auto to Dynamic Desirable Example end.|Пример 8-6 SW1 переключается с динамического автоматического на динамический. Желаемый конец примера.
|
Example 8-6 repeats the show interfaces gi0/1 switchport command seen in Example 8-5, but after configuring VLAN trunking, so this time the output shows that SW1’s G0/1 interface now operates as a trunk.|В примере 8-6 повторяется команда show interfaces gi0 / 1 switchport, показанная в примере 8-5, но после настройки транкинга VLAN, поэтому на этот раз выходные данные показывают, что интерфейс G0 / 1 SW1 теперь работает как транк.
Note that the command still lists the administrative settings, which denote the configured values along with the operational settings, which list what the switch is currently doing.|Обратите внимание, что в команде по-прежнему перечислены административные параметры, которые обозначают настроенные значения, а также рабочие параметры, в которых перечислены текущие действия коммутатора.
SW1 now claims to be in an operational mode of trunk, with an operational trunking encapsulation of dot1Q.|SW1 теперь утверждает, что находится в рабочем режиме магистрали с инкапсуляцией точки1Q в оперативную магистраль.
|
Example 8-7 now repeats the same show interfaces trunk command that showed no output at all back in Example 8-5.|В примере 8-7 теперь повторяется та же команда show interfaces trunk, которая в примере 8-5 не показывала никаких выходных данных.
Now that SW1 trunks on its G0/1 port, the output in Example 8-7 lists G0/1, confirming that G0/1 is now operationally trunking.|Теперь, когда SW1 соединяется со своим портом G0 / 1, в выходных данных примера 8-7 отображается G0 / 1, подтверждающий, что G0 / 1 теперь работает в режиме транкинга.
The next section discusses the meaning of the output of this command.|В следующем разделе обсуждается значение вывода этой команды.
Also, note that the end of the example repeats the show vlan id 2 command; of note, it includes the trunk port G0/1 in the output because the trunk port can forward traffic in VLAN 2.|Также обратите внимание, что в конце примера повторяется команда show vlan id 2; Следует отметить, что он включает в себя магистральный порт G0 / 1 в выходных данных, поскольку магистральный порт может пересылать трафик в VLAN 2.
|
Example 8-7 A Closer Look at SW1’s G0/1 Trunk Port Example end.|Пример 8-7. Более пристальный взгляд на конец примера магистрального порта G0 / 1 коммутатора SW1.
|
For the exams, you should be ready to interpret the output of the show interfaces switchport command, realize the administrative mode implied by the output, and know whether the link should operationally trunk based on those settings.|К экзаменам вы должны быть готовы интерпретировать выходные данные команды show interfaces switchport, осознавать административный режим, подразумеваемый выходными данными, и знать, должна ли линия связи в оперативном режиме соединяться с этими параметрами.
Table 8-3 lists the combinations of the trunking administrative modes and the expected operational mode (trunk or access) resulting from the configured settings.|В Таблице 8-3 перечислены сочетания административных режимов транкинга и ожидаемого рабочего режима (соединительный канал или доступ) в результате заданных параметров.
The table lists the administrative mode used on one end of the link on the left, and the administrative mode on the switch on the other end of the link across the top of the table.|В таблице перечислены административный режим, используемый на одном конце ссылки слева, и административный режим на переключателе на другом конце ссылки в верхней части таблицы.
|
Table 8-3 Expected Trunking Operational Mode Based on the Configured Administrative Table end.|Таблица 8-3 Ожидаемый рабочий режим транкинга на основе сконфигурированной административной таблицы.
|
1 When two switches configure a mode of “access” on one end and “trunk” on the other, problems occur.|1 Когда два коммутатора настраивают режим «доступа» на одном конце и «магистрали» на другом, возникают проблемы.
|
Avoid this combination.|Избегайте этой комбинации.
|
Finally, before leaving the discussion of configuring trunks, Cisco recommends disabling trunk negotiation on most ports for better security.|Наконец, прежде чем прекратить обсуждение настройки соединительных линий, Cisco рекомендует отключить согласование соединительных линий на большинстве портов для повышения безопасности.
The majority of switch ports on most switches will be used to connect to users and configured with the command switchport mode access—which also disables DTP. For ports without the switchport mode access command—for instance, ports statically configured to trunk with the switchport mode trunk command—DTP still operates, but you can disable DTP negotiations altogether using the switchport nonegotiate interface subcommand.|Большинство портов коммутаторов на большинстве коммутаторов будут использоваться для подключения к пользователям и настроены с помощью команды switchport mode access, которая также отключает DTP. Для портов без команды доступа к режиму switchport - например, порты, статически настроенные для транкинга с помощью команды switchport mode trunk - DTP по-прежнему работает, но вы можете полностью отключить согласование DTP с помощью подкоманды интерфейса switchport nonegotiate.
#### Implementing Interfaces Connected to Phones
Реализация интерфейсов, подключенных к телефонам   
__|__
--|--
|
This next topic is strange, at least in the context of access links and trunk links.|Следующая тема выглядит странно, по крайней мере, в контексте ссылок доступа и магистральных ссылок.
In the world of IP telephony, telephones use Ethernet ports to connect to an Ethernet network so they can use IP to send and receive voice traffic sent via IP packets.|В мире IP-телефонии телефоны используют порты Ethernet для подключения к сети Ethernet, поэтому они могут использовать IP для отправки и получения голосового трафика, отправляемого через IP-пакеты.
To make that work, the switch’s Ethernet port acts like an access port, but at the same time, the port acts like a trunk in some ways.|Чтобы это работало, порт Ethernet коммутатора действует как порт доступа, но в то же время порт в некотором смысле действует как магистраль.
This last topic of the chapter works through those main concepts.|В последней теме главы рассматриваются эти основные концепции.
##### Data and Voice VLAN Concepts
Концепции VLAN для передачи данных и голоса   
__|__
--|--
|
Before IP telephony, a PC could sit on the same desk as a phone.|До появления IP-телефонии ПК мог стоять на одном столе с телефоном.
The phone happened to use UTP cabling, with that phone connected to some voice device (often called a voice switch or a private branch exchange [PBX]).|В телефоне использовался кабель UTP, при этом телефон был подключен к какому-либо голосовому устройству (часто называемому коммутатором голоса или частной телефонной станцией [PBX]).
The PC, of course, connected using an unshielded twisted-pair (UTP) cable to the usual LAN switch that sat in the wiring closet—sometimes in the same wiring closet as the voice switch.|Компьютер, конечно же, был подключен с помощью неэкранированной витой пары (UTP) к обычному коммутатору LAN, который находился в коммутационном шкафу - иногда в том же коммутационном шкафу, что и голосовой переключатель.
Figure 8-11 shows the idea.|На рис. 8-11 показана идея.
|
Figure 8-11 Before IP Telephony: PC and Phone, One Cable Each, Connect to Two Different Devices The term IP telephony refers to the branch of networking in which the telephones use IP packets to send and receive voice as represented by the bits in the data portion of the IP packet.|Рисунок 8-11 Перед IP-телефонией: ПК и телефон, каждый по одному кабелю, подключение к двум разным устройствам Термин IP-телефония относится к той ветви сети, в которой телефоны используют IP-пакеты для отправки и получения голоса, что представлено битами в часть данных IP-пакета.
The phones connect to the network like most other end-user devices, using either Ethernet or Wi-Fi. These new IP phones did not connect via cable directly to a voice switch, instead connecting to the IP network using an Ethernet cable and an Ethernet port built in to the phone.|Телефоны подключаются к сети, как и большинство других устройств конечных пользователей, через Ethernet или Wi-Fi. Эти новые IP-телефоны не подключались с помощью кабеля напрямую к коммутатору голосовой связи, а подключались к IP-сети с помощью кабеля Ethernet и порта Ethernet, встроенного в телефон.
The phones then communicated over the IP network with software that replaced the call setup and other functions of the PBX. (The current products from Cisco that perform this IP telephony control function are called Cisco Unified Communication Manager.)|Затем телефоны обменивались данными по IP-сети с помощью программного обеспечения, которое заменило настройку вызова и другие функции УАТС. (Текущие продукты Cisco, которые выполняют эту функцию управления IP-телефонией, называются Cisco Unified Communication Manager.)
|
The migration from using the already-installed telephone cabling to these new IP phones that needed UTP cables that supported Ethernet caused some problems in some offices.|Переход от использования уже установленных телефонных кабелей к этим новым IP-телефонам, для которых требовались кабели UTP с поддержкой Ethernet, вызвал некоторые проблемы в некоторых офисах.
In particular:|Особенно:
###### The older non-IP phones used a category of UTP cabling that often did not support 100-
В старых не IP-телефонах использовалась категория кабелей UTP, которые часто не поддерживали 100-   
__|__
--|--
|
Mbps or 1000-Mbps Ethernet.|Ethernet или 1000 Мбит / с.
###### Most offices had a single UTP cable running from the wiring closet to each desk, but now
В большинстве офисов был один кабель UTP, идущий от коммутационного шкафа к каждому столу, но теперь   
__|__
--|--
|
two devices (the PC and the new IP phone) both needed a cable from the desktop to the wiring closet.|для двух устройств (ПК и нового IP-телефона) требовался кабель от рабочего стола к коммутационному шкафу.
###### Installing a new cable to every desk would be expensive, plus you would need more
Установка нового кабеля на каждый стол обойдется дорого, к тому же вам понадобится больше   
__|__
--|--
|
switch ports.|переключать порты.
|
To solve this problem, Cisco embedded small three-port switches into each phone.|Чтобы решить эту проблему, Cisco встроила в каждый телефон небольшие трехпортовые коммутаторы.
|
IP telephones have included a small LAN switch, on the underside of the phone, since the earliest IP telephone products.|IP-телефоны включают в себя небольшой переключатель LAN на нижней стороне телефона, начиная с самых ранних IP-телефонов.
Figure 8-12 shows the basic cabling, with the wiring closet cable connecting to one physical port on the embedded switch, the PC connecting with a short patch cable to the other physical port, and the phone’s internal CPU connecting to an internal switch port.|На Рис. 8-12 показаны основные кабели: кабель коммутационного шкафа подключается к одному физическому порту встроенного коммутатора, ПК подключается с помощью короткого соединительного кабеля к другому физическому порту, а внутренний ЦП телефона подключается к внутреннему порту коммутатора.
|
Figure 8-12 Cabling with an IP Phone, a Single Cable, and an Integrated Switch Sites that use IP telephony, which includes almost every company today, now have two devices off each access port.|Рис. 8-12. Кабельная проводка с IP-телефоном, одним кабелем и интегрированным коммутатором. На сайтах, использующих IP-телефонию, к которым сегодня относятся почти все компании, теперь есть два устройства на каждом порту доступа.
In addition, Cisco best practices for IP telephony design tell us to put the phones in one VLAN and the PCs in a different VLAN. To make that happen, the switch port acts a little like an access link (for the PC’s traffic), and a little like a trunk (for the phone’s traffic).|Кроме того, лучшие практики Cisco в области проектирования IP-телефонии говорят нам размещать телефоны в одной VLAN, а ПК - в другой VLAN. Для этого порт коммутатора действует как канал доступа (для трафика ПК) и как транк (для трафика телефона).
The configuration defines two VLANs on that port, as follows:|Конфигурация определяет две сети VLAN на этом порту следующим образом:
|
Data VLAN: Same idea and configuration as the access VLAN on an access port but defined as the VLAN on that link for forwarding the traffic for the device connected to the phone on the desk (typically the user’s PC).|Data VLAN: та же идея и конфигурация, что и VLAN доступа на порту доступа, но определяется как VLAN на этом канале для перенаправления трафика для устройства, подключенного к телефону на столе (обычно это ПК пользователя).
|
Voice VLAN: The VLAN defined on the link for forwarding the phone’s traffic.|Голосовая VLAN: VLAN, определенная в ссылке для пересылки телефонного трафика.
Traffic in this VLAN is typically tagged with an 802.1Q header.|Трафик в этой VLAN обычно помечается заголовком 802.1Q.
|
Figure 8-13 illustrates this design with two VLANs on access ports that support IP telephones.|На рис. 8-13 показана эта конструкция с двумя виртуальными локальными сетями на портах доступа, которые поддерживают IP-телефоны.
|
VLAN 11 VLAN 10 IP IP IP IP Voice VLAN Data VLAN figure 8-13 A LAN Design, with Data in VLAN 10 and Phones in VLAN 11|VLAN 11 VLAN 10 IP IP IP Голосовой IP VLAN Данные VLAN рисунок 8-13 Схема локальной сети с данными в VLAN 10 и телефонами в VLAN 11
##### Data and Voice VLAN Configuration and Verification
Конфигурация и проверка VLAN для передачи данных и голоса   
__|__
--|--
|
Configuring a switch port to support IP phones, once you know the planned voice and data VLAN IDs, requires just a few easy commands.|Для настройки порта коммутатора для поддержки IP-телефонов после того, как вы узнаете запланированные идентификаторы VLAN для передачи голоса и данных, потребуется всего несколько простых команд.
Making sense of the show commands once it is configured, however, can be a challenge.|Однако понимание команд show после их настройки может быть проблемой.
The port acts like an access port in many ways.|Порт во многом действует как порт доступа.
|
However, with most configuration options, the voice frames flow with an 802.1Q header, so that the link supports frames in both VLANs on the link.|Однако в большинстве вариантов конфигурации голосовые кадры передаются с заголовком 802.1Q, поэтому канал поддерживает кадры в обеих виртуальных локальных сетях канала.
But that makes for some different show command output.|Но это делает вывод команды show по-другому.
|
Example 8-8 shows an example configuration.|В примере 8-8 показан пример конфигурации.
In this case, all four switch ports F0/1–F0/4 begin with default configuration.|В этом случае все четыре порта коммутатора F0 / 1 – F0 / 4 начинаются с конфигурации по умолчанию.
The configuration adds the new data and voice VLANs.|Конфигурация добавляет новые сети VLAN для передачи данных и голоса.
|
The example then configures all four ports as access ports and defines the access VLAN, which is also called the data VLAN when discussing IP telephony.|Затем в примере настраиваются все четыре порта как порты доступа и определяется VLAN доступа, которая также называется VLAN данных при обсуждении IP-телефонии.
Finally, the configuration includes the switchport voice vlan 11 command, which defines the voice VLAN used on the port.|Наконец, конфигурация включает команду switchport voice vlan 11, которая определяет голосовую VLAN, используемую на порту.
The example matches Figure 8-13, using ports F0/1–F0/4.|Пример соответствует рисунку 8-13 с использованием портов F0 / 1 – F0 / 4.
|
Example 8-8 Configuring the Voice and Data VLAN on Ports Connected to Phones Example end.|Пример 8-8 Настройка VLAN для передачи голоса и данных на портах, подключенных к телефонам. Пример конец.
|
Chapter 9, “Device Management Protocols,” must be enabled on an interface for a voice access port to work with Cisco IP phones.|Глава 9 «Протоколы управления устройством» должна быть включена на интерфейсе, чтобы порт голосового доступа работал с IP-телефонами Cisco.
Cisco switches and routers enable CDP by default, so its configuration is not shown here.|Коммутаторы и маршрутизаторы Cisco включают CDP по умолчанию, поэтому его конфигурация здесь не показана.
|
The following list details the configuration steps for easier review and study:|В следующем списке подробно описаны шаги настройки для облегчения просмотра и изучения:
|
Step 1.|Шаг 1.
Use the vlan vlan-id command in global configuration mode to create the data and voice VLANs if they do not already exist on the switch.|Используйте команду vlan vlan-id в режиме глобальной конфигурации для создания сетей VLAN для передачи данных и голоса, если они еще не существуют на коммутаторе.
|
Step 2.|Шаг 2.
Configure the data VLAN like an access VLAN, as usual:|Настройте VLAN данных как VLAN доступа, как обычно:
|
A. Use the interface type number command global configuration mode to move into interface configuration mode.|A. Используйте режим глобальной конфигурации команды номера типа интерфейса, чтобы перейти в режим конфигурации интерфейса.
|
B. Use the switchport access vlan id-number command in interface configuration mode to define the data VLAN.|B. Используйте команду switchport access vlan id-number в режиме настройки интерфейса, чтобы определить VLAN данных.
|
C. Use the switchport mode access command in interface configuration mode to make this port always operate in access mode (that is, to not trunk).|C. Используйте команду switchport mode access в режиме настройки интерфейса, чтобы этот порт всегда работал в режиме доступа (то есть не в магистральном режиме).
|
Step 3.|Шаг 3.
Use the switchport voice vlan id-number command in interface configuration mode to set the voice VLAN ID.|Используйте команду switchport voice vlan id-number в режиме настройки интерфейса, чтобы установить идентификатор голосовой VLAN.
|
Config Checklist Verifying the status of a switch port configured like Example 8-8 shows some different output compared to the pure access port and pure trunk port configurations seen earlier in this chapter.|Контрольный список конфигурации При проверке состояния порта коммутатора, настроенного, как в примере 8-8, выходные данные несколько отличаются по сравнению с конфигурациями чистого порта доступа и чистого транкового порта, рассмотренными ранее в этой главе.
For example, the show interfaces switchport command shows details about the operation of an interface, including many details about access ports.|Например, команда show interfaces switchport показывает подробные сведения о работе интерфейса, включая многие сведения о портах доступа.
Example 8-9 shows those details for port F0/4 after the configuration in Example 8-8 was added.|В примере 8-9 показаны эти подробности для порта F0 / 4 после добавления конфигурации из примера 8-8.
|
Example 8-9 Verifying the Data VLAN (Access VLAN) and Voice VLAN Example end.|Пример 8-9 Проверка VLAN данных (VLAN доступа) и голосовой VLAN Пример конец.
|
Working through the first three highlighted lines in the output, all those details should look familiar for any access port.|Проработав первые три выделенные строки в выходных данных, все эти детали должны быть знакомы для любого порта доступа.
The switchport mode access configuration command statically configures the administrative mode to be an access port, so the port of course operates as an access port.|Команда настройки доступа в режиме switchport статически настраивает административный режим как порт доступа, поэтому порт, конечно же, работает как порт доступа.
Also, as shown in the third highlighted line, the switchport access vlan 10 configuration command defined the access mode VLAN as highlighted here.|Кроме того, как показано в третьей выделенной строке, команда конфигурации switchport access vlan 10 определила VLAN режима доступа, как показано здесь.
|
The fourth highlighted line shows the one small new piece of information: the voice VLAN ID, as set with the switchport voice vlan 11 command in this case.|Четвертая выделенная строка показывает одну небольшую новую информацию: идентификатор голосовой VLAN, установленный в этом случае с помощью команды switchport voice vlan 11.
This small line of output is the only piece of information in the output that differs from the earlier access port examples in this chapter.|Эта небольшая строка вывода - единственная часть информации в выводе, которая отличается от предыдущих примеров порта доступа в этой главе.
|
These ports act more like access ports than trunk ports.|Эти порты больше похожи на порты доступа, чем на магистральные порты.
In fact, the show interfaces type number switchport command boldly proclaims, “Operational Mode: static access.”|Фактически, команда show interfaces type number switchport смело заявляет: «Рабочий режим: статический доступ».
|
However, one other show command reveals just a little more about the underlying operation with 802.1Q tagging for the voice frames.|Однако еще одна команда show раскрывает немного больше о базовой операции с тегированием 802.1Q для голосовых кадров.
|
As mentioned earlier, the show interfaces trunk command—that is, the command that does not include a specific interface in the middle of the command—lists the operational trunks on a switch.|Как упоминалось ранее, команда show interfaces trunk, то есть команда, которая не включает конкретный интерфейс в середине команды, перечисляет рабочие соединительные линии на коммутаторе.
With IP telephony ports, the ports do not show up in the list of trunks either—|При использовании портов IP-телефонии эти порты также не отображаются в списке соединительных линий -
|
providing evidence that these links are not treated as trunks.|предоставление доказательств того, что эти ссылки не рассматриваются как транки.
Example 8-10 shows just such an example.|Пример 8-10 показывает именно такой пример.
|
However, the show interfaces trunk command with the interface listed in the middle of the command, as is also shown in Example 8-10, does list some additional information.|Однако команда show interfaces trunk с интерфейсом, указанным в середине команды, как также показано в примере 8-10, действительно перечисляет некоторую дополнительную информацию.
Note that in this case, the show interfaces F0/4 trunk command lists the status as not-trunking, but with VLANs 10 and 11 allowed on the trunk. (Normally, on an access port, only the access VLAN is listed in the “VLANs allowed on the trunk” list in the output of this command.)|Обратите внимание, что в этом случае команда show interfaces F0 / 4 trunk указывает статус как «не транкинг», но с разрешенными на магистрали VLAN 10 и 11. (Обычно для порта доступа только VLAN доступа указывается в списке «VLAN, разрешенные на магистрали» в выходных данных этой команды.)
|
Example 8-10 Allowed VLAN List and the List of Active VLANs Example end.|Пример 8-10. Список разрешенных VLAN и список активных VLAN. Пример конец.
##### Summary: IP Telephony Ports on Switches
Обзор: порты IP-телефонии на коммутаторах   
__|__
--|--
|
It might seem as though this short topic about IP telephony and switch configuration includes a lot of small twists and turns and trivia, and it does.|Может показаться, что этот краткий раздел об IP-телефонии и настройке коммутатора включает в себя множество мелких ухищрений и мелочей, и это действительно так.
The most important items to remember are as follows:|Наиболее важные моменты, о которых следует помнить, следующие:
###### Configure these ports like a normal access port to begin: Configure it as a static access
Для начала настройте эти порты как обычный порт доступа: Настройте их как статический доступ   
__|__
--|--
|
port and assign it an access VLAN.|порт и назначьте ему доступ к VLAN.
###### Add one more command to define the voice VLAN (switchport voice vlan vlan-id).
Добавьте еще одну команду для определения голосовой VLAN (switchport voice vlan vlan-id).   
###### Look for the mention of the voice VLAN ID, but no other new facts, in the output of the
Ищите упоминание идентификатора голосовой VLAN ID, но никаких других новых фактов в выводе   
__|__
--|--
|
show interfaces type number switchport command.|команда show interfaces type number switchport.
###### Look for both the voice and data (access) VLAN IDs in the output of the show interfaces
Найдите идентификаторы VLAN для голоса и данных (доступа) в выходных данных show interfaces   
__|__
--|--
|
type number trunk command.|введите номер команды соединительной линии.
###### Do not expect to see the port listed in the list of operational trunks as listed by the show
Не ожидайте увидеть порт, указанный в списке рабочих магистралей, как указано на шоу.   
__|__
--|--
|
interfaces trunk command.|интерфейс магистральной команды.
### Troubleshooting VLANs and VLAN Trunks
Устранение неполадок в сетях VLAN и магистралях VLAN   
__|__
--|--
|
A switch’s data plane forwarding processes depend in part on VLANs and VLAN trunking.|Процессы пересылки уровня данных коммутатора частично зависят от сетей VLAN и транкинга VLAN.
|
This final section of the chapter focuses on issues related to VLANs and VLAN trunks that could prevent LAN switching from working properly, focusing on a few items not yet discussed in the chapter.|В этом последнем разделе главы основное внимание уделяется вопросам, связанным с сетями VLAN и магистралями VLAN, которые могут помешать правильной работе коммутации локальной сети, при этом особое внимание уделяется нескольким вопросам, которые еще не обсуждались в этой главе.
In particular, this section examines these steps an engineer can take to avoid issues:|В частности, в этом разделе рассматриваются следующие шаги, которые инженер может предпринять, чтобы избежать проблем:
|
Step 1.|Шаг 1.
Confirm that all VLANs are both defined and active.|Убедитесь, что все VLAN определены и активны.
|
Step 2.|Шаг 2.
Check the allowed VLAN lists on both ends of each trunk to ensure that all VLANs intended to be used are included.|Проверьте списки разрешенных VLAN на обоих концах каждой магистрали, чтобы убедиться, что включены все VLAN, предназначенные для использования.
|
Step 3.|Шаг 3.
Check for incorrect trunk configuration settings that result in one switch operating as a trunk, with the neighboring switch not operating as a trunk.|Проверьте неправильные настройки конфигурации магистрали, в результате которых один коммутатор работает как магистраль, а соседний коммутатор не работает как магистраль.
|
Step 4.|Шаг 4.
Check the native VLAN settings on both ends of the trunk to ensure the settings match.|Проверьте настройки собственной VLAN на обоих концах магистрали, чтобы убедиться, что настройки совпадают.
#### Access VLANs Undefined or Disabled
Доступ к VLAN не определен или отключен   
__|__
--|--
|
Switches do not forward frames for VLANs that are (a) not known because the VLAN is not configured or has not been learned with VTP or (b) the VLAN is known, but it is disabled (shut down).|Коммутаторы не пересылают кадры для VLAN, которые (а) неизвестны, потому что VLAN не настроена или не была изучена с помощью VTP, или (b) VLAN известна, но отключена (выключена).
This next topic summarizes the best ways to confirm that a switch knows that a particular VLAN exists, and if it exists, determines the shutdown state of the VLAN.|В следующем разделе кратко описаны лучшие способы подтверждения того, что коммутатор знает о существовании конкретной VLAN, и, если она существует, определяет состояние выключения этой VLAN.
|
First, on the issue of whether a VLAN exists on a switch, a VLAN can be defined to a switch in two ways: using the vlan number global configuration command, or it can be learned from another switch using VTP. As mentioned earlier in this chapter, the examples in this book assume that you are not using VTP. If you discover that a VLAN does not exist on a switch, simply configure the VLAN as discussed earlier in the section, “Creating VLANs and Assigning Access VLANs to an Interface.”|Во-первых, по вопросу о том, существует ли VLAN на коммутаторе, VLAN может быть определена для коммутатора двумя способами: с помощью команды глобальной конфигурации номера vlan или ее можно узнать от другого коммутатора с помощью VTP. Как упоминалось ранее в этой главе, примеры в этой книге предполагают, что вы не используете VTP. Если вы обнаружите, что VLAN не существует на коммутаторе, просто настройте VLAN, как описано ранее в разделе «Создание VLAN и назначение VLAN доступа интерфейсу».
|
In addition to checking the configuration, you can check for the status of the VLAN (as well as whether it is known to the switch) using the show vlan command.|Помимо проверки конфигурации, вы можете проверить состояние VLAN (а также то, известно ли оно коммутатору), используя команду show vlan.
No matter the VTP mode, this command will list all VLANs known to the switch, plus one of two VLAN state values, depending on the current state: either active or act/lshut.|Независимо от режима VTP, эта команда выведет список всех VLAN, известных коммутатору, плюс одно из двух значений состояния VLAN, в зависимости от текущего состояния: active или act / lshut.
The second of these states means that the VLAN is shut down.|Второе из этих состояний означает, что VLAN отключена.
Shutting down a VLAN disables the VLAN on that switch only, so the switch will not forward frames in that VLAN.|Выключение VLAN отключает VLAN только на этом коммутаторе, поэтому коммутатор не будет пересылать кадры в этой VLAN.
|
Switch IOS gives you two similar configuration methods with which to disable (shutdown)|Switch IOS предоставляет вам два аналогичных метода настройки для отключения (выключения)
|
and enable (no shutdown) a VLAN. Example 8-11 shows how, first by using the global command [no] shutdown vlan number and then using the VLAN mode subcommand [no]|и включить (без выключения) VLAN. В примере 8-11 показано, как сначала с помощью глобальной команды [no] выключить номер vlan, а затем с помощью подкоманды режима VLAN [no]
|
shutdown.|неисправность.
The example shows the global commands enabling and disabling VLANs 10 and 20, respectively, and using VLAN subcommands to enable and disable VLANs 30 and 40, respectively.|В примере показаны глобальные команды, включающие и выключающие VLAN 10 и 20 соответственно, и использующие подкоманды VLAN для включения и отключения VLAN 30 и 40 соответственно.
|
Example 8-11 Enabling and Disabling VLANs on a Switch Example end.|Пример 8-11 Включение и отключение VLAN на коммутаторе.
|
NOTE The output of the show vlan brief command also lists a state of “act/unsup” for the reserved VLAN IDs 1002–1005, with “unsup” meaning “unsupported.”|ПРИМЕЧАНИЕ. В выходных данных команды show vlan Short также указывается состояние «действие / отключение» для зарезервированных идентификаторов VLAN 1002–1005, где «отключено» означает «не поддерживается».
#### Mismatched Trunking Operational States
Несоответствующие рабочие состояния транкинга   
__|__
--|--
|
Trunking can be configured correctly so that both switches use trunking.|Транкинг можно правильно настроить, чтобы оба коммутатора использовали транкинг.
However, trunks can also be misconfigured, with a couple of different results: either both switches do not trunk, or one switch trunks and the other does not.|Однако соединительные линии также могут быть неправильно сконфигурированы, что может привести к нескольким различным результатам: либо оба коммутатора не являются соединительными линиями, либо один коммутатор соединяет соединительные линии, а другой - нет.
Both results cause problems.|Оба результата вызывают проблемы.
|
The most common incorrect configuration—which results in both switches not trunking—is a configuration that uses the switchport mode dynamic auto command on both switches on the link.|Наиболее распространенная неправильная конфигурация - в результате которой оба коммутатора не соединяются в транкинг - это конфигурация, в которой используется динамическая автоматическая команда режима switchport на обоих коммутаторах канала.
The word auto just makes us all want to think that the link would trunk automatically, but this command is both automatic and passive.|Слово auto просто заставляет всех нас думать, что ссылка будет транслироваться автоматически, но эта команда одновременно автоматическая и пассивная.
As a result, both switches passively wait on the other device on the link to begin negotiations.|В результате оба коммутатора пассивно ждут на другом устройстве в канале связи, чтобы начать переговоры.
Example 8-12 highlights those parts of the output from the show interfaces switchport command that confirm both the configured and operational states.|В примере 8-12 выделены те части выходных данных команды show interfaces switchport, которые подтверждают как настроенное, так и рабочее состояние.
Note that the output lists the operational mode as “static access” rather than “trunking.”|Обратите внимание, что в выходных данных рабочий режим указан как «статический доступ», а не «транкинг».
|
Example 8-12 Operational Trunking State Example end.|Пример 8-12 Рабочее состояние транкинга Пример конец.
|
A different incorrect trunking configuration has an even worse result: one switch trunks, sending tagged frames, while the neighboring switch does not trunk, so the neighboring switch discards any frames it receives that have a VLAN tag in the header.|Другая неправильная конфигурация транкинга дает еще худший результат: один коммутатор соединяет транкинг, отправляя тегированные кадры, в то время как соседний коммутатор не соединяется, поэтому соседний коммутатор отбрасывает все полученные им кадры, которые имеют тег VLAN в заголовке.
When this combination of events happens, the interface works in that the status on each end will be up/up or connected.|Когда происходит эта комбинация событий, интерфейс работает так, что состояние на каждом конце будет «включено» / «работает» или «подключен».
Traffic in the native VLAN will actually cross the link successfully because those frames have no VLAN tags (headers).|Трафик в собственной VLAN фактически будет успешно пересекать ссылку, потому что эти кадры не имеют тегов (заголовков) VLAN.
However, traffic in all the rest of the VLANs will not cross the link.|Однако трафик во всех остальных VLAN не будет пересекать ссылку.
|
Figure 8-14 shows the incorrect configuration along with which side trunks and which does not.|На Рис. 8-14 показана неправильная конфигурация с указанием того, какие боковые стволы, а какие нет.
The side that trunks (SW1 in this case) enables trunking using the command switchport mode trunk but also disables Dynamic Trunking Protocol (DTP) negotiations using the switchport nonegotiate command.|Сторона, которая выполняет транкинг (в данном случае SW1), включает транкинг с помощью команды switchport mode trunk, но также отключает согласование протокола динамического транкинга (DTP) с помощью команды switchport nonegotiate.
SW2’s configuration also helps create the problem, by using one of the two trunking options that relies on DTP. Because SW1 has disabled DTP, SW2’s DTP negotiations fail, and SW2 chooses to not trunk.|Конфигурация SW2 также помогает создать проблему, используя один из двух вариантов транкинга, основанный на DTP. Поскольку SW1 отключил DTP, согласование DTP SW2 не выполняется, и SW2 выбирает не транк.
|
Figure 8-14 Mismatched Trunking Operational States The figure shows what happens when using this incorrect configuration.|Рисунок 8-14 Несоответствующие рабочие состояния транкинга На рисунке показано, что происходит при использовании этой неправильной конфигурации.
At Step 1, SW1 could (for example) forward a frame in VLAN 10.|На шаге 1 SW1 может (например) переслать кадр в VLAN 10.
However, SW2 would view any frame that arrives with an 802.1Q header as illegal because the frame has an 802.1Q header, and SW2 treats its G0/2 port as an access port.|Однако SW2 будет рассматривать любой фрейм, который прибывает с заголовком 802.1Q, как недопустимый, поскольку у фрейма есть заголовок 802.1Q, а SW2 рассматривает свой порт G0 / 2 как порт доступа.
So, SW2 discards any 802.1Q frames received on that port.|Таким образом, SW2 отбрасывает все кадры 802.1Q, полученные на этом порту.
|
The trunking issues shown here can be easily avoided by checking the configuration and by checking the trunk’s operational state (mode) on both sides of the trunk.|Показанных здесь проблем с транкингом можно легко избежать, проверив конфигурацию и проверив рабочее состояние (режим) соединительной линии на обеих сторонах соединительной линии.
The best commands to check trunking-related facts are show interfaces trunk and show interfaces switchport.|Лучшие команды для проверки фактов, связанных с транкингом, - это show interfaces trunk и show interfaces switchport.
|
Just be aware that the switches do not prevent you from making these configuration mistakes.|Просто имейте в виду, что переключатели не мешают вам делать эти ошибки конфигурации.
#### The Supported VLAN List on Trunks
Список поддерживаемых VLAN на магистралях   
__|__
--|--
|
A Cisco switch can forward traffic for all defined and active VLANs. However, a particular VLAN trunk may not forward traffic for a defined and active VLAN for a variety of other reasons.|Коммутатор Cisco может пересылать трафик для всех определенных и активных сетей VLAN. Однако конкретная магистраль VLAN может не пересылать трафик для определенной и активной VLAN по ряду других причин.
You should learn how to identify which VLANs a particular trunk port currently supports and the reasons why the switch might not be forwarding frames for a VLAN on that trunk port.|Вы должны узнать, как определить, какие сети VLAN поддерживает конкретный магистральный порт в настоящее время, а также причины, по которым коммутатор может не пересылать кадры для VLAN на этом магистральном порту.
|
The first category in this step can be easily done using the show interfaces interface-id trunk command, which only lists information about currently operational trunks.|Первую категорию на этом шаге можно легко сделать с помощью команды show interfaces interface-id trunk, которая перечисляет только информацию о текущих действующих соединительных линиях.
The best place to begin with this command is the last section of output, which lists the VLANs whose traffic will be forwarded over the trunk.|Лучше всего начинать с этой команды с последнего раздела вывода, в котором перечислены сети VLAN, трафик которых будет пересылаться по магистрали.
Any VLANs that make it to this final list of VLANs in the command output meet the following criteria:|Любые сети VLAN, которые попадают в этот окончательный список VLAN в выходных данных команды, соответствуют следующим критериям:
###### The VLAN has not been removed from the allowed VLAN list on the trunk (as configured
VLAN не была удалена из списка разрешенных VLAN на магистрали (как настроено   
__|__
--|--
|
with the switchport trunk allowed vlan interface subcommand).|с транком switchport разрешена подкоманда интерфейса vlan).
###### The VLAN exists and is active on the local switch (as seen in the show vlan command).
VLAN существует и активна на локальном коммутаторе (как показано в команде show vlan).   
###### The VLAN has not been VTP-pruned from the trunk. (Because this book attempts to
VLAN не была удалена из магистрали VTP. (Поскольку эта книга пытается   
__|__
--|--
|
ignore VTP as much as possible, this section assumes that VTP is not used and this feature has no impact on any trunks.) The trunk is in an STP forwarding state in that VLAN (as also seen in the show spanning-tree vlan vlan-id command).|в максимально возможной степени игнорируйте VTP, в этом разделе предполагается, что VTP не используется, и эта функция не влияет на какие-либо магистрали.) Магистраль находится в состоянии пересылки STP в этой VLAN (как также показано в показе spanning-tree vlan vlan- id команда).
|
The switchport trunk allowed vlan interface subcommand gives the network engineer a method to administratively limit the VLANs whose traffic uses a trunk.|Подкоманда switchport trunk allowed vlan interface дает сетевому инженеру метод административного ограничения VLAN, трафик которых использует транк.
If the engineer wants all defined VLANs to be supported on a trunk, the engineer simply does not configure this command.|Если инженер хочет, чтобы все определенные VLAN поддерживались на магистрали, он просто не настраивает эту команду.
If the engineer would like to limit the trunk to support a subset of the VLANs known to the switch, however, the engineer can add one or more switchport trunk allowed vlan interface subcommands.|Однако, если инженер хочет ограничить магистраль для поддержки подмножества сетей VLAN, известных коммутатору, он может добавить одну или несколько подкоманд интерфейса vlan, разрешенных магистралью порта коммутатора.
|
For instance, in a switch that has configured VLANs 1 through 100, but no others, by default the switch would allow traffic in all 100 VLANs. However, the trunk interface command switchport trunk allowed vlan 1-60 would limit the trunk to forward traffic for VLANs 1 through 60, but not the rest of the VLANs. Example 8-13 shows a sample of the command output from the show interfaces trunk command, which confirms the first list of VLAN IDs now lists VLANs 1–60.|Например, в коммутаторе, который настроил сети VLAN с 1 по 100, но не другие, по умолчанию коммутатор будет разрешать трафик во всех 100 VLAN. Однако команда интерфейса транка switchport trunk allowed vlan 1-60 ограничит транк для пересылки трафика для VLAN с 1 по 60, но не для остальных VLAN. В примере 8-13 показан образец выходных данных команды show interfaces trunk, подтверждающий, что в первом списке идентификаторов VLAN теперь перечислены VLAN 1–60.
Without the switchport trunk allowed vlan command, the first list would have included VLANs 1–4094.|Без команды switchport trunk allowed vlan первый список включал бы VLAN 1–4094.
|
Example 8-13 Allowed VLAN List and List of Active VLANs Example end.|Пример 8-13 Список разрешенных VLAN и список активных VLAN Пример конец.
|
The output of the show interfaces trunk command creates three separate lists of VLANs, each under a separate heading.|Выходные данные команды show interfaces trunk создают три отдельных списка VLAN, каждый под отдельным заголовком.
These three lists show a progression of reasons why a VLAN is not forwarded over a trunk.|Эти три списка показывают последовательность причин, по которым VLAN не пересылается по магистрали.
Table 8-4 summarizes the headings that precede each list and the reasons why a switch chooses to include or not include a VLAN in each list.|В таблице 8-4 приведены заголовки, предшествующие каждому списку, и причины, по которым коммутатор решает включать или не включать VLAN в каждый список.
For instance, in Example 8-13, VLAN 60 has been shut down, and VLAN 59 happens to be in an STP blocking state. (Chapter 9, “Spanning Tree Protocol Concepts,” has more information about STP.)|Например, в Примере 8-13 VLAN 60 отключена, а VLAN 59 находится в состоянии блокировки STP. (Глава 9, «Основные понятия протокола связующего дерева», содержит дополнительную информацию о STP.)
|
Table 8-4 VLAN Lists in the show interfaces trunk Command Table end.|Таблица 8-4 Списки VLAN в конце таблицы команд show interfaces trunk.
|
NOTE The companion website includes a video from the CCNA Exam Prep LiveLessons product, named “Troubleshooting VLANs Allowed on a Trunk #1,” which works through the three lists of VLANs in the output of the show interfaces interface-id trunk command in more detail.|ПРИМЕЧАНИЕ. На сопутствующем веб-сайте есть видео из продукта CCNA Exam Prep LiveLessons под названием «Устранение неполадок виртуальных локальных сетей, разрешенных на магистрали №1», которое более подробно работает с тремя списками виртуальных локальных сетей в выходных данных команды show interfaces interface-id trunk. .
#### Mismatched Native VLAN on a Trunk
Несоответствие собственной VLAN на магистрали   
__|__
--|--
|
Unfortunately, it is possible to set the native VLAN ID to different VLANs on either end of the trunk, using the switchport trunk native vlan vlan-id command.|К сожалению, можно установить собственный VLAN ID для разных VLAN на любом конце магистрали, используя команду switchport trunk native vlan vlan-id.
If the native VLANs differ according to the two neighboring switches, the switches will cause frames sent in the native VLAN to jump from one VLAN to the other.|Если собственные VLAN различаются в зависимости от двух соседних коммутаторов, коммутаторы заставят кадры, отправленные в собственной VLAN, переходить из одной VLAN в другую.
|
For example, if switch SW1 sends a frame using native VLAN 1 on an 802.1Q trunk, SW1 does not add a VLAN header, as is normal for the native VLAN. When switch SW2 receives the frame, noticing that no 802.1Q header exists, SW2 assumes that the frame is part of SW2’s configured native VLAN. If SW2 has been configured to think VLAN 2 is the native VLAN on that trunk, SW2 will try to forward the received frame into VLAN 2. (This effect of a frame being sent in one VLAN but then being believed to be in a different VLAN is called VLAN hopping.)|Например, если коммутатор SW1 отправляет кадр с использованием собственной VLAN 1 по магистрали 802.1Q, SW1 не добавляет заголовок VLAN, как это обычно бывает для собственной VLAN. Когда коммутатор SW2 принимает кадр, замечая, что заголовок 802.1Q не существует, SW2 предполагает, что кадр является частью настроенной собственной VLAN SW2. Если SW2 настроен так, чтобы считать, что VLAN 2 является собственной VLAN на этом магистральном канале, SW2 попытается переслать полученный кадр в VLAN 2. (Это эффект отправки кадра в одну VLAN, но затем считается, что он находится в другой VLAN. называется перескоком VLAN.)
### Chapter Review
Обзор главы   
__|__
--|--
|
Review this chapter’s material using either the tools in the book or the interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты в книге или интерактивные инструменты для того же материала, которые можно найти на сопутствующем веб-сайте книги.
Table 8-5 outlines the key review elements and where you can find them.|В Таблице 8-5 перечислены ключевые элементы обзора и указаны места, где их можно найти.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 8-5 Chapter Review Tracking Table end.|Таблица 8-5 Окончание таблицы отслеживания обзора главы.
|
Review All the Key Topics Key Terms You Should Know 802.1Q, trunk, trunking administrative mode, trunking operational mode, VLAN, VTP, VTP transparent mode, Layer 3 switch, access interface, trunk interface, data VLAN, voice VLAN, native VLAN, default VLAN, static access interface Do Labs The Sim Lite software is a version of Pearson’s full simulator learning product with a subset of the labs, included free with this book.|Ознакомьтесь со всеми ключевыми темами Ключевые термины, которые вы должны знать 802.1Q, магистраль, административный режим транкинга, рабочий режим транкинга, VLAN, VTP, прозрачный режим VTP, коммутатор уровня 3, интерфейс доступа, интерфейс магистрали, VLAN для передачи данных, голосовая VLAN, собственная VLAN, VLAN по умолчанию, интерфейс статического доступа. Лаборатории. Программное обеспечение Sim Lite - это версия полного учебного продукта Pearson на симуляторах с подмножеством лабораторных работ, бесплатно включенных в эту книгу.
The Sim Lite with this book includes a couple of labs about VLANs. Also, check the author’s blog site pages for configuration exercises (Config Labs) at https://blog.certskills.com.|Sim Lite с этой книгой включает в себя несколько лабораторных работ по VLAN. Также проверьте страницы блога автора на предмет упражнений по настройке (Лаборатория конфигурации) по адресу https://blog.certskills.com.
|
Command References Tables 8-7 and 8-8 list configuration and verification commands used in this chapter, respectively.|Ссылки на команды В таблицах 8-7 и 8-8 перечислены команды настройки и проверки, используемые в этой главе, соответственно.
|
As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.|В качестве простого упражнения на повторение закройте левый столбец таблицы, прочтите правый столбец и попытайтесь вспомнить команду, не глядя.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Затем повторите упражнение, охватывая правый столбец, и попытайтесь вспомнить, что делает команда.
|
Table 8-7 Chapter 8 Configuration Command Reference Table end.|Таблица 8-7 Глава 8 Справочник команд конфигурации Конец таблицы.
|
Table 8-8 Chapter 8 EXEC Command Reference Table end.|Таблица 8-8 Глава 8 Справочник команд EXEC Конец таблицы.
## Chapter 9 Spanning Tree Protocol Concepts
Глава 9 Концепции протокола связующего дерева   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 2.0 Network Access
2.0 Доступ к сети   
###### 2.4 Configure and verify (Layer 2/Layer 3) EtherChannel (LACP)
2.4 Настройка и проверка (уровень 2 / уровень 3) EtherChannel (LACP)   
###### 2.5 Describe the need for and basic operations of Rapid PVST+ Spanning Tree Protocol
2.5. Опишите необходимость и основные операции Rapid PVST + Spanning Tree Protocol.   
__|__
--|--
|
and identify basic operations|и определить основные операции
###### 2.5.a Root port, root bridge (primary/secondary), and other port names
2.5.a Корневой порт, корневой мост (первичный / вторичный) и другие имена портов.   
###### 2.5.b Port states (forwarding/blocking)
2.5.b Состояния портов (пересылка / блокировка)   
###### 2.5.c PortFast benefits
2.5.c Преимущества PortFast   
__|__
--|--
|
Spanning Tree Protocol (STP) allows Ethernet LANs to have the added benefits of installing redundant links in a LAN, while overcoming the known problems that occur when adding those extra links.|Протокол Spanning Tree Protocol (STP) позволяет локальным сетям Ethernet иметь дополнительные преимущества, заключающиеся в установке резервных каналов в локальной сети, при одновременном преодолении известных проблем, возникающих при добавлении этих дополнительных каналов.
Using redundant links in a LAN design allows the LAN to keep working even when some links fail or even when some entire switches fail.|Использование избыточных ссылок в конструкции локальной сети позволяет локальной сети продолжать работать даже при выходе из строя некоторых каналов или даже при выходе из строя некоторых коммутаторов целиком.
Proper LAN design should add enough redundancy so that no single point of failure crashes the LAN; STP allows the design to use redundancy without causing some other problems.|Правильный дизайн ЛВС должен добавить достаточную избыточность, чтобы ни одна единственная точка отказа не разрушила ЛВС; STP позволяет проекту использовать избыточность, не вызывая других проблем.
|
Historically, the IEEE first standardized STP as part of the IEEE 802.1D standard back in 1990, with pre-standard versions working even before that time.|Исторически сложилось так, что IEEE впервые стандартизировал протокол STP как часть стандарта IEEE 802.1D еще в 1990 году, а предварительные версии стандарта работали еще раньше.
Over time, the industry and IEEE improved STP, with the eventual replacement of STP with an improved protocol: Rapid Spanning Tree Protocol (RSTP). The IEEE first released RSTP as amendment 802.1w and, in 2004, integrated RSTP into the 802.1D standard.|Со временем отрасль и IEEE улучшили STP с возможной заменой STP на улучшенный протокол: Rapid Spanning Tree Protocol (RSTP). IEEE сначала выпустил RSTP как поправку к 802.1w, а в 2004 году интегрировал RSTP в стандарт 802.1D.
|
An argument could be made to ignore STP today and instead focus solely on RSTP. Most modern networks use RSTP instead of STP. The most recent models and IOS versions of Cisco switches default to use RSTP instead of STP. Plus, the CCNA 200-301 exam topics mention RSTP by name, but not STP. However, STP and RSTP share many of the same mechanisms, and RSTP’s improvements can be best understood in comparison to STP. For that reason, this chapter presents some details that apply only to STP, as a learning tool to help you understand RSTP.|Можно привести аргумент, чтобы сегодня игнорировать STP и вместо этого сосредоточиться исключительно на RSTP. Большинство современных сетей используют RSTP вместо STP. Самые последние модели и версии IOS коммутаторов Cisco по умолчанию используют RSTP вместо STP. Кроме того, в темах экзамена CCNA 200-301 по имени упоминается RSTP, но не STP. Тем не менее, STP и RSTP используют одни и те же механизмы, и улучшения RSTP можно лучше понять по сравнению с STP. По этой причине в этой главе представлены некоторые подробности, которые относятся только к STP, как к учебному пособию, которое поможет вам понять RSTP.
|
This chapter organizes the material into three sections.|В этой главе материал разбит на три раздела.
The first section presents some core concepts about how both STP and RSTP discover a tree made of nodes (switches) and links so that no loops exist in a network.|В первом разделе представлены некоторые основные концепции о том, как STP и RSTP обнаруживают дерево, состоящее из узлов (коммутаторов) и каналов, так что в сети не существует петель.
The second section then takes a brief look at the area for which STP differs the most from RSTP: in how STP reacts to changes in the network.|Во втором разделе кратко рассматривается область, в которой протокол STP больше всего отличается от RSTP: то, как протокол STP реагирует на изменения в сети.
This chapter ends with a third major section that details RSTP, including how RSTP works much better that STP when reacting to changes.|Эта глава заканчивается третьим основным разделом, в котором подробно описывается RSTP, в том числе то, как RSTP работает намного лучше, чем STP при реагировании на изменения.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom CHAPTER 9 of the page following the quiz.|Ответы на письма перечислены в нижней ГЛАВЕ 9 страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 9-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 9-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### STP and RSTP Basics
Основы STP и RSTP   
__|__
--|--
|
Details Specific to STP (and Not RSTP) 3–4 Rapid STP Concepts 5–7 1.|Подробности, относящиеся к STP (а не RSTP) 3–4 Основные понятия Rapid STP 5–7 1.
Which of the following port states are stable states used when STP has completed convergence?|Какие из следующих состояний порта используются в стабильных состояниях после завершения конвергенции STP?
|
(Choose two answers.)|(Выберите два ответа.)
|
a. Blocking b.|а. Блокировка b.
Forwarding c.|Пересылка c.
Listening d.|Прослушивание d.
Learning e.|Обучение e.
Discarding 2.|Отбрасывая 2.
Which of the following bridge IDs wins election as root, assuming that the switches with these bridge IDs are in the same network?|Какой из следующих идентификаторов моста выигрывает выборы в качестве root, если предполагается, что коммутаторы с этими идентификаторами моста находятся в одной сети?
|
a. 32769:0200.1111.1111 b. 32769:0200.2222.2222 c. 4097:0200.1111.1111 d. 4097:0200.2222.2222 e. 40961:0200.1111.1111 3.|а. 32769: 0200.1111.1111 б. 32769: 0200.2222.2222 с. 4097: 0200.1111.1111 г. 4097: 0200.2222.2222 e. 40961: 0200.1111.1111 3.
Which of the following are transitory port states used only during the process of STP convergence? (Choose two answers.)|Какие из следующих состояний порта используются только в процессе конвергенции STP? (Выберите два ответа.)
|
a. Blocking b.|а. Блокировка b.
Forwarding c.|Пересылка c.
Listening d.|Прослушивание d.
Learning e.|Обучение e.
Discarding 4.|Отбрасывание 4.
Which of the following facts determines how often a nonroot bridge or switch sends an STP Hello BPDU message?|Какой из следующих фактов определяет, как часто некорневой мост или коммутатор отправляет сообщение STP Hello BPDU?
|
a. The Hello timer as configured on that switch.|а. Таймер Hello, настроенный на этом переключателе.
|
b. The Hello timer as configured on the root switch.|б. Таймер Hello, настроенный на корневом коммутаторе.
|
c. It is always every 2 seconds.|c. Это всегда каждые 2 секунды.
|
d. The switch reacts to BPDUs received from the root switch by sending another BPDU 2 seconds after receiving the root BPDU.|d. Коммутатор реагирует на BPDU, полученные от корневого коммутатора, отправляя другой BPDU через 2 секунды после получения корневого BPDU.
|
5. Which of the following RSTP port states have the same name and purpose as a port state in traditional STP? (Choose two answers.)|5. Какие из следующих состояний порта RSTP имеют то же имя и назначение, что и состояние порта в традиционном STP? (Выберите два ответа.)
|
a. Blocking b.|а. Блокировка b.
Forwarding c.|Пересылка c.
Listening d.|Прослушивание d.
Learning e.|Обучение e.
Discarding 6.|Отбрасывание 6.
RSTP adds features beyond STP that enable ports to be used for a role if another port on the same switch fails.|RSTP добавляет функции помимо STP, которые позволяют использовать порты для роли в случае отказа другого порта на том же коммутаторе.
Which of the following statements correctly describe a port role that is waiting to take over for another port role? (Choose two answers.)|Какое из следующих утверждений правильно описывает роль порта, которая ожидает перехода на другую роль порта? (Выберите два ответа.)
|
a. An alternate port waits to become a root port.|а. Альтернативный порт ожидает, чтобы стать корневым портом.
|
b. A backup port waits to become a root port.|б. Резервный порт ожидает, чтобы стать корневым портом.
|
c. An alternate port waits to become a designated port.|c. Альтернативный порт ожидает, чтобы стать назначенным портом.
|
d. A backup port waits to become a designated port.|d. Резервный порт ожидает, чтобы стать назначенным портом.
|
7. What STP feature causes an interface to be placed in the forwarding state as soon as the interface is physically active?|7. Какая функция STP переводит интерфейс в состояние пересылки, как только интерфейс становится физически активным?
|
a. STP b.|а. СТП б.
EtherChannel c.|EtherChannel c.
Root Guard d.|Корневая защита d.
PortFast Foundation Topics STP and RSTP Basics Without some mechanism like Spanning Tree Protocol (STP) or Rapid STP (RSTP), a LAN with redundant links would cause Ethernet frames to loop for an indefinite period of time.|Основные темы PortFast Основы STP и RSTP Без какого-либо механизма, такого как протокол Spanning Tree Protocol (STP) или Rapid STP (RSTP), в локальной сети с резервными каналами связи кадры Ethernet будут зацикливаться на неопределенный период времени.
|
With STP or RSTP enabled, some switches block ports so that these ports do not forward frames.|При включенном STP или RSTP некоторые коммутаторы блокируют порты, чтобы эти порты не пересылали кадры.
STP and RSTP intelligently choose which ports block, with two goals in mind:|STP и RSTP разумно выбирают, какие порты блокируются, имея в виду две цели:
###### All devices in a VLAN can send frames to all other devices. In other words, STP or RSTP
Все устройства в VLAN могут отправлять кадры всем остальным устройствам. Другими словами, STP или RSTP   
__|__
--|--
|
does not block too many ports, cutting off some parts of the LAN from other parts.|не блокирует слишком много портов, отрезая одни части ЛВС от других.
###### Frames have a short life and do not loop around the network indefinitely.
У фреймов короткий срок службы, и они не могут бесконечно перемещаться по сети.   
__|__
--|--
|
STP and RSTP strike a balance, allowing frames to be delivered to each device, without causing the problems that occur when frames loop through the network over and over again.|Протоколы STP и RSTP обеспечивают баланс, позволяя доставлять кадры на каждое устройство, не вызывая проблем, которые возникают, когда кадры проходят через сеть снова и снова.
|
NOTE This first major section of the chapter explains details of both STP and RSTP, so this section uses the term STP/RSTP to refer to these protocols together.|ПРИМЕЧАНИЕ В этом первом основном разделе главы подробно описываются как STP, так и RSTP, поэтому в этом разделе используется термин STP / RSTP для обозначения этих протоколов вместе.
Note that this term is just a convenient shorthand.|Обратите внимание, что этот термин - всего лишь удобное сокращение.
Later in the chapter, the text will point out differences between STP and RSTP and begin using the terms STP and RSTP separately, referring to only the specific protocol.|Позже в этой главе текст будет указывать на различия между STP и RSTP и начинать использовать термины STP и RSTP отдельно, имея в виду только конкретный протокол.
|
STP/RSTP prevents looping frames by adding an additional check on each interface before a switch uses it to send or receive user traffic.|STP / RSTP предотвращает зацикливание кадров, добавляя дополнительную проверку на каждый интерфейс перед тем, как коммутатор использует его для отправки или получения пользовательского трафика.
That check: If the port is in STP/RSTP forwarding state in that VLAN, use it as normal; if it is in STP/RSTP blocking state, however, block all user traffic and do not send or receive user traffic on that interface in that VLAN.|Эта проверка: если порт находится в состоянии пересылки STP / RSTP в этой VLAN, используйте его как обычно; однако если он находится в состоянии блокировки STP / RSTP, блокируйте весь пользовательский трафик и не отправляйте и не принимайте пользовательский трафик на этом интерфейсе в этой VLAN.
|
Note that these STP/RSTP states do not change the other information you already know about switch interfaces.|Обратите внимание, что эти состояния STP / RSTP не изменяют другую информацию, которую вы уже знаете об интерфейсах коммутатора.
The interface’s state of connected/notconnect does not change.|Состояние интерфейса connected / notconnect не меняется.
The interface’s operational state as either an access or trunk port does not change.|Рабочее состояние интерфейса как порта доступа или магистрального порта не изменяется.
STP/RSTP adds this additional state, with the blocking state basically disabling the interface.|STP / RSTP добавляет это дополнительное состояние, при этом состояние блокировки в основном отключает интерфейс.
|
In many ways, those last two paragraphs sum up what STP/RSTP does.|Во многих отношениях последние два абзаца подводят итог тому, что делает STP / RSTP.
However, the details of how STP/RSTP does its work can take a fair amount of study and practice.|Однако подробности того, как STP / RSTP выполняет свою работу, могут потребовать значительного количества изучения и практики.
This first major section of the chapter begins by explaining the need for STP/RSTP and the basic ideas of what STP/RSTP does to solve the problem of looping frames.|Этот первый основной раздел главы начинается с объяснения необходимости STP / RSTP и основных идей того, что STP / RSTP делает для решения проблемы зацикливания кадров.
The majority of this section then looks at how STP/RSTP goes about choosing which switch ports to block to accomplish its goals.|В большей части этого раздела рассматривается, как протокол STP / RSTP выбирает, какие порты коммутатора блокировать для достижения своих целей.
#### The Need for Spanning Tree
Необходимость связующего дерева   
__|__
--|--
|
STP/RSTP prevents three common problems in Ethernet LANs. All three problems occur as a side effect of one fact: without STP/RSTP, some Ethernet frames would loop around the network for a long time (hours, days, literally forever if the LAN devices and links never failed).|STP / RSTP предотвращает три распространенные проблемы в локальных сетях Ethernet. Все три проблемы возникают как побочный эффект одного факта: без STP / RSTP некоторые кадры Ethernet будут петлять по сети в течение длительного времени (часы, дни, буквально навсегда, если устройства и каналы LAN никогда не выходили из строя).
|
Just one looping frame causes what is called a broadcast storm.|Всего один зацикленный кадр вызывает так называемый широковещательный шторм.
Broadcast storms happen when any kind of Ethernet frames—broadcast frames, multicast frames, or unknown-destination unicast frames—loop around a LAN indefinitely.|Широковещательные штормы случаются, когда любые кадры Ethernet - широковещательные кадры, многоадресные кадры или одноадресные кадры неизвестного назначения - бесконечно циркулируют по локальной сети.
Broadcast storms can saturate all the links with copies of that one single frame, crowding out good frames, as well as significantly impacting end-user device performance by making the PCs process too many broadcast frames.|Широковещательные штормы могут насыщать все ссылки копиями этого единственного кадра, вытесняя хорошие кадры, а также значительно влияя на производительность устройства конечного пользователя, заставляя ПК обрабатывать слишком много широковещательных кадров.
|
To help you understand how this occurs, Figure 9-1 shows a sample network in which Bob sends a broadcast frame.|Чтобы помочь вам понять, как это происходит, на рис. 9-1 показан пример сети, в которой Боб отправляет широковещательный кадр.
The dashed lines show how the switches forward the frame when STP/RSTP does not exist.|Пунктирными линиями показано, как коммутаторы пересылают кадр, когда протокол STP / RSTP не существует.
|
Figure 9-1 Broadcast Storm NOTE Bob’s original broadcast would also be forwarded around the other direction, with SW3 sending a copy of the original frame out its Gi0/1 port.|Рис. 9-1 Broadcast Storm ПРИМЕЧАНИЕ Исходная широковещательная передача Боба также будет пересылаться в другом направлении, при этом SW3 отправляет копию исходного кадра через свой порт Gi0 / 1.
To reduce clutter, Figure 9-1 does not show that frame.|Чтобы уменьшить беспорядок, на рис. 9-1 этот кадр не показан.
|
Remember that LAN switch?|Помните тот переключатель LAN?
That logic tells switches to flood broadcasts out all interfaces in the same VLAN except the interface in which the frame arrived.|Эта логика сообщает коммутаторам, что следует рассылать широковещательную рассылку по всем интерфейсам в одной и той же VLAN, за исключением интерфейса, в который прибыл кадр.
In Figure 9-1, that means SW3 forwards Bob’s frame to SW2, SW2 forwards the frame to SW1, SW1 forwards the frame back to SW3, and SW3 forwards it back to SW2 again.|На рисунке 9-1 это означает, что SW3 пересылает кадр Боба SW2, SW2 пересылает кадр SW1, SW1 пересылает кадр обратно к SW3, а SW3 снова пересылает его обратно к SW2.
|
When broadcast storms happen, frames like the one in Figure 9-1 keep looping until something changes—someone shuts down an interface, reloads a switch, or does something else to break the loop.|Когда случаются широковещательные штормы, кадры, подобные показанному на рис. 9-1, продолжают зацикливаться, пока что-то не изменится - кто-то отключит интерфейс, перезагрузит коммутатор или сделает что-то еще, чтобы разорвать цикл.
Also note that the same event happens in the opposite direction.|Также обратите внимание, что такое же событие происходит в обратном направлении.
When Bob sends the original frame, SW3 also forwards a copy to SW1, SW1 forwards it to SW2, and so on.|Когда Боб отправляет исходный кадр, SW3 также пересылает копию на SW1, SW1 пересылает ее на SW2 и так далее.
|
The storm also causes a much more subtle problem called MAC table instability.|Шторм также вызывает гораздо более тонкую проблему, называемую нестабильностью таблицы MAC.
MAC table instability means that the switches’ MAC address tables keep changing because frames with the same source MAC arrive on different ports.|Нестабильность таблицы MAC-адресов означает, что таблицы MAC-адресов коммутаторов продолжают меняться, поскольку кадры с одним и тем же исходным MAC-адресом поступают на разные порты.
To see why, follow this example, in which SW3 begins Figure 9-1 with a MAC table entry for Bob, at the bottom of the figure, associated with port Fa0/13:|Чтобы понять, почему, следуйте этому примеру, в котором SW3 начинается на рисунке 9-1 с записи таблицы MAC для Боба в нижней части рисунка, связанной с портом Fa0 / 13:
|
0200.3333.3333 Fa0/13 VLAN 1 However, now think about the switch-learning process that occurs when the looping frame goes to SW2, then SW1, and then back into SW3’s Gi0/1 interface.|0200.3333.3333 Fa0 / 13 VLAN 1 Однако теперь подумайте о процессе обучения переключателя, который происходит, когда цикл цикла переходит к SW2, затем SW1, а затем обратно в интерфейс Gi0 / 1 SW3.
SW3 thinks, “Hmm…the source MAC address is 0200.3333.3333, and it came in my Gi0/1 interface.|SW3 думает: «Хм… MAC-адрес источника - 0200.3333.3333, и он пришел в мой интерфейс Gi0 / 1.
Update my MAC table!” This results in the following entry on SW3, with interface Gi0/1 instead of Fa0/13:|Обновите мою таблицу MAC-адресов! » Это приводит к следующей записи на SW3 с интерфейсом Gi0 / 1 вместо Fa0 / 13:
|
0200.3333.3333 Gi0/1 VLAN 1 At this point, SW3 itself cannot correctly deliver frames to Bob’s MAC address.|0200.3333.3333 Gi0 / 1 VLAN 1 На этом этапе сам SW3 не может правильно доставлять кадры на MAC-адрес Боба.
At that instant, if a frame arrives at SW3 destined for Bob—a different frame than the looping frame that causes the problems—SW3 incorrectly forwards the frame out Gi0/1 to SW1, creating even more congestion.|В этот момент, если в SW3 поступает кадр, предназначенный для Боба - другой кадр, чем циклический кадр, вызывающий проблемы, - SW3 неправильно пересылает кадр из Gi0 / 1 в SW1, создавая еще большую перегрузку.
|
The looping frames in a broadcast storm also cause a third problem: multiple copies of the frame arrive at the destination.|Зацикливание кадров в широковещательном шторме также вызывает третью проблему: несколько копий кадра прибывают в место назначения.
Consider a case in which Bob sends a frame to Larry but none of the switches know Larry’s MAC address.|Рассмотрим случай, когда Боб отправляет кадр Ларри, но ни один из коммутаторов не знает MAC-адрес Ларри.
Switches flood frames sent to unknown destination unicast MAC addresses.|Переключает кадры лавинной рассылки, отправляемые на одноадресные MAC-адреса неизвестного назначения.
When Bob sends the frame destined for Larry’s MAC address, SW3 sends a copy to both SW1 and SW2. SW1 and SW2 also flood the frame, causing copies of the frame to loop.|Когда Боб отправляет кадр, предназначенный для MAC-адреса Ларри, SW3 отправляет копию как SW1, так и SW2. SW1 и SW2 также переполняют кадр, вызывая зацикливание копий кадра.
SW1 also sends a copy of each frame out Fa0/11 to Larry.|SW1 также отправляет копию каждого кадра Fa0 / 11 Ларри.
As a result, Larry gets multiple copies of the frame, which may result in an application failure, if not more pervasive networking problems.|В результате Ларри получает несколько копий кадра, что может привести к сбою приложения, если не к более распространенным сетевым проблемам.
|
Table 9-2 summarizes the main three classes of problems that occur when STP/RSTP is not used in a LAN that has redundancy.|В таблице 9-2 приведены три основных класса проблем, которые возникают, когда протокол STP / RSTP не используется в локальной сети с резервированием.
|
Answers to the “Do I Know This Already?” quiz:|Ответы на вопрос «Знаю ли я это уже?» викторина:
|
1 A, B 2 C 3 C, D 4 B 5 B, D 6 A, D 7 D Table 9-2 Three Classes of Problems Caused by Not Using STP in Redundant LANs Table end.|1 A, B 2 C 3 C, D 4 B 5 B, D 6 A, D 7 D Таблица 9-2 Три класса проблем, вызванных неиспользованием STP в резервных локальных сетях Конец таблицы.
#### What Spanning Tree Does
Что делает Spanning Tree   
__|__
--|--
|
STP/RSTP prevents loops by placing each switch port in either a forwarding state or a blocking state.|STP / RSTP предотвращает образование петель, переводя каждый порт коммутатора в состояние пересылки или в состояние блокировки.
Interfaces in the forwarding state act as normal, forwarding and receiving frames.|Интерфейсы в состоянии пересылки работают как обычно, пересылая и получая кадры.
|
However, interfaces in a blocking state do not process any frames except STP/RSTP messages (and some other overhead messages).|Однако интерфейсы в состоянии блокировки не обрабатывают никакие кадры, кроме сообщений STP / RSTP (и некоторых других служебных сообщений).
Interfaces that block do not forward user frames, do not learn MAC addresses of received frames, and do not process received user frames.|Блокирующие интерфейсы не пересылают пользовательские кадры, не узнают MAC-адреса полученных кадров и не обрабатывают полученные пользовательские кадры.
|
Figure 9-2 shows a simple STP/RSTP tree that solves the problem shown in Figure 9-1 by placing one port on SW3 in the blocking state.|На рисунке 9-2 показано простое дерево STP / RSTP, которое решает проблему, показанную на рисунке 9-1, путем перевода одного порта на SW3 в состояние блокировки.
|
Figure 9-2 What STP/RSTP Does: Blocks a Port to Break the Loop Now when Bob sends a broadcast frame, the frame does not loop.|Рисунок 9-2. Что делает протокол STP / RSTP: блокирует порт для разрыва петли. Теперь, когда Боб отправляет широковещательный кадр, этот кадр не зацикливается.
As shown in the steps in the figure:|Как показано в шагах на рисунке:
|
Step 1.|Шаг 1.
Bob sends the frame to SW3.|Боб отправляет фрейм в SW3.
|
Step 2.|Шаг 2.
SW3 forwards the frame only to SW1, but not out Gi0/2 to SW2, because SW3’s Gi0/2 interface is in a blocking state.|SW3 пересылает кадр только SW1, но не передает Gi0 / 2 в SW2, потому что интерфейс Gi0 / 2 SW3 находится в состоянии блокировки.
|
Step 3.|Шаг 3.
SW1 floods the frame out both Fa0/11 and Gi0/1.|SW1 заливает кадр как Fa0 / 11, так и Gi0 / 1.
|
Step 4.|Шаг 4.
SW2 floods the frame out Fa0/12 and Gi0/1.|SW2 выгружает кадр из Fa0 / 12 и Gi0 / 1.
|
Step 5.|Шаг 5.
SW3 physically receives the frame, but it ignores the frame received from SW2 because SW3’s Gi0/2 interface is in a blocking state.|SW3 физически принимает кадр, но игнорирует кадр, полученный от SW2, поскольку интерфейс Gi0 / 2 SW3 находится в состоянии блокировки.
|
With the STP/RSTP topology in Figure 9-2, the switches simply do not use the link between SW2 and SW3 for traffic in this VLAN, which is the minor negative side effect of STP.|С топологией STP / RSTP, показанной на рис. 9-2, коммутаторы просто не используют канал между SW2 и SW3 для трафика в этой VLAN, что является незначительным отрицательным побочным эффектом STP.
|
However, if either of the other two links fails, STP/RSTP converges so that SW3 forwards instead of blocks on its Gi0/2 interface.|Однако, если какой-либо из двух других каналов выходит из строя, STP / RSTP сходится, так что SW3 пересылает вместо блоков на своем интерфейсе Gi0 / 2.
|
NOTE The term STP convergence refers to the process by which the switches collectively realize that something has changed in the LAN topology and determine whether they need to change which ports block and which ports forward.|ПРИМЕЧАНИЕ. Термин «конвергенция STP» относится к процессу, с помощью которого коммутаторы коллективно осознают, что что-то изменилось в топологии LAN, и определяют, нужно ли им изменить, какие порты блокируются, а какие пересылаются.
|
That completes the description of what STP/RSTP does, placing each port into either a forwarding or blocking state.|Это завершает описание того, что делает STP / RSTP, переводя каждый порт в состояние пересылки или блокировки.
The more interesting question, and the one that takes a lot more work to understand, is how and why STP/RSTP makes its choices.|Более интересный вопрос, который требует гораздо больше усилий, чтобы понять, как и почему STP / RSTP делает свой выбор.
How does STP/RSTP manage to make switches block or forward on each interface?|Как протоколу STP / RSTP удается блокировать или пересылать коммутаторы на каждом интерфейсе?
And how does it converge to change state from blocking to forwarding to take advantage of redundant links in response to network outages?|И как он сводится к изменению состояния с блокировки на пересылку, чтобы воспользоваться преимуществами избыточных каналов в ответ на сбои в сети?
The following pages answer these questions.|Следующие страницы отвечают на эти вопросы.
#### How Spanning Tree Works
Как работает связующее дерево   
__|__
--|--
|
The STP/RSTP algorithm creates a spanning tree of interfaces that forward frames.|Алгоритм STP / RSTP создает связующее дерево интерфейсов, которые пересылают кадры.
The tree structure of forwarding interfaces creates a single path to and from each Ethernet link, just like you can trace a single path in a living, growing tree from the base of the tree to each leaf.|Древовидная структура перенаправляющих интерфейсов создает единый путь к каждому каналу Ethernet и от него, точно так же, как вы можете проследить единственный путь в живом растущем дереве от основания дерева до каждого листа.
|
NOTE STP was created before LAN switches even existed, using LAN bridges to connect LANs. Today, switches play the same role as bridges, implementing STP/RSTP. However, many STP/RSTP terms still refer to bridge.|ПРИМЕЧАНИЕ STP был создан до того, как появились коммутаторы LAN, с использованием мостов LAN для подключения к LAN. Сегодня коммутаторы играют ту же роль, что и мосты, реализующие STP / RSTP. Однако многие термины STP / RSTP по-прежнему относятся к мосту.
For the purposes of STP/RSTP and this chapter, consider the terms bridge and switch synonymous.|Для целей STP / RSTP и данной главы термины «мост» и «коммутатор» являются синонимами.
|
The process used by STP, sometimes called the spanning-tree algorithm (STA), chooses the interfaces that should be placed into a forwarding state.|Процесс, используемый STP, иногда называемый алгоритмом связующего дерева (STA), выбирает интерфейсы, которые должны быть переведены в состояние пересылки.
For any interfaces not chosen to be in a forwarding state, STP/RSTP places the interfaces in blocking state.|Для любых интерфейсов, не выбранных для пересылки, STP / RSTP переводит интерфейсы в состояние блокировки.
In other words, STP/RSTP simply picks which interfaces should forward, and any interfaces left over go to a blocking state.|Другими словами, STP / RSTP просто выбирает, какие интерфейсы следует пересылать, и любые оставшиеся интерфейсы переходят в состояние блокировки.
|
STP/RSTP uses three criteria to choose whether to put an interface in forwarding state:|STP / RSTP использует три критерия для выбора, переводить ли интерфейс в состояние пересылки:
###### STP/RSTP elects a root switch. STP puts all working interfaces on the root switch in forwarding
STP / RSTP выбирает корневой коммутатор. STP переводит все рабочие интерфейсы корневого коммутатора в режим пересылки.   
__|__
--|--
|
state.|штат.
###### Each nonroot switch considers one of its ports to have the least administrative cost
Каждый некорневой коммутатор считает, что один из его портов имеет наименьшие административные затраты.   
__|__
--|--
|
between itself and the root switch.|между собой и корневым коммутатором.
The cost is called that switch’s root cost.|Стоимость называется корневой стоимостью этого переключателя.
STP/RSTP places its port that is part of the least root cost path, called that switch’s root port (RP), in forwarding state.|STP / RSTP переводит свой порт, который является частью пути с наименьшей стоимостью корня, называемого корневым портом (RP) этого коммутатора, в состояние пересылки.
###### Many switches can attach to the same Ethernet segment, but due to the fact that links
Многие коммутаторы могут подключаться к одному и тому же сегменту Ethernet, но из-за того, что ссылки   
__|__
--|--
|
connect two devices, a link would have at most two switches.|подключите два устройства, канал будет иметь не более двух переключателей.
With two switches on a link, the switch with the lowest root cost, as compared with the other switches attached to the same link, is placed in forwarding state.|При двух коммутаторах на канале коммутатор с наименьшими корневыми затратами по сравнению с другими коммутаторами, подключенными к тому же каналу, переводится в состояние пересылки.
That switch is the designated switch, and that switch’s interface, attached to that segment, is called the designated port (DP).|Этот коммутатор является назначенным коммутатором, а интерфейс этого коммутатора, подключенный к этому сегменту, называется назначенным портом (DP).
|
NOTE The real reason the root switches place all working interfaces in a forwarding state (at step 1 in the list) is that all its interfaces on the root switch will become DPs. However, it is easier to just remember that all the root switches’ working interfaces will forward frames.|ПРИМЕЧАНИЕ. Настоящая причина, по которой корневые коммутаторы переводят все рабочие интерфейсы в состояние пересылки (на шаге 1 в списке), заключается в том, что все его интерфейсы на корневом коммутаторе станут DP. Однако проще помнить, что все рабочие интерфейсы корневых коммутаторов будут пересылать кадры.
|
All other interfaces are placed in blocking state.|Все остальные интерфейсы переводятся в состояние блокировки.
Table 9-3 summarizes the reasons STP/RSTP places a port in forwarding or blocking state.|Таблица 9-3 суммирует причины, по которым протокол STP / RSTP переводит порт в состояние пересылки или блокировки.
|
Table 9-3 STP/RSTP: Reasons for Forwarding or Blocking Table end.|Таблица 9-3 STP / RSTP: Причины завершения таблицы пересылки или блокировки.
|
NOTE STP/RSTP only considers working interfaces (those in a connected state).|ПРИМЕЧАНИЕ STP / RSTP учитывает только рабочие интерфейсы (те, которые находятся в подключенном состоянии).
Failed interfaces (for example, interfaces with no cable installed) or administratively shutdown interfaces are instead placed into an STP/RSTP disabled state.|Отказавшие интерфейсы (например, интерфейсы без установленного кабеля) или интерфейсы, отключенные административно, вместо этого переводятся в состояние отключения STP / RSTP.
So, this section uses the term working ports to refer to interfaces that could forward frames if STP/RSTP placed the interface into a forwarding state.|Таким образом, в этом разделе термин рабочие порты используется для обозначения интерфейсов, которые могут пересылать кадры, если STP / RSTP переводит интерфейс в состояние пересылки.
|
NOTE STP and RSTP do differ slightly in the use of the names of some states like blocking and disabled, with RSTP using the status term discarding.|ПРИМЕЧАНИЕ STP и RSTP немного отличаются в использовании названий некоторых состояний, таких как блокировка и отключение, при этом RSTP использует термин «отбрасывание состояния».
However, those minor differences do not change the meaning of the discussions in this first section of the chapter.|Однако эти незначительные различия не меняют смысла обсуждений в этом первом разделе главы.
The upcoming section titled “Comparing STP and RSTP” discusses these differences, both important and minor.|В следующем разделе под названием «Сравнение STP и RSTP» обсуждаются эти различия, как важные, так и незначительные.
##### The STP Bridge ID and Hello BPDU
Идентификатор моста STP и Hello BPDU   
__|__
--|--
|
The STA begins with an election of one switch to be the root switch.|STA начинает с выбора одного коммутатора в качестве корневого коммутатора.
To better understand this election process, you need to understand the STP/RSTP messages sent between switches as well as the concept and format of the identifier used to uniquely identify each switch.|Чтобы лучше понять этот процесс выбора, вам необходимо понять сообщения STP / RSTP, отправляемые между коммутаторами, а также концепцию и формат идентификатора, используемого для уникальной идентификации каждого коммутатора.
|
The STP/RSTP bridge ID (BID) is an 8-byte value unique to each switch.|Идентификатор моста STP / RSTP (BID) - это 8-байтовое значение, уникальное для каждого коммутатора.
The bridge ID consists of a 2-byte priority field and a 6-byte system ID, with the system ID being based on a universal (burned-in) MAC address in each switch.|Идентификатор моста состоит из 2-байтового поля приоритета и 6-байтового идентификатора системы, причем идентификатор системы основан на универсальном (встроенном) MAC-адресе в каждом коммутаторе.
Using a burned-in MAC address ensures that each switch’s bridge ID will be unique.|Использование встроенного MAC-адреса гарантирует, что идентификатор моста каждого коммутатора будет уникальным.
|
STP/RSTP defines messages called bridge protocol data units (BPDU), also called configuration BPDUs, which switches use to exchange information with each other.|STP / RSTP определяет сообщения, называемые блоками данных протокола моста (BPDU), также называемыми конфигурационными блоками BPDU, которые коммутаторы используют для обмена информацией друг с другом.
The most common BPDU, called a Hello BPDU, lists many details, including the sending switch’s BID. By listing its own unique BID, switches can tell which switch sent which Hello BPDU. Table 9-4 lists some of the key information in the Hello BPDU.|Самый распространенный BPDU, называемый Hello BPDU, содержит множество деталей, включая BID отправляющего коммутатора. Перечисляя свой собственный уникальный BID, коммутаторы могут определить, какой коммутатор какой Hello BPDU отправил. Таблица 9-4 перечисляет некоторую ключевую информацию в Hello BPDU.
|
Table 9-4 Fields in the STP Hello BPDU Table end.|Таблица 9-4 Поля в конце таблицы STP Hello BPDU.
|
For the time being, just keep the first three items from Table 9-4 in mind as the following sections work through the three steps in how STP/RSTP chooses the interfaces to place into a forwarding state.|На данный момент просто помните о первых трех элементах из Таблицы 9-4, поскольку в следующих разделах рассматриваются три шага в том, как STP / RSTP выбирает интерфейсы для перевода в состояние пересылки.
Next, the text examines the three main steps in the STP/RSTP process.|Далее в тексте рассматриваются три основных этапа процесса STP / RSTP.
##### Electing the Root Switch
Выбор корневого переключателя   
__|__
--|--
|
Switches elect a root switch based on the BIDs in the BPDUs. The root switch is the switch with the lowest numeric value for the BID. Because the two-part BID starts with the priority value, essentially the switch with the lowest priority becomes the root.|Коммутаторы выбирают корневой коммутатор на основе идентификаторов BID в BPDU. Корневой переключатель - это переключатель с наименьшим числовым значением BID. Поскольку двухчастный BID начинается со значения приоритета, по сути, коммутатор с самым низким приоритетом становится корневым.
For example, if one switch has priority 4096, and another switch has priority 8192, the switch with priority 4096 wins, regardless of what MAC address was used to create the BID for each switch.|Например, если один коммутатор имеет приоритет 4096, а другой коммутатор имеет приоритет 8192, победит коммутатор с приоритетом 4096, независимо от того, какой MAC-адрес использовался для создания BID для каждого коммутатора.
|
If a tie occurs based on the priority portion of the BID, the switch with the lowest MAC address portion of the BID is the root.|Если связь возникает на основе приоритетной части BID, коммутатор с наименьшей частью MAC-адреса BID является корневым.
No other tiebreaker should be needed because switches use one of their own universal (burned-in) MAC addresses as the second part of their BIDs. So if the priorities tie, and one switch uses a MAC address of 0200.0000.0000 as part of the BID and the other uses 0811.1111.1111, the first switch (MAC 0200.0000.0000)|Никакого другого разрешения конфликтов не требуется, поскольку коммутаторы используют один из своих собственных универсальных (встроенных) MAC-адресов в качестве второй части своих BID. Итак, если приоритеты совпадают, и один коммутатор использует MAC-адрес 0200.0000.0000 как часть BID, а другой использует 0811.1111.1111, первый коммутатор (MAC 0200.0000.0000)
|
becomes the root switch.|становится корневым коммутатором.
|
STP/RSTP elects a root switch in a manner not unlike a political election.|Протокол STP / RSTP выбирает корневой коммутатор аналогично политическим выборам.
The process begins with all switches claiming to be the root by sending Hello BPDUs listing their own BID as the root BID. If a switch hears a Hello that lists a better (lower) BID, that switch stops advertising itself as root and starts forwarding the superior Hello.|Процесс начинается с того, что все коммутаторы заявляют, что они являются корневыми, отправляя Hello BPDU, перечисляя их собственный BID в качестве корневого BID. Если коммутатор слышит Hello, в котором указан лучший (более низкий) BID, этот коммутатор прекращает рекламировать себя как root и начинает пересылать старшее Hello.
The Hello sent by the better switch lists the better switch’s BID as the root.|В сообщении Hello, отправленном лучшим коммутатором, в качестве корневого указывается BID лучшего коммутатора.
It works like a political race in which a less-popular candidate gives up and leaves the race, throwing his support behind the more popular candidate.|Это работает как политическая гонка, в которой менее популярный кандидат сдается и покидает гонку, оказывая поддержку более популярному кандидату.
Eventually, everyone agrees which switch has the best (lowest) BID, and everyone supports the elected switch—which is where the political race analogy falls apart.|В конце концов, все соглашаются, у какого коммутатора самая лучшая (самая низкая) ставка BID, и все поддерживают выбранный коммутатор - здесь аналогия с политической гонкой разваливается.
|
NOTE A better Hello, meaning that the listed root’s BID is better (numerically lower), is called a superior Hello; a worse Hello, meaning that the listed root’s BID is not as good (numerically higher), is called an inferior Hello.|ПРИМЕЧАНИЕ Лучшее приветствие, означающее, что указанный в списке корневой идентификатор BID лучше (численно ниже), называется старшим приветствием; худшее Hello, означающее, что BID указанного корневого каталога не так хорош (численно выше), называется второстепенным Hello.
|
Figure 9-3 shows the beginning of the root election process.|На рис. 9-3 показано начало процесса корневого выбора.
In this case, SW1 has advertised itself as root, as have SW2 and SW3. However, SW2 now believes that SW1 is a better root, so SW2 is now forwarding the Hello originating at SW1. So, at this point, the figure shows SW1 is saying Hello, claiming to be root; SW2 agrees and is forwarding SW1’s Hello that lists SW1 as root; but SW3 is still claiming to be best, sending its own Hello BPDUs, listing SW3’s BID as the root.|В этом случае SW1 объявил себя root, как и SW2 и SW3. Однако теперь SW2 считает, что SW1 - лучший корень, поэтому SW2 теперь пересылает Hello, исходящее от SW1. Итак, в этот момент рисунок показывает, что SW1 говорит Hello, утверждая, что он root; SW2 соглашается и пересылает SW1 Hello, в котором SW1 указан как root; но SW3 по-прежнему претендует на звание лучшего, отправляя свои собственные Hello BPDU, перечисляя BID SW3 в качестве корневого.
|
Figure 9-3 Beginnings of the Root Election Process Two candidates still exist in Figure 9-3: SW1 and SW3. So, who wins?|Рис. 9-3. Начало процесса корневых выборов. На рис. 9-3 все еще существуют два кандидата: SW1 и SW3. Итак, кто победит?
Well, from the BID, the lower-priority switch wins; if a tie occurs, the lower MAC address wins.|Что ж, от BID выигрывает переключатель с более низким приоритетом; в случае ничьей выигрывает более низкий MAC-адрес.
As shown in the figure, SW1 has a lower BID (32769:0200.0001.0001) than SW3 (32769:0200.0003.0003), so SW1 wins, and SW3 now also believes that SW1 is the better switch.|Как показано на рисунке, SW1 имеет более низкий BID (32769: 0200.0001.0001), чем SW3 (32769: 0200.0003.0003), поэтому SW1 выигрывает, а SW3 теперь также считает, что SW1 - лучший переключатель.
Figure 9-4 shows the resulting Hello messages sent by the switches.|На рис. 9-4 показаны результирующие сообщения Hello, отправленные коммутаторами.
|
Summarizing, the root election happens through each switch claiming to be root, with the best switch being elected based on the numerically lowest BID. Breaking down the BID into its components, the comparisons can be made as|Подводя итог, можно сказать, что выбор root происходит через каждый коммутатор, претендующий на роль root, причем лучший коммутатор выбирается на основе численно самого низкого BID. Разбив BID на составляющие, сравнения можно провести следующим образом:
###### The lowest priority
Самый низкий приоритет   
###### If that ties, the lowest switch MAC address.
Если это так, то самый низкий MAC-адрес коммутатора.   
__|__
--|--
|
Figure 9-4 SW1 Wins the Election|Рисунок 9-4 SW1 побеждает на выборах
##### Choosing Each Switch’s Root Port
Выбор корневого порта каждого коммутатора   
__|__
--|--
|
The second part of the STP/RSTP process occurs when each nonroot switch chooses its one and only root port.|Вторая часть процесса STP / RSTP происходит, когда каждый некорневой коммутатор выбирает свой единственный корневой порт.
A switch’s RP is its interface through which it has the least STP/RSTP cost to reach the root switch (least root cost).|RP коммутатора - это его интерфейс, через который у него наименьшая стоимость STP / RSTP для достижения корневого коммутатора (наименьшая стоимость корневого коммутатора).
|
The idea of a switch’s cost to reach the root switch can be easily seen for humans.|Людям легко понять, насколько дорого обходится коммутатор до корневого коммутатора.
Just look at a network diagram that shows the root switch, lists the STP/RSTP cost associated with each switch port, and identifies the nonroot switch in question.|Просто посмотрите на сетевую диаграмму, которая показывает корневой коммутатор, перечисляет стоимость STP / RSTP, связанную с каждым портом коммутатора, и идентифицирует рассматриваемый некорневой коммутатор.
Switches use a different process than looking at a network diagram, of course, but using a diagram can make it easier to learn the idea.|Коммутаторы, конечно, используют другой процесс, чем просмотр сетевой диаграммы, но использование диаграммы может облегчить понимание идеи.
|
Figure 9-5 shows just such a figure, with the same three switches shown in the last several figures.|На рис. 9-5 показан именно такой рисунок с теми же тремя переключателями, что и на последних нескольких рисунках.
SW1 has already won the election as root, and the figure considers the cost from SW3’s perspective. (Note that the figure uses some nondefault cost settings.)|SW1 уже выиграл выборы как root, и на рисунке показаны затраты с точки зрения SW3. (Обратите внимание, что на рисунке используются некоторые настройки стоимости не по умолчанию.)
|
SW3 has two possible physical paths to send frames to the root switch: the direct path to the left and the indirect path to the right through switch SW2. The cost is the sum of the costs of all the switch ports the frame would exit if it flowed over that path. (The calculation ignores the inbound ports.) As you can see, the cost over the direct path out SW3’s G0/1 port has a total cost of 5, and the other path has a total cost of 8.|SW3 имеет два возможных физических пути для отправки кадров на корневой коммутатор: прямой путь влево и косвенный путь вправо через коммутатор SW2. Стоимость - это сумма затрат на все порты коммутатора, из которых фрейм вышел бы, если бы он прошел по этому пути. (При расчете игнорируются входящие порты.) Как видите, стоимость прямого пути к порту G0 / 1 SW3 составляет 5, а для другого пути - 8.
SW3 picks its G0/1 port as root port because it is the port that is part of the least-cost path to send frames to the root switch.|SW3 выбирает свой порт G0 / 1 в качестве корневого порта, потому что это порт, который является частью пути с наименьшей стоимостью для отправки кадров на корневой коммутатор.
|
Figure 9-5 How a Human Might Calculate STP/RSTP Cost from SW3 to the Root (SW1)|Рисунок 9-5. Как человек может рассчитать стоимость STP / RSTP от SW3 до корня (SW1)
|
Switches come to the same conclusion but using a different process.|Коммутаторы приходят к такому же выводу, но с использованием другого процесса.
Instead, they add their local interface STP/RSTP cost to the root cost listed in each received Hello BPDU. The STP/RSTP port cost is simply an integer value assigned to each interface, per VLAN, for the purpose of providing an objective measurement that allows STP/RSTP to choose which interfaces to add to the STP/RSTP topology.|Вместо этого они добавляют стоимость STP / RSTP своего локального интерфейса к стоимости корня, указанной в каждом полученном Hello BPDU. Стоимость порта STP / RSTP - это просто целое число, присвоенное каждому интерфейсу в каждой VLAN, с целью обеспечения объективного измерения, которое позволяет STP / RSTP выбирать, какие интерфейсы добавить в топологию STP / RSTP.
The switches also look at their neighbor’s root cost, as announced in Hello BPDUs received from each neighbor.|Коммутаторы также проверяют корневую стоимость своего соседа, как объявляется в Hello BPDU, полученных от каждого соседа.
|
Figure 9-6 shows an example of how switches calculate their best root cost and then choose their root port, using the same topology and STP/RSTP costs as shown in Figure 9-5.|На рис. 9-6 показан пример того, как коммутаторы рассчитывают наилучшую стоимость корневого доступа, а затем выбирают свой корневой порт, используя ту же топологию и стоимость STP / RSTP, как показано на рис. 9-5.
|
STP/RSTP on SW3 calculates its cost to reach the root over the two possible paths by adding the advertised cost (in Hello messages) to the interface costs listed in the figure.|STP / RSTP на SW3 вычисляет стоимость достижения корня по двум возможным путям, добавляя объявленную стоимость (в сообщениях Hello) к стоимости интерфейса, указанной на рисунке.
|
Figure 9-6 How STP/RSTP Actually Calculates the Cost from SW3 to the Root Focus on the process for a moment.|Рис. 9-6. Как STP / RSTP на самом деле вычисляет стоимость от SW3 до корня. На мгновение сфокусируйтесь на процессе.
The root switch sends Hellos, with a listed root cost of 0.|Корневой коммутатор отправляет приветствие с указанной корневой стоимостью 0.
The idea is that the root’s cost to reach itself is 0.|Идея состоит в том, что стоимость доступа корня к самому себе равна 0.
|
Next, look on the left of the figure.|Затем посмотрите на рисунок слева.
SW3 takes the received cost (0) from the Hello sent by SW1 and adds the interface cost (5) of the interface on which that Hello was received.|SW3 берет полученную стоимость (0) из Hello, отправленного SW1, и добавляет стоимость интерфейса (5) интерфейса, на котором было получено это Hello.
SW3 calculates that the cost to reach the root switch, out that port (G0/1), is 5.|SW3 рассчитывает, что стоимость доступа к корневому коммутатору за пределами этого порта (G0 / 1) составляет 5.
|
On the right side, SW2 has realized its best cost to reach the root is cost 4.|С правой стороны, SW2 понял, что его лучшая цена для достижения корня - 4.
So, when SW2 forwards the Hello toward SW3, SW2 lists a root cost 4.|Итак, когда SW2 пересылает Hello к SW3, SW2 перечисляет корневую стоимость 4.
SW3’s STP/RSTP port cost on port G0/2 is 4, so SW3 determines a total cost to reach root out its G0/2 port of 8.|Стоимость порта STP / RSTP SW3 на порте G0 / 2 равна 4, поэтому SW3 определяет общую стоимость выхода из порта G0 / 2, равную 8.
|
As a result of the process depicted in Figure 9-6, SW3 chooses Gi0/1 as its RP because the cost to reach the root switch through that port (5) is lower than the other alternative (Gi0/2, cost 8).|В результате процесса, изображенного на рис. 9-6, SW3 выбирает Gi0 / 1 в качестве своего RP, поскольку стоимость доступа к корневому коммутатору через этот порт (5) ниже, чем у другого альтернативного варианта (Gi0 / 2, стоимость 8).
Similarly, SW2 chooses Gi0/2 as its RP, with a cost of 4 (SW1’s advertised cost of 0 plus SW2’s Gi0/2 interface cost of 4).|Точно так же SW2 выбирает Gi0 / 2 в качестве RP со стоимостью 4 (объявленная стоимость SW1 равна 0 плюс стоимость интерфейса Gi0 / 2 SW2 равна 4).
Each switch places its root port into a forwarding state.|Каждый коммутатор переводит свой корневой порт в состояние пересылки.
|
Switches need a tiebreaker to use in case the best root cost ties for two or more paths.|Коммутаторам необходимо использовать средство разрешения конфликтов в случае, если лучшая стоимость корня связана для двух или более путей.
If a tie occurs, the switch applies these three tiebreakers to the paths that tie, in order, as follows:|Если происходит ничья, коммутатор применяет эти три разрешения конфликтов к связующим путям в следующем порядке:
|
1. Choose based on the lowest neighbor bridge ID.|1. Выберите на основе наименьшего идентификатора соседнего моста.
|
2. Choose based on the lowest neighbor port priority.|2. Выберите на основе самого низкого приоритета соседнего порта.
|
3. Choose based on the lowest neighbor internal port number.|3. Выберите на основе наименьшего номера внутреннего порта соседа.
##### Choosing the Designated Port on Each LAN Segment
Выбор назначенного порта в каждом сегменте LAN   
__|__
--|--
|
STP/RSTP’s final step to choose the STP/RSTP topology is to choose the designated port on each LAN segment.|Последний шаг STP / RSTP при выборе топологии STP / RSTP - это выбор назначенного порта в каждом сегменте LAN.
The designated port (DP) on each LAN segment is the switch port that advertises the lowest-cost Hello onto a LAN segment.|Назначенный порт (DP) в каждом сегменте LAN - это порт коммутатора, который объявляет самое дешевое приветствие в сегменте LAN.
When a nonroot switch forwards a Hello, the nonroot switch sets the root cost field in the Hello to that switch’s cost to reach the root.|Когда некорневой коммутатор пересылает Hello, некорневой коммутатор устанавливает в поле стоимости корня в Hello значение стоимости того коммутатора для достижения корня.
In effect, the switch with the lower cost to reach the root, among all switches connected to a segment, becomes the DP on that segment.|По сути, коммутатор с более низкой стоимостью достижения корня среди всех коммутаторов, подключенных к сегменту, становится DP в этом сегменте.
|
For example, earlier Figure 9-4 shows in bold text the parts of the Hello messages from both SW2 and SW3 that determine the choice of DP on that segment.|Например, ранее на рис. 9-4 жирным шрифтом показаны части сообщений Hello и от SW2, и от SW3, которые определяют выбор DP в этом сегменте.
Note that both SW2 and SW3 list their respective cost to reach the root switch (cost 4 on SW2 and cost 5 on SW3).|Обратите внимание, что и SW2, и SW3 указывают свою соответствующую стоимость для достижения корневого коммутатора (стоимость 4 для SW2 и стоимость 5 для SW3).
|
SW2 lists the lower cost, so SW2’s Gi0/1 port is the designated port on that LAN segment.|SW2 указывает более низкую стоимость, поэтому порт Gi0 / 1 SW2 является назначенным портом в этом сегменте LAN.
|
All DPs are placed into a forwarding state; so in this case, SW2’s Gi0/1 interface will be in a forwarding state.|Все DP переводятся в состояние пересылки; поэтому в этом случае интерфейс Gi0 / 1 SW2 будет в состоянии пересылки.
|
If the advertised costs tie, the switches break the tie by choosing the switch with the lower BID. In this case, SW2 would also have won, with a BID of 32769:0200.0002.0002 versus SW3’s 32769:0200.0003.0003.|Если объявленные затраты совпадают, коммутаторы прерывают связь, выбирая коммутатор с более низким BID. В этом случае SW2 также выиграла бы с BID 32769: 0200.0002.0002 по сравнению с 32769: 0200.0003.0003 SW3.
|
NOTE Two additional tiebreakers are needed in some cases, although these would be unlikely today.|ПРИМЕЧАНИЕ. В некоторых случаях необходимы два дополнительных тай-брейка, хотя сегодня это маловероятно.
A single switch can connect two or more interfaces to the same collision domain by connecting to a hub.|Один коммутатор может подключить два или более интерфейса к одному домену конфликтов, подключившись к концентратору.
In that case, the one switch hears its own BPDUs. So, if a switch ties with itself, two additional tiebreakers are used: the lowest interface STP/RSTP priority and, if that ties, the lowest internal interface number.|В этом случае один коммутатор слышит свои собственные BPDU. Таким образом, если коммутатор связан сам с собой, используются два дополнительных средства разрешения конфликтов: самый низкий приоритет интерфейса STP / RSTP и, если это связано, самый низкий внутренний номер интерфейса.
|
The only interface that does not have a reason to be in a forwarding state on the three switches in the examples shown in Figures 9-3 through 9-6 is SW3’s Gi0/2 port.|Единственный интерфейс, который не имеет причины находиться в состоянии пересылки на трех коммутаторах в примерах, показанных на рисунках с 9-3 по 9-6, - это порт Gi0 / 2 SW3.
So, the STP/RSTP process is now complete.|Итак, процесс STP / RSTP завершен.
Table 9-5 outlines the state of each port and shows why it is in that state.|Таблица 9-5 описывает состояние каждого порта и показывает, почему он находится в этом состоянии.
|
Table 9-5 State of Each Interface Table end.|Таблица 9-5. Состояние каждого конца таблицы интерфейсов.
|
Note that the examples in this section focus on the links between the switches, but switch ports connected to endpoint devices should become DPs and settle into a forwarding state.|Обратите внимание, что примеры в этом разделе сосредоточены на каналах связи между коммутаторами, но порты коммутатора, подключенные к оконечным устройствам, должны стать DP и перейти в состояние пересылки.
|
Working through the logic, each switch will forward BPDUs on each port as part of the process to determine the DP on that LAN. Endpoints should ignore those messages because they do not run STP/RSTP, so the switch will win and become DP on every access port.|Работая по логике, каждый коммутатор пересылает BPDU на каждый порт как часть процесса для определения DP в этой локальной сети. Конечные точки должны игнорировать эти сообщения, потому что они не запускают STP / RSTP, поэтому коммутатор выиграет и станет DP на каждом порте доступа.
#### Configuring to Influence the STP Topology
Настройка влияния на топологию STP   
__|__
--|--
|
STP/RSTP works by default on Cisco switches, so all the settings needed by a switch have a useful default.|STP / RSTP по умолчанию работает на коммутаторах Cisco, поэтому все настройки, необходимые коммутатору, имеют полезные значения по умолчанию.
Switches have a default BID, based on a default priority value and adding a universal MAC address that comes with the switch hardware.|Коммутаторы имеют BID по умолчанию, основанный на значении приоритета по умолчанию и добавлении универсального MAC-адреса, который поставляется с оборудованием коммутатора.
Additionally, switch interfaces have default STP/RSTP costs based on the current operating speed of the switch interfaces.|Кроме того, интерфейсы коммутатора имеют стоимость STP / RSTP по умолчанию в зависимости от текущей скорости работы интерфейсов коммутатора.
|
Network engineers often want to change the STP/RSTP settings to then change the choices STP/RSTP makes in a given LAN. Two main tools available to the engineer are to configure the bridge ID and to change STP/RSTP port costs.|Сетевые инженеры часто хотят изменить настройки STP / RSTP, чтобы затем изменить выбор, который STP / RSTP делает в данной локальной сети. Инженеру доступны два основных инструмента: настройка идентификатора моста и изменение стоимости портов STP / RSTP.
|
First, to change the BID, the engineer can set the priority used by the switch, while continuing to use the universal MAC address as the final 48 bits of the BID. For instance, giving a switch the lowest priority value among all switches will cause that switch to win the root election.|Во-первых, чтобы изменить BID, инженер может установить приоритет, используемый коммутатором, продолжая использовать универсальный MAC-адрес в качестве последних 48 бит BID. Например, присвоение коммутатору самого низкого значения приоритета среди всех коммутаторов приведет к тому, что этот коммутатор победит на корневых выборах.
|
Port costs also have default values, per port, per VLAN. You can configure these port costs, which will in turn impact many switch’s calculations of the root cost.|Стоимость портов также имеет значения по умолчанию для каждого порта и VLAN. Вы можете настроить эти затраты на порты, что, в свою очередь, повлияет на расчеты корневой стоимости многими коммутаторами.
For instance, to favor one link, give the ports on that link a lower cost, or to avoid a link, give the ports a higher cost.|Например, чтобы отдать предпочтение одному каналу, назначьте портам на этом канале более низкую стоимость или, чтобы избежать соединения, назначьте портам более высокую стоимость.
|
Of course, it helps to know the default cost values so you can then choose alternative values as needed.|Конечно, полезно знать значения стоимости по умолчанию, чтобы затем при необходимости выбирать альтернативные значения.
Table 9-6 lists the default port costs suggested by IEEE. IOS on Cisco switches has long used the default settings as defined as far back as the 1998 version of the IEEE 802.1D standard.|Таблица 9-6 перечисляет стоимость портов по умолчанию, предложенную IEEE. В IOS на коммутаторах Cisco уже давно используются настройки по умолчанию, определенные еще в версии 1998 года стандарта IEEE 802.1D.
The latest IEEE standard to suggest RSTP default costs (as of the publication of this book), the 2018 publication of the 802.1Q standard, suggests values that are more useful when using links faster than 10 Gbps.|Последний стандарт IEEE, предлагающий стоимость RSTP по умолчанию (на момент публикации этой книги), публикация стандарта 802.1Q 2018 года, предлагает значения, которые более полезны при использовании каналов со скоростью, превышающей 10 Гбит / с.
|
Table 9-6 Default Port Costs According to IEEE Table end.|Таблица 9-6 Стоимость портов по умолчанию в соответствии с концом таблицы IEEE.
|
Of note in regards to these defaults, the cost defaults based on the operating speed of the link, not the maximum speed.|В отношении этих значений по умолчанию следует отметить, что значения по умолчанию основаны на рабочей скорости соединения, а не на максимальной скорости.
That is, if a 10/100/1000 port runs at 10 Mbps for some reason, its default STP cost on a Cisco switch is 100, the default cost for an interface running at 10 Mbps.|То есть, если порт 10/100/1000 по какой-то причине работает на скорости 10 Мбит / с, его стоимость STP по умолчанию на коммутаторе Cisco составляет 100, стоимость по умолчанию для интерфейса, работающего на скорости 10 Мбит / с.
Also, if you prefer the defaults in the right-side column of Table 9-6, note that Cisco Catalyst switches can be configured to use those values as defaults with a single global configuration command on each switch (spanning-tree pathcost method long).|Кроме того, если вы предпочитаете значения по умолчанию в правом столбце Таблицы 9-6, обратите внимание, что коммутаторы Cisco Catalyst могут быть настроены на использование этих значений по умолчанию с помощью одной команды глобальной конфигурации на каждом коммутаторе (метод определения стоимости связующего дерева длинный) .
### Details Specific to STP (and Not RSTP)
Подробности, относящиеся к STP (а не RSTP)   
__|__
--|--
|
As promised in the introduction to this chapter, the first section showed features that apply to both STP and RSTP. This next heading acts as the turning point, with the next several pages being about STP only.|Как и было обещано во введении к этой главе, в первом разделе показаны функции, применимые как к протоколу STP, так и к RSTP. Этот следующий заголовок действует как поворотный момент, так как следующие несколько страниц посвящены только STP.
The upcoming section titled “Rapid STP Concepts” then shows details specific to RSTP, in contrast to STP.|В следующем разделе, озаглавленном «Основные понятия быстрого STP», будут показаны детали, относящиеся к RSTP, в отличие от STP.
|
Once the engineer has finished all STP configuration, the STP topology should settle into a stable state and not change, at least until the network topology changes.|После того как инженер завершит всю настройку STP, топология STP должна перейти в стабильное состояние и не меняться, по крайней мере, до тех пор, пока топология сети не изменится.
This section examines the ongoing operation of STP while the network is stable, and then it covers how STP converges to a new topology when something changes.|В этом разделе исследуется текущая работа STP в стабильной сети, а затем рассматривается, как STP сходится к новой топологии, когда что-то меняется.
|
Note that almost all the differences between STP and RSTP revolve around the activities of waiting for and reacting to changes in the topology.|Обратите внимание, что почти все различия между STP и RSTP связаны с действиями по ожиданию изменений топологии и реагированию на них.
STP performed well for the era and circumstances in which it was created.|STP хорошо зарекомендовал себя для той эпохи и обстоятельств, в которых он был создан.
The “rapid” in RSTP refers to the improvements to how fast RSTP could react when changes occur—so understanding how STP reacts will be useful to understand why RSTP reacts faster.|«Быстрый» в RSTP относится к усовершенствованию того, насколько быстро RSTP может реагировать на изменения, поэтому понимание того, как реагирует STP, будет полезно для понимания того, почему RSTP реагирует быстрее.
These next few pages show the specifics of STP (and not RSTP) and how STP reacts to and manages convergence when changes happen in an Ethernet LAN.|На следующих нескольких страницах показаны особенности STP (а не RSTP) и то, как STP реагирует и управляет конвергенцией, когда в локальной сети Ethernet происходят изменения.
#### STP Activity When the Network Remains Stable
Активность STP, когда сеть остается стабильной   
__|__
--|--
|
An STP root switch sends a new Hello BPDU every 2 seconds by default.|По умолчанию корневой коммутатор STP отправляет новый Hello BPDU каждые 2 секунды.
Each nonroot switch forwards the Hello on all DPs, but only after changing items listed in the Hello. (As a result, the Hello flows once over every working link in the LAN.)|Каждый некорневой коммутатор пересылает Hello на все DP, но только после изменения элементов, перечисленных в Hello. (В результате Hello проходит по каждому рабочему каналу в локальной сети.)
|
When forwarding the Hello BPDU, each switch sets the root cost to that local switch’s calculated root cost.|При пересылке Hello BPDU каждый коммутатор устанавливает корневую стоимость равной вычисленной корневой стоимости этого локального коммутатора.
The switch also sets the “sender’s bridge ID” field to its own bridge ID. (The root’s bridge ID field is not changed.)|Коммутатор также устанавливает в поле «идентификатор моста отправителя» свой собственный идентификатор моста. (Поле идентификатора корневого моста не изменяется.)
|
Assuming a default Hello timer of 2 seconds on the root switch, each switch will forward the received (and changed) Hellos out all DPs so that all switches continue to receive Hellos every 2 seconds.|Предполагая, что таймер приветствия по умолчанию на корневом коммутаторе равен 2 секундам, каждый коммутатор будет пересылать полученные (и измененные) сообщения приветствия всем DP, чтобы все коммутаторы продолжали получать приветствия каждые 2 секунды.
The following steps summarize the steady-state operation when nothing is currently changing in the STP topology:|Следующие шаги резюмируют работу в установившемся режиме, когда в топологии STP в данный момент ничего не меняется:
|
Step 1.|Шаг 1.
The root creates and sends a Hello BPDU, with a root cost of 0, out all its working interfaces (those in a forwarding state).|Корень создает и отправляет Hello BPDU со стоимостью корня 0 на все свои рабочие интерфейсы (те, которые находятся в состоянии пересылки).
|
Step 2.|Шаг 2.
The nonroot switches receive the Hello on their root ports.|Некорневые коммутаторы получают сообщение Hello на свои корневые порты.
After changing the Hello to list their own BID as the sender’s BID and listing that switch’s root cost, the switch forwards the Hello out all designated ports.|После изменения Hello, чтобы указать свой собственный BID в качестве BID отправителя и перечислить корневую стоимость этого коммутатора, коммутатор пересылает Hello на все назначенные порты.
|
Step 3.|Шаг 3.
Steps 1 and 2 repeat until something changes.|Шаги 1 и 2 повторяются, пока что-то не изменится.
|
When a switch fails to receive a Hello, it knows a problem might be occurring in the network.|Когда коммутатор не получает сообщение Hello, он знает, что проблема может возникнуть в сети.
|
Each switch relies on these periodically received Hellos from the root as a way to know that its path to the root is still working.|Каждый коммутатор полагается на эти периодически получаемые от корня приветствия как способ узнать, что его путь к корню все еще работает.
When a switch ceases to receive the Hellos, or receives a Hello that lists different details, something has failed, so the switch reacts and starts the process of changing the spanning-tree topology.|Когда коммутатор перестает получать приветственные сообщения или получает приветственное сообщение, в котором перечислены различные детали, происходит сбой, поэтому коммутатор реагирует и запускает процесс изменения топологии связующего дерева.
#### STP Timers That Manage STP Convergence
Таймеры STP, управляющие конвергенцией STP   
__|__
--|--
|
For various reasons, the STP convergence process requires the use of three timers, listed in Table 9-7.|По разным причинам процесс конвергенции STP требует использования трех таймеров, перечисленных в таблице 9-7.
Note that all switches use the timers as dictated by the root switch, which the root lists in its periodic Hello BPDU messages.|Обратите внимание, что все коммутаторы используют таймеры в соответствии с указаниями корневого коммутатора, который корень перечисляет в своих периодических сообщениях Hello BPDU.
|
Table 9-7 STP Timers Table end.|Таблица 9-7 Таймеры STP Конец таблицы.
|
If a switch does not get an expected Hello BPDU within the Hello time, the switch continues as normal.|Если коммутатор не получает ожидаемого Hello BPDU в течение времени Hello, коммутатор продолжает работу в обычном режиме.
However, if the Hellos do not show up again within MaxAge time, the switch reacts by taking steps to change the STP topology.|Однако, если сообщения приветствия не появляются снова в течение времени MaxAge, коммутатор реагирует, предпринимая шаги по изменению топологии STP.
With default settings, MaxAge is 20 seconds (10 times the default Hello timer of 2 seconds).|При настройках по умолчанию MaxAge составляет 20 секунд (в 10 раз больше таймера приветствия по умолчанию, равного 2 секундам).
So, a switch would go 20 seconds without hearing a Hello before reacting.|Таким образом, переключение прошло бы 20 секунд, не услышав Hello, прежде чем среагировать.
|
After MaxAge expires, the switch essentially makes all its STP choices again, based on any Hellos it receives from other switches.|По истечении срока действия MaxAge коммутатор, по сути, снова делает все свои варианты STP на основе любых сообщений Hello, которые он получает от других коммутаторов.
It reevaluates which switch should be the root switch.|Он повторно оценивает, какой коммутатор должен быть корневым.
|
If the local switch is not the root, it chooses its RP. And it determines whether it is DP on each of its other links.|Если локальный коммутатор не является корневым, он выбирает свой RP. И он определяет, является ли это DP на каждой из своих других ссылок.
|
The best way to describe STP convergence is to show an example using the same familiar topology.|Лучший способ описать сходимость STP - показать пример, использующий ту же знакомую топологию.
Figure 9-7 shows the same familiar figure, with SW3’s Gi0/2 in a blocking state, but SW1’s Gi0/2 interface has just failed.|На рис. 9-7 показан тот же знакомый рисунок, где Gi0 / 2 SW3 находится в состоянии блокировки, но интерфейс Gi0 / 2 SW1 только что вышел из строя.
|
Figure 9-7 Initial STP State Before SW1-SW3 Link Fails In the scenario shown in the figure, SW3 reacts to the change because SW3 fails to receive its expected Hellos on its Gi0/1 interface.|Рисунок 9-7 Начальное состояние STP перед отказом канала связи SW1-SW3 В сценарии, показанном на рисунке, SW3 реагирует на изменение, потому что SW3 не может получить ожидаемые сообщения Hello на своем интерфейсе Gi0 / 1.
However, SW2 does not need to react because SW2 continues to receive its periodic Hellos in its Gi0/2 interface.|Однако SW2 не должен реагировать, потому что SW2 продолжает получать свои периодические приветствия в своем интерфейсе Gi0 / 2.
In this case, SW3 reacts either when MaxAge time passes without hearing the Hellos, or as soon as SW3 notices that interface Gi0/1 has failed. (If the interface fails, the switch can assume that the Hellos will not be arriving in that interface anymore.)|В этом случае SW3 реагирует либо тогда, когда время MaxAge проходит, не слыша приветствия, либо как только SW3 замечает, что интерфейс Gi0 / 1 вышел из строя. (Если интерфейс выходит из строя, коммутатор может предположить, что сообщения Hellos больше не будут поступать через этот интерфейс.)
|
Now that SW3 can act, it begins by reevaluating the choice of root switch.|Теперь, когда SW3 может действовать, он начинает с переоценки выбора корневого коммутатора.
SW3 still receives the Hellos from SW2, as forwarded from the root (SW1).|SW3 по-прежнему получает приветствия от SW2, перенаправленные от корня (SW1).
SW1 still has a lower BID than SW3; otherwise, SW1 would not have already been the root.|SW1 по-прежнему имеет более низкий BID, чем SW3; в противном случае SW1 еще не был бы корнем.
So, SW3 decides that SW1 wins the root election and that SW3 is not the root.|Итак, SW3 решает, что SW1 побеждает на корневых выборах, а SW3 не является корневым.
|
Next, SW3 reevaluates its choice of RP. At this point, SW3 is receiving Hellos on only one interface: Gi0/2.|Затем SW3 пересматривает свой выбор RP. На данный момент SW3 получает приветствия только на одном интерфейсе: Gi0 / 2.
Whatever the calculated root cost, Gi0/2 becomes SW3’s new RP. (The cost would be 8, assuming the STP costs had no changes since Figures 9-5 and 9-6.)|Независимо от рассчитанной корневой стоимости Gi0 / 2 становится новым RP SW3. (Стоимость будет 8, если предположить, что стоимость STP не изменилась по сравнению с рисунками 9-5 и 9-6.)
|
SW3 then reevaluates its role as DP on any other interfaces.|Затем SW3 повторно оценивает свою роль DP на любых других интерфейсах.
In this example, no real work needs to be done.|В этом примере не требуется никакой реальной работы.
SW3 was already DP on interface Fa0/13, and it continues to be the DP because no other switches connect to that port.|SW3 уже был DP на интерфейсе Fa0 / 13, и он продолжает быть DP, потому что другие коммутаторы не подключаются к этому порту.
#### Changing Interface States with STP
Изменение состояний интерфейса с помощью STP   
__|__
--|--
|
STP uses the idea of roles and states.|STP использует идею ролей и состояний.
Roles, like root port and designated port, relate to how STP analyzes the LAN topology.|Роли, такие как корневой порт и назначенный порт, связаны с тем, как STP анализирует топологию LAN.
States, like forwarding and blocking, tell a switch whether to send or receive frames.|Такие состояния, как пересылка и блокировка, указывают коммутатору, следует ли отправлять или получать кадры.
When STP converges, a switch chooses new port roles, and the port roles determine the state (forwarding or blocking).|Когда STP сходится, коммутатор выбирает новые роли порта, а роли порта определяют состояние (пересылка или блокировка).
|
Switches using STP can simply move immediately from forwarding to blocking state, but they must take extra time to transition from blocking state to forwarding state.|Коммутаторы, использующие STP, могут просто немедленно перейти из состояния пересылки в состояние блокировки, но им потребуется дополнительное время для перехода из состояния блокировки в состояние пересылки.
For instance, when switch SW3 in Figure 9-7 formerly used port G0/1 as its RP (a role), that port was in a forwarding state.|Например, когда коммутатор SW3 на рисунке 9-7 ранее использовал порт G0 / 1 в качестве RP (роли), этот порт находился в состоянии пересылки.
After convergence, G0/1 might be neither an RP nor DP; the switch can immediately move that port to a blocking state.|После сходимости G0 / 1 может быть ни RP, ни DP; коммутатор может немедленно перевести этот порт в состояние блокировки.
|
However, when a port that formerly blocked needs to transition to forwarding, the switch first puts the port through two intermediate interface states.|Однако, когда порт, который ранее был заблокирован, должен перейти в режим пересылки, коммутатор сначала переводит порт через два промежуточных состояния интерфейса.
These temporary STP states help prevent temporary loops:|Эти временные состояния STP помогают предотвратить временные петли:
###### Listening: Like the blocking state, the interface does not forward frames. The switch
Прослушивание: как и в состоянии блокировки, интерфейс не пересылает кадры. Переключатель   
__|__
--|--
|
removes old stale (unused) MAC table entries for which no frames are received from each MAC address during this period.|удаляет старые устаревшие (неиспользуемые) записи в таблице MAC-адресов, для которых в течение этого периода не получены кадры с каждого MAC-адреса.
These stale MAC table entries could be the cause of the temporary loops.|Эти устаревшие записи таблицы MAC могут быть причиной временных циклов.
###### Learning: Interfaces in this state still do not forward frames, but the switch begins to
Обучение: интерфейсы в этом состоянии все еще не пересылают кадры, но коммутатор начинает   
__|__
--|--
|
learn the MAC addresses of frames received on the interface.|узнайте MAC-адреса кадров, полученных на интерфейсе.
|
STP moves an interface from blocking to listening, then to learning, and then to forwarding state.|STP переводит интерфейс из состояния блокировки в состояние прослушивания, затем в состояние обучения, а затем в состояние пересылки.
STP leaves the interface in each interim state for a time equal to the forward delay timer, which defaults to 15 seconds.|STP оставляет интерфейс в каждом промежуточном состоянии на время, равное таймеру задержки пересылки, которое по умолчанию составляет 15 секунд.
As a result, a convergence event that causes an interface to change from blocking to forwarding requires 30 seconds to transition from blocking to forwarding.|В результате событие конвергенции, которое вызывает переход интерфейса с блокировки на пересылку, требует 30 секунд для перехода от блокировки к пересылке.
In addition, a switch might have to wait MaxAge seconds (default 20 seconds)|Кроме того, коммутатору может потребоваться подождать MaxAge секунд (по умолчанию 20 секунд).
|
before even choosing to move an interface from blocking to forwarding state.|еще до того, как выбрать перевод интерфейса из состояния блокировки в состояние пересылки.
|
For example, follow what happens with an initial STP topology as shown in Figures 9-3 through 9-6, with the SW1-to-SW3 link failing as shown in Figure 9-7.|Например, проследите, что происходит с начальной топологией STP, как показано на рисунках с 9-3 по 9-6, с отказом канала SW1-SW3, как показано на рисунке 9-7.
If SW1 simply quit sending Hello messages to SW3, but the link between the two did not fail, SW3 would wait MaxAge seconds before reacting (20 seconds is the default).|Если SW1 просто прекратил отправлять сообщения Hello SW3, но связь между ними не прервалась, SW3 будет ждать MaxAge секунд, прежде чем реагировать (по умолчанию 20 секунд).
SW3 would actually quickly choose its ports’ STP roles, but then wait 15 seconds each in listening and learning states on interface Gi0/2, resulting in a 50-second convergence delay.|SW3 на самом деле быстро выбирает роли STP своих портов, но затем ждет по 15 секунд каждую в состояниях прослушивания и обучения на интерфейсе Gi0 / 2, что приводит к 50-секундной задержке сходимости.
|
Table 9-8 summarizes spanning tree’s various interface states for easier review.|В таблице 9-8 приведены различные состояния интерфейса связующего дерева для облегчения просмотра.
|
Table 9-8 IEEE STP (Not RSTP) States Table end.|Таблица 9-8 Состояния IEEE STP (не RSTP) Конец таблицы.
### Rapid STP Concepts
Концепции Rapid STP   
__|__
--|--
|
The original STP worked well given the assumptions about networks and networking devices in that era.|Исходный протокол STP хорошо работал с учетом предположений о сетях и сетевых устройствах того времени.
However, as with any computing or networking standard, as time passes, hardware and software capabilities improve, so new protocols emerge to take advantage of those new capabilities.|Однако, как и в случае с любыми вычислительными или сетевыми стандартами, со временем возможности оборудования и программного обеспечения улучшаются, поэтому появляются новые протоколы, использующие эти новые возможности.
For STP, one of the most significant improvements over time has been the introduction of Rapid Spanning Tree Protocol (RSTP), introduced as standard IEEE 802.1w.|Для STP одним из наиболее значительных улучшений со временем стало внедрение протокола Rapid Spanning Tree Protocol (RSTP), представленного как стандарт IEEE 802.1w.
|
NOTE Just to make sure you are clear about the terminology: Throughout the rest of the chapter, STP refers to the original STP standard only, and use of the term RSTP does not include STP.|ПРИМЕЧАНИЕ Просто чтобы убедиться, что вы понимаете терминологию: В остальной части главы STP относится только к исходному стандарту STP, а использование термина RSTP не включает STP.
|
Before getting into the details of RSTP, it helps to make sense of the standards numbers a bit.|Прежде чем вдаваться в подробности RSTP, стоит немного разобраться в стандартах.
|
802.1w was actually an amendment to the 802.1D standard.|802.1w на самом деле был поправкой к стандарту 802.1D.
The IEEE first published 802.1D in 1990, and anew in 1998.|IEEE впервые опубликовал 802.1D в 1990 году и снова в 1998 году.
After the 1998 version of 802.1D, the IEEE published the 802.1w amendment to 802.1D in 2001, which first standardized RSTP.|После версии 802.1D 1998 года, IEEE опубликовал поправку 802.1w к 802.1D в 2001 году, которая впервые стандартизировала RSTP.
|
Over the years, other meaningful changes happened in the standards as well, although those changes probably do not impact most networkers’ thinking when it comes to working with STP or RSTP. But to be complete, the IEEE replaced STP with RSTP in the revised 802.1D standard in 2004.|С годами в стандарты произошли и другие значимые изменения, хотя эти изменения, вероятно, не влияют на мышление большинства сетевых специалистов, когда дело доходит до работы с STP или RSTP. Но чтобы завершить, IEEE заменил STP на RSTP в пересмотренном стандарте 802.1D в 2004 году.
In another move, in 2011 the IEEE moved all the RSTP details into a revised 802.1Q standard.|Еще один шаг: в 2011 году IEEE переместил все детали RSTP в пересмотренный стандарт 802.1Q.
As it stands today, RSTP actually sits in the 802.1Q standards document.|В его нынешнем виде RSTP фактически включен в стандарт 802.1Q.
|
As a result, when reading about RSTP, you will see documents, books, videos, and the like that refer to RSTP and include various references to 802.1w, 802.1D, and 802.1Q—and they might all be correct based on timing and context.|В результате, читая о RSTP, вы увидите документы, книги, видео и тому подобное, которые относятся к RSTP и включают различные ссылки на 802.1w, 802.1D и 802.1Q - и все они могут быть правильными в зависимости от времени и контекст.
At the same time, many people refer to RSTP as 802.1w because that was the first IEEE document to define it.|В то же время многие люди называют RSTP 802.1w, потому что это был первый документ IEEE, в котором он был определен.
However, for the purposes of this book, focus instead on the RSTP acronym rather than the IEEE standards numbers used with RSTP over its history.|Однако для целей этой книги вместо этого сосредоточьтесь на аббревиатуре RSTP, а не на номерах стандартов IEEE, которые использовались с RSTP на протяжении его истории.
|
NOTE The IEEE sells its standards, but through the “Get IEEE 802” program, you can get free PDFs of the current 802 standards.|ПРИМЕЧАНИЕ IEEE продает свои стандарты, но с помощью программы «Get IEEE 802» вы можете бесплатно получить PDF-файлы текущих стандартов 802.
To read about RSTP today, you will need to download the 802.1Q standard, and then look for the sections about RSTP.|Чтобы прочитать о RSTP сегодня, вам нужно будет загрузить стандарт 802.1Q, а затем искать разделы о RSTP.
|
Now on to the details about RSTP in this chapter.|Теперь перейдем к подробностям о RSTP в этой главе.
As discussed throughout this chapter, RSTP and STP have many similarities, so this section next compares and contrasts the two.|Как уже говорилось в этой главе, RSTP и STP имеют много общего, поэтому в следующем разделе мы их сравниваем и сравниваем.
|
Following that, the rest of this section discusses the concepts unique to RSTP that are not found in STP—alternate root ports, different port states, backup ports, and the port roles used by RSTP.|После этого в оставшейся части этого раздела обсуждаются уникальные для RSTP концепции, которых нет в STP - альтернативные корневые порты, различные состояния портов, резервные порты и роли портов, используемые RSTP.
#### Comparing STP and RSTP
Сравнение STP и RSTP   
__|__
--|--
|
RSTP works just like STP in several ways, as discussed in the first major section of the chapter.|RSTP работает так же, как STP, несколькими способами, как обсуждалось в первом основном разделе этой главы.
|
To review:|Для обзора:
###### RSTP and STP elect the root switch using the same rules and tiebreakers.
RSTP и STP выбирают корневой коммутатор, используя одни и те же правила и разрешения конфликтов.   
###### RSTP and STP switches select their root ports with the same rules.
Коммутаторы RSTP и STP выбирают свои корневые порты по одинаковым правилам.   
###### RSTP and STP elect designated ports on each LAN segment with the same rules and
RSTP и STP выбирают назначенные порты в каждом сегменте LAN с одинаковыми правилами и   
__|__
--|--
|
tiebreakers.|тай-брейки.
###### RSTP and STP place each port in either forwarding or blocking state, although RSTP calls
RSTP и STP переводят каждый порт в состояние пересылки или блокировки, хотя RSTP вызывает   
__|__
--|--
|
the blocking state the discarding state.|состояние блокировки состояние отмены.
|
In fact, RSTP works so much like STP that they can both be used in the same network.|Фактически, RSTP работает так же, как STP, что оба могут использоваться в одной сети.
|
RSTP and STP switches can be deployed in the same network, with RSTP features working in switches that support it and traditional STP features working in the switches that support only STP.|Коммутаторы RSTP и STP могут быть развернуты в одной сети, при этом функции RSTP работают в коммутаторах, которые его поддерживают, а традиционные функции STP работают в коммутаторах, поддерживающих только STP.
|
With all these similarities, you might be wondering why the IEEE bothered to create RSTP in the first place.|При всем этом сходстве у вас может возникнуть вопрос, почему IEEE вообще потрудился создать RSTP.
The overriding reason is convergence.|Основная причина - конвергенция.
STP takes a relatively long time to converge (50 seconds with the default settings when all the wait times must be followed).|Для схождения STP требуется относительно много времени (50 секунд с настройками по умолчанию, когда необходимо соблюдать все времена ожидания).
|
RSTP improves network convergence when topology changes occur, usually converging within a few seconds (or in slow conditions, in about 10 seconds).|RSTP улучшает сходимость сети при изменении топологии, обычно сходимость в течение нескольких секунд (или в медленных условиях примерно за 10 секунд).
|
RSTP changes and adds to STP in ways that avoid waiting on STP timers, resulting in quick transitions from forwarding to discarding (blocking) state and vice versa.|RSTP изменяется и дополняет STP таким образом, чтобы избежать ожидания таймеров STP, что приводит к быстрому переходу от состояния пересылки к состоянию отмены (блокировки) и наоборот.
Specifically, RSTP, compared to STP, defines more cases in which the switch can avoid waiting for a timer to expire, such as the following:|В частности, RSTP, по сравнению с STP, определяет больше случаев, в которых коммутатор может избежать ожидания истечения таймера, например следующие:
###### RSTP adds a mechanism by which a switch can replace its root port, without any waiting
RSTP добавляет механизм, с помощью которого коммутатор может заменить свой корневой порт без ожидания.   
__|__
--|--
|
to reach a forwarding state (in some conditions).|для перехода в состояние пересылки (при некоторых условиях).
###### RSTP adds a new mechanism to replace a designated port, without any waiting to reach a
RSTP добавляет новый механизм для замены назначенного порта, не дожидаясь достижения   
__|__
--|--
|
forwarding state (in some conditions).|состояние пересылки (в некоторых условиях).
###### RSTP lowers waiting times for cases in which RSTP must wait for a timer.
RSTP снижает время ожидания для случаев, когда RSTP должен ждать таймера.   
__|__
--|--
|
For instance, imagine a failure case in which a link remains up, but for some reason, a nonroot switch stops hearing the Hello BPDUs it had been hearing in the past.|Например, представьте себе случай отказа, при котором соединение остается активным, но по какой-то причине некорневой коммутатор перестает слышать Hello BPDU, которое он слышал в прошлом.
STP requires a switch to wait for MaxAge seconds, which STP defines based on 10 times the Hello timer, or 20 seconds, by default.|STP требует, чтобы коммутатор ждал в течение MaxAge секунд, которые STP определяет на основе 10-кратного таймера Hello или 20 секунд по умолчанию.
RSTP shortens this timer, defining MaxAge as three times the Hello timer.|RSTP сокращает этот таймер, определяя MaxAge как трехкратный таймер Hello.
Additionally, RSTP can send messages to the neighboring switch to inquire whether a problem has occurred rather than wait for timers.|Кроме того, RSTP может отправлять сообщения на соседний коммутатор, чтобы узнать, возникла ли проблема, вместо того, чтобы ждать таймеров.
|
The best way to get a sense for these mechanisms is to see how the RSTP alternate port and the backup port both work.|Лучший способ разобраться в этих механизмах - посмотреть, как работают альтернативный порт RSTP и резервный порт.
RSTP uses the term alternate port to refer to a switch’s other ports that could be used as the root port if the root port ever fails.|RSTP использует термин альтернативный порт для обозначения других портов коммутатора, которые могут использоваться в качестве корневого порта в случае выхода из строя корневого порта.
The backup port concept provides a backup port on the local switch for a designated port. (Note that backup ports apply only to designs that use hubs, so they are unlikely to be useful today.) However, both are instructive about how RSTP works.|Концепция резервного порта обеспечивает резервный порт на локальном коммутаторе для назначенного порта. (Обратите внимание, что резервные порты применимы только к проектам, использующим концентраторы, поэтому они вряд ли будут полезны сегодня.) Однако оба поучительны в отношении того, как работает RSTP.
Table 9-9 lists these RSTP port roles.|В Таблице 9-9 перечислены эти роли портов RSTP.
|
Table 9-9 Port Roles in RSTP Table end.|Таблица 9-9 Роли портов в конце таблицы RSTP.
|
RSTP differs from STP in a few other ways as well.|RSTP отличается от STP и несколькими другими способами.
For instance, with STP, the root switch creates a Hello with all other switches, updating and forwarding the Hello.|Например, с STP корневой коммутатор создает Hello со всеми другими коммутаторами, обновляя и пересылая Hello.
With RSTP, each switch independently generates its own Hellos.|При использовании RSTP каждый коммутатор независимо генерирует свои собственные приветствия.
Additionally, RSTP allows for queries between neighbors, rather than waiting on timers to expire, as a means to avoid waiting to learn information.|Кроме того, RSTP позволяет отправлять запросы между соседями вместо ожидания истечения таймеров, чтобы избежать ожидания получения информации.
These types of protocol changes help RSTP-based switches isolate what has changed in a network and react quickly to choose a net RSTP topology.|Эти типы изменений протокола помогают коммутаторам на основе RSTP изолировать то, что изменилось в сети, и быстро реагировать на выбор сетевой топологии RSTP.
|
The next few pages work through some of those overt RSTP features that differ from STP.|На следующих нескольких страницах рассматриваются некоторые из тех явных функций RSTP, которые отличаются от STP.
#### RSTP and the Alternate (Root) Port Role
RSTP и роль альтернативного (корневого) порта   
__|__
--|--
|
With STP, each nonroot switch places one port in the STP root port (RP) role.|При использовании STP каждый некорневой коммутатор помещает один порт в роль корневого порта (RP) STP.
RSTP follows that same convention, with the same exact rules for choosing the RP. RSTP then takes another step beyond STP, naming other possible RPs, identifying them as alternate ports.|RSTP следует тому же соглашению с теми же точными правилами выбора RP. Затем RSTP делает еще один шаг за пределы STP, называя другие возможные RP, идентифицируя их как альтернативные порты.
|
To be an alternate port, both the RP and the alternate port must receive Hellos that identify the same root switch.|Чтобы быть альтернативным портом, и RP, и альтернативный порт должны получать сообщения приветствия, которые идентифицируют один и тот же корневой коммутатор.
For instance, in Figure 9-8, SW1 is the root.|Например, на рис. 9-8 SW1 - это корень.
SW3 will receive Hello BPDUs on two ports: G0/1 and G0/2.|SW3 будет получать Hello BPDU на двух портах: G0 / 1 и G0 / 2.
Both Hellos list SW1’s bridge ID (BID) as the root switch, so whichever port is not the root port meets the criteria to be an alternate port.|Оба Hellos указывают идентификатор моста SW1 (BID) в качестве корневого коммутатора, поэтому любой порт, не являющийся корневым, соответствует критериям альтернативного порта.
SW3 picks G0/1 as its root port in this case and then makes G0/2 an alternate port.|SW3 выбирает G0 / 1 в качестве корневого порта в этом случае, а затем делает G0 / 2 альтернативным портом.
|
An alternate port basically works like the second-best option for the root port.|Альтернативный порт в основном работает как второй лучший вариант для корневого порта.
The alternate port can take over for the former root port, often very rapidly, without requiring a wait in other interim RSTP states.|Альтернативный порт может занять место бывшего корневого порта, часто очень быстро, без необходимости ожидания в других промежуточных состояниях RSTP.
For instance, when the root port fails, or when Hellos stop arriving on the original root port, the switch changes the former root port’s role and state: (a) the role from root port to a disabled port, and (b) the state from forwarding to discarding (the equivalent of STP’s blocking state).|Например, когда корневой порт выходит из строя или когда приветы перестают поступать на исходный корневой порт, коммутатор изменяет роль и состояние бывшего корневого порта: (а) роль с корневого порта на отключенный порт и (б) состояние от пересылки до отбрасывания (эквивалент состояния блокировки STP).
Then, without waiting on any timers, the switch changes roles and state for the alternate port: its role changes to be the root port, with a forwarding state.|Затем, не дожидаясь таймеров, коммутатор меняет роли и состояние для альтернативного порта: его роль меняется на корневой порт с состоянием пересылки.
|
Notably, the new root port also does not need to spend time in other states, such as learning state, instead moving immediately to forwarding state.|Примечательно, что новому корневому порту также не нужно проводить время в других состояниях, таких как состояние обучения, вместо этого он немедленно переходит в состояние пересылки.
|
Figure 9-8 Example of SW3 Making G0/2 Become an Alternate Port Figure 9-9 shows an example of RSTP convergence.|Рисунок 9-8. Пример SW3, когда G0 / 2 становится альтернативным портом. Рисунок 9-9 показывает пример конвергенции RSTP.
SW3’s root port before the failure shown in this figure is SW3’s G0/1, the link connected directly to SW1 (the root switch).|Корневым портом SW3 до сбоя, показанного на этом рисунке, был G0 / 1 SW3, канал, подключенный напрямую к SW1 (корневому коммутатору).
Then SW3’s link to SW1 fails as shown in Step 1 of the figure.|Тогда связь SW3 с SW1 не работает, как показано на шаге 1 рисунка.
|
Figure 9-9 Convergence Events with SW3 G0/1 Failure Following the steps in Figure 9-9:|Рисунок 9-9 События сходимости при отказе SW3 G0 / 1 Выполните шаги, показанные на рисунке 9-9:
|
Step 1.|Шаг 1.
The link between SW1 and SW3 fails, so SW3’s current root port (Gi0/1) fails.|Связь между SW1 и SW3 не работает, поэтому текущий корневой порт SW3 (Gi0 / 1) не работает.
|
Step 2.|Шаг 2.
SW3 and SW2 exchange RSTP messages to confirm that SW3 will now transition its former alternate port (Gi0/2) to be the root port.|SW3 и SW2 обмениваются сообщениями RSTP, чтобы подтвердить, что SW3 теперь переведет свой прежний альтернативный порт (Gi0 / 2) в корневой порт.
This action causes SW2 to flush the required MAC table entries.|Это действие заставляет SW2 очищать требуемые записи таблицы MAC.
|
Step 3.|Шаг 3.
SW3 transitions Gi0/1 to the disabled role and Gi0/2 to the root port role.|SW3 переводит Gi0 / 1 в отключенную роль, а Gi0 / 2 в роль корневого порта.
|
Step 4.|Шаг 4.
SW3 transitions Gi0/2 to a forwarding state immediately, without using learning state, because this is one case in which RSTP knows the transition will not create a loop.|SW3 переводит Gi0 / 2 в состояние пересылки немедленно, без использования состояния обучения, потому что это один из случаев, когда RSTP знает, что переход не создаст петли.
|
As soon as SW3 realizes its Gi0/1 interface has failed, the process shown in the figure takes very little time.|Как только SW3 понимает, что его интерфейс Gi0 / 1 вышел из строя, процесс, показанный на рисунке, занимает очень мало времени.
None of the processes rely on timers, so as soon as the work can be done, the convergence completes. (This particular convergence example takes about 1 second in a lab.)|Ни один из процессов не полагается на таймеры, поэтому, как только работа может быть выполнена, конвергенция завершается. (Этот конкретный пример сходимости занимает в лаборатории около 1 секунды.)
#### RSTP States and Processes
Состояния и процессы RSTP   
__|__
--|--
|
The depth of the previous example does not point out all details of RSTP, of course; however, the example does show enough details to discuss RSTP states and internal processes.|Глубина предыдущего примера, конечно, не раскрывает всех деталей RSTP; тем не менее, пример показывает достаточно деталей, чтобы обсудить состояния и внутренние процессы RSTP.
|
Both STP and RSTP use port states, but with some differences.|И STP, и RSTP используют состояния портов, но с некоторыми отличиями.
First, RSTP keeps both the learning and forwarding states as compared with STP, for the same purposes.|Во-первых, RSTP сохраняет состояние обучения и пересылки по сравнению с STP для тех же целей.
However, RSTP does not even define a listening state, finding it unnecessary.|Однако RSTP даже не определяет состояние прослушивания, считая его ненужным.
Finally, RSTP renames the blocking state to the discarding state and redefines its use slightly.|Наконец, RSTP переименовывает состояние блокировки в состояние отмены и немного переопределяет его использование.
|
RSTP uses the discarding state for what STP defines as two states: disabled state and blocking state.|RSTP использует состояние отмены для того, что STP определяет как два состояния: отключенное состояние и состояние блокировки.
Blocking should be somewhat obvious by now: the interface can work physically, but STP/RSTP chooses to not forward traffic to avoid loops.|К настоящему времени блокировка должна быть очевидна: интерфейс может работать физически, но STP / RSTP предпочитает не пересылать трафик, чтобы избежать петель.
STP’s disabled state simply meant that the interface was administratively disabled.|Состояние отключения STP просто означает, что интерфейс отключен административно.
RSTP just combines those into a single discarding state.|RSTP просто объединяет их в одно состояние отбрасывания.
Table 9-10 shows the list of STP and RSTP states for comparison purposes.|Таблица 9-10 показывает список состояний STP и RSTP для сравнения.
|
Table 9-10 Port States Compared: STP and RSTP Table end.|Таблица 9-10 Сравнение состояний портов: конец таблицы STP и RSTP.
|
RSTP also changes some processes and message content (compared to STP) to speed convergence.|RSTP также изменяет некоторые процессы и содержимое сообщений (по сравнению с STP) для ускорения конвергенции.
|
For example, STP waits for a time (forward delay) in both listening and learning states.|Например, STP ожидает некоторое время (задержка пересылки) как в состоянии прослушивания, так и в состоянии обучения.
|
The reason for this delay in STP is that, at the same time, the switches have all been told to time out their MAC table entries.|Причина этой задержки в STP заключается в том, что в то же время всем коммутаторам было приказано истечь время ожидания своих записей в таблице MAC.
When the topology changes, the existing MAC table entries may actually cause a loop.|Когда топология изменяется, существующие записи таблицы MAC могут фактически вызвать петлю.
With STP, the switches all tell each other (with BPDU messages) that the topology has changed and to time out any MAC table entries using the forward delay timer.|С STP все коммутаторы сообщают друг другу (с сообщениями BPDU), что топология изменилась, и тайм-аут для любых записей таблицы MAC с помощью таймера задержки пересылки.
This removes the entries, which is good, but it causes the need to wait in both listening and learning state for forward delay time (default 15 seconds each).|Это удаляет записи, что хорошо, но вызывает необходимость ожидания времени задержки пересылки как в состоянии прослушивания, так и в состоянии обучения (по умолчанию 15 секунд каждая).
|
RSTP, to converge more quickly, avoids relying on timers.|RSTP, чтобы сойтись быстрее, избегает использования таймеров.
RSTP switches tell each other (using messages) that the topology has changed.|Коммутаторы RSTP сообщают друг другу (используя сообщения), что топология изменилась.
Those messages also direct neighboring switches to flush the contents of their MAC tables in a way that removes all the potentially loop-causing entries, without a wait.|Эти сообщения также предписывают соседним коммутаторам очистить содержимое своих таблиц MAC таким образом, чтобы без ожидания удалялись все потенциально вызывающие петли записи.
As a result, RSTP creates more scenarios in which a formerly discarding port can immediately transition to a forwarding state, without waiting, and without using the learning state, as shown in the example in Figure 9-9.|В результате RSTP создает больше сценариев, в которых ранее отвергающий порт может немедленно перейти в состояние пересылки, без ожидания и без использования состояния обучения, как показано в примере на рис. 9-9.
#### RSTP and the Backup (Designated) Port Role
RSTP и роль резервного (назначенного) порта   
__|__
--|--
|
The RSTP backup port role acts as yet another new RSTP port role as compared to STP. As a reminder, the RSTP alternate port role creates a way for RSTP to quickly replace a switch’s root port.|Роль резервного порта RSTP действует как еще одна новая роль порта RSTP по сравнению с STP. Напоминаем, что роль альтернативного порта RSTP позволяет RSTP быстро заменить корневой порт коммутатора.
Similarly, the RSTP backup port role creates a way for RSTP to quickly replace a switch’s designated port on some LAN.|Точно так же роль резервного порта RSTP позволяет RSTP быстро заменить назначенный порт коммутатора в некоторой локальной сети.
|
The need for a backup port can be a bit confusing at first because the need for the backup port role only happens in designs that are a little unlikely today.|Потребность в резервном порту может сначала сбивать с толку, потому что необходимость в роли резервного порта возникает только в проектах, которые сегодня маловероятны.
The reason is that a design must use hubs, which then allows the possibility that one switch connects more than one port to the same collision domain.|Причина в том, что в проекте должны использоваться концентраторы, что тогда допускает возможность того, что один коммутатор подключит более одного порта к одному домену конфликтов.
|
Figure 9-10 shows an example.|На рис. 9-10 показан пример.
SW3 and SW4 both connect to the same hub.|SW3 и SW4 оба подключены к одному концентратору.
SW4’s port F0/1 happens to win the election as designated port (DP). The other port on SW4 that connects to the same collision domain, F0/2, acts as a backup port.|Порт F0 / 1 SW4 выигрывает выборы в качестве назначенного порта (DP). Другой порт на SW4, который подключается к тому же домену конфликтов, F0 / 2, действует как резервный порт.
|
Figure 9-10 RSTP Backup Port Example With a backup port, if the current designated port fails, SW4 can start using the backup port with rapid convergence.|Рисунок 9-10 Пример резервного порта RSTP. Если текущий назначенный порт выходит из строя, при использовании резервного порта SW4 может начать использовать резервный порт с быстрой сходимостью.
For instance, if SW4’s F0/1 interface were to fail, SW4 could transition F0/2 to the designated port role, without any delay in moving from discarding state to a forwarding state.|Например, если интерфейс F0 / 1 SW4 откажет, SW4 может перевести F0 / 2 в назначенную роль порта без какой-либо задержки при переходе из состояния сброса в состояние пересылки.
#### RSTP Port Types
Типы портов RSTP   
__|__
--|--
|
The final RSTP concept included here relates to some terms RSTP uses to refer to different types of ports and the links that connect to those ports.|Заключительная концепция RSTP, включенная здесь, относится к некоторым терминам, которые RSTP использует для обозначения различных типов портов и ссылок, которые подключаются к этим портам.
|
To begin, consider the basic image in Figure 9-11.|Для начала рассмотрим базовое изображение на рис. 9-11.
It shows several links between two switches.|Он показывает несколько связей между двумя переключателями.
|
RSTP considers these links to be point-to-point links and the ports connected to them to be point-to-point ports because the link connects exactly two devices (points).|RSTP считает эти ссылки двухточечными, а подключенные к ним порты - двухточечными, поскольку канал соединяет ровно два устройства (точки).
|
RSTP further classifies point-to-point ports into two categories.|RSTP дополнительно классифицирует двухточечные порты на две категории.
Point-to-point ports that connect two switches are not at the edge of the network and are simply called point-topoint ports.|Порты точка-точка, которые соединяют два коммутатора, не находятся на границе сети и называются портами точка-точка.
Ports that instead connect to a single endpoint device at the edge of the network, like a PC or server, are called point-to-point edge ports, or simply edge ports.|Порты, которые вместо этого подключаются к одному оконечному устройству на границе сети, например ПК или серверу, называются граничными портами точка-точка или просто граничными портами.
In Figure 9-11, SW3’s switch port connected to a PC is an edge port.|На рисунке 9-11 порт коммутатора SW3, подключенный к ПК, является пограничным портом.
|
Figure 9-11 RSTP Link Types Finally, RSTP defines the term shared to describe ports connected to a hub.|Рис. 9-11. Типы каналов RSTP Наконец, RSTP определяет термин «общий» для описания портов, подключенных к концентратору.
The term shared comes from the fact that hubs create a shared Ethernet; hubs also force the attached switch port to use half-duplex logic.|Термин «разделяемый» происходит от того факта, что концентраторы создают общий Ethernet; концентраторы также заставляют подключенный порт коммутатора использовать полудуплексную логику.
RSTP assumes that all half-duplex ports may be connected to hubs, treating ports that use half duplex as shared ports.|RSTP предполагает, что все полудуплексные порты могут быть подключены к концентраторам, рассматривая порты, которые используют полудуплекс, как общие порты.
RSTP converges more slowly on shared ports as compared to all point-to-point ports.|RSTP сходится на общих портах медленнее, чем на всех двухточечных портах.
#### Optional STP Features
Дополнительные функции STP   
__|__
--|--
|
To close out the chapter, the last few topics introduce a few optional features that make STP work even better or be more secure: EtherChannel, PortFast, and BPDU Guard.|Завершая главу, в последних нескольких темах рассказывается о нескольких дополнительных функциях, которые делают работу STP еще лучше или более безопасной: EtherChannel, PortFast и BPDU Guard.
##### EtherChannel
EtherChannel   
__|__
--|--
|
One of the best ways to lower STP’s convergence time is to avoid convergence altogether.|Один из лучших способов сократить время сходимости STP - полностью избежать сходимости.
|
EtherChannel provides a way to prevent STP convergence from being needed when only a single port or cable failure occurs.|EtherChannel предоставляет способ предотвратить необходимость конвергенции STP, когда происходит сбой только одного порта или кабеля.
|
EtherChannel combines multiple parallel segments of equal speed (up to eight) between the same pair of switches, bundled into an EtherChannel.|EtherChannel объединяет несколько параллельных сегментов с одинаковой скоростью (до восьми) между одной и той же парой коммутаторов, объединенных в EtherChannel.
The switches treat the EtherChannel as a single interface with regard to STP. As a result, if one of the links fails, but at least one of the links is up, STP convergence does not have to occur.|Коммутаторы рассматривают EtherChannel как единый интерфейс по отношению к STP. В результате, если одна из ссылок выходит из строя, но хотя бы одна из них работает, сходимость STP не должна происходить.
For example, Figure 9-12 shows the familiar three-switch network, but now with two Gigabit Ethernet connections between each pair of switches.|Например, на рис. 9-12 показана знакомая сеть с тремя коммутаторами, но теперь с двумя подключениями Gigabit Ethernet между каждой парой коммутаторов.
|
With each pair of Ethernet links configured as an EtherChannel, STP treats each EtherChannel as a single link.|Когда каждая пара каналов Ethernet настроена как канал EtherChannel, STP рассматривает каждый канал EtherChannel как один канал.
In other words, both links to the same switch must fail for a switch to need to cause STP convergence.|Другими словами, обе ссылки на один и тот же коммутатор должны выйти из строя, чтобы коммутатор мог вызвать конвергенцию STP.
Without EtherChannel, if you have multiple parallel links between two switches, STP blocks all the links except one.|Без EtherChannel, если у вас есть несколько параллельных каналов между двумя коммутаторами, STP блокирует все каналы, кроме одного.
With EtherChannel, all the parallel links can be up and working at the same time, while reducing the number of times STP must converge, which in turn makes the network more available.|С EtherChannel все параллельные каналы могут быть включены и работать одновременно, уменьшая при этом количество раз, когда STP должен сходиться, что, в свою очередь, делает сеть более доступной.
|
Figure 9-12 Two-Segment EtherChannels Between Switches The current CCNA exam blueprint includes a topic for the configuration of both Layer 2 EtherChannels (as described here) as well as Layer 3 EtherChannels.|Рисунок 9-12. Двухсегментные каналы EtherChannels между коммутаторами Текущий план экзамена CCNA включает тему для конфигурации как EtherChannels уровня 2 (как описано здесь), так и EtherChannels уровня 3.
Chapter 10, “RSTP and EtherChannel Configuration,” shows how to configure Layer 2 EtherChannels, while Chapter 17, “IP Routing in the LAN,” shows how to configure Layer 3 EtherChannels.|В главе 10 «Конфигурация RSTP и EtherChannel» показано, как настроить каналы EtherChannels уровня 2, а в главе 17 «IP-маршрутизация в локальной сети» показано, как настроить каналы EtherChannel уровня 3.
Note that Layer 2 EtherChannels combine links that switches use as switch ports, with the switches using Layer 2 switching logic to forward and receive Ethernet frames over the EtherChannels.|Обратите внимание, что каналы EtherChannels уровня 2 объединяют ссылки, которые коммутаторы используют в качестве портов коммутатора, с коммутаторами, использующими логику коммутации уровня 2 для пересылки и приема кадров Ethernet по каналам EtherChannels.
|
Layer 3 EtherChannels also combine links, but the switches use Layer 3 routing logic to forward packets over the EtherChannels.|Каналы EtherChannels уровня 3 также объединяют ссылки, но коммутаторы используют логику маршрутизации уровня 3 для пересылки пакетов по каналам EtherChannels.
##### PortFast
PortFast   
__|__
--|--
|
PortFast allows a switch to immediately transition from blocking to forwarding, bypassing listening and learning states.|PortFast позволяет коммутатору немедленно перейти от блокировки к пересылке, минуя состояния прослушивания и обучения.
However, the only ports on which you can safely enable PortFast are ports on which you know that no bridges, switches, or other STP-speaking devices are connected.|Однако единственные порты, на которых вы можете безопасно включить PortFast, - это порты, к которым вы знаете, что никакие мосты, коммутаторы или другие устройства, говорящие на STP, не подключены.
Otherwise, using PortFast risks creating loops, the very thing that the listening and learning states are intended to avoid.|В противном случае использование PortFast может привести к возникновению петель, как раз того, чего предназначены состояния прослушивания и обучения.
|
PortFast is most appropriate for connections to end-user devices.|PortFast наиболее подходит для подключения к устройствам конечных пользователей.
If you turn on PortFast on ports connected to end-user devices, when an end-user PC boots, the switch port can move to an STP forwarding state and forward traffic as soon as the PC NIC is active.|Если вы включите PortFast на портах, подключенных к устройствам конечных пользователей, при загрузке ПК конечного пользователя порт коммутатора может перейти в состояние пересылки STP и пересылать трафик, как только сетевая карта ПК станет активной.
Without PortFast, each port must wait while the switch confirms that the port is a DP. With STP in particular (and not RSTP), the switch waits in the temporary listening and learning states before settling into the forwarding state.|Без PortFast каждый порт должен ждать, пока коммутатор подтвердит, что порт является DP. В частности, при использовании протокола STP (а не RSTP) коммутатор ожидает во временных состояниях прослушивания и обучения, прежде чем перейти в состояние пересылки.
|
As you might guess from the fact that PortFast speeds convergence, RSTP includes PortFast.|Как вы могли догадаться по тому факту, что PortFast ускоряет сходимость, RSTP включает PortFast.
|
You might recall the mention of RSTP port types, particularly point-to-point edge port types, around Figure 9-11.|Вы, возможно, помните упоминание о типах портов RSTP, особенно о типах граничных портов точка-точка, на рис. 9-11.
RSTP, by design of the protocol, converges quickly on these point-to-point edge type ports by bypassing the learning state, which is the same idea Cisco originally introduced with PortFast.|RSTP, по замыслу протокола, быстро сходится на этих двухточечных граничных портах, обходя состояние обучения, что является той же идеей, которую Cisco изначально представила с PortFast.
In practice, Cisco switches enable RSTP point-to-point edge ports by enabling PortFast on the port.|На практике коммутаторы Cisco включают граничные порты «точка-точка» RSTP путем включения PortFast на порту.
##### BPDU Guard
BPDU Guard   
__|__
--|--
|
STP and RSTP open up the LAN to several different types of possible security exposures.|STP и RSTP открывают LAN для нескольких различных типов возможных угроз безопасности.
|
For example:|Например:
###### An attacker could connect a switch to one of these ports, one with a low STP/RSTP priority
Злоумышленник может подключить коммутатор к одному из этих портов, один с низким приоритетом STP / RSTP.   
__|__
--|--
|
value, and become the root switch.|значение и стать корневым переключателем.
The new STP/RSTP topology could have worse performance than the desired topology.|Новая топология STP / RSTP может иметь худшую производительность, чем желаемая топология.
###### The attacker could plug into multiple ports, into multiple switches, become root, and
Злоумышленник может подключиться к нескольким портам, к нескольким коммутаторам, стать пользователем root и   
__|__
--|--
|
actually forward much of the traffic in the LAN. Without the networking staff realizing it, the attacker could use a LAN analyzer to copy large numbers of data frames sent through the LAN.|фактически пересылает большую часть трафика в LAN. Не осознавая этого сетевой персонал, злоумышленник может использовать анализатор локальной сети для копирования большого количества фреймов данных, отправляемых через локальную сеть.
###### Users could innocently harm the LAN when they buy and connect an inexpensive
Пользователи могут невиновно навредить ЛВС, купив и подключив недорогой   
__|__
--|--
|
consumer LAN switch (one that does not use STP/RSTP). Such a switch, without any STP/RSTP function, would not choose to block any ports and could cause a loop.|потребительский коммутатор LAN (тот, который не использует STP / RSTP). Такой коммутатор без какой-либо функции STP / RSTP не будет блокировать какие-либо порты и может вызвать петлю.
|
The Cisco BPDU Guard feature helps defeat these kinds of problems by disabling a port if any BPDUs are received on the port.|Функция Cisco BPDU Guard помогает справиться с подобными проблемами, отключая порт, если через порт получены какие-либо BPDU.
So, this feature is particularly useful on ports that should be used only as an access port and never connected to another switch.|Таким образом, эта функция особенно полезна для портов, которые следует использовать только как порт доступа и никогда не подключаться к другому коммутатору.
|
In addition, the BPDU Guard feature helps prevent problems with PortFast.|Кроме того, функция BPDU Guard помогает предотвратить проблемы с PortFast.
PortFast should be enabled only on access ports that connect to user devices, not to other LAN switches.|PortFast следует включать только на портах доступа, которые подключаются к пользовательским устройствам, но не к другим коммутаторам LAN.
|
Using BPDU Guard on these same ports makes sense because if another switch connects to such a port, the local switch can disable the port before a loop is created.|Использование BPDU Guard на тех же портах имеет смысл, потому что, если другой коммутатор подключается к такому порту, локальный коммутатор может отключить порт до создания петли.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element for more details.|Обратитесь к элементу «Ваш учебный план» для получения более подробной информации.
Table 9-11 outlines the key review elements and where you can find them.|В Таблице 9-11 представлены основные элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 9-11 Chapter Review Tracking Table end.|Таблица 9-11 Окончание таблицы отслеживания обзора главы.
|
Review All the Key Topics Key Topic Element Description Page Number Key Terms You Should Know blocking state, BPDU Guard, bridge ID, bridge protocol data unit (BPDU), designated port, EtherChannel, forward delay, forwarding state, Hello BPDU, learning state, listening state, MaxAge, PortFast, root port, root switch, root cost, Spanning Tree Protocol (STP), rapid STP (RSTP), alternate port, backup port, disabled port, discarding state|Просмотрите все ключевые темы Ключевая тема Элемент Описание Номер страницы Ключевые термины, которые вы должны знать состояние блокировки, BPDU Guard, идентификатор моста, блок данных протокола моста (BPDU), назначенный порт, EtherChannel, задержка пересылки, состояние пересылки, Hello BPDU, состояние обучения, состояние прослушивания, MaxAge, PortFast, корневой порт, корневой коммутатор, стоимость корня, протокол связующего дерева (STP), быстрый STP (RSTP), альтернативный порт, резервный порт, отключенный порт, состояние отбрасывания
## Chapter 10 RSTP and EtherChannel Configuration
Глава 10 Настройка RSTP и EtherChannel   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 2.0 Network Access
2.0 Доступ к сети   
###### 2.4 Configure and verify (Layer 2/Layer 3) EtherChannel (LACP)
2.4 Настройка и проверка (уровень 2 / уровень 3) EtherChannel (LACP)   
###### 2.5 Describe the need for and basic operations of Rapid PVST+ Spanning Tree Protocol
2.5. Опишите необходимость и основные операции Rapid PVST + Spanning Tree Protocol.   
__|__
--|--
|
and identify basic operations|и определить основные операции
###### 2.5.a Root port, root bridge (primary/secondary), and other port names
2.5.a Корневой порт, корневой мост (первичный / вторичный) и другие имена портов.   
###### 2.5.b Port states (forwarding/blocking)
2.5.b Состояния портов (пересылка / блокировка)   
###### 2.5.c PortFast benefits
2.5.c Преимущества PortFast   
__|__
--|--
|
This chapter shows how to configure Rapid Spanning Tree Protocol (RSTP) and Layer 2 EtherChannels.|В этой главе показано, как настроить протокол Rapid Spanning Tree Protocol (RSTP) и EtherChannels уровня 2.
The EtherChannel content, in the second major section of the chapter, follows a typical flow for most configuration/verification topics in a certification guide: it reviews concepts, shows configurations, and provides show commands that point out the configuration settings and operational state.|Содержимое EtherChannel во втором основном разделе главы следует типичной схеме для большинства тем по настройке / проверке в руководстве по сертификации: в нем рассматриваются концепции, отображаются конфигурации и предоставляются команды show, указывающие на параметры конфигурации и рабочее состояние.
The details include how to manually configure a channel, how to cause a switch to dynamically create a channel, and how EtherChannel load distribution works.|Подробности включают в себя, как вручную настроить канал, как заставить коммутатор динамически создавать канал и как работает распределение нагрузки EtherChannel.
|
The first section of the chapter explores RSTP implementation taking a different approach.|В первом разделе главы рассматривается реализация RSTP с использованием другого подхода.
|
Cisco mentions RSTP concepts, but not configuration/verification, in the CCNA exam topics.|Cisco упоминает концепции RSTP, но не упоминает конфигурацию / проверку в темах экзамена CCNA.
|
However, to get a real sense of RSTP concepts, especially some concepts specific to Cisco Catalyst switches, you need to work with RSTP configuration and verification.|Однако, чтобы получить реальное представление о концепциях RSTP, особенно некоторых концепциях, характерных для коммутаторов Cisco Catalyst, вам необходимо работать с настройкой и проверкой RSTP.
The first section of the chapter explores RSTP implementation, but as a means to the end of more fully understanding RSTP concepts.|В первом разделе главы рассматривается реализация RSTP, но как средство для более полного понимания концепций RSTP.
|
For those of you who, like me, probably would want to go ahead and practice configuring RSTP, do some show commands, and understand more fully, you do have some options:|Для тех из вас, кто, как и я, вероятно, захочет продолжить и попрактиковаться в настройке RSTP, выполнить несколько команд show и понять более полно, у вас есть несколько вариантов:
###### Read Appendix O, “Spanning Tree Protocol Implementation,” from this book’s companion
Прочтите Приложение O «Реализация протокола связующего дерева» из сопутствующего материала к этой книге.   
__|__
--|--
|
website.|Веб-сайт.
The appendix is a chapter from the previous edition of this book, with full details of configuration/verification of STP and RSTP.|Приложение представляет собой главу из предыдущего издания этой книги с полными сведениями о настройке / проверке STP и RSTP.
###### Use the STP/RSTP config labs on my blog site (as regularly listed in the Chapter Review
Используйте лабораторные работы по настройке STP / RSTP на моем сайте блога (как регулярно указывается в Обзоре главы   
__|__
--|--
|
section of each chapter).|раздел каждой главы).
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
CHAPTER 10 Table 10-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|ГЛАВА 10 Таблица 10-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### Understanding RSTP Through Configuration
Понимание RSTP через конфигурацию   
__|__
--|--
|
Implementing EtherChannel 4–6 1.|Внедрение EtherChannel 4–6 1.
Which type value on the spanning-tree mode type global command enables the use of RSTP?|Какое значение типа в глобальной команде типа режима связующего дерева включает использование RSTP?
|
a. rapid-pvst b. pvst c. rstp d. rpvst 2.|а. Rapid-PVST b. pvst c. rstp d. рпвст 2.
Examine the following output from the show spanning-tree vlan 5 command, which describes a root switch in a LAN. Which answers accurately describe facts related to the root’s bridge ID?|Изучите следующие выходные данные команды show spanning-tree vlan 5, в которой описывается корневой коммутатор в локальной сети. Какие ответы точно описывают факты, связанные с идентификатором корневого моста?
|
SW1# show spanning-tree vlan 5 VLAN0005 Spanning tree enabled protocol rstp Root ID Priority 32773 Address 1833.9d7b.0e80 Cost 15 Port 25 (GigabitEthernet0/1)|SW1 # show spanning-tree vlan 5 VLAN0005 Протокол с включенным связующим деревом rstp Root ID Priority 32773 Address 1833.9d7b.0e80 Cost 15 Port 25 (GigabitEthernet0 / 1)
|
Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec a.|Время приветствия 2 секунды Максимальный возраст 20 секунд Задержка пересылки 15 секунд a.
The system ID extension value, in decimal, is 5.|Десятичное значение расширенного идентификатора системы - 5.
|
b. The root’s configured priority value is 32773.|б. Настроенное значение приоритета корня - 32773.
|
c. The root’s configured priority value is 32768.|c. Настроенное значение приоритета корневого каталога - 32768.
|
d. The system ID extension value, in hexadecimal, is 1833.9d7b.0e80.|d. Значение расширения системного идентификатора в шестнадцатеричном формате: 1833.9d7b.0e80.
|
3. With the Cisco RPVST+, which of the following action(s) does a switch take to identify which VLAN is described by a BPDU? (Choose three answers.)|3. Что касается Cisco RPVST +, какое из следующих действий выполняет коммутатор, чтобы определить, какая VLAN описывается BPDU? (Выберите три ответа.)
|
a. Adds a VLAN tag when forwarding a BPDU on trunks b.|а. Добавляет тег VLAN при пересылке BPDU по соединительным линиям b.
Adds the VLAN ID in an extra TLV in the BPDU c.|Добавляет идентификатор VLAN в дополнительный TLV в BPDU c.
Lists the VLAN ID as the middle 12 bits of the System ID field of the BPDU d.|Перечисляет идентификатор VLAN как средние 12 бит поля System ID в BPDU. D.
Lists the VLAN ID in the System ID Extension field of the BPDU 4.|Перечисляет идентификатор VLAN в поле System ID Extension блока BPDU 4.
An engineer configures a switch to put interfaces G0/1 and G0/2 into the same Layer 2 EtherChannel.|Инженер настраивает коммутатор для помещения интерфейсов G0 / 1 и G0 / 2 в один канал EtherChannel уровня 2.
Which of the following terms is used in the configuration commands?|Какие из следующих терминов используются в командах настройки?
|
a. EtherChannel b.|а. EtherChannel б.
PortChannel c.|PortChannel c.
Ethernet-Channel d.|Канал Ethernet d.
Channel-group 5.|Группа каналов 5.
Which combinations of keywords on the channel-group interface subcommand on two neighboring switches will cause the switches to use LACP and attempt to add the link to the EtherChannel? (Choose two answers.)|Какие комбинации ключевых слов в подкоманде интерфейса группы каналов на двух соседних коммутаторах заставят коммутаторы использовать LACP и попытаться добавить ссылку на EtherChannel? (Выберите два ответа.)
|
a. desirable and active b. passive and active c. active and auto d. active and active 6.|а. желанный и активный b. пассивный и активный c. активный и автоматический d. активный и активный 6.
A Cisco Catalyst switch needs to send frames over a Layer 2 EtherChannel.|Коммутатор Cisco Catalyst должен отправлять кадры по каналу EtherChannel уровня 2.
Which answer best describes how the switch balances the traffic over the four active links in the channel?|Какой ответ лучше всего описывает, как коммутатор балансирует трафик по четырем активным ссылкам в канале?
|
a. Breaks each frame into fragments of approximately one-fourth of the original frame, sending one fragment over each link b.|а. Разбивает каждый кадр на фрагменты примерно четвертой части исходного кадра, отправляя один фрагмент по каждой ссылке. B.
Sends the entire frame over one link, alternating links in sequence for each successive frame c.|Посылает весь кадр по одной ссылке, чередуя ссылки последовательно для каждого последующего кадра c.
Sends the entire frame over one link, choosing the link by applying some math to fields in each frame’s headers d.|Посылает весь фрейм по одной ссылке, выбирая ссылку, применяя математические вычисления к полям в заголовках каждого фрейма. D.
Sends the entire frame over one link, using the link with the lowest percent utilization as the next link to use Foundation Topics Understanding RSTP Through Configuration Cisco IOS switches today typically default to using RSTP rather than STP, with default settings so that RSTP works with no configuration.|Отправляет весь кадр по одной ссылке, используя ссылку с наименьшим процентом использования в качестве следующей ссылки для использования основных тем Понимание RSTP через конфигурацию Сегодня коммутаторы Cisco IOS обычно по умолчанию используют RSTP, а не STP, с настройками по умолчанию, так что RSTP работает без конфигурация.
You can buy some Cisco switches and connect them with Ethernet cables in a redundant topology, and RSTP will ensure that frames do not loop.|Вы можете купить несколько коммутаторов Cisco и подключить их с помощью кабелей Ethernet в топологии с резервированием, и RSTP гарантирует, что кадры не зацикливаются.
And even if some switches use RSTP and some use STP, the switches can interoperate and still build a working spanning tree—and you never even have to think about changing any settings!|И даже если некоторые коммутаторы используют RSTP, а некоторые - STP, коммутаторы могут взаимодействовать друг с другом и по-прежнему строить рабочее связующее дерево - и вам даже не придется думать об изменении каких-либо настроек!
|
Although RSTP works without any configuration, most medium-size to large-size campus LANs benefit from some STP configuration.|Хотя RSTP работает без какой-либо конфигурации, большинство кампусных локальных сетей среднего и большого размера выигрывают от некоторой конфигурации STP.
For instance, Figure 10-1 shows a typical LAN design model, with two distribution layer switches (D1 and D2).|Например, на рис. 10-1 показана типовая модель проекта LAN с двумя коммутаторами уровня распределения (D1 и D2).
The design may have dozens of access layer switches that connect to end users; the figure shows just three access switches (A1, A2, and A3).|В проекте могут быть десятки переключателей уровня доступа, которые подключаются к конечным пользователям; на рисунке показаны всего три переключателя доступа (A1, A2 и A3).
For a variety of reasons, most network engineers make the distribution layer switches be the root.|По ряду причин большинство сетевых инженеров делают коммутаторы уровня распределения корневыми.
|
Figure 10-1 Typical Configuration Choice: Making Distribution Switch Be Root NOTE Cisco uses the term access switch to refer to switches used to connect to endpoint devices.|Рисунок 10-1 Типичный выбор конфигурации: создание коммутатора распределения как корневого ПРИМЕЧАНИЕ Cisco использует термин коммутатор доступа для обозначения коммутаторов, используемых для подключения к оконечным устройствам.
The term distribution switch refers to switches that do not connect to endpoints but rather connect to each access switch, providing a means to distribute frames throughout the LAN. If you want to read more about LAN design concepts and terms, refer to this book’s companion website for Appendix K, “Analyzing Ethernet LAN Designs.”|Термин «коммутатор распределения» относится к коммутаторам, которые не подключаются к конечным точкам, а подключаются к каждому коммутатору доступа, обеспечивая средства для распределения кадров по локальной сети. Если вы хотите узнать больше о концепциях и терминах проектирования ЛВС, обратитесь к сопутствующему веб-сайту этой книги, где вы найдете Приложение K, «Анализ проектов ЛВС Ethernet».
|
As discussed in the introduction to this chapter, this first section of the chapter examines a variety of STP/RSTP configuration topics, but with a goal of revealing a few more details about how STP and RSTP operate.|Как обсуждалось во введении к этой главе, в этом первом разделе главы рассматриваются различные темы конфигурации STP / RSTP, но с целью раскрыть еще несколько деталей о том, как работают STP и RSTP.
Following this opening section about RSTP configuration, the next section examines how to configure Layer 2 EtherChannels, and how that impacts STP/RSTP.|После этого вводного раздела о конфигурации RSTP в следующем разделе рассматривается, как настроить каналы EtherChannels уровня 2 и как это влияет на STP / RSTP.
#### The Need for Multiple Spanning Trees
Потребность в нескольких связующих деревьях   
__|__
--|--
|
The IEEE first standardized STP as the IEEE 802.1D standard, first published back in 1990.|IEEE впервые стандартизировал STP как стандарт IEEE 802.1D, впервые опубликованный еще в 1990 году.
|
To put some perspective on that date, Cisco did not have a LAN switch product line at the time, and virtual LANs did not exist yet.|Чтобы заглянуть в ту дату, у Cisco в то время не было линейки коммутаторов LAN, а виртуальные LAN еще не существовали.
Instead of multiple VLANs in a physical Ethernet LAN, the physical Ethernet LAN existed as one single broadcast domain, with one instance of STP.|Вместо нескольких VLAN в физической локальной сети Ethernet физическая локальная сеть Ethernet существовала как один широковещательный домен с одним экземпляром STP.
|
By the mid 1990s, VLANs had appeared on the scene, along with LAN switches.|К середине 1990-х годов на сцене появились сети VLAN и коммутаторы LAN.
The emergence of VLANs posed a challenge for STP—the only type of STP available at the time—|Появление сетей VLAN стало проблемой для STP - единственного доступного в то время типа STP -
|
because STP defined a single common spanning tree (CST) topology for the entire LAN. The IEEE needed an option to create multiple spanning trees so that traffic could be balanced across the available links, as shown in Figure 10-2.|потому что STP определил единую топологию общего связующего дерева (CST) для всей локальной сети. IEEE требовалась возможность создания нескольких связующих деревьев, чтобы трафик мог быть сбалансирован по доступным каналам, как показано на рисунке 10-2.
With two different STP instances, SW3 could block on a different interface in each VLAN, as shown in the figure.|С двумя разными экземплярами STP SW3 может блокироваться на разных интерфейсах в каждой VLAN, как показано на рисунке.
|
Figure 10-2 Load Balancing with One Tree for VLAN 1 and Another for VLAN 2|Рисунок 10-2 Балансировка нагрузки с одним деревом для VLAN 1 и другим для VLAN 2
#### STP Modes and Standards
Режимы и стандарты STP   
__|__
--|--
|
Because of the sequence of events over the history of the various STP family of protocols, vendors like Cisco needed to create their own proprietary features to create the per-VLAN spanning tree concept shown in Figure 10-2.|Из-за последовательности событий в истории различных семейств протоколов STP, таким поставщикам, как Cisco, потребовалось создать свои собственные проприетарные функции для создания концепции связующего дерева для каждой VLAN, показанной на рисунке 10-2.
That sequence resulted in the following:|Эта последовательность привела к следующему:
###### When STP was the only STP standard back in the 1990s with 802.1D, Cisco created the
Когда в 1990-х годах STP был единственным стандартом STP с 802.1D, Cisco создала   
__|__
--|--
|
STP-based Per VLAN Spanning Tree Plus (PVST+) protocol, which creates one spanning tree instance per VLAN.|Протокол STP Per VLAN Spanning Tree Plus (PVST +), который создает один экземпляр связующего дерева для каждой VLAN.
###### When the IEEE introduced RSTP (in 802.1D amendment 802.1w, in the year 2001), Cisco
Когда IEEE представил RSTP (в поправке 802.1D 802.1w в 2001 году), Cisco   
__|__
--|--
|
also created the Rapid PVST+ (RPVST+) protocol.|также создал протокол Rapid PVST + (RPVST +).
RPVST+ provided more features than standardized RSTP, including one tree per VLAN.|RPVST + предоставляет больше функций, чем стандартизированный RSTP, включая одно дерево на каждую VLAN.
###### The IEEE did not adopt Cisco’s PVST+ or RPVST+ into their standards to create multiple
IEEE не включил Cisco PVST + или RPVST + в свои стандарты для создания нескольких   
__|__
--|--
|
spanning trees.|остовные деревья.
Instead, the IEEE created a different method: Multiple Spanning Tree Protocol (MSTP), originally defined in 802.1Q amendment 802.1s.|Вместо этого IEEE создал другой метод: протокол множественного связующего дерева (MSTP), первоначально определенный в поправке 802.1Q 802.1s.
|
Figure 10-3 shows the features as a timeline for perspective.|Рисунок 10-3 показывает особенности в виде временной шкалы для перспективы.
|
Figure 10-3 Timeline of Per-VLAN and Multiple STP Features Today, Cisco Catalyst switches give us three options to configure on the spanning-tree mode command, which tells the switch which type of STP to use.|Рис. 10-3. Временная шкала для каждой VLAN и нескольких функций STP Сегодня коммутаторы Cisco Catalyst предоставляют нам три варианта настройки в команде режима связующего дерева, которая сообщает коммутатору, какой тип STP использовать.
Note that the switches do not support STP or RSTP with the single tree (CST). They can use either the Ciscoproprietary and STP-based PVST+, Cisco-proprietary and RSTP-based RPVST+, or the IEEE standard MSTP. Table 10-2 summarizes some of the facts about these standards and options, Answers to the “Do I Know This Already?” quiz:|Обратите внимание, что коммутаторы не поддерживают STP или RSTP с одним деревом (CST). Они могут использовать собственный протокол Cisco PVST + на основе STP, собственный протокол Cisco и протокол RPVST + на основе RSTP или стандарт MSTP IEEE. В Таблице 10-2 приведены некоторые факты об этих стандартах и ​​вариантах, ответы на вопрос «Знаю ли я это уже?» викторина:
|
1 A 2 A, C 3 A, B, D 4 D 5 B, D 6 C along with the keywords used on the spanning-tree mode global configuration command.|1 A 2 A, C 3 A, B, D 4 D 5 B, D 6 C вместе с ключевыми словами, используемыми в команде глобальной конфигурации режима связующего дерева.
|
Example 10-1, which follows, shows the command options in global configuration mode.|В следующем примере 10-1 показаны параметры команды в режиме глобальной конфигурации.
|
Table 10-2 STP Standards and Configuration Options Table end.|Таблица 10-2 Стандарты STP и варианты конфигурации Конец таблицы.
|
1 MSTP allows the definition of as many instances (multiple spanning tree instances, or MSTIs) as chosen by the network designer but does not require one per VLAN.|1 MSTP позволяет определять столько экземпляров (несколько экземпляров связующего дерева или MSTI), сколько выбрано разработчиком сети, но не требует по одному на каждую VLAN.
|
Example 10-1 STP Status with Default STP Parameters on SW1 and SW2 Example end.|Пример 10-1 Состояние STP с параметрами STP по умолчанию на переключателях SW1 и SW2 Конец примера.
#### The Bridge ID and System ID Extension
Идентификатор моста и расширение идентификатора системы   
__|__
--|--
|
To support the idea of multiple spanning trees, whether one per VLAN or simply multiple as created with MSTP, the protocols must consider the VLANs and VLAN trunking. (That’s one reason why RSTP and MSTP now exist as part of the 802.1Q standard, which defines VLANs and VLAN trunking.) To help make that work, the IEEE redefined the format of the original BID value to help make per-VLAN instances of STP/RSTP become a reality.|Для поддержки идеи нескольких покрывающих деревьев, будь то одно на каждую VLAN или просто несколько, созданных с помощью MSTP, протоколы должны учитывать VLAN и транкинг VLAN. (Это одна из причин, почему RSTP и MSTP теперь существуют как часть стандарта 802.1Q, который определяет сети VLAN и транкинг VLAN.) Чтобы помочь этой работе, IEEE переопределил формат исходного значения BID, чтобы помочь создать экземпляры для каждой VLAN STP / RSTP становятся реальностью.
|
Originally, a switch’s BID was formed by combining the switch’s 2-byte priority and its 6-byte MAC address.|Первоначально BID коммутатора был сформирован путем объединения 2-байтового приоритета коммутатора и его 6-байтового MAC-адреса.
The revised rules divide the original priority field into two separate fields, as shown in Figure 10-4: a 4-bit priority field and a 12-bit subfield called the system ID extension (which represents the VLAN ID).|В пересмотренных правилах исходное поле приоритета делится на два отдельных поля, как показано на рисунке 10-4: 4-битное поле приоритета и 12-битное подполе, называемое расширением идентификатора системы (которое представляет идентификатор VLAN).
|
Figure 10-4 STP System ID Extension Cisco switches let you configure the BID, but only the priority part.|Рисунок 10-4 Расширение идентификатора системы STP Коммутаторы Cisco позволяют настраивать BID, но только его приоритетную часть.
The switch fills in its universal (burned-in) MAC address as the system ID. It also plugs in the VLAN ID of a VLAN in the 12-bit system ID extension field; you cannot change that behavior either.|Коммутатор подставляет свой универсальный (записанный) MAC-адрес в качестве идентификатора системы. Он также вставляет идентификатор VLAN для VLAN в 12-битное поле расширения идентификатора системы; вы также не можете изменить это поведение.
The only part configurable by the network engineer is the 4-bit priority field.|Единственная часть, которую может настроить сетевой инженер, - это 4-битное поле приоритета.
|
However, configuring the number to put in the priority field may be one of the strangest things to configure on a Cisco router or switch.|Однако настройка числа для ввода в поле приоритета может быть одной из самых странных вещей для настройки на маршрутизаторе или коммутаторе Cisco.
As shown at the top of Figure 10-4, the priority field was originally a 16-bit number, which represented a decimal number from 0 to 65,535.|Как показано в верхней части рисунка 10-4, поле приоритета изначально было 16-битным числом, которое представляло десятичное число от 0 до 65 535.
Because of that history, the configuration command (spanning-tree vlan vlan-id priority x) requires a decimal number between 0 and 65,535.|Из-за этой истории команда настройки (связующее дерево vlan vlan-id приоритет x) требует десятичного числа от 0 до 65 535.
But not just any number in that range will suffice; it must be a multiple of 4096, as emphasized in the help text shown in Example 10-2.|Но не просто любое число в этом диапазоне будет достаточно; он должен быть кратным 4096, как подчеркивается в тексте справки, показанном в примере 10-2.
|
Example 10-2 Help Shows Requirements for Using Increments of 4096 for Priority Example end.|Пример 10-2 Справка показывает требования для использования приращения 4096 для конца примера приоритета.
|
Table 10-3 lists all the configurable values for the STP/RSTP priority.|В Табл. 10-3 перечислены все настраиваемые значения приоритета STP / RSTP.
However, do not worry about memorizing the values.|Однако не беспокойтесь о запоминании значений.
Instead, the table lists the values to emphasize two points about the binary values: the first 4 bits in each value differ, but the last 12 bits remain as 12 binary zeros.|Вместо этого в таблице перечислены значения, чтобы подчеркнуть два момента о двоичных значениях: первые 4 бита в каждом значении различаются, но последние 12 бит остаются как 12 двоичных нулей.
|
Table 10-3 STP/RSTP Configurable Priority Values Table end.|Таблица 10-3. Конфигурируемые значения приоритета STP / RSTP. Конец таблицы.
|
Note that while you can set the priority to any of the 16 decimal values in Table 10-3, Cisco provides a convenient means to create a primary and secondary root switch concept without configuring an actual number.|Обратите внимание, что, хотя вы можете установить приоритет на любое из 16 десятичных значений в Таблице 10-3, Cisco предоставляет удобные средства для создания концепции первичного и вторичного корневого коммутатора без настройки фактического числа.
In most LAN designs, only a small number of switches would be good candidates to ever be the root switch based on where the switches sit within the topology.|В большинстве проектов ЛВС только небольшое количество коммутаторов будет подходящими кандидатами на роль корневого коммутатора в зависимости от того, где коммутаторы находятся в топологии.
Think of the preferred switch as the primary switch and the next-best option as the secondary switch.|Считайте предпочтительный коммутатор первичным коммутатором, а следующий лучший вариант - вторичным коммутатором.
Then, to configure those two switches to be the two most likely switches to be the root switch, simply configure spanning-tree vlan x root primary (on the switch that should be primary)|Затем, чтобы настроить эти два коммутатора как два наиболее вероятных коммутатора в качестве корневого коммутатора, просто настройте связующее дерево vlan x root primary (на коммутаторе, который должен быть основным)
|
spanning-tree vlan x root secondary (on the switch that should be secondary)|Spanning-tree vlan x root вторичный (на коммутаторе, который должен быть вторичным)
|
These two commands cause the switch to make a choice of priority value but then store the chosen priority value in the spanning-tree vlan x priority value command.|Эти две команды заставляют коммутатор выбрать значение приоритета, но затем сохранить выбранное значение приоритета в команде spanning-tree vlan x priority value.
The command with root primary or root secondary does not appear in the configuration.|Команда с корневым первичным или корневым вторичным не отображается в конфигурации.
When configuring root primary, the switch looks at the priority of the current root switch and chooses either (a) 24,576 or (b) 4096 less than the current root’s priority (if the current root’s priority is 24,576 or less) to the configuration instead.|При настройке основного корневого коммутатора коммутатор смотрит на приоритет текущего корневого коммутатора и вместо этого выбирает для конфигурации (a) 24 576 или (b) на 4096 меньше, чем приоритет текущего корневого (если приоритет текущего корня равен 24 576 или меньше).
When configuring, root secondary always results in that switch using a priority of 28,672, with the assumption that the value will be less than other switches that use the default of 32,768, and higher than any switch configured as root primary.|При настройке корневой вторичный всегда приводит к тому, что этот коммутатор использует приоритет 28 672, с предположением, что это значение будет меньше, чем у других коммутаторов, которые используют значение по умолчанию 32 768, и выше, чем у любого коммутатора, настроенного как корневой первичный.
#### How Switches Use the Priority and System ID Extension
Как коммутаторы используют расширение Priority и System ID   
__|__
--|--
|
Cisco Catalyst switches configure the priority value using a number that represents a 16-bit value; however, the system ID extension exists as the low-order 12 bits of that same number.|Коммутаторы Cisco Catalyst настраивают значение приоритета с помощью числа, представляющего 16-битное значение; однако расширение системного идентификатора существует как младшие 12 бит того же номера.
|
This next topic works through connecting those ideas.|В следующей теме мы объединяем эти идеи.
|
When the switch builds its BID to use for RSTP in a VLAN, it must combine the configured priority with the VLAN ID of that VLAN. Interestingly, the configured priority results in a 16-bit priority that always ends with 12 binary 0s.|Когда коммутатор создает свой BID для использования для RSTP в VLAN, он должен объединить настроенный приоритет с идентификатором VLAN этой VLAN. Интересно, что сконфигурированный приоритет приводит к 16-битному приоритету, который всегда заканчивается 12 двоичными нулями.
That fact makes the process of combining values to create the BID a little simpler for the switch and possibly a little simpler for network engineers once you understand it all.|Этот факт делает процесс объединения значений для создания BID немного проще для коммутатора и, возможно, немного проще для сетевых инженеров, если вы все это понимаете.
|
First, consider the process shown in Figure 10-5.|Сначала рассмотрим процесс, показанный на рис. 10-5.
The top shows the configured priority value (decimal 32768), in 16-bit binary form, with a System ID Extension of 12 zeros.|Вверху показано настроенное значение приоритета (десятичное 32768) в 16-битной двоичной форме с расширением идентификатора системы из 12 нулей.
|
Moving down the figure, you see the binary version of a VLAN ID (decimal 9).|Двигаясь вниз по рисунку, вы видите двоичную версию идентификатора VLAN (десятичное число 9).
At the last step, the switch replaces those last 12 bits of the System ID Extension with the value that matches the VLAN ID and uses that value as the first 16 bits of the BID.|На последнем шаге коммутатор заменяет эти последние 12 бит расширения идентификатора системы значением, которое соответствует идентификатору VLAN, и использует это значение в качестве первых 16 бит идентификатора BID.
|
Figure 10-5 Configured Priority (16-Bit) and System ID Extension (12-Bit) Added As it turns out, the process shown in Figure 10-5 is just the sum of the two numbers—both in binary and decimal.|Рис. 10-5. Добавлен настроенный приоритет (16-разрядный) и расширение идентификатора системы (12-разрядное). Как оказалось, процесс, показанный на рис. 10-5, представляет собой просто сумму двух чисел - как в двоичном, так и в десятичном виде.
To see an example, refer to upcoming Example 10-3, which demonstrates the following details:|Чтобы увидеть пример, обратитесь к следующему примеру 10-3, который демонстрирует следующие детали:
###### The output shows details about VLAN 9.
Вывод показывает подробную информацию о VLAN 9.   
###### The root switch has been configured with the spanning-tree vlan 9 priority 24576
Корневой коммутатор был настроен с приоритетом связующего дерева vlan 9 24576   
__|__
--|--
|
command.|команда.
###### The local switch (the switch on which the command was gathered) has been configured
Локальный коммутатор (коммутатор, на котором была собрана команда) настроен   
__|__
--|--
|
with the spanning-tree vlan 9 priority 32768 command.|с помощью команды spanning-tree vlan 9 priority 32768.
###### Conveniently, the decimal equivalent of the two switches’ first 16 bits—the original
Для удобства десятичный эквивалент первых 16 бит двух переключателей - исходный   
__|__
--|--
|
16-bit priority field—can be easily calculated in decimal.|16-битное поле приоритета - легко вычисляется в десятичном виде.
In this example:|В этом примере:
###### Root Switch: 24,576 (priority) + 9 (VLAN ID) = 24585
Корневой коммутатор: 24 576 (приоритет) + 9 (идентификатор VLAN) = 24585   
###### Local Switch: 32,768 (priority) + 9 (VLAN ID) = 32777
Локальный коммутатор: 32768 (приоритет) + 9 (VLAN ID) = 32777   
__|__
--|--
|
The output in Example 10-3 matches this logic.|Вывод в Примере 10-3 соответствует этой логике.
The top highlight shows the priority of the root switch (24585), which is the sum of the root switch’s priority setting (configured as 24,576) plus 9 for the VLAN ID. The second highlight shows a value of 32,777, calculated as the local switch’s priority setting of 32,768 plus 9 for the VLAN ID.|Верхнее выделение показывает приоритет корневого коммутатора (24585), который представляет собой сумму настройки приоритета корневого коммутатора (настроенной как 24 576) плюс 9 для идентификатора VLAN. Второе выделение показывает значение 32 777, рассчитанное как значение приоритета локального коммутатора 32 768 плюс 9 для идентификатора VLAN.
|
Example 10-3 Examining the 16-bit Priority as Interpreted in Cisco show Commands Example end.|Пример 10-3. Проверка 16-битного приоритета, интерпретированного в командах Cisco show. Пример конец.
#### RSTP Methods to Support Multiple Spanning Trees
Методы RSTP для поддержки нескольких связующих деревьев   
__|__
--|--
|
Although the history and configuration might make the BID priority idea seem a bit convoluted, having an extra 12-bit field in the BID works well in practice because it can be used to identify the VLAN ID. VLAN IDs range from 1 to 4094, requiring 12 bits.|Хотя история и конфигурация могут сделать идею приоритета BID немного запутанной, наличие дополнительного 12-битного поля в BID на практике хорошо работает, поскольку его можно использовать для идентификации идентификатора VLAN. Идентификаторы VLAN варьируются от 1 до 4094, требуя 12 бит.
|
For the purposes of discussion, focus on the standard RSTP and its Cisco-proprietary cousin RPVST+. Both use the RSTP mechanisms as discussed in Chapter 9, “Spanning Tree Protocol Concepts,” but RPVST+ uses the mechanisms for every VLAN, while standard RSTP does not.|В целях обсуждения сосредоточьтесь на стандартном RSTP и его проприетарном родственнике Cisco RPVST +. Оба используют механизмы RSTP, как описано в главе 9 «Принципы протокола связующего дерева», но RPVST + использует механизмы для каждой VLAN, а стандартный RSTP - нет.
So how do their methods differ?|Так чем же отличаются их методы?
###### RSTP creates one tree—the Common Spanning Tree (CST)—while RPVST+ creates one
RSTP создает одно дерево - Common Spanning Tree (CST), а RPVST + создает одно   
__|__
--|--
|
tree for each and every VLAN.|дерево для каждой VLAN.
###### RSTP sends one set of RSTP messages (BPDUs) in the network, no matter the number of
RSTP отправляет один набор сообщений RSTP (BPDU) в сети, независимо от количества   
__|__
--|--
|
VLANs, while RPVST+ sends one set of messages per VLAN.|VLAN, а RPVST + отправляет один набор сообщений для каждой VLAN.
###### RSTP and RPVST+ use different destination MAC addresses: RSTP with multicast address
RSTP и RPVST + используют разные MAC-адреса назначения: RSTP с многоадресным адресом   
__|__
--|--
|
0180.C200.0000 (an address defined in the IEEE standard), and RPVST+ with multicast address 0100.0CCC.CCCD (an address chosen by Cisco).|0180.C200.0000 (адрес, определенный в стандарте IEEE) и RPVST + с многоадресным адресом 0100.0CCC.CCCD (адрес, выбранный Cisco).
###### When transmitting messages on VLAN trunks, RSTP sends the messages in the native
При передаче сообщений по магистральным каналам VLAN RSTP отправляет сообщения в собственном   
__|__
--|--
|
VLAN with no VLAN header/tag.|VLAN без заголовка / тега VLAN.
RPVST+ sends each VLAN’s messages inside that VLAN—for instance, BPDUs about VLAN 9 have an 802.1Q header that lists VLAN 9.|RPVST + отправляет сообщения каждой VLAN внутри этой VLAN - например, BPDU о VLAN 9 имеют заголовок 802.1Q, в котором перечислены VLAN 9.
###### RPVST+ adds an extra type-length value (TLV) to the BPDU that identifies the VLAN ID,
RPVST + добавляет дополнительное значение длины типа (TLV) к BPDU, которое идентифицирует идентификатор VLAN,   
__|__
--|--
|
while RSTP does not (because it does not need to, as RSTP ignores VLANs.)|в то время как RSTP этого не делает (потому что в этом нет необходимости, поскольку RSTP игнорирует VLAN).
###### Both view the 16-bit priority as having a 12-bit System ID Extension, with RSTP setting
Оба рассматривают 16-битный приоритет как имеющий 12-битное расширение идентификатора системы с настройкой RSTP.   
__|__
--|--
|
the value to 0000.0000.0000, meaning “no VLAN,” while RPVST+ uses the VLAN ID.|значение 0000.0000.0000, что означает «без VLAN», а RPVST + использует идентификатор VLAN.
|
In other words, standard RSTP behaves as if VLANs do not exist, while Cisco’s RPVST+ integrates VLAN information into the entire process.|Другими словами, стандартный RSTP ведет себя так, как будто виртуальных локальных сетей не существует, тогда как Cisco RPVST + интегрирует информацию о виртуальных локальных сетях во весь процесс.
|
NOTE Some documents refer to the feature of sending BPDUs over trunks with VLAN tags matching the same VLAN as BPDU tunneling.|ПРИМЕЧАНИЕ В некоторых документах упоминается функция отправки BPDU по магистралям с тегами VLAN, соответствующими той же VLAN, что и туннелирование BPDU.
#### Other RSTP Configuration Options
Другие параметры конфигурации RSTP   
__|__
--|--
|
This chapter does not attempt to work through all the configuration options available for RSTP. However, many of the configuration settings may be intuitive now that you know quite a bit about the protocol.|В этой главе не рассматриваются все варианты конфигурации, доступные для RSTP. Однако теперь, когда вы немного знаете о протоколе, многие параметры конфигурации могут быть интуитивно понятными.
This final topic in the first section of the chapter summarizes a few of the configuration concepts.|В этом заключительном разделе первого раздела главы кратко излагаются некоторые концепции конфигурации.
As a reminder, for those interested in continuing on to CCNP Enterprise, you might be interested in reading more about RSTP configuration in the companion website’s Appendix O, “Spanning Tree Protocol Implementation.”|Напоминаем, что для тех, кто хочет продолжить работу с CCNP Enterprise, вам может быть интересно узнать больше о конфигурации RSTP в Приложении O сопутствующего веб-сайта «Реализация протокола связующего дерева».
###### Switch Priority: The global command spanning-tree vlan x priority y lets an engineer
Switch Priority: глобальная команда spanning-tree vlan x priority y позволяет инженеру   
__|__
--|--
|
set the switch’s priority in that VLAN.|установить приоритет коммутатора в этой VLAN.
###### Primary and Secondary Root Switches: The global command spanning-tree vlan x root
Первичный и вторичный корневые коммутаторы: глобальная команда spanning-tree vlan x root   
__|__
--|--
|
primary | secondary also lets you set the priority, but the switch decides on a value to make that switch likely to be the primary root switch (the root) or the secondary root switch (the switch that becomes root if the primary fails).|первичный | вторичный также позволяет вам установить приоритет, но коммутатор выбирает значение, чтобы этот коммутатор мог быть первичным корневым коммутатором (корнем) или вторичным корневым коммутатором (коммутатор, который становится корневым в случае отказа основного).
###### Port Costs: The interface subcommand spanning-tree [vlan x] cost y lets an engineer
Стоимость порта: интерфейсная подкоманда spanning-tree [vlan x] cost y позволяет инженеру   
__|__
--|--
|
set the switch’s STP/RSTP cost on that port, either for all VLANs or for a specific VLAN on that port.|установить стоимость STP / RSTP коммутатора для этого порта либо для всех VLAN, либо для конкретной VLAN на этом порту.
Changing those costs then changes the root cost for some switches, which impacts the choice of root ports and designated ports.|При изменении этих затрат изменяется стоимость корня для некоторых коммутаторов, что влияет на выбор корневых портов и назначенных портов.
|
That concludes this chapter’s examination of RSTP configuration—now on to Layer 2 EtherChannel!|На этом мы завершаем рассмотрение конфигурации RSTP в этой главе - теперь перейдем к EtherChannel уровня 2!
### Configuring Layer 2 EtherChannel
Настройка EtherChannel уровня 2   
__|__
--|--
|
As introduced in Chapter 9, two neighboring switches can treat multiple parallel links between each other as a single logical link called an EtherChannel.|Как было сказано в главе 9, два соседних коммутатора могут рассматривать несколько параллельных каналов между собой как один логический канал, называемый EtherChannel.
Without EtherChannel, a switch treats each physical port as an independent port, applying MAC learning, forwarding, and STP logic per physical port.|Без EtherChannel коммутатор рассматривает каждый физический порт как независимый порт, применяя изучение MAC, пересылку и логику STP для каждого физического порта.
With EtherChannel, the switch applies all those same processes to a group of physical ports as one entity: the EtherChannel.|С EtherChannel коммутатор применяет все те же процессы к группе физических портов как к одному объекту: EtherChannel.
Without EtherChannel, with parallel links between two switches, STP/RSTP would block all links except one, but with EtherChannel, the switch can use all the links, load balancing the traffic over the links.|Без EtherChannel при параллельных каналах между двумя коммутаторами STP / RSTP блокировал бы все ссылки, кроме одного, но с EtherChannel коммутатор может использовать все каналы, балансируя нагрузку на трафик по каналам.
|
NOTE All references to EtherChannel in this chapter refer to Layer 2 EtherChannels, not to Layer 3 EtherChannels (as discussed in Chapter 17, “IP Routing in the LAN”).|ПРИМЕЧАНИЕ Все ссылки на EtherChannel в этой главе относятся к EtherChannel уровня 2, а не к EtherChannels уровня 3 (как описано в главе 17, «IP-маршрутизация в локальной сети»).
CCNA 200-301 exam topics include both Layer 2 and Layer 3 EtherChannels.|Темы экзамена CCNA 200-301 включают в себя каналы EtherChannels уровня 2 и уровня 3.
|
EtherChannel may be one of the most challenging switch features to make work.|EtherChannel может быть одной из самых сложных функций коммутатора для работы.
First, the configuration has several options, so you have to remember the details of which options work together.|Во-первых, у конфигурации есть несколько опций, поэтому вы должны запомнить детали, какие опции работают вместе.
Second, the switches also require a variety of other interface settings to match among all the links in the channel, so you have to know those settings as well.|Во-вторых, для переключателей также требуется множество других настроек интерфейса, чтобы соответствовать всем ссылкам в канале, поэтому вы также должны знать эти настройки.
|
This section shows how to configure a Layer 2 EtherChannel, first through manual (static)|В этом разделе показано, как настроить канал EtherChannel уровня 2, сначала вручную (статический).
|
configuration, and then by allowing dynamic protocols to create the channel.|конфигурации, а затем разрешив динамическим протоколам создать канал.
This section closes with some information about some common configuration issues that occur with Layer 2 EtherChannels.|В конце этого раздела приводится некоторая информация о некоторых типичных проблемах конфигурации, которые возникают с EtherChannels уровня 2.
#### Configuring a Manual Layer 2 EtherChannel
Настройка EtherChannel уровня 2 вручную   
__|__
--|--
|
To configure a Layer 2 EtherChannel so that all the ports always attempt to be part of the channel, simply add the correct channel-group configuration command to each physical interface, on each switch, all with the on keyword, and all with the same number.|Чтобы настроить канал EtherChannel уровня 2 таким образом, чтобы все порты всегда пытались быть частью канала, просто добавьте правильную команду настройки группы каналов к каждому физическому интерфейсу, на каждом коммутаторе, все с ключевым словом on и все с одинаковым номером. .
The on keyword tells the switches to place a physical interface into an EtherChannel, and the number identifies the PortChannel interface number that the interface should be a part of.|Ключевое слово on сообщает коммутаторам о необходимости размещения физического интерфейса в EtherChannel, а число определяет номер интерфейса PortChannel, частью которого должен быть интерфейс.
|
Before getting into the configuration and verification, however, you need to start using three terms as synonyms: EtherChannel, PortChannel, and Channel-group.|Однако перед тем, как приступить к настройке и проверке, вам необходимо начать использовать три термина как синонимы: EtherChannel, PortChannel и Channel-group.
Oddly, IOS uses the channel-group configuration command, but then to display its status, IOS uses the show etherchannel command.|Как ни странно, IOS использует команду настройки группы каналов, но затем для отображения своего статуса IOS использует команду show etherchannel.
Then the output of this show command refers to neither an “EtherChannel” nor a “Channel-group,” instead using the term “PortChannel.” So, pay close attention to these three terms in the example.|Тогда выходные данные этой команды show не относятся ни к «EtherChannel», ни к «группе каналов», вместо этого используется термин «PortChannel». Итак, обратите внимание на эти три термина в примере.
|
To configure an EtherChannel manually, follow these steps:|Чтобы настроить EtherChannel вручную, выполните следующие действия:
|
Step 1.|Шаг 1.
Add the channel-group number mode on command in interface configuration mode under each physical interface that should be in the channel to add it to the channel.|Добавьте режим номера группы каналов по команде в режиме конфигурации интерфейса для каждого физического интерфейса, который должен быть в канале, чтобы добавить его в канал.
|
Step 2.|Шаг 2.
Use the same number for all commands on the same switch, but the channelgroup number on the neighboring switch can differ.|Используйте один и тот же номер для всех команд на одном коммутаторе, но номер группы каналов на соседнем коммутаторе может отличаться.
|
Example 10-4 shows a simple example, with two links between switches SW1 and SW2, as shown in Figure 10-6.|В примере 10-4 показан простой пример с двумя связями между переключателями SW1 и SW2, как показано на рисунке 10-6.
The configuration shows SW1’s two interfaces placed into channelgroup 1, with two show commands to follow.|Конфигурация показывает два интерфейса SW1, помещенных в группу каналов 1, с двумя последующими командами show.
|
Figure 10-6 Sample LAN Used in EtherChannel Example Example 10-4 Configuring and Monitoring EtherChannel Example end.|Рисунок 10-6 Пример LAN, используемой в EtherChannel Пример Пример 10-4 Настройка и мониторинг EtherChannel Пример конец.
|
Take a few moments to look at the output in the two show commands in the example, as well.|Уделите несколько минут, чтобы взглянуть на результат двух команд show в примере.
First, the show spanning-tree command lists Po1, short for PortChannel1, as an interface.|Во-первых, команда show spanning-tree перечисляет Po1, сокращение от PortChannel1, в качестве интерфейса.
This interface exists because of the channel-group commands using the 1 parameter.|Этот интерфейс существует из-за команд группы каналов, использующих параметр 1.
STP no longer operates on physical interfaces Fa0/14 and Fa0/15, instead operating on the PortChannel1 interface, so only that interface is listed in the output.|STP больше не работает на физических интерфейсах Fa0 / 14 и Fa0 / 15, вместо этого работает на интерфейсе PortChannel1, поэтому в выходных данных отображается только этот интерфейс.
|
Next, note the output of the show etherchannel 1 summary command.|Затем обратите внимание на результат команды show etherchannel 1 summary.
It lists as a heading “Port-channel,” with Po1 below it.|В нем указан заголовок «Порт-канал» с Po1 под ним.
It also lists both Fa0/14 and Fa0/15 in the list of ports, with a (P) beside each.|Он также перечисляет Fa0 / 14 и Fa0 / 15 в списке портов с символом (P) рядом с каждым.
Per the legend, the P means that the ports are bundled in the port channel, which is a code that means these ports have passed all the configuration checks and are valid to be included in the channel.|Согласно легенде, P означает, что порты связаны в канал порта, что означает, что эти порты прошли все проверки конфигурации и могут быть включены в канал.
#### Configuring Dynamic EtherChannels
Настройка динамических каналов EtherChannels   
__|__
--|--
|
In addition to manual configuration, Cisco switches also support two different configuration options that then use a dynamic protocol to negotiate whether a particular link becomes part of an EtherChannel or not.|В дополнение к ручной настройке коммутаторы Cisco также поддерживают два разных варианта конфигурации, которые затем используют динамический протокол для согласования того, становится ли конкретный канал частью EtherChannel или нет.
Basically, the configuration enables a protocol for a particular channel-group number.|По сути, конфигурация включает протокол для определенного номера группы каналов.
At that point, the switch can use the protocol to send messages to/from the neighboring switch and discover whether their configuration settings pass all checks.|В этот момент коммутатор может использовать протокол для отправки сообщений на / от соседнего коммутатора и определять, прошли ли его параметры конфигурации все проверки.
If a given physical link passes, the link is added to the EtherChannel and used; if not, it is placed in a down state, and not used, until the configuration inconsistency can be resolved.|Если данное физическое соединение проходит, оно добавляется в EtherChannel и используется; в противном случае он переводится в неактивное состояние и не используется до тех пор, пока несогласованность конфигурации не будет устранена.
|
Most Cisco Catalyst switches support the Cisco-proprietary Port Aggregation Protocol (PAgP) and the IEEE standard Link Aggregation Control Protocol (LACP), based on IEEE standard 802.3ad.|Большинство коммутаторов Cisco Catalyst поддерживают проприетарный протокол агрегации портов (PAgP) Cisco и стандартный протокол управления агрегацией каналов (LACP) IEEE, основанный на стандарте IEEE 802.3ad.
Although differences exist between the two, to the depth discussed here, they both accomplish the same task: negotiate so that only links that pass the configuration checks are actually used in an EtherChannel.|Несмотря на то, что между ними существуют различия, но в той мере, в какой они обсуждаются здесь, они оба выполняют одну и ту же задачу: согласовывают так, чтобы в EtherChannel фактически использовались только ссылки, прошедшие проверку конфигурации.
|
One difference of note is that LACP does support more links in a channel—16—as compared to PaGP’s maximum of 8.|Следует отметить одно отличие: LACP поддерживает больше ссылок в канале - 16 - по сравнению с максимумом в 8 в PaGP.
With LACP, only 8 can be active at one time, with the others waiting to be used should any of the other links fail.|С LACP только 8 могут быть активными одновременно, а остальные ожидают использования в случае отказа любого из других каналов.
|
To configure either protocol, a switch uses the channel-group configuration commands on each switch, but with a keyword that either means “use this protocol and begin negotiations”|Для настройки любого протокола коммутатор использует команды настройки группы каналов на каждом коммутаторе, но с ключевым словом, которое либо означает «использовать этот протокол и начать переговоры».
|
or “use this protocol and wait for the other switch to begin negotiations.” As shown in Figure 10-7, the desirable and auto keywords enable PAgP, and the active and passive keywords enable LACP. With these options, at least one side has to begin the negotiations.|или «используйте этот протокол и дождитесь, пока другой коммутатор начнет переговоры». Как показано на рисунке 10-7, ключевые слова желаемые и автоматические включают PAgP, а активные и пассивные ключевые слова включают LACP. Имея эти варианты, по крайней мере, одна сторона должна начать переговоры.
|
In other words, with PAgP, at least one of the two sides must use desirable, and with LACP, at least one of the two sides must use active.|Другими словами, с PAgP по крайней мере одна из двух сторон должна использовать желаемое, а с LACP по крайней мере одна из двух сторон должна использовать active.
|
Figure 10-7 Correct EtherChannel Configuration Combinations NOTE Do not use the on parameter on one end, and either auto or desirable (or for LACP, active or passive) on the neighboring switch.|Рисунок 10-7 Правильные комбинации конфигурации EtherChannel ПРИМЕЧАНИЕ Не используйте параметр on на одном конце, а также автоматический или желательный (или для LACP, активного или пассивного) на соседнем коммутаторе.
The on option uses neither PAgP nor LACP, so a configuration that uses on, with PAgP or LACP options on the other end, would prevent the EtherChannel from working.|Опция on не использует ни PAgP, ни LACP, поэтому конфигурация, которая использует on с опциями PAgP или LACP на другом конце, помешает работе EtherChannel.
|
For example, in the design shown in Figure 10-7, imagine both physical interfaces on both switches were configured with the channel-group 2 mode desirable interface subcommand.|Например, в схеме, показанной на рисунке 10-7, представьте, что оба физических интерфейса на обоих коммутаторах были настроены с помощью подкоманды желаемого интерфейса для режима группы каналов 2.
|
As a result, the two switches would negotiate and create an EtherChannel.|В результате два коммутатора будут согласовывать и создавать EtherChannel.
Example 10-5 shows the verification of that configuration, with the command show etherchannel 1 port-channel.|В примере 10-5 показана проверка этой конфигурации с помощью команды show etherchannel 1 port-channel.
This command confirms the protocol in use (PAgP, because the desirable keyword was configured), and the list of interfaces in the channel.|Эта команда подтверждает используемый протокол (PAgP, поскольку было настроено желаемое ключевое слово) и список интерфейсов в канале.
|
Example 10-5 EtherChannel Verification: PAgP Desirable Mode Example end.|Пример 10-5 Проверка EtherChannel: желаемый режим PAgP Конец примера.
#### Physical Interface Configuration and EtherChannels
Конфигурация физического интерфейса и каналы EtherChannels   
__|__
--|--
|
Even when the channel-group commands have all been configured correctly, other configuration settings can prevent a switch from using a physical port in an EtherChannel—even physical ports manually configured to be part of the channel.|Даже если все команды группы каналов были настроены правильно, другие параметры конфигурации могут помешать коммутатору использовать физический порт в EtherChannel - даже физические порты, вручную настроенные как часть канала.
The next topic examines those reasons.|В следующей теме исследуются эти причины.
|
First, before using a physical port in an EtherChannel, the switch compares the new physical port’s configuration to the existing ports in the channel.|Во-первых, перед использованием физического порта в EtherChannel коммутатор сравнивает конфигурацию нового физического порта с существующими портами в канале.
That new physical interface’s settings must be the same as the existing ports’ settings; otherwise, the switch does not add the new link to the list of approved and working interfaces in the channel.|Настройки этого нового физического интерфейса должны быть такими же, как настройки существующих портов; в противном случае коммутатор не добавляет новую ссылку в список одобренных и работающих интерфейсов в канале.
That is, the physical interface remains configured as part of the PortChannel, but it is not used as part of the channel, often being placed into some nonworking state.|То есть физический интерфейс остается настроенным как часть PortChannel, но он не используется как часть канала, часто переводя его в нерабочее состояние.
|
The list of items the switch checks includes the following:|Список пунктов, которые проверяет коммутатор, включает следующее:
###### Speed
Скорость   
###### Duplex
Дуплекс   
###### Operational access or trunking state (all must be access, or all must be trunks)
Оперативный доступ или состояние транкинга (все должны иметь доступ или все должны быть транками)   
###### If an access port, the access VLAN
Если порт доступа, VLAN доступа   
###### If a trunk port, the allowed VLAN list (per the switchport trunk allowed command)
Если это магистральный порт, список разрешенных VLAN (для разрешенной команды switchport trunk)   
###### If a trunk port, the native VLAN
Если порт транка, собственная VLAN   
###### STP interface settings
Настройки интерфейса STP   
__|__
--|--
|
In addition, switches check the settings on the neighboring switch.|Кроме того, переключатели проверяют настройки на соседнем переключателе.
To do so, the switches either use PAgP or LACP (if already in use) or use Cisco Discovery Protocol (CDP) if using manual configuration.|Для этого коммутаторы либо используют PAgP или LACP (если он уже используется), либо используют протокол обнаружения Cisco (CDP) при ручной настройке.
When checking neighbors, all settings except the STP settings must match.|При проверке соседей должны совпадать все настройки, кроме настроек STP.
|
As an example, SW1 and SW2 again use two links in one EtherChannel from Figure 10-7.|Например, SW1 и SW2 снова используют два канала в одном EtherChannel, как показано на рисунке 10-7.
|
Before configuring the EtherChannel, SW1’s G0/2 was given a different RSTP port cost than G0/1.|Перед настройкой EtherChannel для G0 / 2 коммутатора SW1 была присвоена стоимость порта RSTP, отличная от G0 / 1.
Example 10-6 picks up the story just after configuring the correct channel-group commands, when the switch is deciding whether to use G0/1 and G0/2 in this.|Пример 10-6 раскрывает историю сразу после настройки правильных команд группы каналов, когда коммутатор решает, использовать ли в этом G0 / 1 и G0 / 2.
|
Example 10-6 Local Interfaces Fail in EtherChannel Because of Mismatched STP Cost Example end.|Пример 10-6 Отказ локальных интерфейсов в EtherChannel из-за несоответствия стоимости STP Конец примера.
|
The messages at the top of the example specifically state what the switch does when determining whether the interface settings match.|Сообщения в верхней части примера конкретно указывают, что делает переключатель при определении совпадения настроек интерфейса.
In this case, SW1 detects the different STP costs.|В этом случае SW1 обнаруживает различные затраты STP.
SW1 does not use G0/1, does not use G0/2, and even places them into an errdisabled state.|SW1 не использует G0 / 1, не использует G0 / 2 и даже переводит их в состояние errdisabled.
The switch also puts the PortChannel into err-disabled state.|Коммутатор также переводит PortChannel в состояние отключения из-за ошибки.
As a result, the PortChannel is not operational, and the physical interfaces are also not operational.|В результате PortChannel не работает, как и физические интерфейсы.
|
To solve this problem, you must reconfigure the physical interfaces to use the same STP settings.|Чтобы решить эту проблему, необходимо перенастроить физические интерфейсы для использования тех же параметров STP.
In addition, the PortChannel and physical interfaces must be shutdown, and then no shutdown, to recover from the err-disabled state. (Note that when a switch applies the shutdown and no shutdown commands to a PortChannel, it applies those same commands to the physical interfaces, as well; so, just do the shutdown/no shutdown on the PortChannel interface.)|Кроме того, PortChannel и физические интерфейсы должны быть выключены, а затем не выключены, чтобы выйти из состояния отключения из-за ошибки. (Обратите внимание, что когда коммутатор применяет команды shutdown и no shutdown к PortChannel, он применяет те же самые команды к физическим интерфейсам; поэтому просто выполните shutdown / no shutdown на интерфейсе PortChannel.)
#### EtherChannel Load Distribution
Распределение нагрузки EtherChannel   
__|__
--|--
|
When using Layer 2 EtherChannels, a switch’s MAC learning process associates MAC addresses with the PortChannel interfaces and not the underlying physical ports.|При использовании каналов EtherChannel уровня 2 процесс изучения MAC-адресов коммутатора связывает MAC-адреса с интерфейсами PortChannel, а не с соответствующими физическими портами.
Later, when a switch makes a forwarding decision to send a frame out a PortChannel interface, the switch must do more work: to decide out which specific physical port to use to forward the frame.|Позже, когда коммутатор принимает решение о пересылке кадра через интерфейс PortChannel, коммутатор должен выполнять больше работы: решать, какой конкретный физический порт использовать для пересылки кадра.
|
IOS documentation refers to those rules as EtherChannel load distribution or load balancing.|В документации IOS эти правила называются распределением нагрузки EtherChannel или балансировкой нагрузки.
|
Figure 10-8 shows the main idea.|На рис. 10-8 показана основная идея.
|
Figure 10-8 Correct EtherChannel Configuration Combinations|Рисунок 10-8 Правильные комбинации конфигурации EtherChannel
##### Configuration Options for EtherChannel Load Distribution
Варианты конфигурации для распределения нагрузки EtherChannel   
__|__
--|--
|
EtherChannel load distribution makes the choice for each frame based on various numeric values found in the Layer 2, 3, and 4 headers.|Распределение нагрузки EtherChannel делает выбор для каждого кадра на основе различных числовых значений, найденных в заголовках уровней 2, 3 и 4.
The process uses one configurable setting as input: the load distribution method as defined with the port-channel load-balance method global command.|В качестве входных данных процесс использует один настраиваемый параметр: метод распределения нагрузки, определенный с помощью глобальной команды метода балансировки нагрузки порта-канала.
The process then performs some match against the fields identified by the configured method.|Затем процесс выполняет некоторое сопоставление с полями, идентифицированными настроенным методом.
|
Table 10-4 lists the most common methods.|В Таблице 10-4 перечислены наиболее распространенные методы.
However, note that some switches may support only MAC-based methods, or only MAC- and IP-based methods, depending on the model and software version.|Однако обратите внимание, что некоторые коммутаторы могут поддерживать только методы на основе MAC или только методы на основе MAC и IP, в зависимости от модели и версии программного обеспечения.
|
Table 10-4 EtherChannel Load Distribution Methods Table end.|Таблица 10-4 Методы распределения нагрузки EtherChannel Конец таблицы.
|
To appreciate why you might want to use different methods, you need to consider the results of how switches make their choice. (The discussion here focuses on the result, and not the logic, because the logic remains internal to the switch, and Cisco does not document how each switch model or IOS version works internally.) However, the various load distribution algorithms do share some common goals:|Чтобы понять, почему вы можете захотеть использовать разные методы, вам нужно рассмотреть результаты того, как коммутаторы делают свой выбор. (Обсуждение здесь сосредоточено на результате, а не на логике, потому что логика остается внутренней по отношению к коммутатору, и Cisco не документирует, как каждая модель коммутатора или версия IOS работает внутри.) Однако различные алгоритмы распределения нагрузки имеют некоторые общие черты. цели:
###### To cause all messages in a single application flow to use the same link in the channel,
Чтобы все сообщения в одном потоке приложения использовали одну и ту же ссылку в канале,   
__|__
--|--
|
rather than being sent over different links.|а не по разным ссылкам.
Doing so means that the switch will not inadvertently reorder the messages sent in that application flow by sending one message over a busy link that has a queue of waiting messages, while immediately sending the next message out an unused link.|Это означает, что коммутатор не будет непреднамеренно изменять порядок сообщений, отправляемых в этом потоке приложений, отправляя одно сообщение по занятой ссылке, которая имеет очередь ожидающих сообщений, при немедленной отправке следующего сообщения по неиспользуемой ссылке.
###### To integrate the load distribution algorithm work into the hardware forwarding ASIC so
Чтобы интегрировать алгоритм распределения нагрузки в аппаратную пересылку ASIC,   
__|__
--|--
|
that load distribution works just as quickly as the work to forward any other frame.|это распределение нагрузки работает так же быстро, как и работа по пересылке любого другого кадра.
###### To use all the active links in the EtherChannel, adjusting to the addition and removal of
Чтобы использовать все активные ссылки в EtherChannel, настраиваясь на добавление и удаление   
__|__
--|--
|
active links over time.|активные ссылки с течением времени.
###### Within the constraints of the other goals, balance the traffic across those active links.
В рамках ограничений других целей сбалансируйте трафик по этим активным ссылкам.   
__|__
--|--
|
In short, the algorithms first intend to avoid message reordering, make use of the switch forwarding ASICs, and use all the active links.|Короче говоря, алгоритмы в первую очередь предназначены для предотвращения переупорядочения сообщений, использования ASIC для пересылки коммутатора и использования всех активных ссылок.
However, the algorithm does not attempt to send the exact same number of bits over each link over time.|Однако алгоритм не пытается посылать одно и то же количество бит по каждому каналу с течением времени.
The algorithm does try to balance the traffic, but always within the constraints of the other goals.|Алгоритм действительно пытается сбалансировать трафик, но всегда в пределах ограничений других целей.
|
Whatever load distribution method you choose, the method identifies fields in the message headers.|Какой бы метод распределения нагрузки вы ни выбрали, этот метод определяет поля в заголовках сообщений.
Any messages in the same application flow will then have the same values in the fields used by the load distribution algorithm and will always be forwarded over the same link.|Любые сообщения в одном потоке приложения будут иметь те же значения в полях, используемых алгоритмом распределения нагрузки, и всегда будут пересылаться по одной и той же ссылке.
For example, when a user connects to a website, that web server may return thousands of packets to the client.|Например, когда пользователь подключается к веб-сайту, этот веб-сервер может возвращать клиенту тысячи пакетов.
Those thousands of packets should flow over the same link in the EtherChannel.|Эти тысячи пакетов должны проходить по одному и тому же каналу в EtherChannel.
|
For instance, with the load distribution method of src-mac (meaning source MAC address), all frames with the same MAC address flow over one link.|Например, при использовании метода распределения нагрузки src-mac (что означает MAC-адрес источника) все кадры с одним и тем же MAC-адресом проходят по одному каналу.
Figure 10-9 shows the idea with pseudo MAC addresses, with the load distribution sending frames with source MAC 1 over link 1, source MAC 2 over link 2, and source MAC 3 over link 3.|На рисунке 10-9 показана идея с псевдо-MAC-адресами, при котором распределение нагрузки отправляет кадры с исходным MAC-адресом 1 по каналу 1, исходным MAC-адресом 2 по каналу 2 и исходным MAC-адресом 3 по каналу 3.
|
Figure 10-9 Distributing All Frames with Same Mac Out Same Interface Cisco provides a variety of load distribution options so that the engineer can examine the flows in the network with the idea of finding which fields have the most variety in their values:|Рис. 10-9. Распределение всех кадров с одним и тем же интерфейсом Mac на выходе Cisco предоставляет множество вариантов распределения нагрузки, чтобы инженер мог исследовать потоки в сети, чтобы определить, какие поля имеют наибольшее разнообразие значений:
|
source and destination MAC, or IP address, or transport layer port numbers.|MAC-адрес источника и назначения, IP-адрес или номера портов транспортного уровня.
The more variety in the values in the fields, the better the balancing effects, and the lower the chance of sending disproportionate amounts of traffic over one link.|Чем больше разнообразия значений в полях, тем лучше эффекты балансировки и тем меньше вероятность отправки непропорционального объема трафика по одной ссылке.
|
NOTE The algorithm focuses on the low-order bits in the fields in the headers because the low-order bits typically differ the most in real networks, while the high-order bits do not differ much.|ПРИМЕЧАНИЕ. Алгоритм фокусируется на младших битах в полях заголовков, потому что младшие биты обычно больше всего различаются в реальных сетях, тогда как старшие разряды не сильно отличаются.
By focusing on the lower-order bits, the algorithm achieves better balancing of traffic over the links.|За счет сосредоточения внимания на битах более низкого порядка алгоритм обеспечивает лучшую балансировку трафика по ссылкам.
##### The Effects of the EtherChannel Load Distribution Algorithm
Эффекты алгоритма распределения нагрузки EtherChannel   
__|__
--|--
|
Figure 10-10 details a new EtherChannel that will be used in two examples to show the effects of load distribution.|На рис. 10-10 показан новый канал EtherChannel, который будет использоваться в двух примерах, чтобы показать влияние распределения нагрузки.
The examples will focus on frames sent by switch SW1 in the figure, showing the use of the test etherchannel load-balance EXEC command.|Примеры будут сосредоточены на кадрах, отправленных переключателем SW1 на рисунке, показывающем использование команды EXEC test etherchannel load-balance.
That command asks the switch to consider some addresses or ports and answer the question: which link would you use when forwarding a message with those address/port values?.|Эта команда просит коммутатор рассмотреть некоторые адреса или порты и ответить на вопрос: какую ссылку вы бы использовали при пересылке сообщения с этими значениями адреса / порта?
|
Figure 10-10 Four-Link EtherChannel Example 10-7 shows how switch SW1 distributes traffic when using src-mac load distribution.|Рис. 10-10. Пример 10-7 для четырехканального EtherChannel показывает, как коммутатор SW1 распределяет трафик при использовании распределения нагрузки src-mac.
|
The example lists the output from three of the test etherchannel load-balance commands, but note that all three commands use the same source MAC address.|В примере перечислены выходные данные трех тестовых команд балансировки нагрузки etherchannel, но обратите внимание, что все три команды используют один и тот же исходный MAC-адрес.
As a result, the answer from each command references the same interface (G1/0/22 in this case).|В результате ответ каждой команды ссылается на один и тот же интерфейс (в данном случае G1 / 0/22).
|
Example 10-7 Testing with Identical Source MACs When Using src-mac Balancing Example end.|Пример 10-7. Тестирование с идентичными исходными MAC-адресами при использовании балансировки src-mac Конец примера.
|
Example 10-7 makes two important points:|В примере 10-7 отмечаются два важных момента:
###### All three tests list the same outgoing physical interface because (1) the method uses only
Все три теста перечисляют один и тот же исходящий физический интерфейс, потому что (1) метод использует только   
__|__
--|--
|
the source MAC address, and (2) all three tests use the same MAC addresses.|MAC-адрес источника и (2) все три теста используют одни и те же MAC-адреса.
###### All three tests use a different destination MAC address, with different low-order bits, but
Во всех трех тестах используется другой MAC-адрес назначения с разными младшими битами, но   
__|__
--|--
|
that had no impact on the choice because the method—src-mac—does not consider the destination MAC address.|это не повлияло на выбор, поскольку метод - src-mac - не учитывает MAC-адрес назначения.
|
In contrast on that first point, Example 10-8 repeats the test commands from Example 10-7.|В отличие от этого первого пункта пример 10-8 повторяет тестовые команды из примера 10-7.
|
The switch still uses the src-mac balancing method, but now with different source MAC addresses in each test.|Коммутатор по-прежнему использует метод балансировки src-mac, но теперь с разными исходными MAC-адресами в каждом тесте.
Notice that the source MAC addresses used in the tests differ by just a few bit values in the low-order bits, so as a result, each test shows a different interface choice by SW1.|Обратите внимание, что MAC-адреса источника, используемые в тестах, различаются всего на несколько битовых значений в младших битах, поэтому в результате каждый тест показывает другой выбор интерфейса SW1.
|
Example 10-8 Testing with Source MACs with Low-Order Bit Differences Example end.|Пример 10-8 Тестирование с исходными MAC-адресами с младшими разностями битов Пример конец.
|
Example 10-9 shows yet a third variation, this time changing the load distribution method to src-dst-mac, which means that the switch will consider both source and destination MAC.|В примере 10-9 показан еще один вариант, на этот раз с изменением метода распределения нагрузки на src-dst-mac, что означает, что коммутатор будет учитывать MAC-адрес источника и назначения.
|
The example repeats the exact same test etherchannel commands as Example 10-7, with the exact same MAC addresses: the source MAC addresses remain the same in all three tests, but the destination MAC addresses differ in the low-order bits.|В примере повторяются те же самые команды test etherchannel, что и в примере 10-7, с теми же MAC-адресами: исходные MAC-адреса остаются одинаковыми во всех трех тестах, но MAC-адреса назначения различаются младшими битами.
With the chosen destination MAC values differing slightly, switch SW1 happens to choose three different interfaces.|Поскольку выбранные значения MAC назначения немного отличаются, коммутатор SW1 выбирает три разных интерфейса.
|
Example 10-9 Evidence of Source and Destination MAC Load Distribution Example end.|Пример 10-9 Свидетельство распределения нагрузки MAC-адресов источника и назначения Конец примера.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element for more details.|Обратитесь к элементу «Ваш учебный план» для получения более подробной информации.
Table 10-5 outlines the key review elements and where you can find them.|В Таблице 10-5 представлены ключевые элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 10-5 Chapter Review Tracking Table end.|Таблица 10-5 Окончание таблицы отслеживания обзора главы.
|
Review All the Key Topics Key Terms You Should Know Rapid PVST+, PVST+, system ID extension, PAgP, LACP, PortChannel, Channel-group, EtherChannel, EtherChannel Load Distribution, primary root, secondary root Command References Tables 10-7 and 10-8 list configuration and verification commands used in this chapter.|Ознакомьтесь со всеми ключевыми темами. Ключевые термины, которые вы должны знать Rapid PVST +, PVST +, расширение системного идентификатора, PAgP, LACP, PortChannel, группа каналов, EtherChannel, распределение нагрузки EtherChannel, первичный корень, вторичный корень Ссылки на команды Таблицы 10-7 и 10-8 перечислить команды настройки и проверки, используемые в этой главе.
As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.|В качестве простого упражнения на повторение закройте левый столбец таблицы, прочтите правый столбец и попытайтесь вспомнить команду, не глядя.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Затем повторите упражнение, охватывая правый столбец, и попытайтесь вспомнить, что делает команда.
|
Table 10-7 Chapter 10 Configuration Command Reference Table end.|Таблица 10-7 Глава 10 Справочник команд конфигурации Конец таблицы.
|
Table 10-8 Chapter 10 EXEC Command Reference Table end.|Таблица 10-8 Глава 10 Справочник команд EXEC Конец таблицы.
|
Keep track of your part review progress with the checklist shown in Table P3-1.|Следите за ходом проверки деталей с помощью контрольного списка, приведенного в Таблице P3-1.
Details on each task follow the table.|Подробности по каждой задаче приведены в таблице.
|
Table P3-1 Part III Part Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Do Labs Review Appendices Videos Repeat All DIKTA Questions For this task, answer the “Do I Know This Already?” questions again for the chapters in this part of the book, using the PCPT software.|Таблица P3-1. Контрольный список проверки части III. Действие 1-я дата завершения 2-я дата завершения Повторить все вопросы DIKTA Ответить на вопросы проверки части Пересмотреть ключевые темы Проверяют ли лаборатории Приложения Видео Повторить все вопросы DIKTA Для этой задачи ответьте на вопрос «Знаю ли я это уже?» снова задайте вопросы к главам этой части книги, используя программное обеспечение PCPT.
|
Answer Part Review Questions For this task, answer the Part Review questions for this part of the book, using the PTP software.|Ответить на вопросы обзора части Для этой задачи ответьте на вопросы обзора части для этой части книги, используя программное обеспечение PTP.
|
Review Key Topics Review all key topics in all chapters in this part, either by browsing the chapters or by using the Key Topics application on the companion website.|Обзор ключевых тем. Просмотрите все ключевые темы во всех главах этой части, просматривая главы или используя приложение «Ключевые темы» на сопутствующем веб-сайте.
|
Labs Depending on your chosen lab tool, here are some suggestions for what to do in lab:|Лабораторные работы В зависимости от выбранного вами лабораторного инструмента, вот несколько советов о том, что делать в лаборатории:
|
Pearson Network Simulator: If you use the full Pearson ICND1 or CCNA simulator, focus more on the configuration scenario and troubleshooting scenario labs associated with the topics in this part of the book.|Симулятор сети Pearson: если вы используете полный симулятор Pearson ICND1 или CCNA, уделите больше внимания сценарию конфигурации и лабораторным работам по сценарию устранения неполадок, связанным с темами в этой части книги.
These types of labs include a larger set of topics and work well as Part Review activities. (See the Introduction for some details about how to find which labs are about topics in this part of the book.) Note that the Sim Lite that comes with this book also has a couple of labs about VLANs.|Эти типы лабораторных работ включают более широкий набор тем и хорошо подходят для работы с обзором деталей. (См. Введение для получения некоторых подробностей о том, как найти, какие лабораторные работы посвящены темам в этой части книги.) Обратите внимание, что Sim Lite, поставляемый с этой книгой, также имеет несколько лабораторных работ по VLAN.
|
Blog: Config Labs: The author’s blog includes a series of configuration-focused labs that you can do on paper, each in 10–15 minutes.|Блог: Config Labs: блог автора включает в себя серию лабораторных работ по настройке, которые вы можете выполнить на бумаге, каждая из которых занимает 10–15 минут.
Review and perform the labs for this part of the book, as found at http://blog.certskills.com.|Просмотрите и выполните лабораторные работы для этой части книги, которые можно найти на http://blog.certskills.com.
Then navigate to the Hands-on Config labs.|Затем перейдите к практическим занятиям по настройке.
## Part III Review
Часть III Обзор   
__|__
--|--
|
Other: If using other lab tools, as a few suggestions: Make sure and experiment heavily with VLAN configuration and VLAN trunking configuration.|Другое: при использовании других лабораторных инструментов, несколько предложений: Убедитесь и поэкспериментируйте с конфигурацией VLAN и конфигурацией транкинга VLAN.
|
Dig Deeper with Appendices on the Companion Website The chapters in Part III of the book recommended the following appendices for extra reading.|Копайте глубже с приложениями на сопутствующем веб-сайте В главах Части III книги рекомендуются следующие приложения для дополнительного чтения.
|
If you care to read further, consider:|Если вы хотите читать дальше, подумайте:
###### Appendix K, “Analyzing Ethernet LAN Designs”: A chapter from the previous
Приложение K, «Анализ схем локальной сети Ethernet»: глава из предыдущего   
__|__
--|--
|
edition that discusses design topologies and LAN design with two-tier and three-tier designs, including access and distribution switches.|издание, в котором обсуждаются топологии проектирования и проектирование ЛВС с двухуровневым и трехуровневым дизайном, включая коммутаторы доступа и распределения.
###### Appendix O, “Spanning Tree Protocol Implementation”: A chapter that works
Приложение O, «Реализация протокола связующего дерева»: глава, которая работает   
__|__
--|--
|
through the configuration and verification commands for STP and RSTP.|с помощью команд настройки и проверки для STP и RSTP.
###### Appendix P, “LAN Troubleshooting”: A chapter from the previous edition of the
Приложение P, «Устранение неполадок LAN»: глава из предыдущего издания   
__|__
--|--
|
ICND2 Cert Guide.|ICND2 Cert Guide.
This chapter includes topics about VLANs, trunks, and STP and how to troubleshoot each.|Эта глава включает темы о виртуальных локальных сетях, соединительных линиях и протоколе STP, а также способы устранения каждой из них.
|
Watch Videos Chapter 8 recommends two videos, one about VLANs and another about the VLAN allowed list on trunks.|Смотреть видео В главе 8 рекомендуется два видеоролика, один о VLAN, а другой о разрешенном списке VLAN на магистралях.
If you have not watched those videos yet, take a moment to scan back to Chapter 8 on the companion website and watch the videos.|Если вы еще не смотрели эти видео, найдите время, чтобы вернуться к главе 8 на сопутствующем веб-сайте и посмотреть видео.
|
The book makes a big transition at this point.|На этом этапе книга делает большой переход.
Part I gave you a broad introduction to networking, and Parts II and III went into some detail about the dominant LAN technology today: Ethernet.|Часть I дала вам общее представление о сетях, а в частях II и III были подробно описаны доминирующая сегодня технология LAN: Ethernet.
Part IV transitions from Ethernet to the network layer details that sit above Ethernet and WAN technology, specifically IP Version 4 (IPv4).|Часть IV переходит от Ethernet к деталям сетевого уровня, которые находятся над технологиями Ethernet и WAN, в частности IP версии 4 (IPv4).
|
Thinking about the network layer requires engineers to shift how they think about addressing.|Думая о сетевом уровне, инженеры должны изменить свой взгляд на адресацию.
|
Ethernet allows the luxury of using universal MAC addresses, assigned by the manufacturers, with no need to plan or configure addresses.|Ethernet позволяет использовать универсальные MAC-адреса, назначаемые производителями, без необходимости планировать или настраивать адреса.
Although the network engineer needs to understand MAC addresses, MAC already exists on each Ethernet NIC, and switches learn the Ethernet MAC addresses dynamically without even needing to be configured to do so.|Хотя сетевому инженеру необходимо понимать MAC-адреса, MAC-адреса уже существуют на каждой сетевой карте Ethernet, а коммутаторы динамически изучают MAC-адреса Ethernet без необходимости их настройки для этого.
As a result, most people operating the network can ignore the specific MAC address values for most tasks.|В результате большинство людей, управляющих сетью, могут игнорировать конкретные значения MAC-адресов для большинства задач.
|
Conversely, IP addressing gives us flexibility and allows choice, but those features require planning, along with a much deeper understanding of the internal structure of the addresses.|И наоборот, IP-адресация дает нам гибкость и позволяет выбирать, но эти функции требуют планирования, а также гораздо более глубокого понимания внутренней структуры адресов.
|
People operating the network must be more aware of the network layer addresses when doing many tasks.|Люди, управляющие сетью, должны больше знать адреса сетевого уровня при выполнении многих задач.
To better prepare you for these Layer 3 addressing details, this part breaks down the addressing details into four chapters, with an opportunity to learn more in preparation for the CCNP Enterprise certification.|Чтобы лучше подготовить вас к этим деталям адресации уровня 3, в этой части детали адресации разбиты на четыре главы, с возможностью узнать больше при подготовке к сертификации CCNP Enterprise.
|
Part IV examines most of the basic details of IPv4 addressing and subnetting, mostly from the perspective of operating an IP network.|В части IV исследуется большинство основных деталей адресации IPv4 и подсетей, в основном с точки зрения эксплуатации IP-сети.
Chapter 11 takes a grand tour of IPv4 addressing as implemented inside a typical enterprise network.|В главе 11 подробно рассказывается об адресации IPv4, реализованной в типичной корпоративной сети.
Chapters 12, 13, and 14 look at some of the specific questions people must ask themselves when operating an IPv4 network.|В главах 12, 13 и 14 рассматриваются некоторые конкретные вопросы, которые люди должны задать себе при работе в сети IPv4.
## Part IV IPv4 Addressing
Часть IV. Адресация IPv4.   
__|__
--|--
|
Part IV Review|Часть IV Обзор
## Chapter 11 Perspectives on IPv4 Subnetting
Глава 11 Перспективы разделения IPv4 на подсети   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.6 Configure and verify IPv4 addressing and subnetting
1.6 Настройка и проверка адресации IPv4 и подсетей   
###### 1.7 Describe the need for private IPv4 addressing
1.7. Опишите необходимость частной адресации IPv4.   
__|__
--|--
|
Most entry-level networking jobs require you to operate and troubleshoot a network using a preexisting IP addressing and subnetting plan.|Большинство сетевых заданий начального уровня требуют, чтобы вы управляли сетью и выполняли поиск неисправностей, используя уже существующий план IP-адресации и подсети.
The CCNA exam assesses your readiness to use preexisting IP addressing and subnetting information to perform typical operations tasks, such as monitoring the network, reacting to possible problems, configuring addresses for new parts of the network, and troubleshooting those problems.|Экзамен CCNA оценивает вашу готовность использовать уже существующие IP-адресацию и информацию о подсетях для выполнения типичных операционных задач, таких как мониторинг сети, реагирование на возможные проблемы, настройка адресов для новых частей сети и устранение этих проблем.
|
However, you also need to understand how networks are designed and why.|Однако вам также необходимо понимать, как устроены сети и почему.
Anyone monitoring a network must continually ask the question, “Is the network working as designed?” If a problem exists, you must consider questions such as “What happens when the network works normally, and what is different right now?” Both questions require you to understand the intended design of the network, including details of the IP addressing and subnetting design.|Любой, кто контролирует сеть, должен постоянно задавать вопрос: «Работает ли сеть, как задумано?» Если проблема существует, вы должны рассмотреть такие вопросы, как «Что происходит, когда сеть работает нормально, и что сейчас изменилось?» Оба вопроса требуют от вас понимания предполагаемого дизайна сети, в том числе деталей IP-адресации и структуры подсетей.
|
This chapter provides some perspectives and answers for the bigger issues in IPv4 addressing.|В этой главе представлены некоторые точки зрения и ответы на более серьезные проблемы, связанные с адресацией IPv4.
|
What addresses can be used so that they work properly?|Какие адреса можно использовать, чтобы они работали правильно?
What addresses should be used?|Какие адреса следует использовать?
When told to use certain numbers, what does that tell you about the choices made by some other network engineer?|Когда вам говорят использовать определенные числа, что это говорит вам о выборе, сделанном другим сетевым инженером?
How do these choices impact the practical job of configuring switches, routers, hosts, and operating the network on a daily basis?|Как этот выбор влияет на практическую работу по настройке коммутаторов, маршрутизаторов, хостов и повседневной эксплуатации сети?
This chapter hopes to answer these questions while revealing details of how IPv4 addresses work.|В этой главе мы надеемся ответить на эти вопросы, в то же время раскрывая детали того, как работают адреса IPv4.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 11-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 11-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
__|__
--|--
|
Analyze Requirements 1–3 Make Design Choices 4–7 CHAPTER 11 1.|Анализировать требования 1–3 Сделать выбор в дизайне 4–7 ГЛАВА 11 1.
Host A is a PC, connected to switch SW1 and assigned to VLAN 1.|Хост A - это ПК, подключенный к коммутатору SW1 и назначенный VLAN 1.
Which of the following are typically assigned an IP address in the same subnet as host A? (Choose two answers.)|Какому из следующего обычно назначается IP-адрес в той же подсети, что и хосту A? (Выберите два ответа.)
|
a. The local router’s WAN interface b.|а. WAN-интерфейс локального маршрутизатора b.
The local router’s LAN interface c.|Интерфейс локальной сети локального маршрутизатора c.
All other hosts attached to the same switch d.|Все остальные хосты подключены к тому же коммутатору d.
Other hosts attached to the same switch and also in VLAN 1 2.|Другие хосты, подключенные к тому же коммутатору, а также в VLAN 1 2.
Why does the formula for the number of hosts per subnet (2H – 2) require the subtraction of two hosts?|Почему формула количества хостов в подсети (2H - 2) требует вычитания двух хостов?
|
a. To reserve two addresses for redundant default gateways (routers)|а. Чтобы зарезервировать два адреса для резервных шлюзов по умолчанию (маршрутизаторов)
|
b. To reserve the two addresses required for DHCP operation c.|б. Чтобы зарезервировать два адреса, необходимые для работы DHCP c.
To reserve addresses for the subnet ID and default gateway (router)|Чтобы зарезервировать адреса для идентификатора подсети и шлюза по умолчанию (маршрутизатора)
|
d. To reserve addresses for the subnet broadcast address and subnet ID 3.|d. Чтобы зарезервировать адреса для широковещательного адреса подсети и идентификатора подсети 3.
A Class B network needs to be subnetted such that it supports 100 subnets and 100 hosts/subnet.|Сеть класса B должна быть разделена на подсети так, чтобы поддерживать 100 подсетей и 100 хостов в подсети.
Which of the following answers list a workable combination for the number of network, subnet, and host bits? (Choose two answers.)|В каком из следующих ответов приводится допустимая комбинация количества битов сети, подсети и хоста? (Выберите два ответа.)
|
a. Network = 16, subnet = 7, host = 7 b.|а. Сеть = 16, подсеть = 7, хост = 7 b.
Network = 16, subnet = 8, host = 8 c.|Сеть = 16, подсеть = 8, хост = 8 c.
Network = 16, subnet = 9, host = 7 d.|Сеть = 16, подсеть = 9, хост = 7 d.
Network = 8, subnet = 7, host = 17 4.|Сеть = 8, подсеть = 7, хост = 17 4.
Which of the following are private IP networks? (Choose two answers.)|Что из перечисленного является частными IP-сетями? (Выберите два ответа.)
|
a. 172.31.0.0 b. 172.32.0.0 c. 192.168.255.0 d. 192.1.168.0 e. 11.0.0.0 5.|а. 172.31.0.0 б. 172.32.0.0 с. 192.168.255.0 г. 192.1.168.0 e. 11.0.0.0 5.
Which of the following are public IP networks? (Choose three answers.)|Что из перечисленного является общедоступными IP-сетями? (Выберите три ответа.)
|
a. 9.0.0.0 b. 172.30.0.0 c. 192.168.255.0 d. 192.1.168.0 e. 1.0.0.0 6.|а. 9.0.0.0 б. 172.30.0.0 с. 192.168.255.0 г. 192.1.168.0 e. 1.0.0.0 6.
Before Class B network 172.16.0.0 is subnetted by a network engineer, what parts of the structure of the IP addresses in this network already exist, with a specific size?|До того как сеть 172.16.0.0 класса B была разделена сетевым инженером на подсети, какие части структуры IP-адресов в этой сети уже существуют с определенным размером?
|
(Choose two answers.)|(Выберите два ответа.)
|
a. Network b.|а. Сеть b.
Subnet c.|Подсеть c.
Host d.|Хост d.
Broadcast 7.|Трансляция 7.
A network engineer spends time thinking about the entire Class B network 172.16.0.0 and how to subnet that network.|Сетевой инженер тратит время на размышления обо всей сети класса B 172.16.0.0 и о том, как разбить эту сеть на подсети.
He then chooses how to subnet this Class B network and creates an addressing and subnetting plan, on paper, showing his choices.|Затем он выбирает способ подсети этой сети класса B и создает план адресации и подсети на бумаге, показывая свой выбор.
|
If you compare his thoughts about this network before subnetting the network to his thoughts about this network after mentally subnetting the network, which of the following occurred to the parts of the structure of addresses in this network?|Если вы сравните его мысли об этой сети до того, как разбить сеть на подсети, с его мыслями об этой сети после мысленного разбиения сети на подсети, что из следующего произошло с частями структуры адресов в этой сети?
|
a. The subnet part got smaller.|а. Подсеть стала меньше.
|
b. The host part got smaller.|б. Хост-часть уменьшилась.
|
c. The network part got smaller.|c. Сетевая часть стала меньше.
|
d. The host part was removed.|d. Ведущая часть была удалена.
|
e. The network part was removed.|е. Сетевая часть удалена.
|
Foundation Topics|Основные темы
### Introduction to Subnetting
Введение в разделение на подсети   
__|__
--|--
|
Say you just happened to be at the sandwich shop when it was selling the world’s longest sandwich.|Допустим, вы случайно оказались в магазине сэндвичей, когда там продавали самый длинный сэндвич в мире.
You’re pretty hungry, so you go for it.|Вы очень голодны, так что дерзайте.
Now you have one sandwich, but because it’s over 2 kilometers long, you realize it’s a bit more than you need for lunch all by yourself.|Теперь у вас есть один бутерброд, но, поскольку его длина превышает 2 километра, вы понимаете, что это немного больше, чем вам нужно на обед в одиночку.
|
To make the sandwich more useful (and more portable), you chop the sandwich into mealsize pieces and give the pieces to other folks around you who are also ready for lunch.|Чтобы сделать бутерброд более полезным (и более портативным), вы нарезаете его на кусочки размером с обед и отдаете их окружающим, которые также готовы к обеду.
|
Huh?|А?
Well, subnetting, at least the main concept, is similar to this sandwich story.|Ну, подсети, по крайней мере, основная концепция, похожа на эту историю про бутерброд.
You start with one network, but it is just one large network.|Вы начинаете с одной сети, но это всего лишь одна большая сеть.
As a single large entity, it might not be useful, and it is probably far too large.|Как единое целое он может оказаться бесполезным и, вероятно, слишком большим.
To make it useful, you chop it into smaller pieces, called subnets, and assign those subnets to be used in different parts of the enterprise internetwork.|Чтобы сделать его полезным, вы разделяете его на более мелкие части, называемые подсетями, и назначаете эти подсети для использования в различных частях объединенной корпоративной сети.
|
This short first section of the chapter introduces IP subnetting.|Этот короткий первый раздел главы знакомит с разделением IP-подсетей.
First, it shows the general ideas behind a completed subnet design that indeed chops (or subnets) one network into subnets.|Во-первых, он показывает общие идеи, лежащие в основе завершенного проекта подсети, который действительно разбивает (или подсети) одну сеть на подсети.
The rest of this section describes the many design steps that you would take to create just such a subnet design.|В оставшейся части этого раздела описываются многие этапы проектирования, которые необходимо предпринять для создания именно такой схемы подсети.
By the end of this section, you should have the right context to then read through the subnetting design steps introduced throughout the rest of this chapter.|К концу этого раздела у вас должен быть правильный контекст для последующего чтения шагов по проектированию подсетей, представленных в оставшейся части этой главы.
|
NOTE All the chapters from this chapter up until Chapter 22, “Fundamentals of IP Version 6,” focus on IPv4 rather than IPv6.|ПРИМЕЧАНИЕ Все главы от этой главы до главы 22 «Основы IP версии 6» посвящены IPv4, а не IPv6.
All references to IP refer to IPv4 unless otherwise stated.|Все ссылки на IP относятся к IPv4, если не указано иное.
#### Subnetting Defined Through a Simple Example
Определение подсетей на простом примере   
__|__
--|--
|
An IP network—in other words, a Class A, B, or C network—is simply a set of consecutively numbered IP addresses that follows some preset rules.|IP-сеть - другими словами, сеть класса A, B или C - это просто набор последовательно пронумерованных IP-адресов, который следует некоторым предустановленным правилам.
These Class A, B, and C rules define that for a given network, all the addresses in the network have the same value in some of the octets of the addresses.|Эти правила классов A, B и C определяют, что для данной сети все адреса в сети имеют одинаковое значение в некоторых октетах адресов.
For example, Class B network 172.16.0.0 consists of all IP addresses that begin with 172.16: 172.16.0.0, 172.16.0.1, 172.16.0.2, and so on, through 172.16.255.255.|Например, сеть 172.16.0.0 класса B состоит из всех IP-адресов, начинающихся с 172.16: 172.16.0.0, 172.16.0.1, 172.16.0.2 и т. Д. До 172.16.255.255.
|
Another example: Class A network 10.0.0.0 includes all addresses that begin with 10.|Другой пример: сеть класса A 10.0.0.0 включает все адреса, начинающиеся с 10.
|
An IP subnet is simply a subset of a Class A, B, or C network.|Подсеть IP - это просто подмножество сети класса A, B или C.
In fact, the word subnet is a shortened version of the phrase subdivided network.|Фактически, слово «подсеть» - это сокращенная версия словосочетания «разделенная сеть».
For example, one subnet of Class B network 172.16.0.0 could be the set of all IP addresses that begin with 172.16.1, and would include 172.16.1.0, 172.16.1.1, 172.16.1.2, and so on, up through 172.16.1.255.|Например, одна подсеть сети 172.16.0.0 класса B может быть набором всех IP-адресов, которые начинаются с 172.16.1 и включают 172.16.1.0, 172.16.1.1, 172.16.1.2 и т. Д., Вплоть до 172.16.1. 1.255.
Another subnet of that same Class B network could be all addresses that begin with 172.16.2.|В другой подсети той же сети класса B могут быть все адреса, начинающиеся с 172.16.2.
|
To give you a general idea, Figure 11-1 shows some basic documentation from a completed subnet design that could be used when an engineer subnets Class B network 172.16.0.0.|Чтобы дать вам общее представление, на рис. 11-1 показана некоторая базовая документация по завершенному проекту подсети, которая может быть использована, когда инженерная подсеть подключает сеть класса B 172.16.0.0.
|
Figure 11-1 Subnet Plan Document The design shows five subnets—one for each of the three LANs and one each for the two WAN links.|Рисунок 11-1 Документ с планом подсети На схеме показаны пять подсетей - по одной для каждой из трех локальных сетей и по одной для двух каналов глобальной сети.
The small text note shows the rationale used by the engineer for the subnets:|В небольшом текстовом примечании показано обоснование, использованное инженером для подсетей:
|
each subnet includes addresses that have the same value in the first three octets.|каждая подсеть включает адреса, которые имеют одинаковое значение в первых трех октетах.
For example, for the LAN on the left, the number shows 172.16.1.__, meaning “all addresses that begin with 172.16.1.” Also, note that the design, as shown, does not use all the addresses in Class B network 172.16.0.0, so the engineer has left plenty of room for growth.|Например, для LAN слева номер показывает 172.16.1 .__, что означает «все адреса, начинающиеся с 172.16.1». Также обратите внимание, что схема, как показано, не использует все адреса в сети 172.16.0.0 класса B, поэтому инженер оставил достаточно места для роста.
#### Operational View Versus Design View of Subnetting
Рабочее представление по сравнению с представлением проекта разбиения на подсети   
__|__
--|--
|
Most IT jobs require you to work with subnetting from an operational view.|Большинство ИТ-задач требуют, чтобы вы работали с подсетями с операционной точки зрения.
That is, someone else, before you got the job, designed how IP addressing and subnetting would work for that particular enterprise network.|То есть кто-то еще до того, как вы получили эту работу, спроектировал, как IP-адресация и разделение на подсети будут работать для этой конкретной корпоративной сети.
You need to interpret what someone else has already chosen.|Вам нужно интерпретировать то, что уже выбрал кто-то другой.
|
To fully understand IP addressing and subnetting, you need to think about subnetting from both a design and operational perspective.|Чтобы полностью понять IP-адресацию и разбиение на подсети, вам нужно подумать о подсетях как с точки зрения дизайна, так и с точки зрения эксплуатации.
For example, Figure 11-1 simply states that in all these subnets, the first three octets must be equal.|Например, на рис. 11-1 просто указано, что во всех этих подсетях первые три октета должны быть равны.
Why was that convention chosen?|Почему была выбрана эта конвенция?
What alternatives exist?|Какие существуют альтернативы?
Would those alternatives be better for your internetwork today?|Подойдут ли эти альтернативы для вашей совместной сети сегодня?
All these questions relate more to subnetting design rather than to operation.|Все эти вопросы больше относятся к проектированию подсетей, чем к работе.
|
To help you see both perspectives, this chapter focuses more on design issues by moving through the entire design process for the purpose of introducing the bigger picture of IP subnetting.|Чтобы помочь вам увидеть обе точки зрения, в этой главе больше внимания уделяется вопросам проектирования, проходя через весь процесс проектирования с целью представления более широкой картины IP-подсетей.
The next three chapters each take one topic from this chapter and examine it more closely but more from an operational perspective: how to use those ideas in real networks.|Каждая из следующих трех глав берет одну тему из этой главы и исследует ее более подробно, но в большей степени с оперативной точки зрения: как использовать эти идеи в реальных сетях.
|
The remaining three main sections of this chapter examine each of the steps listed in Figure 11-2, in sequence.|В оставшихся трех основных разделах этой главы последовательно исследуется каждый из шагов, перечисленных на рис. 11-2.
|
Figure 11-2 Subnet Planning, Design, and Implementation Tasks|Рисунок 11-2 Задачи планирования, проектирования и реализации подсети
### Analyze Subnetting and Addressing Needs
Анализируйте разбиение на подсети и удовлетворение потребностей   
__|__
--|--
|
This section discusses the meaning of four basic questions that can be used to analyze the addressing and subnetting needs for any new or changing enterprise network:|В этом разделе обсуждается значение четырех основных вопросов, которые можно использовать для анализа потребностей в адресации и подсетях для любой новой или изменяющейся корпоративной сети:
|
1. Which hosts should be grouped together into a subnet?|1. Какие хосты следует объединить в подсеть?
|
2. How many subnets does this internetwork require?|2. Сколько подсетей требуется для этой объединенной сети?
|
3. How many host IP addresses does each subnet require?|3. Сколько IP-адресов хоста требуется каждой подсети?
|
4. Will we use a single subnet size for simplicity, or not?|4. Будем ли мы использовать для простоты единый размер подсети или нет?
#### Rules About Which Hosts Are in Which Subnet
Правила о том, какие хосты находятся в какой подсети   
__|__
--|--
|
Every device that connects to an IP internetwork needs to have an IP address.|Каждое устройство, которое подключается к объединенной IP-сети, должно иметь IP-адрес.
These devices include computers used by end users, servers, mobile phones, laptops, IP phones, tablets, and networking devices like routers, switches, and firewalls.|Эти устройства включают компьютеры, используемые конечными пользователями, серверы, мобильные телефоны, ноутбуки, IP-телефоны, планшеты и сетевые устройства, такие как маршрутизаторы, коммутаторы и брандмауэры.
In short, any device that uses IP to send and receive packets needs an IP address.|Короче говоря, любому устройству, которое использует IP для отправки и получения пакетов, нужен IP-адрес.
|
NOTE In a discussion of IP addressing, the term network has specific meaning: a Class A, B, or C IP network.|ПРИМЕЧАНИЕ. При обсуждении IP-адресации термин сеть имеет особое значение: IP-сеть класса A, B или C.
To avoid confusion with that use of the term network, this book uses the terms internetwork and enterprise network when referring to a collection of hosts, routers, switches, and so on.|Чтобы избежать путаницы с использованием термина «сеть», в этой книге термины «объединенная сеть» и «сеть предприятия» используются для обозначения совокупности хостов, маршрутизаторов, коммутаторов и т. Д.
|
Answers to the “Do I Know This Already?” quiz:|Ответы на вопрос «Знаю ли я это уже?» викторина:
|
1 B, D 2 D 3 B, C 4 A, C 5 A, D, E 6 A, C 7 B The IP addresses must be assigned according to some basic rules—and for good reasons.|1 B, D 2 D 3 B, C 4 A, C 5 A, D, E 6 A, C 7 B IP-адреса должны быть назначены в соответствии с некоторыми основными правилами - и по уважительным причинам.
To make routing work efficiently, IP addressing rules group addresses into groups called subnets.|Чтобы маршрутизация работала эффективно, правила IP-адресации группируют адреса в группы, называемые подсетями.
|
The rules are as follows:|Правила следующие:
###### Addresses in the same subnet are not separated by a router.
Адреса в одной подсети не разделяются маршрутизатором.   
###### Addresses in different subnets are separated by at least one router.
Адреса в разных подсетях разделены хотя бы одним маршрутизатором.   
__|__
--|--
|
Figure 11-3 shows the general concept, with hosts A and B in one subnet and host C in another.|На рис. 11-3 показана общая концепция с хостами A и B в одной подсети и хостом C в другой.
In particular, note that hosts A and B are not separated from each other by any routers.|В частности, обратите внимание, что хосты A и B не отделены друг от друга маршрутизаторами.
|
However, host C, separated from A and B by at least one router, must be in a different subnet.|Однако хост C, отделенный от A и B хотя бы одним маршрутизатором, должен находиться в другой подсети.
|
Figure 11-3 PC A and B in One Subnet and PC C in a Different Subnet The idea that hosts on the same link must be in the same subnet is much like the postal code concept.|Рис. 11-3. Компьютеры A и B в одной подсети, а ПК C в другой подсети. Идея о том, что хосты на одном канале должны находиться в одной подсети, очень похожа на концепцию почтового индекса.
All mailing addresses in the same town use the same postal code (ZIP codes in the United States).|Все почтовые адреса в одном городе используют один и тот же почтовый индекс (почтовые индексы в США).
Addresses in another town, whether relatively nearby or on the other side of the country, have a different postal code.|Адреса в другом городе, относительно близком или на другом конце страны, имеют другой почтовый индекс.
The postal code gives the postal service a better ability to automatically sort the mail to deliver it to the right location.|Почтовый индекс дает почтовой службе лучшую возможность автоматически сортировать почту, чтобы доставить ее в нужное место.
For the same general reasons, hosts on the same LAN are in the same subnet, and hosts in different LANs are in different subnets.|По одним и тем же общим причинам хосты в одной и той же LAN находятся в одной подсети, а хосты в разных LAN находятся в разных подсетях.
|
Note that the point-to-point WAN link in the figure also needs a subnet.|Обратите внимание, что каналу WAN точка-точка на рисунке также нужна подсеть.
Figure 11-3 shows Router R1 connected to the LAN subnet on the left and to a WAN subnet on the right.|На Рис. 11-3 показан маршрутизатор R1, подключенный к подсети LAN слева и к подсети WAN справа.
Router R2 connects to that same WAN subnet.|Маршрутизатор R2 подключается к той же подсети WAN.
To do so, both R1 and R2 will have IP addresses on their WAN interfaces, and the addresses will be in the same subnet. (An Ethernet WAN link has the same IP addressing needs, with each of the two routers having an IP address in the same subnet.)|Для этого и R1, и R2 будут иметь IP-адреса на своих интерфейсах WAN, и эти адреса будут находиться в одной подсети. (Канал Ethernet WAN имеет одинаковые потребности в IP-адресации, при этом каждый из двух маршрутизаторов имеет IP-адрес в одной подсети.)
|
The Ethernet LANs in Figure 11-3 also show a slightly different style of drawing, using simple lines with no Ethernet switch.|Локальные сети Ethernet на рис. 11-3 также показывают немного другой стиль рисования с использованием простых линий без коммутатора Ethernet.
Drawings of Ethernet LANs when the details of the LAN switches do not matter simply show each device connected to the same line, as shown in Figure 11-3. (This kind of drawing mimics the original Ethernet cabling before switches and hubs existed.)|Чертежи локальных сетей Ethernet, когда детали коммутаторов LAN не имеют значения, просто показывают каждое устройство, подключенное к одной и той же линии, как показано на рис. 11-3. (Этот вид чертежа имитирует исходную кабельную сеть Ethernet до того, как существовали коммутаторы и концентраторы.)
|
Finally, because the routers’ main job is to forward packets from one subnet to another, routers typically connect to multiple subnets.|Наконец, поскольку основная задача маршрутизаторов - пересылать пакеты из одной подсети в другую, маршрутизаторы обычно подключаются к нескольким подсетям.
For example, in this case, Router R1 connects to one LAN subnet on the left and one WAN subnet on the right.|Например, в этом случае маршрутизатор R1 подключается к одной подсети LAN слева и одной подсети WAN справа.
To do so, R1 will be configured with two different IP addresses, one per interface.|Для этого R1 будет настроен с двумя разными IP-адресами, по одному на интерфейс.
These addresses will be in different subnets because the interfaces connect the router to different subnets.|Эти адреса будут в разных подсетях, потому что интерфейсы подключают маршрутизатор к разным подсетям.
#### Determining the Number of Subnets
Определение количества подсетей   
__|__
--|--
|
To determine the number of subnets required, the engineer must think about the internetwork as documented and count the locations that need a subnet.|Чтобы определить необходимое количество подсетей, инженер должен подумать об объединенной сети, как задокументировано, и подсчитать места, которым нужна подсеть.
To do so, the engineer requires access to network diagrams, VLAN configuration details, and details about WAN links.|Для этого инженеру требуется доступ к сетевым схемам, сведениям о конфигурации VLAN и сведениям о каналах WAN.
For the types of links discussed in this book, you should plan for one subnet for every|Для типов ссылок, обсуждаемых в этой книге, вы должны запланировать одну подсеть для каждого
###### VLAN
VLAN   
###### Point-to-point serial link
Последовательная связь точка-точка   
###### Ethernet WAN (Ethernet Line Service)
Ethernet WAN (линия Ethernet)   
__|__
--|--
|
NOTE Other WAN technologies outside the scope of the CCNA exam topics allow subnetting options other than one subnet per pair of routers on the WAN (as shown here).|ПРИМЕЧАНИЕ. Другие технологии WAN, выходящие за рамки тем экзамена CCNA, допускают варианты разделения на подсети, отличные от одной подсети на пару маршрутизаторов в WAN (как показано здесь).
However, this book only uses point-to-point WAN technologies—serial links and Ethernet WAN links—|Однако в этой книге используются только технологии WAN точка-точка - последовательные каналы и каналы Ethernet WAN -
|
that have one subnet for each point-to-point WAN connection between two routers.|которые имеют одну подсеть для каждого соединения WAN точка-точка между двумя маршрутизаторами.
|
For example, imagine that the network planner has only Figure 11-4 on which to base the subnet design.|Например, представьте, что у планировщика сети есть только рис. 11-4, на котором можно строить подсеть.
|
Figure 11-4 Four-Site Internetwork with Small Central Site The number of subnets required cannot be fully predicted with only this figure.|Рисунок 11-4 Межсеть с четырьмя узлами и небольшим центральным узлом. Количество необходимых подсетей невозможно полностью предсказать, используя только это число.
Certainly, three subnets will be needed for the WAN links, one per link.|Конечно, для каналов WAN потребуются три подсети, по одной на ссылку.
However, each LAN switch can be configured with a single VLAN or with multiple VLANs. You can be certain that you need at least one subnet for the LAN at each site, but you might need more.|Однако каждый коммутатор LAN может быть настроен как с одной, так и с несколькими VLAN. Вы можете быть уверены, что вам понадобится хотя бы одна подсеть для локальной сети на каждом сайте, но вам может понадобиться и больше.
|
Next, consider the more detailed version of the same figure shown in Figure 11-5.|Затем рассмотрим более подробную версию того же рисунка, показанного на рисунке 11-5.
In this case, the figure shows VLAN counts in addition to the same Layer 3 topology (the routers and the links connected to the routers).|В этом случае на рисунке показано количество VLAN в дополнение к той же топологии уровня 3 (маршрутизаторы и ссылки, подключенные к маршрутизаторам).
It also shows that the central site has many more switches, but the key fact on the left, regardless of how many switches exist, is that the central site has a total of 12 VLANs. Similarly, the figure lists each branch as having two VLANs. Along with the same three WAN subnets, this internetwork requires 21 subnets.|Он также показывает, что на центральном узле гораздо больше коммутаторов, но ключевой факт слева, независимо от того, сколько коммутаторов существует, заключается в том, что на центральном узле всего 12 VLAN. Точно так же на рисунке показано, что каждая ветвь имеет две сети VLAN. Наряду с теми же тремя подсетями WAN, эта объединенная сеть требует 21 подсети.
|
Finally, in a real job, you would consider the needs today as well as how much growth you expect in the internetwork over time.|Наконец, в реальной работе вы должны учитывать потребности сегодня, а также ожидаемый рост межсетевого взаимодействия со временем.
Any subnetting plan should include a reasonable estimate of the number of subnets you need to meet future needs.|Любой план разделения на подсети должен включать разумную оценку количества подсетей, необходимых для удовлетворения будущих потребностей.
|
Figure 11-5 Four-Site Internetwork with Larger Central Site|Рисунок 11-5 Межсетевое соединение с четырьмя сайтами и большим центральным сайтом
#### Determining the Number of Hosts per Subnet
Определение количества хостов в подсети   
__|__
--|--
|
Determining the number of hosts per subnet requires knowing a few simple concepts and then doing a lot of research and questioning.|Для определения количества хостов в подсети необходимо знать несколько простых концепций, а затем провести много исследований и задать вопросы.
Every device that connects to a subnet needs an IP address.|Каждому устройству, которое подключается к подсети, нужен IP-адрес.
For a totally new network, you can look at business plans—numbers of people at the site, devices on order, and so on—to get some idea of the possible devices.|Что касается совершенно новой сети, вы можете посмотреть бизнес-планы - количество людей на сайте, количество заказанных устройств и т. Д. - чтобы получить некоторое представление о возможных устройствах.
When expanding an existing network to add new sites, you can use existing sites as a point of comparison and then find out which sites will get bigger or smaller.|При расширении существующей сети для добавления новых сайтов вы можете использовать существующие сайты в качестве точки сравнения, а затем выяснить, какие сайты станут больше или меньше.
And don’t forget to count the router interface IP address in each subnet and the switch IP address used to remotely manage the switch.|И не забудьте посчитать IP-адрес интерфейса маршрутизатора в каждой подсети и IP-адрес коммутатора, используемый для удаленного управления коммутатором.
|
Instead of gathering data for each and every site, planners often just use a few typical sites for planning purposes.|Вместо того, чтобы собирать данные для каждого сайта, планировщики часто просто используют несколько типичных сайтов для целей планирования.
For example, maybe you have some large sales offices and some small sales offices.|Например, у вас могут быть большие и небольшие офисы продаж.
You might dig in and learn a lot about only one large sales office and only one small sales office.|Вы можете вникнуть в подробности и узнать много нового об одном большом офисе продаж и только одном небольшом офисе продаж.
Add that analysis to the fact that point-to-point links need a subnet with just two addresses, plus any analysis of more one-of-a-kind subnets, and you have enough information to plan the addressing and subnetting design.|Добавьте этот анализ к тому факту, что для соединений «точка-точка» требуется подсеть всего с двумя адресами, плюс любой анализ нескольких уникальных подсетей, и у вас будет достаточно информации для планирования адресации и структуры подсетей.
|
For example, in Figure 11-6, the engineer has built a diagram that shows the number of hosts per LAN subnet in the largest branch, B1. For the two other branches, the engineer did not bother to dig to find out the number of required hosts.|Например, на рис. 11-6 инженер построил диаграмму, на которой показано количество хостов в каждой подсети LAN в самом большом ответвлении, B1. Для двух других веток инженер не стал копать, чтобы узнать количество необходимых хостов.
As long as the number of required IP addresses at sites B2 and B3 stays below the estimate of 50, based on larger site B1, the engineer can plan for 50 hosts in each branch LAN subnet and have plenty of addresses per subnet.|Пока количество требуемых IP-адресов на сайтах B2 и B3 остается ниже оценочного значения 50, основанного на более крупном сайте B1, инженер может запланировать 50 хостов в каждой подсети локальной сети филиала и иметь множество адресов для каждой подсети.
|
Figure 11-6 Large Branch B1 with 50 Hosts/Subnet|Рисунок 11-6 Большая ветвь B1 с 50 хостами в подсети
#### One Size Subnet Fits All—Or Not
Подсеть одного размера подходит всем - или нет   
__|__
--|--
|
The final choice in the initial planning step is to decide whether you will use a simpler design by using a one-size-subnet-fits-all philosophy.|Окончательный выбор на начальном этапе планирования - решить, будете ли вы использовать более простой дизайн, используя философию универсальной подсети, подходящей для всех.
A subnet’s size, or length, is simply the number of usable IP addresses in the subnet.|Размер или длина подсети - это просто количество используемых IP-адресов в подсети.
A subnetting design can either use one size subnet or varied sizes of subnets, with pros and cons for each choice.|В схеме разделения на подсети можно использовать подсеть одного размера или подсети разных размеров, с плюсами и минусами для каждого варианта.
##### Defining the Size of a Subnet
Определение размера подсети   
__|__
--|--
|
Before you finish this book, you will learn all the details of how to determine the size of the subnet.|Прежде чем вы закончите эту книгу, вы узнаете все подробности о том, как определить размер подсети.
For now, you just need to know a few specific facts about the size of subnets.|На данный момент вам просто нужно знать несколько конкретных фактов о размере подсетей.
|
Chapter 12, “Analyzing Classful IPv4 Networks,” and Chapter 13, “Analyzing Subnet Masks,” give you a progressively deeper knowledge of the details.|Глава 12 «Анализ классовых сетей IPv4» и Глава 13 «Анализ масок подсетей» дают вам все более глубокие знания в деталях.
|
The engineer assigns each subnet a subnet mask, and that mask, among other things, defines the size of that subnet.|Инженер назначает каждой подсети маску подсети, и эта маска, среди прочего, определяет размер этой подсети.
The mask sets aside a number of host bits whose purpose is to number different host IP addresses in that subnet.|В маске выделяется ряд битов хоста, целью которых является нумерация различных IP-адресов хоста в этой подсети.
Because you can number 2x things with x bits, if the mask defines H host bits, the subnet contains 2H unique numeric values.|Поскольку вы можете пронумеровать 2x объекта с помощью x битов, если маска определяет H битов хоста, подсеть содержит 2H уникальных числовых значений.
|
However, the subnet’s size is not 2H.|Однако размер подсети не 2H.
It’s 2H – 2 because two numbers in each subnet are reserved for other purposes.|Это 2H - 2, потому что два номера в каждой подсети зарезервированы для других целей.
Each subnet reserves the numerically lowest value for the subnet number and the numerically highest value as the subnet broadcast address.|Каждая подсеть резервирует наименьшее численное значение для номера подсети и наибольшее численное значение в качестве широковещательного адреса подсети.
As a result, the number of usable IP addresses per subnet is 2H – 2.|В результате количество используемых IP-адресов в каждой подсети составляет 2H - 2.
|
NOTE The terms subnet number, subnet ID, and subnet address all refer to the number that represents or identifies a subnet.|ПРИМЕЧАНИЕ Термины «номер подсети», «идентификатор подсети» и «адрес подсети» относятся к числу, которое представляет или идентифицирует подсеть.
|
Figure 11-7 shows the general concept behind the three-part structure of an IP address, focusing on the host part and the resulting subnet size.|На рис. 11-7 показана общая концепция трехчастной структуры IP-адреса с акцентом на хост-часть и результирующий размер подсети.
|
Figure 11-7 Subnet Size Concepts|Рисунок 11-7 Понятия размера подсети
##### One Size Subnet Fits All
Подсеть одного размера для всех   
__|__
--|--
|
To choose to use a single-size subnet in an enterprise network, you must use the same mask for all subnets because the mask defines the size of the subnet.|Чтобы выбрать использование подсети одного размера в корпоративной сети, необходимо использовать одну и ту же маску для всех подсетей, поскольку маска определяет размер подсети.
But which mask?|Но какая маска?
|
One requirement to consider when choosing that one mask is this: that one mask must provide enough host IP addresses to support the largest subnet.|Одно требование, которое следует учитывать при выборе этой маски, заключается в следующем: одна маска должна предоставлять достаточно IP-адресов хоста для поддержки самой большой подсети.
To do so, the number of host bits (H) defined by the mask must be large enough so that 2H – 2 is larger than (or equal to)|Для этого количество битов хоста (H), определяемое маской, должно быть достаточно большим, чтобы 2H - 2 было больше (или равно)
|
the number of host IP addresses required in the largest subnet.|количество IP-адресов хоста, необходимых в самой большой подсети.
|
For example, consider Figure 11-8.|Например, рассмотрим рисунок 11-8.
It shows the required number of hosts per LAN subnet.|Он показывает необходимое количество хостов в каждой подсети LAN.
|
(The figure ignores the subnets on the WAN links, which require only two IP addresses each.) The branch LAN subnets require only 50 host addresses, but the main site LAN subnet requires 200 host addresses.|(На рисунке не учитываются подсети в каналах глобальной сети, для каждой из которых требуется только два IP-адреса.) Для подсетей локальной сети филиала требуется только 50 адресов узлов, но для подсети локальной сети основного сайта требуется 200 адресов узлов.
To accommodate the largest subnet, you need at least 8 host bits.|Для размещения самой большой подсети вам потребуется не менее 8 бит хоста.
Seven host bits would not be enough because 27 – 2 = 126.|Семи битов хоста было бы недостаточно, потому что 27-2 = 126.
Eight host bits would be enough because 28 – 2 = 254, which is more than enough to support 200 hosts in a subnet.|Восемь битов хоста будет достаточно, потому что 28-2 = 254, что более чем достаточно для поддержки 200 хостов в подсети.
|
Figure 11-8 Network Using One Subnet Size What’s the big advantage when using a single-size subnet?|Рисунок 11-8 Сеть с использованием подсети одного размера В чем большое преимущество при использовании подсети одного размера?
Operational simplicity.|Простота эксплуатации.
In other words, keeping it simple.|Другими словами, все просто.
Everyone on the IT staff who has to work with networking can get used to working with one mask—and one mask only.|Каждый ИТ-персонал, которому приходится работать с сетями, может привыкнуть к работе с одной маской - и только с одной маской.
Staff members will be able to answer all subnetting questions more easily because everyone gets used to doing subnetting math with that one mask.|Сотрудники смогут легче ответить на все вопросы о подсетях, потому что все привыкли выполнять математические вычисления с подсетями с этой единственной маской.
|
The big disadvantage for using a single-size subnet is that it wastes IP addresses.|Большой недостаток использования подсети одного размера заключается в том, что она тратит впустую IP-адреса.
For example, in Figure 11-8, all the branch LAN subnets support 254 addresses, while the largest branch subnet needs only 50 addresses.|Например, на рис. 11-8 все подсети LAN филиала поддерживают 254 адреса, в то время как подсеть самого большого филиала требует только 50 адресов.
The WAN subnets only need two IP addresses, but each supports 254 addresses, again wasting more IP addresses.|Подсети WAN нуждаются только в двух IP-адресах, но каждый поддерживает 254 адреса, снова тратя впустую больше IP-адресов.
|
The wasted IP addresses do not actually cause a problem in most cases, however.|Однако в большинстве случаев потраченные впустую IP-адреса на самом деле не вызывают проблем.
Most organizations use private IP networks in their enterprise internetworks, and a single Class A or Class B private network can supply plenty of IP addresses, even with the waste.|Большинство организаций используют частные IP-сети в своих корпоративных объединенных сетях, и одна частная сеть класса A или класса B может предоставить множество IP-адресов, даже с отходами.
##### Multiple Subnet Sizes (Variable-Length Subnet Masks)
Несколько размеров подсети (маски подсети переменной длины)   
__|__
--|--
|
To create multiple sizes of subnets in one Class A, B, or C network, the engineer must create some subnets using one mask, some with another, and so on.|Чтобы создать подсети нескольких размеров в одной сети класса A, B или C, инженер должен создать несколько подсетей, используя одну маску, некоторые - другую, и так далее.
Different masks mean different numbers of host bits, and a different number of hosts in some subnets based on the 2H – 2 formula.|Разные маски означают разное количество битов хоста и разное количество хостов в некоторых подсетях на основе формулы 2H - 2.
|
For example, consider the requirements listed earlier in Figure 11-8.|Например, рассмотрим требования, перечисленные ранее на рисунке 11-8.
It showed one LAN subnet on the left that needs 200 host addresses, three branch subnets that need 50 addresses, and three WAN links that need two addresses.|Слева была показана одна подсеть LAN, для которой требуется 200 адресов узлов, три подсети ответвления, которым требуется 50 адресов, и три канала WAN, которым требуется два адреса.
To meet those needs, but waste fewer IP addresses, three subnet masks could be used, creating subnets of three different sizes, as shown in Figure 11-9.|Чтобы удовлетворить эти потребности, но не тратить меньше IP-адресов, можно использовать три маски подсети, создавая подсети трех разных размеров, как показано на рисунке 11-9.
|
Figure 11-9 Three Masks, Three Subnet Sizes The smaller subnets now waste fewer IP addresses compared to the design shown earlier in Figure 11-8.|Рисунок 11-9 Три маски, три размера подсети Теперь в меньших подсетях расходуется меньше IP-адресов по сравнению с схемой, показанной ранее на Рисунке 11-8.
The subnets on the right that need 50 IP addresses have subnets with 6 host bits, for 26 – 2 = 62 available addresses per subnet.|Подсети справа, которым требуется 50 IP-адресов, имеют подсети с 6 битами хоста, для 26-2 = 62 доступных адреса на подсеть.
The WAN links use masks with 2 host bits, for 22 – 2 = 2 available addresses per subnet.|В каналах WAN используются маски с 2 битами хоста, для 22-2 = 2 доступных адреса на подсеть.
|
However, some are still wasted because you cannot set the size of the subnet as some arbitrary size.|Однако некоторые из них по-прежнему теряются, потому что вы не можете установить произвольный размер подсети.
All subnets will be a size based on the 2H – 2 formula, with H being the number of host bits defined by the mask for each subnet.|Все подсети будут иметь размер, основанный на формуле 2H - 2, где H - количество бит хоста, определенное маской для каждой подсети.
##### One Mask for All Subnets, or More Than One
Одна маска для всех подсетей или более одной   
__|__
--|--
|
For the most part, this book explains subnetting using designs that use a single mask, creating a single subnet size for all subnets.|По большей части в этой книге объясняется разбиение на подсети с использованием схем, использующих единую маску, что создает единый размер подсети для всех подсетей.
Why?|Зачем?
First, it makes the process of learning subnetting easier.|Во-первых, это упрощает процесс изучения подсетей.
Second, some types of analysis that you can do about a network—specifically, calculating the number of subnets in the classful network—only make sense when a single mask is used.|Во-вторых, некоторые типы анализа сети, в частности, подсчет количества подсетей в классовой сети, имеют смысл только при использовании одной маски.
|
However, you still need to be ready to work with designs that use more than one mask in different subnets of the same Class A, B, or C network.|Однако вам все равно нужно быть готовым к работе с проектами, в которых используется более одной маски в разных подсетях одной и той же сети класса A, B или C.
In fact, a design that does just that is said to be using variable-length subnet masks (VLSM). For example, the internetwork in Figure 11-10 shows 11 subnets, two with a mask of /30, and nine with a mask of /24.|Фактически, конструкция, которая делает именно это, называется использованием масок подсети переменной длины (VLSM). Например, объединенная сеть на Рисунке 11-10 показывает 11 подсетей, две с маской / 30 и девять с маской / 24.
By using more than one mask among all the subnets of one Class A network (10.0.0.0), the design uses VLSM.|Используя более одной маски среди всех подсетей одной сети класса A (10.0.0.0), в проекте используется VLSM.
|
Figure 11-10 Internetwork with VLSM: Network 10.0.0.0, >1 Mask For the current CCNA 200-301 exam, using VLSM causes no issues, although it does cause problems with some older routing protocols.|Рис. 11-10 Межсетевое взаимодействие с VLSM: Сеть 10.0.0.0,> 1 маска Для текущего экзамена CCNA 200-301 использование VLSM не вызывает проблем, хотя и вызывает проблемы с некоторыми старыми протоколами маршрутизации.
The only routing protocol included in the CCNA blueprint (OSPF) works the same regardless of whether the design uses VLSM. Just be aware of the term and what it means and that it should not impact the features included in the current CCNA exam.|Единственный протокол маршрутизации, включенный в схему CCNA (OSPF), работает одинаково независимо от того, использует ли проект VLSM. Просто имейте в виду этот термин и его значение, и что он не должен влиять на функции, включенные в текущий экзамен CCNA.
|
NOTE VLSM has been featured in the CCNA exam topics in the past.|ПРИМЕЧАНИЕ VLSM уже упоминался в темах экзаменов CCNA в прошлом.
If you want to read a little more about VLSM, check out Appendix N, “Variable-Length Subnet Masks,” on the companion website for this book.|Если вы хотите узнать больше о VLSM, посмотрите Приложение N «Маски подсети переменной длины» на сопутствующем веб-сайте этой книги.
### Make Design Choices
Сделайте выбор дизайна   
__|__
--|--
|
Now that you know how to analyze the IP addressing and subnetting needs, the next major step examines how to apply the rules of IP addressing and subnetting to those needs and make some choices.|Теперь, когда вы знаете, как анализировать потребности в IP-адресации и разделении на подсети, следующим важным шагом будет изучение того, как применить правила IP-адресации и разделения в подсети к этим потребностям и сделать некоторые варианты.
In other words, now that you know how many subnets you need and how many host addresses you need in the largest subnet, how do you create a useful subnetting design that meets those requirements?|Другими словами, теперь, когда вы знаете, сколько подсетей вам нужно и сколько адресов узлов вам нужно в самой большой подсети, как создать полезный дизайн подсетей, отвечающий этим требованиям?
The short answer is that you need to do the three tasks shown on the right side of Figure 11-11.|Короткий ответ: вам нужно выполнить три задачи, показанные в правой части рисунка 11-11.
|
Figure 11-11 Input to the Design Phase, and Design Questions to Answer|Рисунок 11-11 Исходные данные на этапе проектирования и вопросы проектирования, на которые нужно ответить
#### Choose a Classful Network
Выберите классную сеть   
__|__
--|--
|
In the original design for what we know of today as the Internet, companies used registered public classful IP networks when implementing TCP/IP inside the company.|В первоначальном дизайне того, что мы знаем сегодня как Интернет, компании использовали зарегистрированные общедоступные классовые IP-сети при реализации TCP / IP внутри компании.
By the mid-1990s, an alternative became more popular: private IP networks.|К середине 1990-х годов более популярной стала альтернатива: частные IP-сети.
This section discusses the background behind these two choices because it impacts the choice of what IP network a company will then subnet and implement in its enterprise internetwork.|В этом разделе обсуждается предыстория этих двух вариантов, поскольку они влияют на выбор IP-сети, которую компания затем будет использовать в подсети и внедрить в свою корпоративную объединенную сеть.
##### Public IP Networks
Публичные IP-сети   
__|__
--|--
|
The original design of the Internet required that any company that connected to the Internet had to use a registered public IP network.|Первоначальный дизайн Интернета требовал, чтобы любая компания, подключенная к Интернету, использовала зарегистрированную общедоступную IP-сеть.
To do so, the company would complete some paperwork, describing the enterprise’s internetwork and the number of hosts existing, plus plans for growth.|Для этого компания заполняла некоторые документы, описывая объединенную сеть предприятия и количество существующих хостов, а также планы роста.
After submitting the paperwork, the company would receive an assignment of either a Class A, B, or C network.|После подачи документов компания получит назначение сети класса A, B или C.
|
Public IP networks—and the administrative processes surrounding them—ensure that all the companies that connect to the Internet all use unique IP addresses.|Публичные IP-сети и связанные с ними административные процессы гарантируют, что все компании, подключенные к Интернету, используют уникальные IP-адреса.
In particular, after a public IP network is assigned to a company, only that company should use the addresses in that network.|В частности, после того, как публичная IP-сеть назначена компании, только эта компания должна использовать адреса в этой сети.
That guarantee of uniqueness means that Internet routing can work well because there are no duplicate public IP addresses.|Эта гарантия уникальности означает, что маршрутизация в Интернете может работать хорошо, потому что нет повторяющихся общедоступных IP-адресов.
|
For example, consider the example shown in Figure 11-12.|Например, рассмотрим пример, показанный на рисунке 11-12.
Company 1 has been assigned public Class A network 1.0.0.0, and company 2 has been assigned public Class A network|Компании 1 присвоена общедоступная сеть класса A 1.0.0.0, а компании 2 - общедоступная сеть класса А.
###### 2.0.0.0. Per the original intent for public addressing in the Internet, after these public network
2.0.0.0. Согласно первоначальному замыслу публичной адресации в Интернете, после этих публичных сетей   
__|__
--|--
|
assignments have been made, no other companies can use addresses in Class A networks|назначения выполнены, никакие другие компании не могут использовать адреса в сетях класса А
###### 1.0.0.0 or 2.0.0.0.
1.0.0.0 или 2.0.0.0.   
__|__
--|--
|
Figure 11-12 Two Companies with Unique Public IP Networks This original address assignment process ensured unique IP addresses across the entire planet.|Рис. 11-12. Две компании с уникальными общедоступными IP-сетями. Этот первоначальный процесс назначения адресов обеспечил уникальные IP-адреса по всей планете.
|
The idea is much like the fact that your telephone number should be unique in the universe, your postal mailing address should also be unique, and your email address should also be unique.|Идея во многом схожа с тем, что ваш номер телефона должен быть уникальным во вселенной, ваш почтовый почтовый адрес также должен быть уникальным, и ваш адрес электронной почты также должен быть уникальным.
If someone calls you, your phone rings, but no one else’s phone rings.|Если кто-то звонит вам, ваш телефон звонит, но никто не звонит.
Similarly, if company 1 is assigned Class A network 1.0.0.0, and the engineers at Company 1 assign address 1.1.1.1 to a particular PC, that address should be unique in the universe.|Аналогично, если компании 1 назначена сеть 1.0.0.0 класса A, а инженеры компании 1 назначают адрес 1.1.1.1 конкретному ПК, этот адрес должен быть уникальным во вселенной.
A packet sent through the Internet to destination 1.1.1.1 should only arrive at this one PC inside company 1, instead of being delivered to some other host.|Пакет, отправленный через Интернет в пункт назначения 1.1.1.1, должен прибыть только на этот компьютер внутри компании 1, а не на какой-либо другой хост.
##### Growth Exhausts the Public IP Address Space
Рост исчерпывает пространство общедоступных IP-адресов   
__|__
--|--
|
By the early 1990s, the world was running out of public IP networks that could be assigned.|К началу 1990-х годов в мире заканчивались общедоступные IP-сети, которые можно было назначить.
|
During most of the 1990s, the number of hosts newly connected to the Internet was growing at a double-digit pace per month.|В течение большей части 1990-х количество хостов, вновь подключенных к Интернету, росло двузначными темпами в месяц.
Companies kept following the rules, asking for public IP networks, and it was clear that the current address-assignment scheme could not continue without some changes.|Компании продолжали следовать правилам, запрашивая публичные IP-сети, и было ясно, что текущая схема назначения адресов не может продолжаться без некоторых изменений.
Simply put, the number of Class A, B, and C networks supported by the 32-bit address in IP version 4 (IPv4) was not enough to support one public classful network per organization, while also providing enough IP addresses in each company.|Проще говоря, количество сетей класса A, B и C, поддерживаемых 32-битным адресом в IP версии 4 (IPv4), было недостаточным для поддержки одной общедоступной классовой сети на организацию, а также предоставления достаточного количества IP-адресов в каждой компании.
|
NOTE The universe has run out of public IPv4 addresses in a couple of significant ways.|ПРИМЕЧАНИЕ. В юниверсе закончились общедоступные адреса IPv4 по нескольким важным причинам.
|
IANA, which assigns public IPv4 address blocks to the five Regional Internet Registries (RIR) around the globe, assigned the last of the IPv4 address spaces in early 2011.|IANA, которая назначает блоки общедоступных адресов IPv4 пяти региональным интернет-реестрам (RIR) по всему миру, назначила последнее из адресных пространств IPv4 в начале 2011 года.
By 2015, ARIN, the RIR for North America, exhausted its supply of IPv4 addresses, so companies must return unused public IPv4 addresses to ARIN before they have more to assign to new companies.|К 2015 году ARIN, RIR для Северной Америки, исчерпал свой запас адресов IPv4, поэтому компании должны возвращать неиспользуемые общедоступные адреса IPv4 в ARIN, прежде чем они смогут назначить новые адреса новым компаниям.
Try an online search for “ARIN depletion” to see pages about the current status of available IPv4 address space for just one RIR example.|Попробуйте выполнить поиск в Интернете по запросу «Истощение ARIN», чтобы просмотреть страницы о текущем состоянии доступного адресного пространства IPv4 только для одного примера RIR.
|
The Internet community worked hard during the 1990s to solve this problem, coming up with several solutions, including the following:|Интернет-сообщество упорно работал в течение 1990-х годов, чтобы решить эту проблему, придумывая несколько решений, включая следующие:
###### A new version of IP (IPv6), with much larger addresses (128 bit)
Новая версия IP (IPv6) с гораздо большими адресами (128 бит)   
###### Assigning a subset of a public IP network to each company, instead of an entire public IP
Назначение подмножества общедоступной IP-сети каждой компании вместо всего общедоступного IP-адреса   
__|__
--|--
|
network, to reduce waste, using a feature called “Classless Interdomain Routing” (CIDR)|сеть, чтобы уменьшить потери, используя функцию под названием «Бесклассовая междоменная маршрутизация» (CIDR)
###### Network Address Translation (NAT), which allows the use of private IP networks
Трансляция сетевых адресов (NAT), которая позволяет использовать частные IP-сети   
__|__
--|--
|
These three solutions matter to real networks today.|Эти три решения важны для реальных сетей сегодня.
However, to stay focused on the topic of subnet design, this chapter focuses on the third option, and in particular, the private IP networks that can be used by an enterprise when also using NAT. (Be aware that Chapter more detail about the last two bullets in the list, while Part VII of this book discusses the first bullet item (IPv6) in more depth.|Однако, чтобы сосредоточиться на теме проектирования подсети, в этой главе основное внимание уделяется третьему варианту и, в частности, частным IP-сетям, которые могут использоваться предприятием при использовании NAT. (Имейте в виду, что в этой главе более подробно рассматриваются последние два маркера в списке, а в части VII этой книги более подробно рассматривается первый маркер (IPv6).
|
Focusing on the third item in the bullet list, NAT allows multiple companies to use the exact same private IP network, using the same IP addresses as other companies while still connecting to the Internet.|Сосредоточившись на третьем пункте в маркированном списке, NAT позволяет нескольким компаниям использовать одну и ту же частную IP-сеть, используя те же IP-адреса, что и другие компании, при этом при подключении к Интернету.
For example, Figure 11-13 shows the same two companies connecting to the Internet as in Figure 11-12, but now with both using the same private Class A network 10.0.0.0.|Например, на рис. 11-13 показаны те же две компании, которые подключаются к Интернету, что и на рис. 11-12, но теперь обе используют одну и ту же частную сеть класса A 10.0.0.0.
|
Figure 11-13 Reusing the Same Private Network 10.0.0.0 with NAT Both companies use the same classful IP network (10.0.0.0).|Рисунок 11-13 Повторное использование одной и той же частной сети 10.0.0.0 с NAT Обе компании используют одну и ту же классовую IP-сеть (10.0.0.0).
Both companies can implement their subnet design internal to their respective enterprise internetworks, without discussing their plans.|Обе компании могут реализовать свою структуру подсети внутри своих соответствующих корпоративных межсетевых сетей, не обсуждая свои планы.
The two companies can even use the exact same IP addresses inside network|Обе компании могут даже использовать одни и те же IP-адреса внутри сети.
###### 10.0.0.0. And amazingly, at the same time, both companies can even communicate with each
10.0.0.0. И что удивительно, в то же время обе компании могут даже общаться друг с другом.   
__|__
--|--
|
other through the Internet.|прочее через Интернет.
|
The technology called Network Address Translation makes it possible for companies to reuse the same IP networks, as shown in Figure 11-13.|Технология, называемая преобразованием сетевых адресов, позволяет компаниям повторно использовать одни и те же IP-сети, как показано на рис. 11-13.
NAT does this by translating the IP addresses inside the packets as they go from the enterprise to the Internet, using a small number of public IP addresses to support tens of thousands of private IP addresses.|NAT делает это путем преобразования IP-адресов внутри пакетов по мере их передачи от предприятия в Интернет, используя небольшое количество общедоступных IP-адресов для поддержки десятков тысяч частных IP-адресов.
That one bit of information is not enough to understand how NAT works; however, to keep the focus on subnetting, the book defers the discussion of how NAT works until CCNA 200-301 Official Cert Guide, Volume 2.|Одного бита информации недостаточно, чтобы понять, как работает NAT; однако, чтобы сосредоточить внимание на подсетях, в книге обсуждение того, как работает NAT, откладывается до CCNA 200-301 Official Cert Guide, Volume 2.
For now, accept that most companies use NAT, and therefore, they can use private IP networks for their internetworks.|А пока согласитесь с тем, что большинство компаний используют NAT, и, следовательно, они могут использовать частные IP-сети для своих объединенных сетей.
##### Private IP Networks
Частные IP-сети   
__|__
--|--
|
When using NAT—and almost every organization that connects to the Internet uses NAT—the company can simply pick one or more of the private IP networks from the list of reserved private IP network numbers.|При использовании NAT - а почти каждая организация, которая подключается к Интернету, использует NAT - компания может просто выбрать одну или несколько частных IP-сетей из списка зарезервированных номеров частных IP-сетей.
RFC 1918 defines the list of available private IP networks, which is summarized in Table 11-2.|RFC 1918 определяет список доступных частных IP-сетей, который сведен в Таблицу 11-2.
|
Table 11-2 RFC 1918 Private Address Space Table end.|Таблица 11-2 Конец таблицы частного адресного пространства RFC 1918.
|
NOTE According to an informal survey I ran on my blog a few years back, about half of the respondents said that their networks use private Class A network 10.0.0.0, as opposed to other private networks or public networks.|ПРИМЕЧАНИЕ. Согласно неофициальному опросу, который я провел в своем блоге несколько лет назад, около половины респондентов заявили, что их сети используют частную сеть класса A 10.0.0.0, в отличие от других частных сетей или общедоступных сетей.
|
From the perspective of making IPv4 work for the entire world, private IP networks have helped preserve and extend IPv4 and its use in every enterprise and throughout the Internet.|С точки зрения обеспечения работы IPv4 для всего мира, частные IP-сети помогли сохранить и расширить IPv4 и его использование на каждом предприятии и во всем Интернете.
|
In particular, private networks have improved IPv4’s implementation worldwide by|В частности, частные сети улучшили реализацию IPv4 во всем мире за счет
###### Avoiding Using Another Organization’s Public Address Range for Private Networks:
Избегайте использования диапазона публичных адресов другой организации для частных сетей:   
__|__
--|--
|
Some organizations have a part of their networks that need zero Internet access.|Некоторые организации имеют часть своих сетей, для которой не требуется доступ в Интернет.
The hosts in that part of their network need IP addresses.|Хостам в этой части сети нужны IP-адреса.
RFC 1918 suggests that truly private networks—that is, networks with no need for Internet connectivity—use addresses from the RFC 1918 list of private networks.|RFC 1918 предполагает, что действительно частные сети, то есть сети, не требующие подключения к Интернету, используют адреса из списка частных сетей RFC 1918.
###### Avoiding/Delaying IPv4 Address Exhaustion: To delay the day in which all public IPv4
Предотвращение / задержка исчерпания адресов IPv4: чтобы отложить день, когда все общедоступные IPv4   
__|__
--|--
|
addresses were assigned to organizations as public addresses, RFC 1918 calls for the use of NAT along with private networks for the addresses internal to an organization.|Адреса назначались организациям как общедоступные, RFC 1918 призывает использовать NAT наряду с частными сетями для адресов, внутренних по отношению к организации.
###### Reducing Internet Routers’ Routing Table Size: Using private networks also helps reduce
Уменьшение размера таблицы маршрутизации интернет-маршрутизаторов: использование частных сетей также помогает уменьшить   
__|__
--|--
|
the size of the IP routing tables in Internet routers.|размер таблиц IP-маршрутизации в Интернет-маршрутизаторах.
For instance, routers in the Internet do not need routes for the private IP networks used inside organizations (in fact, ISPs filter those routes).|Например, маршрутизаторам в Интернете не нужны маршруты для частных IP-сетей, используемых внутри организаций (фактически, интернет-провайдеры фильтруют эти маршруты).
##### Choosing an IP Network During the Design Phase
Выбор IP-сети на этапе проектирования   
__|__
--|--
|
Today, some organizations use private IP networks along with NAT, and some use public IP networks.|Сегодня некоторые организации используют частные IP-сети вместе с NAT, а некоторые используют общедоступные IP-сети.
Most new enterprise internetworks use private IP addresses throughout the network, along with NAT, as part of the connection to the Internet.|Большинство новых корпоративных объединенных сетей используют частные IP-адреса по всей сети вместе с NAT как часть подключения к Интернету.
Those organizations that already have registered public IP networks—often obtained before the addresses started running short in the early 1990s—can continue to use those public addresses throughout their enterprise networks.|Те организации, которые уже зарегистрировали общедоступные IP-сети - часто полученные до того, как в начале 1990-х годов начался дефицит адресов, - могут продолжать использовать эти общедоступные адреса в своих корпоративных сетях.
|
After the choice to use a private IP network has been made, just pick one that has enough IP addresses.|После того, как был сделан выбор в пользу использования частной IP-сети, просто выберите ту, у которой достаточно IP-адресов.
You can have a small internetwork and still choose to use private Class A network|Вы можете иметь небольшую объединенную сеть и по-прежнему использовать частную сеть класса А.
###### 10.0.0.0. It might seem wasteful to choose a Class A network that has over 16 million IP
10.0.0.0. Выбор сети класса A с более чем 16 миллионами IP-адресов может показаться расточительным.   
__|__
--|--
|
addresses, especially if you need only a few hundred.|адресов, особенно если вам нужно всего несколько сотен.
However, there’s no penalty or problem with using a private network that is too large for your current or future needs.|Однако нет никаких штрафов или проблем с использованием частной сети, которая слишком велика для ваших текущих или будущих потребностей.
|
For the purposes of this book, most examples use private IP network numbers.|Для целей этой книги в большинстве примеров используются номера частных IP-сетей.
For the design step to choose a network number, just choose a private Class A, B, or C network from the list of RFC 1918 private networks.|Чтобы на этапе проектирования выбрать номер сети, просто выберите частную сеть класса A, B или C из списка частных сетей RFC 1918.
|
Regardless, from a math and concept perspective, the methods to subnet a public IP network versus a private IP network are the same.|Тем не менее, с математической и концептуальной точки зрения методы подсети общедоступной IP-сети и частной IP-сети одинаковы.
#### Choose the Mask
Выберите маску   
__|__
--|--
|
If a design engineer followed the topics in this chapter so far, in order, he would know the following:|Если бы инженер-конструктор до сих пор следовал темам этой главы по порядку, он бы знал следующее:
###### The number of subnets required
Количество необходимых подсетей   
###### The number of hosts/subnet required
Требуемое количество хостов / подсети   
###### That a choice was made to use only one mask for all subnets so that all subnets are the
Было решено использовать только одну маску для всех подсетей, чтобы все подсети были   
__|__
--|--
|
same size (same number of hosts/subnet)|одинаковый размер (такое же количество хостов в подсети)
###### The classful IP network number that will be subnetted
Классовый номер IP-сети, которая будет разбита на подсети.   
__|__
--|--
|
This section completes the design process, at least the parts described in this chapter, by discussing how to choose that one mask to use for all subnets.|В этом разделе завершается процесс проектирования, по крайней мере, частей, описанных в этой главе, путем обсуждения того, как выбрать эту маску для использования для всех подсетей.
First, this section examines default masks, used when a network is not subnetted, as a point of comparison.|Во-первых, в этом разделе исследуются маски по умолчанию, используемые, когда сеть не разделена на подсети, в качестве точки сравнения.
Next, the concept of borrowing host bits to create subnet bits is explored.|Затем исследуется концепция заимствования битов хоста для создания битов подсети.
Finally, this section ends with an example of how to create a subnet mask based on the analysis of the requirements.|Наконец, этот раздел заканчивается примером того, как создать маску подсети на основе анализа требований.
##### Classful IP Networks Before Subnetting
Классовые IP-сети до разделения на подсети   
__|__
--|--
|
Before an engineer subnets a classful network, the network is a single group of addresses.|Перед тем, как инженер подсети классовой сети, сеть представляет собой единую группу адресов.
|
In other words, the engineer has not yet subdivided the network into many smaller subsets called subnets.|Другими словами, инженер еще не разделил сеть на множество более мелких подмножеств, называемых подсетями.
|
When thinking about an unsubnetted classful network, the addresses in a network have only two parts: the network part and host part.|Когда мы думаем о классовой сети без подсетей, адреса в сети состоят только из двух частей: сетевой части и хостовой части.
Comparing any two addresses in the classful network:|Сравнение любых двух адресов в классовой сети:
###### The addresses have the same value in the network part.
Адреса имеют одинаковое значение в сетевой части.   
###### The addresses have different values in the host part.
Адреса имеют разные значения в части хоста.   
__|__
--|--
|
The actual sizes of the network and host part of the addresses in a network can be easily predicted, as shown in Figure 11-14.|Фактические размеры сети и узловых адресов в сети можно легко предсказать, как показано на рисунке 11-14.
|
Figure 11-14 Format of Unsubnetted Class A, B, and C Networks In Figure 11-14, N and H represent the number of network and host bits, respectively.|Рисунок 11-14 Формат сетей классов A, B и C без подсетей На рисунке 11-14 N и H представляют количество битов сети и хоста, соответственно.
Class rules define the number of network octets (1, 2, or 3) for Classes A, B, and C, respectively;|Правила класса определяют количество сетевых октетов (1, 2 или 3) для классов A, B и C соответственно;
|
the figure shows these values as a number of bits.|на рисунке эти значения показаны в виде числа битов.
The number of host octets is 3, 2, or 1, respectively.|Число октетов хоста равно 3, 2 или 1 соответственно.
|
Continuing the analysis of classful network before subnetting, the number of addresses in one classful IP network can be calculated with the same 2H – 2 formula previously discussed.|Продолжая анализ классовой сети до разбиения на подсети, количество адресов в одной классовой IP-сети можно рассчитать с помощью той же формулы 2H - 2, обсуждавшейся ранее.
|
In particular, the size of an unsubnetted Class A, B, or C network is as follows:|В частности, размер сети классов A, B или C без подсетей следующий:
###### Class A: 224 – 2 = 16,777,214
Класс A: 224 - 2 = 16 777 214   
###### Class B: 216 – 2 = 65,534
Класс B: 216 - 2 = 65 534   
###### Class C: 28 – 2 = 254
Класс C: 28 - 2 = 254   
##### Borrowing Host Bits to Create Subnet Bits
Заимствование битов хоста для создания битов подсети   
__|__
--|--
|
To subnet a network, the designer thinks about the network and host parts, as shown in Figure 11-15, and then the engineer adds a third part in the middle: the subnet part.|Чтобы подсеть сеть, разработчик думает о частях сети и хоста, как показано на рис. 11-15, а затем инженер добавляет третью часть посередине: часть подсети.
However, the designer cannot change the size of the network part or the size of the entire address (32 bits).|Однако разработчик не может изменить размер сетевой части или размер всего адреса (32 бита).
To create a subnet part of the address structure, the engineer borrows bits from the host part.|Чтобы создать часть структуры адреса подсети, инженер заимствует биты из части хоста.
Figure 11-15 shows the general idea.|На рис. 11-15 показана общая идея.
|
Figure 11-15 Concept of Borrowing Host Bits Figure 11-15 shows a rectangle that represents the subnet mask.|Рис. 11-15. Концепция заимствования битов хоста. На рис. 11-15 показан прямоугольник, представляющий маску подсети.
N, representing the number of network bits, remains locked at 8, 16, or 24, depending on the class.|N, представляющий количество сетевых битов, остается заблокированным на 8, 16 или 24, в зависимости от класса.
Conceptually, the designer moves a (dashed) dividing line into the host field, with subnet bits (S) between the network and host parts, and the remaining host bits (H) on the right.|Концептуально разработчик перемещает (пунктирную) разделительную линию в поле хоста с битами подсети (S) между сетью и частями хоста, а оставшиеся биты хоста (H) справа.
The three parts must add up to 32 because IPv4 addresses consist of 32 bits.|Сумма трех частей должна составлять 32, потому что адреса IPv4 состоят из 32 бит.
##### Choosing Enough Subnet and Host Bits
Выбор достаточного количества битов подсети и хоста   
__|__
--|--
|
The design process requires a choice of where to place the dashed line shown in Figure 11-15.|В процессе проектирования необходимо выбрать место для размещения пунктирной линии, показанной на рисунке 11-15.
But what is the right choice?|Но каков правильный выбор?
How many subnet and host bits should the designer choose?|Сколько бит подсети и хоста должен выбрать дизайнер?
The answers hinge on the requirements gathered in the early stages of the planning process:|Ответы зависят от требований, собранных на ранних этапах процесса планирования:
###### Number of subnets required
Требуемое количество подсетей   
###### Number of hosts/subnet
Количество хостов / подсеть   
__|__
--|--
|
The bits in the subnet part create a way to uniquely number the different subnets that the design engineer wants to create.|Биты в части подсети позволяют однозначно пронумеровать различные подсети, которые инженер-проектировщик хочет создать.
With 1 subnet bit, you can number 21 or 2 subnets.|С 1 битом подсети вы можете пронумеровать 21 или 2 подсети.
With 2 bits, 22 or 4 subnets, with 3 bits, 23 or 8 subnets, and so on.|С 2 битами, 22 или 4 подсетями, с 3 битами, 23 или 8 подсетями и т. Д.
The number of subnet bits must be large enough to uniquely number all the subnets, as determined during the planning process.|Количество битов подсети должно быть достаточно большим, чтобы однозначно пронумеровать все подсети, как определено в процессе планирования.
|
At the same time, the remaining number of host bits must also be large enough to number the host IP addresses in the largest subnet.|В то же время оставшееся количество битов хоста также должно быть достаточно большим, чтобы пронумеровать IP-адреса хоста в самой большой подсети.
Remember, in this chapter, we assume the use of a single mask for all subnets.|Помните, что в этой главе мы предполагаем использование одной маски для всех подсетей.
This single mask must support both the required number of subnets and the required number of hosts in the largest subnet.|Эта единственная маска должна поддерживать необходимое количество подсетей и необходимое количество хостов в самой большой подсети.
Figure 11-16 shows the concept.|На рис. 11-16 показана концепция.
|
Figure 11-16 Borrowing Enough Subnet and Host Bits Figure 11-16 shows the idea of the designer choosing a number of subnet (S) and host (H)|Рисунок 11-16 Заимствование достаточного количества битов подсети и хоста Рисунок 11-16 показывает идею о том, как разработчик выбирает количество подсети (S) и хоста (H).
|
bits and then checking the math. 2S must be more than the number of required subnets, or the mask will not supply enough subnets in this IP network.|бит и затем проверка математики. 2S должно быть больше, чем количество требуемых подсетей, иначе маска не предоставит достаточно подсетей в этой IP-сети.
Also, 2H – 2 must be more than the required number of hosts/subnet.|Кроме того, 2H - 2 должно быть больше необходимого количества хостов / подсети.
|
NOTE The idea of calculating the number of subnets as 2S applies only in cases where a single mask is used for all subnets of a single classful network, as is being assumed in this chapter.|ПРИМЕЧАНИЕ. Идея расчета количества подсетей как 2S применима только в тех случаях, когда одна маска используется для всех подсетей одной классовой сети, как предполагается в этой главе.
|
To effectively design masks, or to interpret masks that were chosen by someone else, you need a good working memory of the powers of 2.|Чтобы эффективно создавать маски или интерпретировать маски, выбранные кем-то другим, вам нужна хорошая рабочая память о степенях двойки.
Appendix A, “Numeric Reference Tables,”|Приложение A, «Цифровые справочные таблицы»,
|
lists a table with powers of 2 up through 232 for your reference.|для справки перечисляет таблицу с степенями от 2 до 232.
##### Example Design: 172.16.0.0, 200 Subnets, 200 Hosts
Пример дизайна: 172.16.0.0, 200 подсетей, 200 хостов   
__|__
--|--
|
To help make sense of the theoretical discussion so far, consider an example that focuses on the design choice for the subnet mask.|Чтобы помочь разобраться в теоретическом обсуждении до сих пор, рассмотрим пример, который фокусируется на выборе конструкции для маски подсети.
In this case, the planning and design choices so far tell us the following:|В этом случае выбор планирования и дизайна говорит нам следующее:
###### Use a single mask for all subnets.
Используйте единую маску для всех подсетей.   
###### Plan for 200 subnets.
Планируйте 200 подсетей.   
###### Plan for 200 host IP addresses per subnet.
Запланируйте 200 IP-адресов хоста в каждой подсети.   
###### Use private Class B network 172.16.0.0.
Используйте частную сеть класса B 172.16.0.0.   
__|__
--|--
|
To choose the mask, the designer asks this question:|Чтобы выбрать маску, дизайнер задает такой вопрос:
|
How many subnet (S) bits do I need to number 200 subnets?|Сколько бит подсети (S) мне нужно для нумерации 200 подсетей?
|
You can see that S = 7 is not large enough (27 = 128), but S = 8 is enough (28 = 256).|Вы можете видеть, что S = 7 недостаточно велико (27 = 128), но S = 8 достаточно (28 = 256).
So, you need at least 8 subnet bits.|Итак, вам нужно как минимум 8 бит подсети.
|
Next, the designer asks a similar question, based on the number of hosts per subnet:|Затем разработчик задает аналогичный вопрос, исходя из количества хостов в подсети:
|
How many host (H) bits do I need to number 200 hosts per subnet?|Сколько бит хоста (H) мне нужно для нумерации 200 хостов в подсети?
|
The math is basically the same, but the formula subtracts 2 when counting the number of hosts/subnet.|Математика в основном такая же, но формула вычитает 2 при подсчете количества хостов / подсети.
You can see that H = 7 is not large enough (27 – 2 = 126), but H = 8 is enough (28 – 2 = 254).|Вы можете видеть, что H = 7 недостаточно велико (27-2 = 126), но H = 8 достаточно (28-2 = 254).
|
Only one possible mask meets all the requirements in this case.|В этом случае всем требованиям удовлетворяет только одна возможная маска.
First, the number of network bits (N) must be 16 because the design uses a Class B network.|Во-первых, количество сетевых битов (N) должно быть 16, потому что в проекте используется сеть класса B.
The requirements tell us that the mask needs at least 8 subnet bits and at least 8 host bits.|Требования говорят нам, что для маски требуется не менее 8 бит подсети и не менее 8 бит хоста.
The mask only has 32 bits in it;|В маске всего 32 бита;
|
Figure 11-17 shows the resulting mask.|На рисунке 11-17 показана полученная маска.
|
Figure 11-17 Example Mask Choice, N = 16, S = 8, H = 8|Рисунок 11-17 Пример выбора маски, N = 16, S = 8, H = 8
##### Masks and Mask Formats
Маски и форматы масок   
__|__
--|--
|
Although engineers think about IP addresses in three parts when making design choices (network, subnet, and host), the subnet mask gives the engineer a way to communicate those design choices to all the devices in the subnet.|Хотя инженеры рассматривают IP-адреса в трех частях при выборе проекта (сеть, подсеть и хост), маска подсети дает инженеру способ сообщить эти варианты дизайна всем устройствам в подсети.
|
The subnet mask is a 32-bit binary number with a number of binary 1s on the left and with binary 0s on the right.|Маска подсети представляет собой 32-битное двоичное число с количеством двоичных единиц слева и двоичных нулей справа.
By definition, the number of binary 0s equals the number of host bits;|По определению, количество двоичных нулей равно количеству бит хоста;
|
in fact, that is exactly how the mask communicates the idea of the size of the host part of the addresses in a subnet.|Фактически, именно так маска передает представление о размере хостовой части адресов в подсети.
The beginning bits in the mask equal binary 1, with those bit positions representing the combined network and subnet parts of the addresses in the subnet.|Начальные биты в маске равны двоичной единице, причем эти позиции битов представляют объединенные сетевые и подсетевые части адресов в подсети.
|
Because the network part always comes first, then the subnet part, and then the host part, the subnet mask, in binary form, cannot have interleaved 1s and 0s.|Поскольку сначала идет сетевая часть, затем часть подсети, а затем часть хоста, маска подсети в двоичной форме не может иметь чередование единиц и нулей.
Each subnet mask has one unbroken string of binary 1s on the left, with the rest of the bits as binary 0s.|Каждая маска подсети имеет одну непрерывную строку двоичных единиц слева, а остальные биты представляют собой двоичные нули.
|
After the engineer chooses the classful network and the number of subnet and host bits in a subnet, creating the binary subnet mask is easy.|После того, как инженер выберет классовую сеть и количество битов подсети и хоста в подсети, создать двоичную маску подсети становится легко.
Just write down N 1s, S 1s, and then H 0s (assuming that N, S, and H represent the number of network, subnet, and host bits).|Просто запишите N 1, S 1, а затем H 0 (при условии, что N, S и H представляют количество битов сети, подсети и хоста).
Figure 11-18 shows the mask based on the previous example, which subnets a Class B network by creating 8 subnet bits, leaving 8 host bits.|На рис. 11-18 показана маска, основанная на предыдущем примере, в которой сеть класса B разбивается на подсети, создавая 8 бит подсети, оставляя 8 битов хоста.
|
Figure 11-18 Creating the Subnet Mask—Binary—Class B Network In addition to the binary mask shown in Figure 11-18, masks can also be written in two other formats: the familiar dotted-decimal notation (DDN) seen in IP addresses and an even briefer prefix notation.|Рис. 11-18. Создание маски подсети - двоичная - сеть класса B В дополнение к двоичной маске, показанной на рис. 11-18, маски также могут быть записаны в двух других форматах: знакомой десятичной системе с разделительными точками (DDN), применяемой в IP-адресах. и даже более короткое префиксное обозначение.
Chapter 13, “Analyzing Subnet Masks,” discusses these formats and how to convert between the different formats.|В главе 13 «Анализ масок подсети» обсуждаются эти форматы и способы преобразования между различными форматами.
#### Build a List of All Subnets
Составьте список всех подсетей   
__|__
--|--
|
Building a list of all subnets, the final task of the subnet design step, determines the actual subnets that can be used, based on all the earlier choices.|Построение списка всех подсетей, последняя задача этапа проектирования подсети, определяет фактические подсети, которые можно использовать, на основе всех предыдущих вариантов.
The earlier design work determined the Class A, B, or C network to use, and the (one) subnet mask to use that supplies enough subnets and enough host IP addresses per subnet.|Более ранние проектные работы определили использование сети класса A, B или C и (одну) маску подсети для использования, которая обеспечивает достаточное количество подсетей и достаточное количество IP-адресов хоста для каждой подсети.
But what are those subnets?|Но что это за подсети?
How do you identify or describe a subnet?|Как вы идентифицируете или описываете подсеть?
This section answers these questions.|Этот раздел отвечает на эти вопросы.
|
A subnet consists of a group of consecutive numbers.|Подсеть состоит из группы последовательных номеров.
Most of these numbers can be used as IP addresses by hosts.|Большинство из этих номеров могут использоваться хостами в качестве IP-адресов.
However, each subnet reserves the first and last numbers in the group, and these two numbers cannot be used as IP addresses.|Однако каждая подсеть резервирует первый и последний номера в группе, и эти два номера не могут использоваться в качестве IP-адресов.
In particular, each subnet contains the following:|В частности, каждая подсеть содержит следующее:
###### Subnet number: Also called the subnet ID or subnet address, this number identifies the
Номер подсети: также называемый идентификатором подсети или адресом подсети, этот номер определяет   
__|__
--|--
|
subnet.|подсеть.
It is the numerically smallest number in the subnet.|Это наименьшее числовое значение в подсети.
It cannot be used as an IP address by a host.|Хост не может использовать его в качестве IP-адреса.
###### Subnet broadcast: Also called the subnet broadcast address or directed broadcast
Широковещательная передача подсети: также называется широковещательным адресом подсети или направленной трансляцией.   
__|__
--|--
|
address, this is the last (numerically highest) number in the subnet.|адрес, это последний (наибольший числовой) номер в подсети.
It also cannot be used as an IP address by a host.|Он также не может использоваться хостом в качестве IP-адреса.
###### IP addresses: All the numbers between the subnet ID and the subnet broadcast address
IP-адреса: все числа между идентификатором подсети и широковещательным адресом подсети.   
__|__
--|--
|
can be used as a host IP address.|может использоваться как IP-адрес хоста.
|
For example, consider the earlier case in which the design results were as follows:|Например, рассмотрим более ранний случай, в котором результаты проектирования были следующими:
|
Network 172.16.0.0 (Class B)|Сеть 172.16.0.0 (класс B)
|
Mask 255.255.255.0 (for all subnets)|Маска 255.255.255.0 (для всех подсетей)
|
With some math, the facts about each subnet that exists in this Class B network can be calculated.|С помощью математики можно вычислить факты о каждой подсети, существующей в этой сети класса B.
|
In this case, Table 11-3 shows the first 10 such subnets.|В этом случае в таблице 11-3 показаны первые 10 таких подсетей.
It then skips many subnets and shows the last two (numerically largest) subnets.|Затем он пропускает множество подсетей и показывает две последние (численно наибольшие) подсети.
|
Table 11-3 First 10 Subnets, Plus the Last Few, from 172.16.0.0, 255.255.255.0 Table end.|Таблица 11-3 Первые 10 подсетей плюс несколько последних, начиная с 172.16.0.0, 255.255.255.0 Конец таблицы.
|
After you have the network number and the mask, calculating the subnet IDs and other details for all subnets requires some math.|После того, как у вас есть номер сети и маска, для расчета идентификаторов подсетей и других деталей для всех подсетей потребуются некоторые математические вычисления.
In real life, most people use subnet calculators or subnet-planning tools.|В реальной жизни большинство людей используют калькуляторы подсети или инструменты планирования подсети.
For the CCNA exam, you need to be ready to find this kind of information.|Для сдачи экзамена CCNA вы должны быть готовы найти такую ​​информацию.
|
If you want to dig a little deeper in preparation for CCNP Enterprise or other studies related to IP routing, consider using Appendix L, “Subnet Design,” on the book’s companion website, which shows you how to find all the subnets of a given network.|Если вы хотите копнуть немного глубже при подготовке к CCNP Enterprise или другим исследованиям, связанным с IP-маршрутизацией, рассмотрите возможность использования Приложения L «Дизайн подсети» на сопутствующем веб-сайте книги, в котором показано, как найти все подсети данной сети. .
### Plan the Implementation
Планируйте реализацию   
__|__
--|--
|
The next step, planning the implementation, is the last step before actually configuring the devices to create a subnet.|Следующий шаг - планирование реализации - это последний шаг перед фактической настройкой устройств для создания подсети.
The engineer first needs to choose where to use each subnet.|Сначала инженеру нужно выбрать, где использовать каждую подсеть.
|
For example, at a branch office in a particular city, which subnet from the subnet planning chart (Table 11-3) should be used for each VLAN at that site?|Например, в филиале в определенном городе, какая подсеть из диаграммы планирования подсети (Таблица 11-3) должна использоваться для каждой VLAN на этом сайте?
Also, for any interfaces that require static IP addresses, which addresses should be used in each case?|Кроме того, для любых интерфейсов, требующих статических IP-адресов, какие адреса следует использовать в каждом случае?
Finally, what range of IP addresses from inside each subnet should be configured in the DHCP server, to be dynamically leased to hosts for use as their IP address?|Наконец, какой диапазон IP-адресов из каждой подсети должен быть настроен на DHCP-сервере, чтобы они динамически сдавались в аренду хостам для использования в качестве их IP-адресов?
Figure 11-19 summarizes the list of implementation planning tasks.|На рис. 11-19 представлен список задач планирования внедрения.
|
Figure 11-19 Facts Supplied to the Plan Implementation Step|Рисунок 11-19 Факты, представленные на этапе реализации плана
#### Assigning Subnets to Different Locations
Назначение подсетей разным местоположениям   
__|__
--|--
|
The job is simple: Look at your network diagram, identify each location that needs a subnet, and pick one from the table you made of all the possible subnets.|Задача проста: посмотрите на схему своей сети, определите каждое местоположение, которому требуется подсеть, и выберите одно из составленных вами таблиц из всех возможных подсетей.
Then, track it so that you know which ones you use where, using a spreadsheet or some other purpose-built subnetplanning tool.|Затем отслеживайте его, чтобы знать, какие из них вы используете где, с помощью электронной таблицы или другого специального инструмента для планирования подсетей.
That’s it!|Это оно!
Figure 11-20 shows a sample of a completed design using Table 11-3, which happens to match the initial design sample shown way back in Figure 11-1.|На рис. 11-20 показан образец завершенного проекта с использованием таблицы 11-3, который, как оказалось, совпадает с исходным образцом дизайна, показанным еще на рис. 11-1.
|
Figure 11-20 Example of Subnets Assigned to Different Locations Although this design could have used any five subnets from Table 11-3, in real networks, engineers usually give more thought to some strategy for assigning subnets.|Рис. 11-20. Пример подсетей, назначенных разным расположениям. Хотя в этой схеме можно было использовать любые пять подсетей из таблицы 11-3, в реальных сетях инженеры обычно больше думают о какой-либо стратегии назначения подсетей.
For example, you might assign all LAN subnets lower numbers and WAN subnets higher numbers.|Например, вы можете назначить всем подсетям LAN более низкие номера, а подсетям WAN более высокие номера.
Or you might slice off large ranges of subnets for different divisions of the company.|Или вы можете выделить большие диапазоны подсетей для разных подразделений компании.
Or you might follow that same strategy but ignore organizational divisions in the company, paying more attention to geographies.|Или вы можете следовать той же стратегии, но игнорировать организационные подразделения в компании, уделяя больше внимания географическому положению.
|
For example, for a U.S.-based company with a smaller presence in both Europe and Asia, you might plan to reserve ranges of subnets based on continent.|Например, для американской компании с меньшим присутствием как в Европе, так и в Азии вы можете запланировать резервирование диапазонов подсетей в зависимости от континента.
This kind of choice is particularly useful when later trying to use a feature called route summarization.|Такой выбор особенно полезен, когда позже вы попытаетесь использовать функцию, называемую суммированием маршрута.
Figure 11-21 shows the general benefit of placing addressing in the network for easier route summarization, using the same subnets from Table 11-3 again.|На рис. 11-21 показано общее преимущество размещения адресации в сети для упрощения суммирования маршрута с использованием тех же подсетей из таблицы 11-3.
|
Figure 11-21 Reserving 50 Percent of Subnets for North America and 25 Percent Each for Europe and Asia|Рисунок 11-21 Резервирование 50 процентов подсетей для Северной Америки и по 25 процентов каждой для Европы и Азии
#### Choose Static and Dynamic Ranges per Subnet
Выберите статические и динамические диапазоны для каждой подсети   
__|__
--|--
|
Devices receive their IP address and mask assignment in one of two ways: dynamically by using Dynamic Host Configuration Protocol (DHCP) or statically through configuration.|Устройства получают свой IP-адрес и назначение маски одним из двух способов: динамически с помощью протокола динамической конфигурации хоста (DHCP) или статически с помощью конфигурации.
|
For DHCP to work, the network engineer must tell the DHCP server the subnets for which it must assign IP addresses.|Чтобы DHCP работал, сетевой инженер должен сообщить DHCP-серверу подсети, для которых он должен назначить IP-адреса.
In addition, that configuration limits the DHCP server to only a subset of the addresses in the subnet.|Кроме того, эта конфигурация ограничивает DHCP-сервер только подмножеством адресов в подсети.
For static addresses, you simply configure the device to tell it what IP address and mask to use.|Для статических адресов вы просто настраиваете устройство, чтобы указать ему, какой IP-адрес и маску использовать.
|
To keep things as simple as possible, most shops use a strategy to separate the static IP addresses on one end of each subnet, and the DHCP-assigned dynamic addresses on the other.|Чтобы упростить задачу, большинство магазинов используют стратегию разделения статических IP-адресов на одном конце каждой подсети и динамических адресов, назначенных DHCP, на другом.
It does not really matter whether the static addresses sit on the low end of the range of addresses or the high end.|На самом деле не имеет значения, находятся ли статические адреса на нижнем или верхнем конце диапазона адресов.
|
For example, imagine that the engineer decides that, for the LAN subnets in Figure 11-20, the DHCP pool comes from the high end of the range, namely, addresses that end in .101 through .254. (The address that ends in .255 is, of course, reserved.) The engineer also assigns static addresses from the lower end, with addresses ending in .1 through .100.|Например, представьте, что инженер решает, что для подсетей LAN на рис. 11-20 пул DHCP исходит из верхнего конца диапазона, а именно адресов, заканчивающихся на .101–0.254. (Адрес, заканчивающийся на .255, конечно, зарезервирован.) Инженер также назначает статические адреса с нижнего конца, причем адреса заканчиваются на .1–0.100.
Figure 11-22 shows the idea.|На рис. 11-22 показана идея.
|
Figure 11-22 Static from the Low End and DHCP from the High End Figure 11-22 shows all three routers with statically assigned IP addresses that end in .1.|Рисунок 11-22 Статический от нижнего уровня и DHCP от верхнего уровня На рис. 11-22 показаны все три маршрутизатора со статически назначенными IP-адресами, оканчивающимися на .1.
The only other static IP address in the figure is assigned to the server on the left, with address 172.16.1.11 (abbreviated simply as .11 in the figure).|Единственный другой статический IP-адрес на рисунке назначен серверу слева, с адресом 172.16.1.11 (сокращенно .11 на рисунке).
|
On the right, each LAN has two PCs that use DHCP to dynamically lease their IP addresses.|Справа в каждой локальной сети есть два компьютера, которые используют DHCP для динамической аренды своих IP-адресов.
|
DHCP servers often begin by leasing the addresses at the bottom of the range of addresses, so in each LAN, the hosts have leased addresses that end in .101 and .102, which are at the low end of the range chosen by design.|DHCP-серверы часто начинают с аренды адресов в нижней части диапазона адресов, поэтому в каждой локальной сети хосты арендуют адреса, оканчивающиеся на .101 и .102, которые находятся в нижней части диапазона, выбранного по дизайну.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element for more details.|Обратитесь к элементу «Ваш учебный план» для получения более подробной информации.
Table 11-4 outlines the key review elements and where you can find them.|В Таблице 11-4 представлены ключевые элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 11-4 Chapter Review Tracking Table end.|Таблица 11-4 Окончание таблицы отслеживания обзора главы.
|
Key Terms You Should Know subnet, network, classful IP network, variable-length subnet masks (VLSM), network part, subnet part, host part, public IP network, private IP network, subnet mask|Ключевые термины, которые вы должны знать: подсеть, сеть, классовая IP-сеть, маски подсети переменной длины (VLSM), сетевая часть, часть подсети, часть хоста, общедоступная IP-сеть, частная IP-сеть, маска подсети.
## Chapter 12 Analyzing Classful IPv4 Networks
Глава 12 Анализ классовых сетей IPv4   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.6 Configure and verify IPv4 addressing and subnetting
1.6 Настройка и проверка адресации IPv4 и подсетей   
__|__
--|--
|
When operating a network, you often start investigating a problem based on an IP address and mask.|При работе в сети вы часто начинаете исследовать проблему на основе IP-адреса и маски.
Based on the IP address alone, you should be able to determine several facts about the Class A, B, or C network in which the IP address resides.|Основываясь только на IP-адресе, вы сможете определить несколько фактов о сети класса A, B или C, в которой находится IP-адрес.
|
This chapter lists the key facts about classful IP networks and explains how to discover these facts.|В этой главе перечислены ключевые факты о классовых IP-сетях и объясняется, как их обнаружить.
Following that, this chapter lists some practice problems.|После этого в этой главе перечислены некоторые практические проблемы.
Before moving to the next chapter, you should practice until you can consistently determine all these facts, quickly and confidently, based on an IP address.|Прежде чем перейти к следующей главе, вам следует потренироваться, пока вы не сможете последовательно и быстро и уверенно определять все эти факты на основе IP-адреса.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 12-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 12-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### Classful Network Concepts
Концепции классической сети   
__|__
--|--
|
1. Which of the following are not valid Class A network IDs? (Choose two answers.)|1. Что из перечисленного не является действительным идентификатором сети класса A? (Выберите два ответа.)
|
a. 1.0.0.0 b. 130.0.0.0 c. 127.0.0.0 d. 9.0.0.0 2.|а. 1.0.0.0 б. 130.0.0.0 с. 127.0.0.0 г. 9.0.0.0 2.
Which of the following are not valid Class B network IDs?|Что из перечисленного не является действительным идентификатором сети класса B?
|
a. 130.0.0.0 b. 191.255.0.0 c. 128.0.0.0 d. 150.255.0.0 e.|а. 130.0.0.0 б. 191.255.0.0 с. 128.0.0.0 г. 150.255.0.0 э.
All are valid Class B network IDs.|Все допустимые идентификаторы сети класса B.
|
CHAPTER 12 3.|ГЛАВА 12 3.
Which of the following are true about IP address 172.16.99.45’s IP network? (Choose two answers.)|Что из перечисленного верно относительно IP-сети IP-адреса 172.16.99.45? (Выберите два ответа.)
|
a. The network ID is 172.0.0.0.|а. Идентификатор сети - 172.0.0.0.
|
b. The network is a Class B network.|б. Сеть относится к классу B.
|
c. The default mask for the network is 255.255.255.0.|c. Маска по умолчанию для сети 255.255.255.0.
|
d. The number of host bits in the unsubnetted network is 16.|d. Количество битов хоста в сети без подсети - 16.
|
4. Which of the following are true about IP address 192.168.6.7’s IP network? (Choose two answers.)|4. Какие из следующих утверждений касаются IP-сети с IP-адресом 192.168.6.7? (Выберите два ответа.)
|
a. The network ID is 192.168.6.0.|а. Идентификатор сети 192.168.6.0.
|
b. The network is a Class B network.|б. Сеть относится к классу B.
|
c. The default mask for the network is 255.255.255.0.|c. Маска по умолчанию для сети 255.255.255.0.
|
d. The number of host bits in the unsubnetted network is 16.|d. Количество битов хоста в сети без подсети - 16.
|
5. Which of the following is a network broadcast address?|5. Что из перечисленного является сетевым широковещательным адресом?
|
a. 10.1.255.255 b. 192.168.255.1 c. 224.1.1.255 d. 172.30.255.255 Foundation Topics Classful Network Concepts Imagine that you have a job interview for your first IT job.|а. 10.1.255.255 б. 192.168.255.1 г. 224.1.1.255 г. 172.30.255.255 Основные темы Концепции классической сети Представьте, что у вас есть собеседование на вашу первую работу в сфере ИТ.
As part of the interview, you’re given an IPv4 address and mask: 10.4.5.99, 255.255.255.0.|В рамках собеседования вам будут предоставлены IPv4-адрес и маска: 10.4.5.99, 255.255.255.0.
What can you tell the interviewer about the classful network (in this case, the Class A network) in which the IP address resides?|Что вы можете сказать интервьюеру о классовой сети (в данном случае о сети класса A), в которой находится IP-адрес?
|
This section, the first of two major sections in this chapter, reviews the concepts of classful IP networks (in other words, Class A, B, and C networks).|В этом разделе, первом из двух основных разделов этой главы, рассматриваются концепции классовых IP-сетей (другими словами, сетей классов A, B и C).
In particular, this chapter examines how to begin with a single IP address and then determine the following facts:|В частности, в этой главе исследуется, как начать с одного IP-адреса, а затем определить следующие факты:
###### Class (A, B, or C)
Класс (A, B или C)   
###### Default mask
Маска по умолчанию   
###### Number of network octets/bits
Количество сетевых октетов / битов   
###### Number of host octets/bits
Количество октетов / битов хоста   
###### Number of host addresses in the network
Количество адресов хоста в сети   
###### Network ID
Идентификатор сети   
###### Network broadcast address
Сетевой широковещательный адрес   
###### First and last usable address in the network
Первый и последний используемый адрес в сети   
#### IPv4 Network Classes and Related Facts
Сетевые классы IPv4 и связанные факты   
__|__
--|--
|
IP version 4 (IPv4) defines five address classes.|IP версии 4 (IPv4) определяет пять классов адресов.
Three of the classes, Classes A, B, and C, consist of unicast IP addresses.|Три класса, классы A, B и C, состоят из одноадресных IP-адресов.
Unicast addresses identify a single host or interface so that the address uniquely identifies the device.|Одноадресные адреса идентифицируют один хост или интерфейс, поэтому адрес однозначно идентифицирует устройство.
Class D addresses serve as multicast addresses, so that one packet sent to a Class D multicast IPv4 address can actually be delivered to multiple hosts.|Адреса класса D служат в качестве многоадресных адресов, поэтому один пакет, отправленный на многоадресный IPv4-адрес класса D, может быть доставлен на несколько хостов.
Finally, Class E addresses were originally intended for experimentation but were changed to simply be reserved for future use.|Наконец, адреса класса E изначально предназначались для экспериментов, но были изменены, чтобы просто зарезервировать для будущего использования.
The class can be identified based on the value of the first octet of the address, as shown in Table 12-2.|Класс может быть идентифицирован на основе значения первого октета адреса, как показано в Таблице 12-2.
|
Table 12-2 IPv4 Address Classes Based on First Octet Values Table end.|Таблица 12-2. Классы адресов IPv4 на основе значений первого октета. Конец таблицы.
|
After you identify the class of a unicast address as either A, B, or C, many other related facts can be derived just through memorization.|После того, как вы определили класс одноадресного адреса как A, B или C, многие другие связанные факты могут быть получены просто путем запоминания.
Table 12-3 lists that information for reference and later study; each of these concepts is described in this chapter.|Таблица 12-3 перечисляет эту информацию для справки и дальнейшего изучения; каждая из этих концепций описана в этой главе.
|
Table 12-3 Key Facts for Classes A, B, and C Table end.|Таблица 12-3 Основные факты для классов A, B и C Конец таблицы.
|
Note that the address ranges of all addresses that begin with 0 and all addresses that begin with 127 are reserved.|Обратите внимание, что диапазоны адресов всех адресов, начинающихся с 0, и всех адресов, начинающихся со 127, зарезервированы.
Had they not been reserved since the creation of Class A networks, as listed in RFC 791 (published in 1981), then they might have been known as class A networks|Если бы они не были зарезервированы с момента создания сетей класса A, как указано в RFC 791 (опубликованном в 1981 г.), то они могли бы быть известны как сети класса A.
###### 0.0.0.0 and 127.0.0.0. Because they are reserved, however, the address space has 126 class A
0.0.0.0 и 127.0.0.0. Однако, поскольку они зарезервированы, адресное пространство имеет 126 класс A   
__|__
--|--
|
networks, and not 128.|сетей, а не 128.
Also, note that there are no similar reserved ranges to begin/end the class B and C ranges.|Также обратите внимание, что нет аналогичных зарезервированных диапазонов для начала / конца диапазонов классов B и C.
|
Answers to the “Do I Know This Already?” quiz:|Ответы на вопрос «Знаю ли я это уже?» викторина:
|
1 B, C 2 E 3 B, D 4 A, C 5 D In addition to the reservation of what would be class A networks 0.0.0.0 and 127.0.0.0 for other purposes, other newer RFCs have also reserved small pieces of the Class A, B, and C address space.|1 B, C 2 E 3 B, D 4 A, C 5 D В дополнение к резервированию сетей класса A 0.0.0.0 и 127.0.0.0 для других целей, в других более новых RFC также зарезервированы небольшие части этого класса. Адресное пространство A, B и C.
So, tables like Table 12-3, with the count of the numbers of Class A, B, and C networks, are a good place to get a sense of the size of the number; however, the number of reserved networks does change slightly over time (albeit slowly) based on these other reserved address ranges.|Таким образом, таблицы, подобные таблице 12-3, с подсчетом количества сетей классов A, B и C, являются хорошим местом, чтобы получить представление о размере числа; однако количество зарезервированных сетей немного меняется со временем (хотя и медленно) в зависимости от этих других зарезервированных диапазонов адресов.
|
NOTE If you are interested in seeing all the reserved IPv4 address ranges, just do an Internet search on “IANA IPv4 special-purpose address registry.”|ПРИМЕЧАНИЕ. Если вы хотите просмотреть все зарезервированные диапазоны адресов IPv4, просто выполните поиск в Интернете в «Реестре специальных адресов IANA IPv4».
##### The Number and Size of the Class A, B, and C Networks
Количество и размер сетей классов A, B и C   
__|__
--|--
|
Table 12-3 lists the range of Class A, B, and C network numbers; however, some key points can be lost just referencing a table of information.|Таблица 12-3 перечисляет диапазон номеров сетей классов A, B и C; однако некоторые ключевые моменты можно упустить, просто обратившись к таблице информации.
This section examines the Class A, B, and C network numbers, focusing on the more important points and the exceptions and unusual cases.|В этом разделе исследуются номера сетей классов A, B и C, уделяя особое внимание наиболее важным моментам, а также исключениям и необычным случаям.
|
First, the number of networks from each class significantly differs.|Во-первых, количество сетей каждого класса существенно различается.
Only 126 Class A networks exist: network 1.0.0.0, 2.0.0.0, 3.0.0.0, and so on, up through network 126.0.0.0.|Существует только 126 сетей класса A: сеть 1.0.0.0, 2.0.0.0, 3.0.0.0 и так далее, вплоть до сети 126.0.0.0.
|
However, 16,384 Class B networks exist, with more than 2 million Class C networks.|Однако существует 16 384 сети класса B, из них более 2 миллионов сетей класса C.
|
Next, note that the size of networks from each class also significantly differs.|Далее обратите внимание, что размер сетей каждого класса также значительно отличается.
Each Class A network is relatively large—over 16 million host IP addresses per network—so they were originally intended to be used by the largest companies and organizations.|Каждая сеть класса A относительно велика - более 16 миллионов IP-адресов хостов в каждой сети - поэтому изначально они предназначались для использования крупнейшими компаниями и организациями.
Class B networks are smaller, with over 65,000 hosts per network.|Сети класса B меньше по размеру, более 65 000 хостов в каждой сети.
Finally, Class C networks, intended for small organizations, have 254 hosts in each network.|Наконец, сети класса C, предназначенные для небольших организаций, имеют 254 хоста в каждой сети.
Figure 12-1 summarizes those facts.|Рисунок 12-1 суммирует эти факты.
|
Figure 12-1 Numbers and Sizes of Class A, B, and C Networks|Рисунок 12-1 Количество и размеры сетей классов A, B и C
##### Address Formats
Форматы адресов   
__|__
--|--
|
In some cases, an engineer might need to think about a Class A, B, or C network as if the network has not been subdivided through the subnetting process.|В некоторых случаях инженеру может потребоваться подумать о сети класса A, B или C так, как если бы сеть не была разделена в процессе разделения на подсети.
In such a case, the addresses in the classful network have a structure with two parts: the network part (sometimes called the prefix) and the host part.|В таком случае адреса в классовой сети имеют структуру из двух частей: сетевая часть (иногда называемая префиксом) и часть хоста.
Then, comparing any two IP addresses in one network, the following observations can be made:|Затем, сравнивая любые два IP-адреса в одной сети, можно сделать следующие наблюдения:
|
The addresses in the same network have the same values in the network part.|Адреса в одной сети имеют одинаковые значения в сетевой части.
|
The addresses in the same network have different values in the host part.|Адреса в одной сети имеют разные значения в части хоста.
|
For example, in Class A network 10.0.0.0, by definition, the network part consists of the first octet.|Например, в сети 10.0.0.0 класса A по определению сетевая часть состоит из первого октета.
As a result, all addresses have an equal value in the network part, namely a 10 in the first octet.|В результате все адреса имеют одинаковое значение в сетевой части, а именно 10 в первом октете.
If you then compare any two addresses in the network, the addresses have a different value in the last three octets (the host octets).|Если вы затем сравните любые два адреса в сети, адреса будут иметь разные значения в последних трех октетах (октетах хоста).
For example, IP addresses 10.1.1.1 and|Например, IP-адреса 10.1.1.1 и
###### 10.1.1.2 have the same value (10) in the network part, but different values in the host part.
10.1.1.2 имеют одинаковое значение (10) в сетевой части, но разные значения в хостовой части.   
__|__
--|--
|
Figure 12-2 shows the format and sizes (in number of bits) of the network and host parts of IP addresses in Class A, B, and C networks, before any subnetting has been applied.|На рис. 12-2 показаны формат и размеры (в количестве бит) сетевых и узловых частей IP-адресов в сетях классов A, B и C до того, как будет применено какое-либо подсетевое разделение.
|
Figure 12-2 Sizes (Bits) of the Network and Host Parts of Unsubnetted Classful Networks|Рисунок 12-2 Размеры (биты) части сети и узла в классовых сетях без подсетей
##### Default Masks
Маски по умолчанию   
__|__
--|--
|
Although we humans can easily understand the concepts behind Figure 12-2, computers prefer numbers.|Хотя мы, люди, можем легко понять концепции, лежащие в основе рисунка 12-2, компьютеры предпочитают числа.
To communicate those same ideas to computers, each network class has an associated default mask that defines the size of the network and host parts of an unsubnetted Class A, B, and C network.|Чтобы передать эти же идеи компьютерам, каждый сетевой класс имеет связанную маску по умолчанию, которая определяет размер сети и узлов сети без подсетей классов A, B и C.
To do so, the mask lists binary 1s for the bits considered to be in the network part and binary 0s for the bits considered to be in the host part.|Для этого в маске перечислены двоичные единицы для битов, которые считаются находящимися в сетевой части, и двоичные 0 для битов, которые считаются находящимися в основной части.
|
For example, Class A network 10.0.0.0 has a network part of the first single octet (8 bits) and a host part of the last three octets (24 bits).|Например, сеть 10.0.0.0 класса A имеет сетевую часть первого одиночного октета (8 бит) и хост-часть последних трех октетов (24 бита).
As a result, the Class A default mask is 255.0.0.0, which in binary is 11111111 00000000 00000000 00000000 Figure 12-3 shows default masks for each network class, both in binary and dotted-decimal format.|В результате маска по умолчанию для класса A равна 255.0.0.0, что в двоичном формате равно 11111111 00000000 00000000 00000000 На рис. 12-3 показаны маски по умолчанию для каждого класса сети, как в двоичном, так и в десятичном формате с разделителями.
|
NOTE Decimal 255 converts to the binary value 11111111.|ПРИМЕЧАНИЕ Decimal 255 преобразуется в двоичное значение 11111111.
Decimal 0, converted to 8-bit binary, is 00000000.|Десятичный 0, преобразованный в 8-битный двоичный код, равен 00000000.
See Appendix A, “Numeric Reference Tables,” for a conversion table.|См. Приложение A, «Цифровые справочные таблицы», где приведена таблица преобразования.
|
Figure 12-3 Default Masks for Classes A, B, and C|Рисунок 12-3 Маски по умолчанию для классов A, B и C
#### Number of Hosts per Network
Количество хостов в сети   
__|__
--|--
|
Calculating the number of hosts per network requires some basic binary math.|Для расчета количества хостов в сети требуется базовая двоичная математика.
First, consider a case where you have a single binary digit.|Сначала рассмотрим случай, когда у вас есть одна двоичная цифра.
How many unique values are there?|Сколько существует уникальных ценностей?
There are, of course, two values: 0 and 1.|Конечно, есть два значения: 0 и 1.
With 2 bits, you can make four combinations: 00, 01, 10, and 11.|Используя 2 бита, вы можете составить четыре комбинации: 00, 01, 10 и 11.
As it turns out, the total combination of unique values you can make with N bits is 2N.|Как оказалось, общая комбинация уникальных значений, которую вы можете создать с помощью N бит, составляет 2N.
|
Host addresses—the IP addresses assigned to hosts—must be unique.|Адреса хостов - IP-адреса, назначенные хостам, - должны быть уникальными.
The host bits exist for the purpose of giving each host a unique IP address by virtue of having a different value in the host part of the addresses.|Биты хоста существуют для того, чтобы дать каждому хосту уникальный IP-адрес в силу того, что они имеют разные значения в части адресов хоста.
So, with H host bits, 2H unique combinations exist.|Итак, с H битами хоста существует 2H уникальных комбинаций.
|
However, the number of hosts in a network is not 2H; instead, it is 2H – 2.|Однако количество хостов в сети не 2H; вместо этого это 2H - 2.
Each network reserves two numbers that would have otherwise been useful as host addresses but have instead been reserved for special use: one for the network ID and one for the network broadcast address.|Каждая сеть резервирует два номера, которые в противном случае были бы полезны в качестве адресов хоста, но вместо этого были зарезервированы для специального использования: один для идентификатора сети и один для широковещательного адреса сети.
As a result, the formula to calculate the number of host addresses per Class A, B, or C network is 2H – 2 where H is the number of host bits.|В результате формула для расчета количества адресов хоста в сети класса A, B или C составляет 2H - 2, где H - количество бит хоста.
#### Deriving the Network ID and Related Numbers
Получение идентификатора сети и связанных номеров   
__|__
--|--
|
Each classful network has four key numbers that describe the network.|Каждая классовая сеть имеет четыре ключевых числа, которые описывают сеть.
You can derive these four numbers if you start with just one IP address in the network.|Вы можете получить эти четыре числа, если начнете с одного IP-адреса в сети.
The numbers are as follows:|Цифры следующие:
###### Network number
Номер сети   
###### First (numerically lowest) usable address
Первый (наименьший) используемый адрес   
###### Last (numerically highest) usable address
Последний (высший числовой) используемый адрес   
###### Network broadcast address
Сетевой широковещательный адрес   
__|__
--|--
|
First, consider both the network number and first usable IP address.|Во-первых, рассмотрите и номер сети, и первый используемый IP-адрес.
The network number, also called the network ID or network address, identifies the network.|Сетевой номер, также называемый идентификатором сети или сетевым адресом, идентифицирует сеть.
By definition, the network number is the numerically lowest number in the network.|По определению, номер сети - это наименьшее численное значение в сети.
However, to prevent any ambiguity, the people that made up IP addressing added the restriction that the network number cannot be assigned as an IP address.|Однако, чтобы избежать двусмысленности, люди, которые составляли IP-адресацию, добавили ограничение, согласно которому сетевой номер не может быть назначен в качестве IP-адреса.
So, the lowest number in the network is the network ID. Then, the first (numerically lowest) host IP address is one larger than the network number.|Итак, наименьшее число в сети - это идентификатор сети. Тогда первый (самый младший) IP-адрес хоста на единицу больше номера сети.
|
Next, consider the network broadcast address along with the last (numerically highest)|Затем рассмотрите широковещательный адрес сети вместе с последним (наибольшим по численности)
|
usable IP address.|пригодный для использования IP-адрес.
The TCP/IP RFCs define a network broadcast address as a special address in each network.|RFC TCP / IP определяют сетевой широковещательный адрес как специальный адрес в каждой сети.
This broadcast address could be used as the destination address in a packet, and the routers would forward a copy of that one packet to all hosts in that classful network.|Этот широковещательный адрес может использоваться в качестве адреса назначения в пакете, и маршрутизаторы будут пересылать копию этого одного пакета всем хостам в этой классовой сети.
|
Numerically, a network broadcast address is always the highest (last) number in the network.|В числовом выражении сетевой широковещательный адрес всегда является наивысшим (последним) номером в сети.
|
As a result, the highest (last) number usable as an IP address is the address that is one less than the network broadcast address.|В результате наивысший (последний) номер, который можно использовать в качестве IP-адреса, - это адрес, который на единицу меньше широковещательного адреса сети.
|
Simply put, if you can find the network number and network broadcast address, finding the first and last usable IP addresses in the network is easy.|Проще говоря, если вы можете найти номер сети и сетевой широковещательный адрес, найти первый и последний используемые IP-адреса в сети очень просто.
For the exam, you should be able to find all four values with ease; the process is as follows:|На экзамене вы должны легко найти все четыре значения; процесс выглядит следующим образом:
|
Step 1.|Шаг 1.
Determine the class (A, B, or C) based on the first octet.|Определите класс (A, B или C) на основе первого октета.
|
Step 2.|Шаг 2.
Mentally divide the network and host octets based on the class.|Мысленно разделите октеты сети и хоста в зависимости от класса.
|
Step 3.|Шаг 3.
To find the network number, change the IP address’s host octets to 0.|Чтобы найти номер сети, измените октеты хоста IP-адреса на 0.
|
Step 4.|Шаг 4.
To find the first address, add 1 to the fourth octet of the network ID.|Чтобы найти первый адрес, добавьте 1 к четвертому октету идентификатора сети.
|
Step 5.|Шаг 5.
To find the broadcast address, change the network ID’s host octets to 255.|Чтобы найти широковещательный адрес, измените октеты хоста идентификатора сети на 255.
|
Step 6.|Шаг 6.
To find the last address, subtract 1 from the fourth octet of the network broadcast address.|Чтобы найти последний адрес, вычтите 1 из четвертого октета широковещательного адреса сети.
|
The written process actually looks harder than it is.|Письменный процесс на самом деле выглядит сложнее, чем есть на самом деле.
Figure 12-4 shows an example of the process, using Class A IP address 10.17.18.21, with the circled numbers matching the process.|На рисунке 12-4 показан пример процесса с использованием IP-адреса класса A 10.17.18.21 с номерами в кружках, соответствующими процессу.
|
Figure 12-4 Example of Deriving the Network ID and Other Values from 10.17.18.21 Figure 12-4 shows the identification of the class as Class A (Step 1) and the number of network/|Рисунок 12-4 Пример получения идентификатора сети и других значений из 10.17.18.21 Рисунок 12-4 показывает идентификацию класса как Class A (Шаг 1) и количество сетей /
|
host octets as 1 and 3, respectively.|октеты хоста равны 1 и 3 соответственно.
So, to find the network ID at Step 3, the figure copies only the first octet, setting the last three (host) octets to 0.|Итак, чтобы найти идентификатор сети на шаге 3, рисунок копирует только первый октет, устанавливая последние три (хост) октета на 0.
At Step 4, just copy the network ID and add 1 to the fourth octet.|На шаге 4 просто скопируйте идентификатор сети и добавьте 1 к четвертому октету.
Similarly, to find the broadcast address at Step 5, copy the network octets, but set the host octets to 255.|Точно так же, чтобы найти широковещательный адрес на шаге 5, скопируйте сетевые октеты, но установите для октетов хоста значение 255.
Then, at Step 6, subtract 1 from the fourth octet to find the last (numerically highest) usable IP address.|Затем на шаге 6 вычтите 1 из четвертого октета, чтобы найти последний (высший численно) используемый IP-адрес.
|
Just to show an alternative example, consider IP address 172.16.8.9.|Чтобы показать альтернативный пример, рассмотрим IP-адрес 172.16.8.9.
Figure 12-5 shows the process applied to this IP address.|На рисунке 12-5 показан процесс, применяемый к этому IP-адресу.
|
Figure 12-5 Example Deriving the Network ID and Other Values from 172.16.8.9 Figure 12-5 shows the identification of the class as Class B (Step 1) and the number of network/|Рисунок 12-5 Пример получения идентификатора сети и других значений из 172.16.8.9 Рисунок 12-5 показывает идентификацию класса как Class B (Шаг 1) и количество сетей /
|
host octets as 2 and 2, respectively.|октеты хоста равны 2 и 2 соответственно.
So, to find the network ID at Step 3, the figure copies only the first two octets, setting the last two (host) octets to 0.|Итак, чтобы найти идентификатор сети на шаге 3, рисунок копирует только первые два октета, устанавливая последние два (хост) октета на 0.
Similarly, Step 5 shows the same action, but with the last two (host) octets being set to 255.|Точно так же на шаге 5 показано то же действие, но последние два (хост) октета установлены на 255.
#### Unusual Network IDs and Network Broadcast Addresses
Необычные сетевые идентификаторы и сетевые широковещательные адреса   
__|__
--|--
|
Some of the more unusual numbers in and around the range of Class A, B, and C network numbers can cause some confusion.|Некоторые из наиболее необычных номеров в диапазоне сетевых номеров классов A, B и C и за его пределами могут вызвать некоторую путаницу.
This section lists some examples of numbers that make many people make the wrong assumptions about the meaning of the number.|В этом разделе перечислены некоторые примеры чисел, из-за которых многие люди делают неправильные предположения о значении числа.
|
For Class A, the first odd fact is that the range of values in the first octet omits the numbers 0 and 127.|Для класса A первым нечетным фактом является то, что диапазон значений в первом октете пропускает числа 0 и 127.
As it turns out, what would be Class A network 0.0.0.0 was originally reserved for some broadcasting requirements, so all addresses that begin with 0 in the first octet are reserved.|Оказывается, сеть 0.0.0.0 класса A изначально была зарезервирована для некоторых требований широковещания, поэтому все адреса, начинающиеся с 0 в первом октете, зарезервированы.
What would be Class A network 127.0.0.0 is still reserved because of a special address used in software testing, called the loopback address (127.0.0.1).|Сеть класса A 127.0.0.0 по-прежнему зарезервирована из-за специального адреса, используемого при тестировании программного обеспечения, который называется адресом обратной связи (127.0.0.1).
|
For Class B (and C), some of the network numbers can look odd, particularly if you fall into a habit of thinking that 0s at the end means the number is a network ID, and 255s at the end means it’s a network broadcast address.|Для класса B (и C) некоторые номера сетей могут выглядеть странно, особенно если вы привыкли думать, что 0 в конце означает, что число является идентификатором сети, а 255 в конце означает, что это широковещательный адрес сети. .
First, Class B network numbers range from 128.0.0.0 to 191.255.0.0, for a total of 214 networks.|Во-первых, номера сетей класса B находятся в диапазоне от 128.0.0.0 до 191.255.0.0, всего 214 сетей.
However, even the very first (lowest number) Class B network number (128.0.0.0) looks a little like a Class A network number because it ends with three 0s.|Однако даже самый первый (самый низкий номер) номер сети класса B (128.0.0.0) немного похож на номер сети класса A, потому что он заканчивается тремя нулями.
However, the first octet is 128, making it a Class B network with a two-octet network part (128.0).|Однако первый октет равен 128, что делает его сетью класса B с двухоктетной сетевой частью (128.0).
|
For another Class B example, the high end of the Class B range also might look strange at first glance (191.255.0.0), but this is indeed the numerically highest of the valid Class B network numbers.|В другом примере класса B верхний предел диапазона класса B также может показаться странным на первый взгляд (191.255.0.0), но это действительно самый высокий числовой из допустимых сетевых номеров класса B.
This network’s broadcast address, 191.255.255.255, might look a little like a Class A broadcast address because of the three 255s at the end, but it is indeed the broadcast address of a Class B network.|Широковещательный адрес этой сети, 191.255.255.255, может немного походить на широковещательный адрес класса A из-за трех 255 в конце, но это действительно широковещательный адрес сети класса B.
|
Similarly to Class B networks, some of the valid Class C network numbers do look strange.|Как и в сетях класса B, некоторые допустимые номера сетей класса C выглядят странно.
|
For example, Class C network 192.0.0.0 looks a little like a Class A network because of the last three octets being 0, but because it is a Class C network, it consists of all addresses that begin with three octets equal to 192.0.0.|Например, сеть класса C 192.0.0.0 немного похожа на сеть класса A из-за того, что последние три октета равны 0, но поскольку это сеть класса C, она состоит из всех адресов, начинающихся с трех октетов, равных 192.0.0. .
Similarly, 223.255.255.0, another valid Class C network, consists of all addresses that begin with 223.255.255.|Точно так же 223.255.255.0, другая действующая сеть класса C, состоит из всех адресов, начинающихся с 223.255.255.
### Practice with Classful Networks
Практика с Classful Networks   
__|__
--|--
|
As with all areas of IP addressing and subnetting, you need to practice to be ready for the CCNA exam.|Как и во всех областях IP-адресации и разделения на подсети, вам необходимо потренироваться, чтобы быть готовым к экзамену CCNA.
You should practice some while reading this chapter to make sure that you understand the processes.|Вам следует попрактиковаться во время чтения этой главы, чтобы убедиться, что вы понимаете процессы.
At that point, you can use your notes and this book as a reference, with a goal of understanding the process.|На этом этапе вы можете использовать свои заметки и эту книгу в качестве справочника с целью понимания процесса.
After that, keep practicing this and all the other subnetting processes.|После этого продолжайте практиковать этот и все другие процессы разделения на подсети.
Before you take the exam, you should be able to always get the right answer, and with speed.|Прежде чем сдать экзамен, вы всегда должны быть в состоянии получить правильный ответ и быстро.
Table 12-4 summarizes the key concepts and suggestions for this two-phase approach.|Таблица 12-4 суммирует ключевые концепции и предложения для этого двухэтапного подхода.
|
Table 12-4 Keep-Reading and Take-Exam Goals for This Chapter’s Topics Table end.|Таблица 12-4 Цели «Продолжайте читать и сдавать экзамен» в конце таблицы тем этой главы.
#### Practice Deriving Key Facts Based on an IP Address
Практика получения ключевых фактов на основе IP-адреса   
__|__
--|--
|
Practice finding the various facts that can be derived from an IP address, as discussed throughout this chapter.|Попрактикуйтесь в поиске различных фактов, которые могут быть получены из IP-адреса, как это обсуждается в этой главе.
To do so, complete Table 12-5.|Для этого заполните Таблицу 12-5.
|
Table 12-5 Practice Problems: Find the Network ID and Network Broadcast Table end.|Таблица 12-5 Практические проблемы: Найдите конец таблицы идентификатора сети и сетевого широковещания.
|
The answers are listed in the section “Answers to Earlier Practice Problems,” later in this chapter.|Ответы перечислены в разделе «Ответы на более ранние практические проблемы» далее в этой главе.
#### Practice Remembering the Details of Address Classes
Практика запоминания деталей классов адресов   
__|__
--|--
|
Tables 12-2 and 12-3, shown earlier in this chapter, summarized some key information about IPv4 address classes.|Таблицы 12-2 и 12-3, показанные ранее в этой главе, суммировали некоторую ключевую информацию о классах адресов IPv4.
Tables 12-6 and 12-7 show sparse versions of these same tables.|Таблицы 12-6 и 12-7 показывают разреженные версии этих же таблиц.
To practice recalling those key facts, particularly the range of values in the first octet that identifies the address class, complete these tables.|Чтобы попрактиковаться в воспроизведении этих ключевых фактов, в частности диапазона значений в первом октете, который определяет класс адреса, заполните эти таблицы.
Then, refer to Tables 12-2 and 12-3 to check your answers.|Затем обратитесь к таблицам 12-2 и 12-3, чтобы проверить свои ответы.
Repeat this process until you can recall all the information in the tables.|Повторяйте этот процесс, пока не вспомните всю информацию в таблицах.
|
Table 12-6 Sparse Study Table Version of Table 12-2 Table end.|Таблица 12-6 Таблица разреженных исследований Версия таблицы 12-2 Конец таблицы.
|
Table 12-7 Sparse Study Table Version of Table 12-3 Table end.|Таблица 12-7 Таблица разреженных исследований Версия таблицы 12-3 Конец таблицы.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element for more details.|Обратитесь к элементу «Ваш учебный план» для получения более подробной информации.
Table 12-8 outlines the key review elements and where you can find them.|В Таблице 12-8 указаны основные элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 12-8 Chapter Review Tracking Table end.|Таблица 12-8 Окончание таблицы отслеживания обзора главы.
|
Key Terms You Should Know network, classful IP network, network number, network ID, network address, network broadcast address, network part, host part, default mask Additional Practice for This Chapter’s Processes For additional practice with analyzing classful networks, you may do a set of practice problems using your choice of tools:|Ключевые термины, которые вы должны знать сеть, классовая IP-сеть, номер сети, идентификатор сети, сетевой адрес, сетевой широковещательный адрес, сетевая часть, часть хоста, маска по умолчанию. Дополнительная практика для процессов, описанных в этой главе. Для дополнительной практики с анализом классовых сетей вы можете выполнить набор практических задач с использованием выбранных вами инструментов:
|
Application: Use the Analyzing Classful IPv4 Networks application on the companion website.|Приложение: используйте приложение "Анализ классовых сетей IPv4" на сопутствующем веб-сайте.
|
PDF: Alternatively, practice the same problems using companion website Appendix D, Answers to Earlier Practice Problems Table 12-5, shown earlier, listed several practice problems.|PDF: В качестве альтернативы попробуйте те же самые задачи, используя сопутствующий веб-сайт. Приложение D, ответы на предыдущие практические проблемы. Таблица 12-5, показанная ранее, перечисляет несколько практических проблем.
Table 12-10 lists the answers.|В Таблице 12-10 перечислены ответы.
|
Table 12-10 Practice Problems: Find the Network ID and Network Broadcast Table end.|Таблица 12-10 Практические проблемы: Найдите конец таблицы идентификаторов сети и сетевого вещания.
|
The class, number of network octets, and number of host octets all require you to look at the first octet of the IP address to determine the class.|Класс, количество сетевых октетов и количество октетов хоста - все это требует, чтобы вы смотрели на первый октет IP-адреса, чтобы определить класс.
If a value is between 1 and 126, inclusive, the address is a Class A address, with one network and three host octets.|Если значение находится в диапазоне от 1 до 126 включительно, это адрес класса A с одной сетью и тремя октетами хоста.
If a value is between 128 and 191 inclusive, the address is a Class B address, with two network and two host octets.|Если значение находится между 128 и 191 включительно, это адрес класса B с двумя сетевыми октетами и двумя октетами хоста.
If a value is between 192 and 223, inclusive, it is a Class C address, with three network octets and one host octet.|Если значение находится в диапазоне от 192 до 223 включительно, это адрес класса C с тремя октетами сети и одним октетом хоста.
|
The last two columns can be found based on Table 12-3, specifically the number of network and host octets along with the IP address.|Последние два столбца можно найти на основе таблицы 12-3, в частности, количества октетов сети и хоста, а также IP-адреса.
To find the network ID, copy the IP address, but change the host octets to 0.|Чтобы найти идентификатор сети, скопируйте IP-адрес, но измените октеты хоста на 0.
Similarly, to find the network broadcast address, copy the IP address, but change the host octets to 255.|Точно так же, чтобы найти сетевой широковещательный адрес, скопируйте IP-адрес, но измените октеты хоста на 255.
|
The last three problems can be confusing and were included on purpose so that you could see an example of these unusual cases, as follows.|Последние три проблемы могут сбивать с толку и были включены специально, чтобы вы могли увидеть следующий пример этих необычных случаев.
|
Answers to Practice Problem 7 (from Table 12-5)|Ответы на практическую задачу 7 (из таблицы 12-5)
|
Consider IP address 192.0.0.1.|Рассмотрим IP-адрес 192.0.0.1.
First, 192 is on the lower edge of the first octet range for Class C; as such, this address has three network and one host octet.|Во-первых, 192 находится на нижней границе диапазона первых октетов для класса C; как таковой, у этого адреса есть три октета сети и один октет хоста.
To find the network ID, copy the address, but change the single host octet (the fourth octet) to 0, for a network ID of 192.0.0.0.|Чтобы найти идентификатор сети, скопируйте адрес, но измените октет отдельного хоста (четвертый октет) на 0 для идентификатора сети 192.0.0.0.
It looks strange, but it is indeed the network ID.|Выглядит странно, но это действительно идентификатор сети.
|
The network broadcast address choice for problem 7 can also look strange.|Выбор сетевого широковещательного адреса для задачи 7 также может выглядеть странно.
To find the broadcast address, copy the IP address (192.0.0.1), but change the last octet (the only host octet) to 255, for a broadcast address of 192.0.0.255.|Чтобы найти широковещательный адрес, скопируйте IP-адрес (192.0.0.1), но измените последний октет (единственный октет хоста) на 255, для широковещательного адреса 192.0.0.255.
In particular, if you decide that the broadcast should be 192.255.255.255, you might have fallen into the trap of logic, like “Change all 0s in the network ID to 255s,” which is not the correct logic.|В частности, если вы решите, что широковещательная передача должна быть 192.255.255.255, вы могли попасть в ловушку логики, например «Изменить все нули в идентификаторе сети на 255», что не является правильной логикой.
Instead, change all host octets in the IP address (or network ID) to 255s.|Вместо этого измените все октеты хоста в IP-адресе (или идентификаторе сети) на 255.
|
Answers to Practice Problem 8 (from Table 12-5)|Ответы на практическую задачу 8 (из таблицы 12-5)
|
The first octet of problem 8 (191.255.1.47) sits on the upper edge of the Class B range for the first octet (128–191).|Первый октет задачи 8 (191.255.1.47) находится на верхнем крае диапазона класса B для первого октета (128–191).
As such, to find the network ID, change the last two octets (host octets) to 0, for a network ID of 191.255.0.0.|Таким образом, чтобы найти идентификатор сети, измените последние два октета (октета хоста) на 0 для идентификатора сети 191.255.0.0.
This value sometimes gives people problems because they are used to thinking that 255 somehow means the number is a broadcast address.|Это значение иногда доставляет людям проблемы, потому что они привыкли думать, что 255 каким-то образом означает, что число является широковещательным адресом.
|
The broadcast address, found by changing the two host octets to 255, means that the broadcast address is 191.255.255.255.|Широковещательный адрес, найденный путем изменения двух октетов хоста на 255, означает, что широковещательный адрес - 191.255.255.255.
It looks more like a broadcast address for a Class A network, but it is actually the broadcast address for Class B network 191.255.0.0.|Он больше похож на широковещательный адрес для сети класса A, но на самом деле это широковещательный адрес для сети класса B 191.255.0.0.
|
Answers to Practice Problem 9 (from Table 12-5)|Ответы на практическую задачу 9 (из таблицы 12-5)
|
Problem 9, with IP address 223.223.0.1, is near the high end of the Class C range.|Проблема 9 с IP-адресом 223.223.0.1 близка к верхнему пределу диапазона класса C.
As a result, only the last (host) octet is changed to 0 to form the network ID 223.223.0.0.|В результате только последний (хост) октет изменяется на 0 для формирования идентификатора сети 223.223.0.0.
It looks a little like a Class B network number at first glance because it ends in two octets of 0.|На первый взгляд это немного похоже на сетевой номер класса B, потому что заканчивается двумя октетами из 0.
However, it is indeed a Class C network ID (based on the value in the first octet).|Однако это действительно идентификатор сети класса C (на основе значения в первом октете).
## Chapter 13 Analyzing Subnet Masks
Глава 13 Анализ масок подсети   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.6 Configure and verify IPv4 addressing and subnetting
1.6 Настройка и проверка адресации IPv4 и подсетей   
__|__
--|--
|
The subnet mask used in one or many subnets in an IP internetwork says a lot about the intent of the subnet design.|Маска подсети, используемая в одной или нескольких подсетях в объединенной IP-сети, многое говорит о предназначении структуры подсети.
First, the mask divides addresses into two parts: prefix and host, with the host part defining the size of the subnet.|Во-первых, маска делит адреса на две части: префикс и хост, причем часть хоста определяет размер подсети.
Then, the class (A, B, or C) further divides the structure of addresses in a subnet, breaking the prefix part into the network and subnet parts.|Затем класс (A, B или C) дополнительно разделяет структуру адресов в подсети, разбивая часть префикса на части сети и подсети.
The subnet part defines the number of subnets that could exist inside one classful IP network, assuming that one mask is used throughout the classful network.|Часть подсети определяет количество подсетей, которые могут существовать внутри одной классовой IP-сети, предполагая, что одна маска используется во всей классовой сети.
|
The subnet mask holds the key to understanding several important subnetting design points.|Маска подсети содержит ключ к пониманию нескольких важных моментов проектирования подсетей.
|
However, to analyze a subnet mask, you first need some basic math skills with masks.|Однако, чтобы проанализировать маску подсети, вам сначала понадобятся некоторые базовые математические навыки с масками.
The math converts masks between the three different formats used to represent a mask:|Математика преобразует маски между тремя различными форматами, используемыми для представления маски:
###### Binary
Двоичный   
###### Dotted-decimal notation (DDN)
Десятичная запись с точками (DDN)   
###### Prefix (also called classless interdomain routing [CIDR])
Префикс (также называемый бесклассовой междоменной маршрутизацией [CIDR])   
__|__
--|--
|
This chapter has two major sections.|Эта глава состоит из двух основных разделов.
The first focuses on the mask formats and the math used to convert between the three formats.|Первый фокусируется на форматах масок и математике, используемых для преобразования между тремя форматами.
The second section explains how to take an IP address and its subnet mask and analyze those values.|Во втором разделе объясняется, как взять IP-адрес и его маску подсети и проанализировать эти значения.
In particular, it shows how to determine the three-part format of the IPv4 address and describes the facts about the subnetting design that are implied by the mask.|В частности, он показывает, как определить трехкомпонентный формат адреса IPv4, и описывает факты о структуре подсети, которые подразумеваются маской.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 13-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 13-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### Subnet Mask Conversion
Преобразование маски подсети   
__|__
--|--
|
Defining the Format of IPv4 Addresses 4–7 CHAPTER 13 1.|Определение формата адресов IPv4 4–7 ГЛАВА 13 1.
Which of the following answers lists the prefix (CIDR) format equivalent of 255.255.254.0?|В каком из следующих ответов указан формат префикса (CIDR), эквивалентный 255.255.254.0?
|
a. /19 b. /20 c. /23 d. /24 e. /25 2.|а. / 19 б. / 20 с. / 23 дн. / 24 шт. / 25 2.
Which of the following answers lists the prefix (CIDR) format equivalent of 255.255.255.240?|В каком из следующих ответов указан формат префикса (CIDR), эквивалентный 255.255.255.240?
|
a. /26 b. /28 c. /27 d. /30 e. /29 3.|а. / 26 б. / 28 с. / 27 дн. / 30 шт. / 29 3.
Which of the following answers lists the dotted-decimal notation (DDN) equivalent of /30?|В каком из следующих ответов приводится десятичная нотация с разделительными точками (DDN), эквивалентная / 30?
|
a. 255.255.255.192 b. 255.255.255.252 c. 255.255.255.240 d. 255.255.254.0 e. 255.255.255.0 4.|а. 255.255.255.192 б. 255.255.255.252 с. 255.255.255.240 г. 255.255.254.0 e. 255.255.255.0 4.
Working at the help desk, you receive a call and learn a user’s PC IP address and mask (10.55.66.77, mask 255.255.255.0).|Работая в справочной службе, вы получаете звонок и узнаете IP-адрес и маску ПК пользователя (10.55.66.77, маска 255.255.255.0).
When thinking about this using classful logic, you determine the number of network (N), subnet (S), and host (H) bits.|Думая об этом, используя классовую логику, вы определяете количество битов сети (N), подсети (S) и хоста (H).
Which of the following is true in this case?|Что из следующего верно в данном случае?
|
a. N=12 b.|а. N = 12 б.
S=12 c.|S = 12 в.
H=8 d.|H = 8 дн.
S=8 e.|S = 8 эл.
N=24 5.|N = 24 5.
Working at the help desk, you receive a call and learn a user’s PC IP address and mask (192.168.9.1/27).|Работая в справочной службе, вам позвонят и вы узнаете IP-адрес и маску компьютера пользователя (192.168.9.1/27).
When thinking about this using classful logic, you determine the number of network (N), subnet (S), and host (H) bits.|Думая об этом, используя классовую логику, вы определяете количество битов сети (N), подсети (S) и хоста (H).
Which of the following is true in this case?|Что из следующего верно в данном случае?
|
a. N=24 b.|а. N = 24 б.
S=24 c.|S = 24 с.
H=8 d.|H = 8 дн.
H=7 6.|Н = 7 6.
Which of the following statements is true about classless IP addressing concepts?|Какое из следующих утверждений относительно концепции бесклассовой IP-адресации верно?
|
a. Uses a 128-bit IP address b.|а. Использует 128-битный IP-адрес. B.
Applies only for Class A and B networks c.|Применимо только для сетей классов A и B c.
Separates IP addresses into network, subnet, and host parts d.|Разделяет IP-адреса на части сети, подсети и хоста d.
Ignores Class A, B, and C network rules 7.|Игнорирует сетевые правила классов A, B и C 7.
Which of the following masks, when used as the only mask within a Class B network, would supply enough subnet bits to support 100 subnets? (Choose two.)|Какая из следующих масок при использовании в качестве единственной маски в сети класса B предоставит достаточно битов подсети для поддержки 100 подсетей? (Выберите два.)
|
a. /24 b. 255.255.255.252 c. /20 d. 255.255.252.0 Foundation Topics Subnet Mask Conversion This section describes how to convert between different formats for the subnet mask.|а. / 24 б. 255.255.255.252 с. / 20 дн. 255.255.252.0 Основные темы Преобразование маски подсети В этом разделе описывается, как преобразовать между различными форматами маски подсети.
You can then use these processes when you practice.|Затем вы можете использовать эти процессы во время практики.
If you already know how to convert from one format to the other, go ahead and move to the section “Practice Converting Subnet Masks,” later in this chapter.|Если вы уже знаете, как преобразовывать из одного формата в другой, перейдите к разделу «Практика преобразования масок подсети» далее в этой главе.
#### Three Mask Formats
Три формата маски   
__|__
--|--
|
Subnet masks can be written as 32-bit binary numbers, but not just any binary number.|Маски подсети могут быть записаны как 32-битные двоичные числа, но не как любое двоичное число.
In particular, the binary subnet mask must follow these rules:|В частности, двоичная маска подсети должна соответствовать следующим правилам:
###### The value must not interleave 1s and 0s.
Значение не должно чередоваться 1 и 0.   
###### If 1s exist, they are on the left.
Если единицы существуют, они находятся слева.   
###### If 0s exist, they are on the right.
Если есть нули, они справа.   
__|__
--|--
|
For example, the following values would be illegal.|Например, следующие значения будут недопустимыми.
The first is illegal because the value interleaves 0s and 1s, and the second is illegal because it lists 0s on the left and 1s on the right:|Первое недопустимо, потому что значение чередуется с 0 и 1, а второе недопустимо, потому что оно перечисляет 0 слева и 1 справа:
|
10101010 01010101 11110000 00001111 00000000 00000000 00000000 11111111 The following two binary values meet the requirements, in that they have all 1s on the left, followed by all 0s, with no interleaving of 1s and 0s:|10101010 01010101 11110000 00001111 00000000 00000000 00000000 11111111 Следующие два двоичных значения соответствуют требованиям, так как у них есть все единицы слева, за которыми следуют все нули, без чередования единиц и нулей:
|
11111111 00000000 00000000 00000000 11111111 11111111 11111111 00000000 Two alternative subnet mask formats exist so that we humans do not have to work with 32-bit binary numbers.|11111111 00000000 00000000 00000000 11111111 11111111 11111111 00000000 Существуют два альтернативных формата маски подсети, так что людям не нужно работать с 32-битными двоичными числами.
One format, dotted-decimal notation (DDN), converts each set of 8 bits into the decimal equivalent.|Один формат, десятичное представление с разделительными точками (DDN), преобразует каждый набор из 8 бит в десятичный эквивалент.
For example, the two previous binary masks would convert to the following DDN subnet masks because binary 11111111 converts to decimal 255, and binary 00000000 converts to decimal 0:|Например, две предыдущие двоичные маски будут преобразованы в следующие маски подсети DDN, поскольку двоичный код 11111111 преобразуется в десятичное число 255, а двоичное 00000000 преобразуется в десятичное число 0:
|
255.0.0.0 255.255.255.0 Although the DDN format has been around since the beginning of IPv4 addressing, the third mask format was added later, in the early 1990s: the prefix format.|255.0.0.0 255.255.255.0 Хотя формат DDN существует с самого начала адресации IPv4, третий формат маски был добавлен позже, в начале 1990-х: формат префикса.
This format takes advantage of the rule that the subnet mask starts with some number of 1s, and then the rest of the digits are 0s.|В этом формате используется правило, согласно которому маска подсети начинается с некоторого числа единиц, а затем остальные цифры равны 0.
Prefix format lists a slash (/) followed by the number of binary 1s in the binary mask.|В формате префикса отображается косая черта (/), за которой следует количество двоичных единиц в двоичной маске.
Using the same two examples as earlier in this section, the prefix format equivalent masks are as follows:|Используя те же два примера, что и ранее в этом разделе, эквивалентные маски формата префикса следующие:
|
/8 /24 Note that although the terms prefix or prefix mask can be used, the terms CIDR mask or slash mask can also be used.|/ 8/24 Обратите внимание, что, хотя могут использоваться термины «префиксная маска» или «маска префикса», также могут использоваться термины «маска CIDR» или «маска косой черты».
This newer prefix style mask was created around the same time as the classless interdomain routing (CIDR) specification back in the early 1990s, and the acronym CIDR grew to be used for anything related to CIDR, including prefix-style masks.|Эта более новая маска стиля префикса была создана примерно в то же время, что и спецификация бесклассовой междоменной маршрутизации (CIDR) в начале 1990-х годов, а аббревиатура CIDR стала использоваться для всего, что связано с CIDR, включая маски в стиле префикса.
|
In addition, the term slash mask is sometimes used because the value includes a slash mark (/).|Кроме того, иногда используется термин маска косой черты, потому что значение включает косую черту (/).
|
You need to get comfortable working with masks in different formats.|Вам нужно научиться работать с масками разных форматов.
The rest of this section examines how to convert between the three formats.|Остальная часть этого раздела исследует, как конвертировать между тремя форматами.
#### Converting Between Binary and Prefix Masks
Преобразование между двоичной и префиксной масками   
__|__
--|--
|
Converting between binary and prefix masks should be relatively intuitive after you know that the prefix value is simply the number of binary 1s in the binary mask.|Преобразование между двоичной маской и маской префикса должно быть относительно интуитивно понятным, если вы знаете, что значение префикса - это просто количество двоичных единиц в двоичной маске.
For the sake of completeness, the processes to convert in each direction are Binary to prefix: Count the number of binary 1s in the binary mask, and write the total, in decimal, after a /.|Для полноты, процессы для преобразования в каждом направлении являются двоичными для префикса: подсчитайте количество двоичных единиц в двоичной маске и запишите общее количество в десятичном виде после /.
|
Prefix to binary: Write P binary 1s, where P is the prefix value, followed by as many binary 0s as required to create a 32-bit number.|Префикс в двоичный: запишите P двоичных единиц, где P - значение префикса, за которым следует столько двоичных нулей, сколько требуется для создания 32-разрядного числа.
|
Tables 13-2 and 13-3 show some examples.|В таблицах 13-2 и 13-3 приведены некоторые примеры.
|
Table 13-2 Example Conversions: Binary to Prefix Table end.|Таблица 13-2 Пример преобразования: двоичный код в конец таблицы префиксов.
|
Table 13-3 Example Conversions: Prefix to Binary Table end.|Таблица 13-3 Пример преобразования: Префикс в конец двоичной таблицы.
#### Converting Between Binary and DDN Masks
Преобразование между двоичной маской и маской DDN   
__|__
--|--
|
By definition, a dotted-decimal number (DDN) used with IPv4 addressing contains four decimal numbers, separated by dots.|По определению, десятичное число с точками (DDN), используемое с адресацией IPv4, содержит четыре десятичных числа, разделенных точками.
Each decimal number represents 8 bits.|Каждое десятичное число представляет 8 бит.
So, a single DDN shows four decimal numbers that together represent some 32-bit binary number.|Итак, один DDN показывает четыре десятичных числа, которые вместе представляют 32-битное двоичное число.
|
Conversion from a DDN mask to the binary equivalent is relatively simple to describe but can be laborious to perform.|Преобразование маски DDN в двоичный эквивалент относительно просто описать, но может быть трудоемким в выполнении.
First, to do the conversion, the process is as follows:|Во-первых, процесс преобразования выглядит следующим образом:
|
For each octet, perform a decimal-to-binary conversion.|Для каждого октета выполните десятичное преобразование в двоичное.
|
However, depending on your comfort level with doing decimal-to-binary conversions, that process can be difficult or time-consuming.|Однако, в зависимости от вашего уровня комфорта при преобразовании десятичных чисел в двоичные, этот процесс может быть трудным или длительным.
If you want to think about masks in binary for the exam, consider picking one of the following methods to do the conversion and practicing until you can do it quickly and accurately:|Если вы хотите подумать о масках в двоичном формате для экзамена, подумайте о выборе одного из следующих методов для преобразования и тренировки, пока вы не сможете сделать это быстро и точно:
###### Do the decimal-binary conversions, but practice your decimal-binary conversions to
Выполняйте десятично-двоичные преобразования, но практикуйте десятично-двоичные преобразования в   
__|__
--|--
|
become faster.|стать быстрее.
If you choose this path, consider the Cisco Binary Game, which you can find by searching its name at the Cisco Learning Network (CLN) (http://|Если вы выберете этот путь, рассмотрите бинарную игру Cisco, которую вы можете найти, выполнив поиск по ее названию в Cisco Learning Network (CLN) (http: //
|
learningnetwork.cisco.com).|learningnetwork.cisco.com).
###### Use the decimal-binary conversion chart in Appendix A, “Numeric Reference Tables.” This
Воспользуйтесь таблицей преобразования десятичного и двоичного числа в Приложении A, «Цифровые справочные таблицы». Этот   
__|__
--|--
|
lets you find the answer more quickly now, but you cannot use the chart on exam day.|позволяет быстрее найти ответ, но вы не можете использовать таблицу в день экзамена.
###### Memorize the nine possible decimal values that can be in a decimal mask, and practice
Запомните девять возможных десятичных значений, которые могут быть в десятичной маске, и потренируйтесь   
__|__
--|--
|
using a reference table with those values.|используя справочную таблицу с этими значениями.
|
The third method, which is the method recommended in this book, takes advantage of the fact that any and every DDN mask octet must be one of only nine values.|Третий метод, рекомендуемый в этой книге, использует тот факт, что любой октет маски DDN должен иметь одно из девяти значений.
Why?|Зачем?
Well, remember how a binary mask cannot interleave 1s and 0s, and the 0s must be on the right?|Хорошо, помните, как двоичная маска не может чередовать единицы и нули, а нули должны быть справа?
|
It turns out that only nine different 8-bit binary numbers conform to these rules.|Оказывается, этим правилам соответствуют только девять различных 8-битных двоичных чисел.
Table 13-4 lists the values, along with other relevant information.|В Таблице 13-4 перечислены значения вместе с другой соответствующей информацией.
|
Answers to the “Do I Know This Already?” quiz:|Ответы на вопрос «Знаю ли я это уже?» викторина:
|
1 C 2 B 3 B 4 C 5 A 6 D 7 A, B Table 13-4 Nine Possible Values in One Octet of a Subnet Mask Table end.|1 C 2 B 3 B 4 C 5 A 6 D 7 A, B Таблица 13-4 Девять возможных значений в одном октете конца таблицы масок подсети.
|
Many subnetting processes can be done with or without binary math.|Многие процессы разделения на подсети могут выполняться с использованием двоичной математики или без нее.
Some of those processes—|Некоторые из этих процессов -
|
mask conversion included—use the information in Table 13-4.|преобразование маски включено - используйте информацию из Таблицы 13-4.
You should plan to memorize the information in the table.|Вы должны спланировать запоминание информации, содержащейся в таблице.
I recommend making a copy of the table to keep handy while you practice. (You will likely memorize the contents of this table simply by practicing the conversion process enough to get both good and fast at the conversion.)|Я рекомендую сделать копию таблицы, чтобы держать ее под рукой во время практики. (Вы, вероятно, запомните содержимое этой таблицы, просто попрактиковавшись в процессе преобразования, чтобы добиться хорошего и быстрого преобразования.)
|
Using the table, the conversion processes in each direction with binary and decimal masks are as follows:|Используя таблицу, процессы преобразования в каждом направлении с двоичной и десятичной масками следующие:
|
Binary to decimal: Organize the bits into four sets of eight.|Из двоичного в десятичное: разделите биты на четыре набора по восемь.
For each octet, find the binary value in the table and write down the corresponding decimal value.|Для каждого октета найдите двоичное значение в таблице и запишите соответствующее десятичное значение.
|
Decimal to binary: For each octet, find the decimal value in the table and write down the corresponding 8-bit binary value.|Десятичное в двоичное: для каждого октета найдите десятичное значение в таблице и запишите соответствующее 8-битное двоичное значение.
|
Tables 13-5 and 13-6 show some examples.|В таблицах 13-5 и 13-6 приведены некоторые примеры.
|
Table 13-5 Conversion Example: Binary to Decimal Table end.|Таблица 13-5 Пример преобразования: конец таблицы двоичных чисел в десятичные.
|
Table 13-6 Conversion Examples: Decimal to Binary Table end.|Таблица 13-6 Примеры преобразования: конец таблицы из десятичного числа в двоичный.
#### Converting Between Prefix and DDN Masks
Преобразование между масками префикса и DDN   
__|__
--|--
|
When you are learning, the best way to convert between the prefix and decimal formats is to first convert to binary.|Когда вы учитесь, лучший способ преобразования между префиксным и десятичным форматами - это сначала преобразовать в двоичный.
For example, to move from decimal to prefix, first convert decimal to binary and then from binary to prefix.|Например, чтобы перейти от десятичного числа к префиксному, сначала преобразуйте десятичное число в двоичное, а затем из двоичного числа в префиксное.
|
For the exams, set a goal to master these conversions doing the math in your head.|Перед экзаменами поставьте цель овладеть этими преобразованиями, вычисляя в уме.
While learning, you will likely want to use paper.|Во время обучения вы, вероятно, захотите использовать бумагу.
To train yourself to do all this without writing it down, instead of writing each octet of binary, just write the number of binary 1s in that octet.|Чтобы научиться делать все это без записи, вместо записи каждого октета двоичного кода просто запишите количество двоичных единиц в этом октете.
|
Figure 13-1 shows an example with a prefix-to-decimal conversion.|На рис. 13-1 показан пример преобразования префикса в десятичный.
The left side shows the conversion to binary as an interim step.|Слева показано преобразование в двоичное в качестве промежуточного шага.
For comparison, the right side shows the binary interim step in shorthand that just lists the number of binary 1s in each octet of the binary mask.|Для сравнения, правая сторона в сокращенном виде показывает двоичный промежуточный шаг, который просто перечисляет количество двоичных единиц в каждом октете двоичной маски.
|
Figure 13-1 Conversion from Prefix to Decimal: Full Binary Versus Shorthand Similarly, when converting from decimal to prefix, mentally convert to binary along the way, and as you improve, just think of the binary as the number of 1s in each octet.|Рис. 13-1. Преобразование из префикса в десятичное: полное двоичное или сокращенное. Аналогично, при преобразовании из десятичного в префиксный, мысленно конвертируйте в двоичный код по пути, и по мере улучшения просто думайте о двоичном виде как о количестве единиц в каждом октете.
Figure 13-2 shows an example of such a conversion.|На рис. 13-2 показан пример такого преобразования.
|
Figure 13-2 Conversion from Decimal to Prefix: Full Binary Versus Shorthand Note that Appendix A has a table that lists all 33 legal subnet masks, with all three formats shown.|Рис. 13-2. Преобразование десятичного числа в префиксное: сравнение полного двоичного представления с сокращенным Обратите внимание, что в Приложении A есть таблица, в которой перечислены все 33 допустимые маски подсети со всеми тремя показанными форматами.
#### Practice Converting Subnet Masks
Практика преобразования масок подсети   
__|__
--|--
|
Before moving to the second half of this chapter, and thinking about what these subnet masks mean, first do some practice.|Прежде чем перейти ко второй половине этой главы и подумать о том, что означают эти маски подсети, сначала потренируйтесь.
Practice the processes discussed in this chapter until you get the right answer most of the time.|Практикуйте процессы, описанные в этой главе, пока в большинстве случаев вы не получите правильный ответ.
Later, before taking the exam, practice more until you master the topics in this chapter and can move pretty fast, as outlined in the right column of Table 13-7.|Позже, перед сдачей экзамена, потренируйтесь больше, пока не овладеете темами этой главы и не сможете продвигаться довольно быстро, как показано в правом столбце Таблицы 13-7.
|
Table 13-7 Keep-Reading and Take-Exam Goals for This Chapter’s Topics Table end.|Таблица 13-7 Цели «Продолжайте читать и сдавать экзамен» в конце таблицы тем этой главы.
|
Table 13-8 lists eight practice problems.|В таблице 13-8 перечислены восемь практических задач.
The table has three columns, one for each mask format.|В таблице есть три столбца, по одному для каждого формата маски.
|
Each row lists one mask, in one format.|Каждая строка содержит одну маску в одном формате.
Your job is to find the mask’s value in the other two formats for each row.|Ваша задача - найти значение маски в двух других форматах для каждой строки.
Table 13-12, located in the section “Answers to Earlier Practice Problems,” later in this chapter, lists the answers.|Таблица 13-12, расположенная в разделе «Ответы на более ранние практические проблемы» далее в этой главе, содержит ответы на эти вопросы.
|
Table 13-8 Practice Problems: Find the Mask Values in the Other Two Formats Table end.|Таблица 13-8 Практические задачи: Найдите значения маски в конце таблицы двух других форматов.
### Identifying Subnet Design Choices Using Masks
Определение вариантов дизайна подсети с помощью масок   
__|__
--|--
|
Subnet masks have many purposes.|Маски подсети имеют множество целей.
In fact, if ten experienced network engineers were independently asked, “What is the purpose of a subnet mask?” the engineers would likely give a variety of true answers.|Фактически, если бы десять опытных сетевых инженеров независимо друг от друга спросили: «Какова цель маски подсети?» инженеры, вероятно, дадут множество правильных ответов.
The subnet mask plays several roles.|Маска подсети играет несколько ролей.
|
This chapter focuses on one particular use of a subnet mask: defining the prefix part of the IP addresses in a subnet.|В этой главе основное внимание уделяется одному конкретному использованию маски подсети: определению префиксной части IP-адресов в подсети.
The prefix part must be the same value for all addresses in a subnet.|Часть префикса должна иметь одно и то же значение для всех адресов в подсети.
|
In fact, a single subnet can be defined as all IPv4 addresses that have the same value in the prefix part of their IPv4 addresses.|Фактически, одна подсеть может быть определена как все адреса IPv4, которые имеют одинаковое значение в префиксной части своих адресов IPv4.
|
While the previous paragraph might sound a bit formal, the idea is relatively basic, as shown in Figure 13-3.|Хотя предыдущий абзац может показаться немного формальным, идея относительно проста, как показано на рис. 13-3.
The figure shows a network diagram, focusing on two subnets: a subnet of all addresses that begin with 172.16.2 and another subnet made of all addresses that begin with 172.16.3.|На рисунке показана сетевая диаграмма с акцентом на две подсети: подсеть, состоящая из всех адресов, начинающихся с 172.16.2, и другая подсеть, состоящая из всех адресов, начинающихся с 172.16.3.
In this example, the prefix—the part that has the same value in all the addresses in the subnet—is the first three octets.|В этом примере префикс - часть, которая имеет одинаковое значение во всех адресах в подсети, - это первые три октета.
|
Figure 13-3 Simple Subnet Design, with Mask /24 While people can sit around a conference table and talk about how a prefix is three octets long, computers communicate that same concept using a subnet mask.|Рис. 13-3. Простая конструкция подсети с маской / 24 Пока люди могут сидеть за столом для переговоров и обсуждать длину префикса в три октета, компьютеры передают ту же концепцию, используя маску подсети.
In this case, the subnets use a subnet mask of /24, which means that the prefix part of the addresses is 24 bits (3 octets) long.|В этом случае подсети используют маску подсети / 24, что означает, что префиксная часть адресов имеет длину 24 бита (3 октета).
|
This section explains more about how to use a subnet mask to understand this concept of a prefix part of an IPv4 address, along with these other uses for a subnet mask.|В этом разделе объясняется, как использовать маску подсети, чтобы понять эту концепцию префиксной части IPv4-адреса, а также другие способы использования маски подсети.
Note that this section discusses the first five items in the list.|Обратите внимание, что в этом разделе обсуждаются первые пять пунктов списка.
###### Defines the size of the prefix (combined network and subnet) part of the addresses in a
Определяет размер префиксной (объединенной сети и подсети) части адресов в   
__|__
--|--
|
subnet|подсеть
###### Defines the size of the host part of the addresses in the subnet
Определяет размер хостовой части адресов в подсети   
###### Can be used to calculate the number of hosts in the subnet
Может использоваться для расчета количества хостов в подсети   
###### Provides a means for the network designer to communicate the design details—the number
Предоставляет разработчику сети средство сообщить подробности проекта - число   
__|__
--|--
|
of subnet and host bits—to the devices in the network|бит подсети и хоста - к устройствам в сети
###### Under certain assumptions, can be used to calculate the number of subnets in the entire
При определенных предположениях может использоваться для расчета количества подсетей во всем   
__|__
--|--
|
classful network|классная сеть
###### Can be used in binary calculations of both the subnet ID and the subnet broadcast
Может использоваться в двоичных вычислениях как идентификатора подсети, так и широковещательной передачи подсети.   
__|__
--|--
|
address|адрес
#### Masks Divide the Subnet’s Addresses into Two Parts
Маски разделяют адреса подсети на две части   
__|__
--|--
|
The subnet mask subdivides the IP addresses in a subnet into two parts: the prefix, or subnet part, and the host part.|Маска подсети подразделяет IP-адреса в подсети на две части: префикс или часть подсети и часть хоста.
|
The prefix part identifies the addresses that reside in the same subnet because all IP addresses in the same subnet have the same value in the prefix part of their addresses.|Часть префикса определяет адреса, которые находятся в одной подсети, потому что все IP-адреса в одной подсети имеют одинаковое значение в префиксной части своих адресов.
The idea is much like the postal code (ZIP codes in the United States) in mailing addresses.|Идея очень похожа на почтовый индекс (почтовые индексы в США) в почтовых адресах.
All mailing addresses in the same town have the same postal code.|Все почтовые адреса в одном городе имеют одинаковый почтовый индекс.
Likewise, all IP addresses in the same subnet have identical values in the prefix part of their addresses.|Точно так же все IP-адреса в одной подсети имеют одинаковые значения в префиксной части своих адресов.
|
The host part of an address identifies the host uniquely inside the subnet.|Часть адреса, относящаяся к хосту, однозначно идентифицирует хост внутри подсети.
If you compare any two IP addresses in the same subnet, their host parts will differ, even though the prefix parts of their addresses have the same value.|Если вы сравните любые два IP-адреса в одной подсети, их части хоста будут отличаться, даже если части префиксов их адресов имеют одинаковое значение.
To summarize these key comparisons:|Подводя итог этим ключевым сравнениям:
|
Prefix (subnet) part: Equal in all addresses in the same subnet.|Часть префикса (подсети): равны для всех адресов в одной подсети.
|
Host part: Different in all addresses in the same subnet.|Часть хоста: разные адреса в одной подсети.
|
For example, imagine a subnet that, in concept, includes all addresses whose first three octets are 10.1.1.|Например, представьте себе подсеть, которая по идее включает в себя все адреса, первые три октета которых равны 10.1.1.
So, the following list shows several addresses in this subnet:|Итак, следующий список показывает несколько адресов в этой подсети:
###### 10.1.1.1
10.1.1.1   
###### 10.1.1.2
10.1.1.2   
###### 10.1.1.3
10.1.1.3   
__|__
--|--
|
In this list, the prefix or subnet part (the first three octets of 10.1.1) are equal.|В этом списке префикс или часть подсети (первые три октета 10.1.1) равны.
The host part (the last octet [in bold]) is different.|Часть хоста (последний октет [выделено жирным шрифтом]) отличается.
So, the prefix or subnet part of the address identifies the group, and the host part identifies the specific member of the group.|Таким образом, префикс или часть подсети в адресе идентифицируют группу, а часть хоста идентифицирует конкретного члена группы.
|
The subnet mask defines the dividing line between the prefix and the host part.|Маска подсети определяет разделительную линию между префиксом и частью хоста.
To do so, the mask creates a conceptual line between the binary 1s in the binary mask and the binary 0s in the mask.|Для этого маска создает концептуальную линию между двоичными единицами в двоичной маске и двоичными нулями в маске.
In short, if a mask has P binary 1s, the prefix part is P bits long and the rest of the bits are host bits.|Короче говоря, если маска имеет P двоичных единиц, часть префикса имеет длину P бит, а остальные биты являются битами хоста.
Figure 13-4 shows the general concept.|На рис. 13-4 показана общая концепция.
|
Figure 13-4 Prefix (Subnet) and Host Parts Defined by Mask 1s and 0s The next figure, Figure 13-5, shows a specific example using mask 255.255.255.0.|Рисунок 13-4 Префикс (подсеть) и части хоста, определяемые маской 1 и 0 На следующем рисунке, Рисунок 13-5, показан конкретный пример с использованием маски 255.255.255.0.
Mask 255.255.255.0 (/24) has 24 binary 1s, for a prefix length of 24 bits.|Маска 255.255.255.0 (/ 24) имеет 24 двоичных единицы для длины префикса 24 бита.
|
Figure 13-5 Mask 255.255.255.0: P=24, H=8|Рисунок 13-5 Маска 255.255.255.0: P = 24, H = 8
#### Masks and Class Divide Addresses into Three Parts
Маски и классы разделяют адреса на три части   
__|__
--|--
|
In addition to the two-part view of IPv4 addresses, you can also think about IPv4 addresses as having three parts.|В дополнение к двухчастному представлению адресов IPv4, вы также можете рассматривать адреса IPv4 как состоящие из трех частей.
To do so, just apply Class A, B, and C rules to the address format to define the network part at the beginning of the address.|Для этого просто примените правила классов A, B и C к формату адреса, чтобы определить сетевую часть в начале адреса.
This added logic divides the prefix into two parts: the network part and the subnet part.|Эта добавленная логика делит префикс на две части: сетевая часть и часть подсети.
The class defines the length of the network part, with the subnet part simply being the rest of the prefix.|Класс определяет длину сетевой части, при этом часть подсети является просто остальной частью префикса.
Figure 13-6 shows the idea.|На рис. 13-6 показана идея.
|
Figure 13-6 Class Concepts Applied to Create Three Parts The combined network and subnet parts act like the prefix because all addresses in the same subnet must have identical values in the network and subnet parts.|Рис. 13-6. Концепции классов, применяемые для создания трех частей Объединенные части сети и подсети действуют как префикс, потому что все адреса в одной подсети должны иметь одинаковые значения в частях сети и подсети.
The size of the host part remains unchanged, whether viewing the addresses as having two parts or three parts.|Размер основной части остается неизменным, независимо от того, рассматриваются ли адреса как состоящие из двух или трех частей.
|
To be complete, Figure 13-7 shows the same example as in the previous section, with the subnet of “all addresses that begin with 10.1.1.” In that example, the subnet uses mask 255.255.255.0, and the addresses are all in Class A network 10.0.0.0.|Для полноты картины на рис. 13-7 показан тот же пример, что и в предыдущем разделе, с подсетью «все адреса, начинающиеся с 10.1.1». В этом примере подсеть использует маску 255.255.255.0, и все адреса относятся к сети класса A 10.0.0.0.
The class defines 8 network bits, and the mask defines 24 prefix bits, meaning that 24 – 8 = 16 subnet bits exist.|Класс определяет 8 сетевых битов, а маска определяет 24 бита префикса, что означает, что существует 24-8 = 16 битов подсети.
|
The host part remains as 8 bits per the mask.|Часть хоста остается равной 8 битам на маску.
|
Figure 13-7 Subnet 10.1.1.0, Mask 255.255.255.0: N=8, S=16, H=8|Рисунок 13-7 Подсеть 10.1.1.0, маска 255.255.255.0: N = 8, S = 16, H = 8
#### Classless and Classful Addressing
Бесклассовая и классовая адресация   
__|__
--|--
|
The terms classless addressing and classful addressing refer to the two different ways to think about IPv4 addresses as described so far in this chapter.|Термины бесклассовая адресация и классовая адресация относятся к двум различным представлениям об адресах IPv4, описанных до сих пор в этой главе.
Classful addressing means that you think about Class A, B, and C rules, so the prefix is separated into the network and subnet parts, as shown in Figures 13-6 and 13-7.|Классовая адресация означает, что вы думаете о правилах классов A, B и C, поэтому префикс разделяется на части сети и подсети, как показано на рисунках 13-6 и 13-7.
Classless addressing means that you ignore the Class A, B, and C rules and treat the prefix part as one part, as shown in Figures 13-4 and 13-5.|Бесклассовая адресация означает, что вы игнорируете правила классов A, B и C и обрабатываете часть префикса как одну часть, как показано на рисунках 13-4 и 13-5.
The following more formal definitions are listed for reference and study:|Для справки и изучения приведены следующие более формальные определения:
|
Classless addressing: The concept that an IPv4 address has two parts—the prefix part plus the host part—as defined by the mask, with no consideration of the class (A, B, or C).|Бесклассовая адресация: концепция, согласно которой IPv4-адрес состоит из двух частей - части префикса и части хоста - как определено маской, без учета класса (A, B или C).
|
Classful addressing: The concept that an IPv4 address has three parts—network, subnet, and host—as defined by the mask and Class A, B, and C rules.|Классовая адресация: концепция, согласно которой IPv4-адрес состоит из трех частей - сети, подсети и хоста - в соответствии с маской и правилами классов A, B и C.
|
NOTE Unfortunately, the networking world uses the terms classless and classful in a couple of different ways.|ПРИМЕЧАНИЕ. К сожалению, в мире сетей термины бесклассовый и классовый используются по-разному.
In addition to the classless and classful addressing described here, each routing protocol can be categorized as either a classless routing protocol or a classful routing protocol.|В дополнение к бесклассовой и классовой адресации, описанной здесь, каждый протокол маршрутизации может быть отнесен к категории бесклассовых протоколов маршрутизации или классовых протоколов маршрутизации.
In another use, the terms classless routing and classful routing refer to some details of how Cisco routers forward (route) packets using the default route in some cases.|В другом случае термины бесклассовая маршрутизация и классовая маршрутизация относятся к некоторым деталям того, как маршрутизаторы Cisco пересылают (маршрутизируют) пакеты, используя в некоторых случаях маршрут по умолчанию.
As a result, these terms can be easily confused and misused.|В результате эти термины можно легко спутать или неправильно использовать.
So, when you see the words classless and classful, be careful to note the context: addressing, routing, or routing protocols.|Итак, когда вы видите слова «бесклассовый» и «классовый», обратите внимание на контекст: адресация, маршрутизация или протоколы маршрутизации.
#### Calculations Based on the IPv4 Address Format
Расчеты на основе формата адреса IPv4   
__|__
--|--
|
After you know how to break an address down using both classless and classful addressing rules, you can easily calculate a couple of important facts using some basic math formulas.|После того, как вы узнаете, как разбить адрес, используя как бесклассовые, так и классовые правила адресации, вы можете легко вычислить несколько важных фактов, используя некоторые основные математические формулы.
|
First, for any subnet, after you know the number of host bits, you can calculate the number of host IP addresses in the subnet.|Во-первых, для любой подсети, зная количество битов хоста, вы можете рассчитать количество IP-адресов хоста в подсети.
Next, if you know the number of subnet bits (using classful addressing concepts) and you know that only one subnet mask is used throughout the network, you can also calculate the number of subnets in the network.|Затем, если вы знаете количество битов подсети (с использованием концепций классовой адресации) и знаете, что во всей сети используется только одна маска подсети, вы также можете рассчитать количество подсетей в сети.
The formulas just require that you know the powers of 2:|Формулы просто требуют знания степени двойки:
|
Hosts in the subnet: 2H – 2, where H is the number of host bits.|Хосты в подсети: 2H - 2, где H - количество бит хоста.
|
Subnets in the network: 2S, where S is the number of subnet bits.|Подсети в сети: 2S, где S - количество бит подсети.
Only use this formula if only one mask is used throughout the network.|Используйте эту формулу только в том случае, если во всей сети используется только одна маска.
|
NOTE The section “Choose the Mask” in Chapter 11, “Perspectives on IPv4 Subnetting,”|ПРИМЕЧАНИЕ. Раздел «Выбор маски» в главе 11 «Перспективы разбиения на подсети IPv4»,
|
details many concepts related to masks, including comments about this assumption of one mask throughout a single Class A, B, or C network.|подробно описывает многие концепции, связанные с масками, включая комментарии по поводу этого предположения об одной маске во всей сети класса A, B или C.
|
The sizes of the parts of IPv4 addresses can also be calculated.|Также можно рассчитать размеры частей IPv4-адресов.
The math is basic, but the concepts are important.|Математика проста, но концепции важны.
Keeping in mind that IPv4 addresses are 32 bits long, the two parts with classless addressing must add up to 32 (P + H = 32), and with classful addressing, the three parts must add up to 32 (N + S + H = 32).|Принимая во внимание, что адреса IPv4 имеют длину 32 бита, две части с бесклассовой адресацией должны составлять до 32 (P + H = 32), а с классовой адресацией три части должны складываться до 32 (N + S + H = 32).
Figure 13-8 shows the relationships.|На рисунке 13-8 показаны отношения.
|
Figure 13-8 Relationship Between /P, N, S, and H You often begin with an IP address and mask, both when answering questions on the CCNA exam and when examining problems that occur in real networks.|Рисунок 13-8 Взаимосвязь между / P, N, S и H Вы часто начинаете с IP-адреса и маски, как при ответе на вопросы экзамена CCNA, так и при исследовании проблем, возникающих в реальных сетях.
Based on the information in this chapter and earlier chapters, you should be able to find all the information in Figure 13-8 and then calculate the number of hosts/subnet and the number of subnets in the network.|Основываясь на информации в этой и предыдущих главах, вы сможете найти всю информацию на рис. 13-8, а затем рассчитать количество хостов / подсетей и количество подсетей в сети.
|
For reference, the following process spells out the steps:|Для справки, следующий процесс описывает шаги:
|
Step 1.|Шаг 1.
Convert the mask to prefix format (/P) as needed. (See the earlier section “Practice Converting Subnet Masks” for review.)|При необходимости преобразуйте маску в формат префикса (/ P). (См. Предыдущий раздел «Практика преобразования масок подсети» для обзора.)
|
Step 2.|Шаг 2.
Determine N based on the class. (See Chapter 12, “Analyzing Classful IPv4 Networks,” for review.)|Определите N на основе класса. (См. Обзор в главе 12, «Анализ классовых сетей IPv4».)
|
Step 3.|Шаг 3.
Calculate S = P – N.|Вычислить S = P - N.
|
Step 4.|Шаг 4.
Calculate H = 32 – P.|Вычислить H = 32 - P.
|
Step 5.|Шаг 5.
Calculate hosts/subnet: 2H – 2.|Вычислить хосты / подсеть: 2H - 2.
|
Step 6.|Шаг 6.
Calculate number of subnets: 2S.|Подсчитайте количество подсетей: 2S.
|
For example, consider the case of IP address 8.1.4.5 with mask 255.255.0.0 by following this process:|Например, рассмотрим случай IP-адреса 8.1.4.5 с маской 255.255.0.0, выполнив этот процесс:
|
Step 1. 255.255.0.0 = /16, so P=16.|Шаг 1. 255.255.0.0 = / 16, поэтому P = 16.
|
Step 2. 8.1.4.5 is in the range 1–126 in the first octet, so it is Class A; so N=8.|Шаг 2. 8.1.4.5 находится в диапазоне 1–126 в первом октете, поэтому это класс A; так что N = 8.
|
Step 3.|Шаг 3.
S = P – N = 16 – 8 = 8.|S = P - N = 16-8 = 8.
|
Step 4.|Шаг 4.
H = 32 – P = 32 – 16 = 16.|H = 32 - P = 32 - 16 = 16.
|
Step 5. 216 – 2 = 65,534 hosts/subnet.|Шаг 5. 216-2 = 65 534 хоста / подсеть.
|
Step 6. 28 = 256 subnets.|Шаг 6. 28 = 256 подсетей.
|
Figure 13-9 shows a visual analysis of the same problem.|На рис. 13-9 показан визуальный анализ той же проблемы.
|
Figure 13-9 Visual Representation of Problem: 8.1.4.5, 255.255.0.0 For another example, consider address 200.1.1.1, mask 255.255.255.252 by following this process:|Рисунок 13-9 Визуальное представление проблемы: 8.1.4.5, 255.255.0.0 В качестве другого примера рассмотрим адрес 200.1.1.1, маска 255.255.255.252, выполнив этот процесс:
|
Step 1. 255.255.255.252 = /30, so P=30.|Шаг 1. 255.255.255.252 = / 30, поэтому P = 30.
|
Step 2. 200.1.1.1 is in the range 192–223 in the first octet, so it is Class C; so N=24.|Шаг 2. 200.1.1.1 находится в диапазоне 192–223 в первом октете, поэтому это класс C; Итак, N = 24.
|
Step 3.|Шаг 3.
S = P – N = 30 – 24 = 6.|S = P - N = 30-24 = 6.
|
Step 4.|Шаг 4.
H = 32 – P = 32 – 30 = 2.|H = 32 - P = 32 - 30 = 2.
|
Step 5. 22 – 2 = 2 hosts/subnet.|Шаг 5. 22 - 2 = 2 хоста / подсеть.
|
Step 6. 26 = 64 subnets.|Шаг 6. 26 = 64 подсети.
|
This example uses a popular mask for serial links because serial links only require two host addresses, and the mask supports only two host addresses.|В этом примере используется популярная маска для последовательных каналов, поскольку для последовательных каналов требуется только два адреса хоста, а маска поддерживает только два адреса хоста.
#### Practice Analyzing Subnet Masks
Практика анализа масок подсети   
__|__
--|--
|
As with the other subnetting math in this book, using a two-phase approach may help.|Как и в случае с другой математикой разбиения на подсети в этой книге, может помочь двухэтапный подход.
Take time now to practice until you feel as though you understand the process.|Найдите время для практики, пока не почувствуете, что понимаете этот процесс.
Then, before the exam, make sure you master the math.|Затем, перед экзаменом, убедитесь, что вы освоили математику.
Table 13-9 summarizes the key concepts and suggestions for this two-phase approach.|Таблица 13-9 суммирует ключевые концепции и предложения для этого двухэтапного подхода.
|
Table 13-9 Keep-Reading and Take-Exam Goals for This Chapter’s Topics Table end.|Таблица 13-9 Цели «Продолжайте читать и сдавать экзамен» в конце таблицы тем этой главы.
|
On a piece of scratch paper, answer the following questions.|На листе бумаги для заметок ответьте на следующие вопросы.
In each case:|В каждом случае:
###### Determine the structure of the addresses in each subnet based on the class and mask,
Определите структуру адресов в каждой подсети на основе класса и маски,   
__|__
--|--
|
using classful IP addressing concepts.|с использованием концепций классической IP-адресации.
In other words, find the size of the network, subnet, and host parts of the addresses.|Другими словами, найдите размер сети, подсети и части адресов хоста.
###### Calculate the number of hosts in the subnet.
Подсчитайте количество хостов в подсети.   
###### Calculate the number of subnets in the network, assuming that the same mask is used
Рассчитайте количество подсетей в сети, предполагая, что используется та же маска.   
__|__
--|--
|
throughout.|на протяжении.
|
1. 8.1.4.5, 255.255.254.0 2. 130.4.102.1, 255.255.255.0 3. 199.1.1.100, 255.255.255.0 4. 130.4.102.1, 255.255.252.0 5. 199.1.1.100, 255.255.255.224 The answers are listed in the section “Answers to Earlier Practice Problems,” later in this chapter.|1. 8.1.4.5, 255.255.254.0 2. 130.4.102.1, 255.255.255.0 3. 199.1.1.100, 255.255.255.0 4. 130.4.102.1, 255.255.252.0 5. 199.1.1.100, 255.255.255.224 Ответы перечислены в раздел «Ответы на более ранние практические проблемы» далее в этой главе.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element for more details.|Обратитесь к элементу «Ваш учебный план» для получения более подробной информации.
Table 13-10 outlines the key review elements and where you can find them.|В Таблице 13-10 представлены основные элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 13-10 Chapter Review Tracking Table end.|Таблица 13-10 Окончание таблицы отслеживания обзора главы.
|
Key Terms You Should Know binary mask, dotted-decimal notation (DDN), decimal mask, prefix mask, CIDR mask, classful addressing, classless addressing Additional Practice for This Chapter’s Processes You can do more practice with the processes in this chapter with a pair of practice sets.|Ключевые термины, которые вы должны знать двоичную маску, десятичную нотацию с точками (DDN), десятичную маску, маску префикса, маску CIDR, классовую адресацию, бесклассовую адресацию Дополнительная практика для процессов в этой главе Вы можете больше попрактиковаться в процессах, описанных в этой главе, с парой наборов для практики.
One focuses on interpreting existing masks, while the other gives you practice with converting between mask formats.|Один ориентирован на интерпретацию существующих масок, а другой дает вам возможность попрактиковаться в преобразовании между форматами масок.
You may do each practice set using the following tools:|Вы можете выполнять каждый набор упражнений, используя следующие инструменты:
|
Application: Use the “Analyzing Subnet Masks” and “Converting Masks” applications on the companion website, listed under the Chapter Review for this chapter.|Приложение: используйте приложения «Анализ масок подсети» и «Преобразование масок» на сопутствующем веб-сайте, перечисленные в разделе Обзор главы для этой главы.
|
PDF: Alternatively, practice the same problems found in both these apps using companion Answers to Earlier Practice Problems Table 13-8, shown earlier, listed several practice problems for converting subnet masks; Table 13-12 lists the answers.|PDF: В качестве альтернативы, попробуйте те же проблемы, которые есть в обоих этих приложениях, используя сопутствующие ответы на предыдущие практические проблемы. Таблица 13-8, показанная ранее, перечисляет несколько практических проблем для преобразования масок подсети; В Таблице 13-12 перечислены ответы.
|
Table 13-12 Answers to Problems in Table 13-8 Table end.|Таблица 13-12. Ответы на проблемы в таблице 13-8. В конце таблицы.
|
Table 13-13 lists the answers to the practice problems from the earlier section “Practice Analyzing Subnet Masks.”|В Таблице 13-13 перечислены ответы на практические проблемы из предыдущего раздела «Практика анализа масок подсети».
|
Table 13-13 Answers to Problems from Earlier in the Chapter Table end.|Таблица 13-13. Ответы на проблемы, возникшие ранее в конце таблицы.
|
The following list reviews the problems:|В следующем списке рассматриваются проблемы:
|
1. For 8.1.4.5, the first octet (8) is in the 1–126 range, so it is a Class A address, with 8 network bits.|1. Для 8.1.4.5 первый октет (8) находится в диапазоне 1–126, поэтому это адрес класса A с 8 битами сети.
Mask 255.255.254.0 converts to /23, so P – N = 15, for 15 subnet bits.|Маска 255.255.254.0 преобразуется в / 23, поэтому P - N = 15 для 15 бит подсети.
H can be found by subtracting /P (23) from 32, for 9 host bits.|H можно найти путем вычитания / P (23) из 32 для 9 бит хоста.
|
2. 130.4.102.1 is in the 128–191 range in the first octet, making it a Class B address, with N = 16 bits. 255.255.255.0 converts to /24, so the number of subnet bits is 24 – 16 = 8.|2. 130.4.102.1 находится в диапазоне 128–191 в первом октете, что делает его адресом класса B с N = 16 битами. 255.255.255.0 преобразуется в / 24, поэтому количество бит подсети составляет 24-16 = 8.
|
With 24 prefix bits, the number of host bits is 32 – 24 = 8.|С 24 битами префикса количество бит хоста составляет 32-24 = 8.
|
3. The third problem purposely shows a case where the mask does not create a subnet part of the address.|3. Третья проблема преднамеренно показывает случай, когда маска не создает подсетевую часть адреса.
The address, 199.1.1.100, has a first octet between 192 and 223, making it a Class C address with 24 network bits.|Адрес 199.1.1.100 имеет первый октет между 192 и 223, что делает его адресом класса C с 24 битами сети.
The prefix version of the mask is /24, so the number of subnet bits is 24 – 24 = 0.|Версия маски с префиксом / 24, поэтому количество бит подсети составляет 24–24 = 0.
The number of host bits is 32 minus the prefix length (24), for a total of 8 host bits.|Число битов хоста равно 32 минус длина префикса (24), всего 8 битов хоста.
So in this case, the mask shows that the network engineer is using the default mask, which creates no subnet bits and no subnets.|Таким образом, в этом случае маска показывает, что сетевой инженер использует маску по умолчанию, которая не создает ни битов подсети, ни подсетей.
|
4. With the same address as the second problem, 130.4.102.1 is a Class B address with N = 16 bits.|4. С тем же адресом, что и во второй задаче, 130.4.102.1 - это адрес класса B с N = 16 битами.
This problem uses a different mask, 255.255.252.0, which converts to /22.|В этой проблеме используется другая маска 255.255.252.0, которая преобразуется в / 22.
|
This makes the number of subnet bits 22 – 16 = 6.|Это делает количество битов подсети 22-16 = 6.
With 22 prefix bits, the number of host bits is 32 – 22 = 10.|С 22 битами префикса количество бит хоста составляет 32-22 = 10.
|
5. With the same address as the third problem, 199.1.1.100 is a Class C address with N =|5. С тем же адресом, что и у третьей проблемы, 199.1.1.100 - это адрес класса C с N =
|
24 bits.|24 бита.
This problem uses a different mask, 255.255.255.224, which converts to /27.|В этой задаче используется другая маска 255.255.255.224, которая преобразуется в / 27.
|
This makes the number of subnet bits 27 – 24 = 3.|Это делает количество битов подсети 27 - 24 = 3.
With 27 prefix bits, the number of host bits is 32 – 27 = 5.|С 27 битами префикса количество бит хоста составляет 32-27 = 5.
## Chapter 14 Analyzing Existing Subnets
Глава 14 Анализ существующих подсетей   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.6 Configure and verify IPv4 addressing and subnetting
1.6 Настройка и проверка адресации IPv4 и подсетей   
__|__
--|--
|
Often, a networking task begins with the discovery of the IP address and mask used by some host.|Часто сетевая задача начинается с обнаружения IP-адреса и маски, используемых каким-либо хостом.
Then, to understand how the internetwork routes packets to that host, you must find key pieces of information about the subnet, specifically the following:|Затем, чтобы понять, как межсетевое соединение маршрутизирует пакеты к этому хосту, вы должны найти ключевую информацию о подсети, в частности следующую:
###### Subnet ID
ID подсети   
###### Subnet broadcast address
Широковещательный адрес подсети   
###### Subnet’s range of usable unicast IP addresses
Диапазон используемых в подсети одноадресных IP-адресов   
__|__
--|--
|
This chapter discusses the concepts and math to take a known IP address and mask, and then fully describe a subnet by finding the values in this list.|В этой главе обсуждаются концепции и математические вычисления, позволяющие получить известный IP-адрес и маску, а затем полностью описать подсеть, найдя значения в этом списке.
These specific tasks might well be the most important IP skills in the entire IP addressing and subnetting topics in this book because these tasks might be the most commonly used tasks when operating and troubleshooting real networks.|Эти конкретные задачи могут быть наиболее важными навыками IP во всех разделах этой книги по IP-адресации и подсетям, поскольку эти задачи могут быть наиболее часто используемыми задачами при эксплуатации и устранении неисправностей в реальных сетях.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 14-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 14-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### Defining a Subnet
Определение подсети   
__|__
--|--
|
Analyzing Existing Subnets: Binary 2 Analyzing Existing Subnets: Decimal 3–6 1.|Анализ существующих подсетей: двоичный 2 Анализ существующих подсетей: десятичный 3–6 1.
When you think about an IP address using classful addressing rules, an address can have three parts: network, subnet, and host.|Когда вы думаете об IP-адресе с использованием правил классовой адресации, адрес может состоять из трех частей: сети, подсети и хоста.
If you examined all the addresses in one subnet, in binary, which of the following answers correctly states which of the three parts of the addresses will be equal among all addresses? (Choose the best answer.)|Если вы проверили все адреса в одной подсети в двоичном формате, какой из следующих ответов правильно указывает, какая из трех частей адресов будет одинакова среди всех адресов? (Выбери лучший ответ.)
|
a. Network part only b.|а. Только сетевая часть b.
Subnet part only c.|Только часть подсети c.
Host part only d.|Только принимающая часть d.
Network and subnet parts e.|Части сети и подсети e.
Subnet and host parts CHAPTER 14 2.|Части подсети и хоста ГЛАВА 14 2.
Which of the following statements are true regarding the binary subnet ID, subnet broadcast address, and host IP address values in any single subnet? (Choose two answers.)|Какие из следующих утверждений верны относительно значений двоичного идентификатора подсети, широковещательного адреса подсети и IP-адреса узла в любой отдельной подсети? (Выберите два ответа.)
|
a. The host part of the broadcast address is all binary 0s.|а. Хост-часть широковещательного адреса состоит из двоичных нулей.
|
b. The host part of the subnet ID is all binary 0s.|б. Хост-часть идентификатора подсети состоит из двоичных нулей.
|
c. The host part of a usable IP address can have all binary 1s.|c. Хост-часть используемого IP-адреса может иметь все двоичные единицы.
|
d. The host part of any usable IP address must not be all binary 0s.|d. Часть хоста любого используемого IP-адреса не должна состоять только из двоичных нулей.
|
3. Which of the following is the resident subnet ID for IP address 10.7.99.133/24?|3. Что из перечисленного является идентификатором резидентной подсети для IP-адреса 10.7.99.133/24?
|
a. 10.0.0.0 b. 10.7.0.0 c. 10.7.99.0 d. 10.7.99.128 4.|а. 10.0.0.0 б. 10.7.0.0 с. 10.7.99.0 г. 10.7.99.128 4.
Which of the following is the resident subnet for IP address 192.168.44.97/30?|Что из следующего является резидентной подсетью для IP-адреса 192.168.44.97/30?
|
a. 192.168.44.0 b. 192.168.44.64 c. 192.168.44.96 d. 192.168.44.128 5.|а. 192.168.44.0 б. 192.168.44.64 с. 192.168.44.96 г. 192.168.44.128 5.
Which of the following is the subnet broadcast address for the subnet in which IP address 172.31.77.201/27 resides?|Что из перечисленного является широковещательным адресом подсети для подсети, в которой находится IP-адрес 172.31.77.201/27?
|
a. 172.31.201.255 b. 172.31.255.255 c. 172.31.77.223 d. 172.31.77.207 6.|а. 172.31.201.255 б. 172.31.255.255 с. 172.31.77.223 г. 172.31.77.207 6.
A fellow engineer tells you to configure the DHCP server to lease the last 100 usable IP addresses in subnet 10.1.4.0/23.|Другой инженер посоветует вам настроить DHCP-сервер на аренду последних 100 используемых IP-адресов в подсети 10.1.4.0/23.
Which of the following IP addresses could be leased as a result of your new configuration?|Какие из следующих IP-адресов можно арендовать в результате вашей новой конфигурации?
|
a. 10.1.4.156 b. 10.1.4.254 c. 10.1.5.200 d. 10.1.7.200 e. 10.1.255.200 Foundation Topics Defining a Subnet An IP subnet is a subset of a classful network, created by choice of some network engineer.|а. 10.1.4.156 б. 10.1.4.254 с. 10.1.5.200 г. 10.1.7.200 е. 10.1.255.200 Основные темы Определение подсети IP-подсеть - это подмножество классовой сети, созданное по выбору сетевого инженера.
|
However, that engineer cannot pick just any arbitrary subset of addresses; instead, the engineer must follow certain rules, such as the following:|Однако этот инженер не может выбрать произвольное подмножество адресов; вместо этого инженер должен следовать определенным правилам, например следующим:
###### The subnet contains a set of consecutive numbers.
Подсеть содержит набор последовательных номеров.   
###### The subnet holds 2H numbers, where H is the number of host bits defined by the subnet
Подсеть содержит номера 2H, где H - количество бит хоста, определяемое подсетью.   
__|__
--|--
|
mask.|маска.
###### Two special numbers in the range cannot be used as IP addresses:
Два специальных номера из диапазона нельзя использовать в качестве IP-адресов:   
###### The first (lowest) number acts as an identifier for the subnet (subnet ID).
Первый (самый низкий) номер действует как идентификатор подсети (ID подсети).   
###### The last (highest) number acts as a subnet broadcast address.
Последний (самый высокий) номер действует как широковещательный адрес подсети.   
###### The remaining addresses, whose values sit between the subnet ID and subnet broadcast
Остальные адреса, значения которых находятся между идентификатором подсети и широковещательной рассылкой подсети.   
__|__
--|--
|
address, are used as unicast IP addresses.|адрес, используются как одноадресные IP-адреса.
|
This section reviews and expands the basic concepts of the subnet ID, subnet broadcast address, and range of addresses in a subnet.|В этом разделе рассматриваются и расширяются основные понятия идентификатора подсети, широковещательного адреса подсети и диапазона адресов в подсети.
#### An Example with Network 172.16.0.0 and Four Subnets
Пример с сетью 172.16.0.0 и четырьмя подсетями   
__|__
--|--
|
Imagine that you work at the customer support center, where you receive all initial calls from users who have problems with their computer.|Представьте, что вы работаете в центре поддержки клиентов, куда вам поступают все первоначальные звонки от пользователей, у которых проблемы с компьютером.
You coach the user through finding her IP address and mask: 172.16.150.41, mask 255.255.192.0.|Вы обучаете пользователя поиску его IP-адреса и маски: 172.16.150.41, маска 255.255.192.0.
One of the first and most common tasks you will do based on that information is to find the subnet ID of the subnet in which that address resides. (In fact, this subnet ID is sometimes called the resident subnet because the IP address exists in or resides in that subnet.)|Одна из первых и наиболее распространенных задач, которые вы будете выполнять на основе этой информации, - это найти идентификатор подсети той подсети, в которой находится этот адрес. (Фактически, этот идентификатор подсети иногда называют резидентной подсетью, потому что IP-адрес существует или находится в этой подсети.)
|
Before getting into the math, examine the mask (255.255.192.0) and classful network (172.16.0.0) for a moment.|Прежде чем приступить к математике, изучите маску (255.255.192.0) и классовую сеть (172.16.0.0).
From the mask, based on what you learned in Chapter 13, “Analyzing Subnet Masks,” you can find the structure of the addresses in the subnet, including the number of host and subnet bits.|Из маски, основанной на том, что вы узнали в главе 13 «Анализ масок подсети», вы можете найти структуру адресов в подсети, включая количество битов хоста и подсети.
That analysis tells you that two subnet bits exist, meaning that there should be four (22) subnets.|Этот анализ показывает, что существует два бита подсети, а это означает, что должно быть четыре (22) подсети.
Figure 14-1 shows the idea.|На рис. 14-1 показана идея.
|
Figure 14-1 Address Structure: Class B Network, /18 Mask Answers to the “Do I Know This Already?” quiz:|Рис. 14-1 Структура адреса: сеть класса B, / 18 Маска ответов на вопрос «Знаю ли я это уже?» викторина:
|
1 D 2 B, D 3 C 4 C 5 C 6 C NOTE This chapter, like the others in this part of the book, assumes that one mask is used throughout an entire classful network.|1 D 2 B, D 3 C 4 C 5 C 6 C ПРИМЕЧАНИЕ В этой главе, как и в других в этой части книги, предполагается, что одна маска используется во всей классовой сети.
|
Because each subnet uses a single mask, all subnets of this single IP network must be the same size, because all subnets have the same structure.|Поскольку каждая подсеть использует одну маску, все подсети этой единой IP-сети должны быть одинакового размера, поскольку все подсети имеют одинаковую структуру.
In this example, all four subnets will have the structure shown in the figure, so all four subnets will have 214 – 2 host addresses.|В этом примере все четыре подсети будут иметь структуру, показанную на рисунке, поэтому все четыре подсети будут иметь 214-2 адреса хоста.
|
Next, consider the big picture of what happens with this example subnet design: the one Class B network now has four subnets of equal size.|Затем рассмотрим общую картину того, что происходит с этим примером структуры подсети: одна сеть класса B теперь имеет четыре подсети одинакового размера.
Conceptually, if you represent the entire Class B network as a number line, each subnet consumes one-fourth of the number line, as shown in Figure 14-2.|Концептуально, если вы представляете всю сеть класса B в виде числовой линии, каждая подсеть занимает одну четверть числовой линии, как показано на Рисунке 14-2.
Each subnet has a subnet ID—the numerically lowest number in the subnet—so it sits on the left of the subnet.|Каждая подсеть имеет идентификатор подсети - наименьшее числовое значение в подсети, поэтому он находится слева от подсети.
And each subnet has a subnet broadcast address—the numerically highest number in the subnet—so it sits on the right side of the subnet.|И каждая подсеть имеет широковещательный адрес подсети - самое большое числовое значение в подсети, поэтому он находится в правой части подсети.
|
Figure 14-2 Network 172.16.0.0, Divided into Four Equal Subnets The rest of this chapter focuses on how to take one IP address and mask and discover the details about that one subnet in which the address resides.|Рис. 14-2. Сеть 172.16.0.0, разделенная на четыре равные подсети Остальная часть этой главы посвящена тому, как взять один IP-адрес и маску, а также узнать подробности о той подсети, в которой находится этот адрес.
In other words, you see how to find the resident subnet of an IP address.|Другими словами, вы видите, как найти резидентную подсеть IP-адреса.
Again, using IP address 172.16.150.41 and mask 255.255.192.0 as an example, Figure 14-3 shows the resident subnet, along with the subnet ID and subnet broadcast address that bracket the subnet.|Опять же, используя IP-адрес 172.16.150.41 и маску 255.255.192.0 в качестве примера, на рисунке 14-3 показана резидентная подсеть, а также идентификатор подсети и широковещательный адрес подсети, которые ограничивают подсеть.
|
Figure 14-3 Resident Subnet for 172.16.150.41, 255.255.192.0|Рисунок 14-3 Резидентная подсеть для 172.16.150.41, 255.255.192.0
#### Subnet ID Concepts
Основные понятия идентификатора подсети   
__|__
--|--
|
A subnet ID is simply a number used to succinctly represent a subnet.|ID подсети - это просто число, используемое для лаконичного представления подсети.
When listed along with its matching subnet mask, the subnet ID identifies the subnet and can be used to derive the subnet broadcast address and range of addresses in the subnet.|При указании вместе с соответствующей маской подсети идентификатор подсети определяет подсеть и может использоваться для получения широковещательного адреса подсети и диапазона адресов в подсети.
Rather than having to write down all these details about a subnet, you simply need to write down the subnet ID and mask, and you have enough information to fully describe the subnet.|Вместо того, чтобы записывать все эти сведения о подсети, вам просто нужно записать идентификатор и маску подсети, и у вас будет достаточно информации, чтобы полностью описать подсеть.
|
The subnet ID appears in many places, but it is seen most often in IP routing tables.|Идентификатор подсети появляется во многих местах, но чаще всего он встречается в таблицах IP-маршрутизации.
For example, when an engineer configures a router with its IP address and mask, the router calculates the subnet ID and puts a route into its routing table for that subnet.|Например, когда инженер настраивает маршрутизатор с его IP-адресом и маской, маршрутизатор вычисляет идентификатор подсети и помещает маршрут в свою таблицу маршрутизации для этой подсети.
The router typically then advertises the subnet ID/mask combination to neighboring routers with some IP routing protocol.|Затем маршрутизатор обычно объявляет комбинацию идентификатора подсети / маски соседним маршрутизаторам с некоторым протоколом IP-маршрутизации.
Eventually, all the routers in an enterprise learn about the subnet—again using the subnet ID and subnet mask combination—and display it in their routing tables. (You can display the contents of a router’s IP routing table using the show ip route command.)|В конце концов, все маршрутизаторы на предприятии узнают о подсети - снова используя комбинацию идентификатора подсети и маски подсети - и отображают ее в своих таблицах маршрутизации. (Вы можете отобразить содержимое таблицы IP-маршрутизации маршрутизатора с помощью команды show ip route.)
|
Unfortunately, the terminology related to subnets can sometimes cause problems.|К сожалению, терминология, связанная с подсетями, иногда может вызывать проблемы.
First, the terms subnet ID, subnet number, and subnet address are synonyms.|Во-первых, термины ID подсети, номер подсети и адрес подсети являются синонимами.
In addition, people sometimes simply say subnet when referring to both the idea of a subnet and the number that is used as the subnet ID. When talking about routing, people sometimes use the term prefix instead of subnet.|Кроме того, люди иногда просто говорят «подсеть», имея в виду как идею подсети, так и номер, который используется в качестве идентификатора подсети. Говоря о маршрутизации, люди иногда используют термин префикс вместо подсети.
The term prefix refers to the same idea as subnet; it just uses terminology from the classless addressing way to describe IP addresses, as discussed in Chapter 13’s section “Classless and Classful Addressing.”|Термин «префикс» относится к той же идее, что и подсеть; он просто использует терминологию из способа бесклассовой адресации для описания IP-адресов, как обсуждалось в главе 13 в разделе «Бесклассовая и классовая адресация».
|
The biggest terminology confusion arises between the terms network and subnet.|Самая большая путаница в терминологии возникает между терминами сеть и подсеть.
In the real world, people often use these terms synonymously, and that is perfectly reasonable in some cases.|В реальном мире люди часто используют эти термины как синонимы, и в некоторых случаях это вполне разумно.
In other cases, the specific meaning of these terms, and their differences, matter to what is being discussed.|В других случаях конкретное значение этих терминов и их различия имеют значение для обсуждаемого вопроса.
|
For example, people often might say, “What is the network ID?” when they really want to know the subnet ID. In another case, they might want to know the Class A, B, or C network ID. So, when one engineer asks something like, “What’s the net ID for 172.16.150.41 slash 18?” use the context to figure out whether he wants the literal classful network ID (172.16.0.0, in this case) or the literal subnet ID (172.16.128.0, in this case).|Например, люди часто могут спросить: «Какой идентификатор сети?» когда они действительно хотят знать идентификатор подсети. В другом случае они могут захотеть узнать идентификатор сети класса A, B или C. Итак, когда один инженер спрашивает что-то вроде: «Какой сетевой идентификатор для 172.16.150.41 слэш 18?» используйте контекст, чтобы выяснить, хочет ли он буквальный идентификатор сети класса (в данном случае 172.16.0.0) или буквальный идентификатор подсети (в данном случае 172.16.128.0).
|
For the exams, be ready to notice when the terms subnet and network are used, and then use the context to figure out the specific meaning of the term in that case.|На экзаменах будьте готовы замечать, когда используются термины подсеть и сеть, а затем использовать контекст, чтобы выяснить конкретное значение термина в этом случае.
|
Table 14-2 summarizes the key facts about the subnet ID, along with the possible synonyms, for easier review and study.|В Табл. 14-2 приведены основные сведения об идентификаторе подсети вместе с возможными синонимами для облегчения просмотра и изучения.
|
Table 14-2 Summary of Subnet ID Key Facts Table end.|Таблица 14-2 Сводная таблица основных фактов об идентификаторах подсети Конец таблицы.
#### Subnet Broadcast Address
Адрес рассылки подсети   
__|__
--|--
|
The subnet broadcast address has two main roles: to be used as a destination IP address for the purpose of sending packets to all hosts in the subnet, and as a means to find the high end of the range of addresses in a subnet.|Широковещательный адрес подсети выполняет две основные роли: он должен использоваться в качестве IP-адреса назначения с целью отправки пакетов на все хосты в подсети и как средство для поиска верхнего предела диапазона адресов в подсети.
|
The original purpose for the subnet broadcast address was to give hosts a way to send one packet to all hosts in a subnet and to do so efficiently.|Первоначальная цель широковещательного адреса подсети заключалась в том, чтобы дать хостам возможность отправлять один пакет всем хостам в подсети и делать это эффективно.
For example, a host in subnet A could send a packet with a destination address of subnet B’s subnet broadcast address.|Например, хост в подсети A может отправить пакет с адресом назначения широковещательного адреса подсети B.
The routers would forward this one packet just like a packet sent to a host in subnet B.|Маршрутизаторы будут пересылать этот один пакет точно так же, как пакет, отправленный на хост в подсети B.
After the packet arrives at the router connected to subnet B, that last router would then forward the packet to all hosts in subnet B, typically by encapsulating the packet in a data-link layer broadcast frame.|После того, как пакет прибывает на маршрутизатор, подключенный к подсети B, последний маршрутизатор затем пересылает пакет на все хосты в подсети B, обычно путем инкапсуляции пакета в широковещательный кадр уровня звена данных.
As a result, all hosts in host B’s subnet would receive a copy of the packet.|В результате все хосты в подсети хоста B получат копию пакета.
|
The subnet broadcast address also helps you find the range of addresses in a subnet because the broadcast address is the last (highest) number in a subnet’s range of addresses.|Широковещательный адрес подсети также помогает вам найти диапазон адресов в подсети, поскольку широковещательный адрес является последним (самым высоким) числом в диапазоне адресов подсети.
To find the low end of the range, calculate the subnet ID; to find the high end of the range, calculate the subnet broadcast address.|Чтобы найти нижнюю границу диапазона, вычислите идентификатор подсети; чтобы найти верхний предел диапазона, вычислите широковещательный адрес подсети.
|
Table 14-3 summarizes the key facts about the subnet broadcast address, along with the possible synonyms, for easier review and study.|В Таблице 14-3 приведены основные сведения о широковещательном адресе подсети, а также возможные синонимы для облегчения просмотра и изучения.
|
Table 14-3 Summary of Subnet Broadcast Address Key Facts Table end.|Таблица 14-3 Сводка ключевых фактов об адресе широковещательной передачи в подсети Конец таблицы.
#### Range of Usable Addresses
Диапазон используемых адресов   
__|__
--|--
|
The engineers implementing an IP internetwork need to know the range of unicast IP addresses in each subnet.|Инженеры, реализующие объединение IP-сетей, должны знать диапазон одноадресных IP-адресов в каждой подсети.
Before you can plan which addresses to use as statically assigned IP addresses, which to configure to be leased by the DHCP server, and which to reserve for later use, you need to know the range of usable addresses.|Прежде чем вы сможете спланировать, какие адреса использовать в качестве статически назначаемых IP-адресов, какие настроить для аренды сервером DHCP, а какие зарезервировать для последующего использования, вам необходимо знать диапазон используемых адресов.
|
To find the range of usable IP addresses in a subnet, first find the subnet ID and the subnet broadcast address.|Чтобы найти диапазон используемых IP-адресов в подсети, сначала найдите идентификатор подсети и широковещательный адрес подсети.
Then, just add 1 to the fourth octet of the subnet ID to get the first (lowest)|Затем просто добавьте 1 к четвертому октету идентификатора подсети, чтобы получить первый (самый низкий)
|
usable address, and subtract 1 from the fourth octet of the subnet broadcast address to get the last (highest) usable address in the subnet.|используемый адрес, и вычтите 1 из четвертого октета широковещательного адреса подсети, чтобы получить последний (самый высокий) используемый адрес в подсети.
|
For example, Figure 14-3 showed subnet ID 172.16.128.0, mask /18.|Например, на рисунке 14-3 показан идентификатор подсети 172.16.128.0, маска / 18.
The first usable address is simply one more than the subnet ID (in this case, 172.16.128.1).|Первый доступный адрес просто на единицу больше, чем идентификатор подсети (в данном случае 172.16.128.1).
That same figure showed a subnet broadcast address of 172.16.191.255, so the last usable address is one less, or 172.16.191.254.|На том же рисунке показан широковещательный адрес подсети 172.16.191.255, поэтому последний используемый адрес на единицу меньше, или 172.16.191.254.
|
Now that this section has described the concepts behind the numbers that collectively define a subnet, the rest of this chapter focuses on the math used to find these values.|Теперь, когда в этом разделе описаны концепции чисел, которые в совокупности определяют подсеть, остальная часть этой главы посвящена математике, используемой для нахождения этих значений.
### Analyzing Existing Subnets: Binary
Анализ существующих подсетей: двоичный   
__|__
--|--
|
What does it mean to “analyze a subnet”?|Что значит «анализировать подсеть»?
For this book, it means that you should be able to start with an IP address and mask and then define key facts about the subnet in which that address resides.|Для этой книги это означает, что вы должны иметь возможность начать с IP-адреса и маски, а затем определить ключевые факты о подсети, в которой находится этот адрес.
Specifically, that means discovering the subnet ID, subnet broadcast address, and range of addresses.|В частности, это означает определение идентификатора подсети, широковещательного адреса подсети и диапазона адресов.
The analysis can also include the calculation of the number of addresses in the subnet as discussed in Chapter 13, but this chapter does not review those concepts.|Анализ также может включать в себя расчет количества адресов в подсети, как описано в главе 13, но в этой главе эти концепции не рассматриваются.
|
Many methods exist to calculate the details about a subnet based on the address/mask.|Существует множество методов для вычисления подробностей о подсети на основе адреса / маски.
This section begins by discussing some calculations that use binary math, with the next section showing alternatives that use only decimal math.|Этот раздел начинается с обсуждения некоторых вычислений, использующих двоичную математику, а в следующем разделе показаны альтернативы, использующие только десятичную математику.
Although many people prefer the decimal method for going fast on the exams, the binary calculations ultimately give you a better understanding of IPv4 addressing.|Хотя многие люди предпочитают десятичный метод для быстрой сдачи экзаменов, двоичные вычисления в конечном итоге дают вам лучшее понимание адресации IPv4.
In particular, if you plan to move on to attain Cisco certifications beyond CCNA, you should take the time to understand the binary methods discussed in this section, even if you use the decimal methods for the exams.|В частности, если вы планируете перейти к сертификации Cisco за пределами CCNA, вам следует найти время, чтобы понять двоичные методы, обсуждаемые в этом разделе, даже если вы используете десятичные методы для экзаменов.
#### Finding the Subnet ID: Binary
Поиск идентификатора подсети: двоичный   
__|__
--|--
|
The two following statements summarize the logic behind the binary value of any subnet ID:|Два следующих оператора суммируют логику двоичного значения любого идентификатора подсети:
|
All numbers in the subnet (subnet ID, subnet broadcast address, and all usable IP addresses)|Все числа в подсети (идентификатор подсети, широковещательный адрес подсети и все используемые IP-адреса)
|
have the same value in the prefix part of the numbers.|имеют такое же значение в префиксной части чисел.
|
The subnet ID is the lowest numeric value in the subnet, so its host part, in binary, is all 0s.|Идентификатор подсети - это наименьшее числовое значение в подсети, поэтому его хост-часть в двоичном формате равна нулю.
|
To find the subnet ID in binary, you take the IP address in binary and change all host bits to binary 0.|Чтобы найти идентификатор подсети в двоичном формате, вы берете IP-адрес в двоичном формате и меняете все биты хоста на двоичный 0.
To do so, you need to convert the IP address to binary.|Для этого вам необходимо преобразовать IP-адрес в двоичный.
You also need to identify the prefix and host bits, which can be easily done by converting the mask (as needed) to prefix format. (Note that Appendix A, “Numeric Reference Tables,” includes a decimal-binary conversion table.) Figure 14-4 shows the idea, using the same address/mask as in the earlier examples in this chapter: 172.16.150.41, mask /18.|Вам также необходимо определить биты префикса и хоста, что можно легко сделать, преобразовав маску (при необходимости) в формат префикса. (Обратите внимание, что Приложение A «Цифровые справочные таблицы» включает таблицу десятично-двоичного преобразования.) На рис. 14-4 показана идея с использованием того же адреса / маски, что и в предыдущих примерах в этой главе: 172.16.150.41, маска / 18.
|
Figure 14-4 Binary Concept: Convert the IP Address to the Subnet ID Starting at the top of Figure 14-4, the format of the IP address is represented with 18 prefix (P) and 14 host (H) bits in the mask (Step 1).|Рисунок 14-4 Двоичная концепция: преобразование IP-адреса в идентификатор подсети Начиная с верхней части рисунка 14-4, формат IP-адреса представлен 18 битами префикса (P) и 14 битами хоста (H) в маске ( Шаг 1).
The second row (Step 2) shows the binary version of the IP address, converted from the dotted-decimal notation (DDN) value 172.16.150.41. (If you have not yet used the conversion table in Appendix A, it might be useful to double-check the conversion of all four octets based on the table.)|Во второй строке (шаг 2) отображается двоичная версия IP-адреса, преобразованная из десятичного представления с разделительными точками (DDN), значение 172.16.150.41. (Если вы еще не использовали таблицу преобразования в Приложении A, может быть полезно дважды проверить преобразование всех четырех октетов на основе таблицы.)
|
The next two steps show the action to copy the IP address’s prefix bits (Step 3) and give the host bits a value of binary 0 (Step 4).|Следующие два шага показывают, как копировать биты префикса IP-адреса (шаг 3) и присвоить битам хоста значение двоичного 0 (шаг 4).
This resulting number is the subnet ID (in binary).|Полученное число является идентификатором подсети (в двоичном формате).
|
The last step, not shown in Figure 14-4, is to convert the subnet ID from binary to decimal.|Последний шаг, не показанный на рисунке 14-4, - это преобразование идентификатора подсети из двоичного в десятичный.
|
This book shows that conversion as a separate step, in Figure 14-5, mainly because many people make a mistake at this step in the process.|Эта книга показывает это преобразование как отдельный шаг, на рис. 14-5, главным образом потому, что многие люди делают ошибку на этом этапе процесса.
When converting a 32-bit number (like an IP address or IP subnet ID) back to an IPv4 DDN, you must follow this rule:|При преобразовании 32-битного числа (например, IP-адреса или идентификатора IP-подсети) обратно в IPv4 DDN вы должны следовать этому правилу:
|
Convert 8 bits at a time from binary to decimal, regardless of the line between the prefix and host parts of the number.|Преобразуйте 8 бит за раз из двоичного в десятичное, независимо от линии между префиксом и основной частью числа.
|
Figure 14-5 Converting the Subnet ID from Binary to DDN Figure 14-5 shows this final step.|Рисунок 14-5. Преобразование идентификатора подсети из двоичного в DDN. Рисунок 14-5 показывает этот последний шаг.
Note that the third octet (the third set of 8 bits) has 2 bits in the prefix and 6 bits in the host part of the number, but the conversion occurs for all 8 bits.|Обратите внимание, что третий октет (третий набор из 8 бит) имеет 2 бита в префиксе и 6 бит в части номера хоста, но преобразование происходит для всех 8 бит.
|
NOTE You can do the numeric conversions in Figures 14-4 and 14-5 by relying on the conversion table in Appendix A.|ПРИМЕЧАНИЕ. Вы можете выполнять числовые преобразования, показанные на рисунках 14-4 и 14-5, используя таблицу преобразования в Приложении A.
To convert from DDN to binary, for each octet, find the decimal value in the table and then write down the 8-bit binary equivalent.|Чтобы преобразовать DDN в двоичный, для каждого октета найдите десятичное значение в таблице и затем запишите 8-битный двоичный эквивалент.
To convert from binary back to DDN, for each octet of 8 bits, find the matching binary entry in the table and write down the corresponding decimal value.|Чтобы преобразовать двоичный код обратно в DDN, для каждого 8-битного октета найдите соответствующую двоичную запись в таблице и запишите соответствующее десятичное значение.
For example, 172 converts to binary 10101100, and 00010000 converts to decimal 16.|Например, 172 преобразуется в двоичное 10101100, а 00010000 преобразуется в десятичное 16.
#### Finding the Subnet Broadcast Address: Binary
Поиск адреса широковещательной передачи в подсети: двоичный   
__|__
--|--
|
Finding the subnet broadcast address uses a similar process.|Для поиска широковещательного адреса подсети используется аналогичный процесс.
To find the subnet broadcast address, use the same binary process used to find the subnet ID, but instead of setting all the host bits to the lowest value (all binary 0s), set the host part to the highest value (all binary 1s).|Чтобы найти широковещательный адрес подсети, используйте тот же двоичный процесс, который использовался для поиска идентификатора подсети, но вместо того, чтобы устанавливать все биты хоста на наименьшее значение (все двоичные нули), установите часть узла на максимальное значение (все двоичные единицы) .
Figure 14-6 shows the concept.|На рис. 14-6 показана концепция.
|
Figure 14-6 Finding a Subnet Broadcast Address: Binary The process in Figure 14-6 demonstrates the same first three steps shown in Figure 14-4.|Рисунок 14-6. Поиск адреса широковещательной рассылки в подсети: двоичный. Процесс на рисунке 14-6 демонстрирует те же первые три шага, что и на рисунке 14-4.
|
Specifically, it shows the identification of the prefix and host bits (Step 1), the results of converting the IP address 172.16.150.41 to binary (Step 2), and the copying of the prefix bits (first 18 bits, in this case).|В частности, он показывает идентификацию битов префикса и хоста (шаг 1), результаты преобразования IP-адреса 172.16.150.41 в двоичный (шаг 2) и копирование битов префикса (в данном случае первые 18 бит). .
The difference occurs in the host bits on the right, changing all host bits (the last 14, in this case) to the largest possible value (all binary 1s).|Разница возникает в битах хоста справа, изменяя все биты хоста (в данном случае последние 14) на максимально возможное значение (все двоичные единицы).
The final step converts the 32-bit subnet broadcast address to DDN format.|На последнем этапе 32-битный широковещательный адрес подсети преобразуется в формат DDN.
Also, remember that with any conversion from DDN to binary or vice versa, the process always converts using 8 bits at a time.|Кроме того, помните, что при любом преобразовании из DDN в двоичный или наоборот процесс всегда преобразуется с использованием 8 бит за раз.
In particular, in this case, the entire third octet of binary 10111111 is converted back to decimal 191.|В частности, в этом случае весь третий октет двоичного числа 10111111 преобразуется обратно в десятичный 191.
#### Binary Practice Problems
Проблемы бинарной практики   
__|__
--|--
|
Figures 14-4 and 14-5 demonstrate a process to find the subnet ID using binary math.|На рисунках 14-4 и 14-5 показан процесс определения идентификатора подсети с использованием двоичной математики.
The following process summarizes those steps in written form for easier reference and practice:|Следующий процесс резюмирует эти шаги в письменной форме для облегчения справки и практики:
|
Step 1.|Шаг 1.
Convert the mask to prefix format to find the length of the prefix (/P) and the length of the host part (32 – P).|Преобразуйте маску в формат префикса, чтобы найти длину префикса (/ P) и длину части хоста (32 - P).
|
Step 2.|Шаг 2.
Convert the IP address to its 32-bit binary equivalent.|Преобразуйте IP-адрес в его 32-битный двоичный эквивалент.
|
Step 3.|Шаг 3.
Copy the prefix bits of the IP address.|Скопируйте биты префикса IP-адреса.
|
Step 4.|Шаг 4.
Write down 0s for the host bits.|Запишите 0 для битов хоста.
|
Step 5.|Шаг 5.
Convert the resulting 32-bit number, 8 bits at a time, back to decimal.|Преобразуйте полученное 32-битное число по 8 бит за раз обратно в десятичное.
|
The process to find the subnet broadcast address is exactly the same, except in Step 4, you set the bits to 1s, as shown in Figure 14-6.|Процесс поиска широковещательного адреса подсети точно такой же, за исключением шага 4, вы устанавливаете биты в 1, как показано на Рисунке 14-6.
|
Take a few moments and run through the following five practice problems on scratch paper.|Уделите несколько минут и выполните следующие пять практических задач на бумаге для заметок.
|
In each case, find both the subnet ID and subnet broadcast address.|В каждом случае найдите идентификатор подсети и широковещательный адрес подсети.
Also, record the prefix style mask:|Также запишите маску стиля префикса:
|
1. 8.1.4.5, 255.255.0.0 2. 130.4.102.1, 255.255.255.0 3. 199.1.1.100, 255.255.255.0 4. 130.4.102.1, 255.255.252.0 5. 199.1.1.100, 255.255.255.224 Tables 14-4 through 14-8 show the results for the five different examples.|1. 8.1.4.5, 255.255.0.0 2. 130.4.102.1, 255.255.255.0 3. 199.1.1.100, 255.255.255.0 4. 130.4.102.1, 255.255.252.0 5. 199.1.1.100, 255.255.255.224 Таблицы с 14-4 по 14-8 показаны результаты для пяти различных примеров.
The tables show the host bits in bold, and they include the binary version of the address and mask and the binary version of the subnet ID and subnet broadcast address.|В таблицах биты узла выделены жирным шрифтом, и они включают двоичную версию адреса и маски, а также двоичную версию идентификатора подсети и широковещательного адреса подсети.
|
Table 14-4 Subnet Analysis for Subnet with Address 8.1.4.5, Mask 255.255.0.0 Table end.|Таблица 14-4 Анализ подсети для подсети с адресом 8.1.4.5, маска 255.255.0.0 Конец таблицы.
|
Table 14-5 Subnet Analysis for Subnet with Address 130.4.102.1, Mask 255.255.255.0 Table end.|Таблица 14-5 Анализ подсети для подсети с адресом 130.4.102.1, маска 255.255.255.0 Конец таблицы.
|
Table 14-6 Subnet Analysis for Subnet with Address 199.1.1.100, Mask 255.255.255.0 Table end.|Таблица 14-6 Анализ подсети для подсети с адресом 199.1.1.100, маска 255.255.255.0 Конец таблицы.
|
Table 14-7 Subnet Analysis for Subnet with Address 130.4.102.1, Mask 255.255.252.0 Table end.|Таблица 14-7 Анализ подсети для подсети с адресом 130.4.102.1, маска 255.255.252.0 Конец таблицы.
|
Table 14-8 Subnet Analysis for Subnet with Address 199.1.1.100, Mask 255.255.255.224 Table end.|Таблица 14-8 Анализ подсети для подсети с адресом 199.1.1.100, маска 255.255.255.224 Конец таблицы.
#### Shortcut for the Binary Process
Ярлык для двоичного процесса   
__|__
--|--
|
The binary process described in this section so far requires that all four octets be converted to binary and then back to decimal.|Двоичный процесс, описанный в этом разделе, требует, чтобы все четыре октета были преобразованы в двоичный, а затем обратно в десятичный.
However, you can easily predict the results in at least three of the four octets, based on the DDN mask.|Однако вы можете легко предсказать результаты по крайней мере для трех из четырех октетов на основе маски DDN.
You can then avoid the binary math in all but one octet and reduce the number of binary conversions you need to do.|Затем вы можете избежать двоичной математики во всех октетах, кроме одного, и уменьшить количество необходимых вам двоичных преобразований.
|
First, consider an octet, and that octet only, whose DDN mask value is 255.|Сначала рассмотрим октет, и только тот октет, значение маски DDN которого равно 255.
The mask value of 255 converts to binary 11111111, which means that all 8 bits are prefix bits.|Значение маски 255 преобразуется в двоичное 11111111, что означает, что все 8 бит являются битами префикса.
Thinking through the steps in the process, at Step 2, you convert the address to some number.|Обдумывая шаги процесса, на шаге 2 вы конвертируете адрес в какое-то число.
At Step 3, you copy the number.|На шаге 3 вы копируете номер.
At Step 4, you convert the same 8-bit number back to decimal.|На шаге 4 вы конвертируете то же 8-битное число обратно в десятичное.
All you did in those three steps, in this one octet, is convert from decimal to binary and convert the same number back to the same decimal value!|Все, что вы сделали на этих трех шагах, в этом одном октете, - это преобразование десятичного числа в двоичное и преобразование того же числа обратно в то же десятичное значение!
|
In short, the subnet ID (and subnet broadcast address) are equal to the IP address in octets for which the mask is 255.|Короче говоря, идентификатор подсети (и широковещательный адрес подсети) равны IP-адресу в октетах, для которого маска равна 255.
|
For example, the resident subnet ID for 172.16.150.41, mask 255.255.192.0 is 172.16.128.0.|Например, ID резидентной подсети для 172.16.150.41, маска 255.255.192.0 - 172.16.128.0.
|
The first two mask octets are 255.|Первые два октета маски - 255.
Rather than think about the binary math, you could just start by copying the address’s value in those two octets: 172.16.|Вместо того, чтобы думать о двоичной математике, вы могли бы просто начать с копирования значения адреса в этих двух октетах: 172.16.
|
Another shortcut exists for octets whose DDN mask value is decimal 0, or binary 00000000.|Другой ярлык существует для октетов, значение маски DDN которых равно десятичному 0 или двоичному значению 00000000.
|
With a decimal mask value of 0, the math always results in a decimal 0 for the subnet ID, no matter the beginning value in the IP address.|При значении десятичной маски, равном 0, математические вычисления всегда приводят к десятичному значению 0 для идентификатора подсети, независимо от начального значения IP-адреса.
Specifically, just look at Steps 4 and 5 in this case: At Step 4, you would write down 8 binary 0s, and at Step 5, you would convert 00000000 back to decimal 0.|В частности, в этом случае просто посмотрите на шаги 4 и 5: на шаге 4 вы должны записать 8 двоичных нулей, а на шаге 5 вы должны преобразовать 00000000 обратно в десятичный 0.
|
The following revised process steps take these two shortcuts into account.|Следующие обновленные шаги процесса учитывают эти два ярлыка.
However, when the mask is neither 0 nor 255, the process requires the same conversions.|Однако, когда маска не равна ни 0, ни 255, процесс требует тех же преобразований.
At most, you have to do only one octet of the conversions.|В лучшем случае вам нужно сделать только один октет преобразований.
To find the subnet ID, apply the logic in these steps for each of the four octets:|Чтобы найти идентификатор подсети, примените логику, описанную в этих шагах, для каждого из четырех октетов:
|
Step 1.|Шаг 1.
If the mask = 255, copy the decimal IP address for that octet.|Если маска = 255, скопируйте десятичный IP-адрес для этого октета.
|
Step 2.|Шаг 2.
If the mask = 0, write down a decimal 0 for that octet.|Если маска = 0, запишите десятичный 0 для этого октета.
|
Step 3.|Шаг 3.
If the mask is neither 0 nor 255 in this octet, use the same binary logic as shown in the section “Finding the Subnet ID: Binary,” earlier in this chapter.|Если маска не равна ни 0, ни 255 в этом октете, используйте ту же двоичную логику, которая показана в разделе «Определение идентификатора подсети: двоичный» ранее в этой главе.
|
Figure 14-7 shows an example of this process, again using 172.16.150.41, 255.255.192.0.|На рис. 14-7 показан пример этого процесса, опять же с использованием 172.16.150.41, 255.255.192.0.
|
To find the subnet broadcast address, you can use a decimal shortcut similar to the one used to find the subnet ID: for DDN mask octets equal to decimal 0, set the decimal subnet broadcast address value to 255 instead of 0, as noted in the following list:|Чтобы найти широковещательный адрес подсети, вы можете использовать десятичный ярлык, аналогичный тому, который использовался для поиска идентификатора подсети: для октетов маски DDN, равных десятичному 0, установите для десятичного широковещательного адреса подсети значение 255 вместо 0, как указано в следующий список:
|
Step 1.|Шаг 1.
If the mask = 255, copy the decimal IP address for that octet.|Если маска = 255, скопируйте десятичный IP-адрес для этого октета.
|
Step 2.|Шаг 2.
If the mask = 0, write down a decimal 255 for that octet.|Если маска = 0, запишите десятичное число 255 для этого октета.
|
Step 3.|Шаг 3.
If the mask is neither 0 nor 255 in this octet, use the same binary logic as shown in the section “Finding the Subnet Broadcast Address: Binary,” earlier in this chapter.|Если маска не равна ни 0, ни 255 в этом октете, используйте ту же двоичную логику, которая показана в разделе «Определение адреса широковещательной передачи подсети: двоичный» ранее в этой главе.
|
0-255 ID ID 0-255 192 Binary 150 . . ____ .|0-255 ID ID 0-255 192 Двоичный 150. . ____.
|
255 Copy 16 16 0 Zero 41 0 255 Copy 172 172 . . .|255 Копирование 16 16 0 Ноль 41 0 255 Копирование 172 172. . .
|
. . .|. . .
|
Figure 14-7 Binary Shortcut Example|Рисунок 14-7 Пример двоичного ярлыка
#### Brief Note About Boolean Math
Краткое примечание о булевой математике   
__|__
--|--
|
So far, this chapter has described how humans can use binary math to find the subnet ID and subnet broadcast address.|До сих пор в этой главе описывалось, как люди могут использовать двоичную математику для поиска идентификатора подсети и широковещательного адреса подсети.
However, computers typically use an entirely different binary process to find the same values, using a branch of mathematics called Boolean algebra.|Однако компьютеры обычно используют совершенно другой двоичный процесс для поиска тех же значений, используя раздел математики, называемый булевой алгеброй.
|
Computers already store the IP address and mask in binary form, so they do not have to do any conversions to and from decimal.|Компьютеры уже хранят IP-адрес и маску в двоичной форме, поэтому им не нужно выполнять какие-либо преобразования в десятичное и обратно.
Then, certain Boolean operations allow the computers to calculate the subnet ID and subnet broadcast address with just a few CPU instructions.|Затем определенные логические операции позволяют компьютерам вычислять идентификатор подсети и широковещательный адрес подсети с помощью всего нескольких инструкций ЦП.
|
You do not need to know Boolean math to have a good understanding of IP subnetting.|Вам не нужно знать логическую математику, чтобы хорошо разбираться в IP-подсетях.
|
However, in case you are interested, computers use the following Boolean logic to find the subnet ID and subnet broadcast address, respectively:|Однако, если вам интересно, компьютеры используют следующую логическую логику для поиска идентификатора подсети и широковещательного адреса подсети соответственно:
|
Perform a Boolean AND of the IP address and mask.|Выполните логическое И для IP-адреса и маски.
This process converts all host bits to binary 0.|Этот процесс преобразует все биты хоста в двоичный 0.
|
Invert the mask, and then perform a Boolean OR of the IP address and inverted subnet mask.|Инвертируйте маску, а затем выполните логическое ИЛИ IP-адреса и инвертированной маски подсети.
This process converts all host bits to binary 1s.|Этот процесс преобразует все биты хоста в двоичные единицы.
#### Finding the Range of Addresses
Определение диапазона адресов   
__|__
--|--
|
Finding the range of usable addresses in a subnet, after you know the subnet ID and subnet broadcast address, requires only simple addition and subtraction.|Для определения диапазона используемых адресов в подсети после того, как вы знаете идентификатор подсети и широковещательный адрес подсети, требуется только простое сложение и вычитание.
To find the first (lowest)|Чтобы найти первый (самый низкий)
|
usable IP address in the subnet, simply add 1 to the fourth octet of the subnet ID. To find the last (highest) usable IP address, simply subtract 1 from the fourth octet of the subnet broadcast address.|используемый IP-адрес в подсети, просто добавьте 1 к четвертому октету идентификатора подсети. Чтобы найти последний (самый высокий) используемый IP-адрес, просто вычтите 1 из четвертого октета широковещательного адреса подсети.
### Analyzing Existing Subnets: Decimal
Анализ существующих подсетей: десятичный   
__|__
--|--
|
Analyzing existing subnets using the binary process works well.|Хорошо работает анализ существующих подсетей с использованием двоичного процесса.
However, some of the math takes time for most people, particularly the decimal-binary conversions.|Однако у большинства людей некоторые математические вычисления требуют времени, особенно десятично-двоичные преобразования.
And you need to do the math quickly for the Cisco CCNA exam.|И вам нужно быстро посчитать для экзамена Cisco CCNA.
For the exam, you really should be able to take an IP address and mask, and calculate the subnet ID and range of usable addresses within about 15 seconds.|Для экзамена вы действительно должны уметь взять IP-адрес и маску и рассчитать идентификатор подсети и диапазон используемых адресов примерно за 15 секунд.
When using binary methods, most people require a lot of practice to be able to find these answers, even when using the abbreviated binary process.|При использовании двоичных методов большинству людей требуется много практики, чтобы найти эти ответы, даже при использовании сокращенного двоичного процесса.
|
This section discusses how to find the subnet ID and subnet broadcast address using only decimal math.|В этом разделе обсуждается, как найти идентификатор подсети и широковещательный адрес подсети, используя только десятичные вычисления.
Most people can find the answers more quickly using this process, at least after a little practice, as compared with the binary process.|Большинство людей могут быстрее находить ответы с помощью этого процесса, по крайней мере после небольшой практики, по сравнению с двоичным процессом.
However, the decimal process does not tell you anything about the meaning behind the math.|Однако десятичный процесс ничего не говорит вам о значении математики.
So, if you have not read the earlier section “Analyzing Existing Subnets: Binary,” it is worthwhile to read it for the sake of understanding subnetting.|Итак, если вы не читали предыдущий раздел «Анализ существующих подсетей: двоичные», стоит прочитать его, чтобы понять разбиение на подсети.
This section focuses on getting the right answer using a method that, after you have practiced, should be faster.|В этом разделе основное внимание уделяется тому, чтобы получить правильный ответ с помощью метода, который после практики должен быть быстрее.
#### Analysis with Easy Masks
Анализ с помощью простых масок   
__|__
--|--
|
With three easy subnet masks in particular, finding the subnet ID and subnet broadcast address requires only easy logic and literally no math.|В частности, с помощью трех простых масок подсети для поиска идентификатора подсети и широковещательного адреса подсети требуется только простая логика и буквально никаких математических вычислений.
Three easy masks exist:|Существуют три простых маски:
|
255.0.0.0 255.255.0.0 255.255.255.0 These easy masks have only 255 and 0 in decimal.|255.0.0.0 255.255.0.0 255.255.255.0 Эти простые маски содержат только 255 и 0 в десятичном виде.
In comparison, difficult masks have one octet that has neither a 255 nor a 0 in the mask, which makes the logic more challenging.|Для сравнения, сложные маски имеют один октет, в котором нет ни 255, ни 0, что усложняет логику.
|
NOTE The terms easy mask and difficult mask are terms created for use in this book to describe the masks and the level of difficulty when working with each.|ПРИМЕЧАНИЕ Термины простая маска и сложная маска - это термины, созданные для использования в этой книге для описания масок и уровня сложности при работе с ними.
|
When the problem uses an easy mask, you can quickly find the subnet ID based on the IP address and mask in DDN format.|Когда проблема использует простую маску, вы можете быстро найти идентификатор подсети на основе IP-адреса и маски в формате DDN.
Just use the following process for each of the four octets to find the subnet ID:|Просто используйте следующий процесс для каждого из четырех октетов, чтобы найти идентификатор подсети:
|
Step 1.|Шаг 1.
If the mask octet = 255, copy the decimal IP address.|Если октет маски = 255, скопируйте десятичный IP-адрес.
|
Step 2.|Шаг 2.
If the mask octet = 0, write a decimal 0.|Если октет маски = 0, запишите десятичный 0.
|
A similar simple process exists to find the subnet broadcast address, as follows:|Аналогичный простой процесс существует для поиска широковещательного адреса подсети, а именно:
|
Step 1.|Шаг 1.
If the mask octet = 255, copy the decimal IP address.|Если октет маски = 255, скопируйте десятичный IP-адрес.
|
Step 2.|Шаг 2.
If the mask octet = 0, write a decimal 255.|Если октет маски = 0, запишите десятичное число 255.
|
Before moving to the next section, take some time to fill in the blanks in Table 14-9.|Перед тем, как перейти к следующему разделу, заполните пробелы в Таблице 14-9.
Check your answers against Table 14-15 in the section “Answers to Earlier Practice Problems,” later in this chapter.|Сравните свои ответы с Таблицей 14-15 в разделе «Ответы на более ранние практические проблемы» далее в этой главе.
Complete the table by listing the subnet ID and subnet broadcast address.|Заполните таблицу, указав идентификатор подсети и широковещательный адрес подсети.
|
Table 14-9 Practice Problems: Find Subnet ID and Broadcast Address, Easy Masks Table end.|Таблица 14-9 Практические задачи: поиск идентификатора подсети и адреса широковещательной передачи, конец таблицы простых масок.
#### Predictability in the Interesting Octet
Предсказуемость в интересном октете   
__|__
--|--
|
Although three masks are easier to work with (255.0.0.0, 255.255.0.0, and 255.255.255.0), the rest make the decimal math a little more difficult, so we call these masks difficult masks.|Хотя с тремя масками легче работать (255.0.0.0, 255.255.0.0 и 255.255.255.0), остальные несколько усложняют десятичные вычисления, поэтому мы называем эти маски сложными масками.
With difficult masks, one octet is neither a 0 nor a 255.|В сложных масках один октет не равен ни 0, ни 255.
The math in the other three octets is easy and boring, so this book calls the one octet with the more difficult math the interesting octet.|Математика в трех других октетах проста и утомительна, поэтому в этой книге один октет с более сложной математикой называется интересным октетом.
|
If you take some time to think about different problems and focus on the interesting octet, you will begin to see a pattern.|Если вы потратите некоторое время на то, чтобы подумать о различных проблемах и сосредоточиться на интересном октете, вы начнете видеть закономерность.
This section takes you through that examination so that you can learn how to predict the pattern, in decimal, and find the subnet ID.|Этот раздел проведет вас через этот экзамен, чтобы вы могли узнать, как предсказать шаблон в десятичном формате и найти идентификатор подсети.
|
First, the subnet ID value has a predictable decimal value because of the assumption that a single subnet mask is used for all subnets of a single classful network.|Во-первых, значение идентификатора подсети имеет предсказуемое десятичное значение из-за предположения, что одна маска подсети используется для всех подсетей одной классовой сети.
The chapters in this part of the book assume that, for a given classful network, the design engineer chooses to use a single subnet mask for all subnets. (See the section “One Size Subnet Fits All—Or Not”|В главах этой части книги предполагается, что для данной классовой сети инженер-проектировщик решает использовать одну маску подсети для всех подсетей. (См. Раздел «Подсеть одного размера подходит всем - или нет»
|
in Chapter 11, “Perspectives on IPv4 Subnetting,” for more details.)|в главе 11 «Перспективы разделения IPv4 на подсети» для получения более подробной информации.)
|
To see that predictability, consider some planning information written down by a network engineer, as shown in Figure 14-8.|Чтобы увидеть эту предсказуемость, рассмотрите некоторую информацию о планировании, записанную сетевым инженером, как показано на Рисунке 14-8.
The figure shows four different masks the engineer is considering using in an IPv4 network, along with Class B network 172.16.0.0.|На рисунке показаны четыре различные маски, которые инженер рассматривает для использования в сети IPv4, а также сеть класса B 172.16.0.0.
The figure shows the third-octet values for the subnet IDs that would be created when using mask 255.255.128.0, 255.255.192.0, 255.255.224.0, and 255.255.240.0, from top to bottom in the figure.|На рисунке сверху вниз показаны значения третьего октета для идентификаторов подсети, которые будут созданы при использовании маски 255.255.128.0, 255.255.192.0, 255.255.224.0 и 255.255.240.0.
|
Figure 14-8 Numeric Patterns in the Interesting Octet First, to explain the figure further, look at the top row of the figure.|Рис. 14-8. Числовые паттерны в интересном октете Сначала, чтобы пояснить фигуру, посмотрите на верхнюю строку рисунка.
If the engineer uses 255.255.128.0 as the mask, the mask creates two subnets, with subnet IDs 172.16.0.0 and 172.16.128.0.|Если инженер использует 255.255.128.0 в качестве маски, маска создает две подсети с идентификаторами подсети 172.16.0.0 и 172.16.128.0.
If the engineer uses mask 255.255.192.0, the mask creates four subnets, with subnet IDs 172.16.0.0, 172.16.64.0, 172.16.128.0, and 172.16.192.0.|Если инженер использует маску 255.255.192.0, маска создает четыре подсети с идентификаторами подсети 172.16.0.0, 172.16.64.0, 172.16.128.0 и 172.16.192.0.
|
If you take the time to look at the figure, the patterns become obvious.|Если вы потратите время на то, чтобы посмотреть на рисунок, закономерности станут очевидны.
In this case:|В этом случае:
|
Mask: 255.255.128.0 Pattern: Multiples of 128 Mask: 255.255.192.0 Pattern: Multiples of 64 Mask: 255.255.224.0 Pattern: Multiples of 32 Mask: 255.255.240.0 Pattern: Multiples of 16 To find the subnet ID, you just need a way to figure out what the pattern is.|Маска: 255.255.128.0 Шаблон: кратный 128 Маска: 255.255.192.0 Шаблон: кратный 64 Маска: 255.255.224.0 Шаблон: кратный 32 Маска: 255.255.240.0 Шаблон: кратный 16 Чтобы найти идентификатор подсети, вам просто нужен способ выяснить, что это за узор.
If you start with an IP address and mask, just find the subnet ID closest to the IP address, without going over, as discussed in the next section.|Если вы начинаете с IP-адреса и маски, просто найдите идентификатор подсети, ближайший к IP-адресу, не переходя, как описано в следующем разделе.
#### Finding the Subnet ID: Difficult Masks
Определение идентификатора подсети: сложные маски   
__|__
--|--
|
The following written process lists all the steps to find the subnet ID, using only decimal math.|В следующем письменном процессе перечислены все шаги по поиску идентификатора подсети с использованием только десятичной математики.
This process adds to the earlier process used with easy masks.|Этот процесс дополняет предыдущий процесс, который использовался с простыми масками.
For each octet:|Для каждого октета:
|
Step 1.|Шаг 1.
If the mask octet = 255, copy the decimal IP address.|Если октет маски = 255, скопируйте десятичный IP-адрес.
|
Step 2.|Шаг 2.
If the mask octet = 0, write a decimal 0.|Если октет маски = 0, запишите десятичный 0.
|
Step 3.|Шаг 3.
If the mask is neither, refer to this octet as the interesting octet:|Если маска не совпадает, назовите этот октет интересным октетом:
|
A. Calculate the magic number as 256 – mask.|A. Рассчитайте магическое число как 256 - маска.
|
B. Set the subnet ID’s value to the multiple of the magic number that is closest to the IP address without going over.|Б. Установите значение идентификатора подсети, кратное магическому числу, которое ближе всего к IP-адресу, не переходя через него.
|
The process uses two new terms created for this book: magic number and interesting octet.|В процессе используются два новых термина, созданных для этой книги: магическое число и интересный октет.
|
The term interesting octet refers to the octet identified at Step 3 in the process; in other words, it is the octet with the mask that is neither 255 nor 0.|Термин интересующий октет относится к октету, идентифицированному на шаге 3 в процессе; другими словами, это октет с маской, которая не равна ни 255, ни 0.
Step 3A then uses the term magic number, which is derived from the DDN mask.|Затем на шаге 3A используется термин «магическое число», производный от маски DDN.
Conceptually, the magic number is the number you add to one subnet ID to get the next subnet ID in order, as shown in Figure 14-8.|По сути, магическое число - это число, которое вы добавляете к одному идентификатору подсети, чтобы получить следующий идентификатор подсети по порядку, как показано на рисунке 14-8.
Numerically, it can be found by subtracting the DDN mask’s value, in the interesting octet, from 256, as mentioned in Step 3A.|Численно его можно найти, вычитая значение маски DDN в интересующем октете из 256, как упоминалось в шаге 3A.
|
The best way to learn this process is to see it happen.|Лучший способ изучить этот процесс - увидеть, как он происходит.
In fact, if you can, stop reading now, use the companion website for this book, and watch the videos about finding the subnet ID with a difficult mask.|Фактически, если вы можете, прекратите читать сейчас, используйте сопутствующий веб-сайт для этой книги и посмотрите видеоролики о поиске идентификатора подсети со сложной маской.
These videos demonstrate this process.|Эти видео демонстрируют этот процесс.
You can also use the examples on the next few pages that show the process being used on paper.|Вы также можете использовать примеры на следующих нескольких страницах, которые демонстрируют используемый процесс на бумаге.
Then follow the practice opportunities outlined in the section “Practice Analyzing Existing Subnets,” later in this chapter.|Затем следуйте практическим возможностям, описанным в разделе «Практика анализа существующих подсетей» далее в этой главе.
##### Resident Subnet Example 1
Резидентная подсеть, пример 1   
__|__
--|--
|
For example, consider the requirement to find the resident subnet for IP address 130.4.102.1, mask 255.255.240.0.|Например, рассмотрим требование найти резидентную подсеть для IP-адреса 130.4.102.1, маска 255.255.240.0.
The process does not require you to think about prefix bits versus host bits, convert the mask, think about the mask in binary, or convert the IP address to and from binary.|Этот процесс не требует, чтобы вы думали о битах префикса по сравнению с битами хоста, преобразовывали маску, думали о маске в двоичном формате или преобразовывали IP-адрес в двоичный и обратно.
Instead, for each of the four octets, choose an action based on the value in the mask.|Вместо этого для каждого из четырех октетов выберите действие на основе значения в маске.
|
Figure 14-9 shows the results; the circled numbers in the figure refer to the step numbers in the written process to find the subnet ID, as listed in the previous few pages.|Рисунок 14-9 показывает результаты; числа в кружке на рисунке относятся к номерам шагов в письменном процессе поиска идентификатора подсети, как указано на предыдущих нескольких страницах.
|
Figure 14-9 Find the Subnet ID: 130.4.102.1, 255.255.240.0 First, examine the three uninteresting octets (1, 2, and 4, in this example).|Рисунок 14-9 Найдите идентификатор подсети: 130.4.102.1, 255.255.240.0 Сначала проверьте три неинтересных октета (1, 2 и 4 в этом примере).
The process keys on the mask, and the first two octets have a mask value of 255, so simply copy the IP address to the place where you intend to write down the subnet ID. The fourth octet has a mask value of 0, so write down a 0 for the fourth octet of the subnet ID.|Ключи процессов в маске и первые два октета имеют значение маски 255, поэтому просто скопируйте IP-адрес в то место, где вы собираетесь записать идентификатор подсети. Четвертый октет имеет значение маски 0, поэтому запишите 0 для четвертого октета идентификатора подсети.
|
The most challenging logic occurs in the interesting octet, which is the third octet in this example, because of the mask value 240 in that octet.|Самая сложная логика возникает в интересующем октете, который является третьим октетом в этом примере, из-за значения маски 240 в этом октете.
For this octet, Step 3A asks you to calculate the magic number as 256 – mask.|Для этого октета шаг 3A просит вас вычислить магическое число как 256 - маску.
That means you take the mask’s value in the interesting octet (240, in this case) and subtract it from 256: 256 – 240 = 16.|Это означает, что вы берете значение маски в интересующем октете (в данном случае 240) и вычитаете его из 256: 256 - 240 = 16.
The subnet ID’s value in this octet must be a multiple of decimal 16, in this case.|В этом случае значение идентификатора подсети в этом октете должно быть кратным десятичному числу 16.
|
Step 3B then asks you to find the multiples of the magic number (16, in this case) and choose the one closest to the IP address without going over.|Затем на шаге 3B вас попросят найти кратные магическому числу (в данном случае 16) и выбрать ближайшее к IP-адресу, не переходя к следующему.
Specifically, that means that you should mentally calculate the multiples of the magic number, starting at 0. (Do not forget to start at 0!) Count, starting at 0: 0, 16, 32, 48, 64, 80, 96, 112, and so on.|В частности, это означает, что вы должны мысленно вычислить кратные магическому числу, начиная с 0. (Не забудьте начать с 0!) Счет, начиная с 0: 0, 16, 32, 48, 64, 80, 96, 112 и так далее.
Then, find the multiple closest to the IP address value in this octet (102, in this case), without going over 102.|Затем найдите кратное число, наиболее близкое к значению IP-адреса в этом октете (в данном случае 102), не превышая 102.
So, as shown in Figure 14-9, you make the third octet’s value 96 to complete the subnet ID of 130.4.96.0.|Итак, как показано на рис. 14-9, вы делаете значение 96 третьего октета, чтобы завершить идентификатор подсети 130.4.96.0.
##### Resident Subnet Example 2
Резидентная подсеть, пример 2   
__|__
--|--
|
Consider another example: 192.168.5.77, mask 255.255.255.224.|Рассмотрим другой пример: 192.168.5.77, маска 255.255.255.224.
Figure 14-10 shows the results.|На рисунке 14-10 показаны результаты.
|
The three uninteresting octets (1, 2, and 3, in this case) require only a little thought.|Три неинтересных октета (в данном случае 1, 2 и 3) требуют лишь небольшого размышления.
For each octet, each with a mask value of 255, just copy the IP address.|Для каждого октета, каждый со значением маски 255, просто скопируйте IP-адрес.
|
For the interesting octet, at Step 3A, the magic number is 256 – 224 = 32.|Для интересного октета на шаге 3A магическое число 256 - 224 = 32.
The multiples of the magic number are 0, 32, 64, 96, and so on.|Кратное магическое число: 0, 32, 64, 96 и так далее.
Because the IP address value in the fourth octet is 77, in this case, the multiple must be the number closest to 77 without going over;|Поскольку значение IP-адреса в четвертом октете равно 77, в этом случае кратное число должно быть числом, наиболее близким к 77, без перехода;
|
therefore, the subnet ID ends with 64, for a value of 192.168.5.64.|следовательно, идентификатор подсети заканчивается на 64 для значения 192.168.5.64.
|
Figure 14-10 Resident Subnet for 192.168.5.77, 255.255.255.224|Рисунок 14-10 Резидентная подсеть для 192.168.5.77, 255.255.255.224
##### Resident Subnet Practice Problems
Проблемы с резидентной подсетью   
__|__
--|--
|
Before moving to the next section, take some time to fill in the blanks in Table 14-10.|Перед тем, как перейти к следующему разделу, найдите время, чтобы заполнить пробелы в Таблице 14-10.
Check your answers against Table 14-16 in the section “Answers to Earlier Practice Problems,” later in this chapter.|Сравните свои ответы с Таблицей 14-16 в разделе «Ответы на более ранние практические проблемы» далее в этой главе.
Complete the table by listing the subnet ID in each case.|Заполните таблицу, указав в каждом случае идентификатор подсети.
The text following Table 14-16 also lists explanations for each problem.|В тексте после Таблицы 14-16 также приведены объяснения каждой проблемы.
|
Table 14-10 Practice Problems: Find Subnet ID, Difficult Masks Table end.|Таблица 14-10 Практические проблемы: найти идентификатор подсети, конец таблицы сложных масок.
#### Finding the Subnet Broadcast Address: Difficult Masks
Нахождение широковещательного адреса подсети: сложные маски   
__|__
--|--
|
To find a subnet’s broadcast address, a similar process can be used.|Чтобы найти широковещательный адрес подсети, можно использовать аналогичный процесс.
For simplicity, this process begins with the subnet ID, rather than the IP address.|Для простоты этот процесс начинается с идентификатора подсети, а не с IP-адреса.
If you happen to start with an IP address instead, use the processes in this chapter to first find the subnet ID, and then use the following process to find the subnet broadcast address for that same subnet.|Если вместо этого вы начинаете с IP-адреса, используйте процессы из этой главы, чтобы сначала найти идентификатор подсети, а затем используйте следующий процесс, чтобы найти широковещательный адрес подсети для этой же подсети.
For each octet:|Для каждого октета:
|
Step 1.|Шаг 1.
If the mask octet = 255, copy the subnet ID.|Если октет маски = 255, скопируйте идентификатор подсети.
|
Step 2.|Шаг 2.
If the mask octet = 0, write 255.|Если октет маски = 0, напишите 255.
|
Step 3.|Шаг 3.
If the mask is neither, identify this octet as the interesting octet:|Если маска не совпадает, идентифицируйте этот октет как интересующий октет:
|
A. Calculate the magic number as 256 – mask.|A. Рассчитайте магическое число как 256 - маска.
|
B. Take the subnet ID’s value, add the magic number, and subtract 1 (ID +|Б. Возьмите значение идентификатора подсети, добавьте магическое число и вычтите 1 (идентификатор +
|
magic – 1).|магия - 1).
|
As with the similar process used to find the subnet ID, you have several options for how to best learn and internalize the process.|Как и в случае с аналогичным процессом, используемым для поиска идентификатора подсети, у вас есть несколько вариантов, как лучше всего изучить и усвоить процесс.
If you can, stop reading now, use the companion website for this book, and watch the videos listed for this chapter.|Если можете, прекратите читать сейчас, используйте сопутствующий веб-сайт этой книги и посмотрите видео, перечисленные для этой главы.
Also, look at the examples in this section, which show the process being used on paper.|Кроме того, посмотрите на примеры в этом разделе, которые показывают используемый процесс на бумаге.
Then, follow the practice opportunities outlined in the section “Additional Practice for This Chapter’s Processes.”|Затем воспользуйтесь возможностями практики, описанными в разделе «Дополнительная практика для процессов этой главы».
##### Subnet Broadcast Example 1
Пример широковещательной рассылки в подсети 1   
__|__
--|--
|
The first example continues the first example from the section “Finding the Subnet ID:|Первый пример продолжает первый пример из раздела «Определение идентификатора подсети:
|
Difficult Masks,” earlier in this chapter, as demonstrated in Figure 14-9.|Сложные маски »ранее в этой главе, как показано на рис. 14-9.
That example started with the IP address/mask of 130.4.102.1, 255.255.240.0, and showed how to find subnet ID 130.4.96.0.|Этот пример начался с IP-адреса / маски 130.4.102.1, 255.255.240.0 и показал, как найти идентификатор подсети 130.4.96.0.
Figure 14-11 now begins with that subnet ID and the same mask.|Рисунок 14-11 теперь начинается с этого идентификатора подсети и той же маски.
|
130 . 4 . 111 . 255 1 1 3 2 +Magic –1 Copy Copy 255 . . .|130. 4. 111. 255 1 1 3 2 + Magic –1 Копия Копия 255. . .
|
Figure 14-11 Find the Subnet Broadcast: 130.4.96.0, 255.255.240.0 First, examine the three uninteresting octets (1, 2, and 4).|Рисунок 14-11. Найдите широковещательную рассылку подсети: 130.4.96.0, 255.255.240.0 Во-первых, проверьте три неинтересных октета (1, 2 и 4).
The process keys on the mask, and the first two octets have a mask value of 255, so simply copy the subnet ID to the place where you intend to write down the subnet broadcast address.|Ключи процессов в маске и первые два октета имеют значение маски 255, поэтому просто скопируйте идентификатор подсети в то место, где вы собираетесь записать широковещательный адрес подсети.
The fourth octet has a mask value of 0, so write down a 255 for the fourth octet.|Четвертый октет имеет значение маски 0, поэтому запишите 255 для четвертого октета.
|
The logic related to the interesting octet occurs in the third octet in this example because of the mask value 240.|Логика, связанная с интересующим октетом, происходит в третьем октете в этом примере из-за значения маски 240.
First, Step 3A asks you to calculate the magic number, as 256 – mask.|Во-первых, шаг 3А просит вас вычислить магическое число, как 256 - маска.
|
(If you had already calculated the subnet ID using the decimal process in this book, you should already know the magic number.) At Step 3B, you take the subnet ID’s value (96), add the magic number (16), and subtract 1, for a total of 111.|(Если вы уже вычислили идентификатор подсети, используя десятичный процесс в этой книге, вы уже должны знать магическое число.) На шаге 3B вы берете значение идентификатора подсети (96), добавляете магическое число (16) и вычитаете 1, всего 111.
That makes the subnet broadcast address 130.4.111.255.|Это делает широковещательный адрес подсети 130.4.111.255.
##### Subnet Broadcast Example 2
Пример широковещательной рассылки в подсети 2   
__|__
--|--
|
Again, this example continues an earlier example, from the section “Resident Subnet Example 2,” as demonstrated in Figure 14-10.|Опять же, этот пример продолжает предыдущий пример из раздела «Пример резидентной подсети 2», как показано на рисунке 14-10.
That example started with the IP address/mask of 192.168.5.77, mask 255.255.255.224 and showed how to find subnet ID 192.168.5.64.|Этот пример начался с IP-адреса / маски 192.168.5.77, маски 255.255.255.224 и показал, как найти идентификатор подсети 192.168.5.64.
|
Figure 14-12 now begins with that subnet ID and the same mask.|Рисунок 14-12 теперь начинается с этого идентификатора подсети и той же маски.
|
First, examine the three uninteresting octets (1, 2, and 3).|Сначала рассмотрим три неинтересных октета (1, 2 и 3).
The process keys on the mask, and the first three octets have a mask value of 255, so simply copy the subnet ID to the place where you intend to write down the subnet broadcast address.|Ключи процесса в маске и первые три октета имеют значение маски 255, поэтому просто скопируйте идентификатор подсети в то место, где вы собираетесь записать широковещательный адрес подсети.
|
ID 0-255 192 . 168 . 5 . 95 1 1 1 3 Copy Copy +Magic –1 Copy . . .|ID 0-255 192. 168. 5. 95 1 1 1 3 Копирование Копирование + Magic –1 Копирование. . .
|
Figure 14-12 Find the Subnet Broadcast: 192.168.5.64, 255.255.255.224 The interesting logic occurs in the interesting octet, the fourth octet in this example, because of the mask value 224.|Рис. 14-12. Поиск широковещательной рассылки в подсети: 192.168.5.64, 255.255.255.224 Интересная логика возникает в интересующем октете, четвертом октете в этом примере, из-за значения маски 224.
First, Step 3A asks you to calculate the magic number, as 256 – mask.|Во-первых, шаг 3А просит вас вычислить магическое число, как 256 - маска.
|
(If you had already calculated the subnet ID, it is the same magic number because the same mask is used.) At Step 3B, you take the subnet ID’s value (64), add magic (32), and subtract 1, for a total of 95.|(Если вы уже вычислили идентификатор подсети, это то же магическое число, потому что используется та же маска.) На шаге 3B вы берете значение идентификатора подсети (64), добавляете магию (32) и вычитаете 1 для всего 95.
That makes the subnet broadcast address 192.168.5.95.|Это делает широковещательный адрес подсети 192.168.5.95.
##### Subnet Broadcast Address Practice Problems
Проблемы с практикой адресации широковещательной передачи в подсети   
__|__
--|--
|
Before moving to the next section, take some time to do several practice problems on a scratch piece of paper.|Перед тем, как перейти к следующему разделу, уделите время выполнению нескольких практических задач на листе бумаги.
Go back to Table 14-10, which lists IP addresses and masks, and practice by finding the subnet broadcast address for all the problems in that table.|Вернитесь к таблице 14-10, в которой перечислены IP-адреса и маски, и потренируйтесь найти широковещательный адрес подсети для всех проблем в этой таблице.
Then check your answers against Table 14-17 in the section “Answers to Earlier Practice Problems,” later in this chapter.|Затем сверьте свои ответы с Таблицей 14-17 в разделе «Ответы на более ранние практические задачи» далее в этой главе.
### Practice Analyzing Existing Subnets
Практика анализа существующих подсетей   
__|__
--|--
|
As with the other subnetting math in this book, using a two-phase approach may help.|Как и в случае с другой математикой разбиения на подсети в этой книге, может помочь двухэтапный подход.
Take time now to practice until you feel like you understand the process.|Найдите время для практики, пока не почувствуете, что понимаете процесс.
Then, before the exam, make sure you master the math.|Затем, перед экзаменом, убедитесь, что вы освоили математику.
Table 14-11 summarizes the key concepts and suggestions for this two-phase approach.|Таблица 14-11 суммирует ключевые концепции и предложения для этого двухэтапного подхода.
|
Table 14-11 Keep-Reading and Take-Exam Goals for This Chapter’s Topics Table end.|Таблица 14-11 Цели «Продолжайте читать и сдавать экзамен» в конце таблицы тем этой главы.
#### A Choice: Memorize or Calculate
Выбор: запомнить или рассчитать   
__|__
--|--
|
As described in this chapter, the decimal processes to find the subnet ID and subnet broadcast address do require some calculation, including the calculation of the magic number (256 – mask).|Как описано в этой главе, десятичные процессы для нахождения идентификатора подсети и широковещательного адреса подсети требуют некоторых вычислений, включая вычисление магического числа (256 - маска).
The processes also use a DDN mask, so if an exam question gives you a prefix-style mask, you need to convert to DDN format before using the process in this book.|Процессы также используют маску DDN, поэтому, если вопрос экзамена дает вам маску стиля префикса, вам необходимо преобразовать в формат DDN, прежде чем использовать процесс, описанный в этой книге.
|
Over the years, some people have told me they prefer to memorize a table to find the magic number.|На протяжении многих лет некоторые люди говорили мне, что они предпочитают запоминать таблицу, чтобы найти магическое число.
These tables could list the magic number for different DDN masks and prefix masks, so you avoid converting from the prefix mask to DDN. Table 14-12 shows an example of such a table.|В этих таблицах могут быть указаны магические числа для различных масок DDN и масок префикса, поэтому вы избегаете преобразования из маски префикса в DDN. В таблице 14-12 показан пример такой таблицы.
Feel free to ignore this table, use it, or make your own.|Не стесняйтесь игнорировать эту таблицу, использовать ее или создавать свою собственную.
|
Table 14-12 Reference Table: DDN Mask Values, Binary Equivalent, Magic Numbers, Table end.|Таблица 14-12 Справочная таблица: значения маски DDN, двоичный эквивалент, магические числа, конец таблицы.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element for more details.|Обратитесь к элементу «Ваш учебный план» для получения более подробной информации.
Table 14-13 outlines the key review elements and where you can find them.|В Таблице 14-13 представлены основные элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 14-13 Chapter Review Tracking Table end.|Таблица 14-13 Окончание таблицы отслеживания обзора главы.
|
Review All the Key Topics Key Terms You Should Know resident subnet, subnet ID, subnet number, subnet address, subnet broadcast address Additional Practice for This Chapter’s Processes You can do more practice with the processes in this chapter with a pair of practice sets.|Ознакомьтесь со всеми ключевыми темами. Ключевые термины, которые вы должны знать резидентную подсеть, идентификатор подсети, номер подсети, адрес подсети, широковещательный адрес подсети. Дополнительная практика для процессов, описанных в этой главе. Вы можете попрактиковаться в процессах, описанных в этой главе, с помощью пары практических наборов.
Both give you practice at analyzing existing subnets.|Оба дают вам практику в анализе существующих подсетей.
You may do each practice set using the following tools:|Вы можете выполнять каждый набор упражнений, используя следующие инструменты:
|
Application: Use the “Analyzing Existing Subnets” exercises 1 and 2 on the companion website, listed under the Chapter Review for this chapter.|Применение: используйте упражнения 1 и 2 «Анализ существующих подсетей» на сопутствующем веб-сайте, перечисленные в разделе «Обзор главы» для этой главы.
|
PDF: Alternatively, practice the same problems found in these apps using companion website Answers to Earlier Practice Problems This chapter includes practice problems spread around different locations in the chapter.|PDF: В качестве альтернативы, попробуйте те же проблемы, что и в этих приложениях, с помощью сопутствующего веб-сайта. Ответы на более ранние практические проблемы.
The answers are located in Tables 14-15, 14-16, and 14-17.|Ответы находятся в таблицах 14-15, 14-16 и 14-17.
|
Table 14-15 Answers to Problems in Table 14-9 Table end.|Таблица 14-15. Ответы на проблемы в таблице 14-9. В конце таблицы.
|
Table 14-16 Answers to Problems in Table 14-10 Table end.|Таблица 14-16. Ответы на проблемы в таблице 14-10. В конце таблицы.
|
The following list explains the answers for Table 14-16:|Следующий список объясняет ответы для Таблицы 14-16:
|
1. The second octet is the interesting octet, with magic number 256 – 248 = 8.|1. Второй октет - это интересный октет с магическим числом 256 - 248 = 8.
The multiples of 8 include 0, 8, 16, 24, …, 64, 72, and 80. 72 is closest to the IP address value in that same octet (77) without going over, making the subnet ID 10.72.0.0.|Кратные 8 включают 0, 8, 16, 24,…, 64, 72 и 80. 72 является ближайшим к значению IP-адреса в том же октете (77) без перехода, что делает идентификатор подсети 10.72.0.0.
|
2. The third octet is the interesting octet, with magic number 256 – 192 = 64.|2. Третий октет - это интересный октет с магическим числом 256 - 192 = 64.
The multiples of 64 include 0, 64, 128, and 192. 64 is closest to the IP address value in that same octet (99) without going over, making the subnet ID 172.30.64.0.|Число, кратное 64, включает 0, 64, 128 и 192. 64 является ближайшим к значению IP-адреса в том же октете (99) без перехода, что делает идентификатор подсети 172.30.64.0.
|
3. The fourth octet is the interesting octet, with magic number 256 – 252 = 4.|3. Четвертый октет представляет собой интересный октет с магическим числом 256 - 252 = 4.
The multiples of 4 include 0, 4, 8, 12, 16, …, 48, 52, and 56. 52 is the closest to the IP address value in that same octet (54) without going over, making the subnet ID 192.168.6.52.|Кратные 4 включают 0, 4, 8, 12, 16,…, 48, 52 и 56. 52 является ближайшим к значению IP-адреса в том же октете (54) без перехода, что делает идентификатор подсети 192.168.0. 6.52.
|
4. The third octet is the interesting octet, with magic number 256 – 128 = 128.|4. Третий октет - это интересный октет с магическим числом 256 - 128 = 128.
Only two multiples exist that matter: 0 and 128. 0 is the closest to the IP address value in that same octet (3) without going over, making the subnet ID 10.77.0.0.|Существуют только два числа, имеющих значение: 0 и 128. 0 является ближайшим к значению IP-адреса в том же октете (3) без перехода, что делает идентификатор подсети 10.77.0.0.
|
5. The third octet is the interesting octet, with magic number 256 – 254 = 2.|5. Третий октет - это интересный октет с магическим числом 256 - 254 = 2.
The multiples of 2 include 0, 2, 4, 6, 8, and so on—essentially all even numbers. 54 is closest to the IP address value in that same octet (55) without going over, making the subnet ID 172.22.54.0.|Кратное 2 включает 0, 2, 4, 6, 8 и так далее - по сути, все четные числа. 54 является ближайшим к значению IP-адреса в том же октете (55) без перехода, что делает идентификатор подсети 172.22.54.0.
|
6. The fourth octet is the interesting octet, with magic number 256 – 248 = 8.|6. Четвертый октет представляет собой интересный октет с магическим числом 256 - 248 = 8.
The multiples of 8 include 0, 8, 16, 24, …, 64, 72, and 80. 72 is closest to the IP address value in that same octet (76) without going over, making the subnet ID 1.99.53.72.|Кратные 8 включают 0, 8, 16, 24,…, 64, 72 и 80. 72 является наиболее близким к значению IP-адреса в том же октете (76) без перехода, что делает идентификатор подсети 1.99.53.72.
|
Table 14-17 Answers to Problems in the Section “Subnet Broadcast Address Practice Table end.|Таблица 14-17 «Ответы на проблемы» в разделе «Конец таблицы практических адресов для широковещательной рассылки.
|
The following list explains the answers for Table 14-17:|В следующем списке приведены ответы на Таблицу 14-17:
|
1. The second octet is the interesting octet.|1. Второй октет - интересный октет.
Completing the three easy octets means that the broadcast address in the interesting octet will be 10.___.255.255.|Заполнение трех простых октетов означает, что широковещательный адрес в интересующем октете будет 10 .___. 255.255.255.
With magic number 256 – 248 = 8, the second octet will be 72 (from the subnet ID), plus 8, minus 1, or 79.|Если магическое число 256 - 248 = 8, второй октет будет равен 72 (из идентификатора подсети), плюс 8, минус 1 или 79.
|
2. The third octet is the interesting octet.|2. Третий октет - интересный октет.
Completing the three easy octets means that the broadcast address in the interesting octet will be 172.30.___.255.|Заполнение трех простых октетов означает, что широковещательный адрес в интересующем октете будет 172.30 .___. 255.
With magic number 256 – 192 = 64, the interesting octet will be 64 (from the subnet ID), plus 64 (the magic number), minus 1, for 127.|Если магическое число 256 - 192 = 64, интересующий октет будет 64 (из идентификатора подсети) плюс 64 (магическое число) минус 1, для 127.
|
3. The fourth octet is the interesting octet.|3. Четвертый октет - интересный октет.
Completing the three easy octets means that the broadcast address in the interesting octet will be 192.168.6.___.|Заполнение трех простых октетов означает, что широковещательный адрес в интересующем октете будет 192.168.6 .___.
With magic number 256 – 252 = 4, the interesting octet will be 52 (the subnet ID value), plus 4 (the magic number), minus 1, or 55.|Если магическое число 256 - 252 = 4, интересующий октет будет 52 (значение идентификатора подсети), плюс 4 (магическое число), минус 1 или 55.
|
4. The third octet is the interesting octet.|4. Третий октет - интересный октет.
Completing the three easy octets means that the broadcast address will be 10.77.___.255.|Заполнение трех простых октетов означает, что широковещательный адрес будет 10.77 .___. 255.
With magic number 256 – 128 = 128, the interesting octet will be 0 (the subnet ID value), plus 128 (the magic number), minus 1, or 127.|Если магическое число 256 - 128 = 128, интересующий октет будет равен 0 (значение идентификатора подсети), плюс 128 (магическое число), минус 1 или 127.
|
5. The third octet is the interesting octet.|5. Третий октет - интересный октет.
Completing the three easy octets means that the broadcast address will be 172.22.___.255.|Заполнение трех простых октетов означает, что широковещательный адрес будет 172.22 .___. 255.
With magic number 256 – 254 = 2, the broadcast address in the interesting octet will be 54 (the subnet ID value), plus 2 (the magic number), minus 1, or 55.|С магическим числом 256 - 254 = 2 широковещательный адрес в интересующем октете будет 54 (значение идентификатора подсети), плюс 2 (магическое число), минус 1 или 55.
|
6. The fourth octet is the interesting octet.|6. Четвертый октет - интересный октет.
Completing the three easy octets means that the broadcast address will be 1.99.53.___.|Заполнение трех простых октетов означает, что широковещательный адрес будет 1.99.53 .___.
With magic number 256 – 248 = 8, the broadcast address in the interesting octet will be 72 (the subnet ID value), plus 8 (the magic number), minus 1, or 79.|При магическом числе 256–248 = 8 широковещательный адрес в интересующем октете будет 72 (значение идентификатора подсети), плюс 8 (магическое число), минус 1 или 79.
|
Keep track of your part review progress with the checklist in Table P4-1.|Следите за ходом проверки детали с помощью контрольного списка в Таблице P4-1.
Details on each task follow the table.|Подробности по каждой задаче приведены в таблице.
|
Table P4-1 Part IV Part Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Subnetting Exercises in Appendices on Companion Website Videos on Companion Website Subnetting Exercises on Author’s Blog Subnetting Exercises in IP Subnetting Practice Question Kit Subnetting Labs in Pearson Network Simulator Repeat All DIKTA Questions For this task, use the PCPT software to answer the “Do I Know This Already?” questions again for the chapters in this part of the book.|Таблица P4-1 Часть IV Контрольный список проверки части Действие 1-я дата завершения 2-я дата завершения Повторить все вопросы DIKTA Ответить на вопросы проверки части Обзор ключевых тем Упражнения по подсетям в приложениях на сопутствующем веб-сайте Видео на сопутствующем веб-сайте Упражнения по подсетям в блоге автора Упражнения по подсетям в практическом разделении IP-подсетей Вопрос Лаборатории по созданию подсетей в симуляторе сети Pearson Повторите все вопросы DIKTA Для этой задачи используйте программу PCPT, чтобы ответить на вопрос «Знаю ли я это уже?» еще раз вопросы к главам этой части книги.
|
Answer Part Review Questions For this task, use PCPT to answer the Part Review questions for this part of the book.|Ответы на вопросы обзора части Для этой задачи используйте PCPT, чтобы ответить на вопросы обзора части для этой части книги.
|
Review Key Topics Review all key topics in all chapters in this part, either by browsing the chapters or by using the Key Topics application on the companion website.|Обзор ключевых тем. Просмотрите все ключевые темы во всех главах этой части, просматривая главы или используя приложение «Ключевые темы» на сопутствующем веб-сайте.
|
Watch Videos Chapter 14 recommends several videos as listed on this book’s companion website.|Смотреть видео Глава 14 рекомендует несколько видеороликов, перечисленных на сопутствующем веб-сайте этой книги.
These videos help you understand how to use the process in the book to find facts about subnets, like the range of usable addresses in the subnet.|Эти видеоролики помогут вам понять, как использовать описанный в книге процесс для поиска фактов о подсетях, таких как диапазон используемых адресов в подсети.
|
Subnetting Exercises Chapters 12, 13, and 14 list some subnetting exercises, along with time and accuracy goals.|Упражнения на разбиение на подсети В главах 12, 13 и 14 перечислены некоторые упражнения на разбиение на подсети, а также цели по времени и точности.
|
Now is a good time to work on those goals.|Сейчас хорошее время для работы над этими целями.
Some options include the following:|Некоторые варианты включают следующее:
## Part IV Review
Часть IV Обзор   
__|__
--|--
|
Practice from this book’s appendices or web applications: The Chapter Review sections of Chapters 12, 13, and 14 mention addressing and subnetting exercises included with this book.|Практика из приложений к этой книге или веб-приложений: в разделах «Обзор глав 12, 13 и 14» упоминаются упражнения по адресации и подсетям, включенные в эту книгу.
Find all the related applications in the Part IV Review section of the companion website:|Найдите все соответствующие приложения в разделе «Обзор части IV» на сопутствующем веб-сайте:
|
Pearson Network Simulator: The full Pearson ICND1 or CCNA simulator has subnetting math exercises that you can do by using CLI commands.|Симулятор сети Pearson: полный симулятор Pearson ICND1 или CCNA имеет математические упражнения на подсети, которые можно выполнять с помощью команд интерфейса командной строки.
Look for the labs with “IP Address Rejection” and “Subnet ID Calculation” in their names.|Ищите лаборатории, в названиях которых есть «Отклонение IP-адреса» и «Расчет идентификатора подсети».
|
Author’s blog: I’ve written a few dozen subnetting exercises on the blog over the years.|Блог автора: за многие годы я написал в блоге несколько десятков упражнений на подсети.
|
Just look at the Questions menu item at the top of the page, and you will see a variety of IPv4 addressing and subnetting question types.|Просто посмотрите на пункт меню «Вопросы» в верхней части страницы, и вы увидите множество типов вопросов для адресации IPv4 и подсетей.
Start at http://blog.certskills.com.|Начните с http://blog.certskills.com.
|
Parts V and VI work together to reveal the details of how to implement IPv4 routing in Cisco routers.|Части V и VI работают вместе, чтобы показать подробности того, как реализовать маршрутизацию IPv4 в маршрутизаторах Cisco.
To that end, Part V focuses on the most common features for Cisco routers, including IP address configuration, connected routes, and static routes.|С этой целью в Части V основное внимание уделяется наиболее распространенным функциям маршрутизаторов Cisco, включая конфигурацию IP-адреса, подключенные маршруты и статические маршруты.
Part VI then goes into some detail about the one IP routing protocol discussed in this book: OSPF Version 2 (OSPFv2).|Затем в части VI рассматриваются некоторые подробности одного протокола IP-маршрутизации, обсуждаемого в этой книге: OSPF версии 2 (OSPFv2).
|
Part V follows a progression of topics.|В Части V рассматривается последовательность тем.
First, Chapter 15 examines the fundamentals of routers—|Во-первых, в главе 15 изучаются основы маршрутизаторов.
|
the physical components, how to access the router command-line interface (CLI), and the configuration process.|физические компоненты, способы доступа к интерфейсу командной строки маршрутизатора (CLI) и процесс настройки.
Chapter 15 makes a close comparison of the switch CLI and its basic administrative commands so that you have to learn only new commands that apply to routers but not to switches.|В главе 15 проводится подробное сравнение интерфейса командной строки коммутатора и его основных административных команд, поэтому вам нужно изучать только новые команды, которые применяются к маршрутизаторам, но не к коммутаторам.
|
Chapter 16 then moves on to discuss how to configure routers to route IPv4 packets in the most basic designs.|Затем в главе 16 обсуждается, как настроить маршрутизаторы для маршрутизации пакетов IPv4 в самых простых схемах.
Those designs require a simple IP address/mask configuration on each interface, with the addition of a static route command—a command that directly configures a route into the IP routing table—for each destination subnet.|Эти конструкции требуют простой конфигурации IP-адреса / маски на каждом интерфейсе с добавлением команды статического маршрута - команды, которая напрямую настраивает маршрут в таблицу IP-маршрутизации - для каждой подсети назначения.
|
By the end of Chapter 16, you should have a solid understanding of how to enable IP addressing and routing in a Cisco router, so Chapter 17 continues the progression into more challenging but more realistic configurations related to routing between subnets in a LAN environment.|К концу главы 16 вы должны иметь твердое представление о том, как включить IP-адресацию и маршрутизацию в маршрутизаторе Cisco, поэтому в главе 17 продолжается переход к более сложным, но более реалистичным конфигурациям, связанным с маршрутизацией между подсетями в среде LAN.
Most LANs use many VLANs, with one subnet per VLAN. Cisco routers and switches can be configured to route packets between those subnets, with more than a few twists in the configuration.|В большинстве локальных сетей используется множество виртуальных локальных сетей, по одной подсети на каждую виртуальную локальную сеть. Маршрутизаторы и коммутаторы Cisco могут быть настроены для маршрутизации пакетов между этими подсетями с большим количеством изменений конфигурации.
|
Finally, Part V closes with a chapter about troubleshooting IPv4 routing.|Наконец, часть V завершается главой об устранении неполадок маршрутизации IPv4.
The chapter features the ping and traceroute commands, two commands that can help you discover not only whether a routing problem exists but also where the problem exists.|В этой главе представлены команды ping и traceroute, две команды, которые могут помочь вам определить не только наличие проблемы маршрутизации, но также и то, где она существует.
Chapters 15, 16, and 17 show how to confirm whether a route has been added to one router’s routing table, while the commands discussed in Chapter 18 teach you how to test the end-to-end routes from sending host to receiving host.|В главах 15, 16 и 17 показано, как проверить, добавлен ли маршрут в таблицу маршрутизации одного маршрутизатора, а команды, обсуждаемые в главе 18, научат вас, как тестировать сквозные маршруты от отправляющего хоста к принимающему.
## Part V IPv4 Routing
Часть V Маршрутизация IPv4   
__|__
--|--
|
Part V Review|Часть V Обзор
## Chapter 15 Operating Cisco Routers
Глава 15 Эксплуатация маршрутизаторов Cisco   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.1 Explain the role and function of network components
1.1 Объясните роль и функции сетевых компонентов   
###### 1.1.a Routers
1.1.a Маршрутизаторы   
###### 1.2 Describe characteristics of network topology architectures
1.2 Описание характеристик архитектур топологии сети   
###### 1.2.e Small office/home office (SOHO)
1.2.e Малый офис / домашний офис (SOHO)   
###### 1.6 Configure and verify IPv4 addressing and subnetting
1.6 Настройка и проверка адресации IPv4 и подсетей   
__|__
--|--
|
Getting an IPv4 network up and working requires some basic steps: installing routers, installing cables, and ordering WAN services.|Для настройки и работы сети IPv4 требуется несколько основных шагов: установка маршрутизаторов, установка кабелей и заказ услуг WAN.
The installation also requires some router configuration because routers often use defaults so that the router does not route IP packets until configuration has been added.|Для установки также требуется некоторая настройка маршрутизатора, поскольку маршрутизаторы часто используют настройки по умолчанию, поэтому маршрутизатор не маршрутизирует IP-пакеты до тех пор, пока конфигурация не будет добавлена.
You will need to configure IPv4 addresses, enable interfaces, and add IP routes—either through static configuration or by enabling some dynamic routing protocol.|Вам потребуется настроить IPv4-адреса, включить интерфейсы и добавить IP-маршруты - либо посредством статической конфигурации, либо путем включения какого-либо протокола динамической маршрутизации.
This chapter focuses on the first steps to creating a small working network: how to install an enterprise-class Cisco router and configure interfaces and IP addresses.|В этой главе рассматриваются первые шаги к созданию небольшой рабочей сети: как установить маршрутизатор Cisco корпоративного класса и настроить интерфейсы и IP-адреса.
|
This chapter breaks the topics into two major headings.|В этой главе темы разбиты на два основных заголовка.
The first discusses the physical installation of an enterprise-class Cisco router.|В первом обсуждается физическая установка маршрутизатора Cisco корпоративного класса.
The second section looks at the commandline interface (CLI) on a Cisco router, which has the same look and feel as the Cisco switch CLI. This section first lists the similarities between a switch and router CLI and then introduces the configuration required to make the router start forwarding IP packets on its interfaces.|Во втором разделе рассматривается интерфейс командной строки (CLI) на маршрутизаторе Cisco, который выглядит так же, как интерфейс командной строки коммутатора Cisco. В этом разделе сначала перечислены сходства между интерфейсом командной строки коммутатора и маршрутизатора, а затем представлена ​​конфигурация, необходимая для того, чтобы маршрутизатор начал пересылку IP-пакетов на своих интерфейсах.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 15-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 15-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### Installing Cisco Routers
Установка маршрутизаторов Cisco   
__|__
--|--
|
Enabling IPv4 Support on Cisco Routers 2–6 CHAPTER 15 1.|Включение поддержки IPv4 на маршрутизаторах Cisco 2–6 ГЛАВА 15 1.
Which of the following installation steps are more likely required on a Cisco router, but not typically required on a Cisco switch? (Choose two answers.)|Какие из следующих шагов установки, скорее всего, требуются на маршрутизаторе Cisco, но обычно не требуются на коммутаторе Cisco? (Выберите два ответа.)
|
a. Connect Ethernet cables b.|а. Подключите кабели Ethernet b.
Connect serial cables c.|Подключите последовательные кабели c.
Connect to the console port d.|Подключитесь к консольному порту d.
Connect the power cable e.|Подключите шнур питания e.
Turn the on/off switch to “on”|Установите переключатель включения / выключения в положение «включено».
|
2. Which of the following commands might you see associated with a router CLI, but not with a switch CLI?|2. Какая из следующих команд может быть связана с интерфейсом командной строки маршрутизатора, но не с интерфейсом командной строки коммутатора?
|
a. The show mac address-table command b.|а. Команда show mac address-table b.
The show ip route command c.|Команда show ip route c.
The show running-config command d.|Команда show running-config d.
The show interfaces status command 3.|Команда show interfaces status 3.
Which answers list a task that could be helpful in making a router interface G0/0 ready to route packets? (Choose two answers.)|В каких ответах перечислены задачи, которые могут быть полезны для подготовки интерфейса маршрутизатора G0 / 0 к маршрутизации пакетов? (Выберите два ответа.)
|
a. Configuring the ip address address mask command in G0/0 configuration mode b.|а. Настройка команды маски IP-адреса и адреса в режиме конфигурации G0 / 0 b.
Configuring the ip address address and ip mask mask commands in G0/0 configuration mode c.|Настройка команд IP-адреса и маски IP-адреса в режиме конфигурации G0 / 0 c.
Configuring the no shutdown command in G0/0 configuration mode d.|Настройка команды no shutdown в режиме конфигурации G0 / 0 d.
Setting the interface description in G0/0 configuration mode 4.|Установка описания интерфейса в режиме конфигурации G0 / 0 4.
The output of the show ip interface brief command on R1 lists interface status codes of “down” and “down” for interface GigabitEthernet 0/0.|В выходных данных команды show ip interfacerief на маршрутизаторе R1 перечислены коды состояния интерфейса «не работает» и «не работает» для интерфейса GigabitEthernet 0/0.
The interface connects to a LAN switch with a UTP straight-through cable.|Интерфейс подключается к коммутатору LAN с помощью прямого кабеля UTP.
Which of the following could be true?|Что из следующего может быть правдой?
|
a. The shutdown command is currently configured for router interface G0/0.|а. Команда выключения в настоящее время настроена для интерфейса маршрутизатора G0 / 0.
|
b. The shutdown command is currently configured for the switch interface on the other end of the cable.|б. Команда выключения в настоящее время настроена для интерфейса коммутатора на другом конце кабеля.
|
c. The router was never configured with an ip address command on the interface.|c. Маршрутизатор никогда не был настроен с помощью команды ip-адреса на интерфейсе.
|
d. The router was configured with the no ip address command.|d. Маршрутизатор был настроен с помощью команды no ip address.
|
5. Which of the following commands do not list the IP address and mask of at least one interface? (Choose two answers.)|5. Какая из следующих команд не отображает IP-адрес и маску хотя бы одного интерфейса? (Выберите два ответа.)
|
a. show running-config b. show protocols type number c. show ip interface brief d. show interfaces e. show version 6.|а. показать текущую конфигурацию b. показать номер типа протокола c. показать краткое описание интерфейса ip d. показать интерфейсы e. показать версию 6.
Which of the following is different on the Cisco switch CLI for a Layer 2 switch as compared with the Cisco router CLI?|Что из следующего отличается в интерфейсе командной строки коммутатора Cisco для коммутатора уровня 2 от интерфейса командной строки маршрутизатора Cisco?
|
a. The commands used to configure simple password checking for the console b.|а. Команды, используемые для настройки простой проверки пароля для консоли b.
The number of IP addresses configured c.|Количество настроенных IP-адресов c.
The configuration of the device’s hostname d.|Конфигурация имени хоста устройства d.
The configuration of an interface description Foundation Topics Installing Cisco Routers Routers collectively provide the main feature of the network layer—the capability to forward packets end to end through a network.|Конфигурация описания интерфейса Основные темы Установка маршрутизаторов Cisco Маршрутизаторы в совокупности обеспечивают основную функцию сетевого уровня - возможность пересылать пакеты из конца в конец по сети.
As introduced in Chapter 3, “Fundamentals of WANs and IP Routing,” routers forward packets by connecting to various physical network links, like Ethernet LAN, Ethernet WAN, and serial WAN links, then using Layer 3 routing logic to choose where to forward each packet.|Как было сказано в главе 3 «Основы глобальных сетей и IP-маршрутизации», маршрутизаторы пересылают пакеты, подключаясь к различным физическим сетевым каналам, таким как Ethernet LAN, Ethernet WAN и последовательные каналы WAN, а затем с помощью логики маршрутизации уровня 3 выбирают, куда пересылать каждый пакет.
As a reminder, Chapter 2, “Fundamentals of Ethernet LANs,” covered the details of making those physical connections to Ethernet networks, while Chapter 3 covered the basics of cabling with WAN links.|Напомним, в главе 2 «Основы локальных сетей Ethernet» были подробно описаны эти физические подключения к сетям Ethernet, а в главе 3 были рассмотрены основы прокладки кабелей с помощью каналов глобальной сети.
|
This section examines some of the details of router installation and cabling, first from the enterprise perspective and then from the perspective of connecting a typical small office/|В этом разделе рассматриваются некоторые детали установки маршрутизатора и кабельной разводки, сначала с точки зрения предприятия, а затем с точки зрения подключения типичного небольшого офиса /
|
home office (SOHO) to an ISP using high-speed Internet.|домашний офис (SOHO) к провайдеру с помощью высокоскоростного Интернета.
#### Installing Enterprise Routers
Установка корпоративных маршрутизаторов   
__|__
--|--
|
A typical enterprise network has a few centralized sites as well as lots of smaller remote sites.|В типичной корпоративной сети есть несколько централизованных сайтов, а также множество более мелких удаленных сайтов.
|
To support devices at each site (the computers, IP phones, printers, and other devices), the network includes at least one LAN switch at each site.|Для поддержки устройств на каждом сайте (компьютеры, IP-телефоны, принтеры и другие устройства) в сети есть как минимум один коммутатор LAN на каждом сайте.
In addition, each site has a router, which connects to the LAN switch and to some WAN link.|Кроме того, у каждого сайта есть маршрутизатор, который подключается к коммутатору LAN и некоторому каналу WAN.
The WAN link provides connectivity from each remote site, back to the central site, and to other sites through the connection to the central site.|Канал WAN обеспечивает возможность подключения с каждого удаленного сайта обратно к центральному сайту и к другим сайтам через соединение с центральным сайтом.
|
Figures 15-1 and 15-2 show a couple of different kinds of network diagrams that might be used to represent an enterprise network.|На рисунках 15-1 и 15-2 показаны несколько различных видов сетевых диаграмм, которые можно использовать для представления корпоративной сети.
The style of Figure 15-1 supports discussions about Layer 3 topics, showing the subnet IDs, masks, and interface IP addresses in shorthand.|Стиль, показанный на рис. 15-1, поддерживает обсуждения тем уровня 3, показывая в сокращенном виде идентификаторы подсети, маски и IP-адреса интерфейсов.
The figure also keeps the physical and data-link details to a minimum with these conventions:|На рисунке также сведены к минимуму физические данные и сведения о канале передачи данных с помощью следующих соглашений:
|
Ethernet LAN: Simple straight lines with one or more LAN switches implied but not shown.|Ethernet LAN: простые прямые линии с одним или несколькими переключателями LAN подразумеваются, но не показаны.
|
Ethernet WAN: Shown as a straight line, often with a cloud over it, with some kind of Ethernet interface identifier shown by the router (in this case, G0/1/0 and G0/0/0, which refers to GigabitEthernet interfaces).|Ethernet WAN: отображается как прямая линия, часто с облаком над ней, с каким-либо идентификатором интерфейса Ethernet, отображаемым маршрутизатором (в данном случае G0 / 1/0 и G0 / 0/0, что относится к интерфейсам GigabitEthernet) .
|
Serial WAN: A line with a crooked part in the middle (a “lightning bolt”) represents a typical point-to-point serial link as introduced in Chapter 3.|Последовательный WAN: линия с изогнутой частью посередине («молния») представляет собой типичный последовательный канал связи точка-точка, как это было описано в главе 3.
|
Figure 15-1 Generic Enterprise Network Diagram In comparison, Figure 15-2 shows more detail about the physical cabling with less detail about the IP subnets and addresses.|Рис. 15-1. Типовая диаграмма корпоративной сети. Для сравнения, на рис. 15-2 показаны более подробные сведения о физических кабелях и менее подробные сведения об IP-подсетях и адресах.
First, if the diagram needs to show physical details in the LAN, the diagram could show the LAN switches and related devices to the outside of the figure.|Во-первых, если на схеме необходимо показать физические детали в локальной сети, на диаграмме могут быть показаны коммутаторы локальной сети и связанные с ними устройства за пределами рисунка.
The router Ethernet interfaces have an RJ-45 connector; just connect the appropriate UTP cable to both the router and the nearby LAN switch.|Интерфейсы Ethernet маршрутизатора имеют разъем RJ-45; просто подключите соответствующий кабель UTP к маршрутизатору и ближайшему коммутатору LAN.
|
Figure 15-2 More Detailed Cabling Diagram for the Same Enterprise Network Next, consider the hardware on the ends of the serial link, in particular where the channel service unit/data service unit (CSU/DSU) hardware resides on each end of the serial link.|Рис. 15-2. Более подробная схема кабельной разводки для той же корпоративной сети. Затем рассмотрим оборудование на концах последовательного канала, в частности, там, где оборудование блока обслуживания канала / блока обслуживания данных (CSU / DSU) находится на каждом конце последовательного канала. ссылка на сайт.
In a real serial link that runs through a service provider, the link terminates at a CSU/DSU. The CSU/DSU can either sit outside the router as a separate device (as shown on the left at router R1) or integrated into the router’s serial interface hardware (as shown on the right).|В реальном последовательном канале, который проходит через поставщика услуг, канал заканчивается в CSU / DSU. CSU / DSU может располагаться вне маршрутизатора как отдельное устройство (как показано слева на маршрутизаторе R1) или быть интегрированным в оборудование последовательного интерфейса маршрутизатора (как показано справа).
|
As for cabling, the service provider will run the cable into the enterprise’s wiring closet and often put an RJ-48 connector (same size as an RJ-45 connector) on the end of the cable.|Что касается кабельной разводки, поставщик услуг проложит кабель в коммутационный шкаф предприятия и часто вставляет разъем RJ-48 (такого же размера, как и разъем RJ-45) на конец кабеля.
|
That cable should connect to the CSU/DSU. With an internal CSU/DSU (as with router R1 in Figure 15-2), the router serial port has an RJ-48 port to which the serial cable should connect.|Этот кабель должен подключаться к CSU / DSU. С внутренним CSU / DSU (как в маршрутизаторе R1 на рис. 15-2) последовательный порт маршрутизатора имеет порт RJ-48, к которому должен подключаться последовательный кабель.
With an external CSU/DSU, the CSU/DSU must be connected to the router’s serial card via a short serial cable.|С внешним CSU / DSU, CSU / DSU должен быть подключен к последовательной карте маршрутизатора с помощью короткого последовательного кабеля.
##### Cisco Integrated Services Routers
Маршрутизаторы с интегрированными сервисами Cisco   
__|__
--|--
|
Product vendors, including Cisco, typically provide several different types of router hardware.|Поставщики продуктов, включая Cisco, обычно предоставляют несколько различных типов оборудования маршрутизатора.
|
Today, routers often do much more work than simply routing packets; in fact, they serve as a device or platform from which to provide many network services.|Сегодня маршрутизаторы часто выполняют гораздо больше работы, чем просто маршрутизация пакетов; фактически, они служат устройством или платформой для предоставления многих сетевых услуг.
Cisco even brands its enterprise routers not just as routers, but as “integrated services routers,” emphasizing the multipurpose nature of the products.|Cisco даже называет свои корпоративные маршрутизаторы не просто маршрутизаторами, а «маршрутизаторами с интегрированными услугами», подчеркивая универсальность продуктов.
|
As an example, consider the networking functions needed at a typical branch office.|В качестве примера рассмотрим сетевые функции, необходимые в типичном филиале.
A typical enterprise branch office needs a router for WAN/LAN connectivity, and a LAN switch to provide a high-performance local network and connectivity into the router and WAN. Many branches also need voice-over-IP (VoIP) services to support IP phones, and several security services as well.|Типичному филиалу предприятия необходим маршрутизатор для подключения к WAN / LAN и коммутатор LAN для обеспечения высокопроизводительной локальной сети и подключения к маршрутизатору и WAN. Многие филиалы также нуждаются в услугах передачи голоса по IP (VoIP) для поддержки IP-телефонов, а также в некоторых службах безопасности.
Plus, it is hard to imagine a site with users that does not have Wi-Fi access today.|К тому же сложно представить себе сайт с пользователями, у которых сегодня нет доступа к Wi-Fi.
|
So, rather than require multiple separate devices at one site, as shown in Figure 15-2, Cisco offers single devices that act as both router and switch and provide other functions as well.|Таким образом, вместо того, чтобы требовать нескольких отдельных устройств на одном сайте, как показано на рис. 15-2, Cisco предлагает отдельные устройства, которые действуют как маршрутизатор и коммутатор, а также предоставляют другие функции.
|
For the sake of learning and understanding the different functions, this book focuses on using a separate switch and separate router, which provides a much cleaner path for learning the basics.|Для изучения и понимания различных функций в этой книге основное внимание уделяется использованию отдельного коммутатора и отдельного маршрутизатора, что обеспечивает более простой путь для изучения основ.
|
Figure 15-3 shows a photo of the Cisco 4321 ISR, with some of the more important features highlighted.|На Рис. 15-3 показана фотография Cisco 4321 ISR с выделенными некоторыми из наиболее важных функций.
The top part of the figure shows a full view of the back of the router.|В верхней части рисунка показан полный вид задней части маршрутизатора.
This model comes with two built-in Gigabit Ethernet interfaces and two modular slots that allow you to add small cards called Network Interface Modules (NIMs).|Эта модель поставляется с двумя встроенными интерфейсами Gigabit Ethernet и двумя модульными слотами, которые позволяют добавлять небольшие карты, называемые модулями сетевого интерфейса (NIM).
The bottom of the figure shows one example NIM (a NIM that provides two serial interfaces).|Внизу рисунка показан один пример NIM (NIM, которая предоставляет два последовательных интерфейса).
The router has other items as well, including both an RJ-45 and USB console port.|В роутере есть и другие элементы, в том числе консольный порт RJ-45 и USB.
|
Figure 15-3 Photos of a Model 4321 Cisco Integrated Services Router (ISR)|Рисунок 15-3 Фотографии маршрутизатора Cisco с интегрированными сервисами (ISR) модели 4321
|
Answers to the “Do I Know This Already?” quiz:|Ответы на вопрос «Знаю ли я это уже?» викторина:
|
1 B, E 2 B 3 A, C 4 C 5 C, E 6 B The figure shows an important feature for using routers to connect to both Ethernet LANs and Ethernet WAN services.|1 B, E 2 B 3 A, C 4 C 5 C, E 6 B На рисунке показана важная функция использования маршрутизаторов для подключения как к локальным сетям Ethernet, так и к службам Ethernet WAN.
Look closely at Figure 15-3’s Gigabit interfaces.|Внимательно посмотрите на гигабитные интерфейсы на Рисунке 15-3.
Gi0/1 refers to interface GigabitEthernet0/1 and is an RJ-45 port that supports UTP cabling only.|Gi0 / 1 относится к интерфейсу GigabitEthernet0 / 1 и является портом RJ-45, который поддерживает только кабели UTP.
However, interface Gi0/0 (short for GigabitEthernet0/0) has some interesting features:|Однако интерфейс Gi0 / 0 (сокращение от GigabitEthernet0 / 0) имеет некоторые интересные особенности:
###### The router has two ports for one interface (Gi0/0).
Маршрутизатор имеет два порта для одного интерфейса (Gi0 / 0).   
###### You can use one or the other at any point in time, but not both.
Вы можете использовать одно или другое в любой момент, но не то и другое одновременно.   
###### One physical port is an RJ-45 port that supports copper cabling (implying that it is used
Один физический порт - это порт RJ-45, который поддерживает медные кабели (подразумевая, что он используется   
__|__
--|--
|
to connect to a LAN).|для подключения к локальной сети).
###### The other Gi0/0 physical port is a Small Form Pluggable (SFP) port that would support various
Другой физический порт Gi0 / 0 - это порт Small Form Pluggable (SFP), который поддерживает различные   
__|__
--|--
|
fiber Ethernet standards, allowing the port to be used for Ethernet WAN purposes.|стандарты оптоволоконного Ethernet, позволяющие использовать порт для сетей Ethernet WAN.
|
Cisco commonly makes one or more of the Ethernet ports on its Enterprise class routers support SFPs so that the engineer can choose an SFP that supports the type of Ethernet cabling provided by the Ethernet WAN service provider.|Cisco обычно делает один или несколько портов Ethernet на своих маршрутизаторах корпоративного класса для поддержки SFP, чтобы инженер мог выбрать SFP, который поддерживает тип кабеля Ethernet, предоставляемый поставщиком услуг Ethernet WAN.
|
NOTE When building a lab network to study for CCNA or CCNP, because your devices will be in the same place, you can create Ethernet WAN links by using the RJ-45 ports and a UTP cable without the need to purchase an SFP for each router.|ПРИМЕЧАНИЕ При создании лабораторной сети для изучения CCNA или CCNP, поскольку ваши устройства будут в одном месте, вы можете создать каналы Ethernet WAN, используя порты RJ-45 и кабель UTP, без необходимости покупать SFP для каждого маршрутизатора. .
##### Physical Installation
Физическая установка   
__|__
--|--
|
Armed with the cabling details in images like Figure 15-2 and the router hardware details in photos like Figure 15-3, you can physically install a router.|Вооружившись деталями кабельной разводки на изображениях, таких как Рисунок 15-2, и деталями оборудования маршрутизатора на фотографиях, таких как Рисунок 15-3, вы можете физически установить маршрутизатор.
To install a router, follow these steps:|Чтобы установить роутер, выполните следующие действия:
|
Step 1.|Шаг 1.
For any Ethernet LAN interface, connect the RJ-45 connector of an appropriate copper Ethernet cable between the RJ-45 Ethernet port on the router and one of the LAN switch ports.|Для любого интерфейса Ethernet LAN подключите разъем RJ-45 соответствующего медного кабеля Ethernet между портом RJ-45 Ethernet на маршрутизаторе и одним из портов коммутатора LAN.
|
Step 2.|Шаг 2.
For any serial WAN ports:|Для любых последовательных портов WAN:
|
A. If using an external CSU/DSU, connect the router’s serial interface to the CSU/DSU and the CSU/DSU to the line from the telco.|A. При использовании внешнего CSU / DSU подключите последовательный интерфейс маршрутизатора к CSU / DSU, а CSU / DSU к линии от телефонной компании.
|
B. If using an internal CSU/DSU, connect the router’s serial interface to the line from the telco.|B. При использовании внутреннего CSU / DSU подключите последовательный интерфейс маршрутизатора к линии от телефонной компании.
|
Step 3.|Шаг 3.
For any Ethernet WAN ports:|Для любых портов Ethernet WAN:
|
A. When ordering the Ethernet WAN service, confirm the required Ethernet standard and SFP type required to connect to the link, and order the SFPs.|A. При заказе услуги Ethernet WAN подтвердите требуемый стандарт Ethernet и тип SFP, необходимые для подключения к каналу, и закажите модули SFP.
|
B. Install the SFPs into the routers, and connect the Ethernet cable for the Ethernet WAN link to the SFP on each end of the link.|B. Установите модули SFP в маршрутизаторы и подключите кабель Ethernet для соединения Ethernet WAN к SFP на каждом конце канала.
|
Step 4.|Шаг 4.
Connect the router’s console port to a PC (as discussed in Chapter 4, “Using the Command-Line Interface”), as needed, to configure the router.|Подключите консольный порт маршрутизатора к ПК (как описано в главе 4 «Использование интерфейса командной строки»), если необходимо, для настройки маршрутизатора.
|
Step 5.|Шаг 5.
Connect a power cable from a power outlet to the power port on the router.|Подключите кабель питания от розетки к разъему питания на маршрутизаторе.
|
Step 6.|Шаг 6.
Power on the router.|Включите роутер.
|
Note that Cisco enterprise routers typically have an on/off switch, while switches do not.|Обратите внимание, что корпоративные маршрутизаторы Cisco обычно имеют переключатель включения / выключения, а коммутаторы - нет.
#### Installing SOHO Routers
Установка маршрутизаторов SOHO   
__|__
--|--
|
The terms enterprise router and small office/home office (SOHO) router act as a pair of contrasting categories for routers, both in terms of how vendors like Cisco provide to the market, and how enterprises use and configure those devices.|Термины корпоративный маршрутизатор и маршрутизатор для малого офиса / домашнего офиса (SOHO) действуют как пара противоположных категорий для маршрутизаторов, как с точки зрения того, как поставщики, такие как Cisco, предоставляют рынку, так и с точки зрения того, как предприятия используют и настраивают эти устройства.
The term enterprise router typically refers to a router that a company would use in a permanent business location, while a SOHO router would reside at an employee’s home or at a small permanent site with just a few people.|Термин корпоративный маршрутизатор обычно относится к маршрутизатору, который компания будет использовать в постоянном офисе, в то время как маршрутизатор SOHO будет находиться в доме сотрудника или на небольшом постоянном объекте с несколькими людьми.
However, as you might guess, the line between a router acting as an enterprise router and a SOHO router is blurry, so use these terms as general categories.|Однако, как вы могли догадаться, грань между маршрутизатором, выступающим в качестве корпоративного маршрутизатора, и маршрутизатором SOHO размыта, поэтому используйте эти термины как общие категории.
|
Even with that general comparison, SOHO routers typically have two features that an enterprise router would be less likely to have:|Даже при таком общем сравнении маршрутизаторы SOHO обычно имеют две функции, которые вряд ли будут иметь корпоративный маршрутизатор:
###### SOHO routers almost always use the Internet and virtual private network (VPN) technology
Маршрутизаторы SOHO почти всегда используют Интернет и технологию виртуальной частной сети (VPN).   
__|__
--|--
|
for their WAN connections to send data back and forth to the rest of the Enterprise.|для их WAN-соединений, чтобы отправлять данные туда и обратно остальной части предприятия.
###### SOHO routers almost always use a multifunction device that does routing, LAN switching,
Маршрутизаторы SOHO почти всегда используют многофункциональное устройство, которое выполняет маршрутизацию, коммутацию LAN,   
__|__
--|--
|
VPN, wireless, and maybe other features.|VPN, беспроводная связь и, возможно, другие функции.
|
For instance, at an enterprise business location, the building may contain enterprise routers, separate Ethernet switches, and separate wireless access points (AP), all connected together.|Например, на территории предприятия, здание может содержать корпоративные маршрутизаторы, отдельные коммутаторы Ethernet и отдельные точки беспроводного доступа (AP), все соединенные вместе.
|
At a permanent business site with four employees and 10 total devices in the network, one SOHO router could provide all those same features in one device.|На постоянной производственной площадке с четырьмя сотрудниками и 10 устройствами в сети один маршрутизатор SOHO может обеспечить все те же функции на одном устройстве.
|
For instance, Figure 15-4 shows a typical SOHO site.|Например, на рис. 15-4 показан типичный объект SOHO.
The three icons that represent a router, switch, and access point actually all exist inside one box; the figure just shows them separately to emphasize the fact that the one SOHO router provides several functions.|Три значка, которые представляют маршрутизатор, коммутатор и точку доступа, фактически находятся внутри одного блока; на рисунке они показаны отдельно, чтобы подчеркнуть тот факт, что один маршрутизатор SOHO обеспечивает несколько функций.
On the left, the SOHO router provides wired and wireless LAN servers, and on the right, it provides WAN access through a cable Internet connection.|Слева маршрутизатор SOHO предоставляет серверы проводной и беспроводной локальной сети, а справа - доступ к глобальной сети через кабельное подключение к Интернету.
|
Figure 15-4 Devices in a SOHO Network with High-Speed CATV Internet Figure 15-4 does not reflect the physical reality of a SOHO router, so Figure 15-5 shows one cabling example.|Рис. 15-4. Устройства в сети SOHO с высокоскоростным кабельным Интернетом. Рисунок 15-4 не отражает физическую реальность маршрутизатора SOHO, поэтому на рис. 15-5 показан один пример кабельной разводки.
The figure shows user devices on the left, connecting to the router via wireless or via Ethernet UTP cabling.|На рисунке слева показаны пользовательские устройства, подключающиеся к маршрутизатору по беспроводной сети или через кабель Ethernet UTP.
On the right in this case, the router uses an external cable modem to connect to the coaxial cable provided by the ISP. Then the router must use a normal UTP Ethernet port to connect a short Ethernet cable between the SOHO router and the cable modem.|В данном случае справа маршрутизатор использует внешний кабельный модем для подключения к коаксиальному кабелю, предоставленному поставщиком Интернет-услуг. Затем маршрутизатор должен использовать обычный порт Ethernet UTP для подключения короткого кабеля Ethernet между маршрутизатором SOHO и кабельным модемом.
|
Figure 15-5 SOHO Network, Using Cable Internet and an Integrated Device|Рисунок 15-5 Сеть SOHO, использование кабельного Интернета и интегрированного устройства
### Enabling IPv4 Support on Cisco Router Interfaces
Включение поддержки IPv4 на интерфейсах маршрутизатора Cisco   
__|__
--|--
|
Routers support a relatively large number of features, with a large number of configuration and EXEC commands to support those features.|Маршрутизаторы поддерживают относительно большое количество функций, с большим количеством конфигураций и команд EXEC для поддержки этих функций.
You will learn about many of these features throughout the rest of this book.|Вы узнаете о многих из этих функций в оставшейся части этой книги.
|
NOTE For perspective, the Cisco router documentation includes a command reference, with an index to every single router command.|ПРИМЕЧАНИЕ. Для удобства в документации маршрутизатора Cisco есть справочник команд с указателем каждой отдельной команды маршрутизатора.
A quick informal count of a recent IOS version listed around 5000 CLI commands.|Быстрый неофициальный подсчет последней версии IOS перечислил около 5000 команд CLI.
|
This second section of the chapter focuses on commands related to router interfaces.|Этот второй раздел главы посвящен командам, связанным с интерфейсами маршрутизатора.
To make routers work—that is, to route IPv4 packets—the interfaces must be configured.|Чтобы маршрутизаторы работали, то есть для маршрутизации пакетов IPv4, интерфейсы должны быть настроены.
This section introduces the most common commands that configure interfaces, make them work, and give the interfaces IP addresses and masks.|В этом разделе представлены наиболее распространенные команды, которые настраивают интерфейсы, заставляют их работать и присваивают интерфейсам IP-адреса и маски.
#### Accessing the Router CLI
Доступ к интерфейсу командной строки маршрутизатора   
__|__
--|--
|
Accessing a router’s command-line interface (CLI) works much like a switch.|Доступ к интерфейсу командной строки маршрутизатора (CLI) работает во многом как коммутатор.
In fact, it works so much like accessing a Cisco switch CLI that this book relies on Chapter 4 instead of repeating the same details here.|Фактически, он работает так же, как доступ к интерфейсу командной строки коммутатора Cisco, что эта книга опирается на главу 4 вместо того, чтобы повторять здесь те же детали.
If the details from Chapter 4 are not fresh in your memory, it might be worthwhile to spend a few minutes briefly reviewing that chapter as well as Chapter 7, “Configuring and Verifying Switch Interfaces,” before reading further.|Если подробности из главы 4 не свежи в вашей памяти, возможно, стоит потратить несколько минут на краткий обзор этой главы, а также главы 7 «Настройка и проверка интерфейсов коммутатора», прежде чем читать дальше.
|
Cisco switches and routers share many of the same CLI navigation features and many of the same configuration commands for management features.|Коммутаторы и маршрутизаторы Cisco используют одни и те же функции навигации CLI и многие из одних и тех же команд конфигурации для функций управления.
The following list mentions the highlights:|В следующем списке перечислены основные моменты:
###### User and Enable (privileged) mode
Пользовательский и активный (привилегированный) режим   
###### Entering and exiting configuration mode, using the configure terminal, end, and exit
Вход и выход из режима конфигурации с помощью терминала настройки, завершение и выход   
__|__
--|--
|
commands and the Ctrl+Z key sequence|команды и последовательность клавиш Ctrl + Z
###### Configuration of console, Telnet (vty), and enable secret passwords
Настройка консоли, Telnet (vty) и включение секретных паролей   
###### Configuration of Secure Shell (SSH) encryption keys and username/password login
Настройка ключей шифрования Secure Shell (SSH) и логина / пароля для входа   
__|__
--|--
|
credentials|полномочия
###### Configuration of the hostname and interface description
Конфигурация имени хоста и описания интерфейса   
###### Configuration of Ethernet interfaces that can negotiate speed using the speed and duplex
Конфигурация интерфейсов Ethernet, которые могут согласовывать скорость с использованием скорости и дуплекса   
__|__
--|--
|
commands|команды
###### Configuration of an interface to be administratively disabled (shutdown) and administratively
Конфигурация интерфейса для административного отключения (выключение) и административного отключения   
__|__
--|--
|
enabled (no shutdown)|включен (без выключения)
###### Navigation through different configuration mode contexts using commands like line
Навигация по различным контекстам режима конфигурации с помощью таких команд, как строка   
__|__
--|--
|
console 0 and interface type number|консоль 0 и номер типа интерфейса
###### CLI help, command editing, and command recall features
Функции справки CLI, редактирования команд и отзыва команд   
###### The meaning and use of the startup-config (in NVRAM), running-config (in RAM), and
Значение и использование конфигурации запуска (в NVRAM), текущей конфигурации (в ОЗУ) и   
__|__
--|--
|
external servers (like TFTP), along with how to use the copy command to copy the configuration files and IOS images At first glance, this list seems to cover most everything you have read so far in this book about the switch CLI. However, a couple of topics do work differently with the router CLI as compared to the switch CLI, as follows:|внешние серверы (например, TFTP), а также то, как использовать команду copy для копирования файлов конфигурации и образов IOS. На первый взгляд, этот список, кажется, охватывает почти все, что вы прочитали в этой книге о CLI коммутатора. Однако несколько тем работают с интерфейсом командной строки маршрутизатора иначе, чем с интерфейсом командной строки коммутатора, а именно:
###### The configuration of IP addresses differs in some ways, with switches using a VLAN
Конфигурация IP-адресов в некоторой степени отличается от коммутаторов, использующих VLAN.   
__|__
--|--
|
interface and routers using an IP address configured on each working interface.|интерфейс и маршрутизаторы, использующие IP-адрес, настроенный для каждого рабочего интерфейса.
###### Many Cisco router models have an auxiliary (Aux) port, intended to be connected to an
Многие модели маршрутизаторов Cisco имеют вспомогательный (Aux) порт, предназначенный для подключения к   
__|__
--|--
|
external modem and phone line to allow remote users to dial in to the router, and access the CLI, by making a phone call.|внешний модем и телефонная линия, чтобы удаленные пользователи могли подключиться к маршрутизатору и получить доступ к интерфейсу командной строки, сделав телефонный звонок.
Cisco switches do not have auxiliary ports.|Коммутаторы Cisco не имеют дополнительных портов.
###### Router IOS defaults to disallow both Telnet and SSH into the router because of the typical
IOS маршрутизатора по умолчанию запрещает подключение Telnet и SSH к маршрутизатору из-за типичного   
__|__
--|--
|
router default setting of transport input none in vty configuration mode. (Cisco Catalyst LAN switches typically default to allow both Telnet and SSH.) Chapter 6, “Configuring Basic Switch Management,” already discussed the various options on this command to enable Telnet (transport input telnet), SSH (transport input ssh), or both (transport input all or transport input telnet ssh).|настройка маршрутизатора по умолчанию для транспортного входа отсутствует в режиме конфигурации VTY. (Коммутаторы Cisco Catalyst LAN обычно по умолчанию разрешают использование Telnet и SSH.) В главе 6 «Настройка базового управления коммутатором» уже обсуждались различные параметры этой команды для включения Telnet (входной транспортный telnet), SSH (транспортный вход ssh) или оба (транспортный ввод всех или транспортный ввод telnet ssh).
|
The router CLI also differs from a switch CLI just because switches and routers do different things.|Интерфейс командной строки маршрутизатора также отличается от интерфейса командной строки коммутатора только потому, что коммутаторы и маршрутизаторы выполняют разные функции.
For example:|Например:
###### Cisco Layer 2 switches support the show mac address-table command, while Cisco routers
Коммутаторы Cisco уровня 2 поддерживают команду show mac address-table, а маршрутизаторы Cisco   
__|__
--|--
|
do not.|не делайте.
###### Cisco routers support the show ip route command, while Cisco Layer 2 switches do not.
Маршрутизаторы Cisco поддерживают команду show ip route, а коммутаторы Cisco уровня 2 - нет.   
###### Cisco Layer 2 switches use the show interfaces status command to list one line of output
Коммутаторы Cisco уровня 2 используют команду show interfaces status для вывода одной строки вывода.   
__|__
--|--
|
per interface (and routers do not), while routers use the show ip interface brief command to list similar information (but switches do not).|на интерфейс (а маршрутизаторы этого не делают), в то время как маршрутизаторы используют команду show ip interface short для вывода аналогичной информации (но коммутаторы этого не делают).
|
Note also that some Cisco devices perform both Layer 2 switching and Layer 3 routing, and those devices support both router and switch commands.|Также обратите внимание, что некоторые устройства Cisco выполняют как коммутацию уровня 2, так и маршрутизацию уровня 3, и эти устройства поддерживают команды как маршрутизатора, так и коммутатора.
Chapter 17, “IP Routing in the LAN,” discusses one such device, a Layer 3 switch, in more detail.|В главе 17 «IP-маршрутизация в локальной сети» более подробно рассматривается одно такое устройство, коммутатор уровня 3.
#### Router Interfaces
Интерфейсы маршрутизатора   
__|__
--|--
|
One minor difference between Cisco switches and routers is that routers support a much wider variety of interfaces.|Одно незначительное различие между коммутаторами и маршрутизаторами Cisco заключается в том, что маршрутизаторы поддерживают гораздо более широкий спектр интерфейсов.
Today, LAN switches support Ethernet LAN interfaces of various speeds.|Сегодня коммутаторы LAN поддерживают интерфейсы Ethernet LAN различной скорости.
Routers support a variety of other types of interfaces, including serial interfaces, cable TV, DSL, 3G/4G wireless, and others not mentioned in this book.|Маршрутизаторы поддерживают множество других типов интерфейсов, включая последовательные интерфейсы, кабельное телевидение, DSL, беспроводную связь 3G / 4G и другие, не упомянутые в этой книге.
|
Most Cisco routers have at least one Ethernet interface of some type.|Большинство маршрутизаторов Cisco имеют по крайней мере один интерфейс Ethernet того или иного типа.
Many of those Ethernet interfaces support multiple speeds and use autonegotiation, so for consistency, the router IOS refers to these interfaces based on the fastest speed.|Многие из этих интерфейсов Ethernet поддерживают несколько скоростей и используют автосогласование, поэтому для единообразия IOS маршрутизатора обращается к этим интерфейсам на основе максимальной скорости.
For example, a 10-Mbpsonly Ethernet interface would be configured with the interface ethernet number configuration command, a 10/100 interface with the interface fastethernet number command, and a 10/100/1000 interface with the interface gigabitethernet number command.|Например, интерфейс Ethernet 10 Мбит / с может быть настроен с помощью команды настройки номера интерфейса Ethernet, интерфейс 10/100 - с помощью команды номера интерфейса fastethernet, а интерфейс 10/100/1000 - с помощью команды номера интерфейса gigabitethernet.
However, when discussing these interfaces all together, engineers would simply call them ethernet interfaces, regardless of the maximum speed.|Однако, обсуждая все эти интерфейсы вместе, инженеры просто называли бы их интерфейсами Ethernet, независимо от максимальной скорости.
|
Some Cisco routers have serial interfaces.|Некоторые маршрутизаторы Cisco имеют последовательные интерфейсы.
As you might recall from Chapter 3, Cisco routers use serial interfaces to connect to a serial link.|Как вы могли вспомнить из главы 3, маршрутизаторы Cisco используют последовательные интерфейсы для подключения к последовательному каналу.
Each point-to-point serial link can then use High-Level Data Link Control (HDLC, the default) or Point-to-Point Protocol (PPP).|Каждый последовательный канал связи точка-точка может затем использовать высокоуровневое управление каналом передачи данных (HDLC, по умолчанию) или протокол точка-точка (PPP).
|
Routers refer to interfaces in many commands, first by the type of interface (Ethernet, Fast Ethernet, Gigabit Ethernet, Serial, and so on) and then with a unique number of that router.|Маршрутизаторы ссылаются на интерфейсы во многих командах, сначала по типу интерфейса (Ethernet, Fast Ethernet, Gigabit Ethernet, Serial и т. Д.), А затем по уникальному номеру этого маршрутизатора.
|
Depending on the router model, the interface numbers might be a single number, two numbers separated by a slash, or three numbers separated by slashes.|В зависимости от модели маршрутизатора номера интерфейсов могут быть одним числом, двумя числами, разделенными косой чертой, или тремя числами, разделенными косой чертой.
For example, all three of the following configuration commands are correct on at least one model of Cisco router:|Например, все три из следующих команд конфигурации верны как минимум на одной модели маршрутизатора Cisco:
|
interface ethernet 0 interface fastethernet 0/1 interface gigabitethernet 0/0 interface gigabitethernet 0/1/0 interface serial 1/0/1 Two of the most common commands to display the interfaces, and their status, are the show ip interface brief and show interfaces commands.|interface ethernet 0 interface fastethernet 0/1 interface gigabitethernet 0/0 interface gigabitethernet 0/1/0 interface serial 1/0/1 Двумя наиболее распространенными командами для отображения интерфейсов и их статуса являются: show ip interface short и show интерфейсы команд.
The first of these commands displays a list with one line per interface, with some basic information, including the interface IP address and interface status.|Первая из этих команд отображает список с одной строкой на интерфейс с некоторой базовой информацией, включая IP-адрес интерфейса и статус интерфейса.
The second command lists the interfaces, but with a large amount of information per interface.|Вторая команда перечисляет интерфейсы, но с большим объемом информации для каждого интерфейса.
Example 15-1 shows a sample of each command.|В примере 15-1 показан образец каждой команды.
The output comes from a 2900-series ISR router, used in many examples in this book; note that it has both a Gi0/0 interface and a Gi0/1/0 interface, showing a case with both two-digit and three-digit interface identifiers.|Выходные данные поступают от маршрутизатора ISR серии 2900, который используется во многих примерах в этой книге; обратите внимание, что он имеет как интерфейс Gi0 / 0, так и интерфейс Gi0 / 1/0, показывая случай как с двухзначными, так и с трехзначными идентификаторами интерфейса.
|
Example 15-1 Listing the Interfaces in a Router Example end.|Пример 15-1. Список интерфейсов в маршрутизаторе. Конец примера.
|
NOTE Commands that refer to router interfaces can be significantly shortened by truncating the words.|ПРИМЕЧАНИЕ. Команды, относящиеся к интерфейсам маршрутизатора, могут быть значительно сокращены путем усечения слов.
For example, sh int gi0/0 or sh int g0/0 can be used instead of show interfaces gigabitethernet 0/0.|Например, sh int gi0 / 0 или sh int g0 / 0 можно использовать вместо show interfaces gigabitethernet 0/0.
In fact, many network engineers, when looking over someone’s shoulder, would say something like “just do a show int G-i-oh-oh command” in this case, rather than speaking the long version of the command.|Фактически, многие сетевые инженеры, глядя через чье-то плечо, в этом случае сказали бы что-то вроде «просто выполните команду show int G-i-oh-oh», вместо того, чтобы произносить длинную версию команды.
|
Also, note that the show interfaces command lists a text interface description on about the third line, if configured.|Также обратите внимание, что команда show interfaces отображает описание текстового интерфейса примерно в третьей строке, если она настроена.
In this case, interface G0/1/0 had been previously configured with the description Link in lab to R3’s G0/0/0 command in interface configuration mode for interface G0/1/0.|В этом случае интерфейс G0 / 1/0 был ранее настроен с описанием Link in lab to R3's G0 / 0/0 command in the interface configuration mode for interface G0 / 1/0.
The description interface subcommand provides an easy way to keep small notes about what router interfaces connect to which neighboring devices, with the show interfaces command listing that information.|Подкоманда description interface предоставляет простой способ сохранять небольшие заметки о том, какие интерфейсы маршрутизатора подключаются к каким соседним устройствам, с помощью команды show interfaces, отображающей эту информацию.
##### Interface Status Codes
Коды состояния интерфейса   
__|__
--|--
|
Each interface has two interface status codes.|Каждый интерфейс имеет два кода состояния интерфейса.
To be usable, the two interface status codes must be in an “up” state.|Для использования два кода состояния интерфейса должны находиться в рабочем состоянии.
The first status code refers essentially to whether Layer 1 is working, and the second status code mainly (but not always) refers to whether the data-link layer protocol is working.|Первый код состояния в основном указывает, работает ли уровень 1, а второй код состояния в основном (но не всегда) указывает, работает ли протокол уровня канала передачи данных.
Table 15-2 summarizes these two status codes.|В таблице 15-2 приведены эти два кода состояния.
|
Table 15-2 Interface Status Codes and Their Meanings Table end.|Таблица 15-2 Коды состояния интерфейсов и их значения Конец таблицы.
|
Several combinations of interface status codes exist, as summarized in Table 15-3.|Существует несколько комбинаций кодов состояния интерфейсов, как показано в Таблице 15-3.
The table lists the status codes in order, from being disabled on purpose by the configuration to a fully working state.|В таблице перечислены коды состояния в порядке от намеренного отключения конфигурацией до полностью рабочего состояния.
|
Table 15-3 Typical Combinations of Interface Status Codes Table end.|Таблица 15-3 Типичные комбинации кодов состояния интерфейсов Конец таблицы.
|
For some examples, look back at Example 15-1’s show ip interface brief command, to the three interfaces in the following list.|В качестве некоторых примеров вернитесь к команде show ip interfacerief в примере 15-1, к трем интерфейсам в следующем списке.
The interfaces in this list each have a different combination of interface status codes; the list details the specific reasons for this status code in the lab used to create this example for the book.|Каждый интерфейс в этом списке имеет различную комбинацию кодов состояния интерфейса; в списке подробно описаны конкретные причины этого кода состояния в лаборатории, использованной для создания этого примера для книги.
|
G0/0: The interface is down/down, in this case because no cable was connected to the interface.|G0 / 0: интерфейс отключен / не работает, в данном случае из-за того, что к интерфейсу не был подключен кабель.
|
G0/1: The interface is administratively down/down, because the configuration includes the shutdown command under the G0/1 interface.|G0 / 1: интерфейс отключен / отключен администратором, поскольку конфигурация включает команду выключения под интерфейсом G0 / 1.
|
S0/0/0: The interface is up/up because a serial cable is installed, is connected to another router in a lab, and is working.|S0 / 0/0: Интерфейс включен / работает, потому что последовательный кабель установлен, подключен к другому маршрутизатору в лаборатории и работает.
##### Router Interface IP Addresses
IP-адреса интерфейса маршрутизатора   
__|__
--|--
|
Cisco enterprise routers require at least some configuration beyond the default configuration before they will do their primary job: routing IP packets.|Для корпоративных маршрутизаторов Cisco требуется по крайней мере некоторая конфигурация помимо конфигурации по умолчанию, прежде чем они будут выполнять свою основную работу: маршрутизацию IP-пакетов.
The following facts tell us that to make a router ready to route IPv4 packets on an interface, you need to enable the interface and assign it an IPv4 address:|Следующие факты говорят нам, что для подготовки маршрутизатора к маршрутизации пакетов IPv4 на интерфейсе вам необходимо включить интерфейс и назначить ему адрес IPv4:
###### Most Cisco router interfaces default to a disabled (shutdown) state and should be enabled
Большинство интерфейсов маршрутизатора Cisco по умолчанию отключены (выключено) и должны быть включены.   
__|__
--|--
|
with the no shutdown interface subcommand.|с помощью подкоманды интерфейса no shutdown.
###### Cisco routers do not route IP packets in or out an interface until an IP address and mask
Маршрутизаторы Cisco не направляют IP-пакеты в интерфейс или исходят из него до тех пор, пока не будет указан IP-адрес и маска.   
__|__
--|--
|
have been configured; by default, no interfaces have an IP address and mask.|были настроены; по умолчанию ни один интерфейс не имеет IP-адреса и маски.
###### Cisco routers attempt to route IP packets for any interfaces that are in an up/up state and
Маршрутизаторы Cisco пытаются маршрутизировать IP-пакеты для любых интерфейсов, которые находятся в активном / активном состоянии и   
__|__
--|--
|
that have an IP address/mask assigned.|которым назначен IP-адрес / маска.
|
To configure the address and mask, simply use the ip address address mask interface subcommand.|Чтобы настроить адрес и маску, просто используйте подкоманду интерфейса маски IP-адреса.
|
Figure 15-6 shows a simple IPv4 network with IPv4 addresses on Router R1, with Example 15-2 showing the matching configuration.|На рис. 15-6 показана простая сеть IPv4 с адресами IPv4 на маршрутизаторе R1, а в примере 15-2 показана соответствующая конфигурация.
|
Figure 15-6 IPv4 Addresses Used in Example 15-2 Example 15-2 Configuring IP Addresses on Cisco Routers Example end.|Рисунок 15-6 Адреса IPv4, используемые в примере 15-2 Пример 15-2 Настройка IP-адресов на маршрутизаторах Cisco Окончание примера.
|
Example 15-3 shows the output of the show protocols command.|В примере 15-3 показаны выходные данные команды show protocol.
This command confirms the state of each of the three R1 interfaces in Figure 15-6 and the IP address and mask configured on those same interfaces.|Эта команда подтверждает состояние каждого из трех интерфейсов R1 на рис. 15-6, а также IP-адрес и маску, настроенные для этих же интерфейсов.
|
Example 15-3 Verifying IP Addresses on Cisco Routers Example end.|Пример 15-3. Проверка IP-адресов на маршрутизаторах Cisco. Пример конец.
|
One of the first actions to take when verifying whether a router is working is to find the interfaces, check the interface status, and check to see whether the correct IP addresses and masks are used.|Одно из первых действий, которое следует предпринять при проверке работы маршрутизатора, - это найти интерфейсы, проверить состояние интерфейса и проверить, используются ли правильные IP-адреса и маски.
Examples 15-1 and 15-3 showed samples of the key show commands, while Table 15-4 summarizes those commands and the types of information they display.|В примерах 15-1 и 15-3 показаны образцы ключевых команд show, а в таблице 15-4 приведены эти команды и типы отображаемой информации.
|
Table 15-4 Key Commands to List Router Interface Status Table end.|Таблица 15-4 Ключевые команды для вывода списка состояний интерфейса маршрутизатора Конец таблицы.
##### Bandwidth and Clock Rate on Serial Interfaces
Пропускная способность и тактовая частота последовательных интерфейсов   
__|__
--|--
|
Cisco has included serial WAN topics in the CCNA exam topic list since its inception in 1998 until the CCNA 200-301 release in the year 2019.|Cisco включила темы последовательных WAN в список тем экзамена CCNA с момента его создания в 1998 году до выпуска CCNA 200-301 в 2019 году.
Because the CCNA 200-301 exam is the first to not mention serial technologies at all, this book includes some examples that show serial links.|Поскольку экзамен CCNA 200-301 является первым, в котором вообще не упоминаются последовательные технологии, в эту книгу включены некоторые примеры, показывающие последовательные связи.
The exam might show them with the expectation that you at least understand basics, such as the fact that two routers can send data over a serial link if the router interfaces on both ends are up/up and the routers have IP addresses in the same subnet.|Экзамен может показать их с ожиданием, что вы хотя бы понимаете основы, такие как тот факт, что два маршрутизатора могут отправлять данные по последовательному каналу, если интерфейсы маршрутизатора на обоих концах подключены / подключены, а маршрутизаторы имеют IP-адреса в одной подсети .
|
However, some of you will want to make serial links work in a lab because you have some serial interface cards in your lab.|Однако некоторые из вас захотят заставить работать последовательные каналы в лаборатории, потому что в вашей лаборатории есть несколько карт последовательного интерфейса.
If so, take the time to look at a few pages in the section titled “Bandwidth and Clock Rate on Serial Interfaces,” in Appendix J, “Topics from Previous Editions,” which shows how to cable and configure a WAN serial link in the lab.|Если это так, найдите время и посмотрите несколько страниц в разделе «Пропускная способность и тактовая частота на последовательных интерфейсах» в Приложении J «Темы из предыдущих выпусков», где показано, как подключить и настроить последовательную связь WAN в лаборатория.
#### Router Auxiliary Port
Дополнительный порт маршрутизатора   
__|__
--|--
|
Both routers and switches have a console port to allow administrative access, but most Cisco routers have an extra physical port called an auxiliary (Aux) port.|И маршрутизаторы, и коммутаторы имеют консольный порт для административного доступа, но большинство маршрутизаторов Cisco имеют дополнительный физический порт, называемый вспомогательным (Aux) портом.
The Aux port typically serves as a means to make a phone call to connect into the router to issue commands from the CLI.|Порт Aux обычно служит средством для выполнения телефонного звонка для подключения к маршрутизатору для выполнения команд из интерфейса командной строки.
|
The Aux port works like the console port, except that the Aux port is typically connected through a cable to an external analog modem, which in turn connects to a phone line.|Порт Aux работает так же, как консольный порт, за исключением того, что порт Aux обычно подключается через кабель к внешнему аналоговому модему, который, в свою очередь, подключается к телефонной линии.
Then, the engineer uses a PC, terminal emulator, and modem to call the remote router.|Затем инженер использует ПК, эмулятор терминала и модем для вызова удаленного маршрутизатора.
After being connected, the engineer can use the terminal emulator to access the router CLI, starting in user mode as usual.|После подключения инженер может использовать эмулятор терминала для доступа к интерфейсу командной строки маршрутизатора, как обычно, начиная с пользовательского режима.
|
Aux ports can be configured beginning with the line aux 0 command to reach aux line configuration mode.|Порты Aux можно настроить, начиная с команды line aux 0, чтобы перейти в режим конфигурации линии aux.
From there, all the commands for the console line, covered mostly in Chapter 6, can be used.|Оттуда можно использовать все команды для строки консоли, описанные в основном в главе 6.
For example, the login and password password subcommands on the aux line could be used to set up simple password checking when a user dials in.|Например, подкоманды входа в систему и пароля и пароля на вспомогательной линии могут использоваться для настройки простой проверки пароля при звонке пользователя.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element for more details.|Обратитесь к элементу «Ваш учебный план» для получения более подробной информации.
Table 15-5 outlines the key review elements and where you can find them.|В Таблице 15-5 представлены основные элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 15-5 Chapter Review Tracking Table end.|Таблица 15-5 Окончание таблицы отслеживания обзора главы.
|
Review All the Key Topics Key Terms You Should Know enterprise router, SOHO router, Integrated Services Router (ISR)|Ознакомьтесь со всеми ключевыми темами. Ключевые термины, которые вы должны знать: корпоративный маршрутизатор, маршрутизатор SOHO, маршрутизатор с интегрированными сервисами (ISR)
|
Command References Tables 15-7 and 15-8 list configuration and verification commands used in this chapter.|Ссылки на команды В таблицах 15-7 и 15-8 перечислены команды настройки и проверки, используемые в этой главе.
As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.|В качестве простого упражнения на повторение закройте левый столбец таблицы, прочтите правый столбец и попытайтесь вспомнить команду, не глядя.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Затем повторите упражнение, охватывая правый столбец, и попытайтесь вспомнить, что делает команда.
|
Table 15-7 Chapter 15 Configuration Command Reference Table end.|Таблица 15-7 Глава 15 Справочник команд конфигурации Конец таблицы.
|
Table 15-8 Chapter 15 EXEC Command Reference Table end.|Таблица 15-8 Глава 15 Справочник команд EXEC Конец таблицы.
## Chapter 16 Configuring IPv4 Addresses and Static Routes
Глава 16 Настройка адресов IPv4 и статических маршрутов   
__|__
--|--
|
Static Routes This chapter covers the following exam topics:|Статические маршруты В этой главе рассматриваются следующие экзаменационные темы:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.6 Configure and verify IPv4 addressing and subnetting
1.6 Настройка и проверка адресации IPv4 и подсетей   
###### 3.0 IP Connectivity
3.0 IP-подключение   
###### 3.1 Interpret the components of routing table
3.1 Интерпретация компонентов таблицы маршрутизации   
###### 3.1.a Routing protocol code
3.1.a Код протокола маршрутизации   
###### 3.1.b Prefix
3.1.b Префикс   
###### 3.1.c Network mask
3.1.c Маска сети   
###### 3.1.d Next hop
3.1.d Следующий переход   
###### 3.1.e Administrative distance
3.1.e Административная дистанция   
###### 3.1.f Metric
3.1.f Метрическая система   
###### 3.1.g Gateway of last resort
3.1.g Шлюз последней инстанции   
###### 3.2 Determine how a router makes a forwarding decision by default
3.2 Определите, как маршрутизатор принимает решение о пересылке по умолчанию   
###### 3.2.a Longest match
3.2.Самый длинный матч   
###### 3.2.b Administrative distance
3.2.b Административная дистанция   
###### 3.3 Configure and verify IPv4 and IPv6 static routing
3.3 Настройка и проверка статической маршрутизации IPv4 и IPv6   
###### 3.3.a Default route
3.3.a Маршрут по умолчанию   
###### 3.3.b Network route
3.3.b Сетевой маршрут   
###### 3.3.c Host route
3.3.c Хост-маршрут   
###### 3.3.d Floating static
3.3.d Плавающая статика   
__|__
--|--
|
Routers route IPv4 packets.|Маршрутизаторы маршрутизируют пакеты IPv4.
That simple statement actually carries a lot of hidden meaning.|Это простое утверждение на самом деле несет в себе много скрытого смысла.
|
For routers to route packets, routers follow a routing process.|Для маршрутизаторов для маршрутизации пакетов маршрутизаторы следуют процессу маршрутизации.
That routing process relies on information called IP routes.|Этот процесс маршрутизации основан на информации, называемой IP-маршрутами.
Each IP route lists a destination—an IP network, IP subnet, or some other group of IP addresses.|В каждом IP-маршруте указан пункт назначения - IP-сеть, IP-подсеть или некоторая другая группа IP-адресов.
Each route also lists instructions that tell the router where to forward packets sent to addresses in that IP network or subnet.|Каждый маршрут также содержит инструкции, которые сообщают маршрутизатору, куда пересылать пакеты, отправленные на адреса в этой IP-сети или подсети.
For routers to do a good job of routing packets, routers need to have a detailed, accurate list of IP routes.|Чтобы маршрутизаторы хорошо справлялись с маршрутизацией пакетов, маршрутизаторы должны иметь подробный и точный список IP-маршрутов.
|
Routers use three methods to add IPv4 routes to their IPv4 routing tables.|Маршрутизаторы используют три метода для добавления маршрутов IPv4 в свои таблицы маршрутизации IPv4.
Routers first learn connected routes, which are routes for subnets attached to a router interface.|Маршрутизаторы сначала изучают подключенные маршруты, которые являются маршрутами для подсетей, подключенных к интерфейсу маршрутизатора.
Routers can CHAPTER 16 also use static routes, which are routes created through a configuration command (ip route)|Маршрутизаторы могут также использовать статические маршруты, которые представляют собой маршруты, созданные с помощью команды настройки (ip route).
|
that tells the router what route to put in the IPv4 routing table.|который сообщает маршрутизатору, какой маршрут поместить в таблицу маршрутизации IPv4.
And routers can use a routing protocol, in which routers tell each other about all their known routes, so that all routers can learn and build routes to all networks and subnets.|Кроме того, маршрутизаторы могут использовать протокол маршрутизации, в котором маршрутизаторы сообщают друг другу обо всех своих известных маршрутах, чтобы все маршрутизаторы могли изучать и строить маршруты ко всем сетям и подсетям.
|
This chapter examines IP routing in depth with the most straightforward routes that can be added to a router’s routing table.|В этой главе подробно рассматривается IP-маршрутизация с помощью наиболее простых маршрутов, которые можно добавить в таблицу маршрутизации маршрутизатора.
The router starts with a detailed look at the IP packet routing (forwarding process)—a process that relies on each router having useful IP routes in their routing tables.|Маршрутизатор начинается с подробного рассмотрения маршрутизации IP-пакетов (процесса пересылки) - процесса, который полагается на то, что каждый маршрутизатор имеет полезные IP-маршруты в своих таблицах маршрутизации.
The second section then examines connected routes, which are routes to subnets that exist on the interfaces connected to the local router.|Затем во втором разделе исследуются подключенные маршруты, которые представляют собой маршруты к подсетям, которые существуют на интерфейсах, подключенных к локальному маршрутизатору.
The third section then examines static routes, which are routes the network engineer configures directly.|В третьем разделе исследуются статические маршруты, которые напрямую настраивает сетевой инженер.
The chapter ends with a section that looks more specifically at the IP routing process in a router, how it matches packets to the routing table, and how to interpret all the details in the output of the show ip route command.|Глава заканчивается разделом, в котором более подробно рассматривается процесс IP-маршрутизации в маршрутизаторе, то, как он сопоставляет пакеты с таблицей маршрутизации, и как интерпретировать все подробности в выходных данных команды show ip route.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 16-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 16-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### IP Routing
IP-маршрутизация   
__|__
--|--
|
Configuring Connected Routes 2 Configuring Static Routes 3–5 IP Forwarding with the Longest Prefix Match 6 1.|Настройка подключенных маршрутов 2 Настройка статических маршрутов 3–5 Пересылка IP с совпадением самого длинного префикса 6 1.
Router R1 lists a route in its routing table.|Маршрутизатор R1 перечисляет маршрут в своей таблице маршрутизации.
Which of the following answers list a fact from a route that the router uses when matching the packet’s destination address?|Какой из следующих ответов перечисляет факт из маршрута, который маршрутизатор использует при сопоставлении адреса назначения пакета?
|
(Choose two answers.)|(Выберите два ответа.)
|
a. Mask b.|а. Маска б.
Next-hop router c.|Маршрутизатор следующего перехода c.
Subnet ID d.|ID подсети d.
Outgoing interface 2.|Исходящий интерфейс 2.
After configuring a working router interface with IP address/mask 10.1.1.100/26, which of the following routes would you expect to see in the output of the show ip route command? (Choose two answers.)|После настройки рабочего интерфейса маршрутизатора с IP-адресом / маской 10.1.1.100/26, какой из следующих маршрутов вы ожидаете увидеть в выходных данных команды show ip route? (Выберите два ответа.)
|
a. A connected route for subnet 10.1.1.64 255.255.255.192 b.|а. Подключенный маршрут для подсети 10.1.1.64 255.255.255.192 b.
A connected route for subnet 10.1.1.0 255.255.255.0 c.|Подключенный маршрут для подсети 10.1.1.0 255.255.255.0 c.
A local route for host 10.1.1.100 255.255.255.192 d.|Локальный маршрут для хоста 10.1.1.100 255.255.255.192 d.
A local route for host 10.1.1.100 255.255.255.255 e.|Локальный маршрут для хоста 10.1.1.100 255.255.255.255 e.
A local route for host 10.1.1.64 255.255.255.255 3.|Локальный маршрут для хоста 10.1.1.64 255.255.255.255 3.
An engineer configures a static IPv4 route on Router R1. Which of the following pieces of information should not be listed as a parameter in the configuration command that creates this static IPv4 route?|Инженер настраивает статический маршрут IPv4 на маршрутизаторе R1. Какая из следующих частей информации не должна быть указана в качестве параметра в команде конфигурации, которая создает этот статический маршрут IPv4?
|
a. The destination subnet’s subnet ID b.|а. ID подсети целевой подсети b.
The next-hop router’s IP address c.|IP-адрес маршрутизатора следующего перехода c.
The next-hop router’s neighboring interface d.|Соседний интерфейс маршрутизатора следующего перехода d.
The subnet mask 4.|Маска подсети 4.
Which of the following commands correctly configures a static route?|Какая из следующих команд правильно настраивает статический маршрут?
|
a. ip route 10.1.3.0 255.255.255.0 10.1.130.253 b. ip route 10.1.3.0 serial 0 c. ip route 10.1.3.0 /24 10.1.130.253 d. ip route 10.1.3.0 /24 serial 0 5.|а. ip route 10.1.3.0 255.255.255.0 10.1.130.253 б. ip route 10.1.3.0 серийный 0 c. ip route 10.1.3.0 / 24 10.1.130.253 г. ip route 10.1.3.0 / 24 серийный 0 5.
A network engineer configures the ip route 10.1.1.0 255.255.255.0 s0/0/0 command on a router and then issues a show ip route command from enable mode.|Сетевой инженер настраивает команду ip route 10.1.1.0 255.255.255.0 s0 / 0/0 на маршрутизаторе, а затем выдает команду show ip route из режима включения.
No routes for subnet 10.1.1.0/24 appear in the output.|В выводе не отображаются маршруты для подсети 10.1.1.0/24.
Which of the following could be true?|Что из следующего может быть правдой?
|
a. The ip route command has incorrect syntax and was rejected in config mode.|а. Команда ip route имеет неправильный синтаксис и была отклонена в режиме конфигурации.
|
b. Interface s0/0/0 is down.|б. Интерфейс s0 / 0/0 не работает.
|
c. The router has no up/up interfaces in Class A network 10.0.0.0.|c. Маршрутизатор не имеет интерфейсов up / up в сети 10.0.0.0 класса A.
|
d. The ip route command is missing a next-hop router IP address.|d. В команде ip route отсутствует IP-адрес маршрутизатора следующего перехода.
|
6. A router lists the following partial output from the show ip route command.|6. Маршрутизатор перечисляет следующие частичные выходные данные команды show ip route.
Out which interface will the router route packets destined to IP address 10.1.15.122?|Через какой интерфейс маршрутизатор будет маршрутизировать пакеты, предназначенные для IP-адреса 10.1.15.122?
###### 10.0.0.0/8 is variably subnetted, 8 subnets, 5 masks
10.0.0.0/8 имеет переменные подсети, 8 подсетей, 5 масок   
__|__
--|--
|
O 10.1.15.100/32 [110/50] via 172.16.25.2, 00:00:04, GigabitEthernet0/0/0 O 10.1.15.64/26 [110/100] via 172.16.25.129, 00:00:09, GigabitEthernet0/1/0 O 10.1.14.0/23 [110/65] via 172.16.24.2, 00:00:04, GigabitEthernet0/2/0 O 10.1.15.96/27 [110/65] via 172.16.24.129, 00:00:09, GigabitEthernet0/3/0 O 0.0.0.0/0 [110/129] via 172.16.25.129, 00:00:09, GigabitEthernet0/0/0 a.|O 10.1.15.100/32 [110/50] через 172.16.25.2, 00:00:04, GigabitEthernet0 / 0/0 O 10.1.15.64/26 [110/100] через 172.16.25.129, 00:00:09, GigabitEthernet0 / 1/0 O 10.1.14.0/23 [110/65] через 172.16.24.2, 00:00:04, GigabitEthernet0 / 2/0 O 10.1.15.96/27 [110/65] через 172.16.24.129, 00:00 : 09, GigabitEthernet0 / 3/0 O 0.0.0.0/0 [110/129] через 172.16.25.129, 00:00:09, GigabitEthernet0 / 0/0 a.
G0/0/0 b.|G0 / 0/0 б.
G0/1/0 c.|G0 / 1/0 с.
G0/2/0 d.|G0 / 2/0 д.
G0/3/0 Foundation Topics IP Routing IP routing—the process of forwarding IP packets—delivers packets across entire TCP/IP networks, from the device that originally builds the IP packet to the device that is supposed to receive the packet.|G0 / 3/0 Основные темы IP-маршрутизация IP-маршрутизация - процесс пересылки IP-пакетов - доставляет пакеты по всем сетям TCP / IP от устройства, которое изначально создает IP-пакет, к устройству, которое должно его получить.
In other words, IP routing delivers IP packets from the sending host to the destination host.|Другими словами, IP-маршрутизация доставляет IP-пакеты от хоста-отправителя к хосту назначения.
|
The complete end-to-end routing process relies on network layer logic on hosts and on routers.|Полный процесс сквозной маршрутизации зависит от логики сетевого уровня на хостах и ​​маршрутизаторах.
|
The sending host uses Layer 3 concepts to create an IP packet, forwarding the IP packet to the host’s default gateway (default router).|Передающий хост использует концепции уровня 3 для создания IP-пакета, пересылающего IP-пакет на шлюз хоста по умолчанию (маршрутизатор по умолчанию).
The process requires Layer 3 logic on the routers as well, by which the routers compare the destination address in the packet to their routing tables, to decide where to forward the IP packet next.|Для этого процесса также требуется логика уровня 3 на маршрутизаторах, с помощью которой маршрутизаторы сравнивают адрес назначения в пакете со своими таблицами маршрутизации, чтобы решить, куда пересылать IP-пакет дальше.
|
The routing process also relies on data-link and physical details at each link.|Процесс маршрутизации также зависит от канала передачи данных и физических данных на каждом канале.
IP routing relies on serial WAN links, Ethernet WAN links, Ethernet LANs, wireless LANs, and many other networks that implement data-link and physical layer standards.|IP-маршрутизация основывается на последовательных каналах WAN, каналах Ethernet WAN, локальных сетях Ethernet, беспроводных локальных сетях и многих других сетях, реализующих стандарты каналов передачи данных и физического уровня.
These lower-layer devices and protocols move the IP packets around the TCP/IP network by encapsulating and transmitting the packets inside data-link layer frames.|Эти устройства и протоколы нижнего уровня перемещают IP-пакеты по сети TCP / IP, инкапсулируя и передавая пакеты внутри кадров канального уровня.
|
The previous two paragraphs summarize the key concepts about IP routing as introduced back in Chapter 3, “Fundamentals of WANs and IP Routing.” Next, this section reviews IP routing, while taking the discussion another step or two deeper, taking advantage of the additional depth of knowledge discussed in all the earlier chapters in this book.|В двух предыдущих абзацах обобщены ключевые концепции IP-маршрутизации, представленные в главе 3 «Основы глобальных сетей и IP-маршрутизации». Далее в этом разделе рассматривается IP-маршрутизация, но мы продвигаемся еще на один или два шага глубже, используя преимущества дополнительных знаний, обсуждавшихся во всех предыдущих главах этой книги.
#### IPv4 Routing Process Reference
Справочник по процессу маршрутизации IPv4   
__|__
--|--
|
Because you already saw the basics back in Chapter 3, this section collects the routing process into steps for reference.|Поскольку вы уже познакомились с основами в главе 3, в этом разделе для справки процесс маршрутизации разбит на этапы.
The steps use many specific Ethernet LAN terms discussed in Parts II and III of this book and some IP addressing terms discussed in Part IV. The upcoming descriptions and example then discuss these summaries of routing logic to make sure that each step is clear.|В шагах используется множество конкретных терминов Ethernet LAN, обсуждаемых в частях II и III этой книги, а также некоторые термины IP-адресации, обсуждаемые в части IV. Затем в следующих описаниях и примерах обсуждаются эти краткие сведения о логике маршрутизации, чтобы убедиться, что каждый шаг понятен.
|
The routing process starts with the host that creates the IP packet.|Процесс маршрутизации начинается с хоста, который создает IP-пакет.
First, the host asks the question: Is the destination IP address of this new packet in my local subnet?|Сначала хост задает вопрос: находится ли IP-адрес назначения этого нового пакета в моей локальной подсети?
The host uses its own IP address/mask to determine the range of addresses in the local subnet.|Хост использует свой собственный IP-адрес / маску для определения диапазона адресов в локальной подсети.
Based on its own opinion of the range of addresses in the local subnet, a LAN-based host acts as follows:|Основываясь на собственном мнении о диапазоне адресов в локальной подсети, хост в локальной сети действует следующим образом:
|
Step 1.|Шаг 1.
If the destination is local, send directly:|Если пункт назначения местный, отправьте напрямую:
|
A. Find the destination host’s MAC address.|A. Найдите MAC-адрес целевого хоста.
Use the already-known Address Resolution Protocol (ARP) table entry, or use ARP messages to learn the information.|Используйте уже известную запись в таблице протокола разрешения адресов (ARP) или сообщения ARP для изучения информации.
|
B. Encapsulate the IP packet in a data-link frame, with the destination data-link address of the destination host.|B. Инкапсулируйте IP-пакет во фрейме канала передачи данных с адресом канала передачи данных пункта назначения.
|
Step 2.|Шаг 2.
If the destination is not local, send to the default gateway:|Если пункт назначения не является локальным, отправьте на шлюз по умолчанию:
|
A. Find the default gateway’s MAC address.|A. Найдите MAC-адрес шлюза по умолчанию.
Use the already-known Address Resolution Protocol (ARP) table entry, or use ARP messages to learn the information.|Используйте уже известную запись в таблице протокола разрешения адресов (ARP) или сообщения ARP для изучения информации.
|
B. Encapsulate the IP packet in a data-link frame, with the destination data-link address of the default gateway.|B. Инкапсулируйте IP-пакет во фрейме канала данных с адресом канала передачи данных назначения шлюза по умолчанию.
|
Figure 16-1 summarizes these same concepts.|Рисунок 16-1 суммирует эти же концепции.
In the figure, host A sends a local packet directly to host D.|На рисунке хост A отправляет локальный пакет непосредственно хосту D.
However, for packets to host B, on the other side of a router and therefore in a different subnet, host A sends the packet to its default router (R1). (As a reminder, the terms default gateway and default router are synonyms.).|Однако для пакетов на хост B, на другой стороне маршрутизатора и, следовательно, в другой подсети, хост A отправляет пакет своему маршрутизатору по умолчанию (R1). (Напоминаем, что термины «шлюз по умолчанию» и «маршрутизатор по умолчанию» являются синонимами.)
|
Figure 16-1 Host Routing Logic Summary Routers have a little more routing work to do as compared with hosts.|Рисунок 16-1. Сводка логики маршрутизации хоста. Маршрутизаторам приходится выполнять немного больше работы по маршрутизации, чем хостам.
While the host logic began with an IP packet sitting in memory, a router has some work to do before getting to that point.|Хотя логика хоста началась с IP-пакета, находящегося в памяти, маршрутизатору нужно поработать, прежде чем добраться до этой точки.
With the following five-step summary of a router’s routing logic, the router takes the first two steps just to receive the frame and extract the IP packet, before thinking about the packet’s destination address at Step 3.|В следующем пятиэтапном обзоре логики маршрутизации маршрутизатор выполняет первые два шага только для получения кадра и извлечения IP-пакета, прежде чем думать об адресе назначения пакета на шаге 3.
The steps are as follows:|Шаги следующие:
|
1. For each received data-link frame, choose whether or not to process the frame.|1. Для каждого полученного кадра канала передачи данных выберите, обрабатывать этот кадр или нет.
|
Process it if A.|Обработать, если А.
The frame has no errors (per the data-link trailer Frame Check Sequence [FCS]|В кадре нет ошибок (в соответствии с последовательностью проверки кадра трейлера канала передачи данных [FCS]
|
field).|поле).
|
B. The frame’s destination data-link address is the router’s address (or an appropriate multicast or broadcast address).|Б. Адресом канала передачи данных назначения кадра является адрес маршрутизатора (или соответствующий адрес многоадресной или широковещательной рассылки).
|
2. If choosing to process the frame at Step 1, de-encapsulate the packet from inside the data-link frame.|2. Если вы выбрали обработку кадра на шаге 1, деинкапсулируйте пакет изнутри кадра канала данных.
|
3. Make a routing decision.|3. Примите решение о маршрутизации.
To do so, compare the packet’s destination IP address to the routing table and find the route that matches the destination address.|Для этого сравните IP-адрес пункта назначения пакета с таблицей маршрутизации и найдите маршрут, соответствующий адресу назначения.
This route identifies the outgoing interface of the router and possibly the next-hop router.|Этот маршрут идентифицирует исходящий интерфейс маршрутизатора и, возможно, маршрутизатор следующего перехода.
|
4. Encapsulate the packet into a data-link frame appropriate for the outgoing interface.|4. Инкапсулируйте пакет в кадр канала данных, соответствующий исходящему интерфейсу.
|
When forwarding out LAN interfaces, use ARP as needed to find the next device’s MAC address.|При пересылке интерфейсов LAN используйте ARP по мере необходимости, чтобы найти MAC-адрес следующего устройства.
|
5. Transmit the frame out the outgoing interface, as listed in the matched IP route.|5. Передайте кадр из исходящего интерфейса, как указано в согласованном IP-маршруте.
|
This routing process summary lists many details, but sometimes you can think about the routing process in simpler terms.|В этом обзоре процесса маршрутизации приводится много деталей, но иногда вы можете подумать о процессе маршрутизации в более простых терминах.
For example, leaving out some details, this paraphrase of the step list details the same big concepts:|Например, опуская некоторые детали, этот пересказ списка шагов описывает те же самые важные концепции:
|
The router receives a frame, removes the packet from inside the frame, decides where to forward the packet, puts the packet into another frame, and sends the frame.|Маршрутизатор получает кадр, удаляет пакет изнутри кадра, решает, куда пересылать пакет, помещает пакет в другой кадр и отправляет этот кадр.
|
Answers to the “Do I Know This Already?” quiz:|Ответы на вопрос «Знаю ли я это уже?» викторина:
|
1 A, C 2 A, D 3 C 4 A 5 B 6 D To give you a little more perspective on these steps, Figure 16-2 breaks down the same fivestep routing process as a diagram.|1 A, C 2 A, D 3 C 4 A 5 B 6 D Чтобы дать вам немного больше представления об этих этапах, на рис. 16-2 показан тот же пятишаговый процесс маршрутизации, что и диаграмма.
The figure shows a packet arriving from the left, entering a router Ethernet interface, with an IP destination of host C.|На рисунке показан пакет, поступающий слева, входящий в интерфейс Ethernet маршрутизатора с IP-адресом хоста C.
The figure shows the packet arriving, encapsulated inside an Ethernet frame (both header and trailer).|На рисунке показан приходящий пакет, инкапсулированный внутри кадра Ethernet (заголовок и конец).
|
Figure 16-2 Router Routing Logic Summary Router R1 processes the frame and packet as shown with the numbers in the figure, matching the same five-step process described just before the figure, as follows:|Рис. 16-2 Сводная логика маршрутизации маршрутизатора Маршрутизатор R1 обрабатывает фрейм и пакет, как показано цифрами на рисунке, в соответствии с тем же пятиэтапным процессом, описанным непосредственно перед рисунком, а именно:
|
1. Router R1 notes that the received Ethernet frame passes the FCS check and that the destination Ethernet MAC address is R1’s MAC address, so R1 processes the frame.|1. Маршрутизатор R1 отмечает, что полученный кадр Ethernet проходит проверку FCS и что MAC-адрес Ethernet назначения является MAC-адресом R1, поэтому R1 обрабатывает этот кадр.
|
2. R1 de-encapsulates the IP packet from inside the Ethernet frame’s header and trailer.|2. R1 деинкапсулирует IP-пакет из заголовка и трейлера кадра Ethernet.
|
3. R1 compares the IP packet’s destination IP address to R1’s IP routing table.|3. R1 сравнивает IP-адрес назначения IP-пакета с таблицей IP-маршрутизации маршрутизатора R1.
|
4. R1 encapsulates the IP packet inside a new data-link frame, in this case, inside a High-|4. R1 инкапсулирует IP-пакет в новый фрейм канала передачи данных, в данном случае внутри High-
|
Level Data Link Control (HDLC) header and trailer.|Заголовок и трейлер Level Data Link Control (HDLC).
|
5. R1 transmits the IP packet, inside the new HDLC frame, out the serial link on the right.|5. R1 передает IP-пакет внутри нового кадра HDLC по последовательному каналу справа.
|
NOTE This chapter uses several figures that show an IP packet encapsulated inside a datalink layer frame.|ПРИМЕЧАНИЕ В этой главе используются несколько рисунков, на которых показан IP-пакет, инкапсулированный внутри кадра уровня канала передачи данных.
These figures often show both the data-link header as well as the data-link trailer, with the IP packet in the middle.|На этих рисунках часто показаны как заголовок канала передачи данных, так и его конец, с IP-пакетом посередине.
The IP packets all include the IP header, plus any encapsulated data.|Все IP-пакеты включают заголовок IP, а также любые инкапсулированные данные.
#### An Example of IP Routing
Пример IP-маршрутизации   
__|__
--|--
|
The next several pages walk you through an example that discusses each routing step, in order, through multiple devices.|На следующих нескольких страницах вы рассмотрите пример, в котором описывается каждый этап маршрутизации через несколько устройств.
The example uses a case in which host A (172.16.1.9) sends a packet to host B (172.16.2.9), with host routing logic and the five steps showing how R1 forwards the packet.|В примере используется случай, когда хост A (172.16.1.9) отправляет пакет хосту B (172.16.2.9), с логикой маршрутизации хоста и пятью шагами, показывающими, как R1 пересылает пакет.
|
Figure 16-3 shows a typical IP addressing diagram for an IPv4 network with typical address abbreviations.|На рис. 16-3 показана типичная диаграмма IP-адресации для сети IPv4 с типичными сокращениями адресов.
The diagram can get a little too messy if it lists the full IP address for every router interface.|Схема может стать слишком запутанной, если на ней будет указан полный IP-адрес для каждого интерфейса маршрутизатора.
When possible, these diagrams usually list the subnet and then the last octet or two of the individual IP addresses—just enough so that you know the IP address but with less clutter.|Если возможно, на этих диаграммах обычно указывается подсеть, а затем последний или два октета отдельных IP-адресов - ровно столько, чтобы вы знали IP-адрес, но с меньшим количеством беспорядка.
For example, host A uses IP address 172.16.1.9, taking from subnet 172.16.1.0/24 (in which all addresses begin 172.16.1) and the .9 beside the host A icon.|Например, хост A использует IP-адрес 172.16.1.9, взятый из подсети 172.16.1.0/24 (в которой все адреса начинаются с 172.16.1) и 0,9 рядом со значком хоста A.
As another example, R1 uses address 172.16.1.1 on its LAN interface, 172.16.4.1 on one serial interface, and 172.16.5.1 on an Ethernet WAN interface.|В качестве другого примера R1 использует адрес 172.16.1.1 на своем интерфейсе LAN, 172.16.4.1 на одном последовательном интерфейсе и 172.16.5.1 на интерфейсе Ethernet WAN.
|
Figure 16-3 IPv4 Network Used to Show Five-Step Routing Example Now on to the example, with host A (172.16.1.9) sending a packet to host B (172.16.2.9).|Рисунок 16-3. Сеть IPv4, используемая для демонстрации примера пятиэтапной маршрутизации. Теперь перейдем к примеру с хостом A (172.16.1.9), отправляющим пакет хосту B (172.16.2.9).
##### Host Forwards the IP Packet to the Default Router (Gateway)
Хост перенаправляет IP-пакет на маршрутизатор по умолчанию (шлюз)   
__|__
--|--
|
In this example, host A uses some application that sends data to host B (172.16.2.9).|В этом примере хост A использует какое-то приложение, которое отправляет данные хосту B (172.16.2.9).
After host A has the IP packet sitting in memory, host A’s logic reduces to the following:|После того, как хост A имеет IP-пакет в памяти, логика хоста A сводится к следующему:
###### My IP address/mask is 172.16.1.9/24, so my local subnet contains numbers 172.16.1.0–
My IP address/mask is 172.16.1.9/24, so my local subnet contains numbers 172.16.1.0–   
__|__
--|--
|
172.16.1.255 (including the subnet ID and subnet broadcast address).|172.16.1.255 (including the subnet ID and subnet broadcast address).
###### The destination address is 172.16.2.9, which is clearly not in my local subnet.
Адрес назначения - 172.16.2.9, которого явно нет в моей локальной подсети.   
###### Send the packet to my default gateway, which is set to 172.16.1.1.
Отправьте пакет на мой шлюз по умолчанию, который установлен на 172.16.1.1.   
###### To send the packet, encapsulate it in an Ethernet frame. Make the destination MAC
Чтобы отправить пакет, инкапсулируйте его в кадр Ethernet. Сделайте MAC-адрес назначения   
__|__
--|--
|
address be R1’s G0/0 MAC address (host A’s default gateway).|адрес - это MAC-адрес G0 / 0 маршрутизатора R1 (шлюз по умолчанию хоста A).
|
Figure 16-4 pulls these concepts together, showing the destination IP address and destination MAC address in the frame and packet sent by host A in this case.|Рисунок 16-4 объединяет эти концепции, показывая IP-адрес пункта назначения и MAC-адрес пункта назначения в кадре и пакете, отправленном хостом A в этом случае.
Note that the figure uses a common drawing convention in networking, showing an Ethernet as a few lines, hiding all the detail of the Layer 2 switches.|Обратите внимание, что на рисунке используется стандартное соглашение о рисовании в сети, где Ethernet отображается в виде нескольких линий, скрывая все детали коммутаторов уровня 2.
|
Figure 16-4 Host A Sends Packet to Host B|Рисунок 16-4 Хост A отправляет пакет хосту B
##### Routing Step 1: Decide Whether to Process the Incoming Frame
Шаг маршрутизации 1. Решите, обрабатывать ли входящий кадр   
__|__
--|--
|
Routers receive many frames in an interface, particularly LAN interfaces.|Маршрутизаторы получают много кадров в интерфейсе, особенно в интерфейсах LAN.
However, a router can and should ignore some of those frames.|Однако маршрутизатор может и должен игнорировать некоторые из этих кадров.
So, the first step in the routing process begins with a decision of whether a router should process the frame or silently discard (ignore) the frame.|Итак, первый шаг в процессе маршрутизации начинается с решения, должен ли маршрутизатор обрабатывать фрейм или молча отбросить (проигнорировать) фрейм.
|
First, the router does a simple but important check (Step 1A in the process summary) so that the router ignores all frames that had bit errors during transmission.|Сначала маршрутизатор выполняет простую, но важную проверку (шаг 1A в сводке процесса), чтобы маршрутизатор игнорировал все кадры, в которых были битовые ошибки во время передачи.
The router uses the data-link trailer’s FCS field to check the frame, and if errors occurred in transmission, the router discards the frame. (The router makes no attempt at error recovery; that is, the router does not ask the sender to retransmit the data.)|Маршрутизатор использует поле FCS трейлера канала данных для проверки кадра, и если при передаче произошли ошибки, маршрутизатор отбрасывает кадр. (Маршрутизатор не предпринимает попыток восстановления после ошибок, то есть маршрутизатор не просит отправителя повторно передать данные.)
|
The router also checks the destination data-link address (Step 1B in the summary) to decide whether the frame is intended for the router.|Маршрутизатор также проверяет адрес канала передачи данных назначения (шаг 1B в сводке), чтобы решить, предназначен ли кадр для маршрутизатора.
For example, frames sent to the router’s unicast MAC address for that interface are clearly sent to that router.|Например, кадры, отправленные на одноадресный MAC-адрес маршрутизатора для этого интерфейса, явно отправляются на этот маршрутизатор.
However, a router can actually receive a frame sent to some other unicast MAC address, and routers should ignore these frames.|Однако маршрутизатор может фактически получить кадр, отправленный на другой одноадресный MAC-адрес, и маршрутизаторы должны игнорировать эти кадры.
|
For example, routers will receive some unicast frames sent to other devices in the VLAN just because of how LAN switches work.|Например, маршрутизаторы будут получать некоторые одноадресные кадры, отправленные на другие устройства в VLAN, только из-за того, как работают коммутаторы LAN.
Think back to how LAN switches forward unknown unicast frames—frames for which the switch does not list the destination MAC address in the MAC address table.|Вспомните, как коммутаторы LAN пересылают неизвестные одноадресные кадры - кадры, для которых коммутатор не перечисляет MAC-адрес назначения в таблице MAC-адресов.
The LAN switch floods those frames.|Коммутатор LAN лавинно рассылает эти кадры.
The result?|Результат?
Routers sometimes receive frames destined for some other device, with some other device’s MAC address listed as the destination MAC address.|Маршрутизаторы иногда получают кадры, предназначенные для какого-то другого устройства, при этом MAC-адрес другого устройства указывается как MAC-адрес назначения.
Routers should ignore those frames.|Маршрутизаторы должны игнорировать эти кадры.
|
In this example, host A sends a frame destined for R1’s MAC address.|В этом примере хост A отправляет кадр, предназначенный для MAC-адреса маршрутизатора R1.
So, after the frame is received, and after R1 confirms with the FCS that no errors occurred, R1 confirms that the frame is destined for R1’s MAC address (0200.0101.0101 in this case).|Таким образом, после получения кадра и после того, как R1 подтвердит с помощью FCS, что ошибок не было, R1 подтверждает, что кадр предназначен для MAC-адреса маршрутизатора R1 (в данном случае 0200.0101.0101).
All checks have been passed, so R1 will process the frame, as shown in Figure 16-5. (Note that the large rectangle in the figure represents the internals of Router R1.).|Все проверки пройдены, поэтому R1 обработает кадр, как показано на рисунке 16-5. (Обратите внимание, что большой прямоугольник на рисунке представляет внутреннюю часть маршрутизатора R1.).
|
Figure 16-5 Routing Step 1, on Router R1: Checking FCS and Destination MAC|Рисунок 16-5 Шаг 1 маршрутизации на маршрутизаторе R1: проверка FCS и MAC-адреса назначения
##### Routing Step 2: De-encapsulation of the IP Packet
Шаг маршрутизации 2: деинкапсуляция IP-пакета   
__|__
--|--
|
After the router knows that it ought to process the received frame (per Step 1), the next step is relatively simple: de-encapsulating the packet.|После того, как маршрутизатор узнает, что он должен обработать полученный кадр (на шаге 1), следующий шаг относительно прост: деинкапсуляция пакета.
In router memory, the router no longer needs the original frame’s data-link header and trailer, so the router removes and discards them, leaving the IP packet, as shown in Figure 16-6.|В памяти маршрутизатора маршрутизатору больше не нужны заголовок и трейлер канала передачи данных исходного кадра, поэтому маршрутизатор удаляет и отбрасывает их, оставляя IP-пакет, как показано на рисунке 16-6.
Note that the destination IP address remains unchanged (172.16.2.9).|Обратите внимание, что IP-адрес назначения остается неизменным (172.16.2.9).
|
Figure 16-6 Routing Step 2 on Router R1: De-encapsulating the Packet|Рисунок 16-6 Шаг 2 маршрутизации на маршрутизаторе R1: деинкапсуляция пакета
##### Routing Step 3: Choosing Where to Forward the Packet
Routing Step 3: Choosing Where to Forward the Packet   
__|__
--|--
|
While routing Step 2 required little thought, Step 3 requires the most thought of all the steps.|While routing Step 2 required little thought, Step 3 requires the most thought of all the steps.
At this point, the router needs to make a choice about where to forward the packet next.|At this point, the router needs to make a choice about where to forward the packet next.
That process uses the router’s IP routing table, with some matching logic to compare the packet’s destination address with the table.|That process uses the router’s IP routing table, with some matching logic to compare the packet’s destination address with the table.
|
First, an IP routing table lists multiple routes.|First, an IP routing table lists multiple routes.
Each individual route contains several facts, which in turn can be grouped as shown in Figure 16-7.|Each individual route contains several facts, which in turn can be grouped as shown in Figure 16-7.
Part of each route is used to match the destination address of the packet, while the rest of the route lists forwarding instructions:|Part of each route is used to match the destination address of the packet, while the rest of the route lists forwarding instructions:
|
where to send the packet next.|where to send the packet next.
|
Figure 16-7 Routing Step 3 on Router R1: Matching the Routing Table Focus on the entire routing table for a moment, and notice the fact that it lists five routes.|Figure 16-7 Routing Step 3 on Router R1: Matching the Routing Table Focus on the entire routing table for a moment, and notice the fact that it lists five routes.
|
Earlier, Figure 16-3 showed the entire example network, with five subnets, so R1 has a route for each of the five subnets.|Earlier, Figure 16-3 showed the entire example network, with five subnets, so R1 has a route for each of the five subnets.
|
Next, look at the part of the five routes that Router R1 will use to match packets.|Next, look at the part of the five routes that Router R1 will use to match packets.
To fully define each subnet, each route lists both the subnet ID and the subnet mask.|To fully define each subnet, each route lists both the subnet ID and the subnet mask.
When matching the IP packet’s destination with the routing table, the router looks at the packet’s destination IP address (172.16.2.9) and compares it to the range of addresses defined by each subnet.|When matching the IP packet’s destination with the routing table, the router looks at the packet’s destination IP address (172.16.2.9) and compares it to the range of addresses defined by each subnet.
|
Specifically, the router looks at the subnet and mask information; with a little math, the router can figure out in which of these subnets 172.16.2.9 resides (the route for subnet 172.16.2.0/24).|Specifically, the router looks at the subnet and mask information; with a little math, the router can figure out in which of these subnets 172.16.2.9 resides (the route for subnet 172.16.2.0/24).
|
Finally, look to the right side of the figure, to the forwarding instructions for these five routes.|Finally, look to the right side of the figure, to the forwarding instructions for these five routes.
After the router matches a specific route, the router uses the forwarding information in the route to tell the router where to send the packet next.|After the router matches a specific route, the router uses the forwarding information in the route to tell the router where to send the packet next.
In this case, the router matched the route for subnet 172.16.2.0/24, so R1 will forward the packet out its own interface S0/0/0, to Router R2 next, listed with its next-hop router IP address of 172.16.4.2.|In this case, the router matched the route for subnet 172.16.2.0/24, so R1 will forward the packet out its own interface S0/0/0, to Router R2 next, listed with its next-hop router IP address of 172.16.4.2.
|
NOTE Routes for remote subnets typically list both an outgoing interface and next-hop router IP address.|NOTE Routes for remote subnets typically list both an outgoing interface and next-hop router IP address.
Routes for subnets that connect directly to the router list only the outgoing interface because packets to these destinations do not need to be sent to another router.|Routes for subnets that connect directly to the router list only the outgoing interface because packets to these destinations do not need to be sent to another router.
##### Routing Step 4: Encapsulating the Packet in a New Frame
Шаг 4: инкапсуляция пакета в новый кадр   
__|__
--|--
|
At this point, the router knows how it will forward the packet.|На этом этапе маршрутизатор знает, как он будет пересылать пакет.
However, routers cannot forward a packet without first wrapping a data-link header and trailer around it (encapsulation).|Однако маршрутизаторы не могут пересылать пакет без предварительного обертывания его заголовком и концом канала передачи данных (инкапсуляция).
|
Encapsulating packets for serial links does not require a lot of thought, but the current CCNA 200-301 exam does not require a lot from us.|Инкапсуляция пакетов для последовательных каналов не требует больших усилий, но текущий экзамен CCNA 200-301 не требует от нас многого.
Point-to-point serial WAN links use either HDLC (the default) or PPP as the data-link protocol.|Для двухточечных последовательных каналов WAN в качестве протокола передачи данных используется HDLC (по умолчанию) или PPP.
However, we can ignore any datalink logic, even ignoring data-link addressing, because serial links have only two devices on the link: the sender and the then-obvious receiver; the data-link addressing does not matter.|Однако мы можем игнорировать любую логику канала данных, даже игнорируя адресацию канала передачи данных, потому что последовательные каналы имеют только два устройства на канале: отправитель и очевидный на тот момент получатель; Адресация канала передачи данных не имеет значения.
|
In this example, R1 forwards the packet out S0/0/0, after encapsulating the packet inside an HDLC frame, as shown in Figure 16-8.|В этом примере R1 пересылает пакет из S0 / 0/0 после инкапсуляции пакета внутри кадра HDLC, как показано на рисунке 16-8.
|
Figure 16-8 Routing Step 4 on Router R1: Encapsulating the Packet Note that with some other types of data links, the router has a little more work to do at this routing step.|Рис. 16-8. Шаг 4 маршрутизации на маршрутизаторе R1: инкапсуляция пакета Обратите внимание, что с некоторыми другими типами каналов передачи данных маршрутизатору нужно проделать немного больше работы на этом этапе маршрутизации.
For example, sometimes a router forwards packets out an Ethernet interface.|Например, иногда маршрутизатор пересылает пакеты через интерфейс Ethernet.
|
To encapsulate the IP packet, the router would need to build an Ethernet header, and that Ethernet header’s destination MAC address would need to list the correct value.|Чтобы инкапсулировать IP-пакет, маршрутизатору потребуется создать заголовок Ethernet, и в MAC-адресе назначения этого заголовка Ethernet необходимо указать правильное значение.
|
For example, consider a packet sent by that same PC A (172.16.1.19) in Figure 16-3 but with a destination of PC C (172.16.3.9).|Например, рассмотрим пакет, отправленный тем же самым ПК A (172.16.1.19) на рисунке 16-3, но с местом назначения ПК C (172.16.3.9).
When R1 processes the packet, R1 matches a route that tells R1 to forward the packet out R1’s G0/1/0 Ethernet interface to 172.16.5.3 (R3) next.|Когда R1 обрабатывает пакет, R1 сопоставляет маршрут, который сообщает R1 о необходимости пересылки пакета с интерфейса G0 / 1/0 маршрутизатора R1 на 172.16.5.3 (R3) следующим.
R1 needs to put R3’s MAC address in the header, and to do that, R1 uses its IP ARP table information, as shown in Figure 16-9.|R1 должен поместить MAC-адрес R3 в заголовок, и для этого R1 использует информацию из своей таблицы IP ARP, как показано на рисунке 16-9.
If R1 did not have an ARP table entry for 172.16.5.3, R1 would first have to use ARP to learn the matching MAC address.|Если бы R1 не имел записи таблицы ARP для 172.16.5.3, R1 сначала должен был бы использовать ARP, чтобы узнать соответствующий MAC-адрес.
|
Figure 16-9 Routing Step 4 on Router R1 with a LAN Outgoing Interface|Рисунок 16-9 Шаг 4 маршрутизации на маршрутизаторе R1 с исходящим интерфейсом LAN
##### Routing Step 5: Transmitting the Frame
Шаг 5: передача кадра   
__|__
--|--
|
After the frame has been prepared, the router simply needs to transmit the frame.|После того, как кадр был подготовлен, маршрутизатору просто нужно передать кадр.
The router might have to wait, particularly if other frames are already waiting their turn to exit the interface.|Маршрутизатору, возможно, придется подождать, особенно если другие фреймы уже ожидают своей очереди для выхода из интерфейса.
### Configuring IP Addresses and Connected Routes
Настройка IP-адресов и подключенных маршрутов   
__|__
--|--
|
Cisco routers enable IPv4 routing globally, by default.|Маршрутизаторы Cisco по умолчанию включают глобальную маршрутизацию IPv4.
Then, to make the router be ready to route packets on a particular interface, the interface must be configured with an IP address and the interface must be configured such that it comes up, reaching a “line status up, line protocol up”|Затем, чтобы маршрутизатор был готов маршрутизировать пакеты на конкретном интерфейсе, интерфейс должен быть настроен с IP-адресом, а интерфейс должен быть настроен так, чтобы он появлялся, достигая «состояние линии вверх, протокол линии вверх»
|
state.|штат.
Only at that point can routers route IP packets in and out a particular interface.|Только в этот момент маршрутизаторы могут маршрутизировать IP-пакеты в конкретный интерфейс и исходить из него.
|
After a router can route IP packets out one or more interfaces, the router needs some routes.|После того, как маршрутизатор сможет направлять IP-пакеты через один или несколько интерфейсов, маршрутизатору требуются некоторые маршруты.
|
Routers can add routes to their routing tables through three methods:|Маршрутизаторы могут добавлять маршруты в свои таблицы маршрутизации тремя способами:
|
Connected routes: Added because of the configuration of the ip address interface subcommand on the local router Static routes: Added because of the configuration of the ip route global command on the local router Routing protocols: Added as a function by configuration on all routers, resulting in a process by which routers dynamically tell each other about the network so that they all learn routes This second of three sections discusses several variations on how to configure connected routes, while the next major section discusses static routes.|Подключенные маршруты: добавлены из-за настройки подкоманды интерфейса ip-адреса на локальном маршрутизаторе Статические маршруты: добавлены из-за настройки глобальной команды ip route на локальном маршрутизаторе Протоколы маршрутизации: добавлены как функция путем настройки на всех маршрутизаторах, в результате в процессе, посредством которого маршрутизаторы динамически сообщают друг другу о сети, чтобы все они изучали маршруты. Во втором из трех разделов обсуждаются несколько вариантов настройки подключенных маршрутов, а в следующем основном разделе обсуждаются статические маршруты.
#### Connected Routes and the ip address Command
Connected Routes and the ip address Command   
__|__
--|--
|
A Cisco router automatically adds a route to its routing table for the subnet connected to each interface, assuming that the following two facts are true:|A Cisco router automatically adds a route to its routing table for the subnet connected to each interface, assuming that the following two facts are true:
###### The interface is in a working state. In other words, the interface status in the show
Интерфейс в рабочем состоянии. Другими словами, статус интерфейса в шоу   
__|__
--|--
|
interfaces command lists a line status of up and a protocol status of up.|Команда interfaces отображает состояние линии «Вкл.» и состояние протокола «Вкл.».
###### The interface has an IP address assigned through the ip address interface subcommand.
The interface has an IP address assigned through the ip address interface subcommand.   
__|__
--|--
|
The concept of connected routes is relatively basic.|The concept of connected routes is relatively basic.
The router, of course, needs to know the subnet number connected to each of its interfaces, so the router can route packets to that subnet.|The router, of course, needs to know the subnet number connected to each of its interfaces, so the router can route packets to that subnet.
The router does the math, taking the interface IP address and mask and calculating the subnet ID. However, the router only needs that route when the interface is up and working, so the router includes a connected route in the routing table only when the interface is working.|The router does the math, taking the interface IP address and mask and calculating the subnet ID. However, the router only needs that route when the interface is up and working, so the router includes a connected route in the routing table only when the interface is working.
|
Example 16-1 shows the connected routes on Router R1 in Figure 16-10.|Example 16-1 shows the connected routes on Router R1 in Figure 16-10.
The first part of the example shows the configuration of IP addresses on all three of R1’s interfaces.|The first part of the example shows the configuration of IP addresses on all three of R1’s interfaces.
The end of the example lists the output from the show ip route command, which lists these routes with a c as the route code, meaning connected.|The end of the example lists the output from the show ip route command, which lists these routes with a c as the route code, meaning connected.
|
Figure 16-10 Sample Network to Show Connected Routes Example 16-1 Connected and Local Routes on Router R1 Example end.|Figure 16-10 Sample Network to Show Connected Routes Example 16-1 Connected and Local Routes on Router R1 Example end.
|
Take a moment to look closely at each of the three highlighted routes in the output of show ip route.|Take a moment to look closely at each of the three highlighted routes in the output of show ip route.
Each lists a C in the first column, and each has text that says “directly connected”;|Each lists a C in the first column, and each has text that says “directly connected”;
|
both identify the route as connected to the router.|both identify the route as connected to the router.
The early part of each route lists the matching parameters (subnet ID and mask), as shown in the earlier example in Figure 16-7.|The early part of each route lists the matching parameters (subnet ID and mask), as shown in the earlier example in Figure 16-7.
|
The end of each of these routes lists the outgoing interface.|The end of each of these routes lists the outgoing interface.
|
Note that the router also automatically produces a different kind of route, called a local route.|Note that the router also automatically produces a different kind of route, called a local route.
The local routes define a route for the one specific IP address configured on the router interface.|The local routes define a route for the one specific IP address configured on the router interface.
Each local route has a /32 prefix length, defining a host route, which defines a route just for that one IP address.|Each local route has a /32 prefix length, defining a host route, which defines a route just for that one IP address.
For example, the last local route, for 172.16.5.1/32, defines a route that matches only the IP address of 172.16.5.1.|For example, the last local route, for 172.16.5.1/32, defines a route that matches only the IP address of 172.16.5.1.
Routers use these local routes that list their own local IP addresses to more efficiently forward packets sent to the router itself.|Routers use these local routes that list their own local IP addresses to more efficiently forward packets sent to the router itself.
|
For the CCNA 200-301 exam, note that this example of the show ip route command reveals a few of the specific subitems within exam topic 3.1, with later examples revealing even more details.|For the CCNA 200-301 exam, note that this example of the show ip route command reveals a few of the specific subitems within exam topic 3.1, with later examples revealing even more details.
This section shows details related to the following terms from the exam topics:|This section shows details related to the following terms from the exam topics:
###### Routing Protocol Code: The legend at the top of the show ip route output (about nine
Код протокола маршрутизации: легенда в верхней части выходных данных show ip route (около девяти   
__|__
--|--
|
lines) lists all the routing protocol codes (exam topic 3.1.a).|lines) содержит список всех кодов протоколов маршрутизации (тема экзамена 3.1.a).
This book references the codes for connected routes (C), local (L), static (S), and OSPF (O).|В этой книге приведены коды для подключенных маршрутов (C), локальных (L), статических (S) и OSPF (O).
###### Prefix: The word prefix (exam topic 3.1.b) is just another name for subnet ID.
Prefix: The word prefix (exam topic 3.1.b) is just another name for subnet ID.   
###### Mask: Each route lists a prefix (subnet ID) and network mask (exam topic 3.1.c) in prefix
Mask: Each route lists a prefix (subnet ID) and network mask (exam topic 3.1.c) in prefix   
__|__
--|--
|
format, for example, /24.|format, for example, /24.
#### The ARP Table on a Cisco Router
The ARP Table on a Cisco Router   
__|__
--|--
|
After a router has added these connected routes, the router can route IPv4 packets between those subnets.|After a router has added these connected routes, the router can route IPv4 packets between those subnets.
To do so, the router makes use of its IP ARP table.|To do so, the router makes use of its IP ARP table.
|
The IPv4 ARP table lists the IPv4 address and matching MAC address of hosts connected to the same subnet as the router.|The IPv4 ARP table lists the IPv4 address and matching MAC address of hosts connected to the same subnet as the router.
When forwarding a packet to a host on the same subnet, the router encapsulates the packet, with a destination MAC address as found in the ARP table.|When forwarding a packet to a host on the same subnet, the router encapsulates the packet, with a destination MAC address as found in the ARP table.
|
If the router wants to forward a packet to an IP address on the same subnet as the router but does not find an ARP table entry for that IP address, the router will use ARP messages to learn that device’s MAC address.|If the router wants to forward a packet to an IP address on the same subnet as the router but does not find an ARP table entry for that IP address, the router will use ARP messages to learn that device’s MAC address.
|
Example 16-2 shows R1’s ARP table based on the previous example.|Example 16-2 shows R1’s ARP table based on the previous example.
The output lists R1’s own IP address of 172.16.1.1, with an age of -, meaning that this entry does not time out.|The output lists R1’s own IP address of 172.16.1.1, with an age of -, meaning that this entry does not time out.
Dynamically learned ARP table entries have an upward counter, like the 35-minute value for the ARP table entry for IP address 172.16.1.9.|Dynamically learned ARP table entries have an upward counter, like the 35-minute value for the ARP table entry for IP address 172.16.1.9.
By default, IOS will time out (remove) an ARP table entry after 240 minutes in which the entry is not used. (IOS resets the timer to 0 when an ARP table entry is used.) Note that to experiment in the lab, you might want to empty all dynamic entries (or a single entry for one IP address) using the clear ip arp [ip-address] EXEC command.|By default, IOS will time out (remove) an ARP table entry after 240 minutes in which the entry is not used. (IOS resets the timer to 0 when an ARP table entry is used.) Note that to experiment in the lab, you might want to empty all dynamic entries (or a single entry for one IP address) using the clear ip arp [ip-address] EXEC command.
|
Example 16-2 Displaying a Router’s IP ARP Table Example end.|Example 16-2 Displaying a Router’s IP ARP Table Example end.
|
Thinking about how Router R1 forwards a packet to host A (172.16.1.9), over that final subnet, R1 does the following:|Thinking about how Router R1 forwards a packet to host A (172.16.1.9), over that final subnet, R1 does the following:
|
1. R1 looks in its ARP table for an entry for 172.16.1.9.|1. R1 looks in its ARP table for an entry for 172.16.1.9.
|
2. R1 encapsulates the IP packet in an Ethernet frame, adding destination 0200.3333.3333 to the Ethernet header (as taken from the ARP table).|2. R1 encapsulates the IP packet in an Ethernet frame, adding destination 0200.3333.3333 to the Ethernet header (as taken from the ARP table).
|
3. R1 transmits the frame out interface G0/0.|3. R1 transmits the frame out interface G0/0.
### Configuring Static Routes
Настройка статических маршрутов   
__|__
--|--
|
All routers add connected routes, as discussed in the previous section.|Все маршрутизаторы добавляют подключенные маршруты, как обсуждалось в предыдущем разделе.
Then, most networks use dynamic routing protocols to cause each router to learn the rest of the routes in an internetwork.|Затем в большинстве сетей используются протоколы динамической маршрутизации, чтобы каждый маршрутизатор узнал остальные маршруты в объединенной сети.
Networks use static routes—routes added to a routing table through direct configuration—much less often than dynamic routing.|Сети используют статические маршруты - маршруты, добавленные в таблицу маршрутизации посредством прямой конфигурации - гораздо реже, чем динамическая маршрутизация.
However, static routes can be useful at times, and they happen to be useful learning tools as well.|Однако статические маршруты иногда могут быть полезны, и они также могут быть полезными инструментами обучения.
This next major section in the chapter discusses static routes.|В следующем главном разделе главы обсуждаются статические маршруты.
|
NOTE The CCNA 200-301 exam topic 3.2 breaks IPv4 (and IPv6) static routes into four subtopics: network routes, host routes, floating static routes, and default routes.|ПРИМЕЧАНИЕ В теме 3.2 экзамена CCNA 200-301 статические маршруты IPv4 (и IPv6) разбиты на четыре подтемы: сетевые маршруты, маршруты хоста, плавающие статические маршруты и маршруты по умолчанию.
This section explains all four types as noted in the upcoming headings.|В этом разделе описаны все четыре типа, указанные в следующих заголовках.
#### Static Network Routes
Static Network Routes   
__|__
--|--
|
IOS allows the definition of individual static routes using the ip route global configuration command.|IOS allows the definition of individual static routes using the ip route global configuration command.
Every ip route command defines a destination that can be matched, usually with a subnet ID and mask.|Every ip route command defines a destination that can be matched, usually with a subnet ID and mask.
The command also lists the forwarding instructions, typically listing either the outgoing interface or the next-hop router’s IP address.|The command also lists the forwarding instructions, typically listing either the outgoing interface or the next-hop router’s IP address.
IOS then takes that information and adds that route to the IP routing table.|IOS then takes that information and adds that route to the IP routing table.
|
The static route is considered a network route when the destination listed in the ip route command defines a subnet, or an entire Class A, B, or C network.|The static route is considered a network route when the destination listed in the ip route command defines a subnet, or an entire Class A, B, or C network.
In contrast, a default route matches all destination IP addresses, while a host route matches a single IP address (that is, an address of one host.)|In contrast, a default route matches all destination IP addresses, while a host route matches a single IP address (that is, an address of one host.)
|
As an example of a network route, Figure 16-11 shows a subset of the figure used throughout this chapter so far, with some unrelated details removed.|As an example of a network route, Figure 16-11 shows a subset of the figure used throughout this chapter so far, with some unrelated details removed.
The figure shows only the details related to a static network route on R1, for destination subnet 172.16.2.0/24, which sits on the far right.|The figure shows only the details related to a static network route on R1, for destination subnet 172.16.2.0/24, which sits on the far right.
To create that static network route on R1, R1 will configure the subnet ID and mask, and either R1’s outgoing interface (S0/0/0) or R2 as the next-hop router IP address (172.16.4.2).|To create that static network route on R1, R1 will configure the subnet ID and mask, and either R1’s outgoing interface (S0/0/0) or R2 as the next-hop router IP address (172.16.4.2).
|
Figure 16-11 Static Route Configuration Concept Example 16-3 shows the configuration of a couple of sample static routes.|Figure 16-11 Static Route Configuration Concept Example 16-3 shows the configuration of a couple of sample static routes.
In particular, it shows routes on Router R1 in Figure 16-12, for the two subnets on the right side of the figure.|In particular, it shows routes on Router R1 in Figure 16-12, for the two subnets on the right side of the figure.
|
Figure 16-12 Sample Network Used in Static Route Configuration Examples Example 16-3 Static Routes Added to R1 Example end.|Figure 16-12 Sample Network Used in Static Route Configuration Examples Example 16-3 Static Routes Added to R1 Example end.
|
The two example ip route commands show the two different styles of forwarding instructions.|The two example ip route commands show the two different styles of forwarding instructions.
|
The first command shows subnet 172.16.2.0, mask 255.255.255.0, which sits on a LAN near Router R2. That same first command lists R1’s S0/0/0 interface as the outgoing interface.|The first command shows subnet 172.16.2.0, mask 255.255.255.0, which sits on a LAN near Router R2. That same first command lists R1’s S0/0/0 interface as the outgoing interface.
|
This route basically states: To send packets to the subnet off Router R2, send them out my own local S0/0/0 interface (which happens to connect to R2).|This route basically states: To send packets to the subnet off Router R2, send them out my own local S0/0/0 interface (which happens to connect to R2).
|
The second route has the same kind of logic, except for using different forwarding instructions.|The second route has the same kind of logic, except for using different forwarding instructions.
|
Instead of referencing R1’s outgoing interface, it instead lists the neighboring router’s IP address on the WAN link as the next-hop router.|Instead of referencing R1’s outgoing interface, it instead lists the neighboring router’s IP address on the WAN link as the next-hop router.
This route basically says this: To send packets to the subnet off Router R3, send them to R3—specifically, R3’s WAN IP address next.|This route basically says this: To send packets to the subnet off Router R3, send them to R3—specifically, R3’s WAN IP address next.
|
The routes created by these two ip route commands actually look a little different in the IP routing table compared to each other.|The routes created by these two ip route commands actually look a little different in the IP routing table compared to each other.
Both are static routes.|Both are static routes.
However, the route that used the outgoing interface configuration is also noted as a connected route; this is just a quirk of the output of the show ip route command.|However, the route that used the outgoing interface configuration is also noted as a connected route; this is just a quirk of the output of the show ip route command.
|
Example 16-4 lists these two routes using the show ip route static command.|Example 16-4 lists these two routes using the show ip route static command.
This command lists the details of static routes only, but it also lists a few statistics about all IPv4 routes.|This command lists the details of static routes only, but it also lists a few statistics about all IPv4 routes.
For example, the example shows two lines, for the two static routes configured in Example 16-4, but statistics state that this router has routes for eight subnets.|For example, the example shows two lines, for the two static routes configured in Example 16-4, but statistics state that this router has routes for eight subnets.
|
Example 16-4 Static Routes Added to R1 Example end.|Example 16-4 Static Routes Added to R1 Example end.
|
IOS adds and removes these static routes dynamically over time, based on whether the outgoing interface is working or not.|IOS adds and removes these static routes dynamically over time, based on whether the outgoing interface is working or not.
For example, in this case, if R1’s S0/0/0 interface fails, R1 removes the static route to 172.16.2.0/24 from the IPv4 routing table.|For example, in this case, if R1’s S0/0/0 interface fails, R1 removes the static route to 172.16.2.0/24 from the IPv4 routing table.
Later, when the interface comes up again, IOS adds the route back to the routing table.|Later, when the interface comes up again, IOS adds the route back to the routing table.
|
Note that most sites use a dynamic routing protocol to learn all the routes to remote subnets rather than using static routes.|Note that most sites use a dynamic routing protocol to learn all the routes to remote subnets rather than using static routes.
However, when not using a dynamic routing protocol, the engineer would need to configure static routes to each subnet on each router.|However, when not using a dynamic routing protocol, the engineer would need to configure static routes to each subnet on each router.
For example, if the routers had only the configuration shown in the examples so far, PC A (from Figure 16-12) would not be able to receive packets back from PC B because Router R2 does not have a route for PC A’s subnet.|For example, if the routers had only the configuration shown in the examples so far, PC A (from Figure 16-12) would not be able to receive packets back from PC B because Router R2 does not have a route for PC A’s subnet.
R2 would need static routes for other subnets, as would R3.|R2 would need static routes for other subnets, as would R3.
|
Finally, note that static routes that will send packets out an Ethernet interface—LAN or WAN—should use the next-hop IP address option on the ip address command, as shown in Example 16-4.|Finally, note that static routes that will send packets out an Ethernet interface—LAN or WAN—should use the next-hop IP address option on the ip address command, as shown in Example 16-4.
Routers expect their Ethernet interfaces to be able to reach any number of other IP addresses in the connected subnet.|Routers expect their Ethernet interfaces to be able to reach any number of other IP addresses in the connected subnet.
Referencing the next-hop router identifies the specific device in the connected subnet, while referencing the local router’s outgoing interface does not identify the specific neighboring router.|Referencing the next-hop router identifies the specific device in the connected subnet, while referencing the local router’s outgoing interface does not identify the specific neighboring router.
#### Static Host Routes
Static Host Routes   
__|__
--|--
|
Earlier, this chapter defined a host route as a route to a single host address.|Earlier, this chapter defined a host route as a route to a single host address.
To configure such a static route, the ip route command uses an IP address plus a mask of 255.255.255.255 so that the matching logic matches just that one address.|To configure such a static route, the ip route command uses an IP address plus a mask of 255.255.255.255 so that the matching logic matches just that one address.
|
An engineer might use host routes to direct packets sent to one host over one path, with all other traffic to that host’s subnet over some other path.|An engineer might use host routes to direct packets sent to one host over one path, with all other traffic to that host’s subnet over some other path.
For instance, you could define these two static routes for subnet 10.1.1.0/24 and host 10.1.1.9, with two different next-hop addresses, as follows:|For instance, you could define these two static routes for subnet 10.1.1.0/24 and host 10.1.1.9, with two different next-hop addresses, as follows:
|
ip route 10.1.1.0 255.255.255.0 10.2.2.2 ip route 10.1.1.9 255.255.255.255 10.9.9.9 Note that these two routes overlap: a packet sent to 10.1.1.9 that arrives at the router would match both routes.|ip route 10.1.1.0 255.255.255.0 10.2.2.2 ip route 10.1.1.9 255.255.255.255 10.9.9.9 Note that these two routes overlap: a packet sent to 10.1.1.9 that arrives at the router would match both routes.
When that happens, routers use the most specific route (that is, the route with the longest prefix length).|When that happens, routers use the most specific route (that is, the route with the longest prefix length).
So, a packet sent to 10.1.1.9 would be forwarded to next-hop router 10.9.9.9, and packets sent to other destinations in subnet 10.1.1.0/24 would be sent to next-hop router 10.2.2.2.|So, a packet sent to 10.1.1.9 would be forwarded to next-hop router 10.9.9.9, and packets sent to other destinations in subnet 10.1.1.0/24 would be sent to next-hop router 10.2.2.2.
|
Note that the section “IP Forwarding with the Longest Prefix Match” later in this chapter gets into this topic in more detail.|Note that the section “IP Forwarding with the Longest Prefix Match” later in this chapter gets into this topic in more detail.
#### Floating Static Routes
Floating Static Routes   
__|__
--|--
|
Next, consider the case in which a static route competes with other static routes or routes learned by a routing protocol.|Next, consider the case in which a static route competes with other static routes or routes learned by a routing protocol.
That is, the ip route command defines a route to a subnet, but the router also knows of other static or dynamically learned routes to reach that same subnet.|That is, the ip route command defines a route to a subnet, but the router also knows of other static or dynamically learned routes to reach that same subnet.
In these cases, the router must first decide which routing source has the better administrative distance, with lower being better, and then use the route learned from the better source.|In these cases, the router must first decide which routing source has the better administrative distance, with lower being better, and then use the route learned from the better source.
|
To see how that works, consider the example illustrated in Figure 16-13, which shows a different design than in the previous examples, this time with a branch office with two WAN links: one very fast Gigabit Ethernet link and one rather slow (but cheap) T1. In this design, the network uses Open Shortest Path First Version 2 (OSPFv2) over the primary link, learning a route for subnet 172.16.2.0/24.|To see how that works, consider the example illustrated in Figure 16-13, which shows a different design than in the previous examples, this time with a branch office with two WAN links: one very fast Gigabit Ethernet link and one rather slow (but cheap) T1. In this design, the network uses Open Shortest Path First Version 2 (OSPFv2) over the primary link, learning a route for subnet 172.16.2.0/24.
R1 also defines a static route over the backup link to that exact same subnet, so R1 must choose whether to use the static route or the OSPFlearned route.|R1 also defines a static route over the backup link to that exact same subnet, so R1 must choose whether to use the static route or the OSPFlearned route.
|
Figure 16-13 Using a Floating Static Route to Key Subnet 172.16.2.0/24 By default, IOS considers static routes better than OSPF-learned routes.|Figure 16-13 Using a Floating Static Route to Key Subnet 172.16.2.0/24 By default, IOS considers static routes better than OSPF-learned routes.
By default, IOS gives static routes an administrative distance of 1 and OSPF routes an administrative distance of 110.|By default, IOS gives static routes an administrative distance of 1 and OSPF routes an administrative distance of 110.
Using these defaults in Figure 16-13, R1 would use the T1 to reach subnet 172.16.2.0/24 in this case, which is not the intended design.|Using these defaults in Figure 16-13, R1 would use the T1 to reach subnet 172.16.2.0/24 in this case, which is not the intended design.
Instead, the engineer prefers to use the OSPFlearned routes over the much-faster primary link and use the static route over the backup link only as needed when the primary link fails.|Instead, the engineer prefers to use the OSPFlearned routes over the much-faster primary link and use the static route over the backup link only as needed when the primary link fails.
|
To instead prefer the OSPF routes, the configuration would need to change the administrative distance settings and use what many networkers call a floating static route.|To instead prefer the OSPF routes, the configuration would need to change the administrative distance settings and use what many networkers call a floating static route.
A floating static route floats or moves into and out of the IP routing table depending on whether the better (lower) administrative distance route learned by the routing protocol happens to exist currently.|A floating static route floats or moves into and out of the IP routing table depending on whether the better (lower) administrative distance route learned by the routing protocol happens to exist currently.
Basically, the router ignores the static route during times when the better routing protocol route is known.|Basically, the router ignores the static route during times when the better routing protocol route is known.
|
To implement a floating static route, you need to use a parameter on the ip route command that sets the administrative distance for just that route, making the value larger than the default administrative distance of the routing protocol.|To implement a floating static route, you need to use a parameter on the ip route command that sets the administrative distance for just that route, making the value larger than the default administrative distance of the routing protocol.
For example, the ip route 172.16.2.0 255.255.255.0 172.16.5.3 130 command on R1 would do exactly that—setting the static route’s administrative distance to 130.|For example, the ip route 172.16.2.0 255.255.255.0 172.16.5.3 130 command on R1 would do exactly that—setting the static route’s administrative distance to 130.
As long as the primary link stays up, and OSPF on R1 learns a route for 172.16.2.0/24, with a default administrative distance of 110, R1 ignores the static route.|As long as the primary link stays up, and OSPF on R1 learns a route for 172.16.2.0/24, with a default administrative distance of 110, R1 ignores the static route.
|
Finally, note that while the show ip route command lists the administrative distance of most routes, as the first of two numbers inside two brackets, the show ip route subnet command plainly lists the administrative distance.|Finally, note that while the show ip route command lists the administrative distance of most routes, as the first of two numbers inside two brackets, the show ip route subnet command plainly lists the administrative distance.
Example 16-5 shows a sample, matching this most recent example.|Example 16-5 shows a sample, matching this most recent example.
|
Example 16-5 Displaying the Administrative Distance of the Static Route Example end.|Example 16-5 Displaying the Administrative Distance of the Static Route Example end.
#### Static Default Routes
Статические маршруты по умолчанию   
__|__
--|--
|
When a router tries to route a packet, the router might not match the packet’s destination IP address with any route.|Когда маршрутизатор пытается направить пакет, он может не сопоставить IP-адрес назначения пакета с каким-либо маршрутом.
When that happens, the router normally just discards the packet.|Когда это происходит, маршрутизатор обычно просто отбрасывает пакет.
|
Routers can be configured so that they use either a statically configured or dynamically learned default route.|Маршрутизаторы можно настроить так, чтобы они использовали статически настроенный или динамически полученный маршрут по умолчанию.
The default route matches all packets, so that if a packet does not match any other more specific route in the routing table, the router can at least forward the packet based on the default route.|Маршрут по умолчанию соответствует всем пакетам, поэтому, если пакет не соответствует какому-либо другому более конкретному маршруту в таблице маршрутизации, маршрутизатор может, по крайней мере, переслать пакет на основе маршрута по умолчанию.
|
One classic example in which companies might use static default routes in their enterprise TCP/IP networks is when the company has many remote sites, each with a single, relatively slow WAN connection.|Один классический пример, в котором компании могут использовать статические маршруты по умолчанию в своих корпоративных сетях TCP / IP, - это когда у компании есть много удаленных сайтов, каждый из которых имеет одно относительно медленное соединение WAN.
Each remote site has only one possible physical route to use to send packets to the rest of the network.|У каждого удаленного сайта есть только один возможный физический маршрут, который можно использовать для отправки пакетов в остальную сеть.
So, rather than use a routing protocol, which sends messages over the WAN and uses precious WAN bandwidth, each remote router might use a default route that sends all traffic to the central site, as shown in Figure 16-14.|Таким образом, вместо использования протокола маршрутизации, который отправляет сообщения по глобальной сети и использует драгоценную полосу пропускания глобальной сети, каждый удаленный маршрутизатор может использовать маршрут по умолчанию, который отправляет весь трафик на центральный сайт, как показано на рисунке 16-14.
|
S0/0/1 ....|S0 / 0/1 ....
|
Figure 16-14 Example Use of Static Default Routes at 1000 Low-Speed Remote Sites IOS allows the configuration of a static default route by using special values for the subnet and mask fields in the ip route command: 0.0.0.0 and 0.0.0.0.|Рисунок 16-14 Пример использования статических маршрутов по умолчанию на 1000 низкоскоростных удаленных узлах IOS позволяет настраивать статический маршрут по умолчанию, используя специальные значения для полей подсети и маски в команде ip route: 0.0.0.0 и 0.0.0.0.
For example, the command ip route 0.0.0.0 0.0.0.0 S0/0/1 creates a static default route on Router B1—a route that matches all IP packets—and sends those packets out interface S0/0/1.|Например, команда ip route 0.0.0.0 0.0.0.0 S0 / 0/1 создает статический маршрут по умолчанию на маршрутизаторе B1 - маршрут, который соответствует всем IP-пакетам - и отправляет эти пакеты через интерфейс S0 / 0/1.
|
Example 16-6 shows an example of a static default route, using Router R2 from Figure 16-13.|В примере 16-6 показан пример статического маршрута по умолчанию с использованием маршрутизатора R2 с рисунка 16-13.
Earlier, that figure, along with Example 16-5, showed R1 with static routes to the two subnets on the right side of the figure.|Ранее на этом рисунке вместе с примером 16-5 был показан маршрутизатор R1 со статическими маршрутами к двум подсетям в правой части рисунка.
Example 16-6 completes the configuration of static IP routes by configuring R2, on the right side of Figure 16-13, with a static default route to route packets back to the routers on the left side of the figure.|Пример 16-6 завершает настройку статических IP-маршрутов путем настройки R2 в правой части рисунка 16-13 со статическим маршрутом по умолчанию для маршрутизации пакетов обратно к маршрутизаторам в левой части рисунка.
|
Example 16-6 Adding a Static Default Route on R2 (Figure 16-13)|Пример 16-6 Добавление статического маршрута по умолчанию на R2 (рисунок 16-13)
|
Example end.|Пример конец.
|
The output of the show ip route command lists a few new and interesting facts.|Вывод команды show ip route содержит несколько новых и интересных фактов.
First, it lists the route with a code of S, meaning static, but also with a 1, meaning it is a candidate default route.|Во-первых, он перечисляет маршрут с кодом S, что означает статический, но также и с 1, что означает, что это маршрут-кандидат по умолчанию.
A router can learn about more than one default route, and the router then has to choose which one to use; the 1 means that it is at least a candidate to become the default route.|Маршрутизатор может узнать о нескольких маршрутах по умолчанию, и затем маршрутизатор должен выбрать, какой из них использовать; 1 означает, что это, по крайней мере, кандидат на то, чтобы стать маршрутом по умолчанию.
Just above, the “Gateway of Last Resort” refers to the chosen default route, which in this case is the just-configured static route with outgoing interface S0/0/1.|Чуть выше «шлюз последней надежды» относится к выбранному маршруту по умолчанию, который в данном случае является только что настроенным статическим маршрутом с исходящим интерфейсом S0 / 0/1.
#### Troubleshooting Static Routes
Troubleshooting Static Routes   
__|__
--|--
|
These final few pages about IPv4 static routes examine some issues that can occur with static routes, both reviewing some reasons mentioned over the last few pages, while adding more detail.|These final few pages about IPv4 static routes examine some issues that can occur with static routes, both reviewing some reasons mentioned over the last few pages, while adding more detail.
This topic breaks static route troubleshooting into three perspectives:|This topic breaks static route troubleshooting into three perspectives:
###### The route is in the routing table but is incorrect.
Маршрут указан в таблице маршрутизации, но неверен.   
###### The route is not in the routing table.
Маршрута нет в таблице маршрутизации.   
###### The route is in the routing table and is correct, but the packets do not arrive at the destination
Маршрут указан в таблице маршрутизации и правильный, но пакеты не достигают места назначения.   
__|__
--|--
|
host.|хост.
##### Troubleshooting Incorrect Static Routes That Appear in the IP Routing Table
Troubleshooting Incorrect Static Routes That Appear in the IP Routing Table   
__|__
--|--
|
This first troubleshooting item can be obvious, but it is worth pausing to think about.|This first troubleshooting item can be obvious, but it is worth pausing to think about.
A static route is only as good as the input typed into the ip route command.|A static route is only as good as the input typed into the ip route command.
IOS checks the syntax, and as mentioned earlier, makes a few other checks that this section reviews in the next heading.|IOS checks the syntax, and as mentioned earlier, makes a few other checks that this section reviews in the next heading.
But once those checks are passed, IOS puts the route into the IP routing table, even if the route had poorly chosen parameters.|But once those checks are passed, IOS puts the route into the IP routing table, even if the route had poorly chosen parameters.
|
For instance, the route might use a subnet and mask that implies a different range of addresses than the addresses in the destination subnet.|For instance, the route might use a subnet and mask that implies a different range of addresses than the addresses in the destination subnet.
Or, for a router sitting in the middle of a diagram, the next-hop address might be a router to the left, while the destination subnet is to the right.|Or, for a router sitting in the middle of a diagram, the next-hop address might be a router to the left, while the destination subnet is to the right.
Or the next-hop address could be an IP address in a connected subnet, but it might be a typo and be an address of a PC or even a currently unused IP address.|Or the next-hop address could be an IP address in a connected subnet, but it might be a typo and be an address of a PC or even a currently unused IP address.
|
When you see an exam question that has static routes, and you see them in the output of show ip route, remember to check on these items:|When you see an exam question that has static routes, and you see them in the output of show ip route, remember to check on these items:
###### Is there a subnetting math error in the subnet ID and mask?
Is there a subnetting math error in the subnet ID and mask?   
###### Is the next-hop IP address correct and referencing an IP address on a neighboring router?
Is the next-hop IP address correct and referencing an IP address on a neighboring router?   
###### Does the next-hop IP address identify the correct router?
Does the next-hop IP address identify the correct router?   
###### Is the outgoing interface correct, and referencing an interface on the local router (that is,
Is the outgoing interface correct, and referencing an interface on the local router (that is,   
__|__
--|--
|
the same router where the static route is configured)?|the same router where the static route is configured)?
##### The Static Route Does Not Appear in the IP Routing Table
Статический маршрут не отображается в таблице IP-маршрутизации   
__|__
--|--
|
After configuring an ip route command, IOS might or might not add the route to the IP routing table.|После настройки команды ip route IOS может добавлять или не добавлять маршрут в таблицу IP-маршрутизации.
IOS also considers the following before adding the route to its routing table:|IOS также учитывает следующее перед добавлением маршрута в свою таблицу маршрутизации:
###### For ip route commands that list an outgoing interface, that interface must be in an up/up
Для команд ip route, которые перечисляют исходящий интерфейс, этот интерфейс должен быть в восходящем / восходящем   
__|__
--|--
|
state.|штат.
###### For ip route commands that list a next-hop IP address, the local router must have a route
For ip route commands that list a next-hop IP address, the local router must have a route   
__|__
--|--
|
to reach that next-hop address.|to reach that next-hop address.
|
For example, earlier in Example 16-3, R1’s command ip route 172.16.3.0 255.255.255.0 172.16.5.3 defines a static route.|For example, earlier in Example 16-3, R1’s command ip route 172.16.3.0 255.255.255.0 172.16.5.3 defines a static route.
Before adding the route to the IP routing table, R1 looks for an existing IP route to reach 172.16.5.3.|Before adding the route to the IP routing table, R1 looks for an existing IP route to reach 172.16.5.3.
In that case, R1 will find a connected route for subnet 172.16.5.0/24 as long as its Ethernet WAN link is up.|In that case, R1 will find a connected route for subnet 172.16.5.0/24 as long as its Ethernet WAN link is up.
As a result, R1 adds the static route to subnet 172.16.3.0/24.|As a result, R1 adds the static route to subnet 172.16.3.0/24.
Later, if R1’s G0/1/0 were to fail, R1 would remove its connected route to 172.16.5.0/24 from the IP routing table—an action that would also then cause R1 to remove its static route to 172.16.3.0/24.|Later, if R1’s G0/1/0 were to fail, R1 would remove its connected route to 172.16.5.0/24 from the IP routing table—an action that would also then cause R1 to remove its static route to 172.16.3.0/24.
|
You can configure a static route so that IOS ignores these basic checks, always putting the IP route in the routing table.|You can configure a static route so that IOS ignores these basic checks, always putting the IP route in the routing table.
To do so, just use the permanent keyword on the ip route command.|To do so, just use the permanent keyword on the ip route command.
|
For example, by adding the permanent keyword to the end of the two commands as demonstrated in Example 16-7, R1 would now add these routes, regardless of whether the two WAN links were up.|For example, by adding the permanent keyword to the end of the two commands as demonstrated in Example 16-7, R1 would now add these routes, regardless of whether the two WAN links were up.
|
Example 16-7 Permanently Adding Static Routes to the IP Routing Table (Router R1)|Example 16-7 Permanently Adding Static Routes to the IP Routing Table (Router R1)
|
Example end.|Example end.
|
Note that although the permanent keyword lets the router keep the route in the routing table without checking the outgoing interface or route to the next-hop address, it does not magically fix a broken route.|Note that although the permanent keyword lets the router keep the route in the routing table without checking the outgoing interface or route to the next-hop address, it does not magically fix a broken route.
For example, if the outgoing interface fails, the route will remain in the routing table, but the router cannot forward packets because the outgoing interface is down.|For example, if the outgoing interface fails, the route will remain in the routing table, but the router cannot forward packets because the outgoing interface is down.
##### The Correct Static Route Appears but Works Poorly
The Correct Static Route Appears but Works Poorly   
__|__
--|--
|
This last section is a place to make two points—one mainstream and one point to review a bit of trivia.|This last section is a place to make two points—one mainstream and one point to review a bit of trivia.
|
First, on the mainstream point, the static route can be perfect, but the packets from one host to the next still might not arrive because of other problems.|First, on the mainstream point, the static route can be perfect, but the packets from one host to the next still might not arrive because of other problems.
An incorrect static route is just one of many items to check when you’re troubleshooting problems like “host A cannot connect to server B.” The root cause may be the static route, or it may be something else.|An incorrect static route is just one of many items to check when you’re troubleshooting problems like “host A cannot connect to server B.” The root cause may be the static route, or it may be something else.
|
Chapter 18, “Troubleshooting IPv4 Routing,” goes into some depth about troubleshooting these types of problems.|Chapter 18, “Troubleshooting IPv4 Routing,” goes into some depth about troubleshooting these types of problems.
|
On the more specific point, be wary of any ip route command with the permanent keyword.|On the more specific point, be wary of any ip route command with the permanent keyword.
|
IOS puts these routes in the routing table with no checks for accuracy.|IOS puts these routes in the routing table with no checks for accuracy.
You should check whether the outgoing interface is down and/or whether the router has a route to reach the next-hop address.|You should check whether the outgoing interface is down and/or whether the router has a route to reach the next-hop address.
### IP Forwarding with the Longest Prefix Match
Пересылка IP с самым длинным совпадением префикса   
__|__
--|--
|
A router’s IP routing process requires that the router compare the destination IP address of each packet with the existing contents of that router’s IP routing table.|Процесс IP-маршрутизации маршрутизатора требует, чтобы маршрутизатор сравнивал IP-адрес назначения каждого пакета с существующим содержимым таблицы IP-маршрутизации этого маршрутизатора.
Often, only one route matches a particular destination address.|Часто только один маршрут соответствует конкретному адресу назначения.
When only one route matches the packet’s destination, the action is obvious: forward the packet based on the details listed in that route.|Когда только один маршрут совпадает с местом назначения пакета, действие очевидно: пересылать пакет на основе деталей, перечисленных в этом маршруте.
|
In some cases, a particular destination address matches more than one of the router’s routes.|В некоторых случаях конкретный адрес назначения совпадает с несколькими маршрутами маршрутизатора.
For instance, one route might list subnet 10.1.0.0/16, another 10.1.1.0/25, and another|Например, один маршрут может содержать подсеть 10.1.0.0/16, другой 10.1.1.0/25 и еще один.
###### 10.1.1.1/32. All would match packets sent to IP address 10.1.1.1. Many legitimate router features
10.1.1.1/32. All would match packets sent to IP address 10.1.1.1. Many legitimate router features   
__|__
--|--
|
can cause these multiple routes to appear in a router’s routing table, including|can cause these multiple routes to appear in a router’s routing table, including
###### Static routes
Static routes   
###### Route autosummarization
Route autosummarization   
###### Manual route summarization
Manual route summarization   
__|__
--|--
|
This fourth of four major sections of this chapter explains how a router makes its routing decisions when a packet matches multiple routes.|This fourth of four major sections of this chapter explains how a router makes its routing decisions when a packet matches multiple routes.
When more than one route matches a packet’s destination address, the router uses the “best” route, defined as follows:|When more than one route matches a packet’s destination address, the router uses the “best” route, defined as follows:
|
When a particular destination IP address matches more than one route in a router’s IPv4 routing table, the router uses the most specific route—in other words, the route with the longest prefix length mask.|When a particular destination IP address matches more than one route in a router’s IPv4 routing table, the router uses the most specific route—in other words, the route with the longest prefix length mask.
#### Using show ip route to Find the Best Route
Использование show ip route для поиска лучшего маршрута   
__|__
--|--
|
We humans have a couple of ways to figure out what choice a router makes for choosing the best route.|У людей есть несколько способов выяснить, какой выбор делает маршрутизатор для выбора наилучшего маршрута.
One way uses the show ip route command, plus some subnetting math, to decide the route the router will choose.|В одном случае используется команда show ip route, а также некоторые математические вычисления для определения маршрута, который выберет маршрутизатор.
To let you see how to use this option, Example 16-8 shows a series of overlapping routes, all created with OSPF, so the output lists only OSPF-learned routes.|Чтобы вы могли увидеть, как использовать эту опцию, в примере 16-8 показана серия перекрывающихся маршрутов, все они созданы с помощью OSPF, поэтому в выходных данных перечислены только маршруты, изученные OSPF.
|
Example 16-8 Show ip route Command with Overlapping Routes Example end.|Пример 16-8 Показать команду ip route с перекрывающимися маршрутами Пример end.
|
To predict which of its routes a router will match, two pieces of information are required: the destination IP address of the packet and the contents of the router’s routing table.|Чтобы предсказать, какой из своих маршрутов будет соответствовать маршрутизатору, необходимы две части информации: IP-адрес назначения пакета и содержимое таблицы маршрутизации маршрутизатора.
The subnet ID and mask listed for a route define the range of addresses matched by that route.|Идентификатор подсети и маска, перечисленные для маршрута, определяют диапазон адресов, соответствующих этому маршруту.
With a little subnetting math, a network engineer can find the range of addresses matched by each route.|С помощью небольшой математической подсети сетевой инженер может найти диапазон адресов, соответствующих каждому маршруту.
For instance, Table 16-2 lists the five subnets listed in Example 16-8 and the address ranges implied by each.|Например, в таблице 16-2 перечислены пять подсетей, перечисленных в примере 16-8, и диапазоны адресов, подразумеваемые каждой из них.
|
Table 16-2 Analysis of Address Ranges for the Subnets in Example 16-8 Table end.|Таблица 16-2. Анализ диапазонов адресов для подсетей в примере 16-8. Конец таблицы.
|
NOTE The route listed as 0.0.0.0/0 is the default route.|ПРИМЕЧАНИЕ Маршрут, указанный как 0.0.0.0/0, является маршрутом по умолчанию.
|
As you can see from these ranges, several of the routes’ address ranges overlap.|Как видно из этих диапазонов, несколько диапазонов адресов маршрутов перекрываются.
When matching more than one route, the route with the longer prefix length is used.|При сопоставлении нескольких маршрутов используется маршрут с большей длиной префикса.
That is, a route with /16 is better than a route with /10; a route with a /25 prefix is better than a route with a /20 prefix; and so on.|То есть маршрут с / 16 лучше, чем маршрут с / 10; маршрут с префиксом / 25 лучше, чем маршрут с префиксом / 20; и так далее.
|
For example, a packet sent to 172.16.1.1 actually matches all five routes listed in the routing table in Example 16-8.|Например, пакет, отправленный на 172.16.1.1, фактически соответствует всем пяти маршрутам, перечисленным в таблице маршрутизации в примере 16-8.
The various prefix lengths range from /0 to /32.|Различные длины префиксов находятся в диапазоне от / 0 до / 32.
The longest prefix (largest /P value, meaning the best and most specific route) is /32.|Самый длинный префикс (наибольшее значение / P, означающий лучший и наиболее конкретный маршрут) - / 32.
So, a packet sent to 172.16.1.1 uses the route to 172.16.1.1/32, and not the other routes.|Таким образом, пакет, отправленный на 172.16.1.1, использует маршрут до 172.16.1.1/32, а не другие маршруты.
|
The following list gives some examples of destination IP addresses.|В следующем списке приведены некоторые примеры IP-адресов назначения.
For each address, the list describes the routes from Table 16-2 that the router would match, and which specific route the router would use.|Для каждого адреса в списке описаны маршруты из Таблицы 16-2, которым будет соответствовать маршрутизатор, и какой конкретный маршрут будет использовать маршрутизатор.
|
172.16.1.1: Matches all five routes; the longest prefix is /32, the route to 172.16.1.1/32.|172.16.1.1: соответствует всем пяти маршрутам; самый длинный префикс / 32, путь к 172.16.1.1/32.
|
172.16.1.2: Matches the last four routes; the longest prefix is /24, the route to 172.16.1.0/24.|172.16.1.2: соответствует последним четырем маршрутам; самый длинный префикс / 24, путь к 172.16.1.0/24.
|
172.16.2.3: Matches the last three routes; the longest prefix is /22, the route to 172.16.0.0/22.|172.16.2.3: соответствует трем последним маршрутам; самый длинный префикс / 22, путь к 172.16.0.0/22.
|
172.16.4.3: Matches the last two routes; the longest prefix is /16, the route to 172.16.0.0/16.|172.16.4.3: соответствует двум последним маршрутам; самый длинный префикс / 16, путь к 172.16.0.0/16.
#### Using show ip route address to Find the Best Route
Использование show ip route address для поиска лучшего маршрута   
__|__
--|--
|
A second way to identify the route a router will use, one that does not require any subnetting math, is the show ip route address command.|Второй способ определения маршрута, который будет использовать маршрутизатор, не требующий математических вычислений, - это команда show ip route address.
The last parameter on this command is the IP address of an assumed IP packet.|Последний параметр в этой команде - IP-адрес предполагаемого IP-пакета.
The router replies by listing the route it would use to route a packet sent to that address.|Маршрутизатор отвечает, перечисляя маршрут, который он будет использовать для маршрутизации пакета, отправленного на этот адрес.
|
For example, Example 16-9 lists the output of the show ip route 172.16.4.3 command on the same router used in Example 24-4.|Например, в примере 16-9 перечислены выходные данные команды show ip route 172.16.4.3 на том же маршрутизаторе, который использовался в примере 24-4.
The first line of (highlighted) output lists the matched route: the route to 172.16.0.0/16.|В первой (выделенной) строке выходных данных указан согласованный маршрут: маршрут до 172.16.0.0/16.
The rest of the output lists the details of that particular route, like the outgoing interface of GigabitEthernet0/1/0 and the next-hop router of 172.16.25.129.|Остальные выходные данные содержат подробную информацию об этом конкретном маршруте, например, исходящий интерфейс GigabitEthernet0 / 1/0 и маршрутизатор следующего перехода 172.16.25.129.
|
Example 16-9 Show ip route Command with Overlapping Routes Example end.|Пример 16-9 Показать команду ip route с перекрывающимися маршрутами Пример end.
|
Certainly, if you have an option, just using a command to check what the router actually chooses is a much quicker option than doing the subnetting math.|Конечно, если у вас есть возможность, просто использование команды для проверки того, что на самом деле выбирает маршрутизатор, является гораздо более быстрым вариантом, чем выполнение математических расчетов по подсетям.
#### Interpreting the IP Routing Table
Интерпретация таблицы IP-маршрутизации   
__|__
--|--
|
The show ip route command plays a huge role in verifying and troubleshooting IP routing and addressing.|Команда show ip route играет огромную роль в проверке и устранении неполадок IP-маршрутизации и адресации.
This final topic of the chapter pulls the concepts together in one place for easier reference and study.|В этой последней теме главы все концепции собраны в одном месте для более удобного использования и изучения.
|
Figure 16-15 shows the output of a sample show ip route command.|На рис. 16-15 показаны выходные данные примера команды show ip route.
The figure numbers various parts of the command output for easier reference, with Table 16-3 describing the output noted by each number.|На рисунке нумерации различных частей вывода команды для удобства пользования, а в Таблице 16-3 описываются выходные данные, отмеченные каждым номером.
|
CLOO|CLOO
###### 10.0.0.0/8 is variably subnetted, 13 subnets, 5 masks
10.0.0.0/8 имеет переменные подсети, 13 подсетей, 5 масок   
__|__
--|--
|
4 5 6 7 8 9 1 2 3 10 11|4 5 6 7 8 9 1 2 3 10 11
###### 10.1.3.0/26 is directly connected, GigabitEthernet0/1
10.1.3.0/26 подключен напрямую, GigabitEthernet0 / 1   
###### 10.1.3.3/32 is directly connected, GigabitEthernet0/1
10.1.3.3/32 подключен напрямую, GigabitEthernet0 / 1   
###### 10.1.4.64/26 [110/65] via 10.2.2.10, 14:31:52, Serial0/1/0
10.1.4.64/26 [110/65] через 10.2.2.10, 14:31:52, Serial0 / 1/0   
###### 10.2.2.0/30 [110/128] via 10.2.2.5, 14:31:52, Serial0/0/1
10.2.2.0/30 [110/128] через 10.2.2.5, 14:31:52, Serial0 / 0/1   
__|__
--|--
|
Figure 16-15 show ip route Command Output Reference Table 16-3 Descriptions of the show ip route Command Output Table end.|Рис. 16-15 Справочная таблица выходных данных команды show ip route Таблица 16-3 Описание выходных данных команды show ip route end.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element for more details.|Обратитесь к элементу «Ваш учебный план» для получения более подробной информации.
Table 16-4 outlines the key review elements and where you can find them.|В Таблице 16-4 представлены основные элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 16-4 Chapter Review Tracking Table end.|Таблица 16-4. Конец таблицы отслеживания обзора главы.
|
Review All the Key Topics Key Terms You Should Know ARP table, routing table, next-hop router, outgoing interface, connected route, static route, default route, host route, floating static route, network route, administrative distance Command References Tables 16-6 and 16-7 list configuration and verification commands used in this chapter.|Ознакомьтесь со всеми ключевыми темами Ключевые термины, которые вы должны знать Таблица ARP, таблица маршрутизации, маршрутизатор следующего перехода, исходящий интерфейс, подключенный маршрут, статический маршрут, маршрут по умолчанию, маршрут хоста, плавающий статический маршрут, сетевой маршрут, административное расстояние Справочные таблицы команд 16- 6 и 16-7 перечислены команды настройки и проверки, используемые в этой главе.
As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.|В качестве простого упражнения на повторение закройте левый столбец таблицы, прочтите правый столбец и попытайтесь вспомнить команду, не глядя.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Затем повторите упражнение, охватывая правый столбец, и попытайтесь вспомнить, что делает команда.
|
Table 16-6 Chapter 16 Configuration Command Reference Table end.|Таблица 16-6 Глава 16 Справочник команд конфигурации Конец таблицы.
|
Table 16-7 Chapter 16 EXEC Command Reference Table end.|Таблица 16-7 Глава 16 Справочник команд EXEC Конец таблицы.
## Chapter 17 IP Routing in the LAN
Chapter 17 IP Routing in the LAN   
__|__
--|--
|
This chapter covers the following exam topics:|This chapter covers the following exam topics:
###### 1.0 Network Fundamentals
1.0 Основы сети   
###### 1.6 Configure and verify IPv4 addressing and subnetting
1.6 Настройка и проверка адресации IPv4 и подсетей   
###### 2.0 Network Access
2.0 Доступ к сети   
###### 2.4 Configure and verify (Layer 2/Layer 3) EtherChannel (LACP)
2.4 Настройка и проверка (уровень 2 / уровень 3) EtherChannel (LACP)   
__|__
--|--
|
The preceding two chapters showed how to configure an IP address and mask on a router interface, making the router ready to route packets to/from the subnet implied by that address/mask combination.|В предыдущих двух главах было показано, как настроить IP-адрес и маску на интерфейсе маршрутизатора, подготовив маршрутизатор к маршрутизации пакетов в / из подсети, подразумеваемой этой комбинацией адреса / маски.
While true and useful, all the examples so far ignored the LAN switches and the possibility of VLANs. In fact, the examples so far show the simplest possible cases: the attached switches as Layer 2 switches, using only one VLAN, with the router configured with one ip address command on its physical interface.|Хотя все примеры верны и полезны, до сих пор игнорировались переключатели LAN и возможность создания сетей VLAN. Фактически, в примерах пока показаны простейшие возможные случаи: подключенные коммутаторы как коммутаторы уровня 2, использующие только одну VLAN, с маршрутизатором, настроенным с помощью одной команды ip-адреса на его физическом интерфейсе.
This chapter takes a detailed look at how to configure routers so that they route packets to/from the subnets that exist on each and every VLAN.|В этой главе подробно рассматривается, как настроить маршрутизаторы так, чтобы они направляли пакеты в / из подсетей, которые существуют в каждой VLAN.
|
Because Layer 2 switches do not forward Layer 2 frames between VLANs, a network must use routers to route IP packets between subnets to allow those devices in different VLANs/|Поскольку коммутаторы уровня 2 не пересылают кадры уровня 2 между VLAN, сеть должна использовать маршрутизаторы для маршрутизации IP-пакетов между подсетями, чтобы эти устройства могли находиться в разных VLAN /
|
subnets to communicate.|подсети для общения.
To review, Ethernet defines the concept of a VLAN, while IP defines the concept of an IP subnet, so a VLAN is not equivalent to a subnet.|Итак, Ethernet определяет концепцию VLAN, тогда как IP определяет концепцию IP-подсети, поэтому VLAN не эквивалентна подсети.
However, the set of devices in one VLAN are typically also in one subnet.|Однако набор устройств в одной VLAN обычно также находится в одной подсети.
By the same reasoning, devices in two different VLANs are normally in two different subnets.|По той же причине устройства в двух разных VLAN обычно находятся в двух разных подсетях.
For two devices in different VLANs to communicate with each other, routers must connect to the subnets that exist on each VLAN, and then the routers forward IP packets between the devices in those subnets.|Чтобы два устройства в разных VLAN могли взаимодействовать друг с другом, маршрутизаторы должны подключаться к подсетям, которые существуют в каждой VLAN, а затем маршрутизаторы пересылают IP-пакеты между устройствами в этих подсетях.
|
This chapter discusses the configuration and verification steps related to three methods of routing between VLANs with three major sections:|В этой главе обсуждаются шаги настройки и проверки, относящиеся к трем методам маршрутизации между VLAN, в трех основных разделах:
###### VLAN Routing with Router 802.1Q Trunks: The first section discusses how to configure
VLAN Routing with Router 802.1Q Trunks: The first section discusses how to configure   
__|__
--|--
|
a router to use VLAN trunking as connected to a Layer 2 switch.|a router to use VLAN trunking as connected to a Layer 2 switch.
The router does the routing, with the switch creating the VLANs. The link between the router and switch use trunking so that the router has an interface connected to each VLAN/subnet.|The router does the routing, with the switch creating the VLANs. The link between the router and switch use trunking so that the router has an interface connected to each VLAN/subnet.
This feature is known as routing over a VLAN trunk and also known as router-on-a-stick (ROAS).|This feature is known as routing over a VLAN trunk and also known as router-on-a-stick (ROAS).
###### VLAN Routing with Layer 3 Switch SVIs: The second section discusses using a LAN
Маршрутизация VLAN с SVI коммутатора уровня 3: во втором разделе обсуждается использование LAN.   
__|__
--|--
|
switch that supports both Layer 2 switching and Layer 3 routing (called a Layer 3 switch or multilayer switch).|коммутатор, который поддерживает как коммутацию уровня 2, так и маршрутизацию уровня 3 (называемый коммутатором уровня 3 или многоуровневым коммутатором).
To route, the Layer 3 switch configuration uses interfaces called switched virtual interfaces (SVI), which are also called VLAN interfaces.|Для маршрутизации конфигурация коммутатора уровня 3 использует интерфейсы, называемые коммутируемыми виртуальными интерфейсами (SVI), которые также называются интерфейсами VLAN.
###### VLAN Routing with Layer 3 Switch Routed Ports: The third major section of the chapter
Маршрутизация VLAN с маршрутизируемыми портами коммутатора уровня 3: Третий важный раздел главы   
__|__
--|--
|
discusses an alternative to SVIs called routed ports, in which the physical switch ports are made to act like interfaces on a router.|обсуждает альтернативу SVI, называемую маршрутизируемыми портами, в которой физические порты коммутатора действуют как интерфейсы на маршрутизаторе.
This third section also introduces the concept of an EtherChannel as used as a routed port in a feature called Layer 3 EtherChannel.|В этом третьем разделе также представлена ​​концепция EtherChannel, используемого в качестве маршрутизируемого порта в функции, называемой EtherChannel уровня 3.
|
CHAPTER 17|ГЛАВА 17
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 17-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 17-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Foundation Topics   
### VLAN Routing with Router 802.1Q Trunks
VLAN Routing with Router 802.1Q Trunks   
__|__
--|--
|
VLAN Routing with Layer 3 Switch SVIs 3, 4 VLAN Routing with Layer 3 Switch Routed Ports 5, 6 1.|VLAN Routing with Layer 3 Switch SVIs 3, 4 VLAN Routing with Layer 3 Switch Routed Ports 5, 6 1.
Router 1 has a Fast Ethernet interface 0/0 with IP address 10.1.1.1.|Router 1 has a Fast Ethernet interface 0/0 with IP address 10.1.1.1.
The interface is connected to a switch.|The interface is connected to a switch.
This connection is then migrated to use 802.1Q trunking.|This connection is then migrated to use 802.1Q trunking.
Which of the following commands could be part of a valid configuration for Router 1’s Fa0/0 interface? (Choose two answers.)|Which of the following commands could be part of a valid configuration for Router 1’s Fa0/0 interface? (Choose two answers.)
|
a. interface fastethernet 0/0.4 b. dot1q enable c. dot1q enable 4 d. trunking enable e. trunking enable 4 f. encapsulation dot1q 4 2.|a. interface fastethernet 0/0.4 b. dot1q enable c. dot1q enable 4 d. trunking enable e. trunking enable 4 f. encapsulation dot1q 4 2.
Router R1 has a router-on-a-stick (ROAS) configuration with two subinterfaces of interface G0/1: G0/1.1 and G0/1.2.|Router R1 has a router-on-a-stick (ROAS) configuration with two subinterfaces of interface G0/1: G0/1.1 and G0/1.2.
Physical interface G0/1 is currently in a down/down state.|Physical interface G0/1 is currently in a down/down state.
The network engineer then configures a shutdown command when in interface configuration mode for G0/1.1 and a no shutdown command when in interface configuration mode for G0/1.2.|The network engineer then configures a shutdown command when in interface configuration mode for G0/1.1 and a no shutdown command when in interface configuration mode for G0/1.2.
Which answers are correct about the interface state for the subinterfaces? (Choose two answers.)|Which answers are correct about the interface state for the subinterfaces? (Choose two answers.)
|
a. G0/1.1 will be in a down/down state.|a. G0/1.1 will be in a down/down state.
|
b. G0/1.2 will be in a down/down state.|b. G0/1.2 will be in a down/down state.
|
c. G0/1.1 will be in an administratively down state.|c. G0/1.1 will be in an administratively down state.
|
d. G0/1.2 will be in an up/up state.|d. G0/1.2 will be in an up/up state.
|
3. A Layer 3 switch has been configured to route IP packets between VLANs 1, 2, and 3 using SVIs, which connect to subnets 172.20.1.0/25, 172.20.2.0/25, and 172.20.3.0/25, respectively.|3. A Layer 3 switch has been configured to route IP packets between VLANs 1, 2, and 3 using SVIs, which connect to subnets 172.20.1.0/25, 172.20.2.0/25, and 172.20.3.0/25, respectively.
The engineer issues a show ip route connected command on the Layer 3 switch, listing the connected routes.|The engineer issues a show ip route connected command on the Layer 3 switch, listing the connected routes.
Which of the following answers lists a piece of information that should be in at least one of the routes?|Which of the following answers lists a piece of information that should be in at least one of the routes?
|
a. Interface Gigabit Ethernet 0/0.3 b.|a. Interface Gigabit Ethernet 0/0.3 b.
Next-hop router 172.20.2.1 c.|Next-hop router 172.20.2.1 c.
Interface VLAN 2 d.|Interface VLAN 2 d.
Mask 255.255.255.0 4.|Mask 255.255.255.0 4.
An engineer has successfully configured a Layer 3 switch with SVIs for VLANs 2 and 3.|An engineer has successfully configured a Layer 3 switch with SVIs for VLANs 2 and 3.
Hosts in the subnets using VLANs 2 and 3 can ping each other with the Layer 3 switch routing the packets.|Hosts in the subnets using VLANs 2 and 3 can ping each other with the Layer 3 switch routing the packets.
The next week, the network engineer receives a call that those same users can no longer ping each other.|The next week, the network engineer receives a call that those same users can no longer ping each other.
If the problem is with the Layer 3 switching function, which of the following could have caused the problem? (Choose two answers.)|If the problem is with the Layer 3 switching function, which of the following could have caused the problem? (Choose two answers.)
|
a. Six (or more) out of 10 working VLAN 2 access ports failing due to physical problems b.|a. Six (or more) out of 10 working VLAN 2 access ports failing due to physical problems b.
A shutdown command issued from interface VLAN 4 configuration mode c.|A shutdown command issued from interface VLAN 4 configuration mode c.
VTP on the switch removing VLAN 3 from the switch’s VLAN list d.|VTP on the switch removing VLAN 3 from the switch’s VLAN list d.
A shutdown command issued from VLAN 2 configuration mode 5.|A shutdown command issued from VLAN 2 configuration mode 5.
A LAN design uses a Layer 3 EtherChannel between two switches SW1 and SW2, with port-channel interface 1 used on both switches.|A LAN design uses a Layer 3 EtherChannel between two switches SW1 and SW2, with port-channel interface 1 used on both switches.
SW1 uses ports G0/1, G0/2, and G0/3 in the channel.|SW1 uses ports G0/1, G0/2, and G0/3 in the channel.
Which of the following are true about SW1’s configuration to make the channel be able to route IPv4 packets correctly? (Choose two answers.)|Which of the following are true about SW1’s configuration to make the channel be able to route IPv4 packets correctly? (Choose two answers.)
|
a. The ip address command must be on the port-channel 1 interface.|a. The ip address command must be on the port-channel 1 interface.
|
b. The ip address command must be on interface G0/1 (lowest numbered port).|b. The ip address command must be on interface G0/1 (lowest numbered port).
|
c. The port-channel 1 interface must be configured with the no switchport command.|c. The port-channel 1 interface must be configured with the no switchport command.
|
d. Interface G0/1 must be configured with the routedport command.|d. Interface G0/1 must be configured with the routedport command.
|
6. A LAN design uses a Layer 3 EtherChannel between two switches SW1 and SW2, with port-channel interface 1 used on both switches.|6. A LAN design uses a Layer 3 EtherChannel between two switches SW1 and SW2, with port-channel interface 1 used on both switches.
SW1 uses ports G0/1 and G0/2 in the channel.|SW1 uses ports G0/1 and G0/2 in the channel.
However, only interface G0/1 is bundled into the channel and working.|However, only interface G0/1 is bundled into the channel and working.
|
Think about the configuration settings on port G0/2 that could have existed before adding G0/2 to the EtherChannel.|Think about the configuration settings on port G0/2 that could have existed before adding G0/2 to the EtherChannel.
Which answers identify a setting that could prevent IOS from adding G0/2 to the Layer 3 EtherChannel? (Choose two answers.)|Which answers identify a setting that could prevent IOS from adding G0/2 to the Layer 3 EtherChannel? (Choose two answers.)
|
a. A different STP cost (spanning-tree cost value)|a. A different STP cost (spanning-tree cost value)
|
b. A different speed (speed value)|b. A different speed (speed value)
|
c. A default setting for switchport (switchport)|c. A default setting for switchport (switchport)
|
d. A different access VLAN (switchport access vlan vlan-id)|d. A different access VLAN (switchport access vlan vlan-id)
|
Foundation Topics VLAN Routing with Router 802.1Q Trunks Almost all enterprise networks use VLANs. To route IP packets in and out of those VLANs, some devices (either routers or Layer 3 switches) need to have an IP address in each subnet and have a connected route to each of those subnets.|Foundation Topics VLAN Routing with Router 802.1Q Trunks Almost all enterprise networks use VLANs. To route IP packets in and out of those VLANs, some devices (either routers or Layer 3 switches) need to have an IP address in each subnet and have a connected route to each of those subnets.
Then the IP addresses on those routers or Layer 3 switches can serve as the default gateways in those subnets.|Then the IP addresses on those routers or Layer 3 switches can serve as the default gateways in those subnets.
|
This chapter breaks down the LAN routing options into four categories:|This chapter breaks down the LAN routing options into four categories:
###### Use a router, with one router LAN interface and cable connected to the switch for each
Use a router, with one router LAN interface and cable connected to the switch for each   
__|__
--|--
|
and every VLAN (typically not used)|and every VLAN (typically not used)
###### Use a router, with a VLAN trunk connecting to a LAN switch (known as router-on-astick,
Use a router, with a VLAN trunk connecting to a LAN switch (known as router-on-astick,   
__|__
--|--
|
or ROAS)|or ROAS)
###### Use a Layer 3 switch with switched virtual interfaces (SVI)
Use a Layer 3 switch with switched virtual interfaces (SVI)   
###### Use a Layer 3 switch with routed interfaces (which may or may not be Layer 3
Use a Layer 3 switch with routed interfaces (which may or may not be Layer 3   
__|__
--|--
|
EtherChannels)|EtherChannels)
|
Of the items in the list, the first option works, but to be practical, it requires far too many interfaces.|Of the items in the list, the first option works, but to be practical, it requires far too many interfaces.
It is mentioned here only to make the list complete.|It is mentioned here only to make the list complete.
|
As for the other three options, this chapter discusses each in turn as the main focus of one of the three major sections in this chapter.|As for the other three options, this chapter discusses each in turn as the main focus of one of the three major sections in this chapter.
Each feature is used in real networks today, with the choice to use one or the other driven by the design and needs for a particular part of the network.|Each feature is used in real networks today, with the choice to use one or the other driven by the design and needs for a particular part of the network.
Figure 17-1 shows cases in which these options could be used.|Figure 17-1 shows cases in which these options could be used.
|
Figure 17-1 Layer 3 Switching at the Central Site Figure 17-1 shows two switches, labeled A and B, which could act as Layer 3 switches—both with SVIs and routed interfaces.|Figure 17-1 Layer 3 Switching at the Central Site Figure 17-1 shows two switches, labeled A and B, which could act as Layer 3 switches—both with SVIs and routed interfaces.
The figure shows a central site campus LAN on the left, with 12 VLANs. Switches A and B act as Layer 3 switches, combining the functions of a router and a switch, routing between all 12 subnets/VLANs, as well as routing to/from the Core router.|The figure shows a central site campus LAN on the left, with 12 VLANs. Switches A and B act as Layer 3 switches, combining the functions of a router and a switch, routing between all 12 subnets/VLANs, as well as routing to/from the Core router.
Those Layer 3 switches could use SVIs, routed interfaces, or both.|Those Layer 3 switches could use SVIs, routed interfaces, or both.
|
Figure 17-1 also shows a classic case for using a router with a VLAN trunk.|Figure 17-1 also shows a classic case for using a router with a VLAN trunk.
Sites like the remote sites on the right side of the figure may have a WAN-connected router and a LAN switch.|Sites like the remote sites on the right side of the figure may have a WAN-connected router and a LAN switch.
These sites might use ROAS to take advantage of the router’s ability to route over an 802.1Q trunk.|These sites might use ROAS to take advantage of the router’s ability to route over an 802.1Q trunk.
|
Note that Figure 17-1 just shows an example.|Note that Figure 17-1 just shows an example.
The engineer could use Layer 3 switching at each site or routers with VLAN trunking at each site.|The engineer could use Layer 3 switching at each site or routers with VLAN trunking at each site.
#### Configuring ROAS
Configuring ROAS   
__|__
--|--
|
This next topic discusses how routers route packets to subnets associated with VLANs connected to a router 802.1Q trunk.|This next topic discusses how routers route packets to subnets associated with VLANs connected to a router 802.1Q trunk.
That long description can be a bit of a chore to repeat each time someone wants to discuss this feature, so over time, the networking world has instead settled on a shorter and more interesting name for this feature: router-on-a-stick (ROAS).|That long description can be a bit of a chore to repeat each time someone wants to discuss this feature, so over time, the networking world has instead settled on a shorter and more interesting name for this feature: router-on-a-stick (ROAS).
|
ROAS uses router VLAN trunking configuration to give the router a logical router interface connected to each VLAN. Because the router then has an interface connected to each VLAN, the router can also be configured with an IP address in the subnet that exists on each VLAN.|ROAS uses router VLAN trunking configuration to give the router a logical router interface connected to each VLAN. Because the router then has an interface connected to each VLAN, the router can also be configured with an IP address in the subnet that exists on each VLAN.
|
Routers use subinterfaces as the means to have an interface connected to a VLAN. The router needs to have an IP address/mask associated with each VLAN on the trunk.|Routers use subinterfaces as the means to have an interface connected to a VLAN. The router needs to have an IP address/mask associated with each VLAN on the trunk.
However, the router has only one physical interface for the link connected to the trunk.|However, the router has only one physical interface for the link connected to the trunk.
Cisco solves this problem by creating multiple virtual router interfaces, one associated with each VLAN on that trunk (at least for each VLAN that you want the trunk to support).|Cisco solves this problem by creating multiple virtual router interfaces, one associated with each VLAN on that trunk (at least for each VLAN that you want the trunk to support).
Cisco calls these virtual interfaces subinterfaces.|Cisco calls these virtual interfaces subinterfaces.
The configuration can then include an ip address command for each subinterface.|The configuration can then include an ip address command for each subinterface.
|
Figure 17-2 shows the concept with Router B1, one of the branch routers from Figure 17-1.|Figure 17-2 shows the concept with Router B1, one of the branch routers from Figure 17-1.
|
Because this router needs to route between only two VLANs, the figure also shows two subinterfaces, named G0/0.10 and G0/0.20, which create a new place in the configuration where the per-VLAN configuration settings can be made.|Because this router needs to route between only two VLANs, the figure also shows two subinterfaces, named G0/0.10 and G0/0.20, which create a new place in the configuration where the per-VLAN configuration settings can be made.
The router treats frames tagged with VLAN 10 as if they came in or out of G0/0.10 and frames tagged with VLAN 20 as if they came in or out G0/0.20.|The router treats frames tagged with VLAN 10 as if they came in or out of G0/0.10 and frames tagged with VLAN 20 as if they came in or out G0/0.20.
|
Figure 17-2 Subinterfaces on Router B1 In addition, note that most Cisco routers do not attempt to negotiate trunking, so both the router and switch need to manually configure trunking.|Figure 17-2 Subinterfaces on Router B1 In addition, note that most Cisco routers do not attempt to negotiate trunking, so both the router and switch need to manually configure trunking.
This chapter discusses the router side of that trunking configuration; the matching switch interface would need to be configured with the switchport mode trunk command.|This chapter discusses the router side of that trunking configuration; the matching switch interface would need to be configured with the switchport mode trunk command.
|
Answers to the “Do I Know This Already?” quiz:|Answers to the “Do I Know This Already?” quiz:
|
1 A, F 2 B, C 3 C 4 C, D 5 A, C 6 B, C Example 17-1 shows a full example of the 802.1Q trunking configuration required on Router B1 in Figure 17-2.|1 A, F 2 B, C 3 C 4 C, D 5 A, C 6 B, C Example 17-1 shows a full example of the 802.1Q trunking configuration required on Router B1 in Figure 17-2.
More generally, these steps detail how to configure 802.1Q trunking on a router:|More generally, these steps detail how to configure 802.1Q trunking on a router:
|
Step 1.|Step 1.
Use the interface type number.subint command in global configuration mode to create a unique subinterface for each VLAN that needs to be routed.|Use the interface type number.subint command in global configuration mode to create a unique subinterface for each VLAN that needs to be routed.
|
Step 2.|Step 2.
Use the encapsulation dot1q vlan_id command in subinterface configuration mode to enable 802.1Q and associate one specific VLAN with the subinterface.|Use the encapsulation dot1q vlan_id command in subinterface configuration mode to enable 802.1Q and associate one specific VLAN with the subinterface.
|
Step 3.|Step 3.
Use the ip address address mask command in subinterface configuration mode to configure IP settings (address and mask).|Use the ip address address mask command in subinterface configuration mode to configure IP settings (address and mask).
|
Example 17-1 Router Configuration for the 802.1Q Encapsulation Shown in Figure 17-2 Example end.|Example 17-1 Router Configuration for the 802.1Q Encapsulation Shown in Figure 17-2 Example end.
|
First, look at the subinterface numbers.|First, look at the subinterface numbers.
The subinterface number begins with the period, like .10 and .20 in this case.|The subinterface number begins with the period, like .10 and .20 in this case.
These numbers can be any number from 1 up through a very large number (over 4 billion).|These numbers can be any number from 1 up through a very large number (over 4 billion).
The number just needs to be unique among all subinterfaces associated with this one physical interface.|The number just needs to be unique among all subinterfaces associated with this one physical interface.
In fact, the subinterface number does not even have to match the associated VLAN ID. (The encapsulation command, and not the subinterface number, defines the VLAN ID associated with the subinterface.)|In fact, the subinterface number does not even have to match the associated VLAN ID. (The encapsulation command, and not the subinterface number, defines the VLAN ID associated with the subinterface.)
|
NOTE Although not required, most sites do choose to make the subinterface number match the VLAN ID, as shown in Example 17-1, just to avoid confusion.|NOTE Although not required, most sites do choose to make the subinterface number match the VLAN ID, as shown in Example 17-1, just to avoid confusion.
|
Each subinterface configuration lists two subcommands.|Each subinterface configuration lists two subcommands.
One command (encapsulation)|One command (encapsulation)
|
enables trunking and defines the VLAN whose frames are considered to be coming in and out of the subinterface.|enables trunking and defines the VLAN whose frames are considered to be coming in and out of the subinterface.
The ip address command works the same way it does on any other interface.|The ip address command works the same way it does on any other interface.
Note that if the physical Ethernet interface reaches an up/up state, the subinterface should as well, which would then let the router add the connected routes shown at the bottom of the example.|Note that if the physical Ethernet interface reaches an up/up state, the subinterface should as well, which would then let the router add the connected routes shown at the bottom of the example.
|
Now that the router has a working interface, with IPv4 addresses configured, the router can route IPv4 packets on these subinterfaces.|Now that the router has a working interface, with IPv4 addresses configured, the router can route IPv4 packets on these subinterfaces.
That is, the router treats these subinterfaces like Config Checklist any physical interface in terms of adding connected routes, matching those routes, and forwarding packets to/from those connected subnets.|That is, the router treats these subinterfaces like Config Checklist any physical interface in terms of adding connected routes, matching those routes, and forwarding packets to/from those connected subnets.
|
The configuration and use of the native VLAN on the trunk require a little extra thought.|The configuration and use of the native VLAN on the trunk require a little extra thought.
The native VLAN can be configured on a subinterface, or on the physical interface, or ignored as in Example 17-1.|The native VLAN can be configured on a subinterface, or on the physical interface, or ignored as in Example 17-1.
Each 802.1Q trunk has one native VLAN, and if the router needs to route packets for a subnet that exists in the native VLAN, then the router needs some configuration to support that subnet.|Each 802.1Q trunk has one native VLAN, and if the router needs to route packets for a subnet that exists in the native VLAN, then the router needs some configuration to support that subnet.
The two options to define a router interface for the native VLAN are|The two options to define a router interface for the native VLAN are
###### Configure the ip address command on the physical interface, but without an
Configure the ip address command on the physical interface, but without an   
__|__
--|--
|
encapsulation command; the router considers this physical interface to be using the native VLAN.|encapsulation command; the router considers this physical interface to be using the native VLAN.
###### Configure the ip address command on a subinterface and use the encapsulation dot1q
Configure the ip address command on a subinterface and use the encapsulation dot1q   
__|__
--|--
|
vlan-id native subcommand to tell the router both the VLAN ID and the fact that it is the native VLAN.|vlan-id native subcommand to tell the router both the VLAN ID and the fact that it is the native VLAN.
|
Example 17-2 shows both native VLAN configuration options with a small change to the same configuration in Example 17-1.|Example 17-2 shows both native VLAN configuration options with a small change to the same configuration in Example 17-1.
In this case, VLAN 10 becomes the native VLAN. The top part of the example shows the option to configure the router physical interface to use native VLAN 10.|In this case, VLAN 10 becomes the native VLAN. The top part of the example shows the option to configure the router physical interface to use native VLAN 10.
The second half of the example shows how to configure that same native VLAN on a subinterface.|The second half of the example shows how to configure that same native VLAN on a subinterface.
In both cases, the switch configuration also needs to be changed to make VLAN 10 the native VLAN.|In both cases, the switch configuration also needs to be changed to make VLAN 10 the native VLAN.
|
Example 17-2 Router Configuration Using Native VLAN 10 on Router B1 Example end.|Example 17-2 Router Configuration Using Native VLAN 10 on Router B1 Example end.
#### Verifying ROAS
Verifying ROAS   
__|__
--|--
|
Beyond using the show running-config command, ROAS configuration on a router can be best verified with two commands: show ip route [connected] and show vlans.|Beyond using the show running-config command, ROAS configuration on a router can be best verified with two commands: show ip route [connected] and show vlans.
As with any router interface, as long as the interface is in an up/up state and has an IPv4 address configured, IOS will put a connected (and local) route in the IPv4 routing table.|As with any router interface, as long as the interface is in an up/up state and has an IPv4 address configured, IOS will put a connected (and local) route in the IPv4 routing table.
So, a first and obvious check would be to see if all the expected connected routes exist.|So, a first and obvious check would be to see if all the expected connected routes exist.
Example 17-3 lists the connected routes per the configuration shown in Example 17-1.|Example 17-3 lists the connected routes per the configuration shown in Example 17-1.
|
Example 17-3 Connected Routes Based on Example 17-1 Configuration Example end.|Example 17-3 Connected Routes Based on Example 17-1 Configuration Example end.
|
As for interface and subinterface state, note that the ROAS subinterface state does depend to some degree on the physical interface state.|As for interface and subinterface state, note that the ROAS subinterface state does depend to some degree on the physical interface state.
In particular, the subinterface state cannot be better than the state of the matching physical interface.|In particular, the subinterface state cannot be better than the state of the matching physical interface.
For instance, on Router B1 in the examples so far, physical interface G0/0 is in an up/up state, and the subinterfaces are in an up/up state.|For instance, on Router B1 in the examples so far, physical interface G0/0 is in an up/up state, and the subinterfaces are in an up/up state.
But if you unplugged the cable from that port, the physical port would fail to a down/down state, and the subinterfaces would also fail to a down/down state.|But if you unplugged the cable from that port, the physical port would fail to a down/down state, and the subinterfaces would also fail to a down/down state.
Example 17-4 shows another example, with the physical interface being shut down, with the subinterfaces then automatically changed to an administratively down state as a result.|Example 17-4 shows another example, with the physical interface being shut down, with the subinterfaces then automatically changed to an administratively down state as a result.
|
Example 17-4 Subinterface State Tied to Physical Interface State Example end.|Example 17-4 Subinterface State Tied to Physical Interface State Example end.
|
Additionally, the subinterface state can also be enabled and disabled independently from the physical interface, using the no shutdown and shutdown commands in subinterface configuration mode.|Additionally, the subinterface state can also be enabled and disabled independently from the physical interface, using the no shutdown and shutdown commands in subinterface configuration mode.
|
Another useful ROAS verification command, show vlans, spells out which router trunk interfaces use which VLANs, which VLAN is the native VLAN, plus some packet statistics.|Another useful ROAS verification command, show vlans, spells out which router trunk interfaces use which VLANs, which VLAN is the native VLAN, plus some packet statistics.
The fact that the packet counters are increasing can be useful when verifying whether traffic is happening or not.|The fact that the packet counters are increasing can be useful when verifying whether traffic is happening or not.
Example 17-5 shows a sample, based on the Router B1 configuration in Example 17-2 (bottom half), in which native VLAN 10 is configured on subinterface G0/0.10.|Example 17-5 shows a sample, based on the Router B1 configuration in Example 17-2 (bottom half), in which native VLAN 10 is configured on subinterface G0/0.10.
|
Note that the output identifies VLAN 1 associated with the physical interface, VLAN 10 as the native VLAN associated with G0/0.10, and VLAN 20 associated with G0/0.20.|Note that the output identifies VLAN 1 associated with the physical interface, VLAN 10 as the native VLAN associated with G0/0.10, and VLAN 20 associated with G0/0.20.
It also lists the IP addresses assigned to each interface/subinterface.|It also lists the IP addresses assigned to each interface/subinterface.
|
Example 17-5 Sample show vlans Command to Match Sample Router Trunking Example end.|Example 17-5 Sample show vlans Command to Match Sample Router Trunking Example end.
#### Troubleshooting ROAS
Troubleshooting ROAS   
__|__
--|--
|
The biggest challenge when troubleshooting ROAS has to do with the fact that if you misconfigure only the router or misconfigure only the switch, the other device on the trunk has no way to know that the other side is misconfigured.|The biggest challenge when troubleshooting ROAS has to do with the fact that if you misconfigure only the router or misconfigure only the switch, the other device on the trunk has no way to know that the other side is misconfigured.
That is, if you check the show ip route and show vlans commands on a router, and the output looks like it matches the intended configuration, and the connected routes for the correct subinterfaces show up, routing may still fail because of problems on the attached switch.|That is, if you check the show ip route and show vlans commands on a router, and the output looks like it matches the intended configuration, and the connected routes for the correct subinterfaces show up, routing may still fail because of problems on the attached switch.
So, troubleshooting ROAS often begins with checking the configuration on both the router and switch because there is no status output on either device that tells you where the problem might be.|So, troubleshooting ROAS often begins with checking the configuration on both the router and switch because there is no status output on either device that tells you where the problem might be.
|
First, to check ROAS on the router, you need to start with the intended configuration and ask questions about the configuration:|First, to check ROAS on the router, you need to start with the intended configuration and ask questions about the configuration:
|
1. Is each non-native VLAN configured on the router with an encapsulation dot1q vlan-id command on a subinterface?|1. Is each non-native VLAN configured on the router with an encapsulation dot1q vlan-id command on a subinterface?
|
2. Do those same VLANs exist on the trunk on the neighboring switch (show interfaces trunk), and are they in the allowed list, not VTP pruned, and not STP blocked?|2. Do those same VLANs exist on the trunk on the neighboring switch (show interfaces trunk), and are they in the allowed list, not VTP pruned, and not STP blocked?
|
3. Does each router ROAS subinterface have an IP address/mask configured per the planned configuration?|3. Does each router ROAS subinterface have an IP address/mask configured per the planned configuration?
|
4. If using the native VLAN, is it configured correctly on the router either on a subinterface (with an encapsulation dot1q vlan-id native command) or implied on the physical interface?|4. If using the native VLAN, is it configured correctly on the router either on a subinterface (with an encapsulation dot1q vlan-id native command) or implied on the physical interface?
|
5. Is the same native VLAN configured on the neighboring switch’s trunk in comparison to the native VLAN configured on the router?|5. Is the same native VLAN configured on the neighboring switch’s trunk in comparison to the native VLAN configured on the router?
|
6. Are the router physical or ROAS subinterfaces configured with a shutdown command?|6. Are the router physical or ROAS subinterfaces configured with a shutdown command?
|
For some of these steps, you need to be ready to investigate possible VLAN trunking issues on the LAN switch.|For some of these steps, you need to be ready to investigate possible VLAN trunking issues on the LAN switch.
The reason is that on many Cisco routers, router interfaces do not negotiate trunking.|The reason is that on many Cisco routers, router interfaces do not negotiate trunking.
As a result, ROAS relies on static trunk configuration on both the router and switch.|As a result, ROAS relies on static trunk configuration on both the router and switch.
If the switch has any problems with VLANs or the VLAN trunking configuration on its side of the trunk, the router has no way to realize that the problem exists.|If the switch has any problems with VLANs or the VLAN trunking configuration on its side of the trunk, the router has no way to realize that the problem exists.
|
For example, imagine you configured ROAS on a router just like in Example 17-1 or Example 17-2.|For example, imagine you configured ROAS on a router just like in Example 17-1 or Example 17-2.
However, the switch on the other end of the link had no matching configuration.|However, the switch on the other end of the link had no matching configuration.
For instance, maybe the switch did not even define VLANs 10 and 20.|For instance, maybe the switch did not even define VLANs 10 and 20.
Maybe the switch did not configure trunking on the port connected to the router.|Maybe the switch did not configure trunking on the port connected to the router.
Even with blatant misconfiguration or missing configuration on the switch, the router still shows up/up ROAS interfaces and subinterfaces, IP routes in the output of show ip route, and meaningful configuration information in the output of the show vlans command.|Even with blatant misconfiguration or missing configuration on the switch, the router still shows up/up ROAS interfaces and subinterfaces, IP routes in the output of show ip route, and meaningful configuration information in the output of the show vlans command.
### VLAN Routing with Layer 3 Switch SVIs
VLAN Routing with Layer 3 Switch SVIs   
__|__
--|--
|
Using a router with ROAS to route packets makes sense in some cases, particularly at small remote sites.|Using a router with ROAS to route packets makes sense in some cases, particularly at small remote sites.
In sites with a larger LAN, network designers choose to use Layer 3 switches for most inter-VLAN routing.|In sites with a larger LAN, network designers choose to use Layer 3 switches for most inter-VLAN routing.
|
A Layer 3 switch (also called a multilayer switch) is one device, but it executes logic at two layers: Layer 2 LAN switching and Layer 3 IP routing.|A Layer 3 switch (also called a multilayer switch) is one device, but it executes logic at two layers: Layer 2 LAN switching and Layer 3 IP routing.
The Layer 2 switch function forwards frames inside each VLAN, but it will not forward frames between VLANs. The Layer 3 forwarding (routing) logic forwards IP packets between VLANs.|The Layer 2 switch function forwards frames inside each VLAN, but it will not forward frames between VLANs. The Layer 3 forwarding (routing) logic forwards IP packets between VLANs.
|
Layer 3 switches typically support two configuration options to enable IPv4 routing inside the switch, specifically to enable IPv4 on switch interfaces.|Layer 3 switches typically support two configuration options to enable IPv4 routing inside the switch, specifically to enable IPv4 on switch interfaces.
This section explains one option, an option that uses switched virtual interfaces (SVI). The final major section of the chapter deals with the other option for configuring IPv4 addresses on Layer 3 switches: routed interfaces.|This section explains one option, an option that uses switched virtual interfaces (SVI). The final major section of the chapter deals with the other option for configuring IPv4 addresses on Layer 3 switches: routed interfaces.
#### Configuring Routing Using Switch SVIs
Configuring Routing Using Switch SVIs   
__|__
--|--
|
The configuration of a Layer 3 switch mostly looks like the Layer 2 switching configuration shown back in Parts II and III of this book, with a small bit of configuration added for the Layer 3 functions.|The configuration of a Layer 3 switch mostly looks like the Layer 2 switching configuration shown back in Parts II and III of this book, with a small bit of configuration added for the Layer 3 functions.
The Layer 3 switching function needs a virtual interface connected to each VLAN internal to the switch.|The Layer 3 switching function needs a virtual interface connected to each VLAN internal to the switch.
These VLAN interfaces act like router interfaces, with an IP address and mask.|These VLAN interfaces act like router interfaces, with an IP address and mask.
The Layer 3 switch has an IP routing table, with connected routes off each of these VLAN interfaces. (These interfaces are also referred to as switched virtual interfaces [SVI].)|The Layer 3 switch has an IP routing table, with connected routes off each of these VLAN interfaces. (These interfaces are also referred to as switched virtual interfaces [SVI].)
|
To show the concept of Layer 3 switching with SVIs, the following example uses the same branch office with two VLANs shown in the earlier examples, but now the design will use Layer 3 switching in the LAN switch.|To show the concept of Layer 3 switching with SVIs, the following example uses the same branch office with two VLANs shown in the earlier examples, but now the design will use Layer 3 switching in the LAN switch.
Figure 17-3 shows the design changes and configuration concept for the Layer 3 switch function with a router icon inside the switch, to emphasize that the switch routes the packets.|Figure 17-3 shows the design changes and configuration concept for the Layer 3 switch function with a router icon inside the switch, to emphasize that the switch routes the packets.
|
Figure 17-3 Routing on VLAN Interfaces in a Layer 3 Switch Note that the figure represents the internals of the Layer 3 switch within the box in the middle of the figure.|Figure 17-3 Routing on VLAN Interfaces in a Layer 3 Switch Note that the figure represents the internals of the Layer 3 switch within the box in the middle of the figure.
The branch still has two user VLANs (10 and 20), so the Layer 3 switch needs one VLAN interface for each VLAN. The figure shows a router icon inside the gray box to represent the Layer 3 switching function, with two VLAN interfaces on the right side of that icon.|The branch still has two user VLANs (10 and 20), so the Layer 3 switch needs one VLAN interface for each VLAN. The figure shows a router icon inside the gray box to represent the Layer 3 switching function, with two VLAN interfaces on the right side of that icon.
In addition, the traffic still needs to get to router B1 (a physical router) to access the WAN, so the switch uses a third VLAN (VLAN 30 in this case) for the link to Router B1. The physical link between the Layer 3 switch and router B1 would not be a trunk, but instead be an access link.|In addition, the traffic still needs to get to router B1 (a physical router) to access the WAN, so the switch uses a third VLAN (VLAN 30 in this case) for the link to Router B1. The physical link between the Layer 3 switch and router B1 would not be a trunk, but instead be an access link.
|
The following steps show how to configure Layer 3 switching using SVIs. Note that on some switches, like the 2960 and 2960-XR switches used for the examples in this book, the ability to route IPv4 packets must be enabled first, with a reload of the switch required to enable the feature.|The following steps show how to configure Layer 3 switching using SVIs. Note that on some switches, like the 2960 and 2960-XR switches used for the examples in this book, the ability to route IPv4 packets must be enabled first, with a reload of the switch required to enable the feature.
The steps that occur after the reload would apply to all models of Cisco switches that are capable of doing Layer 3 switching.|The steps that occur after the reload would apply to all models of Cisco switches that are capable of doing Layer 3 switching.
|
Step 1.|Step 1.
Enable IP routing on the switch, as needed:|Enable IP routing on the switch, as needed:
|
A. Use the sdm prefer lanbase-routing command (or similar) in global configuration mode to change the switch forwarding ASIC settings to make space for IPv4 routes at the next reload of the switch.|A. Use the sdm prefer lanbase-routing command (or similar) in global configuration mode to change the switch forwarding ASIC settings to make space for IPv4 routes at the next reload of the switch.
|
B. Use the reload EXEC command in enable mode to reload (reboot) the switch to pick up the new sdm prefer command setting.|B. Use the reload EXEC command in enable mode to reload (reboot) the switch to pick up the new sdm prefer command setting.
|
C. Once reloaded, use the ip routing command in global configuration mode to enable the IPv4 routing function in IOS software and to enable key commands like show ip route.|C. Once reloaded, use the ip routing command in global configuration mode to enable the IPv4 routing function in IOS software and to enable key commands like show ip route.
|
Config Checklist Step 2.|Config Checklist Step 2.
Configure each SVI interface, one per VLAN for which routing should be done by this Layer 3 switch:|Configure each SVI interface, one per VLAN for which routing should be done by this Layer 3 switch:
|
A. Use the interface vlan vlan_id command in global configuration mode to create a VLAN interface and to give the switch’s routing logic a Layer 3 interface connected into the VLAN of the same number.|A. Use the interface vlan vlan_id command in global configuration mode to create a VLAN interface and to give the switch’s routing logic a Layer 3 interface connected into the VLAN of the same number.
|
B. Use the ip address address mask command in VLAN interface configuration mode to configure an IP address and mask on the VLAN interface, enabling IPv4 routing on that VLAN interface.|B. Use the ip address address mask command in VLAN interface configuration mode to configure an IP address and mask on the VLAN interface, enabling IPv4 routing on that VLAN interface.
|
C. (As needed) Use the no shutdown command in interface configuration mode to enable the VLAN interface (if it is currently in a shutdown state).|C. (As needed) Use the no shutdown command in interface configuration mode to enable the VLAN interface (if it is currently in a shutdown state).
|
Example 17-6 shows the configuration to match Figure 17-3.|Example 17-6 shows the configuration to match Figure 17-3.
In this case, switch SW1 has already used the sdm prefer global command to change to a setting that supports IPv4 routing, and the switch has been reloaded.|In this case, switch SW1 has already used the sdm prefer global command to change to a setting that supports IPv4 routing, and the switch has been reloaded.
The example shows the related configuration on all three VLAN interfaces.|The example shows the related configuration on all three VLAN interfaces.
|
Example 17-6 VLAN Interface Configuration for Layer 3 Switching Example end.|Example 17-6 VLAN Interface Configuration for Layer 3 Switching Example end.
#### Verifying Routing with SVIs
Verifying Routing with SVIs   
__|__
--|--
|
With the VLAN configuration shown in the previous section, the switch is ready to route packets between the VLANs as shown in Figure 17-3.|With the VLAN configuration shown in the previous section, the switch is ready to route packets between the VLANs as shown in Figure 17-3.
To support the routing of packets, the switch adds connected IP routes as shown in Example 17-7; note that each route is listed as being connected to a different VLAN interface.|To support the routing of packets, the switch adds connected IP routes as shown in Example 17-7; note that each route is listed as being connected to a different VLAN interface.
|
Example 17-7 Connected Routes on a Layer 3 Switch Example end.|Example 17-7 Connected Routes on a Layer 3 Switch Example end.
|
The switch would also need additional routes to the rest of the network (not shown in the figures in this chapter).|The switch would also need additional routes to the rest of the network (not shown in the figures in this chapter).
The Layer 3 switch could use static routes or a routing protocol, depending on the capabilities of the switch.|The Layer 3 switch could use static routes or a routing protocol, depending on the capabilities of the switch.
For instance, if you then enabled OSPF on the Layer 3 switch, the configuration and verification would work the same as it does on a router, as discussed in Chapter 20, “Implementing OSPF.” The routes that IOS adds to the Layer 3 switch’s IP routing table would list the VLAN interfaces as outgoing interfaces.|For instance, if you then enabled OSPF on the Layer 3 switch, the configuration and verification would work the same as it does on a router, as discussed in Chapter 20, “Implementing OSPF.” The routes that IOS adds to the Layer 3 switch’s IP routing table would list the VLAN interfaces as outgoing interfaces.
|
NOTE Some models of Cisco enterprise switches, based on model, IOS version, and IOS feature set, support different capabilities for IP routing and routing protocols, so for real networks, check the capabilities of the switch model by browsing at Cisco.com.|NOTE Some models of Cisco enterprise switches, based on model, IOS version, and IOS feature set, support different capabilities for IP routing and routing protocols, so for real networks, check the capabilities of the switch model by browsing at Cisco.com.
In particular, check the Cisco Feature Navigator (CFN) tool at http://www.cisco.com/go/cfn.|In particular, check the Cisco Feature Navigator (CFN) tool at http://www.cisco.com/go/cfn.
#### Troubleshooting Routing with SVIs
Troubleshooting Routing with SVIs   
__|__
--|--
|
There are two big topics to investigate when troubleshooting routing over LANs with SVIs.|There are two big topics to investigate when troubleshooting routing over LANs with SVIs.
|
First, you have to make sure the switch has been enabled to support IP routing.|First, you have to make sure the switch has been enabled to support IP routing.
Second, the VLAN associated with each VLAN interface must be known and active on the local switch;|Second, the VLAN associated with each VLAN interface must be known and active on the local switch;
|
otherwise, the VLAN interfaces do not come up.|otherwise, the VLAN interfaces do not come up.
|
First, about enabling IP routing, note that some models of Cisco switches default to enable Layer 3 switching, and some do not.|First, about enabling IP routing, note that some models of Cisco switches default to enable Layer 3 switching, and some do not.
So, to make sure your switch supports Layer 3 routing, look to those first few configuration commands listed in the configuration checklist found in the earlier section “Configuring Routing Using Switch SVIs.” Those commands are sdm prefer (followed by a reload) and then ip routing (after the reload).|So, to make sure your switch supports Layer 3 routing, look to those first few configuration commands listed in the configuration checklist found in the earlier section “Configuring Routing Using Switch SVIs.” Those commands are sdm prefer (followed by a reload) and then ip routing (after the reload).
|
The sdm prefer command changes how the switch forwarding chips allocate memory for different forwarding tables, and changes to those tables require a reload of the switch.|The sdm prefer command changes how the switch forwarding chips allocate memory for different forwarding tables, and changes to those tables require a reload of the switch.
By default, many access switches that support Layer 3 switching still have an SDM default that does not allocate space for an IP routing table.|By default, many access switches that support Layer 3 switching still have an SDM default that does not allocate space for an IP routing table.
Once changed and reloaded, the ip routing command then enables IPv4 routing in IOS software.|Once changed and reloaded, the ip routing command then enables IPv4 routing in IOS software.
Both are necessary before some Cisco switches will act as a Layer 3 switch.|Both are necessary before some Cisco switches will act as a Layer 3 switch.
|
Example 17-8 shows some symptoms on a router for which Layer 3 switching had not yet been enabled by the sdm prefer command.|Example 17-8 shows some symptoms on a router for which Layer 3 switching had not yet been enabled by the sdm prefer command.
As you can see, both the show ip route EXEC command and the ip routing config command are rejected because they do not exist to IOS until the sdm prefer command has been used (followed by a reload of the switch).|As you can see, both the show ip route EXEC command and the ip routing config command are rejected because they do not exist to IOS until the sdm prefer command has been used (followed by a reload of the switch).
|
Example 17-8 Evidence That a Switch Has Not Yet Enabled IPv4 Routing Example end.|Example 17-8 Evidence That a Switch Has Not Yet Enabled IPv4 Routing Example end.
|
The second big area to investigate when troubleshooting SVIs relates to the SVI state, a state that ties to the state of the associated VLANs. Each VLAN interface has a matching VLAN of the same number, and the VLAN interface’s state is tied to the state of the VLAN in certain ways.|The second big area to investigate when troubleshooting SVIs relates to the SVI state, a state that ties to the state of the associated VLANs. Each VLAN interface has a matching VLAN of the same number, and the VLAN interface’s state is tied to the state of the VLAN in certain ways.
In particular, for a VLAN interface to be in an up/up state:|In particular, for a VLAN interface to be in an up/up state:
|
Step 1.|Step 1.
The VLAN must be defined on the local switch (either explicitly or learned with VTP).|The VLAN must be defined on the local switch (either explicitly or learned with VTP).
|
Step 2.|Step 2.
The switch must have at least one up/up interface using the VLAN, either/both:|The switch must have at least one up/up interface using the VLAN, either/both:
|
A. An up/up access interface assigned to that VLAN B.|A. An up/up access interface assigned to that VLAN B.
A trunk interface for which the VLAN is in the allowed list, is STP forwarding, and is not VTP pruned Step 3.|A trunk interface for which the VLAN is in the allowed list, is STP forwarding, and is not VTP pruned Step 3.
The VLAN (not the VLAN interface) must be administratively enabled (that is, not shutdown).|The VLAN (not the VLAN interface) must be administratively enabled (that is, not shutdown).
|
Step 4.|Step 4.
The VLAN interface (not the VLAN) must be administratively enabled (that is, not shutdown).|The VLAN interface (not the VLAN) must be administratively enabled (that is, not shutdown).
|
When working through the steps in the list, keep in mind that the VLAN and the VLAN interface are related but separate ideas, and the configuration items are separate in the CLI.|When working through the steps in the list, keep in mind that the VLAN and the VLAN interface are related but separate ideas, and the configuration items are separate in the CLI.
|
The VLAN interface is a switch’s Layer 3 interface connected to the VLAN. If you want to route packets for the subnets on VLANs 11, 12, and 13, the matching VLAN interfaces must be numbered 11, 12, and 13.|The VLAN interface is a switch’s Layer 3 interface connected to the VLAN. If you want to route packets for the subnets on VLANs 11, 12, and 13, the matching VLAN interfaces must be numbered 11, 12, and 13.
And both the VLANs and the VLAN interfaces can be disabled and enabled with the shutdown and no shutdown commands (as mentioned in Steps 3 and 4 in the previous list), so you have to check for both.|And both the VLANs and the VLAN interfaces can be disabled and enabled with the shutdown and no shutdown commands (as mentioned in Steps 3 and 4 in the previous list), so you have to check for both.
|
Example 17-9 shows three scenarios, each of which leads to one of the VLAN interfaces in the previous configuration example (Figure 17-3, Example 17-6) to fail.|Example 17-9 shows three scenarios, each of which leads to one of the VLAN interfaces in the previous configuration example (Figure 17-3, Example 17-6) to fail.
At the beginning of the example, all three VLAN interfaces are up/up.|At the beginning of the example, all three VLAN interfaces are up/up.
VLANs 10, 20, and 30 each have at least one access interface up and working.|VLANs 10, 20, and 30 each have at least one access interface up and working.
The example works through three scenarios:|The example works through three scenarios:
###### Scenario 1: The last access interface in VLAN 10 is shut down (F0/1), so IOS shuts down
Scenario 1: The last access interface in VLAN 10 is shut down (F0/1), so IOS shuts down   
__|__
--|--
|
the VLAN 10 interface.|the VLAN 10 interface.
###### Scenario 2: VLAN 20 (not VLAN interface 20, but VLAN 20) is deleted, which results in
Scenario 2: VLAN 20 (not VLAN interface 20, but VLAN 20) is deleted, which results in   
__|__
--|--
|
IOS then bringing down (not shutting down) the VLAN 20 interface.|IOS then bringing down (not shutting down) the VLAN 20 interface.
###### Scenario 3: VLAN 30 (not VLAN interface 30, but VLAN 30) is shut down, which results
Scenario 3: VLAN 30 (not VLAN interface 30, but VLAN 30) is shut down, which results   
__|__
--|--
|
in IOS then bringing down (not shutting down) the VLAN 30 interface.|in IOS then bringing down (not shutting down) the VLAN 30 interface.
|
Example 17-9 Three Examples That Cause VLAN Interfaces to Fail Example end.|Example 17-9 Three Examples That Cause VLAN Interfaces to Fail Example end.
|
Note that the example ends with the three VLAN interfaces in an up/down state per the show ip interface brief command.|Note that the example ends with the three VLAN interfaces in an up/down state per the show ip interface brief command.
### VLAN Routing with Layer 3 Switch Routed Ports
VLAN Routing with Layer 3 Switch Routed Ports   
__|__
--|--
|
When Layer 3 switches use SVIs, the physical interfaces on the switches act like they always have: as Layer 2 interfaces.|When Layer 3 switches use SVIs, the physical interfaces on the switches act like they always have: as Layer 2 interfaces.
That is, the physical interfaces receive Ethernet frames.|That is, the physical interfaces receive Ethernet frames.
The switch learns the source MAC address of the frame, and the switch forwards the frame based on the destination MAC address.|The switch learns the source MAC address of the frame, and the switch forwards the frame based on the destination MAC address.
To perform routing, any Ethernet frames destined for any of the SVI interface MAC addresses trigger the processing of the Layer 2 switching logic, resulting in normal routing actions like stripping data-link headers, making a routing decision, and so on.|To perform routing, any Ethernet frames destined for any of the SVI interface MAC addresses trigger the processing of the Layer 2 switching logic, resulting in normal routing actions like stripping data-link headers, making a routing decision, and so on.
|
Alternately, the Layer 3 switch configuration can make a physical port act like a router interface instead of a switch interface.|Alternately, the Layer 3 switch configuration can make a physical port act like a router interface instead of a switch interface.
To do so, the switch configuration makes that port a routed port.|To do so, the switch configuration makes that port a routed port.
On a routed port, the switch does not perform Layer 2 switching logic on that frame.|On a routed port, the switch does not perform Layer 2 switching logic on that frame.
Instead, frames arriving in a routed port trigger the Layer 3 routing logic, including 1.|Instead, frames arriving in a routed port trigger the Layer 3 routing logic, including 1.
Stripping off the incoming frame’s Ethernet data-link header/trailer 2.|Stripping off the incoming frame’s Ethernet data-link header/trailer 2.
Making a Layer 3 forwarding decision by comparing the destination IP address to the IP routing table 3.|Making a Layer 3 forwarding decision by comparing the destination IP address to the IP routing table 3.
Adding a new Ethernet data-link header/trailer to the packet 4.|Adding a new Ethernet data-link header/trailer to the packet 4.
Forwarding the packet, encapsulated in a new frame This third major section of the chapter examines routed interfaces as configured on Cisco Layer 3 switches, but with a particular goal in mind: to also discuss Layer 3 EtherChannels.|Forwarding the packet, encapsulated in a new frame This third major section of the chapter examines routed interfaces as configured on Cisco Layer 3 switches, but with a particular goal in mind: to also discuss Layer 3 EtherChannels.
|
The exam topics do not mention routed interfaces specifically, but the exam topics do mention L3 EtherChannels, meaning Layer 3 EtherChannels.|The exam topics do not mention routed interfaces specifically, but the exam topics do mention L3 EtherChannels, meaning Layer 3 EtherChannels.
|
You might recall that Chapter 10, “RSTP and EtherChannel Configuration,” discussed Layer 2 EtherChannels.|You might recall that Chapter 10, “RSTP and EtherChannel Configuration,” discussed Layer 2 EtherChannels.
Like Layer 2 EtherChannels, Layer 3 EtherChannels also treat multiple links as one link.|Like Layer 2 EtherChannels, Layer 3 EtherChannels also treat multiple links as one link.
Unlike Layer 2 EtherChannels, however, Layer 3 EtherChannels treat the channel as a routed port instead of switched port.|Unlike Layer 2 EtherChannels, however, Layer 3 EtherChannels treat the channel as a routed port instead of switched port.
So this section first looks at routed ports on Cisco Layer 3 switches and then discusses Layer 3 EtherChannels.|So this section first looks at routed ports on Cisco Layer 3 switches and then discusses Layer 3 EtherChannels.
#### Implementing Routed Interfaces on Switches
Implementing Routed Interfaces on Switches   
__|__
--|--
|
When a Layer 3 switch needs a Layer 3 interface connected to a subnet, and only one physical interface connects to that subnet, the network engineer can choose to use a routed port instead of an SVI. Conversely, when the Layer 3 switch needs a Layer 3 interface connected to a subnet, and many physical interfaces on the switch connect to that subnet, an SVI needs to be used. (SVIs forward traffic internally into the VLAN, so that then the Layer 2 logic can forward the frame out any of the ports in the VLAN. Routed ports cannot.)|When a Layer 3 switch needs a Layer 3 interface connected to a subnet, and only one physical interface connects to that subnet, the network engineer can choose to use a routed port instead of an SVI. Conversely, when the Layer 3 switch needs a Layer 3 interface connected to a subnet, and many physical interfaces on the switch connect to that subnet, an SVI needs to be used. (SVIs forward traffic internally into the VLAN, so that then the Layer 2 logic can forward the frame out any of the ports in the VLAN. Routed ports cannot.)
|
To see why, consider the design in Figure 17-4, which repeats the same design from Figure 17-3 (used in the SVI examples).|To see why, consider the design in Figure 17-4, which repeats the same design from Figure 17-3 (used in the SVI examples).
In that design, the gray rectangle on the right represents the switch and its internals.|In that design, the gray rectangle on the right represents the switch and its internals.
On the right of the switch, at least two access ports sit in both VLAN 10 and VLAN 20.|On the right of the switch, at least two access ports sit in both VLAN 10 and VLAN 20.
However, that figure shows a single link from the switch to Router B1. The switch could configure the port as an access port in a separate VLAN, as shown with VLAN 30 in Examples 17-6 and 17-7.|However, that figure shows a single link from the switch to Router B1. The switch could configure the port as an access port in a separate VLAN, as shown with VLAN 30 in Examples 17-6 and 17-7.
However, with only one switch port needed, the switch could configure that link as a routed port, as shown in the figure.|However, with only one switch port needed, the switch could configure that link as a routed port, as shown in the figure.
|
Figure 17-4 Routing on a Routed Interface on a Switch Enabling a switch interface to be a routed interface instead of a switched interface is simple:|Figure 17-4 Routing on a Routed Interface on a Switch Enabling a switch interface to be a routed interface instead of a switched interface is simple:
|
just use the no switchport subcommand on the physical interface.|just use the no switchport subcommand on the physical interface.
Cisco switches capable of being a Layer 3 switch use a default of the switchport command to each switch physical interface.|Cisco switches capable of being a Layer 3 switch use a default of the switchport command to each switch physical interface.
Think about the word switchport for a moment.|Think about the word switchport for a moment.
With that term, Cisco tells the switch to treat the port like it is a port on a switch—that is, a Layer 2 port on a switch.|With that term, Cisco tells the switch to treat the port like it is a port on a switch—that is, a Layer 2 port on a switch.
To make the port stop acting like a switch port and instead act like a router port, use the no switchport command on the interface.|To make the port stop acting like a switch port and instead act like a router port, use the no switchport command on the interface.
|
Once the port is acting as a routed port, think of it like a router interface.|Once the port is acting as a routed port, think of it like a router interface.
That is, configure the IP address on the physical port, as implied in Figure 17-4.|That is, configure the IP address on the physical port, as implied in Figure 17-4.
Example 17-10 shows a completed configuration for the interfaces configured on the switch in Figure 17-4.|Example 17-10 shows a completed configuration for the interfaces configured on the switch in Figure 17-4.
Note that the design uses the exact same IP subnets as the example that showed SVI configuration in Example 17-6, but now, the port connected to subnet 10.1.30.0 has been converted to a routed port.|Note that the design uses the exact same IP subnets as the example that showed SVI configuration in Example 17-6, but now, the port connected to subnet 10.1.30.0 has been converted to a routed port.
All you have to do is add the no switchport command to the physical interface and configure the IP address on the physical interface.|All you have to do is add the no switchport command to the physical interface and configure the IP address on the physical interface.
|
Example 17-10 Configuring Interface G0/1 on Switch SW1 as a Routed Port Example end.|Example 17-10 Configuring Interface G0/1 on Switch SW1 as a Routed Port Example end.
|
Once configured, the routed interface will show up differently in command output in the switch.|Once configured, the routed interface will show up differently in command output in the switch.
In particular, for an interface configured as a routed port with an IP address, like interface GigabitEthernet0/1 in the previous example:|In particular, for an interface configured as a routed port with an IP address, like interface GigabitEthernet0/1 in the previous example:
|
show interfaces: Similar to the same command on a router, the output will display the IP address of the interface. (Conversely, for switch ports, this command does not list an IP address.)|show interfaces: Similar to the same command on a router, the output will display the IP address of the interface. (Conversely, for switch ports, this command does not list an IP address.)
|
show interfaces status: Under the “VLAN” heading, instead of listing the access VLAN or the word trunk, the output lists the word routed, meaning that it is a routed port.|show interfaces status: Under the “VLAN” heading, instead of listing the access VLAN or the word trunk, the output lists the word routed, meaning that it is a routed port.
|
show ip route: Lists the routed port as an outgoing interface in routes.|show ip route: Lists the routed port as an outgoing interface in routes.
|
show interfaces type number switchport: If a routed port, the output is short and confirms that the port is not a switch port. (If the port is a Layer 2 port, this command lists many configuration and status details.)|show interfaces type number switchport: If a routed port, the output is short and confirms that the port is not a switch port. (If the port is a Layer 2 port, this command lists many configuration and status details.)
|
Example 17-11 shows samples of all four of these commands as taken from the switch as configured in Example 17-10.|Example 17-11 shows samples of all four of these commands as taken from the switch as configured in Example 17-10.
|
Example 17-11 Verification Commands for Routed Ports on Switches Example end.|Example 17-11 Verification Commands for Routed Ports on Switches Example end.
|
So, with two options—SVI and routed ports—where should you use each?|So, with two options—SVI and routed ports—where should you use each?
|
For any topologies with a point-to-point link between two devices that do routing, a routed interface works well.|For any topologies with a point-to-point link between two devices that do routing, a routed interface works well.
|
Figure 17-5 shows an example of where to use SVIs and where to use routed ports in a typical core/distribution/access design.|Figure 17-5 shows an example of where to use SVIs and where to use routed ports in a typical core/distribution/access design.
In this design, the core (Core1, Core2) and distribution (D11 through D14) switches perform Layer 3 switching.|In this design, the core (Core1, Core2) and distribution (D11 through D14) switches perform Layer 3 switching.
All the ports that are links directly between the Layer 3 switches can be routed interfaces.|All the ports that are links directly between the Layer 3 switches can be routed interfaces.
For VLANs for which many interfaces (access and trunk) connect to the VLAN, SVIs make sense because the SVIs can send and receive traffic out multiple ports on the same switch.|For VLANs for which many interfaces (access and trunk) connect to the VLAN, SVIs make sense because the SVIs can send and receive traffic out multiple ports on the same switch.
In this design, all the ports on Core1 and Core2 will be routed ports, while the four distribution switches will use some routed ports and some SVIs.|In this design, all the ports on Core1 and Core2 will be routed ports, while the four distribution switches will use some routed ports and some SVIs.
|
Figure 17-5 Using Routed Interfaces for Core and Distribution Layer 3 Links|Figure 17-5 Using Routed Interfaces for Core and Distribution Layer 3 Links
#### Implementing Layer 3 EtherChannels
Implementing Layer 3 EtherChannels   
__|__
--|--
|
So far, this section has stated that routed interfaces can be used with a single point-to-point link between pairs of Layer 3 switches, or between a Layer 3 switch and a router.|So far, this section has stated that routed interfaces can be used with a single point-to-point link between pairs of Layer 3 switches, or between a Layer 3 switch and a router.
However, in most designs, the network engineers use at least two links between each pair of distribution and core switches, as shown in Figure 17-6.|However, in most designs, the network engineers use at least two links between each pair of distribution and core switches, as shown in Figure 17-6.
|
Figure 17-6 Two Links Between Each Distribution and Core Switch While each individual port in the distribution and core could be treated as a separate routed port, it is better to combine each pair of parallel links into a Layer 3 EtherChannel.|Figure 17-6 Two Links Between Each Distribution and Core Switch While each individual port in the distribution and core could be treated as a separate routed port, it is better to combine each pair of parallel links into a Layer 3 EtherChannel.
Without using EtherChannel, you can still make each port on each switch in the center of the figure be a routed port.|Without using EtherChannel, you can still make each port on each switch in the center of the figure be a routed port.
It works.|It works.
However, once you enable a routing protocol but don’t use EtherChannels, each Layer 3 switch will now learn two IP routes with the same neighboring switch as the next hop—one route over one link, another route over the other link.|However, once you enable a routing protocol but don’t use EtherChannels, each Layer 3 switch will now learn two IP routes with the same neighboring switch as the next hop—one route over one link, another route over the other link.
|
Using a Layer 3 EtherChannel makes more sense with multiple parallel links between two switches.|Using a Layer 3 EtherChannel makes more sense with multiple parallel links between two switches.
By doing so, each pair of links acts as one Layer 3 link.|By doing so, each pair of links acts as one Layer 3 link.
So, each pair of switches has one routing protocol neighbor relationship with the neighbor, and not two.|So, each pair of switches has one routing protocol neighbor relationship with the neighbor, and not two.
Each switch learns one route per destination per pair of links, and not two.|Each switch learns one route per destination per pair of links, and not two.
IOS then balances the traffic, often with better balancing than the balancing that occurs with the use of multiple IP routes to the same subnet.|IOS then balances the traffic, often with better balancing than the balancing that occurs with the use of multiple IP routes to the same subnet.
Overall, the Layer 3 EtherChannel approach works much better than leaving each link as a separate routed port and using Layer 3 balancing.|Overall, the Layer 3 EtherChannel approach works much better than leaving each link as a separate routed port and using Layer 3 balancing.
|
Compared to what you have already learned, configuring a Layer 3 EtherChannel takes only a little more work.|Compared to what you have already learned, configuring a Layer 3 EtherChannel takes only a little more work.
Chapter 10 already showed you how to configure an EtherChannel.|Chapter 10 already showed you how to configure an EtherChannel.
This chapter has already shown how to make a port a Layer 3 routed port.|This chapter has already shown how to make a port a Layer 3 routed port.
Next, you have to combine the two ideas by combining both the EtherChannel and routed port configuration.|Next, you have to combine the two ideas by combining both the EtherChannel and routed port configuration.
|
The following checklist shows the steps, assuming a static definition.|The following checklist shows the steps, assuming a static definition.
|
Step 1.|Step 1.
Configure the physical interfaces as follows, in interface configuration mode:|Configure the physical interfaces as follows, in interface configuration mode:
|
A. Add the channel-group number mode on command to add it to the channel.|A. Add the channel-group number mode on command to add it to the channel.
|
Use the same number for all physical interfaces on the same switch, but the number used (the channel-group number) can differ on the two neighboring switches.|Use the same number for all physical interfaces on the same switch, but the number used (the channel-group number) can differ on the two neighboring switches.
|
B. Add the no switchport command to make each physical port a routed port.|B. Add the no switchport command to make each physical port a routed port.
|
Step 2.|Step 2.
Configure the PortChannel interface:|Configure the PortChannel interface:
|
A. Use the interface port-channel number command to move to port-channel configuration mode for the same channel number configured on the physical interfaces.|A. Use the interface port-channel number command to move to port-channel configuration mode for the same channel number configured on the physical interfaces.
|
B. Add the no switchport command to make sure that the port-channel interface acts as a routed port. (IOS may have already added this command.)|B. Add the no switchport command to make sure that the port-channel interface acts as a routed port. (IOS may have already added this command.)
|
C. Use the ip address address mask command to configure the address and mask.|C. Use the ip address address mask command to configure the address and mask.
|
NOTE Cisco uses the term EtherChannel in concepts discussed in this section and then uses the term PortChannel, with command keyword port-channel, when verifying and configuring EtherChannels.|NOTE Cisco uses the term EtherChannel in concepts discussed in this section and then uses the term PortChannel, with command keyword port-channel, when verifying and configuring EtherChannels.
For the purposes of understanding the technology, you may treat these terms as synonyms.|For the purposes of understanding the technology, you may treat these terms as synonyms.
However, it helps to pay close attention to the use of the terms PortChannel and EtherChannel as you work through the examples in this section because IOS uses both.|However, it helps to pay close attention to the use of the terms PortChannel and EtherChannel as you work through the examples in this section because IOS uses both.
|
Example 17-12 shows an example of the configuration for a Layer 3 EtherChannel for switch SW1 in Figure 17-7.|Example 17-12 shows an example of the configuration for a Layer 3 EtherChannel for switch SW1 in Figure 17-7.
The EtherChannel defines port-channel interface 12 and uses subnet|The EtherChannel defines port-channel interface 12 and uses subnet
###### 10.1.12.0/24.
10.1.12.0/24.   
__|__
--|--
|
Figure 17-7 Design Used in EtherChannel Configuration Examples Config Checklist Example 17-12 Layer 3 EtherChannel Configuration on Switch SW1 Example end.|Figure 17-7 Design Used in EtherChannel Configuration Examples Config Checklist Example 17-12 Layer 3 EtherChannel Configuration on Switch SW1 Example end.
|
Of particular importance, note that although the physical interfaces and PortChannel interface are all routed ports, the IP address should be placed on the PortChannel interface only.|Of particular importance, note that although the physical interfaces and PortChannel interface are all routed ports, the IP address should be placed on the PortChannel interface only.
In fact, when the no switchport command is configured on an interface, IOS adds the no ip address command to the interface.|In fact, when the no switchport command is configured on an interface, IOS adds the no ip address command to the interface.
Then configure the IP address on the PortChannel interface only.|Then configure the IP address on the PortChannel interface only.
|
Once configured, the PortChannel interface appears in several commands, as shown in Example 17-13.|Once configured, the PortChannel interface appears in several commands, as shown in Example 17-13.
The commands that list IP addresses and routes refer to the PortChannel interface.|The commands that list IP addresses and routes refer to the PortChannel interface.
Also, note that the show interfaces status command lists the fact that the physical ports and the port-channel 12 interface are all routed ports.|Also, note that the show interfaces status command lists the fact that the physical ports and the port-channel 12 interface are all routed ports.
|
Example 17-13 Verification Commands Listing Interface Port-Channel 12 from Switch Example end.|Example 17-13 Verification Commands Listing Interface Port-Channel 12 from Switch Example end.
|
For a final bit of verification, you can examine the EtherChannel directly with the show etherchannel summary command as listed in Example 17-14.|For a final bit of verification, you can examine the EtherChannel directly with the show etherchannel summary command as listed in Example 17-14.
Note in particular that it lists a flag legend for characters that identify key operational states, such as whether a port is bundled (included) in the PortChannel (P) and whether it is acting as a routed (R) or switched (S) port.|Note in particular that it lists a flag legend for characters that identify key operational states, such as whether a port is bundled (included) in the PortChannel (P) and whether it is acting as a routed (R) or switched (S) port.
|
Example 17-14 Verifying the EtherChannel Example end.|Example 17-14 Verifying the EtherChannel Example end.
#### Troubleshooting Layer 3 EtherChannels
Troubleshooting Layer 3 EtherChannels   
__|__
--|--
|
When you are troubleshooting a Layer 3 EtherChannel, there are two main areas to consider.|When you are troubleshooting a Layer 3 EtherChannel, there are two main areas to consider.
|
First, you need to look at the configuration of the channel-group command, which enables an interface for an EtherChannel.|First, you need to look at the configuration of the channel-group command, which enables an interface for an EtherChannel.
Second, you should check a list of settings that must match on the interfaces for a Layer 3 EtherChannel to work correctly.|Second, you should check a list of settings that must match on the interfaces for a Layer 3 EtherChannel to work correctly.
|
As for the channel-group interface subcommand, this command can enable EtherChannel statically or dynamically.|As for the channel-group interface subcommand, this command can enable EtherChannel statically or dynamically.
If dynamic, this command’s keywords imply either Port Aggregation Protocol (PaGP) or Link Aggregation Control Protocol (LACP) as the protocol to negotiate between the neighboring switches whether they put the link into the EtherChannel.|If dynamic, this command’s keywords imply either Port Aggregation Protocol (PaGP) or Link Aggregation Control Protocol (LACP) as the protocol to negotiate between the neighboring switches whether they put the link into the EtherChannel.
|
If all this sounds vaguely familiar, it is the exact same configuration covered way back in the Chapter 10 section “Configuring Dynamic EtherChannels.” The configuration of the channel-group subcommand is exactly the same, with the same requirements, whether configuring Layer 2 or Layer 3 EtherChannels.|If all this sounds vaguely familiar, it is the exact same configuration covered way back in the Chapter 10 section “Configuring Dynamic EtherChannels.” The configuration of the channel-group subcommand is exactly the same, with the same requirements, whether configuring Layer 2 or Layer 3 EtherChannels.
So, it might be a good time to review those EtherChannel configuration details from Chapter 10.|So, it might be a good time to review those EtherChannel configuration details from Chapter 10.
However, regardless of when you review and master those commands, note that the configuration of the EtherChannel (with the channel-group subcommand) is the same, whether Layer 2 or Layer 3.|However, regardless of when you review and master those commands, note that the configuration of the EtherChannel (with the channel-group subcommand) is the same, whether Layer 2 or Layer 3.
|
Additionally, you must do more than just configure the channel-group command correctly for all the physical ports to be bundled into the EtherChannel.|Additionally, you must do more than just configure the channel-group command correctly for all the physical ports to be bundled into the EtherChannel.
Layer 2 EtherChannels have a longer list of requirements, but Layer 3 EtherChannels also require a few consistency checks between the ports before they can be added to the EtherChannel.|Layer 2 EtherChannels have a longer list of requirements, but Layer 3 EtherChannels also require a few consistency checks between the ports before they can be added to the EtherChannel.
The following is the list of requirements for Layer 3 EtherChannels:|The following is the list of requirements for Layer 3 EtherChannels:
|
no switchport: The PortChannel interface must be configured with the no switchport command, and so must the physical interfaces.|no switchport: The PortChannel interface must be configured with the no switchport command, and so must the physical interfaces.
If a physical interface is not also configured with the no switchport command, it will not become operational in the EtherChannel.|If a physical interface is not also configured with the no switchport command, it will not become operational in the EtherChannel.
|
Speed: The physical ports in the channel must use the same speed.|Speed: The physical ports in the channel must use the same speed.
|
duplex: The physical ports in the channel must use the same duplex.|duplex: The physical ports in the channel must use the same duplex.
### Chapter Review
Chapter Review   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|One key to doing well on the exams is to perform repetitive spaced review sessions.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.
Refer to the “Your Study Plan” element for more details.|Refer to the “Your Study Plan” element for more details.
Table 17-2 outlines the key review elements and where you can find them.|Table 17-2 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 17-2 Chapter Review Tracking Table end.|Table 17-2 Chapter Review Tracking Table end.
|
Review All the Key Topics Key Terms You Should Know router-on-a-stick (ROAS), switched virtual interface (SVI), VLAN interface, Layer 3 EtherChannel (L3 EtherChannel), routed port, Layer 3 switch, multilayer switch, subinterfaces Command References Tables 17-4 and 17-5 list configuration and verification commands used in this chapter.|Review All the Key Topics Key Terms You Should Know router-on-a-stick (ROAS), switched virtual interface (SVI), VLAN interface, Layer 3 EtherChannel (L3 EtherChannel), routed port, Layer 3 switch, multilayer switch, subinterfaces Command References Tables 17-4 and 17-5 list configuration and verification commands used in this chapter.
As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.|As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Then repeat the exercise, covering the right column, and try to recall what the command does.
|
Table 17-4 Chapter 17 Configuration Command Reference Table end.|Table 17-4 Chapter 17 Configuration Command Reference Table end.
|
Table 17-5 Chapter 17 EXEC Command Reference Table end.|Table 17-5 Chapter 17 EXEC Command Reference Table end.
## Chapter 18 Troubleshooting IPv4 Routing
Chapter 18 Troubleshooting IPv4 Routing   
__|__
--|--
|
This chapter covers the following exam topics:|This chapter covers the following exam topics:
###### 1.0 Network Fundamentals
1.0 Network Fundamentals   
###### 1.6 Configure and verify IPv4 addressing and subnetting
1.6 Configure and verify IPv4 addressing and subnetting   
###### 3.0 IP Connectivity
3.0 IP Connectivity   
###### 3.3 Configure and verify IPv4 and IPv6 static routing
3.3 Configure and verify IPv4 and IPv6 static routing   
###### 3.3.a Default route
3.3.a Default route   
###### 3.3.b Network route
3.3.b Network route   
###### 3.3.c Host route
3.3.c Host route   
###### 3.3.d Floating static
3.3.d Floating static   
__|__
--|--
|
The first three chapters in this part of the book took you from a starting point of understanding IP addressing and subnetting to the details of implementing IP addressing, routing between connected subnets, and configuring static routes.|The first three chapters in this part of the book took you from a starting point of understanding IP addressing and subnetting to the details of implementing IP addressing, routing between connected subnets, and configuring static routes.
All those steps include the idea of configuring a command and seeing a route show up in the IP routing table on that same router.|All those steps include the idea of configuring a command and seeing a route show up in the IP routing table on that same router.
|
This chapter turns our attention to routing from end-to-end across an entire enterprise network.|This chapter turns our attention to routing from end-to-end across an entire enterprise network.
|
How do you troubleshoot an IPv4 network?|How do you troubleshoot an IPv4 network?
How do you verify correct operation, identify root causes, and fix those for various IP routing features?|How do you verify correct operation, identify root causes, and fix those for various IP routing features?
How do you do that in the presence of an IP addressing and subnetting plan, requiring you to apply all that subnetting math from Part IV of this book and the basic address/mask and static route configuration from the other chapters here in Part V?|How do you do that in the presence of an IP addressing and subnetting plan, requiring you to apply all that subnetting math from Part IV of this book and the basic address/mask and static route configuration from the other chapters here in Part V?
This chapter answers some of those questions.|This chapter answers some of those questions.
|
In particular, this chapter focuses on two tools and how to use them: ping and traceroute.|In particular, this chapter focuses on two tools and how to use them: ping and traceroute.
|
Both tools test the IPv4 data plane; that is, the ability of each networking device to route or forward IPv4 packets.|Both tools test the IPv4 data plane; that is, the ability of each networking device to route or forward IPv4 packets.
This chapter devotes a major section each to ping and traceroute.|This chapter devotes a major section each to ping and traceroute.
The chapter then ends with a short discussion of two other router tools that can also be useful for troubleshooting: Telnet and Secure Shell (SSH).|The chapter then ends with a short discussion of two other router tools that can also be useful for troubleshooting: Telnet and Secure Shell (SSH).
### “Do I Know This Already?” Quiz
“Do I Know This Already?” Quiz   
__|__
--|--
|
I put DIKTA quizzes in most of the chapters as a tool to help you decide how to approach reading a chapter.|I put DIKTA quizzes in most of the chapters as a tool to help you decide how to approach reading a chapter.
However, this chapter does not have a DIKTA quiz because I think you should read it regardless of your prior knowledge.|However, this chapter does not have a DIKTA quiz because I think you should read it regardless of your prior knowledge.
As with all chapters in this book, this chapter introduces new concepts, but it also acts as a tool to review and deepen your understanding of IP routing.|As with all chapters in this book, this chapter introduces new concepts, but it also acts as a tool to review and deepen your understanding of IP routing.
I hope you enjoy the perspectives on using ping and traceroute in this chapter.|I hope you enjoy the perspectives on using ping and traceroute in this chapter.
|
CHAPTER 18|CHAPTER 18
### Foundation Topics
Foundation Topics   
### Problem Isolation Using the ping Command
Problem Isolation Using the ping Command   
__|__
--|--
|
Someone sends you an email or text, or a phone message, asking you to look into a user’s network problem.|Someone sends you an email or text, or a phone message, asking you to look into a user’s network problem.
You Secure Shell (SSH) to a router and issue a ping command that works.|You Secure Shell (SSH) to a router and issue a ping command that works.
|
What does that result rule out as a possible reason for the problem?|What does that result rule out as a possible reason for the problem?
What does it rule in as still being a possible root cause?|What does it rule in as still being a possible root cause?
|
Then you issue another ping to another address, and this time the ping fails.|Then you issue another ping to another address, and this time the ping fails.
Again, what does the failure of that ping command tell you?|Again, what does the failure of that ping command tell you?
What parts of IPv4 routing may still be a problem, and what parts do you now know are not a problem?|What parts of IPv4 routing may still be a problem, and what parts do you now know are not a problem?
|
The ping command gives us one of the most common network troubleshooting tools.|The ping command gives us one of the most common network troubleshooting tools.
When the ping command succeeds, it confirms many individual parts of how IP routing works, ruling out some possible causes of the current problem.|When the ping command succeeds, it confirms many individual parts of how IP routing works, ruling out some possible causes of the current problem.
When a ping command fails, it often helps narrow down where in the internetwork the root cause of the problem may be happening, further isolating the problem.|When a ping command fails, it often helps narrow down where in the internetwork the root cause of the problem may be happening, further isolating the problem.
|
This section begins with a brief explanation of how ping works.|This section begins with a brief explanation of how ping works.
It then moves on to some suggestions and analysis of how to use the ping command to isolate problems by removing some items from consideration.|It then moves on to some suggestions and analysis of how to use the ping command to isolate problems by removing some items from consideration.
#### Ping Command Basics
Ping Command Basics   
__|__
--|--
|
The ping command tests connectivity by sending packets to an IP address, expecting the device at that address to send packets back.|The ping command tests connectivity by sending packets to an IP address, expecting the device at that address to send packets back.
The command sends packets that mean “if you receive this packet, and it is addressed to you, send a reply back.” Each time the ping command sends one of these packets and receives the message sent back by the other host, the ping command knows a packet made it from the source host to the destination and back.|The command sends packets that mean “if you receive this packet, and it is addressed to you, send a reply back.” Each time the ping command sends one of these packets and receives the message sent back by the other host, the ping command knows a packet made it from the source host to the destination and back.
|
More formally, the ping command uses the Internet Control Message Protocol (ICMP), specifically the ICMP echo request and ICMP echo reply messages.|More formally, the ping command uses the Internet Control Message Protocol (ICMP), specifically the ICMP echo request and ICMP echo reply messages.
ICMP defines many other messages as well, but these two messages were made specifically for connectivity testing by commands like ping.|ICMP defines many other messages as well, but these two messages were made specifically for connectivity testing by commands like ping.
As a protocol, ICMP does not rely on TCP or UDP, and it does not use any application layer protocol.|As a protocol, ICMP does not rely on TCP or UDP, and it does not use any application layer protocol.
It functions as part of Layer 3, as a control protocol to assist IP by helping manage the IP network functions.|It functions as part of Layer 3, as a control protocol to assist IP by helping manage the IP network functions.
|
Figure 18-1 shows the ICMP messages, with IP headers, in an example.|Figure 18-1 shows the ICMP messages, with IP headers, in an example.
In this case, the user at host A opens a command prompt and issues the ping 172.16.2.101 command, testing connectivity to host B.|In this case, the user at host A opens a command prompt and issues the ping 172.16.2.101 command, testing connectivity to host B.
The command sends one echo request and waits (Step 1); host B receives the messages and sends back an echo reply (Step 2).|The command sends one echo request and waits (Step 1); host B receives the messages and sends back an echo reply (Step 2).
|
Figure 18-1 Concept Behind ping 172.16.2.101 on Host A The ping command is supported on many different devices and many common operating systems.|Figure 18-1 Concept Behind ping 172.16.2.101 on Host A The ping command is supported on many different devices and many common operating systems.
The command has many options: the name or IP address of the destination, how many times the command should send an echo request, how long the command should wait (timeout) for an echo reply, how big to make the packets, and many other options.|The command has many options: the name or IP address of the destination, how many times the command should send an echo request, how long the command should wait (timeout) for an echo reply, how big to make the packets, and many other options.
Example 18-1 shows a sample from host A, with the same command that matches the concept in Figure 18-1: a ping 172.16.2.101 command on host A.|Example 18-1 shows a sample from host A, with the same command that matches the concept in Figure 18-1: a ping 172.16.2.101 command on host A.
|
Example 18-1 Sample Output from Host A’s ping 172.16.2.101 Command Example end.|Example 18-1 Sample Output from Host A’s ping 172.16.2.101 Command Example end.
#### Strategies and Results When Testing with the ping Command
Strategies and Results When Testing with the ping Command   
__|__
--|--
|
Often, the person handling initial calls from users about problems (often called a customer support rep, or CSR) cannot issue ping commands from the user’s device.|Often, the person handling initial calls from users about problems (often called a customer support rep, or CSR) cannot issue ping commands from the user’s device.
In some cases, talking users through typing the right commands and making the right clicks on their machines can be a problem.|In some cases, talking users through typing the right commands and making the right clicks on their machines can be a problem.
Or, the user just might not be available.|Or, the user just might not be available.
As an alternative, using different ping commands from different routers can help isolate the problem.|As an alternative, using different ping commands from different routers can help isolate the problem.
|
The problem with using ping commands from routers, instead of from the host that has the problem, is that no single router ping command can exactly replicate a ping command done from the user’s device.|The problem with using ping commands from routers, instead of from the host that has the problem, is that no single router ping command can exactly replicate a ping command done from the user’s device.
However, each different ping command can help isolate a problem further.|However, each different ping command can help isolate a problem further.
The rest of this section of ping commands discusses troubleshooting IPv4 routing by using various ping commands from the command-line interface (CLI) of a router.|The rest of this section of ping commands discusses troubleshooting IPv4 routing by using various ping commands from the command-line interface (CLI) of a router.
##### Testing Longer Routes from Near the Source of the Problem
Testing Longer Routes from Near the Source of the Problem   
__|__
--|--
|
Most problems begin with some idea like “host X cannot communicate with host Y.” A great first troubleshooting step is to issue a ping command from X for host Y’s IP address.|Most problems begin with some idea like “host X cannot communicate with host Y.” A great first troubleshooting step is to issue a ping command from X for host Y’s IP address.
|
However, assuming the engineer does not have access to host X, the engineer can instead issue the ping from the router nearest X, typically the router acting as host X’s default gateway.|However, assuming the engineer does not have access to host X, the engineer can instead issue the ping from the router nearest X, typically the router acting as host X’s default gateway.
|
For instance, in Figure 18-1, imagine that the user of host A had called IT support with a problem related to sending packets to host B.|For instance, in Figure 18-1, imagine that the user of host A had called IT support with a problem related to sending packets to host B.
A ping 172.16.2.101 command on host A would be a great first troubleshooting step, but the CSR cannot access host A or get in touch with the user of host A.|A ping 172.16.2.101 command on host A would be a great first troubleshooting step, but the CSR cannot access host A or get in touch with the user of host A.
So, the CSR telnets to Router R1 and pings host B from there, as shown in Example 18-2.|So, the CSR telnets to Router R1 and pings host B from there, as shown in Example 18-2.
|
Example 18-2 Router R2 Pings Host B (Two Commands)|Example 18-2 Router R2 Pings Host B (Two Commands)
|
Example end.|Example end.
|
First, take a moment to review the output of the first IOS ping command.|First, take a moment to review the output of the first IOS ping command.
By default, the Cisco IOS ping command sends five echo messages, with a timeout of 2 seconds.|By default, the Cisco IOS ping command sends five echo messages, with a timeout of 2 seconds.
If the command does not receive an echo reply within 2 seconds, the command considers that message to be a failure, and the command lists a period.|If the command does not receive an echo reply within 2 seconds, the command considers that message to be a failure, and the command lists a period.
If a successful reply is received within 2 seconds, the command displays an exclamation point.|If a successful reply is received within 2 seconds, the command displays an exclamation point.
So, in this first command, the first echo reply timed out, whereas the other four received a matching echo reply within 2 seconds.|So, in this first command, the first echo reply timed out, whereas the other four received a matching echo reply within 2 seconds.
|
As a quick aside, the example shows a common and normal behavior with ping commands:|As a quick aside, the example shows a common and normal behavior with ping commands:
|
the first ping command shows one failure to start, but then the rest of the messages work.|the first ping command shows one failure to start, but then the rest of the messages work.
|
This usually happens because some device in the end-to-end route is missing an ARP table entry.|This usually happens because some device in the end-to-end route is missing an ARP table entry.
|
Now think about troubleshooting and what a working ping command tells us about the current behavior of this internetwork.|Now think about troubleshooting and what a working ping command tells us about the current behavior of this internetwork.
First, focus on the big picture for a moment:|First, focus on the big picture for a moment:
###### R1 can send ICMP echo request messages to host B (172.16.2.101).
R1 can send ICMP echo request messages to host B (172.16.2.101).   
###### R1 sends these messages from its outgoing interface’s IP address (by default), 172.16.4.1 in
R1 sends these messages from its outgoing interface’s IP address (by default), 172.16.4.1 in   
__|__
--|--
|
this case.|this case.
###### Host B can send ICMP echo reply messages to R1’s 172.16.4.1 IP address (hosts send echo
Host B can send ICMP echo reply messages to R1’s 172.16.4.1 IP address (hosts send echo   
__|__
--|--
|
reply messages to the IP address from which the echo request was received).|reply messages to the IP address from which the echo request was received).
|
Figure 18-2 shows the packet flow.|Figure 18-2 shows the packet flow.
|
Figure 18-2 Standard ping 172.6.2.101 Command Using the Source Interface IP Address Next, think about IPv4 routing.|Figure 18-2 Standard ping 172.6.2.101 Command Using the Source Interface IP Address Next, think about IPv4 routing.
In the forward direction, R1 must have a route that matches host B’s address (172.16.2.101); this route will be either a static route or one learned with a routing protocol.|In the forward direction, R1 must have a route that matches host B’s address (172.16.2.101); this route will be either a static route or one learned with a routing protocol.
R2 also needs a route for host B’s address, in this case a connected route to B’s subnet (172.16.2.0/24), as shown in the top arrow lines in Figure 18-3.|R2 also needs a route for host B’s address, in this case a connected route to B’s subnet (172.16.2.0/24), as shown in the top arrow lines in Figure 18-3.
|
Figure 18-3 Layer 3 Routes Needed for R1’s Ping 172.16.2.101 to Work The arrow lines on the bottom of Figure 18-3 show the routes needed to forward the ICMP echo reply message back to Router R1’s 172.16.4.1 interface.|Figure 18-3 Layer 3 Routes Needed for R1’s Ping 172.16.2.101 to Work The arrow lines on the bottom of Figure 18-3 show the routes needed to forward the ICMP echo reply message back to Router R1’s 172.16.4.1 interface.
First, host B must have a valid default router setting because 172.16.4.1 sits in a different subnet than host B.|First, host B must have a valid default router setting because 172.16.4.1 sits in a different subnet than host B.
R2 must also have a route that matches destination 172.16.4.1 (in this case, likely to be a connected route).|R2 must also have a route that matches destination 172.16.4.1 (in this case, likely to be a connected route).
|
The working ping commands in Example 18-2 also require the data-link and physical layer details to be working.|The working ping commands in Example 18-2 also require the data-link and physical layer details to be working.
The WAN link must be working: The router interfaces must be up/up, which typically indicates that the link can pass data.|The WAN link must be working: The router interfaces must be up/up, which typically indicates that the link can pass data.
On the LAN, R2’s LAN interface must be in an up/up state.|On the LAN, R2’s LAN interface must be in an up/up state.
In addition, everything discussed about Ethernet LANs must be working because the ping confirmed that the packets went all the way from R1 to host B and back.|In addition, everything discussed about Ethernet LANs must be working because the ping confirmed that the packets went all the way from R1 to host B and back.
In particular|In particular
###### The switch interfaces in use are in a connected (up/up) state.
The switch interfaces in use are in a connected (up/up) state.   
__|__
--|--
|
filter frames sent by R2 or host B.|filter frames sent by R2 or host B.
###### STP has placed the right ports into a forwarding state.
STP has placed the right ports into a forwarding state.   
__|__
--|--
|
The ping 172.16.2.101 command in Example 18-2 also confirms that IP access control lists (ACL) did not filter the ICMP messages.|The ping 172.16.2.101 command in Example 18-2 also confirms that IP access control lists (ACL) did not filter the ICMP messages.
One ACL contains a set of matching rules and actions: some matched packets are filtered (discarded), while others can continue on their path as normal.|One ACL contains a set of matching rules and actions: some matched packets are filtered (discarded), while others can continue on their path as normal.
ACLs can examine packets as they enter or exit a router interface, so Figure 18-4 shows the various locations on routers R1 and R2 where an ACL could have filtered (discarded) the ICMP messages. (Note that an outbound ACL on router R1 would not filter packets created on R1, so there is no rightward-facing arrow over R1.).|ACLs can examine packets as they enter or exit a router interface, so Figure 18-4 shows the various locations on routers R1 and R2 where an ACL could have filtered (discarded) the ICMP messages. (Note that an outbound ACL on router R1 would not filter packets created on R1, so there is no rightward-facing arrow over R1.).
|
Figure 18-4 Locations Where IP ACLs Could Have Filtered the Ping Messages Finally, the working ping 172.16.2.101 command on R1 can also be used to reasonably predict that ARP worked and that switch SW2 learned MAC addresses for its MAC address table.|Figure 18-4 Locations Where IP ACLs Could Have Filtered the Ping Messages Finally, the working ping 172.16.2.101 command on R1 can also be used to reasonably predict that ARP worked and that switch SW2 learned MAC addresses for its MAC address table.
R2 and host B need to know each other’s MAC addresses so that they can encapsulate the IP packet inside an Ethernet frame, which means both must have a matching ARP table entry.|R2 and host B need to know each other’s MAC addresses so that they can encapsulate the IP packet inside an Ethernet frame, which means both must have a matching ARP table entry.
The switch learns the MAC address used by R2 and by host B when it sends the ARP messages or when it sends the frames that hold the IP packets.|The switch learns the MAC address used by R2 and by host B when it sends the ARP messages or when it sends the frames that hold the IP packets.
Figure 18-5 shows the type of information expected in those tables.|Figure 18-5 shows the type of information expected in those tables.
|
Figure 18-5 Router and Host ARP Tables, with the Switch MAC Address Table As you can see from the last few pages, a strategy of using a ping command from near the source of the problem can rule out a lot of possible root causes of any problems between two hosts—assuming the ping command succeeds.|Figure 18-5 Router and Host ARP Tables, with the Switch MAC Address Table As you can see from the last few pages, a strategy of using a ping command from near the source of the problem can rule out a lot of possible root causes of any problems between two hosts—assuming the ping command succeeds.
However, this ping command does not act exactly like the same ping command on the actual host.|However, this ping command does not act exactly like the same ping command on the actual host.
To overcome some of what is missing in the ping command from a nearby router, the next several examples show some strategies for testing other parts of the path between the two hosts that might have a current problem.|To overcome some of what is missing in the ping command from a nearby router, the next several examples show some strategies for testing other parts of the path between the two hosts that might have a current problem.
##### Using Extended Ping to Test the Reverse Route
Using Extended Ping to Test the Reverse Route   
__|__
--|--
|
Pinging from the default router, as discussed in the past few pages, misses an opportunity to test IP routes more fully.|Pinging from the default router, as discussed in the past few pages, misses an opportunity to test IP routes more fully.
In particular, it does not test the reverse route back toward the original host.|In particular, it does not test the reverse route back toward the original host.
|
For instance, referring to the internetwork in Figure 18-2 again, note that the reverse routes do not point to an address in host A’s subnet.|For instance, referring to the internetwork in Figure 18-2 again, note that the reverse routes do not point to an address in host A’s subnet.
When R1 processes the ping 172.16.2.101 command, R1 has to pick a source IP address to use for the echo request, and routers choose the IP address of the outgoing interface.|When R1 processes the ping 172.16.2.101 command, R1 has to pick a source IP address to use for the echo request, and routers choose the IP address of the outgoing interface.
The echo request from R1 to host B flows with source IP address 172.16.4.1 (R1’s G0/0/0 IP address).|The echo request from R1 to host B flows with source IP address 172.16.4.1 (R1’s G0/0/0 IP address).
The echo reply flows back to that same address (172.16.4.1).|The echo reply flows back to that same address (172.16.4.1).
|
A standard ping often does not test the reverse route that you need to test.|A standard ping often does not test the reverse route that you need to test.
In this case, the standard ping 172.16.2.101 command on R1 does not test whether the routers can route back to subnet 172.16.1.0/24, instead testing their routes for subnet172.16.4.0.|In this case, the standard ping 172.16.2.101 command on R1 does not test whether the routers can route back to subnet 172.16.1.0/24, instead testing their routes for subnet172.16.4.0.
A better ping test would test the route back to host A’s subnet; an extended ping from R1 can cause that test to happen.|A better ping test would test the route back to host A’s subnet; an extended ping from R1 can cause that test to happen.
Extended ping allows R1’s ping command to use R1’s LAN IP address from within subnet 172.16.1.0/24.|Extended ping allows R1’s ping command to use R1’s LAN IP address from within subnet 172.16.1.0/24.
Then, the echo reply messages would flow to host A’s subnet, as shown in Figure 18-6.|Then, the echo reply messages would flow to host A’s subnet, as shown in Figure 18-6.
|
Figure 18-6 Extended Ping Command Tests the Route to 172.16.1.51 (Host A)|Figure 18-6 Extended Ping Command Tests the Route to 172.16.1.51 (Host A)
|
The extended ping command does allow the user to type all the parameters on a potentially long command, but it also allows users to simply issue the ping command, press Enter, with IOS then asking the user to answer questions to complete the command, as shown in Example 18-3.|The extended ping command does allow the user to type all the parameters on a potentially long command, but it also allows users to simply issue the ping command, press Enter, with IOS then asking the user to answer questions to complete the command, as shown in Example 18-3.
The example shows the ping command on R1 that matches the logic in Figure 18-6.|The example shows the ping command on R1 that matches the logic in Figure 18-6.
This same command could have been issued from the command line as ping 172.16.2.101 source 172.16.1.1.|This same command could have been issued from the command line as ping 172.16.2.101 source 172.16.1.1.
|
Example 18-3 Testing the Reverse Route Using the Extended Ping Example end.|Example 18-3 Testing the Reverse Route Using the Extended Ping Example end.
|
This particular extended ping command tests the same routes for the echo request going to the right, but it forces a better test of routes pointing back to the left for the ICMP echo reply.|This particular extended ping command tests the same routes for the echo request going to the right, but it forces a better test of routes pointing back to the left for the ICMP echo reply.
For that direction, R2 needs a route that matches address 172.16.1.1, which is likely to be a route for subnet 172.16.1.0/24—the same subnet in which host A resides.|For that direction, R2 needs a route that matches address 172.16.1.1, which is likely to be a route for subnet 172.16.1.0/24—the same subnet in which host A resides.
|
From a troubleshooting perspective, using both standard and extended ping commands can be useful.|From a troubleshooting perspective, using both standard and extended ping commands can be useful.
However, neither can exactly mimic a ping command created on the host itself because the routers cannot send packets with the host’s IP address.|However, neither can exactly mimic a ping command created on the host itself because the routers cannot send packets with the host’s IP address.
For instance, the extended ping in Example 18-3 uses source IP address 172.16.1.1, which is not host A’s IP address.|For instance, the extended ping in Example 18-3 uses source IP address 172.16.1.1, which is not host A’s IP address.
|
As a result, neither the standard or extended ping commands in these two examples so far in this chapter can test for some kinds of problems, such as the following:|As a result, neither the standard or extended ping commands in these two examples so far in this chapter can test for some kinds of problems, such as the following:
###### IP ACLs that discard packets based on host A’s IP address but allow packets that match
IP ACLs that discard packets based on host A’s IP address but allow packets that match   
__|__
--|--
|
the router’s IP address|the router’s IP address
###### LAN switch port security that filters A’s frames (based on A’s MAC address)
LAN switch port security that filters A’s frames (based on A’s MAC address)   
###### IP routes on routers that happen to match host A’s 172.16.1.51 address, with different
IP routes on routers that happen to match host A’s 172.16.1.51 address, with different   
__|__
--|--
|
routes that match R1’s 172.16.1.1 address|routes that match R1’s 172.16.1.1 address
###### Problems with host A’s default router setting
Problems with host A’s default router setting   
__|__
--|--
|
NOTE IP ACLs and LAN switch port security are covered in CCNA 200-301 Official Cert Guide, Volume 2.|NOTE IP ACLs and LAN switch port security are covered in CCNA 200-301 Official Cert Guide, Volume 2.
For now, know that IP ACLs can filter packets on routers, focusing on the Layer 3 and 4 headers.|For now, know that IP ACLs can filter packets on routers, focusing on the Layer 3 and 4 headers.
Port security can be enabled on Layer 2 switches to filter based on source MAC addresses.|Port security can be enabled on Layer 2 switches to filter based on source MAC addresses.
##### Testing LAN Neighbors with Standard Ping
Testing LAN Neighbors with Standard Ping   
__|__
--|--
|
Testing using a ping of another device on the LAN can quickly confirm whether the LAN can pass packets and frames.|Testing using a ping of another device on the LAN can quickly confirm whether the LAN can pass packets and frames.
Specifically, a working ping rules out many possible root causes of a problem.|Specifically, a working ping rules out many possible root causes of a problem.
For instance, Figure 18-7 shows the ICMP messages that occur if R1 issues the command ping 172.16.1.51, pinging host A, which sits on the same VLAN as R1.|For instance, Figure 18-7 shows the ICMP messages that occur if R1 issues the command ping 172.16.1.51, pinging host A, which sits on the same VLAN as R1.
|
Figure 18-7 Standard ping Command Confirms That the LAN Works If the ping works, it confirms the following, which rules out some potential issues:|Figure 18-7 Standard ping Command Confirms That the LAN Works If the ping works, it confirms the following, which rules out some potential issues:
###### The host with address 172.16.1.51 replied.
The host with address 172.16.1.51 replied.   
###### The LAN can pass unicast frames from R1 to host 172.16.1.51 and vice versa.
The LAN can pass unicast frames from R1 to host 172.16.1.51 and vice versa.   
###### You can reasonably assume that the switches learned the MAC addresses of the router
You can reasonably assume that the switches learned the MAC addresses of the router   
__|__
--|--
|
and the host, adding those to the MAC address tables.|and the host, adding those to the MAC address tables.
###### Host A and Router R1 completed the ARP process and list each other in their respective
Host A and Router R1 completed the ARP process and list each other in their respective   
__|__
--|--
|
Address Resolution Protocol (ARP) tables.|Address Resolution Protocol (ARP) tables.
|
The failure of a ping, even with two devices on the same subnet, can point to a variety of problems, like those mentioned in this list.|The failure of a ping, even with two devices on the same subnet, can point to a variety of problems, like those mentioned in this list.
For instance, if the ping 172.16.1.51 on R1 fails (Figure 18-7), that result points to this list of potential root causes:|For instance, if the ping 172.16.1.51 on R1 fails (Figure 18-7), that result points to this list of potential root causes:
###### IP addressing problem: Host A could be statically configured with the wrong IP address.
IP addressing problem: Host A could be statically configured with the wrong IP address.   
###### DHCP problems: If you are using Dynamic Host Configuration Protocol (DHCP), many
DHCP problems: If you are using Dynamic Host Configuration Protocol (DHCP), many   
__|__
--|--
|
problems could exist.|problems could exist.
Chapter 7, “Implementing DHCP” in CCNA 200-301 Official Cert Guide, Volume 2, discusses those possibilities in some depth.|Chapter 7, “Implementing DHCP” in CCNA 200-301 Official Cert Guide, Volume 2, discusses those possibilities in some depth.
###### VLAN trunking problems: The router could be configured for 802.1Q trunking, when the
VLAN trunking problems: The router could be configured for 802.1Q trunking, when the   
__|__
--|--
|
switch is not (or vice versa).|switch is not (or vice versa).
###### LAN problems: A wide variety of issues could exist with the Layer 2 switches, preventing
LAN problems: A wide variety of issues could exist with the Layer 2 switches, preventing   
__|__
--|--
|
any frames from flowing between host A and the router.|any frames from flowing between host A and the router.
|
So, whether the ping works or fails, simply pinging a LAN host from a router can help further isolate the problem.|So, whether the ping works or fails, simply pinging a LAN host from a router can help further isolate the problem.
##### Testing LAN Neighbors with Extended Ping
Testing LAN Neighbors with Extended Ping   
__|__
--|--
|
A standard ping of a LAN host from a router does not test that host’s default router setting.|A standard ping of a LAN host from a router does not test that host’s default router setting.
|
However, an extended ping can test the host’s default router setting.|However, an extended ping can test the host’s default router setting.
Both tests can be useful, especially for problem isolation, because|Both tests can be useful, especially for problem isolation, because
###### If a standard ping of a local LAN host works…
If a standard ping of a local LAN host works…   
###### But an extended ping of the same LAN host fails…
But an extended ping of the same LAN host fails…   
###### The problem likely relates somehow to the host’s default router setting.
The problem likely relates somehow to the host’s default router setting.   
__|__
--|--
|
First, to understand why the standard and extended ping results have different effects, consider first the standard ping 172.16.1.51 command on R1, as shown previously in Figure 18-7.|First, to understand why the standard and extended ping results have different effects, consider first the standard ping 172.16.1.51 command on R1, as shown previously in Figure 18-7.
As a standard ping command, R1 used its LAN interface IP address (172.16.1.1) as the source of the ICMP Echo.|As a standard ping command, R1 used its LAN interface IP address (172.16.1.1) as the source of the ICMP Echo.
So, when the host (A) sent back its ICMP echo reply, host A considered the destination of 172.16.1.1 as being on the same subnet.|So, when the host (A) sent back its ICMP echo reply, host A considered the destination of 172.16.1.1 as being on the same subnet.
Host A’s ICMP echo reply message, sent back to 172.16.1.1, would work even if host A did not have a default router setting at all!|Host A’s ICMP echo reply message, sent back to 172.16.1.1, would work even if host A did not have a default router setting at all!
|
In comparison, Figure 18-8 shows the difference when using an extended ping on Router R1. An extended ping from local Router R1, using R1’s S0/0/0 IP address of 172.16.4.1 as the source of the ICMP echo request, means that host A’s ICMP echo reply will flow to an address in another subnet, which makes host A use its default router setting.|In comparison, Figure 18-8 shows the difference when using an extended ping on Router R1. An extended ping from local Router R1, using R1’s S0/0/0 IP address of 172.16.4.1 as the source of the ICMP echo request, means that host A’s ICMP echo reply will flow to an address in another subnet, which makes host A use its default router setting.
|
The comparison between the previous two figures shows one of the most classic mistakes when troubleshooting networks.|The comparison between the previous two figures shows one of the most classic mistakes when troubleshooting networks.
Sometimes, the temptation is to connect to a router and ping the host on the attached LAN, and it works.|Sometimes, the temptation is to connect to a router and ping the host on the attached LAN, and it works.
So, the engineer moves on, thinking that the network layer issues between the router and host work fine, when the problem still exists with the host’s default router setting.|So, the engineer moves on, thinking that the network layer issues between the router and host work fine, when the problem still exists with the host’s default router setting.
|
Figure 18-8 Extended ping Command Does Test Host A’s Default Router Setting|Figure 18-8 Extended ping Command Does Test Host A’s Default Router Setting
##### Testing WAN Neighbors with Standard Ping
Testing WAN Neighbors with Standard Ping   
__|__
--|--
|
As with a standard ping test across a LAN, a standard ping test between routers over a serial or Ethernet WAN link tests whether the link can pass IPv4 packets.|As with a standard ping test across a LAN, a standard ping test between routers over a serial or Ethernet WAN link tests whether the link can pass IPv4 packets.
With a properly designed IPv4 addressing plan, two routers on the same serial or Ethernet WAN link should have IP addresses in the same subnet.|With a properly designed IPv4 addressing plan, two routers on the same serial or Ethernet WAN link should have IP addresses in the same subnet.
A ping from one router to the IP address of the other router confirms that an IP packet can be sent over the link and back, as shown in the ping 172.16.4.2 command on R1 in Figure 18-9.|A ping from one router to the IP address of the other router confirms that an IP packet can be sent over the link and back, as shown in the ping 172.16.4.2 command on R1 in Figure 18-9.
|
Figure 18-9 Pinging Across a WAN Link A successful ping of the IP address on the other end of an Ethernet WAN link that sits between two routers confirms several specific facts, such as the following:|Figure 18-9 Pinging Across a WAN Link A successful ping of the IP address on the other end of an Ethernet WAN link that sits between two routers confirms several specific facts, such as the following:
###### Both routers’ WAN interfaces are in an up/up state.
Both routers’ WAN interfaces are in an up/up state.   
###### The Layer 1 and 2 features of the link work.
The Layer 1 and 2 features of the link work.   
###### The routers believe that the neighboring router’s IP address is in the same subnet.
The routers believe that the neighboring router’s IP address is in the same subnet.   
###### Inbound ACLs on both routers do not filter the incoming packets, respectively.
Inbound ACLs on both routers do not filter the incoming packets, respectively.   
###### The remote router is configured with the expected IP address (172.16.4.2 in this case).
The remote router is configured with the expected IP address (172.16.4.2 in this case).   
__|__
--|--
|
Testing by pinging the other neighboring router does not test many other features.|Testing by pinging the other neighboring router does not test many other features.
However, although the test is limited in scope, it does let you rule out WAN links as having a Layer 1 or 2 problem, and it rules out some basic Layer 3 addressing problems.|However, although the test is limited in scope, it does let you rule out WAN links as having a Layer 1 or 2 problem, and it rules out some basic Layer 3 addressing problems.
#### Using Ping with Names and with IP Addresses
Using Ping with Names and with IP Addresses   
__|__
--|--
|
All the ping examples so far in this chapter show a ping of an IP address.|All the ping examples so far in this chapter show a ping of an IP address.
However, the ping command can use hostnames, and pinging a hostname allows the network engineer to further test whether the Domain Name System (DNS) process works.|However, the ping command can use hostnames, and pinging a hostname allows the network engineer to further test whether the Domain Name System (DNS) process works.
|
First, most every TCP/IP application today uses hostnames rather than IP addresses to identify the other device.|First, most every TCP/IP application today uses hostnames rather than IP addresses to identify the other device.
No one opens a web browser and types in 72.163.4.185.|No one opens a web browser and types in 72.163.4.185.
Instead, they type in a web address, like www.cisco.com, which includes the hostname www.cisco.com.|Instead, they type in a web address, like www.cisco.com, which includes the hostname www.cisco.com.
|
Then, before a host can send data to a specific IP address, the host must first ask a DNS server to resolve that hostname into the matching IP address.|Then, before a host can send data to a specific IP address, the host must first ask a DNS server to resolve that hostname into the matching IP address.
|
For example, in the small internetwork used for several examples in this chapter, a ping B command on host A tests A’s DNS settings, as shown in Figure 18-10.|For example, in the small internetwork used for several examples in this chapter, a ping B command on host A tests A’s DNS settings, as shown in Figure 18-10.
When host A sees the use of a hostname (B), it first looks in its local DNS name cache to find out whether it has already resolved the name B.|When host A sees the use of a hostname (B), it first looks in its local DNS name cache to find out whether it has already resolved the name B.
If not, host A first asks the DNS to supply (resolve) the name into its matching IP address (Step 1 in the figure).|If not, host A first asks the DNS to supply (resolve) the name into its matching IP address (Step 1 in the figure).
Only then does host A send a packet to 172.16.2.101, host B’s IP address (Step 2).|Only then does host A send a packet to 172.16.2.101, host B’s IP address (Step 2).
|
Figure 18-10 DNS Name Resolution by Host A When troubleshooting, testing from the host by pinging using a hostname can be very helpful.|Figure 18-10 DNS Name Resolution by Host A When troubleshooting, testing from the host by pinging using a hostname can be very helpful.
|
The command, of course, tests the host’s own DNS client settings.|The command, of course, tests the host’s own DNS client settings.
For instance, a classic comparison is to first ping the destination host using the hostname, which requires a DNS request.|For instance, a classic comparison is to first ping the destination host using the hostname, which requires a DNS request.
Then, repeat the same test, but use the destination host’s IP address instead of its name, which does not require the DNS request.|Then, repeat the same test, but use the destination host’s IP address instead of its name, which does not require the DNS request.
If the ping of the hostname fails but the ping of the IP address works, the problem usually has something to do with DNS.|If the ping of the hostname fails but the ping of the IP address works, the problem usually has something to do with DNS.
### Problem Isolation Using the traceroute Command
Problem Isolation Using the traceroute Command   
__|__
--|--
|
Like ping, the traceroute command helps network engineers isolate problems.|Like ping, the traceroute command helps network engineers isolate problems.
Here is a comparison of the two:|Here is a comparison of the two:
###### Both send messages in the network to test connectivity.
Both send messages in the network to test connectivity.   
###### Both rely on other devices to send back a reply.
Both rely on other devices to send back a reply.   
###### Both have wide support on many different operating systems.
Both have wide support on many different operating systems.   
###### Both can use a hostname or an IP address to identify the destination.
Both can use a hostname or an IP address to identify the destination.   
###### On routers, both have a standard and extended version, allowing better testing of the
On routers, both have a standard and extended version, allowing better testing of the   
__|__
--|--
|
reverse route.|reverse route.
|
The biggest differences relate to the more detailed results in the output of the traceroute command and the extra time and effort it takes traceroute to build that output.|The biggest differences relate to the more detailed results in the output of the traceroute command and the extra time and effort it takes traceroute to build that output.
This second major section examines how traceroute works; plus it provides some suggestions on how to use this more detailed information to more quickly isolate IP routing problems.|This second major section examines how traceroute works; plus it provides some suggestions on how to use this more detailed information to more quickly isolate IP routing problems.
#### traceroute Basics
traceroute Basics   
__|__
--|--
|
Imagine some network engineer or CSR starts to troubleshoot some problem.|Imagine some network engineer or CSR starts to troubleshoot some problem.
The engineer pings from the user’s host, pings from a nearby router, and after a few commands, convinces herself that the host can indeed send and receive IP packets.|The engineer pings from the user’s host, pings from a nearby router, and after a few commands, convinces herself that the host can indeed send and receive IP packets.
The problem might not be solved yet, but the problem does not appear to be a network problem.|The problem might not be solved yet, but the problem does not appear to be a network problem.
|
Now imagine the next problem comes along, and this time the ping command fails.|Now imagine the next problem comes along, and this time the ping command fails.
It appears that some problem does exist in the IP network.|It appears that some problem does exist in the IP network.
Where is the problem?|Where is the problem?
Where should the engineer look more closely?|Where should the engineer look more closely?
Although the ping command can prove helpful in isolating the source of the problem, the traceroute command may be a better option.|Although the ping command can prove helpful in isolating the source of the problem, the traceroute command may be a better option.
The traceroute command systematically helps pinpoint routing problems by showing how far a packet goes through an IP network before being discarded.|The traceroute command systematically helps pinpoint routing problems by showing how far a packet goes through an IP network before being discarded.
|
The traceroute command identifies the routers in the path from source host to destination host.|The traceroute command identifies the routers in the path from source host to destination host.
Specifically, it lists the next-hop IP address of each router that would be in each of the individual routes.|Specifically, it lists the next-hop IP address of each router that would be in each of the individual routes.
For instance, a traceroute 172.16.2.101 command on host A in Figure 18-11 would identify an IP address on Router R1, another on Router R2, and then host B, as shown in the figure.|For instance, a traceroute 172.16.2.101 command on host A in Figure 18-11 would identify an IP address on Router R1, another on Router R2, and then host B, as shown in the figure.
Example 18-4, which follows, lists the output of the command, taken from host A.|Example 18-4, which follows, lists the output of the command, taken from host A.
|
Figure 18-11 IP Addresses Identified by a Successful traceroute 172.16.2.101 Command Example 18-4 Output from traceroute 172.16.2.101 on Host A Example end.|Figure 18-11 IP Addresses Identified by a Successful traceroute 172.16.2.101 Command Example 18-4 Output from traceroute 172.16.2.101 on Host A Example end.
##### How the traceroute Command Works
How the traceroute Command Works   
__|__
--|--
|
The traceroute command gathers information by generating packets that trigger error messages from routers; these messages identify the routers, letting the traceroute command list the routers’ IP addresses in the output of the command.|The traceroute command gathers information by generating packets that trigger error messages from routers; these messages identify the routers, letting the traceroute command list the routers’ IP addresses in the output of the command.
That error message is the ICMP Time-to-Live Exceeded (TTL Exceeded) message, originally meant to notify hosts when a packet had been looping around a network.|That error message is the ICMP Time-to-Live Exceeded (TTL Exceeded) message, originally meant to notify hosts when a packet had been looping around a network.
|
Ignoring traceroute for a moment and instead focusing on IP routing, IPv4 routers defeat routing loops in part by discarding looping IP packets.|Ignoring traceroute for a moment and instead focusing on IP routing, IPv4 routers defeat routing loops in part by discarding looping IP packets.
To do so, the IPv4 header holds a field called Time To Live (TTL). The original host that creates the packet sets an initial TTL value.|To do so, the IPv4 header holds a field called Time To Live (TTL). The original host that creates the packet sets an initial TTL value.
Then each router that forwards the packet decrements the TTL value by 1.|Then each router that forwards the packet decrements the TTL value by 1.
When a router decrements the TTL to 0, the router perceives the packet is looping, and the router discards the packet.|When a router decrements the TTL to 0, the router perceives the packet is looping, and the router discards the packet.
The router also notifies the host that sent the discarded packet by sending an ICMP TTL Exceeded message.|The router also notifies the host that sent the discarded packet by sending an ICMP TTL Exceeded message.
|
Now back to traceroute.|Now back to traceroute.
Traceroute sends messages with low TTL values to make the routers send back a TTL Exceeded message.|Traceroute sends messages with low TTL values to make the routers send back a TTL Exceeded message.
Specifically, a traceroute command begins by sending several packets (usually three), each with the header TTL field equal to 1.|Specifically, a traceroute command begins by sending several packets (usually three), each with the header TTL field equal to 1.
When that packet arrives at the next router—host A’s default Router R1 in the example of Figure 18-12—the router decrements TTL to 0 and discards the packet.|When that packet arrives at the next router—host A’s default Router R1 in the example of Figure 18-12—the router decrements TTL to 0 and discards the packet.
The router then sends host A the TTL Exceeded message, which identifies the router’s IP address to the traceroute command.|The router then sends host A the TTL Exceeded message, which identifies the router’s IP address to the traceroute command.
|
Figure 18-12 How traceroute Identifies the First Router in the Route The traceroute command sends several TTL=1 packets, checking them to see whether the TTL Exceeded messages flow from the same router, based on the source IP address of the TTL Exceeded message.|Figure 18-12 How traceroute Identifies the First Router in the Route The traceroute command sends several TTL=1 packets, checking them to see whether the TTL Exceeded messages flow from the same router, based on the source IP address of the TTL Exceeded message.
Assuming the messages come from the same router, the traceroute command lists that IP address as the next line of output on the command.|Assuming the messages come from the same router, the traceroute command lists that IP address as the next line of output on the command.
|
To find all the routers in the path, and finally confirm that packets flow all the way to the destination host, the traceroute command sends a small set of packets with TTL=1, then a small set with TTL=2, then 3, 4, and so on, until the destination host replies.|To find all the routers in the path, and finally confirm that packets flow all the way to the destination host, the traceroute command sends a small set of packets with TTL=1, then a small set with TTL=2, then 3, 4, and so on, until the destination host replies.
Figure 18-13 shows the packet from the second set with TTL=2.|Figure 18-13 shows the packet from the second set with TTL=2.
In this case, one router (R1) actually forwards the packet, while another router (R2) happens to decrement the TTL to 0, causing a TTL Exceeded message to be sent back to host A.|In this case, one router (R1) actually forwards the packet, while another router (R2) happens to decrement the TTL to 0, causing a TTL Exceeded message to be sent back to host A.
|
Figure 18-13 TTL=2 Message Sent by traceroute The figure shows these four steps:|Figure 18-13 TTL=2 Message Sent by traceroute The figure shows these four steps:
|
1. The traceroute command sends a packet from the second set with TTL=2.|1. The traceroute command sends a packet from the second set with TTL=2.
|
2. Router R1 processes the packet and decrements TTL to 1.|2. Router R1 processes the packet and decrements TTL to 1.
R1 forwards the packet.|R1 forwards the packet.
|
3. Router R2 processes the packet and decrements TTL to 0.|3. Router R2 processes the packet and decrements TTL to 0.
R2 discards the packet.|R2 discards the packet.
|
4. R2 notifies the sending host of the discarded packet by sending a TTL Exceeded ICMP message.|4. R2 notifies the sending host of the discarded packet by sending a TTL Exceeded ICMP message.
The source IP address of that message is 172.16.4.2.|The source IP address of that message is 172.16.4.2.
|
Finally, the choice of source IP address to use on the time-exceeded message returned by routers has a big impact on the output of the traceroute command.|Finally, the choice of source IP address to use on the time-exceeded message returned by routers has a big impact on the output of the traceroute command.
Most routers use simpler logic that also makes command output like traceroute more consistent and meaningful.|Most routers use simpler logic that also makes command output like traceroute more consistent and meaningful.
That logic: choose the TTL Exceeded message’s source IP address based on the source interface of the original message that was discarded due to TTL. In the example in Figure 18-13, the original message at Step 2 arrived on R2’s G0/0/1 interface, so at Step 3, R2 uses G0/0/1’s IP address as the source IP address of the TTL Exceeded message, and as the interface out which to send the message.|That logic: choose the TTL Exceeded message’s source IP address based on the source interface of the original message that was discarded due to TTL. In the example in Figure 18-13, the original message at Step 2 arrived on R2’s G0/0/1 interface, so at Step 3, R2 uses G0/0/1’s IP address as the source IP address of the TTL Exceeded message, and as the interface out which to send the message.
##### Standard and Extended traceroute
Standard and Extended traceroute   
__|__
--|--
|
The standard and extended options for the traceroute command give you many of the same options as the ping command.|The standard and extended options for the traceroute command give you many of the same options as the ping command.
For instance, Example 18-5 lists the output of a standard traceroute command on Router R1. Like the standard ping command, a standard traceroute command chooses an IP address based on the outgoing interface for the packet sent by the command.|For instance, Example 18-5 lists the output of a standard traceroute command on Router R1. Like the standard ping command, a standard traceroute command chooses an IP address based on the outgoing interface for the packet sent by the command.
So, in this example, the packets sent by R1 come from source IP address 172.16.4.1, R1’s G0/0/0 IP address.|So, in this example, the packets sent by R1 come from source IP address 172.16.4.1, R1’s G0/0/0 IP address.
|
Example 18-5 Standard traceroute Command on R1 Example end.|Example 18-5 Standard traceroute Command on R1 Example end.
|
The extended traceroute command, as shown in Example 18-6, follows the same basic command structure as the extended ping command.|The extended traceroute command, as shown in Example 18-6, follows the same basic command structure as the extended ping command.
The user can type all the parameters on one command line, but it is much easier to just type traceroute, press Enter, and let IOS prompt for all the parameters, including the source IP address of the packets (172.16.1.1 in this example).|The user can type all the parameters on one command line, but it is much easier to just type traceroute, press Enter, and let IOS prompt for all the parameters, including the source IP address of the packets (172.16.1.1 in this example).
|
Example 18-6 Extended traceroute Command on R1 Example end.|Example 18-6 Extended traceroute Command on R1 Example end.
|
Both the ping and traceroute commands exist on most operating systems, including Cisco IOS. However, some operating systems use a slightly different syntax for traceroute.|Both the ping and traceroute commands exist on most operating systems, including Cisco IOS. However, some operating systems use a slightly different syntax for traceroute.
|
For example, most Windows operating systems support tracert and pathping, and not traceroute.|For example, most Windows operating systems support tracert and pathping, and not traceroute.
Linux and OS X support the traceroute command.|Linux and OS X support the traceroute command.
|
NOTE Host OS traceroute commands usually create ICMP echo requests.|NOTE Host OS traceroute commands usually create ICMP echo requests.
The Cisco IOS traceroute command instead creates IP packets with a UDP header.|The Cisco IOS traceroute command instead creates IP packets with a UDP header.
This bit of information may seem trivial at this point.|This bit of information may seem trivial at this point.
However, note that an ACL may actually filter the traffic from a host’s traceroute messages but not the router traceroute command, or vice versa.|However, note that an ACL may actually filter the traffic from a host’s traceroute messages but not the router traceroute command, or vice versa.
### Telnet and SSH
Telnet and SSH   
__|__
--|--
|
The ping and traceroute commands do give networkers two great tools to begin isolating the cause of an IP routing problem.|The ping and traceroute commands do give networkers two great tools to begin isolating the cause of an IP routing problem.
However, these two commands tell us nothing about the operation state inside the various network devices.|However, these two commands tell us nothing about the operation state inside the various network devices.
Once you begin to get an idea of the kinds of problems and the possible locations of the problems using ping and traceroute, the next step is to look at the status of various router and switch features.|Once you begin to get an idea of the kinds of problems and the possible locations of the problems using ping and traceroute, the next step is to look at the status of various router and switch features.
One way to do that is to use Telnet or Secure Shell (SSH) to log in to the devices.|One way to do that is to use Telnet or Secure Shell (SSH) to log in to the devices.
#### Common Reasons to Use the IOS Telnet and SSH Client
Common Reasons to Use the IOS Telnet and SSH Client   
__|__
--|--
|
Normally, a network engineer would log in to the remote device using a Telnet or SSH client on a PC, tablet, or any other user device.|Normally, a network engineer would log in to the remote device using a Telnet or SSH client on a PC, tablet, or any other user device.
In fact, often, the same software package does both Telnet and SSH. However, in some cases, you may want to take advantage of the Telnet and SSH client built in to IOS on the routers and switches to Telnet/SSH from one Cisco device to the next.|In fact, often, the same software package does both Telnet and SSH. However, in some cases, you may want to take advantage of the Telnet and SSH client built in to IOS on the routers and switches to Telnet/SSH from one Cisco device to the next.
|
To understand why, consider the example shown in Figure 18-14.|To understand why, consider the example shown in Figure 18-14.
The figure shows arrowed lines to three separate IP addresses on three separate Cisco routers.|The figure shows arrowed lines to three separate IP addresses on three separate Cisco routers.
PC1 has attempted to Telnet to each address from a different tab in PC1’s Telnet/SSH client.|PC1 has attempted to Telnet to each address from a different tab in PC1’s Telnet/SSH client.
However, R2 happens to have an error in its routing protocol configuration, so R1, R2, and R3 fail to learn any routes from each other.|However, R2 happens to have an error in its routing protocol configuration, so R1, R2, and R3 fail to learn any routes from each other.
As a result, PC1’s Telnet attempt to both 10.1.2.2 (R2) and 10.1.3.3 (R3) fails.|As a result, PC1’s Telnet attempt to both 10.1.2.2 (R2) and 10.1.3.3 (R3) fails.
|
Figure 18-14 Telnet Works from PC1 to R1 but Not to R2 or R3 In some cases, like this one, a Telnet or SSH login from the network engineer’s device can fail, while you could still find a way to log in using the telnet and ssh commands to use the Telnet and SSH clients on the routers or switches.|Figure 18-14 Telnet Works from PC1 to R1 but Not to R2 or R3 In some cases, like this one, a Telnet or SSH login from the network engineer’s device can fail, while you could still find a way to log in using the telnet and ssh commands to use the Telnet and SSH clients on the routers or switches.
With this particular scenario, all the individual data links work; the problem is with the routing protocol exchanging routes.|With this particular scenario, all the individual data links work; the problem is with the routing protocol exchanging routes.
PC1 can ping R1’s 10.1.1.1 IP address, R1 can ping R2’s 10.1.2.2 address, and R2 can ping R3’s 10.1.3.3 address.|PC1 can ping R1’s 10.1.1.1 IP address, R1 can ping R2’s 10.1.2.2 address, and R2 can ping R3’s 10.1.3.3 address.
Because each link works, and each router can send and receive packets with its neighbor on the shared data link, you could Telnet/SSH to each successive device.|Because each link works, and each router can send and receive packets with its neighbor on the shared data link, you could Telnet/SSH to each successive device.
|
Figure 18-15 shows the idea.|Figure 18-15 shows the idea.
On the left, PC1 begins with either a Telnet/SSH or a console connection into Router R1, as shown on the left.|On the left, PC1 begins with either a Telnet/SSH or a console connection into Router R1, as shown on the left.
Then the user issues the telnet 10.1.2.2 command from R1 to Telnet to R2. Once logged in to R2, the user can issue commands on R2. Then from R2, the user could issue the telnet 10.1.3.3 command to Telnet to R3, from which the user could issue commands on R3.|Then the user issues the telnet 10.1.2.2 command from R1 to Telnet to R2. Once logged in to R2, the user can issue commands on R2. Then from R2, the user could issue the telnet 10.1.3.3 command to Telnet to R3, from which the user could issue commands on R3.
|
Figure 18-15 Successive Telnet Connections: PC1 to R1, R1 to R2, and R2 to R3 The Telnet connections shown in Figure 18-15 work because each Telnet in this case uses source and destination addresses in the same subnet.|Figure 18-15 Successive Telnet Connections: PC1 to R1, R1 to R2, and R2 to R3 The Telnet connections shown in Figure 18-15 work because each Telnet in this case uses source and destination addresses in the same subnet.
For example, R1’s telnet 10.1.2.2 command uses 10.1.2.2 as the destination, of course.|For example, R1’s telnet 10.1.2.2 command uses 10.1.2.2 as the destination, of course.
R1 uses the outgoing interface IP address used to send packets to 10.1.2.2, 10.1.2.1 in this case.|R1 uses the outgoing interface IP address used to send packets to 10.1.2.2, 10.1.2.1 in this case.
Because each of these telnet commands connects to an IP address in a connected subnet, the routing protocol could be completely misconfigured, and you could still Telnet/SSH to each successive device to troubleshoot and fix the problem.|Because each of these telnet commands connects to an IP address in a connected subnet, the routing protocol could be completely misconfigured, and you could still Telnet/SSH to each successive device to troubleshoot and fix the problem.
|
Network engineers also use the IOS Telnet and SSH client just for preference.|Network engineers also use the IOS Telnet and SSH client just for preference.
For instance, if you need to log in to several Cisco devices, you could open several windows and tabs on your PC, and log in from your PC (assuming the network was not having problems).|For instance, if you need to log in to several Cisco devices, you could open several windows and tabs on your PC, and log in from your PC (assuming the network was not having problems).
Or, you could log in from your PC to some nearby Cisco router or switch, and from there Telnet or SSH to other Cisco devices.|Or, you could log in from your PC to some nearby Cisco router or switch, and from there Telnet or SSH to other Cisco devices.
#### IOS Telnet and SSH Examples
IOS Telnet and SSH Examples   
__|__
--|--
|
Using the IOS Telnet client via the telnet host command is pretty simple.|Using the IOS Telnet client via the telnet host command is pretty simple.
Just use the IP address or hostname to identify the host to which you want to connect, and press Enter.|Just use the IP address or hostname to identify the host to which you want to connect, and press Enter.
|
Example 18-7 shows an example based on Figure 18-15, with R1 using Telnet to connect to|Example 18-7 shows an example based on Figure 18-15, with R1 using Telnet to connect to
###### 10.1.2.2 (R2).
10.1.2.2 (R2).   
__|__
--|--
|
Example 18-7 Telnet from R1 to R2 to View Interface Status on R2 Example end.|Example 18-7 Telnet from R1 to R2 to View Interface Status on R2 Example end.
|
Take the time to pay close attention to the command prompts.|Take the time to pay close attention to the command prompts.
The example begins with the user logged in to Router R1, with the R1# command prompt.|The example begins with the user logged in to Router R1, with the R1# command prompt.
After issuing the telnet 10.1.2.2 command, R2 asks the user for both a username and password because Router R2 uses local username authentication, which requires those credentials.|After issuing the telnet 10.1.2.2 command, R2 asks the user for both a username and password because Router R2 uses local username authentication, which requires those credentials.
The show ip interfaces brief command at the end of the output shows Router R2’s interfaces and IP addresses again per Example 18-7 and Figure 18-15.|The show ip interfaces brief command at the end of the output shows Router R2’s interfaces and IP addresses again per Example 18-7 and Figure 18-15.
|
The ssh -l username host command in Example 18-8 follows the same basic ideas as the telnet host command, but with an SSH client.|The ssh -l username host command in Example 18-8 follows the same basic ideas as the telnet host command, but with an SSH client.
The -l flag means that the next parameter is the login username.|The -l flag means that the next parameter is the login username.
In this case, the user begins logged in to Router R1 and then uses the ssh -l wendell 10.1.2.2 command to SSH to Router R2. R2 expects a username/password of wendell/odom, with wendell supplied in the command and odom supplied when R2 prompts the user.|In this case, the user begins logged in to Router R1 and then uses the ssh -l wendell 10.1.2.2 command to SSH to Router R2. R2 expects a username/password of wendell/odom, with wendell supplied in the command and odom supplied when R2 prompts the user.
|
Example 18-8 SSH Client from R1 to R2 to View Interface Status on R2 Example end.|Example 18-8 SSH Client from R1 to R2 to View Interface Status on R2 Example end.
|
When you have finished using the other router, you can log out from your Telnet or SSH connection using the exit or quit command.|When you have finished using the other router, you can log out from your Telnet or SSH connection using the exit or quit command.
|
Finally, note that IOS supports a mechanism to use hotkeys to move between multiple Telnet or SSH sessions from the CLI. Basically, starting at one router, you could telnet or SSH to a router, do some commands, and instead of using the exit command to end your connection, you could keep the connection open while still moving back to the command prompt of the original router.|Finally, note that IOS supports a mechanism to use hotkeys to move between multiple Telnet or SSH sessions from the CLI. Basically, starting at one router, you could telnet or SSH to a router, do some commands, and instead of using the exit command to end your connection, you could keep the connection open while still moving back to the command prompt of the original router.
For instance, if starting at Router R1, you could Telnet to R2, R3, and R4, suspending but not exiting those Telnet connections.|For instance, if starting at Router R1, you could Telnet to R2, R3, and R4, suspending but not exiting those Telnet connections.
Then you could easily move between the sessions to issue new commands with a few keystrokes.|Then you could easily move between the sessions to issue new commands with a few keystrokes.
### Chapter Review
Chapter Review   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|One key to doing well on the exams is to perform repetitive spaced review sessions.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.
Refer to the “Your Study Plan” element for more details.|Refer to the “Your Study Plan” element for more details.
Table 18-1 outlines the key review elements and where you can find them.|Table 18-1 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 18-1 Chapter Review Tracking Table end.|Table 18-1 Chapter Review Tracking Table end.
|
Review All the Key Topics Key Terms You Should Know ping, traceroute, ICMP echo request, ICMP echo reply, extended ping, forward route, reverse route, DNS Keep track of your part review progress with the checklist in Table P5-1.|Review All the Key Topics Key Terms You Should Know ping, traceroute, ICMP echo request, ICMP echo reply, extended ping, forward route, reverse route, DNS Keep track of your part review progress with the checklist in Table P5-1.
Details on each task follow the table.|Details on each task follow the table.
|
Table P5-1 Part V Part Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Do Labs Review Videos Repeat All DIKTA Questions For this task, answer the “Do I Know This Already?” questions again for the chapters in this part of the book, using the PTP software.|Table P5-1 Part V Part Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Do Labs Review Videos Repeat All DIKTA Questions For this task, answer the “Do I Know This Already?” questions again for the chapters in this part of the book, using the PTP software.
|
Answer Part Review Questions For this task, use PTP to answer the Part Review questions for this part of the book.|Answer Part Review Questions For this task, use PTP to answer the Part Review questions for this part of the book.
|
Review Key Topics Review all key topics in all chapters in this part, either by browsing the chapters or by using the Key Topics application on the companion website.|Review Key Topics Review all key topics in all chapters in this part, either by browsing the chapters or by using the Key Topics application on the companion website.
|
Labs Depending on your chosen lab tool, here are some suggestions for what to do in lab:|Labs Depending on your chosen lab tool, here are some suggestions for what to do in lab:
|
Pearson Network Simulator: If you use the full Pearson ICND1 or CCNA simulator, focus more on the configuration scenario and troubleshooting scenario labs associated with the topics in this part of the book.|Pearson Network Simulator: If you use the full Pearson ICND1 or CCNA simulator, focus more on the configuration scenario and troubleshooting scenario labs associated with the topics in this part of the book.
These types of labs include a larger set of topics and work well as Part Review activities. (See the Introduction for some details about how to find which labs are about topics in this part of the book.)|These types of labs include a larger set of topics and work well as Part Review activities. (See the Introduction for some details about how to find which labs are about topics in this part of the book.)
|
Blog Config Labs: The author’s blog includes a series of configuration-focused labs that you can do on paper, each in 10–15 minutes.|Blog Config Labs: The author’s blog includes a series of configuration-focused labs that you can do on paper, each in 10–15 minutes.
Review and perform the labs for this part of the book, as found at http://blog.certskills.com.|Review and perform the labs for this part of the book, as found at http://blog.certskills.com.
Then navigate to the Hands-on Config labs.|Then navigate to the Hands-on Config labs.
|
Other: If using other lab tools, here are a few suggestions: Make sure to experiment heavily with IPv4 addressing, static routing, and Layer 3 switching.|Other: If using other lab tools, here are a few suggestions: Make sure to experiment heavily with IPv4 addressing, static routing, and Layer 3 switching.
In each case, test all your routes using ping and traceroute.|In each case, test all your routes using ping and traceroute.
## Part V Review
Part V Review   
__|__
--|--
|
Watch Videos Chapters 15, 17, and 18 each list a video to be found on the companion website, on topics ranging from how to use the router CLI, how to configure ROAS, and how to troubleshoot using Extended ping.|Watch Videos Chapters 15, 17, and 18 each list a video to be found on the companion website, on topics ranging from how to use the router CLI, how to configure ROAS, and how to troubleshoot using Extended ping.
|
Part IV began the story in this book about IP Version 4 (IPv4) addressing.|Part IV began the story in this book about IP Version 4 (IPv4) addressing.
Part V continued that story with how to implement addressing in Cisco routers, along with a variety of methods to route packets between local interfaces.|Part V continued that story with how to implement addressing in Cisco routers, along with a variety of methods to route packets between local interfaces.
But those topics delayed the discussion of one of the most important topics in TCP/IP, namely IP routing protocols.|But those topics delayed the discussion of one of the most important topics in TCP/IP, namely IP routing protocols.
|
Routers use IP routing protocols to learn about the subnets in an internetwork, choose the current best routes to reach each subnet, and to add those routes to each router’s IP routing table.|Routers use IP routing protocols to learn about the subnets in an internetwork, choose the current best routes to reach each subnet, and to add those routes to each router’s IP routing table.
Cisco chose to include one and only one IP routing protocol in the CCNA 200-301 exam: the Open Shortest Path First (OSPF) routing protocol.|Cisco chose to include one and only one IP routing protocol in the CCNA 200-301 exam: the Open Shortest Path First (OSPF) routing protocol.
This entire part focuses on OSPF as an example of how routing protocols work.|This entire part focuses on OSPF as an example of how routing protocols work.
## Part VI OSPF
Part VI OSPF   
__|__
--|--
|
Part VI Review|Part VI Review
## Chapter 19 Understanding OSPF Concepts
Chapter 19 Understanding OSPF Concepts   
__|__
--|--
|
This chapter covers the following exam topics:|This chapter covers the following exam topics:
###### 3.0 IP Connectivity
3.0 IP Connectivity   
###### 3.2 Determine how a router makes a forwarding decision by default
3.2 Determine how a router makes a forwarding decision by default   
###### 3.2.b Administrative distance
3.2.b Administrative distance   
###### 3.2.c Routing protocol metric
3.2.c Routing protocol metric   
###### 3.4 Configure and verify single area OSPFv2
3.4 Configure and verify single area OSPFv2   
###### 3.4.a Neighbor adjacencies
3.4.a Neighbor adjacencies   
###### 3.4.b Point-to-point
3.4.b Point-to-point   
###### 3.4.c Broadcast (DR/BR selection)
3.4.c Broadcast (DR/BR selection)   
###### 3.4.d Router ID
3.4.d Router ID   
__|__
--|--
|
This chapter takes a long look at Open Shortest Path First Version 2 (OSPFv2) concepts.|This chapter takes a long look at Open Shortest Path First Version 2 (OSPFv2) concepts.
|
OSPF runs on each router, sending and receiving OSPF messages with neighboring (nearby)|OSPF runs on each router, sending and receiving OSPF messages with neighboring (nearby)
|
routers.|routers.
These messages give OSPF the means to exchange data about the network and to learn and add IP Version 4 (IPv4) routes to the IPv4 routing table on each router.|These messages give OSPF the means to exchange data about the network and to learn and add IP Version 4 (IPv4) routes to the IPv4 routing table on each router.
|
Most enterprises over the last 25 years have used either OSPF or the Enhanced Interior Gateway Routing Protocol (EIGRP) for their primary IPv4 routing protocol.|Most enterprises over the last 25 years have used either OSPF or the Enhanced Interior Gateway Routing Protocol (EIGRP) for their primary IPv4 routing protocol.
For perspective, both OSPF and EIGRP have been part of CCNA throughout most of its 20+ year history.|For perspective, both OSPF and EIGRP have been part of CCNA throughout most of its 20+ year history.
|
For the CCNA 200-301 exam blueprint, Cisco has included OSPFv2 as the only IPv4 routing protocol. (Note that Cisco does include EIGRP in the CCNP Enterprise certification.)|For the CCNA 200-301 exam blueprint, Cisco has included OSPFv2 as the only IPv4 routing protocol. (Note that Cisco does include EIGRP in the CCNP Enterprise certification.)
|
This chapter breaks the content into three major sections.|This chapter breaks the content into three major sections.
The first section sets the context about routing protocols in general, defining interior and exterior routing protocols and basic routing protocol features and terms.|The first section sets the context about routing protocols in general, defining interior and exterior routing protocols and basic routing protocol features and terms.
The second major section presents the nuts and bolts of how OSPFv2 works, using OSPF neighbor relationships, database exchange, and then route calculation.|The second major section presents the nuts and bolts of how OSPFv2 works, using OSPF neighbor relationships, database exchange, and then route calculation.
The third section wraps up the discussion by looking at OSPF areas and LSAs.|The third section wraps up the discussion by looking at OSPF areas and LSAs.
### “Do I Know This Already?” Quiz
“Do I Know This Already?” Quiz   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.
The letter answers are listed at the bottom of the page following the quiz.|The letter answers are listed at the bottom of the page following the quiz.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.
You can also find both answers and explanations in the PTP testing software.|You can also find both answers and explanations in the PTP testing software.
|
CHAPTER 19 Table 19-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|CHAPTER 19 Table 19-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping
### Foundation Topics
Foundation Topics   
### Comparing Dynamic Routing Protocol Features
Comparing Dynamic Routing Protocol Features   
__|__
--|--
|
OSPF Concepts and Operation 4, 5 OSPF Areas and LSAs 6 1.|OSPF Concepts and Operation 4, 5 OSPF Areas and LSAs 6 1.
Which of the following routing protocols is considered to use link-state logic?|Which of the following routing protocols is considered to use link-state logic?
|
a. RIPv1 b.|a. RIPv1 b.
RIPv2 c.|RIPv2 c.
EIGRP d.|EIGRP d.
OSPF 2.|OSPF 2.
Which of the following routing protocols use a metric that is, by default, at least partially affected by link bandwidth? (Choose two answers.)|Which of the following routing protocols use a metric that is, by default, at least partially affected by link bandwidth? (Choose two answers.)
|
a. RIPv1 b.|a. RIPv1 b.
RIPv2 c.|RIPv2 c.
EIGRP d.|EIGRP d.
OSPF 3.|OSPF 3.
Which of the following interior routing protocols support VLSM? (Choose three answers.)|Which of the following interior routing protocols support VLSM? (Choose three answers.)
|
a. RIPv1 b.|a. RIPv1 b.
RIPv2 c.|RIPv2 c.
EIGRP d.|EIGRP d.
OSPF 4.|OSPF 4.
Two routers using OSPFv2 have become neighbors and exchanged all LSAs. As a result, Router R1 now lists some OSPF-learned routes in its routing table.|Two routers using OSPFv2 have become neighbors and exchanged all LSAs. As a result, Router R1 now lists some OSPF-learned routes in its routing table.
Which of the following best describes how R1 uses those recently learned LSAs to choose which IP routes to add to its IP routing table?|Which of the following best describes how R1 uses those recently learned LSAs to choose which IP routes to add to its IP routing table?
|
a. Each LSA lists a route to be copied to the routing table.|a. Each LSA lists a route to be copied to the routing table.
|
b. Some LSAs list a route that can be copied to the routing table.|b. Some LSAs list a route that can be copied to the routing table.
|
c. Run some SPF math against the LSAs to calculate the routes.|c. Run some SPF math against the LSAs to calculate the routes.
|
d. R1 does not use the LSAs at all when choosing what routes to add.|d. R1 does not use the LSAs at all when choosing what routes to add.
|
5. Which of the following OSPF neighbor states is expected when the exchange of topology information is complete between two OSPF neighbors?|5. Which of the following OSPF neighbor states is expected when the exchange of topology information is complete between two OSPF neighbors?
|
a. 2-way b.|a. 2-way b.
Full c.|Full c.
Up/up d.|Up/up d.
Final 6.|Final 6.
A company has a small/medium-sized network with 15 routers and 40 subnets and uses OSPFv2.|A company has a small/medium-sized network with 15 routers and 40 subnets and uses OSPFv2.
Which of the following is considered an advantage of using a single-area design as opposed to a multiarea design?|Which of the following is considered an advantage of using a single-area design as opposed to a multiarea design?
|
a. It reduces the processing overhead on most routers.|a. It reduces the processing overhead on most routers.
|
b. Status changes to one link may not require SPF to run on all other routers.|b. Status changes to one link may not require SPF to run on all other routers.
|
c. It allows for simpler planning and operations.|c. It allows for simpler planning and operations.
|
d. It allows for route summarization, reducing the size of IP routing tables.|d. It allows for route summarization, reducing the size of IP routing tables.
|
Foundation Topics Comparing Dynamic Routing Protocol Features Routers add IP routes to their routing tables using three methods: connected routes, static routes, and routes learned by using dynamic routing protocols.|Foundation Topics Comparing Dynamic Routing Protocol Features Routers add IP routes to their routing tables using three methods: connected routes, static routes, and routes learned by using dynamic routing protocols.
Before we get too far into the discussion, however, it is important to define a few related terms and clear up any misconceptions about the terms routing protocol, routed protocol, and routable protocol.|Before we get too far into the discussion, however, it is important to define a few related terms and clear up any misconceptions about the terms routing protocol, routed protocol, and routable protocol.
The concepts behind these terms are not that difficult, but because the terms are so similar, and because many documents pay poor attention to when each of these terms is used, they can be a bit confusing.|The concepts behind these terms are not that difficult, but because the terms are so similar, and because many documents pay poor attention to when each of these terms is used, they can be a bit confusing.
These terms are generally defined as follows:|These terms are generally defined as follows:
###### Routing protocol: A set of messages, rules, and algorithms used by routers for the overall
Routing protocol: A set of messages, rules, and algorithms used by routers for the overall   
__|__
--|--
|
purpose of learning routes.|purpose of learning routes.
This process includes the exchange and analysis of routing information.|This process includes the exchange and analysis of routing information.
Each router chooses the best route to each subnet (path selection) and finally places those best routes in its IP routing table.|Each router chooses the best route to each subnet (path selection) and finally places those best routes in its IP routing table.
Examples include RIP, EIGRP, OSPF, and BGP.|Examples include RIP, EIGRP, OSPF, and BGP.
###### Routed protocol and routable protocol: Both terms refer to a protocol that defines a
Routed protocol and routable protocol: Both terms refer to a protocol that defines a   
__|__
--|--
|
packet structure and logical addressing, allowing routers to forward or route the packets.|packet structure and logical addressing, allowing routers to forward or route the packets.
|
Routers forward packets defined by routed and routable protocols.|Routers forward packets defined by routed and routable protocols.
Examples include IP Version 4 (IPv4) and IP Version 6 (IPv6).|Examples include IP Version 4 (IPv4) and IP Version 6 (IPv6).
|
NOTE The term path selection sometimes refers to part of the job of a routing protocol, in which the routing protocol chooses the best route.|NOTE The term path selection sometimes refers to part of the job of a routing protocol, in which the routing protocol chooses the best route.
|
Even though routing protocols (such as OSPF) are different from routed protocols (such as IP), they do work together very closely.|Even though routing protocols (such as OSPF) are different from routed protocols (such as IP), they do work together very closely.
The routing process forwards IP packets, but if a router does not have any routes in its IP routing table that match a packet’s destination address, the router discards the packet.|The routing process forwards IP packets, but if a router does not have any routes in its IP routing table that match a packet’s destination address, the router discards the packet.
Routers need routing protocols so that the routers can learn all the possible routes and add them to the routing table so that the routing process can forward (route) routable protocols such as IP.|Routers need routing protocols so that the routers can learn all the possible routes and add them to the routing table so that the routing process can forward (route) routable protocols such as IP.
#### Routing Protocol Functions
Routing Protocol Functions   
__|__
--|--
|
Cisco IOS software supports several IP routing protocols, performing the same general functions:|Cisco IOS software supports several IP routing protocols, performing the same general functions:
|
1. Learn routing information about IP subnets from neighboring routers.|1. Learn routing information about IP subnets from neighboring routers.
|
2. Advertise routing information about IP subnets to neighboring routers.|2. Advertise routing information about IP subnets to neighboring routers.
|
3. If more than one possible route exists to reach one subnet, pick the best route based on a metric.|3. If more than one possible route exists to reach one subnet, pick the best route based on a metric.
|
4. If the network topology changes—for example, a link fails—react by advertising that some routes have failed and pick a new currently best route. (This process is called convergence.)|4. If the network topology changes—for example, a link fails—react by advertising that some routes have failed and pick a new currently best route. (This process is called convergence.)
|
NOTE A neighboring router connects to the same link as another router, such as the same WAN link or the same Ethernet LAN.|NOTE A neighboring router connects to the same link as another router, such as the same WAN link or the same Ethernet LAN.
|
Figure 19-1 shows an example of three of the four functions in the list.|Figure 19-1 shows an example of three of the four functions in the list.
Router R1, in the lower left of the figure, must make a decision about the best route to reach the subnet connected off router R2, on the bottom right of the figure.|Router R1, in the lower left of the figure, must make a decision about the best route to reach the subnet connected off router R2, on the bottom right of the figure.
Following the steps in the figure:|Following the steps in the figure:
|
Step 1.|Step 1.
R2 advertises a route to the lower right subnet—172.16.3.0/24—to both router R1 and R3.|R2 advertises a route to the lower right subnet—172.16.3.0/24—to both router R1 and R3.
|
Step 2.|Step 2.
After R3 learns about the route to 172.16.3.0/24 from R2, R3 advertises that route to R1.|After R3 learns about the route to 172.16.3.0/24 from R2, R3 advertises that route to R1.
|
Step 3.|Step 3.
R1 must make a decision about the two routes it learned about for reaching subnet 172.16.3.0/24—one with metric 1 from R2 and one with metric 2 from R3. R1 chooses the lower metric route through R2 (function 3).|R1 must make a decision about the two routes it learned about for reaching subnet 172.16.3.0/24—one with metric 1 from R2 and one with metric 2 from R3. R1 chooses the lower metric route through R2 (function 3).
|
The other routing protocol function, convergence, occurs when the topology changes—that is, when either a router or link fails or comes back up again.|The other routing protocol function, convergence, occurs when the topology changes—that is, when either a router or link fails or comes back up again.
When something changes, the best routes available in the network can change.|When something changes, the best routes available in the network can change.
Convergence simply refers to the process by which all the routers collectively realize something has changed, advertise the information about the changes to all the other routers, and all the routers then choose the currently best routes for each subnet.|Convergence simply refers to the process by which all the routers collectively realize something has changed, advertise the information about the changes to all the other routers, and all the routers then choose the currently best routes for each subnet.
The ability to converge quickly, without causing loops, is one of the most important considerations when choosing which IP routing protocol to use.|The ability to converge quickly, without causing loops, is one of the most important considerations when choosing which IP routing protocol to use.
|
In Figure 19-1, convergence might occur if the link between R1 and R2 failed.|In Figure 19-1, convergence might occur if the link between R1 and R2 failed.
In that case, R1 should stop using its old route for subnet 172.16.3.0/24 (directly through R2) and begin sending packets to R3.|In that case, R1 should stop using its old route for subnet 172.16.3.0/24 (directly through R2) and begin sending packets to R3.
|
G0/0/0 G0/1 G0/1/0 G0/0/0 G0/1/0 G0/0 G0/0/0 172.16.6.252 G0/1/0 172.16.2.252 G0/0 I have a route to 172.16.3.0/24, metric 2.|G0/0/0 G0/1 G0/1/0 G0/0/0 G0/1/0 G0/0 G0/0/0 172.16.6.252 G0/1/0 172.16.2.252 G0/0 I have a route to 172.16.3.0/24, metric 2.
|
I have a route to 172.16.3.0/24, metric 1.|I have a route to 172.16.3.0/24, metric 1.
|
I have a route to 172.16.3.0/24, metric 1.|I have a route to 172.16.3.0/24, metric 1.
|
R1 IP Routing Table Subnet Out Int.|R1 IP Routing Table Subnet Out Int.
Next-Hop Metric 172.16.3.0 G0/0/0 172.16.2.252 1 I’ll use the route out G0/0/0, because it has the lower metric.|Next-Hop Metric 172.16.3.0 G0/0/0 172.16.2.252 1 I’ll use the route out G0/0/0, because it has the lower metric.
|
Figure 19-1 Three of the Four Basic Functions of Routing Protocols|Figure 19-1 Three of the Four Basic Functions of Routing Protocols
#### Interior and Exterior Routing Protocols
Interior and Exterior Routing Protocols   
__|__
--|--
|
IP routing protocols fall into one of two major categories: interior gateway protocols (IGP)|IP routing protocols fall into one of two major categories: interior gateway protocols (IGP)
|
or exterior gateway protocols (EGP). The definitions of each are as follows:|or exterior gateway protocols (EGP). The definitions of each are as follows:
###### IGP: A routing protocol that was designed and intended for use inside a single autonomous
IGP: A routing protocol that was designed and intended for use inside a single autonomous   
__|__
--|--
|
system (AS)|system (AS)
###### EGP: A routing protocol that was designed and intended for use between different autonomous
EGP: A routing protocol that was designed and intended for use between different autonomous   
__|__
--|--
|
systems NOTE The terms IGP and EGP include the word gateway because routers used to be called gateways.|systems NOTE The terms IGP and EGP include the word gateway because routers used to be called gateways.
|
These definitions use another new term: autonomous system (AS). An AS is a network under the administrative control of a single organization.|These definitions use another new term: autonomous system (AS). An AS is a network under the administrative control of a single organization.
For example, a network created and paid for by a single company is probably a single AS, and a network created by a single school system is probably a single AS. Other examples include large divisions of a state or national government, where different government agencies might be able to build their own networks.|For example, a network created and paid for by a single company is probably a single AS, and a network created by a single school system is probably a single AS. Other examples include large divisions of a state or national government, where different government agencies might be able to build their own networks.
Each ISP is also typically a single different AS.|Each ISP is also typically a single different AS.
|
Some routing protocols work best inside a single AS by design, so these routing protocols are called IGPs. Conversely, routing protocols designed to exchange routes between routers Answers to the “Do I Know This Already?” quiz:|Some routing protocols work best inside a single AS by design, so these routing protocols are called IGPs. Conversely, routing protocols designed to exchange routes between routers Answers to the “Do I Know This Already?” quiz:
|
1 D 2 C, D 3 B, C, D 4 C 5 B 6 C in different autonomous systems are called EGPs. Today, Border Gateway Protocol (BGP) is the only EGP used.|1 D 2 C, D 3 B, C, D 4 C 5 B 6 C in different autonomous systems are called EGPs. Today, Border Gateway Protocol (BGP) is the only EGP used.
|
Each AS can be assigned a number called (unsurprisingly) an AS number (ASN). Like public IP addresses, the Internet Assigned Numbers Authority (IANA, www.iana.org) controls the worldwide rights to assigning ASNs. It delegates that authority to other organizations around the world, typically to the same organizations that assign public IP addresses.|Each AS can be assigned a number called (unsurprisingly) an AS number (ASN). Like public IP addresses, the Internet Assigned Numbers Authority (IANA, www.iana.org) controls the worldwide rights to assigning ASNs. It delegates that authority to other organizations around the world, typically to the same organizations that assign public IP addresses.
|
For example, in North America, the American Registry for Internet Numbers (ARIN, www.arin.net) assigns public IP address ranges and ASNs.|For example, in North America, the American Registry for Internet Numbers (ARIN, www.arin.net) assigns public IP address ranges and ASNs.
|
Figure 19-2 shows a small view of the worldwide Internet.|Figure 19-2 shows a small view of the worldwide Internet.
The figure shows two enterprises and three ISPs using IGPs (OSPF and EIGRP) inside their own networks and with BGP being used between the ASNs.|The figure shows two enterprises and three ISPs using IGPs (OSPF and EIGRP) inside their own networks and with BGP being used between the ASNs.
|
Figure 19-2 Comparing Locations for Using IGPs and EGPs|Figure 19-2 Comparing Locations for Using IGPs and EGPs
#### Comparing IGPs
Comparing IGPs   
__|__
--|--
|
Organizations have several options when choosing an IGP for their enterprise network, but most companies today use either OSPF or EIGRP. This book discusses OSPFv2, with the CCNP Enterprise certification adding EIGRP. Before getting into detail on these two protocols, the next section first discusses some of the main goals of every IGP, comparing OSPF, EIGRP, plus a few other IPv4 routing protocols.|Organizations have several options when choosing an IGP for their enterprise network, but most companies today use either OSPF or EIGRP. This book discusses OSPFv2, with the CCNP Enterprise certification adding EIGRP. Before getting into detail on these two protocols, the next section first discusses some of the main goals of every IGP, comparing OSPF, EIGRP, plus a few other IPv4 routing protocols.
##### IGP Routing Protocol Algorithms
IGP Routing Protocol Algorithms   
__|__
--|--
|
A routing protocol’s underlying algorithm determines how the routing protocol does its job.|A routing protocol’s underlying algorithm determines how the routing protocol does its job.
The term routing protocol algorithm simply refers to the logic and processes used by different routing protocols to solve the problem of learning all routes, choosing the best route to each subnet, and converging in reaction to changes in the internetwork.|The term routing protocol algorithm simply refers to the logic and processes used by different routing protocols to solve the problem of learning all routes, choosing the best route to each subnet, and converging in reaction to changes in the internetwork.
Three main branches of routing protocol algorithms exist for IGP routing protocols:|Three main branches of routing protocol algorithms exist for IGP routing protocols:
###### Distance vector (sometimes called Bellman-Ford after its creators)
Distance vector (sometimes called Bellman-Ford after its creators)   
###### Advanced distance vector (sometimes called “balanced hybrid”)
Advanced distance vector (sometimes called “balanced hybrid”)   
###### Link-state
Link-state   
__|__
--|--
|
Historically speaking, distance vector protocols were invented first, mainly in the early 1980s.|Historically speaking, distance vector protocols were invented first, mainly in the early 1980s.
Routing Information Protocol (RIP) was the first popularly used IP distance vector protocol, with the Cisco-proprietary Interior Gateway Routing Protocol (IGRP) being introduced a little later.|Routing Information Protocol (RIP) was the first popularly used IP distance vector protocol, with the Cisco-proprietary Interior Gateway Routing Protocol (IGRP) being introduced a little later.
|
By the early 1990s, distance vector protocols’ somewhat slow convergence and potential for routing loops drove the development of new alternative routing protocols that used new algorithms.|By the early 1990s, distance vector protocols’ somewhat slow convergence and potential for routing loops drove the development of new alternative routing protocols that used new algorithms.
Link-state protocols—in particular, Open Shortest Path First (OSPF) and Integrated Intermediate System to Intermediate System (IS-IS)—solved the main issues.|Link-state protocols—in particular, Open Shortest Path First (OSPF) and Integrated Intermediate System to Intermediate System (IS-IS)—solved the main issues.
They also came with a price: they required extra CPU and memory on routers, with more planning required from the network engineers.|They also came with a price: they required extra CPU and memory on routers, with more planning required from the network engineers.
|
NOTE All references to OSPF in this chapter refer to OSPFv2 unless otherwise stated.|NOTE All references to OSPF in this chapter refer to OSPFv2 unless otherwise stated.
|
Around the same time as the introduction of OSPF, Cisco created a proprietary routing protocol called Enhanced Interior Gateway Routing Protocol (EIGRP), which used some features of the earlier IGRP protocol.|Around the same time as the introduction of OSPF, Cisco created a proprietary routing protocol called Enhanced Interior Gateway Routing Protocol (EIGRP), which used some features of the earlier IGRP protocol.
EIGRP solved the same problems as did link-state routing protocols, but EIGRP required less planning when implementing the network.|EIGRP solved the same problems as did link-state routing protocols, but EIGRP required less planning when implementing the network.
As time went on, EIGRP was classified as a unique type of routing protocol.|As time went on, EIGRP was classified as a unique type of routing protocol.
However, it used more distance vector features than link-state, so it is more commonly classified as an advanced distance vector protocol.|However, it used more distance vector features than link-state, so it is more commonly classified as an advanced distance vector protocol.
##### Metrics
Metrics   
__|__
--|--
|
Routing protocols choose the best route to reach a subnet by choosing the route with the lowest metric.|Routing protocols choose the best route to reach a subnet by choosing the route with the lowest metric.
For example, RIP uses a counter of the number of routers (hops) between a router and the destination subnet, as shown in the example of Figure 19-1.|For example, RIP uses a counter of the number of routers (hops) between a router and the destination subnet, as shown in the example of Figure 19-1.
OSPF totals the cost associated with each interface in the end-to-end route, with the cost based on link bandwidth.|OSPF totals the cost associated with each interface in the end-to-end route, with the cost based on link bandwidth.
Table 19-2 lists the most common IP routing protocols and some details about the metric in each case.|Table 19-2 lists the most common IP routing protocols and some details about the metric in each case.
|
Table 19-2 IP IGP Metrics Table end.|Table 19-2 IP IGP Metrics Table end.
|
A brief comparison of the metric used by the older RIP versus the metric used by OSPF shows some insight into why OSPF and EIGRP surpassed RIP. Figure 19-3 shows an example in which Router B has two possible routes to subnet 10.1.1.0 on the left side of the network:|A brief comparison of the metric used by the older RIP versus the metric used by OSPF shows some insight into why OSPF and EIGRP surpassed RIP. Figure 19-3 shows an example in which Router B has two possible routes to subnet 10.1.1.0 on the left side of the network:
|
a shorter route over a very slow serial link at 1544 Kbps, or a longer route over two Gigabit Ethernet WAN links.|a shorter route over a very slow serial link at 1544 Kbps, or a longer route over two Gigabit Ethernet WAN links.
|
Figure 19-3 RIP and OSPF Metrics Compared The left side of the figure shows the results of RIP in this network.|Figure 19-3 RIP and OSPF Metrics Compared The left side of the figure shows the results of RIP in this network.
Using hop count, Router B learns of a one-hop route directly to Router A through B’s S0/0/1 interface.|Using hop count, Router B learns of a one-hop route directly to Router A through B’s S0/0/1 interface.
B also learns of a two-hop route through Router C, through B’s G0/0 interface.|B also learns of a two-hop route through Router C, through B’s G0/0 interface.
Router B chooses the lower hop count route, which happens to go over the slow-speed serial link.|Router B chooses the lower hop count route, which happens to go over the slow-speed serial link.
|
The right side of the figure shows the better choice made by OSPF based on its better metric.|The right side of the figure shows the better choice made by OSPF based on its better metric.
|
To cause OSPF to make the right choice, the engineer could use default settings based on the correct interface bandwidth to match the actual link speeds, thereby allowing OSPF to choose the faster route. (The bandwidth interface subcommand does not change the actual physical speed of the interface.|To cause OSPF to make the right choice, the engineer could use default settings based on the correct interface bandwidth to match the actual link speeds, thereby allowing OSPF to choose the faster route. (The bandwidth interface subcommand does not change the actual physical speed of the interface.
It just tells IOS what speed to assume the interface is using.)|It just tells IOS what speed to assume the interface is using.)
##### Other IGP Comparisons
Other IGP Comparisons   
__|__
--|--
|
Routing protocols can be compared based on many features, some of which matter to the current CCNA exam, whereas some do not.|Routing protocols can be compared based on many features, some of which matter to the current CCNA exam, whereas some do not.
Table 19-3 introduces a few more points and lists the comparison points mentioned in this book for easier study, with a few supporting comments following the table.|Table 19-3 introduces a few more points and lists the comparison points mentioned in this book for easier study, with a few supporting comments following the table.
|
Table 19-3 Interior IP Routing Protocols Compared Table end.|Table 19-3 Interior IP Routing Protocols Compared Table end.
|
1 Although Cisco created EIGRP and has kept it as a proprietary protocol for many years, Cisco chose to publish EIGRP as an informational RFC in 2013.|1 Although Cisco created EIGRP and has kept it as a proprietary protocol for many years, Cisco chose to publish EIGRP as an informational RFC in 2013.
This allows other vendors to implement EIGRP, while Cisco retains the rights to the protocol.|This allows other vendors to implement EIGRP, while Cisco retains the rights to the protocol.
|
Regarding the top row of the table, routing protocols can be considered to be a classless routing protocol or a classful routing protocol.|Regarding the top row of the table, routing protocols can be considered to be a classless routing protocol or a classful routing protocol.
Classless routing protocols support variablelength subnet masks (VLSM) as well as manual route summarization by sending routing protocol messages that include the subnet masks in the message.|Classless routing protocols support variablelength subnet masks (VLSM) as well as manual route summarization by sending routing protocol messages that include the subnet masks in the message.
The older RIPv1 and IGRP routing protocols—both classful routing protocols—do not.|The older RIPv1 and IGRP routing protocols—both classful routing protocols—do not.
|
Also, note that the older routing protocols (RIPv1, IGRP) sent routing protocol messages as IP broadcast addresses, while the newer routing protocols in the table all use IP multicast destination addresses.|Also, note that the older routing protocols (RIPv1, IGRP) sent routing protocol messages as IP broadcast addresses, while the newer routing protocols in the table all use IP multicast destination addresses.
The use of multicasts makes the protocol more efficient and causes less overhead and fewer issues with the devices in the subnet that are not running the routing protocol.|The use of multicasts makes the protocol more efficient and causes less overhead and fewer issues with the devices in the subnet that are not running the routing protocol.
#### Administrative Distance
Administrative Distance   
__|__
--|--
|
Many companies and organizations use a single routing protocol.|Many companies and organizations use a single routing protocol.
However, in some cases, a company needs to use multiple routing protocols.|However, in some cases, a company needs to use multiple routing protocols.
For example, if two companies connect their networks so that they can exchange information, they need to exchange some routing information.|For example, if two companies connect their networks so that they can exchange information, they need to exchange some routing information.
If one company uses OSPF and the other uses EIGRP on at least one router, both OSPF and EIGRP must be used.|If one company uses OSPF and the other uses EIGRP on at least one router, both OSPF and EIGRP must be used.
Then that router can take routes learned by OSPF and advertise them into EIGRP, and vice versa, through a process called route redistribution.|Then that router can take routes learned by OSPF and advertise them into EIGRP, and vice versa, through a process called route redistribution.
|
Depending on the network topology, the two routing protocols might learn routes to the same subnets.|Depending on the network topology, the two routing protocols might learn routes to the same subnets.
When a single routing protocol learns multiple routes to the same subnet, the metric tells it which route is best.|When a single routing protocol learns multiple routes to the same subnet, the metric tells it which route is best.
However, when two different routing protocols learn routes to the same subnet, because each routing protocol’s metric is based on different information, IOS cannot compare the metrics.|However, when two different routing protocols learn routes to the same subnet, because each routing protocol’s metric is based on different information, IOS cannot compare the metrics.
For example, OSPF might learn a route to subnet 10.1.1.0 with metric 101, and EIGRP might learn a route to 10.1.1.0 with metric 2,195,416, but the EIGRP-learned route might be the better route—or it might not.|For example, OSPF might learn a route to subnet 10.1.1.0 with metric 101, and EIGRP might learn a route to 10.1.1.0 with metric 2,195,416, but the EIGRP-learned route might be the better route—or it might not.
There is simply no basis for comparison between the two metrics.|There is simply no basis for comparison between the two metrics.
|
When IOS must choose between routes learned using different routing protocols, IOS uses a concept called administrative distance.|When IOS must choose between routes learned using different routing protocols, IOS uses a concept called administrative distance.
Administrative distance is a number that denotes how believable an entire routing protocol is on a single router.|Administrative distance is a number that denotes how believable an entire routing protocol is on a single router.
The lower the number, the better, or more believable, the routing protocol.|The lower the number, the better, or more believable, the routing protocol.
For example, RIP has a default administrative distance of 120, OSPF uses a default of 110, and EIGRP defaults to 90.|For example, RIP has a default administrative distance of 120, OSPF uses a default of 110, and EIGRP defaults to 90.
When using OSPF and EIGRP, the router will believe the EIGRP route instead of the OSPF route (at least by default).|When using OSPF and EIGRP, the router will believe the EIGRP route instead of the OSPF route (at least by default).
The administrative distance values are configured on a single router and are not exchanged with other routers.|The administrative distance values are configured on a single router and are not exchanged with other routers.
Table 19-4 lists the various sources of routing information, along with the default administrative distances.|Table 19-4 lists the various sources of routing information, along with the default administrative distances.
|
Table 19-4 Default Administrative Distances Table end.|Table 19-4 Default Administrative Distances Table end.
|
NOTE The show ip route command lists each route’s administrative distance as the first of the two numbers inside the brackets.|NOTE The show ip route command lists each route’s administrative distance as the first of the two numbers inside the brackets.
The second number in brackets is the metric.|The second number in brackets is the metric.
|
The table shows the default administrative distance values, but IOS can be configured to change the administrative distance of a particular routing protocol, a particular route, or even a static route.|The table shows the default administrative distance values, but IOS can be configured to change the administrative distance of a particular routing protocol, a particular route, or even a static route.
For example, the command ip route 10.1.3.0 255.255.255.0|For example, the command ip route 10.1.3.0 255.255.255.0
###### 10.1.130.253 defines a static route with a default administrative distance of 1, but the command
10.1.130.253 defines a static route with a default administrative distance of 1, but the command   
__|__
--|--
|
ip route 10.1.3.0 255.255.255.0 10.1.130.253 210 defines the same static route with an administrative distance of 210.|ip route 10.1.3.0 255.255.255.0 10.1.130.253 210 defines the same static route with an administrative distance of 210.
So, you can actually create a static route that is only used when the routing protocol does not find a route, just by giving the static route a higher administrative distance.|So, you can actually create a static route that is only used when the routing protocol does not find a route, just by giving the static route a higher administrative distance.
### OSPF Concepts and Operation
OSPF Concepts and Operation   
__|__
--|--
|
Routing protocols basically exchange information so routers can learn routes.|Routing protocols basically exchange information so routers can learn routes.
The routers learn information about subnets, routes to those subnets, and metric information about how good each route is compared to others.|The routers learn information about subnets, routes to those subnets, and metric information about how good each route is compared to others.
The routing protocol can then choose the currently best route to each subnet, building the IP routing table.|The routing protocol can then choose the currently best route to each subnet, building the IP routing table.
|
Link-state protocols like OSPF take a little different approach to the particulars of what information they exchange and what the routers do with that information once learned.|Link-state protocols like OSPF take a little different approach to the particulars of what information they exchange and what the routers do with that information once learned.
|
This next (second) major section narrows the focus to only link-state protocols, specifically OSPFv2.|This next (second) major section narrows the focus to only link-state protocols, specifically OSPFv2.
|
This section begins with an overview of what OSPF does by exchanging data about the network in data structures called link-state advertisements (LSA). Then the discussion backs up a bit to provide more details about each of three fundamental parts of how OSPF operates:|This section begins with an overview of what OSPF does by exchanging data about the network in data structures called link-state advertisements (LSA). Then the discussion backs up a bit to provide more details about each of three fundamental parts of how OSPF operates:
|
how OSPF routers use neighbor relationships, how routers exchange LSAs with neighbors, and then how routers calculate the best routes once they learn all the LSAs.|how OSPF routers use neighbor relationships, how routers exchange LSAs with neighbors, and then how routers calculate the best routes once they learn all the LSAs.
#### OSPF Overview
OSPF Overview   
__|__
--|--
|
Link-state protocols build IP routes with a couple of major steps.|Link-state protocols build IP routes with a couple of major steps.
First, the routers together build a lot of information about the network: routers, links, IP addresses, status information, and so on.|First, the routers together build a lot of information about the network: routers, links, IP addresses, status information, and so on.
Then the routers flood the information, so all routers know the same information.|Then the routers flood the information, so all routers know the same information.
At that point, each router can calculate routes to all subnets, but from each router’s own perspective.|At that point, each router can calculate routes to all subnets, but from each router’s own perspective.
##### Topology Information and LSAs
Topology Information and LSAs   
__|__
--|--
|
Routers using link-state routing protocols need to collectively advertise practically every detail about the internetwork to all the other routers.|Routers using link-state routing protocols need to collectively advertise practically every detail about the internetwork to all the other routers.
At the end of the process of flooding the information to all routers, every router in the internetwork has the exact same information about the internetwork.|At the end of the process of flooding the information to all routers, every router in the internetwork has the exact same information about the internetwork.
Flooding a lot of detailed information to every router sounds like a lot of work, and relative to distance vector routing protocols, it is.|Flooding a lot of detailed information to every router sounds like a lot of work, and relative to distance vector routing protocols, it is.
|
Open Shortest Path First (OSPF), the most popular link-state IP routing protocol, organizes topology information using LSAs and the link-state database (LSDB). Figure 19-4 represents the ideas.|Open Shortest Path First (OSPF), the most popular link-state IP routing protocol, organizes topology information using LSAs and the link-state database (LSDB). Figure 19-4 represents the ideas.
Each LSA is a data structure with some specific information about the network topology; the LSDB is simply the collection of all the LSAs known to a router.|Each LSA is a data structure with some specific information about the network topology; the LSDB is simply the collection of all the LSAs known to a router.
|
Figure 19-4 LSA and LSDB Relationship Figure 19-5 Flooding LSAs Using a Link-State Routing Protocol Figure 19-5 shows the rather basic flooding process, with R8 sending the original LSA for itself, and the other routers flooding the LSA by forwarding it until every router has a copy.|Figure 19-4 LSA and LSDB Relationship Figure 19-5 Flooding LSAs Using a Link-State Routing Protocol Figure 19-5 shows the rather basic flooding process, with R8 sending the original LSA for itself, and the other routers flooding the LSA by forwarding it until every router has a copy.
|
The flooding process causes every router to learn the contents of the LSA while preventing the LSA from being flooded around in circles.|The flooding process causes every router to learn the contents of the LSA while preventing the LSA from being flooded around in circles.
Basically, before sending an LSA to yet another neighbor, routers communicate, asking “Do you already have this LSA?,” and then sending the LSA to the next neighbor only if the neighbor has not yet learned about the LSA.|Basically, before sending an LSA to yet another neighbor, routers communicate, asking “Do you already have this LSA?,” and then sending the LSA to the next neighbor only if the neighbor has not yet learned about the LSA.
|
Once flooded, routers do occasionally reflood each LSA. Routers reflood an LSA when some information changes (for example, when a link goes up or comes down).|Once flooded, routers do occasionally reflood each LSA. Routers reflood an LSA when some information changes (for example, when a link goes up or comes down).
They also reflood each LSA based on each LSA’s separate aging timer (default 30 minutes).|They also reflood each LSA based on each LSA’s separate aging timer (default 30 minutes).
##### Applying Dijkstra SPF Math to Find the Best Routes
Applying Dijkstra SPF Math to Find the Best Routes   
__|__
--|--
|
The link-state flooding process results in every router having an identical copy of the LSDB in memory, but the flooding process alone does not cause a router to learn what routes to add to the IP routing table.|The link-state flooding process results in every router having an identical copy of the LSDB in memory, but the flooding process alone does not cause a router to learn what routes to add to the IP routing table.
Although incredibly detailed and useful, the information in the LSDB does not explicitly state each router’s best route to reach a destination.|Although incredibly detailed and useful, the information in the LSDB does not explicitly state each router’s best route to reach a destination.
|
To build routes, link-state routers have to do some math.|To build routes, link-state routers have to do some math.
Thankfully, you and I do not have to know the math!|Thankfully, you and I do not have to know the math!
However, all link-state protocols use a type of math algorithm, called the Dijkstra Shortest Path First (SPF) algorithm, to process the LSDB. That algorithm analyzes (with math) the LSDB and builds the routes that the local router should add to the IP routing table—routes that list a subnet number and mask, an outgoing interface, and a next-hop router IP address.|However, all link-state protocols use a type of math algorithm, called the Dijkstra Shortest Path First (SPF) algorithm, to process the LSDB. That algorithm analyzes (with math) the LSDB and builds the routes that the local router should add to the IP routing table—routes that list a subnet number and mask, an outgoing interface, and a next-hop router IP address.
|
Now that you have the big ideas down, the next several topics walk through the three main phases of how OSPF routers accomplish the work of exchanging LSAs and calculating routes.|Now that you have the big ideas down, the next several topics walk through the three main phases of how OSPF routers accomplish the work of exchanging LSAs and calculating routes.
Those three phases are Becoming neighbors: A relationship between two routers that connect to the same data link, created so that the neighboring routers have a means to exchange their LSDBs.|Those three phases are Becoming neighbors: A relationship between two routers that connect to the same data link, created so that the neighboring routers have a means to exchange their LSDBs.
|
Exchanging databases: The process of sending LSAs to neighbors so that all routers learn the same LSAs.|Exchanging databases: The process of sending LSAs to neighbors so that all routers learn the same LSAs.
|
Adding the best routes: The process of each router independently running SPF, on their local copy of the LSDB, calculating the best routes, and adding those to the IPv4 routing table.|Adding the best routes: The process of each router independently running SPF, on their local copy of the LSDB, calculating the best routes, and adding those to the IPv4 routing table.
#### Becoming OSPF Neighbors
Becoming OSPF Neighbors   
__|__
--|--
|
Of everything you learn about OSPF in this chapter, OSPF neighbor concepts have the most to do with how you will configure and troubleshoot OSPF in Cisco routers.|Of everything you learn about OSPF in this chapter, OSPF neighbor concepts have the most to do with how you will configure and troubleshoot OSPF in Cisco routers.
You configure OSPF to cause routers to run OSPF and become neighbors with other routers.|You configure OSPF to cause routers to run OSPF and become neighbors with other routers.
Once that happens, OSPF does the rest of the work to exchange LSAs and calculate routers in the background, with no additional configuration required.|Once that happens, OSPF does the rest of the work to exchange LSAs and calculate routers in the background, with no additional configuration required.
This section discusses the fundamental concepts of OSPF neighbors.|This section discusses the fundamental concepts of OSPF neighbors.
##### The Basics of OSPF Neighbors
The Basics of OSPF Neighbors   
__|__
--|--
|
OSPF neighbors are routers that both use OSPF and both sit on the same data link.|OSPF neighbors are routers that both use OSPF and both sit on the same data link.
Two routers can become OSPF neighbors if connected to the same VLAN, or same serial link, or same Ethernet WAN link.|Two routers can become OSPF neighbors if connected to the same VLAN, or same serial link, or same Ethernet WAN link.
|
Two routers need to do more than simply exist on the same link to become OSPF neighbors;|Two routers need to do more than simply exist on the same link to become OSPF neighbors;
|
they must send OSPF messages and agree to become OSPF neighbors.|they must send OSPF messages and agree to become OSPF neighbors.
To do so, the routers send OSPF Hello messages, introducing themselves to the potential neighbor.|To do so, the routers send OSPF Hello messages, introducing themselves to the potential neighbor.
Assuming the two potential neighbors have compatible OSPF parameters, the two form an OSPF neighbor relationship, and would be displayed in the output of the show ip ospf neighbor command.|Assuming the two potential neighbors have compatible OSPF parameters, the two form an OSPF neighbor relationship, and would be displayed in the output of the show ip ospf neighbor command.
|
The OSPF neighbor relationship also lets OSPF know when a neighbor might not be a good option for routing packets right now.|The OSPF neighbor relationship also lets OSPF know when a neighbor might not be a good option for routing packets right now.
Imagine R1 and R2 form a neighbor relationship, learn LSAs, and calculate routes that send packets through the other router.|Imagine R1 and R2 form a neighbor relationship, learn LSAs, and calculate routes that send packets through the other router.
Months later, R1 notices that the neighbor relationship with R2 fails.|Months later, R1 notices that the neighbor relationship with R2 fails.
That failed neighbor connection to R2 makes R1 react: R1 refloods LSAs impacted by the failed link, and R1 runs SPF to recalculate its own routes.|That failed neighbor connection to R2 makes R1 react: R1 refloods LSAs impacted by the failed link, and R1 runs SPF to recalculate its own routes.
|
Finally, the OSPF neighbor model allows new routers to be dynamically discovered.|Finally, the OSPF neighbor model allows new routers to be dynamically discovered.
That means new routers can be added to a network without requiring every router to be reconfigured.|That means new routers can be added to a network without requiring every router to be reconfigured.
|
Instead, OSPF routers listen for OSPF Hello messages from new routers and react to those messages, attempting to become neighbors and exchange LSDBs.|Instead, OSPF routers listen for OSPF Hello messages from new routers and react to those messages, attempting to become neighbors and exchange LSDBs.
##### Meeting Neighbors and Learning Their Router ID
Meeting Neighbors and Learning Their Router ID   
__|__
--|--
|
The OSPF Hello process, by which new neighbor relationships are formed, works somewhat like when you move to a new house and meet your various neighbors.|The OSPF Hello process, by which new neighbor relationships are formed, works somewhat like when you move to a new house and meet your various neighbors.
When you see each other outside, you might walk over, say hello, and learn each other’s name.|When you see each other outside, you might walk over, say hello, and learn each other’s name.
After talking a bit, you form a first impression, particularly as to whether you think you’ll enjoy chatting with this neighbor occasionally, or whether you can just wave and not take the time to talk the next time you see him outside.|After talking a bit, you form a first impression, particularly as to whether you think you’ll enjoy chatting with this neighbor occasionally, or whether you can just wave and not take the time to talk the next time you see him outside.
|
Similarly, with OSPF, the process starts with messages called OSPF Hello messages.|Similarly, with OSPF, the process starts with messages called OSPF Hello messages.
The Hellos in turn list each router’s router ID (RID), which serves as each router’s unique name or identifier for OSPF. Finally, OSPF does several checks of the information in the Hello messages to ensure that the two routers should become neighbors.|The Hellos in turn list each router’s router ID (RID), which serves as each router’s unique name or identifier for OSPF. Finally, OSPF does several checks of the information in the Hello messages to ensure that the two routers should become neighbors.
|
OSPF RIDs are 32-bit numbers.|OSPF RIDs are 32-bit numbers.
As a result, most command output lists these as dotted-decimal numbers (DDN). By default, IOS chooses one of the router’s interface IPv4 addresses to use as its OSPF RID. However, the OSPF RID can be directly configured, as covered in the section “Configuring the OSPF Router ID” in Chapter 20, “Implementing OSPF.”|As a result, most command output lists these as dotted-decimal numbers (DDN). By default, IOS chooses one of the router’s interface IPv4 addresses to use as its OSPF RID. However, the OSPF RID can be directly configured, as covered in the section “Configuring the OSPF Router ID” in Chapter 20, “Implementing OSPF.”
|
As soon as a router has chosen its OSPF RID and some interfaces come up, the router is ready to meet its OSPF neighbors.|As soon as a router has chosen its OSPF RID and some interfaces come up, the router is ready to meet its OSPF neighbors.
OSPF routers can become neighbors if they are connected to the same subnet.|OSPF routers can become neighbors if they are connected to the same subnet.
To discover other OSPF-speaking routers, a router sends multicast OSPF Hello packets to each interface and hopes to receive OSPF Hello packets from other routers connected to those interfaces.|To discover other OSPF-speaking routers, a router sends multicast OSPF Hello packets to each interface and hopes to receive OSPF Hello packets from other routers connected to those interfaces.
Figure 19-6 outlines the basic concept.|Figure 19-6 outlines the basic concept.
|
Figure 19-6 OSPF Hello Packets Routers R1 and R2 both send Hello messages onto the link.|Figure 19-6 OSPF Hello Packets Routers R1 and R2 both send Hello messages onto the link.
They continue to send Hellos at a regular interval based on their Hello timer settings.|They continue to send Hellos at a regular interval based on their Hello timer settings.
The Hello messages themselves have the following features:|The Hello messages themselves have the following features:
###### The Hello message follows the IP packet header, with IP protocol type 89.
The Hello message follows the IP packet header, with IP protocol type 89.   
###### Hello packets are sent to multicast IP address 224.0.0.5, a multicast IP address intended
Hello packets are sent to multicast IP address 224.0.0.5, a multicast IP address intended   
__|__
--|--
|
for all OSPF-speaking routers.|for all OSPF-speaking routers.
###### OSPF routers listen for packets sent to IP multicast address 224.0.0.5, in part hoping to
OSPF routers listen for packets sent to IP multicast address 224.0.0.5, in part hoping to   
__|__
--|--
|
receive Hello packets and learn about new neighbors.|receive Hello packets and learn about new neighbors.
|
Taking a closer look, Figure 19-7 shows several of the neighbor states used by the early formation of an OSPF neighbor relationship.|Taking a closer look, Figure 19-7 shows several of the neighbor states used by the early formation of an OSPF neighbor relationship.
The figure shows the Hello messages in the center and the resulting neighbor states on the left and right edges of the figure.|The figure shows the Hello messages in the center and the resulting neighbor states on the left and right edges of the figure.
Each router keeps an OSPF state variable for how it views the neighbor.|Each router keeps an OSPF state variable for how it views the neighbor.
|
Figure 19-7 Early Neighbor States Following the steps in the figure, the scenario begins with the link down, so the routers have no knowledge of each other as OSPF neighbors.|Figure 19-7 Early Neighbor States Following the steps in the figure, the scenario begins with the link down, so the routers have no knowledge of each other as OSPF neighbors.
As a result, they have no state (status) information about each other as neighbors, and they would not list each other in the output of the show ip ospf neighbor command.|As a result, they have no state (status) information about each other as neighbors, and they would not list each other in the output of the show ip ospf neighbor command.
At Step 2, R1 sends the first Hello, so R2 learns of the existence of R1 as an OSPF router.|At Step 2, R1 sends the first Hello, so R2 learns of the existence of R1 as an OSPF router.
At that point, R2 lists R1 as a neighbor, with an interim beginning state of init.|At that point, R2 lists R1 as a neighbor, with an interim beginning state of init.
|
The process continues at Step 3, with R2 sending back a Hello.|The process continues at Step 3, with R2 sending back a Hello.
This message tells R1 that R2 exists, and it allows R1 to move through the init state and quickly to a 2-way state.|This message tells R1 that R2 exists, and it allows R1 to move through the init state and quickly to a 2-way state.
At Step 4, R2 receives the next Hello from R1, and R2 can also move to a 2-way state.|At Step 4, R2 receives the next Hello from R1, and R2 can also move to a 2-way state.
|
The 2-way state is a particularly important OSPF state.|The 2-way state is a particularly important OSPF state.
At that point, the following major facts are true:|At that point, the following major facts are true:
###### The router received a Hello from the neighbor, with that router’s own RID listed as being
The router received a Hello from the neighbor, with that router’s own RID listed as being   
__|__
--|--
|
seen by the neighbor.|seen by the neighbor.
###### The router has checked all the parameters in the Hello received from the neighbor, with
The router has checked all the parameters in the Hello received from the neighbor, with   
__|__
--|--
|
no problems.|no problems.
The router is willing to become an OSPF neighbor.|The router is willing to become an OSPF neighbor.
###### If both routers reach a 2-way state with each other, it means that both routers meet all
If both routers reach a 2-way state with each other, it means that both routers meet all   
__|__
--|--
|
OSPF configuration requirements to become neighbors.|OSPF configuration requirements to become neighbors.
Effectively, at that point, they are neighbors and ready to exchange their LSDB with each other.|Effectively, at that point, they are neighbors and ready to exchange their LSDB with each other.
#### Exchanging the LSDB Between Neighbors
Exchanging the LSDB Between Neighbors   
__|__
--|--
|
One purpose of forming OSPF neighbor relationships is to allow the two neighbors to exchange their databases.|One purpose of forming OSPF neighbor relationships is to allow the two neighbors to exchange their databases.
This next topic works through some of the details of OSPF database exchange.|This next topic works through some of the details of OSPF database exchange.
##### Fully Exchanging LSAs with Neighbors
Fully Exchanging LSAs with Neighbors   
__|__
--|--
|
The OSPF neighbor state 2-way means that the router is available to exchange its LSDB with the neighbor.|The OSPF neighbor state 2-way means that the router is available to exchange its LSDB with the neighbor.
In other words, it is ready to begin a 2-way exchange of the LSDB. So, once two routers on a link reach the 2-way state, they can immediately move on to the process of database exchange.|In other words, it is ready to begin a 2-way exchange of the LSDB. So, once two routers on a link reach the 2-way state, they can immediately move on to the process of database exchange.
|
The database exchange process can be quite involved, with several OSPF messages and several interim neighbor states.|The database exchange process can be quite involved, with several OSPF messages and several interim neighbor states.
This chapter is more concerned with a few of the messages and the final state when database exchange has completed: the full state.|This chapter is more concerned with a few of the messages and the final state when database exchange has completed: the full state.
|
After two routers decide to exchange databases, they do not simply send the contents of the entire database.|After two routers decide to exchange databases, they do not simply send the contents of the entire database.
First, they tell each other a list of LSAs in their respective databases—not all the details of the LSAs, just a list. (Think of these lists as checklists.) Then each router can check which LSAs it already has and then ask the other router for only the LSAs that are not known yet.|First, they tell each other a list of LSAs in their respective databases—not all the details of the LSAs, just a list. (Think of these lists as checklists.) Then each router can check which LSAs it already has and then ask the other router for only the LSAs that are not known yet.
|
For instance, R1 might send R2 a checklist that lists 10 LSAs (using an OSPF Database Description, or DD, packet).|For instance, R1 might send R2 a checklist that lists 10 LSAs (using an OSPF Database Description, or DD, packet).
R2 then checks its LSDB and finds six of those 10 LSAs. So, R2 asks R1 (using a Link-State Request packet) to send the four additional LSAs.|R2 then checks its LSDB and finds six of those 10 LSAs. So, R2 asks R1 (using a Link-State Request packet) to send the four additional LSAs.
|
Thankfully, most OSPFv2 work does not require detailed knowledge of these specific protocol steps.|Thankfully, most OSPFv2 work does not require detailed knowledge of these specific protocol steps.
However, a few of the terms are used quite a bit and should be remembered.|However, a few of the terms are used quite a bit and should be remembered.
In particular, the OSPF messages that actually send the LSAs between neighbors are called Link-State Update (LSU) packets.|In particular, the OSPF messages that actually send the LSAs between neighbors are called Link-State Update (LSU) packets.
That is, the LSU packet holds data structures called linkstate advertisements (LSA). The LSAs are not packets, but rather data structures that sit inside the LSDB and describe the topology.|That is, the LSU packet holds data structures called linkstate advertisements (LSA). The LSAs are not packets, but rather data structures that sit inside the LSDB and describe the topology.
|
Figure 19-8 pulls some of these terms and processes together, with a general example.|Figure 19-8 pulls some of these terms and processes together, with a general example.
The story picks up the example shown in Figure 19-7, with Figure 19-8 showing an example of the database exchange process between Routers R1 and R2. The center shows the protocol messages, and the outer items show the neighbor states at different points in the process.|The story picks up the example shown in Figure 19-7, with Figure 19-8 showing an example of the database exchange process between Routers R1 and R2. The center shows the protocol messages, and the outer items show the neighbor states at different points in the process.
|
Focus on two items in particular:|Focus on two items in particular:
###### The routers exchange the LSAs inside LSU packets.
The routers exchange the LSAs inside LSU packets.   
###### When finished, the routers reach a full state, meaning they have fully exchanged the contents
When finished, the routers reach a full state, meaning they have fully exchanged the contents   
__|__
--|--
|
of their LSDBs.|of their LSDBs.
|
Database Description RID 1.1.1.1 RID 2.2.2.2 Database Description LSU, with Several LSAs Exchange Loading Loading Full Full ExStart LSU, with Several LSAs ...|Database Description RID 1.1.1.1 RID 2.2.2.2 Database Description LSU, with Several LSAs Exchange Loading Loading Full Full ExStart LSU, with Several LSAs ...
|
Figure 19-8 Database Exchange Example, Ending in a Full State|Figure 19-8 Database Exchange Example, Ending in a Full State
##### Maintaining Neighbors and the LSDB
Maintaining Neighbors and the LSDB   
__|__
--|--
|
Once two neighbors reach a full state, they have done all the initial work to exchange OSPF information between them.|Once two neighbors reach a full state, they have done all the initial work to exchange OSPF information between them.
However, neighbors still have to do some small ongoing tasks to maintain the neighbor relationship.|However, neighbors still have to do some small ongoing tasks to maintain the neighbor relationship.
|
First, routers monitor each neighbor relationship using Hello messages and two related timers:|First, routers monitor each neighbor relationship using Hello messages and two related timers:
|
the Hello Interval and the Dead Interval.|the Hello Interval and the Dead Interval.
Routers send Hellos every Hello Interval to each neighbor.|Routers send Hellos every Hello Interval to each neighbor.
Each router expects to receive a Hello from each neighbor based on the Hello Interval, so if a neighbor is silent for the length of the Dead Interval (by default, four times as long as the Hello Interval), the loss of Hellos means that the neighbor has failed.|Each router expects to receive a Hello from each neighbor based on the Hello Interval, so if a neighbor is silent for the length of the Dead Interval (by default, four times as long as the Hello Interval), the loss of Hellos means that the neighbor has failed.
|
Next, routers must react when the topology changes as well, and neighbors play a key role in that process.|Next, routers must react when the topology changes as well, and neighbors play a key role in that process.
When something changes, one or more routers change one or more LSAs. Then the routers must flood the changed LSAs to each neighbor so that the neighbor can change its LSDB.|When something changes, one or more routers change one or more LSAs. Then the routers must flood the changed LSAs to each neighbor so that the neighbor can change its LSDB.
|
For example, imagine a LAN switch loses power, so a router’s G0/0 interface fails from up/up to down/down.|For example, imagine a LAN switch loses power, so a router’s G0/0 interface fails from up/up to down/down.
That router updates an LSA that shows the router’s G0/0 as being down.|That router updates an LSA that shows the router’s G0/0 as being down.
That router then sends the LSA to its neighbors, and that neighbor in turn sends it to its neighbors, until all routers again have an identical copy of the LSDB. Each router’s LSDB now reflects the fact that the original router’s G0/0 interface failed, so each router will then use SPF to recalculate any routes affected by the failed interface.|That router then sends the LSA to its neighbors, and that neighbor in turn sends it to its neighbors, until all routers again have an identical copy of the LSDB. Each router’s LSDB now reflects the fact that the original router’s G0/0 interface failed, so each router will then use SPF to recalculate any routes affected by the failed interface.
|
A third maintenance task done by neighbors is to reflood each LSA occasionally, even when the network is completely stable.|A third maintenance task done by neighbors is to reflood each LSA occasionally, even when the network is completely stable.
By default, each router that creates an LSA also has the responsibility to reflood the LSA every 30 minutes (the default), even if no changes occur.|By default, each router that creates an LSA also has the responsibility to reflood the LSA every 30 minutes (the default), even if no changes occur.
|
(Note that each LSA has a separate timer, based on when the LSA was created, so there is no single big event where the network is overloaded with flooding LSAs.)|(Note that each LSA has a separate timer, based on when the LSA was created, so there is no single big event where the network is overloaded with flooding LSAs.)
|
The following list summarizes these three maintenance tasks for easier review:|The following list summarizes these three maintenance tasks for easier review:
###### Maintain neighbor state by sending Hello messages based on the Hello Interval and listening
Maintain neighbor state by sending Hello messages based on the Hello Interval and listening   
__|__
--|--
|
for Hellos before the Dead Interval expires|for Hellos before the Dead Interval expires
###### Flood any changed LSAs to each neighbor
Flood any changed LSAs to each neighbor   
###### Reflood unchanged LSAs as their lifetime expires (default 30 minutes)
Reflood unchanged LSAs as their lifetime expires (default 30 minutes)   
##### Using Designated Routers on Ethernet Links
Using Designated Routers on Ethernet Links   
__|__
--|--
|
OSPF behaves differently on some types of interfaces based on a per-interface setting called the OSPF network type.|OSPF behaves differently on some types of interfaces based on a per-interface setting called the OSPF network type.
On Ethernet links, OSPF defaults to use a network type of broadcast, which causes OSPF to elect one of the routers on the same subnet to act as the designated router (DR). The DR plays a key role in how the database exchange process works, with different rules than with point-to-point links.|On Ethernet links, OSPF defaults to use a network type of broadcast, which causes OSPF to elect one of the routers on the same subnet to act as the designated router (DR). The DR plays a key role in how the database exchange process works, with different rules than with point-to-point links.
|
To see how, consider the example that begins with Figure 19-9.|To see how, consider the example that begins with Figure 19-9.
The figure shows five OSPFv2 routers on the same Ethernet VLAN. These five OSPF routers elect one router to act as the DR and one router to be a backup DR (BDR). The figure shows A and B as DR and BDR, for no other reason than the Ethernet must have one of each.|The figure shows five OSPFv2 routers on the same Ethernet VLAN. These five OSPF routers elect one router to act as the DR and one router to be a backup DR (BDR). The figure shows A and B as DR and BDR, for no other reason than the Ethernet must have one of each.
|
Figure 19-9 Routers A and B Elected as DR and BDR The database exchange process on an Ethernet link does not happen between every pair of routers on the same VLAN/subnet.|Figure 19-9 Routers A and B Elected as DR and BDR The database exchange process on an Ethernet link does not happen between every pair of routers on the same VLAN/subnet.
Instead, it happens between the DR and each of the other routers, with the DR making sure that all the other routers get a copy of each LSA. In other words, the database exchange happens over the flows shown in Figure 19-10.|Instead, it happens between the DR and each of the other routers, with the DR making sure that all the other routers get a copy of each LSA. In other words, the database exchange happens over the flows shown in Figure 19-10.
|
Figure 19-10 Database Exchange to and from the DR on an Ethernet OSPF uses the BDR concept because the DR is so important to the database exchange process.|Figure 19-10 Database Exchange to and from the DR on an Ethernet OSPF uses the BDR concept because the DR is so important to the database exchange process.
|
The BDR watches the status of the DR and takes over for the DR if it fails. (When the DR fails, the BDR takes over, and then a new BDR is elected.)|The BDR watches the status of the DR and takes over for the DR if it fails. (When the DR fails, the BDR takes over, and then a new BDR is elected.)
|
The use of a DR/BDR, along with the use of multicast IP addresses, makes the exchange of OSPF LSDBs more efficient on networks that allow more than two routers on the same link.|The use of a DR/BDR, along with the use of multicast IP addresses, makes the exchange of OSPF LSDBs more efficient on networks that allow more than two routers on the same link.
|
The DR can send a packet to all OSPF routers in the subnet by using multicast IP address 224.0.0.5.|The DR can send a packet to all OSPF routers in the subnet by using multicast IP address 224.0.0.5.
IANA reserves this address as the “All SPF Routers” multicast address just for this purpose.|IANA reserves this address as the “All SPF Routers” multicast address just for this purpose.
For instance, in Figure 19-10, the DR can send one set of messages to all the OSPF routers rather than sending one message to each router.|For instance, in Figure 19-10, the DR can send one set of messages to all the OSPF routers rather than sending one message to each router.
|
Similarly, any OSPF router needing to send a message to the DR and also to the BDR (so it remains ready to take over for the DR) can send those messages to the “All SPF DRs” multicast address 224.0.0.6.|Similarly, any OSPF router needing to send a message to the DR and also to the BDR (so it remains ready to take over for the DR) can send those messages to the “All SPF DRs” multicast address 224.0.0.6.
So, instead of having to send one set of messages to the DR and another set to the BDR, an OSPF router can send one set of messages, making the exchange more efficient.|So, instead of having to send one set of messages to the DR and another set to the BDR, an OSPF router can send one set of messages, making the exchange more efficient.
|
At this point, you might be getting a little tired of some of the theory, but finally, the theory actually shows something that you may see in show commands on a router.|At this point, you might be getting a little tired of some of the theory, but finally, the theory actually shows something that you may see in show commands on a router.
Because the DR and BDR both do full database exchange with all the other OSPF routers in the LAN, they reach a full state with all neighbors.|Because the DR and BDR both do full database exchange with all the other OSPF routers in the LAN, they reach a full state with all neighbors.
However, routers that are neither a DR nor a BDR—|However, routers that are neither a DR nor a BDR—
|
called DROthers by OSPF—never reach a full state because they do not exchange LSDBs directly with each other.|called DROthers by OSPF—never reach a full state because they do not exchange LSDBs directly with each other.
As a result, the show ip ospf neighbor command on these DROther routers lists some neighbors in a 2-way state, remaining in that state under normal operation.|As a result, the show ip ospf neighbor command on these DROther routers lists some neighbors in a 2-way state, remaining in that state under normal operation.
|
For instance, with OSPF working normally on the Ethernet LAN in Figure 19-10, a show ip ospf neighbor command on router C (which is a DROther router) would show the following:|For instance, with OSPF working normally on the Ethernet LAN in Figure 19-10, a show ip ospf neighbor command on router C (which is a DROther router) would show the following:
###### Two neighbors (A and B, the DR and BDR, respectively) with a full state (called fully
Two neighbors (A and B, the DR and BDR, respectively) with a full state (called fully   
__|__
--|--
|
adjacent neighbors)|adjacent neighbors)
###### Two neighbors (D and E, which are DROthers) with a 2-way state (called neighbors)
Two neighbors (D and E, which are DROthers) with a 2-way state (called neighbors)   
__|__
--|--
|
OSPF requires some terms to describe all neighbors versus the subset of all neighbors that reach the full state.|OSPF requires some terms to describe all neighbors versus the subset of all neighbors that reach the full state.
First, all OSPF routers on the same link that reach the 2-way state—that is, they send Hello messages and the parameters match—are called neighbors.|First, all OSPF routers on the same link that reach the 2-way state—that is, they send Hello messages and the parameters match—are called neighbors.
The subset of neighbors for which the neighbor relationship continues on and reaches the full state are called adjacent neighbors.|The subset of neighbors for which the neighbor relationship continues on and reaches the full state are called adjacent neighbors.
Additionally, OSPFv2 RFC 2328 emphasizes the connection between the full state and the term adjacent neighbor by using the synonyms of fully adjacent and fully adjacent neighbor.|Additionally, OSPFv2 RFC 2328 emphasizes the connection between the full state and the term adjacent neighbor by using the synonyms of fully adjacent and fully adjacent neighbor.
Finally, while the terms so far refer to the neighbor, two other terms refer to the relationship: neighbor relationship refers to any OSPF neighbor relationship, while the term adjacency refers to neighbor relationships that reach a full state.|Finally, while the terms so far refer to the neighbor, two other terms refer to the relationship: neighbor relationship refers to any OSPF neighbor relationship, while the term adjacency refers to neighbor relationships that reach a full state.
Table 19-5 details the terms.|Table 19-5 details the terms.
|
Table 19-5 Stable OSPF Neighbor States and Their Meanings Table end.|Table 19-5 Stable OSPF Neighbor States and Their Meanings Table end.
#### Calculating the Best Routes with SPF
Calculating the Best Routes with SPF   
__|__
--|--
|
OSPF LSAs contain useful information, but they do not contain the specific information that a router needs to add to its IPv4 routing table.|OSPF LSAs contain useful information, but they do not contain the specific information that a router needs to add to its IPv4 routing table.
In other words, a router cannot just copy information from the LSDB into a route in the IPv4 routing table.|In other words, a router cannot just copy information from the LSDB into a route in the IPv4 routing table.
The LSAs individually are more like pieces of a jigsaw puzzle.|The LSAs individually are more like pieces of a jigsaw puzzle.
So, to know what routes to add to the routing table, each router must do some SPF math to choose the best routes from that router’s perspective.|So, to know what routes to add to the routing table, each router must do some SPF math to choose the best routes from that router’s perspective.
The router then adds each route to its routing table: a route with a subnet number and mask, an outgoing interface, and a next-hop router IP address.|The router then adds each route to its routing table: a route with a subnet number and mask, an outgoing interface, and a next-hop router IP address.
|
Although engineers do not need to know the details of how SPF does the math, they do need to know how to predict which routes SPF will choose as the best route.|Although engineers do not need to know the details of how SPF does the math, they do need to know how to predict which routes SPF will choose as the best route.
The SPF algorithm calculates all the routes for a subnet—that is, all possible routes from the router to the destination subnet.|The SPF algorithm calculates all the routes for a subnet—that is, all possible routes from the router to the destination subnet.
If more than one route exists, the router compares the metrics, picking the best (lowest) metric route to add to the routing table.|If more than one route exists, the router compares the metrics, picking the best (lowest) metric route to add to the routing table.
Although the SPF math can be complex, engineers with a network diagram, router status information, and simple addition can calculate the metric for each route, predicting what SPF will choose.|Although the SPF math can be complex, engineers with a network diagram, router status information, and simple addition can calculate the metric for each route, predicting what SPF will choose.
|
Once SPF has identified a route, OSPF calculates the metric for a route as follows:|Once SPF has identified a route, OSPF calculates the metric for a route as follows:
|
The sum of the OSPF interface costs for all outgoing interfaces in the route.|The sum of the OSPF interface costs for all outgoing interfaces in the route.
|
Figure 19-11 shows an example with three possible routes from R1 to Subnet X (172.16.3.0/24) at the bottom of the figure.|Figure 19-11 shows an example with three possible routes from R1 to Subnet X (172.16.3.0/24) at the bottom of the figure.
|
Figure 19-11 SPF Tree to Find R1’s Route to 172.16.3.0/24 NOTE OSPF considers the costs of the outgoing interfaces (only) in each route.|Figure 19-11 SPF Tree to Find R1’s Route to 172.16.3.0/24 NOTE OSPF considers the costs of the outgoing interfaces (only) in each route.
It does not add the cost for incoming interfaces in the route.|It does not add the cost for incoming interfaces in the route.
|
Table 19-6 lists the three routes shown in Figure 19-11, with their cumulative costs, showing that R1’s best route to 172.16.3.0/24 starts by going through R5.|Table 19-6 lists the three routes shown in Figure 19-11, with their cumulative costs, showing that R1’s best route to 172.16.3.0/24 starts by going through R5.
|
Route Location in Figure 19-11 Cumulative Cost R1–R7–R8 Left 10 + 180 + 10 = 200 R1–R5–R6–R8 Middle 20 + 30 + 40 + 10 = 100 R1–R2–R3–R4–R8 Right 30 + 60 + 20 + 5 + 10 = 125 Table end.|Route Location in Figure 19-11 Cumulative Cost R1–R7–R8 Left 10 + 180 + 10 = 200 R1–R5–R6–R8 Middle 20 + 30 + 40 + 10 = 100 R1–R2–R3–R4–R8 Right 30 + 60 + 20 + 5 + 10 = 125 Table end.
|
Table end.|Table end.
|
As a result of the SPF algorithm’s analysis of the LSDB, R1 adds a route to subnet 172.16.3.0/24 to its routing table, with the next-hop router of R5.|As a result of the SPF algorithm’s analysis of the LSDB, R1 adds a route to subnet 172.16.3.0/24 to its routing table, with the next-hop router of R5.
|
In real OSPF networks, an engineer can do the same process by knowing the OSPF cost for each interface.|In real OSPF networks, an engineer can do the same process by knowing the OSPF cost for each interface.
Armed with a network diagram, the engineer can examine all routes, add the costs, and predict the metric for each route.|Armed with a network diagram, the engineer can examine all routes, add the costs, and predict the metric for each route.
### OSPF Areas and LSAs
OSPF Areas and LSAs   
__|__
--|--
|
OSPF can be used in some networks with very little thought about design issues.|OSPF can be used in some networks with very little thought about design issues.
You just turn on OSPF in all the routers, put all interfaces into the same area (usually area 0), and it works!|You just turn on OSPF in all the routers, put all interfaces into the same area (usually area 0), and it works!
|
Figure 19-12 shows one such network example, with 11 routers and all interfaces in area 0.|Figure 19-12 shows one such network example, with 11 routers and all interfaces in area 0.
|
Figure 19-12 Single-Area OSPF Larger OSPFv2 networks suffer with a single-area design.|Figure 19-12 Single-Area OSPF Larger OSPFv2 networks suffer with a single-area design.
For instance, now imagine an enterprise network with 900 routers, rather than only 11, and several thousand subnets.|For instance, now imagine an enterprise network with 900 routers, rather than only 11, and several thousand subnets.
As it turns out, the CPU time to run the SPF algorithm on all that topology data just takes time.|As it turns out, the CPU time to run the SPF algorithm on all that topology data just takes time.
|
As a result, OSPFv2 convergence time—the time required to react to changes in the network—|As a result, OSPFv2 convergence time—the time required to react to changes in the network—
|
can be slow.|can be slow.
The routers might run low on RAM as well.|The routers might run low on RAM as well.
Additional problems with a single area design include the following:|Additional problems with a single area design include the following:
###### A larger topology database requires more memory on each router.
A larger topology database requires more memory on each router.   
###### The SPF algorithm requires processing power that grows exponentially compared to the
The SPF algorithm requires processing power that grows exponentially compared to the   
__|__
--|--
|
size of the topology database.|size of the topology database.
###### A single interface status change anywhere in the internetwork (up to down, or down to
A single interface status change anywhere in the internetwork (up to down, or down to   
__|__
--|--
|
up) forces every router to run SPF again!|up) forces every router to run SPF again!
|
The solution is to take the one large LSDB and break it into several smaller LSDBs by using OSPF areas.|The solution is to take the one large LSDB and break it into several smaller LSDBs by using OSPF areas.
With areas, each link is placed into one area.|With areas, each link is placed into one area.
SPF does its complicated math on the topology inside the area, and that area’s topology only.|SPF does its complicated math on the topology inside the area, and that area’s topology only.
For instance, an internetwork with 1000 routers and 2000 subnets, broken in 100 areas, would average 10 routers and 20 subnets per area.|For instance, an internetwork with 1000 routers and 2000 subnets, broken in 100 areas, would average 10 routers and 20 subnets per area.
The SPF calculation on a router would have to only process topology about 10 routers and 20 links, rather than 1000 routers and 2000 links.|The SPF calculation on a router would have to only process topology about 10 routers and 20 links, rather than 1000 routers and 2000 links.
|
So, how large does a network have to be before OSPF needs to use areas?|So, how large does a network have to be before OSPF needs to use areas?
Well, there is no set answer because the behavior of the SPF process depends largely on CPU processing speed, the amount of RAM, the size of the LSDB, and so on.|Well, there is no set answer because the behavior of the SPF process depends largely on CPU processing speed, the amount of RAM, the size of the LSDB, and so on.
Generally, networks larger than a few dozen routers benefit from areas, and some documents over the years have listed 50 routers as the dividing line at which a network really should use multiple OSPF areas.|Generally, networks larger than a few dozen routers benefit from areas, and some documents over the years have listed 50 routers as the dividing line at which a network really should use multiple OSPF areas.
|
The next few pages look at how OSPF area design works, with more reasons as to why areas help make larger OSPF networks work better.|The next few pages look at how OSPF area design works, with more reasons as to why areas help make larger OSPF networks work better.
#### OSPF Areas
OSPF Areas   
__|__
--|--
|
OSPF area design follows a couple of basic rules.|OSPF area design follows a couple of basic rules.
To apply the rules, start with a clean drawing of the internetwork, with routers, and all interfaces.|To apply the rules, start with a clean drawing of the internetwork, with routers, and all interfaces.
Then choose the area for each router interface, as follows:|Then choose the area for each router interface, as follows:
###### Put all interfaces connected to the same subnet inside the same area.
Put all interfaces connected to the same subnet inside the same area.   
###### An area should be contiguous.
An area should be contiguous.   
###### Some routers may be internal to an area, with all interfaces assigned to that single area.
Some routers may be internal to an area, with all interfaces assigned to that single area.   
###### Some routers may be Area Border Routers (ABR) because some interfaces connect to the
Some routers may be Area Border Routers (ABR) because some interfaces connect to the   
__|__
--|--
|
backbone area, and some connect to nonbackbone areas.|backbone area, and some connect to nonbackbone areas.
###### All nonbackbone areas must have a path to reach the backbone area (area 0) by having at
All nonbackbone areas must have a path to reach the backbone area (area 0) by having at   
__|__
--|--
|
least one ABR connected to both the backbone area and the nonbackbone area.|least one ABR connected to both the backbone area and the nonbackbone area.
|
Figure 19-13 shows one example.|Figure 19-13 shows one example.
An engineer started with a network diagram that showed all 11 routers and their links.|An engineer started with a network diagram that showed all 11 routers and their links.
On the left, the engineer put four WAN links and the LANs connected to branch routers B1 through B4 into area 1.|On the left, the engineer put four WAN links and the LANs connected to branch routers B1 through B4 into area 1.
Similarly, he placed the links to branches B11 through B14 and their LANs in area 2.|Similarly, he placed the links to branches B11 through B14 and their LANs in area 2.
Both areas need a connection to the backbone area, area 0, so he put the LAN interfaces of D1 and D2 into area 0, along with D3, creating the backbone area.|Both areas need a connection to the backbone area, area 0, so he put the LAN interfaces of D1 and D2 into area 0, along with D3, creating the backbone area.
|
The figure also shows a few important OSPF area design terms.|The figure also shows a few important OSPF area design terms.
Table 19-7 summarizes the meaning of these terms, plus some other related terms, but pay closest attention to the terms from the figure.|Table 19-7 summarizes the meaning of these terms, plus some other related terms, but pay closest attention to the terms from the figure.
|
Figure 19-13 Three-Area OSPF with D1 and D2 as ABRs Table 19-7 OSPF Design Terminology Table end.|Figure 19-13 Three-Area OSPF with D1 and D2 as ABRs Table 19-7 OSPF Design Terminology Table end.
#### How Areas Reduce SPF Calculation Time
How Areas Reduce SPF Calculation Time   
__|__
--|--
|
Figure 19-13 shows a sample area design and some terminology related to areas, but it does not show the power and benefit of the areas.|Figure 19-13 shows a sample area design and some terminology related to areas, but it does not show the power and benefit of the areas.
To understand how areas reduce the work SPF has to do, you need to understand what changes about the LSDB inside an area, as a result of the area design.|To understand how areas reduce the work SPF has to do, you need to understand what changes about the LSDB inside an area, as a result of the area design.
|
SPF spends most of its processing time working through all the topology details, namely routers and the links that connect routers.|SPF spends most of its processing time working through all the topology details, namely routers and the links that connect routers.
Areas reduce SPF’s workload because, for a given area, the LSDB lists only routers and links inside that area, as shown on the left side of Figure 19-14.|Areas reduce SPF’s workload because, for a given area, the LSDB lists only routers and links inside that area, as shown on the left side of Figure 19-14.
|
Figure 19-14 Smaller Area 1 LSDB Concept While the LSDB has less topology information, it still has to have information about all subnets in all areas, so that each router can create IPv4 routes for all subnets.|Figure 19-14 Smaller Area 1 LSDB Concept While the LSDB has less topology information, it still has to have information about all subnets in all areas, so that each router can create IPv4 routes for all subnets.
So, with an area design, OSPFv2 uses very brief summary information about the subnets in other areas.|So, with an area design, OSPFv2 uses very brief summary information about the subnets in other areas.
|
These summary LSAs do not include topology information about the other areas; however, each summary LSA does list a subnet ID and mask of a subnet in some other area.|These summary LSAs do not include topology information about the other areas; however, each summary LSA does list a subnet ID and mask of a subnet in some other area.
Summary LSAs do not require much SPF processing at all.|Summary LSAs do not require much SPF processing at all.
Instead, these subnets all appear like subnets connected to the ABR (in Figure 19-14, ABR D1).|Instead, these subnets all appear like subnets connected to the ABR (in Figure 19-14, ABR D1).
|
Using multiple areas improves OSPF operations in many ways for larger networks.|Using multiple areas improves OSPF operations in many ways for larger networks.
The following list summarizes some of the key points arguing for the use of multiple areas in larger OSPF networks:|The following list summarizes some of the key points arguing for the use of multiple areas in larger OSPF networks:
###### Routers require fewer CPU cycles to process the smaller per-area LSDB with the SPF
Routers require fewer CPU cycles to process the smaller per-area LSDB with the SPF   
__|__
--|--
|
algorithm, reducing CPU overhead and improving convergence time.|algorithm, reducing CPU overhead and improving convergence time.
###### The smaller per-area LSDB requires less memory.
The smaller per-area LSDB requires less memory.   
###### Changes in the network (for example, links failing and recovering) require SPF calculations
Changes in the network (for example, links failing and recovering) require SPF calculations   
__|__
--|--
|
only on routers in the area where the link changed state, reducing the number of routers that must rerun SPF.|only on routers in the area where the link changed state, reducing the number of routers that must rerun SPF.
###### Less information must be advertised between areas, reducing the bandwidth required to
Less information must be advertised between areas, reducing the bandwidth required to   
__|__
--|--
|
send LSAs.|send LSAs.
#### \(OSPFv2\) Link-State Advertisements
\(OSPFv2\) Link-State Advertisements   
__|__
--|--
|
Many people tend to get a little intimidated by OSPF LSAs when first learning about them.|Many people tend to get a little intimidated by OSPF LSAs when first learning about them.
|
Commands that list a summary of the LSDB’s contents, like the show ip ospf database command, actually list a lot of information.|Commands that list a summary of the LSDB’s contents, like the show ip ospf database command, actually list a lot of information.
Commands that list the details of the LSDB can list overwhelming amounts of information, and those details appear to be in some kind of code, using lots of numbers.|Commands that list the details of the LSDB can list overwhelming amounts of information, and those details appear to be in some kind of code, using lots of numbers.
It can seem like a bit of a mess.|It can seem like a bit of a mess.
|
However, if you examine LSAs while thinking about OSPF areas and area design, some of the most common LSA types will make a lot more sense.|However, if you examine LSAs while thinking about OSPF areas and area design, some of the most common LSA types will make a lot more sense.
For instance, think about the LSDB in one area.|For instance, think about the LSDB in one area.
The topology in one area includes routers and the links between the routers.|The topology in one area includes routers and the links between the routers.
|
As it turns out, OSPF defines the first two types of LSAs to define those exact details, as follows:|As it turns out, OSPF defines the first two types of LSAs to define those exact details, as follows:
###### One router LSA for each router in the area
One router LSA for each router in the area   
###### One network LSA for each network that has a DR plus one neighbor of the DR
One network LSA for each network that has a DR plus one neighbor of the DR   
__|__
--|--
|
Next, think about the subnets in the other areas.|Next, think about the subnets in the other areas.
The ABR creates summary information about each subnet in one area to advertise into other areas—basically just the subnet IDs and masks—as a third type of LSA:|The ABR creates summary information about each subnet in one area to advertise into other areas—basically just the subnet IDs and masks—as a third type of LSA:
###### One summary LSA for each subnet ID that exists in a different area
One summary LSA for each subnet ID that exists in a different area   
__|__
--|--
|
The next few pages discuss these three LSA types in a little more detail; Table 19-8 lists some information about all three for easier reference and study.|The next few pages discuss these three LSA types in a little more detail; Table 19-8 lists some information about all three for easier reference and study.
|
Table 19-8 The Three OSPFv2 LSA Types Seen with a Multiarea OSPF Design Table end.|Table 19-8 The Three OSPFv2 LSA Types Seen with a Multiarea OSPF Design Table end.
##### Router LSAs Build Most of the Intra-Area Topology
Router LSAs Build Most of the Intra-Area Topology   
__|__
--|--
|
OSPF needs very detailed topology information inside each area.|OSPF needs very detailed topology information inside each area.
The routers inside area X need to know all the details about the topology inside area X.|The routers inside area X need to know all the details about the topology inside area X.
And the mechanism to give routers all these details is for the routers to create and flood router (Type 1) and network (Type 2) LSAs about the routers and links in the area.|And the mechanism to give routers all these details is for the routers to create and flood router (Type 1) and network (Type 2) LSAs about the routers and links in the area.
|
Router LSAs, also known as Type 1 LSAs, describe the router in detail.|Router LSAs, also known as Type 1 LSAs, describe the router in detail.
Each lists a router’s RID, its interfaces, its IPv4 addresses and masks, its interface state, and notes about what neighbors the router knows about via each of its interfaces.|Each lists a router’s RID, its interfaces, its IPv4 addresses and masks, its interface state, and notes about what neighbors the router knows about via each of its interfaces.
|
To see a specific instance, first review Figure 19-15.|To see a specific instance, first review Figure 19-15.
It lists internetwork topology, with subnets listed.|It lists internetwork topology, with subnets listed.
Because it’s a small internetwork, the engineer chose a single-area design, with all interfaces in backbone area 0.|Because it’s a small internetwork, the engineer chose a single-area design, with all interfaces in backbone area 0.
|
With the single-area design planned for this small internetwork, the LSDB will contain four router LSAs. Each router creates a router LSA for itself, with its own RID as the LSA identifier.|With the single-area design planned for this small internetwork, the LSDB will contain four router LSAs. Each router creates a router LSA for itself, with its own RID as the LSA identifier.
|
The LSA lists that router’s own interfaces, IP address/mask, with pointers to neighbors.|The LSA lists that router’s own interfaces, IP address/mask, with pointers to neighbors.
|
Figure 19-15 Enterprise Network with Seven IPv4 Subnets Once all four routers have copies of all four router LSAs, SPF can mathematically analyze the LSAs to create a model.|Figure 19-15 Enterprise Network with Seven IPv4 Subnets Once all four routers have copies of all four router LSAs, SPF can mathematically analyze the LSAs to create a model.
The model looks a lot like the concept drawing in Figure 19-16.|The model looks a lot like the concept drawing in Figure 19-16.
|
Note that the drawing shows each router with an obvious RID value.|Note that the drawing shows each router with an obvious RID value.
Each router has pointers that represent each of its interfaces, and because the LSAs identify neighbors, SPF can figure out which interfaces connect to which other routers.|Each router has pointers that represent each of its interfaces, and because the LSAs identify neighbors, SPF can figure out which interfaces connect to which other routers.
|
Figure 19-16 Type 1 LSAs, Assuming a Single-Area Design|Figure 19-16 Type 1 LSAs, Assuming a Single-Area Design
##### Network LSAs Complete the Intra-Area Topology
Network LSAs Complete the Intra-Area Topology   
__|__
--|--
|
Whereas router LSAs define most of the intra-area topology, network LSAs define the rest.|Whereas router LSAs define most of the intra-area topology, network LSAs define the rest.
|
As it turns out, when OSPF elects a DR on some subnet and that DR has at least one neighbor, OSPF treats that subnet as another node in its mathematical model of the network.|As it turns out, when OSPF elects a DR on some subnet and that DR has at least one neighbor, OSPF treats that subnet as another node in its mathematical model of the network.
To represent that network, the DR creates and floods a network (Type 2) LSA for that network (subnet).|To represent that network, the DR creates and floods a network (Type 2) LSA for that network (subnet).
|
For instance, back in Figure 19-15, one Ethernet LAN and two Ethernet WANs exist.|For instance, back in Figure 19-15, one Ethernet LAN and two Ethernet WANs exist.
The Ethernet LAN between R2 and R3 will elect a DR, and the two routers will become neighbors;|The Ethernet LAN between R2 and R3 will elect a DR, and the two routers will become neighbors;
|
so, whichever router is the DR will create a network LSA. Similarly, R1 and R2 connect with an Ethernet WAN, so the DR on that link will create a network LSA. Likewise, the DR on the Ethernet WAN link between R1 and R3 will also create a network LSA.|so, whichever router is the DR will create a network LSA. Similarly, R1 and R2 connect with an Ethernet WAN, so the DR on that link will create a network LSA. Likewise, the DR on the Ethernet WAN link between R1 and R3 will also create a network LSA.
|
Figure 19-17 shows the completed version of the intra-area LSAs in area 0 with this design.|Figure 19-17 shows the completed version of the intra-area LSAs in area 0 with this design.
|
Note that the router LSAs actually point to the network LSAs when they exist, which lets the SPF processes connect the pieces together.|Note that the router LSAs actually point to the network LSAs when they exist, which lets the SPF processes connect the pieces together.
|
Figure 19-17 Type 1 and Type 2 LSAs in Area 0, Assuming a Single-Area Design Finally, note that in this single-area design example no summary (Type 3) LSAs exist at all.|Figure 19-17 Type 1 and Type 2 LSAs in Area 0, Assuming a Single-Area Design Finally, note that in this single-area design example no summary (Type 3) LSAs exist at all.
|
These LSAs represent subnets in other areas, and there are no other areas.|These LSAs represent subnets in other areas, and there are no other areas.
Given that the CCNA 200-301 exam topics refer specifically to single-area OSPF designs, this section stops at showing the details of the intra-area LSAs (Types 1 and 2).|Given that the CCNA 200-301 exam topics refer specifically to single-area OSPF designs, this section stops at showing the details of the intra-area LSAs (Types 1 and 2).
### Chapter Review
Chapter Review   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|One key to doing well on the exams is to perform repetitive spaced review sessions.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.
Refer to the “Your Study Plan” element for more details.|Refer to the “Your Study Plan” element for more details.
Table 19-9 outlines the key review elements and where you can find them.|Table 19-9 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 19-9 Chapter Review Tracking Table end.|Table 19-9 Chapter Review Tracking Table end.
|
Review All the Key Topics Key Terms You Should Know convergence, Shortest Path First (SPF) algorithm, distance vector, Interior Gateway Protocol (IGP), link-state, link-state advertisement (LSA), link-state database (LSDB), metric, 2-way state, full state, Area Border Router (ABR), designated router (DR), backup designated router (BDR), fully adjacent, Hello Interval, Dead Interval, link-state update, neighbor, router ID (RID), topology database, internal router, backbone area|Review All the Key Topics Key Terms You Should Know convergence, Shortest Path First (SPF) algorithm, distance vector, Interior Gateway Protocol (IGP), link-state, link-state advertisement (LSA), link-state database (LSDB), metric, 2-way state, full state, Area Border Router (ABR), designated router (DR), backup designated router (BDR), fully adjacent, Hello Interval, Dead Interval, link-state update, neighbor, router ID (RID), topology database, internal router, backbone area
### Chapter 20 Implementing OSPF
Chapter 20 Implementing OSPF   
__|__
--|--
|
This chapter covers the following exam topics:|This chapter covers the following exam topics:
###### 3.0 IP Connectivity
3.0 IP Connectivity   
###### 3.2 Determine how a router makes a forwarding decision by default
3.2 Determine how a router makes a forwarding decision by default   
###### 3.2.b Administrative distance
3.2.b Administrative distance   
###### 3.2.c Routing protocol metric
3.2.c Routing protocol metric   
###### 3.4 Configure and verify single area OSPFv2
3.4 Configure and verify single area OSPFv2   
###### 3.4.a Neighbor adjacencies
3.4.a Neighbor adjacencies   
###### 3.4.b Point-to-point
3.4.b Point-to-point   
###### 3.4.c Broadcast (DR/BR selection)
3.4.c Broadcast (DR/BR selection)   
###### 3.4.d Router ID
3.4.d Router ID   
__|__
--|--
|
OSPFv2 requires only a few configuration commands if you rely on default settings.|OSPFv2 requires only a few configuration commands if you rely on default settings.
To use OSPF, all you need to do is enable OSPF on each interface you intend to use in the network, and OSPF uses messages to discover neighbors and learn routes through those neighbors.|To use OSPF, all you need to do is enable OSPF on each interface you intend to use in the network, and OSPF uses messages to discover neighbors and learn routes through those neighbors.
|
However, the complexity of OSPFv2 results in a large number of show commands, many of which reveal those default settings.|However, the complexity of OSPFv2 results in a large number of show commands, many of which reveal those default settings.
So while you can make OSPFv2 work in a lab with all default settings, to become comfortable working with it, you need to know the most common optional features as well.|So while you can make OSPFv2 work in a lab with all default settings, to become comfortable working with it, you need to know the most common optional features as well.
This chapter begins that process.|This chapter begins that process.
|
The first major section of this chapter focuses on traditional OSPFv2 configuration using the network command, along with the large variety of associated show commands.|The first major section of this chapter focuses on traditional OSPFv2 configuration using the network command, along with the large variety of associated show commands.
This section teaches you how to make OSPFv2 operate with default settings and convince yourself that it really is working through use of those show commands.|This section teaches you how to make OSPFv2 operate with default settings and convince yourself that it really is working through use of those show commands.
|
The second major section shows an alternative configuration option called OSPF interface mode, in contrast with the traditional OSPF configuration shown in the first section of the chapter.|The second major section shows an alternative configuration option called OSPF interface mode, in contrast with the traditional OSPF configuration shown in the first section of the chapter.
This mode uses the ip ospf process-id area area-number configuration command instead of the network command.|This mode uses the ip ospf process-id area area-number configuration command instead of the network command.
|
The final section then moves on to discuss a variety of optional but popular configuration topics.|The final section then moves on to discuss a variety of optional but popular configuration topics.
The features include topics such as how to use passive interfaces, how to change OSPF costs (which influences the routes OSPF chooses), and how to create a default route advertised by OSPF.|The features include topics such as how to use passive interfaces, how to change OSPF costs (which influences the routes OSPF chooses), and how to create a default route advertised by OSPF.
|
CHAPTER 20|CHAPTER 20
### “Do I Know This Already?” Quiz
“Do I Know This Already?” Quiz   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.
The letter answers are listed at the bottom of the page following the quiz.|The letter answers are listed at the bottom of the page following the quiz.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.
You can also find both answers and explanations in the PTP testing software.|You can also find both answers and explanations in the PTP testing software.
|
Table 20-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Table 20-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping
### Foundation Topics
Foundation Topics   
#### Implementing Single-Area OSPFv2
Implementing Single-Area OSPFv2   
__|__
--|--
|
OSPFv2 Interface Configuration 4 Additional OSPFv2 Features 5, 6 1.|OSPFv2 Interface Configuration 4 Additional OSPFv2 Features 5, 6 1.
Which of the following network commands, following the command router ospf 1, tells this router to start using OSPF on interfaces whose IP addresses are 10.1.1.1,|Which of the following network commands, following the command router ospf 1, tells this router to start using OSPF on interfaces whose IP addresses are 10.1.1.1,
###### 10.1.100.1, and 10.1.120.1?
10.1.100.1, and 10.1.120.1?   
__|__
--|--
|
a. network 10.0.0.0 255.0.0.0 area 0 b. network 10.0.0.0 0.255.255.255 area 0 c. network 10.0.0.1 0.0.0.255 area 0 d. network 10.0.0.1 0.0.255.255 area 0 2.|a. network 10.0.0.0 255.0.0.0 area 0 b. network 10.0.0.0 0.255.255.255 area 0 c. network 10.0.0.1 0.0.0.255 area 0 d. network 10.0.0.1 0.0.255.255 area 0 2.
Which of the following network commands, following the command router ospf 1, tells this router to start using OSPF on interfaces whose IP addresses are 10.1.1.1,|Which of the following network commands, following the command router ospf 1, tells this router to start using OSPF on interfaces whose IP addresses are 10.1.1.1,
###### 10.1.100.1, and 10.1.120.1?
10.1.100.1, and 10.1.120.1?   
__|__
--|--
|
a. network 10.1.0.0 0.0.255.255 area 0 b. network 10.0.0.0 0.255.255.0 area 0 c. network 10.1.1.0 0.x.1x.0 area 0 d. network 10.1.1.0 255.0.0.0 area 0 e. network 10.0.0.0 255.0.0.0 area 0 3.|a. network 10.1.0.0 0.0.255.255 area 0 b. network 10.0.0.0 0.255.255.0 area 0 c. network 10.1.1.0 0.x.1x.0 area 0 d. network 10.1.1.0 255.0.0.0 area 0 e. network 10.0.0.0 255.0.0.0 area 0 3.
Which of the following commands list the OSPF neighbors off interface serial 0/0?|Which of the following commands list the OSPF neighbors off interface serial 0/0?
|
(Choose two answers.)|(Choose two answers.)
|
a. show ip ospf neighbor b. show ip ospf interface brief c. show ip neighbor d. show ip interface e. show ip ospf neighbor serial 0/0 4.|a. show ip ospf neighbor b. show ip ospf interface brief c. show ip neighbor d. show ip interface e. show ip ospf neighbor serial 0/0 4.
An engineer migrates from a more traditional OSPFv2 configuration that uses network commands in OSPF configuration mode to instead use OSPFv2 interface configuration.|An engineer migrates from a more traditional OSPFv2 configuration that uses network commands in OSPF configuration mode to instead use OSPFv2 interface configuration.
|
Which of the following commands configures the area number assigned to an interface in this new configuration?|Which of the following commands configures the area number assigned to an interface in this new configuration?
|
a. The area command in interface configuration mode b.|a. The area command in interface configuration mode b.
The ip ospf command in interface configuration mode c.|The ip ospf command in interface configuration mode c.
The router ospf command in interface configuration mode d.|The router ospf command in interface configuration mode d.
The network command in interface configuration mode 5.|The network command in interface configuration mode 5.
Which of the following configuration settings on a router does not influence which IPv4 route a router chooses to add to its IPv4 routing table when using OSPFv2?|Which of the following configuration settings on a router does not influence which IPv4 route a router chooses to add to its IPv4 routing table when using OSPFv2?
|
a. auto-cost reference-bandwidth b. delay c. bandwidth d. ip ospf cost 6.|a. auto-cost reference-bandwidth b. delay c. bandwidth d. ip ospf cost 6.
OSPF interface configuration uses the ip ospf process-id area area-number configuration command.|OSPF interface configuration uses the ip ospf process-id area area-number configuration command.
In which modes do you configure the following settings when using this command?|In which modes do you configure the following settings when using this command?
|
a. The router ID is configured explicitly in router mode.|a. The router ID is configured explicitly in router mode.
|
b. The router ID is configured explicitly in interface mode.|b. The router ID is configured explicitly in interface mode.
|
c. An interface’s area number is configured in router mode.|c. An interface’s area number is configured in router mode.
|
d. An interface’s area number is configured in interface mode.|d. An interface’s area number is configured in interface mode.
|
Foundation Topics Implementing Single-Area OSPFv2 After an OSPF design has been chosen—a task that can be complex in larger IP internetworks—|Foundation Topics Implementing Single-Area OSPFv2 After an OSPF design has been chosen—a task that can be complex in larger IP internetworks—
|
the configuration can be as simple as enabling OSPF on each router interface and placing that interface in the correct OSPF area.|the configuration can be as simple as enabling OSPF on each router interface and placing that interface in the correct OSPF area.
This first major section of the chapter focuses on the required configuration using the traditional OSPFv2 network command along with one optional configuration setting: how to set the OSPF router-id.|This first major section of the chapter focuses on the required configuration using the traditional OSPFv2 network command along with one optional configuration setting: how to set the OSPF router-id.
Additionally, this section works through how to show the various lists and tables that confirm how OSPF is working.|Additionally, this section works through how to show the various lists and tables that confirm how OSPF is working.
|
For reference and study, the following list outlines the configuration steps covered in this first major section of the chapter:|For reference and study, the following list outlines the configuration steps covered in this first major section of the chapter:
|
Step 1.|Step 1.
Use the router ospf process-id global command to enter OSPF configuration mode for a particular OSPF process.|Use the router ospf process-id global command to enter OSPF configuration mode for a particular OSPF process.
|
Step 2. (Optional) Configure the OSPF router ID by doing the following:|Step 2. (Optional) Configure the OSPF router ID by doing the following:
|
A. Use the router-id id-value router subcommand to define the router ID, or B.|A. Use the router-id id-value router subcommand to define the router ID, or B.
Use the interface loopback number global command, along with an ip address address mask command, to configure an IP address on a loopback interface (chooses the highest IP address of all working loopbacks), or Config Checklist C.|Use the interface loopback number global command, along with an ip address address mask command, to configure an IP address on a loopback interface (chooses the highest IP address of all working loopbacks), or Config Checklist C.
Rely on an interface IP address (chooses the highest IP address of all working nonloopbacks).|Rely on an interface IP address (chooses the highest IP address of all working nonloopbacks).
|
Step 3.|Step 3.
Use one or more network ip-address wildcard-mask area area-id router subcommands to enable OSPFv2 on any interfaces matched by the configured address and mask, enabling OSPF on the interface for the listed area.|Use one or more network ip-address wildcard-mask area area-id router subcommands to enable OSPFv2 on any interfaces matched by the configured address and mask, enabling OSPF on the interface for the listed area.
|
Figure 20-1 shows the relationship between the OSPF configuration commands, with the idea that the configuration creates a routing process in one part of the configuration, and then indirectly enables OSPF on each interface.|Figure 20-1 shows the relationship between the OSPF configuration commands, with the idea that the configuration creates a routing process in one part of the configuration, and then indirectly enables OSPF on each interface.
The configuration does not name the interfaces on which OSPF is enabled, instead requiring IOS to apply some logic by comparing the OSPF network command to the interface ip address commands.|The configuration does not name the interfaces on which OSPF is enabled, instead requiring IOS to apply some logic by comparing the OSPF network command to the interface ip address commands.
The upcoming example discusses more about this logic.|The upcoming example discusses more about this logic.
|
Figure 20-1 Organization of OSPFv2 Configuration with the network Command|Figure 20-1 Organization of OSPFv2 Configuration with the network Command
#### OSPF Single-Area Configuration
OSPF Single-Area Configuration   
__|__
--|--
|
Figure 20-2 shows a sample network that will be used for most examples throughout this chapter.|Figure 20-2 shows a sample network that will be used for most examples throughout this chapter.
All links reside in area 0, making the area design a single-area design, with four routers.|All links reside in area 0, making the area design a single-area design, with four routers.
|
You can think of Router R1 as a router at a central site, with WAN links to each remote site, and using router-on-a-stick (ROAS) to connect to two LAN subnets on the left.|You can think of Router R1 as a router at a central site, with WAN links to each remote site, and using router-on-a-stick (ROAS) to connect to two LAN subnets on the left.
Routers R2 and R3 might be at one large remote site that needs two WAN links and two routers for WAN redundancy, with both routers connected to the LAN at that remote site.|Routers R2 and R3 might be at one large remote site that needs two WAN links and two routers for WAN redundancy, with both routers connected to the LAN at that remote site.
Router R4 might be a typical smaller remote site with a single router needed for that site.|Router R4 might be a typical smaller remote site with a single router needed for that site.
|
NOTE The interface numbering on Router R1, with interfaces G0/0 and G0/0/0, may seem a bit strange.|NOTE The interface numbering on Router R1, with interfaces G0/0 and G0/0/0, may seem a bit strange.
However, real routers, like the Cisco 2901 used in the example, use this numbering.|However, real routers, like the Cisco 2901 used in the example, use this numbering.
|
That model includes a built-in Gi0/0 and Gi0/1 port.|That model includes a built-in Gi0/0 and Gi0/1 port.
Additionally, if you add one-port Gigabit WAN Interface Cards (WICs), the router numbers them G0/0/0, G0/1/0, and so on.|Additionally, if you add one-port Gigabit WAN Interface Cards (WICs), the router numbers them G0/0/0, G0/1/0, and so on.
|
This is just one example of how router hardware may use two-digit interface numbering, or three-digit, or both.|This is just one example of how router hardware may use two-digit interface numbering, or three-digit, or both.
|
Figure 20-2 Sample Network for OSPF Single-Area Configuration Example 20-1 shows the IPv4 addressing configuration on Router R1, before getting into the OSPF detail.|Figure 20-2 Sample Network for OSPF Single-Area Configuration Example 20-1 shows the IPv4 addressing configuration on Router R1, before getting into the OSPF detail.
Note that R1 enables 802.1Q trunking (ROAS) on its G0/0 interface and assigns an IP address to each subinterface.|Note that R1 enables 802.1Q trunking (ROAS) on its G0/0 interface and assigns an IP address to each subinterface.
|
Example 20-1 IPv4 Address Configuration on R1 (Including VLAN Trunking)|Example 20-1 IPv4 Address Configuration on R1 (Including VLAN Trunking)
|
Example end.|Example end.
|
The OSPF configuration begins with the router ospf process-id global command, which puts the user in OSPF configuration mode, and sets the OSPF process-id value.|The OSPF configuration begins with the router ospf process-id global command, which puts the user in OSPF configuration mode, and sets the OSPF process-id value.
The process-id number just needs to be unique on the local router, allowing the router to support multiple OSPF processes in a single router by using different process IDs. (The Answers to the “Do I Know This Already?” quiz:|The process-id number just needs to be unique on the local router, allowing the router to support multiple OSPF processes in a single router by using different process IDs. (The Answers to the “Do I Know This Already?” quiz:
|
1 B 2 A 3 A, E 4 B 5 B 6 A, D router command uses the process-id to distinguish between the processes.) The process-id does not have to match on each router, and it can be any integer between 1 and 65,535.|1 B 2 A 3 A, E 4 B 5 B 6 A, D router command uses the process-id to distinguish between the processes.) The process-id does not have to match on each router, and it can be any integer between 1 and 65,535.
|
Second, the configuration needs one or more network commands in OSPF mode.|Second, the configuration needs one or more network commands in OSPF mode.
These commands tell the router to find its local interfaces that match the first two parameters on the network command.|These commands tell the router to find its local interfaces that match the first two parameters on the network command.
Then, for each matched interface, the router enables OSPF on those interfaces, discovers neighbors, creates neighbor relationships, and assigns the interface to the area listed in the network command. (Note that the area can be configured as either an integer or a dotted-decimal number, but this book makes a habit of configuring the area number as an integer.|Then, for each matched interface, the router enables OSPF on those interfaces, discovers neighbors, creates neighbor relationships, and assigns the interface to the area listed in the network command. (Note that the area can be configured as either an integer or a dotted-decimal number, but this book makes a habit of configuring the area number as an integer.
The integer area numbers range from 0 through 4,294,967,295.)|The integer area numbers range from 0 through 4,294,967,295.)
|
Example 20-2 shows an example configuration on router R2 from Figure 20-2.|Example 20-2 shows an example configuration on router R2 from Figure 20-2.
The router ospf 1 command enables OSPF process 1, and the single network command enables OSPF on all interfaces shown in the figure.|The router ospf 1 command enables OSPF process 1, and the single network command enables OSPF on all interfaces shown in the figure.
|
Example 20-2 OSPF Single-Area Configuration on R2 Using One network Command Example end.|Example 20-2 OSPF Single-Area Configuration on R2 Using One network Command Example end.
|
For the specific network command in Example 20-2, any matched interfaces are assigned to area 0.|For the specific network command in Example 20-2, any matched interfaces are assigned to area 0.
However, the first two parameters—the ip_address and wildcard_mask parameter values of 10.0.0.0 and 0.255.255.255—need some explaining.|However, the first two parameters—the ip_address and wildcard_mask parameter values of 10.0.0.0 and 0.255.255.255—need some explaining.
In this case, the command matches both interfaces shown for Router R2; the next topic explains why.|In this case, the command matches both interfaces shown for Router R2; the next topic explains why.
#### Wildcard Matching with the network Command
Wildcard Matching with the network Command   
__|__
--|--
|
The key to understanding the traditional OSPFv2 configuration shown in this first example is to understand the OSPF network command.|The key to understanding the traditional OSPFv2 configuration shown in this first example is to understand the OSPF network command.
The OSPF network command compares the first parameter in the command to each interface IP address on the local router, trying to find a match.|The OSPF network command compares the first parameter in the command to each interface IP address on the local router, trying to find a match.
However, rather than comparing the entire number in the network command to the entire IPv4 address on the interface, the router can compare a subset of the octets, based on the wildcard mask, as follows:|However, rather than comparing the entire number in the network command to the entire IPv4 address on the interface, the router can compare a subset of the octets, based on the wildcard mask, as follows:
|
Wildcard 0.0.0.0: Compare all four octets.|Wildcard 0.0.0.0: Compare all four octets.
In other words, the numbers must exactly match.|In other words, the numbers must exactly match.
|
Wildcard 0.0.0.255: Compare the first three octets only.|Wildcard 0.0.0.255: Compare the first three octets only.
Ignore the last octet when comparing the numbers.|Ignore the last octet when comparing the numbers.
|
Wildcard 0.0.255.255: Compare the first two octets only.|Wildcard 0.0.255.255: Compare the first two octets only.
Ignore the last two octets when comparing the numbers.|Ignore the last two octets when comparing the numbers.
|
Wildcard 0.255.255.255: Compare the first octet only.|Wildcard 0.255.255.255: Compare the first octet only.
Ignore the last three octets when comparing the numbers.|Ignore the last three octets when comparing the numbers.
|
Wildcard 255.255.255.255: Compare nothing; this wildcard mask means that all addresses will match the network command.|Wildcard 255.255.255.255: Compare nothing; this wildcard mask means that all addresses will match the network command.
|
Basically, a wildcard mask value of decimal 0 in an octet tells IOS to compare to see if the numbers match, and a value of 255 tells IOS to ignore that octet when comparing the numbers.|Basically, a wildcard mask value of decimal 0 in an octet tells IOS to compare to see if the numbers match, and a value of 255 tells IOS to ignore that octet when comparing the numbers.
|
The network command provides many flexible options because of the wildcard mask.|The network command provides many flexible options because of the wildcard mask.
|
For example, in Router R1, many network commands could be used, with some matching all interfaces, and some matching a subset of interfaces.|For example, in Router R1, many network commands could be used, with some matching all interfaces, and some matching a subset of interfaces.
Table 20-2 shows a sampling of options, with notes.|Table 20-2 shows a sampling of options, with notes.
|
Table 20-2 Example OSPF network Commands on R3, with Expected Results Table end.|Table 20-2 Example OSPF network Commands on R3, with Expected Results Table end.
|
The wildcard mask gives the local router its rules for matching its own interfaces.|The wildcard mask gives the local router its rules for matching its own interfaces.
To show examples of the different options, Example 20-3 shows the configuration on routers R2, R3, and R4, each using different wildcard masks.|To show examples of the different options, Example 20-3 shows the configuration on routers R2, R3, and R4, each using different wildcard masks.
Note that all three routers (R2, R3, and R4)|Note that all three routers (R2, R3, and R4)
|
enable OSPF on all the interfaces shown in Figure 20-2.|enable OSPF on all the interfaces shown in Figure 20-2.
|
Example 20-3 OSPF Configuration on Routers R2, R3, and R4 Example end.|Example 20-3 OSPF Configuration on Routers R2, R3, and R4 Example end.
|
Finally, note that OSPF uses the same wildcard mask logic as defined by Cisco IOS access control lists.|Finally, note that OSPF uses the same wildcard mask logic as defined by Cisco IOS access control lists.
The section titled “Finding the Right Wildcard Mask to Match a Subnet” section detail about wildcard masks.|The section titled “Finding the Right Wildcard Mask to Match a Subnet” section detail about wildcard masks.
|
NOTE IOS will change a network command if it does not follow a particular rule: by convention, if the wildcard mask octet is 255, the matching address octet should be configured as a 0.|NOTE IOS will change a network command if it does not follow a particular rule: by convention, if the wildcard mask octet is 255, the matching address octet should be configured as a 0.
Interestingly, IOS will actually accept a network command that breaks this rule, but then IOS will change that octet of the address to a 0 before putting it into the running configuration file.|Interestingly, IOS will actually accept a network command that breaks this rule, but then IOS will change that octet of the address to a 0 before putting it into the running configuration file.
For example, IOS will change a typed command that begins with network|For example, IOS will change a typed command that begins with network
###### 1.2.3.4 0.0.255.255 to network 1.2.0.0 0.0.255.255.
1.2.3.4 0.0.255.255 to network 1.2.0.0 0.0.255.255.   
#### Verifying OSPF Operation
Verifying OSPF Operation   
__|__
--|--
|
As mentioned in Chapter 19, “Understanding OSPF Concepts,” OSPF routers use a threestep process to eventually add OSPF-learned routes to the IP routing table.|As mentioned in Chapter 19, “Understanding OSPF Concepts,” OSPF routers use a threestep process to eventually add OSPF-learned routes to the IP routing table.
First, they create neighbor relationships.|First, they create neighbor relationships.
Then they build and flood LSAs between those neighbors so each router in the same area has a copy of the same LSDB. Finally, each router independently computes its own IP routes using the SPF algorithm and adds them to its routing table.|Then they build and flood LSAs between those neighbors so each router in the same area has a copy of the same LSDB. Finally, each router independently computes its own IP routes using the SPF algorithm and adds them to its routing table.
This next topic works through how to display the results of each of those steps, which lets you confirm whether OSPF has worked correctly or not.|This next topic works through how to display the results of each of those steps, which lets you confirm whether OSPF has worked correctly or not.
|
The show ip ospf neighbor, show ip ospf database, and show ip route commands display information to match each of these three steps, respectively.|The show ip ospf neighbor, show ip ospf database, and show ip route commands display information to match each of these three steps, respectively.
Figure 20-3 summarizes the commands you can use (and others) when verifying OSPF.|Figure 20-3 summarizes the commands you can use (and others) when verifying OSPF.
|
Many engineers begin OSPF verification by looking at the output of the show ip ospf neighbor command.|Many engineers begin OSPF verification by looking at the output of the show ip ospf neighbor command.
For instance, Example 20-4 shows a sample from Router R1, which should have one neighbor relationship each with routers R2, R3, and R4. Example 20-4 shows all three.|For instance, Example 20-4 shows a sample from Router R1, which should have one neighbor relationship each with routers R2, R3, and R4. Example 20-4 shows all three.
|
Figure 20-3 OSPF Verification Commands Example 20-4 OSPF Neighbors on Router R1 from Figure 20-2 Example end.|Figure 20-3 OSPF Verification Commands Example 20-4 OSPF Neighbors on Router R1 from Figure 20-2 Example end.
|
The detail in the output mentions several important facts, and for most people, working right to left works best in this case.|The detail in the output mentions several important facts, and for most people, working right to left works best in this case.
For example, look at the headings:|For example, look at the headings:
|
Interface: This is the local router’s interface connected to the neighbor.|Interface: This is the local router’s interface connected to the neighbor.
For example, the first neighbor in the list is reachable through R1’s G0/0/0 interface.|For example, the first neighbor in the list is reachable through R1’s G0/0/0 interface.
|
Address: This is the neighbor’s IP address on that link.|Address: This is the neighbor’s IP address on that link.
Again, for this first neighbor, which is R1, uses IP address 10.1.13.1.|Again, for this first neighbor, which is R1, uses IP address 10.1.13.1.
|
State: While many possible states exist, for the details discussed in this chapter, FULL is the correct and fully working state in this case.|State: While many possible states exist, for the details discussed in this chapter, FULL is the correct and fully working state in this case.
|
Neighbor ID: This is the router ID of the neighbor.|Neighbor ID: This is the router ID of the neighbor.
|
Once OSPF convergence has completed, a router should list each neighbor.|Once OSPF convergence has completed, a router should list each neighbor.
On links that use a designated router (DR), the state will also list the role of the neighboring router after the /|On links that use a designated router (DR), the state will also list the role of the neighboring router after the /
|
(DR, BDR, or DROTHER. As a result, the normal working states will be:|(DR, BDR, or DROTHER. As a result, the normal working states will be:
|
FULL/ -: The neighbor state is full, with the “-“ instead of letters meaning that the link does not use a DR/BDR.|FULL/ -: The neighbor state is full, with the “-“ instead of letters meaning that the link does not use a DR/BDR.
|
FULL/DR: The neighbor state is full, and the neighbor is the DR.|FULL/DR: The neighbor state is full, and the neighbor is the DR.
|
FULL/BDR: The neighbor state is full, and the neighbor is the backup DR (BDR).|FULL/BDR: The neighbor state is full, and the neighbor is the backup DR (BDR).
|
FULL/DROTHER: The neighbor state is full, and the neighbor is neither the DR nor BDR.|FULL/DROTHER: The neighbor state is full, and the neighbor is neither the DR nor BDR.
|
(It also implies that the local router is a DR or BDR because the state is FULL.)|(It also implies that the local router is a DR or BDR because the state is FULL.)
|
2WAY/DROTHER: The neighbor state is 2-way, and the neighbor is neither the DR nor BDR—that is, a DROther router. (It also implies that the local router is also a DROther router because otherwise the state would reach a full state.)|2WAY/DROTHER: The neighbor state is 2-way, and the neighbor is neither the DR nor BDR—that is, a DROther router. (It also implies that the local router is also a DROther router because otherwise the state would reach a full state.)
|
Once a router’s OSPF process forms a working neighbor relationship, the routers exchange the contents of their LSDBs, either directly or through the DR on the subnet.|Once a router’s OSPF process forms a working neighbor relationship, the routers exchange the contents of their LSDBs, either directly or through the DR on the subnet.
Example 20-5 shows the contents of the LSDB on Router R1. Interestingly, with a single-area design, all the routers will have the same LSDB contents once all neighbors are up and all LSAs have been exchanged.|Example 20-5 shows the contents of the LSDB on Router R1. Interestingly, with a single-area design, all the routers will have the same LSDB contents once all neighbors are up and all LSAs have been exchanged.
So, the show ip ospf database command in Example 20-5 should list the same exact information, no matter on which of the four routers it is issued.|So, the show ip ospf database command in Example 20-5 should list the same exact information, no matter on which of the four routers it is issued.
|
Example 20-5 OSPF Database on Router R1 from Figure 20-2 Example end.|Example 20-5 OSPF Database on Router R1 from Figure 20-2 Example end.
|
For the purposes of this book, do not be concerned about the specifics in the output of this command.|For the purposes of this book, do not be concerned about the specifics in the output of this command.
However, for perspective, note that the LSDB should list one “Router Link State”|However, for perspective, note that the LSDB should list one “Router Link State”
|
(Type 1 Router LSA) for each of the routers in the same area, so with the design based on Figure 20-2, the output lists four Type 1 LSAs. Also, with all default settings in this design, the routers will create a total of four Type 2 Network LSAs as shown, one each for the subnets that have a DR and contain at least two routers in that subnet.|(Type 1 Router LSA) for each of the routers in the same area, so with the design based on Figure 20-2, the output lists four Type 1 LSAs. Also, with all default settings in this design, the routers will create a total of four Type 2 Network LSAs as shown, one each for the subnets that have a DR and contain at least two routers in that subnet.
|
Next, Example 20-6 shows R4’s IPv4 routing table with the show ip route command.|Next, Example 20-6 shows R4’s IPv4 routing table with the show ip route command.
As configured, with all links working, the design in Figure 20-2 includes seven subnets.|As configured, with all links working, the design in Figure 20-2 includes seven subnets.
R4 has connected routes to two of those subnets and should learn OSPF routes to the other five subnets.|R4 has connected routes to two of those subnets and should learn OSPF routes to the other five subnets.
|
Example 20-6 IPv4 Routes Added by OSPF on Router R1 from Figure 20-2 Example end.|Example 20-6 IPv4 Routes Added by OSPF on Router R1 from Figure 20-2 Example end.
|
Any time you want to check OSPF on a router in a small design like the ones in the book, you can count all the subnets, then count the subnets connected to the local router, and know that OSPF should learn routes to the rest of the subnets.|Any time you want to check OSPF on a router in a small design like the ones in the book, you can count all the subnets, then count the subnets connected to the local router, and know that OSPF should learn routes to the rest of the subnets.
Then just use the show ip route command and add up how many connected and OSPF routes exist as a quick check of whether all the routes have been learned or not.|Then just use the show ip route command and add up how many connected and OSPF routes exist as a quick check of whether all the routes have been learned or not.
|
In this case, router R4 has two connected subnets, but seven subnets exist per the figure, so router R4 should learn five OSPF routes.|In this case, router R4 has two connected subnets, but seven subnets exist per the figure, so router R4 should learn five OSPF routes.
Next look for the code of “O” on the left, which identifies a route as being learned by OSPF. The output lists five such IP routes: two for the LAN subnets off Router R1, one for the LAN subnets connected to both R2 and R3, and one each for the WAN subnets from R1 to R2 and R1 to R3.|Next look for the code of “O” on the left, which identifies a route as being learned by OSPF. The output lists five such IP routes: two for the LAN subnets off Router R1, one for the LAN subnets connected to both R2 and R3, and one each for the WAN subnets from R1 to R2 and R1 to R3.
|
Next, take a look at the first route (to subnet 10.1.1.0/24).|Next, take a look at the first route (to subnet 10.1.1.0/24).
It lists the subnet ID and mask, identifying the subnet.|It lists the subnet ID and mask, identifying the subnet.
It also lists two numbers in brackets.|It also lists two numbers in brackets.
The first, 110, is the administrative distance of the route.|The first, 110, is the administrative distance of the route.
All the OSPF routes in this example use the default of 110 (see Chapter 19’s Table 19-4 for the list of administrative distance values).|All the OSPF routes in this example use the default of 110 (see Chapter 19’s Table 19-4 for the list of administrative distance values).
The second number, 2, is the OSPF metric for this route.|The second number, 2, is the OSPF metric for this route.
The route also lists the forwarding instructions: the nexthop IP address (10.1.14.1) and R4’s outgoing interface (G0/0/0).|The route also lists the forwarding instructions: the nexthop IP address (10.1.14.1) and R4’s outgoing interface (G0/0/0).
#### Verifying OSPF Configuration
Verifying OSPF Configuration   
__|__
--|--
|
Once you can configure OSPF with confidence, you will likely verify OSPF focusing on OSPF neighbors and the IP routing table as just discussed.|Once you can configure OSPF with confidence, you will likely verify OSPF focusing on OSPF neighbors and the IP routing table as just discussed.
However, if OSPF does not work immediately, you may need to circle back and check the configuration.|However, if OSPF does not work immediately, you may need to circle back and check the configuration.
To do so, you can use these steps:|To do so, you can use these steps:
###### If you have enable mode access, use the show running-config command to examine the
If you have enable mode access, use the show running-config command to examine the   
__|__
--|--
|
configuration.|configuration.
###### If you have only user mode access, use the show ip protocols command to re-create the
If you have only user mode access, use the show ip protocols command to re-create the   
__|__
--|--
|
OSPF configuration.|OSPF configuration.
###### Use the show ip ospf interface [brief] command to determine whether the router enabled
Use the show ip ospf interface [brief] command to determine whether the router enabled   
__|__
--|--
|
OSPF on the correct interfaces or not based on the configuration.|OSPF on the correct interfaces or not based on the configuration.
|
NOTE The exam’s Sim and Simlet questions can restrict access to enable mode, so knowing how to extract the configuration from show commands other than show running-config can be particularly helpful for any configuration topic.|NOTE The exam’s Sim and Simlet questions can restrict access to enable mode, so knowing how to extract the configuration from show commands other than show running-config can be particularly helpful for any configuration topic.
|
The best way to verify the configuration begins with the show running-config command, of course.|The best way to verify the configuration begins with the show running-config command, of course.
However, the show ip protocols command repeats the details of the OSPFv2 configuration and does not require enable mode access.|However, the show ip protocols command repeats the details of the OSPFv2 configuration and does not require enable mode access.
To see how, consider Example 20-7, which lists the output of the show ip protocols command on router R3.|To see how, consider Example 20-7, which lists the output of the show ip protocols command on router R3.
|
Example 20-7 Router R3 Configuration and the show ip protocols Command Example end.|Example 20-7 Router R3 Configuration and the show ip protocols Command Example end.
|
The highlighted output emphasizes some of the configuration.|The highlighted output emphasizes some of the configuration.
The first highlighted line repeats the parameters on the router ospf 1 global configuration command. (The second highlighted item points out each router’s router ID, which will be discussed in the next section.)|The first highlighted line repeats the parameters on the router ospf 1 global configuration command. (The second highlighted item points out each router’s router ID, which will be discussed in the next section.)
|
The third set of highlighted lines begins with a heading of “Routing for Networks:”|The third set of highlighted lines begins with a heading of “Routing for Networks:”
|
followed by two lines that closely resemble the parameters on the configured network commands.|followed by two lines that closely resemble the parameters on the configured network commands.
|
In fact, closely compare those last two highlighted lines with the network configuration commands at the top of the example, and you will see that they mirror each other, but the show command just leaves out the word network.|In fact, closely compare those last two highlighted lines with the network configuration commands at the top of the example, and you will see that they mirror each other, but the show command just leaves out the word network.
For instance:|For instance:
|
Configuration: network 10.1.13.3 0.0.0.0 area 0 Show Command: 10.1.13.3 0.0.0.0 area 0 IOS interprets the network commands to choose interfaces on which to run OSPF, so it could be that IOS chooses a different set of interfaces than you predicted.|Configuration: network 10.1.13.3 0.0.0.0 area 0 Show Command: 10.1.13.3 0.0.0.0 area 0 IOS interprets the network commands to choose interfaces on which to run OSPF, so it could be that IOS chooses a different set of interfaces than you predicted.
To check the list of interfaces chosen by IOS, use the show ip ospf interface brief command, which lists all interfaces that have been enabled for OSPF processing.|To check the list of interfaces chosen by IOS, use the show ip ospf interface brief command, which lists all interfaces that have been enabled for OSPF processing.
Verifying the interfaces can be a useful step if you have issues with OSPF neighbors because OSPF must first be enabled on an interface before a router will attempt to discover neighbors on that interface.|Verifying the interfaces can be a useful step if you have issues with OSPF neighbors because OSPF must first be enabled on an interface before a router will attempt to discover neighbors on that interface.
Example 20-8 shows a sample from Router R1.|Example 20-8 shows a sample from Router R1.
|
Example 20-8 Router R1 show ip ospf interface brief Command Example end.|Example 20-8 Router R1 show ip ospf interface brief Command Example end.
|
First, consider the show ip ospf interface brief command shown here.|First, consider the show ip ospf interface brief command shown here.
It lists one line per interface, with the list showing all the interfaces on which OSPF has been enabled.|It lists one line per interface, with the list showing all the interfaces on which OSPF has been enabled.
Each item in the list identifies the OSPF process ID (per the router ospf process-id command), the area, the interface IP address, and the number of neighbors found via each interface.|Each item in the list identifies the OSPF process ID (per the router ospf process-id command), the area, the interface IP address, and the number of neighbors found via each interface.
|
More generally, note that the show ip ospf interface command with the brief keyword at the end lists a single line of output per interface, but the show ip ospf interface command (without the brief keyword) displays about 20 lines of output per interface, with much more information about various OSPF per-interface settings.|More generally, note that the show ip ospf interface command with the brief keyword at the end lists a single line of output per interface, but the show ip ospf interface command (without the brief keyword) displays about 20 lines of output per interface, with much more information about various OSPF per-interface settings.
#### Configuring the OSPF Router ID
Configuring the OSPF Router ID   
__|__
--|--
|
While OSPF has many other optional features, most enterprise networks that use OSPF choose to configure each router’s OSPF router ID. OSPF-speaking routers must have a router ID (RID) for proper operation.|While OSPF has many other optional features, most enterprise networks that use OSPF choose to configure each router’s OSPF router ID. OSPF-speaking routers must have a router ID (RID) for proper operation.
By default, routers will choose an interface IP address to use as the RID. However, many network engineers prefer to choose each router’s router ID, so command output from commands like show ip ospf neighbor lists more recognizable router IDs.|By default, routers will choose an interface IP address to use as the RID. However, many network engineers prefer to choose each router’s router ID, so command output from commands like show ip ospf neighbor lists more recognizable router IDs.
|
To choose its RID, a Cisco router uses the following process when the router reloads and brings up the OSPF process.|To choose its RID, a Cisco router uses the following process when the router reloads and brings up the OSPF process.
Note that the router stops looking for a router ID to use once one of the steps identifies a value to use.|Note that the router stops looking for a router ID to use once one of the steps identifies a value to use.
|
1. If the router-id rid OSPF subcommand is configured, this value is used as the RID.|1. If the router-id rid OSPF subcommand is configured, this value is used as the RID.
|
2. If any loopback interfaces have an IP address configured, and the interface has an interface status of up, the router picks the highest numeric IP address among these loopback interfaces.|2. If any loopback interfaces have an IP address configured, and the interface has an interface status of up, the router picks the highest numeric IP address among these loopback interfaces.
|
3. The router picks the highest numeric IP address from all other interfaces whose interface status code (first status code) is up. (In other words, an interface in up/down state will be included by OSPF when choosing its router ID.)|3. The router picks the highest numeric IP address from all other interfaces whose interface status code (first status code) is up. (In other words, an interface in up/down state will be included by OSPF when choosing its router ID.)
|
The first and third criteria should make some sense right away: the RID is either configured or is taken from a working interface’s IP address.|The first and third criteria should make some sense right away: the RID is either configured or is taken from a working interface’s IP address.
However, this book has not yet explained the concept of a loopback interface, as mentioned in Step 2.|However, this book has not yet explained the concept of a loopback interface, as mentioned in Step 2.
|
A loopback interface is a virtual interface that can be configured with the interface loopback interface-number command, where interface-number is an integer.|A loopback interface is a virtual interface that can be configured with the interface loopback interface-number command, where interface-number is an integer.
Loopback interfaces are always in an “up and up” state unless administratively placed in a shutdown state.|Loopback interfaces are always in an “up and up” state unless administratively placed in a shutdown state.
For example, a simple configuration of the command interface loopback 0, followed by ip address 2.2.2.2 255.255.255.0, would create a loopback interface and assign it an IP address.|For example, a simple configuration of the command interface loopback 0, followed by ip address 2.2.2.2 255.255.255.0, would create a loopback interface and assign it an IP address.
Because loopback interfaces do not rely on any hardware, these interfaces can be up/up whenever IOS is running, making them good interfaces on which to base an OSPF RID.|Because loopback interfaces do not rely on any hardware, these interfaces can be up/up whenever IOS is running, making them good interfaces on which to base an OSPF RID.
|
Example 20-9 shows the configuration that existed in Routers R1 and R2 before the creation of the show command output earlier in this chapter.|Example 20-9 shows the configuration that existed in Routers R1 and R2 before the creation of the show command output earlier in this chapter.
R1 set its router ID using the direct method, while R2 used a loopback IP address.|R1 set its router ID using the direct method, while R2 used a loopback IP address.
|
Example 20-9 OSPF Router ID Configuration Examples Example end.|Example 20-9 OSPF Router ID Configuration Examples Example end.
|
Each router chooses its OSPF RID when OSPF is initialized, which happens when the router boots or when a CLI user stops and restarts the OSPF process (with the clear ip ospf process command).|Each router chooses its OSPF RID when OSPF is initialized, which happens when the router boots or when a CLI user stops and restarts the OSPF process (with the clear ip ospf process command).
So, if OSPF comes up, and later the configuration changes in a way that would impact the OSPF RID, OSPF does not change the RID immediately.|So, if OSPF comes up, and later the configuration changes in a way that would impact the OSPF RID, OSPF does not change the RID immediately.
Instead, IOS waits until the next time the OSPF process is restarted.|Instead, IOS waits until the next time the OSPF process is restarted.
|
Example 20-10 shows the output of the show ip ospf command on R1, which identifies the OSPF RID used by R1.|Example 20-10 shows the output of the show ip ospf command on R1, which identifies the OSPF RID used by R1.
|
Example 20-10 Confirming the Current OSPF Router ID Example end.|Example 20-10 Confirming the Current OSPF Router ID Example end.
#### Implementing Multiarea OSPF
Implementing Multiarea OSPF   
__|__
--|--
|
Even though the current CCNA 200-301 exam blueprint mentions single-area OSPF and does not mention multiarea OSPF, you only need to learn one more idea to know how to configure multiarea OSPF. So, this chapter takes a brief page to show how.|Even though the current CCNA 200-301 exam blueprint mentions single-area OSPF and does not mention multiarea OSPF, you only need to learn one more idea to know how to configure multiarea OSPF. So, this chapter takes a brief page to show how.
|
For example, consider a multiarea OSPF design as shown in Figure 20-4.|For example, consider a multiarea OSPF design as shown in Figure 20-4.
It uses the same routers and IP addresses as shown earlier in Figure 20-2, on which all the examples in this chapter have been based so far.|It uses the same routers and IP addresses as shown earlier in Figure 20-2, on which all the examples in this chapter have been based so far.
However, the design shows three areas instead of the singlearea design shown in Figure 20-2.|However, the design shows three areas instead of the singlearea design shown in Figure 20-2.
|
Figure 20-4 Area Design for an Example Multiarea OSPF Configuration Configuring the routers in a multiarea design is almost like configuring OSPFv2 for a single area.|Figure 20-4 Area Design for an Example Multiarea OSPF Configuration Configuring the routers in a multiarea design is almost like configuring OSPFv2 for a single area.
To configure multiarea OSPF, all you need is a valid OSPF area design (for instance, like Figure 20-4) and a configuration that places each router interface into the correct area per that design.|To configure multiarea OSPF, all you need is a valid OSPF area design (for instance, like Figure 20-4) and a configuration that places each router interface into the correct area per that design.
For example, both of R4’s interfaces connect to links in area 4, making R4 an internal router, so any network commands on router R4 will list area 4.|For example, both of R4’s interfaces connect to links in area 4, making R4 an internal router, so any network commands on router R4 will list area 4.
|
Example 20-11 shows a sample configuration for Router R1. To make the configuration clear, it uses network commands with a wildcard mask of 0.0.0.0, meaning each network command matches a single interface.|Example 20-11 shows a sample configuration for Router R1. To make the configuration clear, it uses network commands with a wildcard mask of 0.0.0.0, meaning each network command matches a single interface.
Each interface will be placed into either area 0, 23, or 4 to match the figure.|Each interface will be placed into either area 0, 23, or 4 to match the figure.
|
Example 20-11 OSPF Configuration on R1, Placing Interfaces into Different Areas Example end.|Example 20-11 OSPF Configuration on R1, Placing Interfaces into Different Areas Example end.
### Using OSPFv2 Interface Subcommands
Using OSPFv2 Interface Subcommands   
__|__
--|--
|
From the earliest days of OSPFv2 support in Cisco routers, the configuration used the OSPF network command as discussed in this chapter.|From the earliest days of OSPFv2 support in Cisco routers, the configuration used the OSPF network command as discussed in this chapter.
However, that configuration style can be confusing, and it does require some interpretation of the network commands and interface IP addresses to decide on which interfaces IOS will enable OSPF. As a result, Cisco added another option for OSPFv2 configuration called OSPF interface configuration.|However, that configuration style can be confusing, and it does require some interpretation of the network commands and interface IP addresses to decide on which interfaces IOS will enable OSPF. As a result, Cisco added another option for OSPFv2 configuration called OSPF interface configuration.
|
The newer interface-style OSPF configuration still enables OSPF on interfaces, but it does so directly with the ip ospf interface subcommand instead of using the network command in router configuration mode.|The newer interface-style OSPF configuration still enables OSPF on interfaces, but it does so directly with the ip ospf interface subcommand instead of using the network command in router configuration mode.
Basically, instead of matching interfaces with indirect logic using network commands, you directly enable OSPFv2 on interfaces by configuring an interface subcommand on each interface.|Basically, instead of matching interfaces with indirect logic using network commands, you directly enable OSPFv2 on interfaces by configuring an interface subcommand on each interface.
#### OSPF Interface Configuration Example
OSPF Interface Configuration Example   
__|__
--|--
|
To show how OSPF interface configuration works, this example basically repeats the example shown earlier in the book using the traditional OSPFv2 configuration with network commands.|To show how OSPF interface configuration works, this example basically repeats the example shown earlier in the book using the traditional OSPFv2 configuration with network commands.
So, before looking at the OSPFv2 interface configuration, take a moment to look back to review traditional OSPFv2 configuration with Figure 20-2 and Examples 20-2 and 20-3.|So, before looking at the OSPFv2 interface configuration, take a moment to look back to review traditional OSPFv2 configuration with Figure 20-2 and Examples 20-2 and 20-3.
|
After reviewing the traditional configuration, consider this checklist, which details how to convert from the old-style configuration in Examples 20-2 and 20-3 to use interface configuration:|After reviewing the traditional configuration, consider this checklist, which details how to convert from the old-style configuration in Examples 20-2 and 20-3 to use interface configuration:
|
Step 1.|Step 1.
Use the no network network-id area area-id subcommands in OSPF configuration mode to remove the network commands.|Use the no network network-id area area-id subcommands in OSPF configuration mode to remove the network commands.
|
Step 2.|Step 2.
Add one ip ospf process-id area area-id command in interface configuration mode under each interface on which OSPF should operate, with the correct OSPF process (process-id) and the correct OSPF area number.|Add one ip ospf process-id area area-id command in interface configuration mode under each interface on which OSPF should operate, with the correct OSPF process (process-id) and the correct OSPF area number.
|
Figure 20-5 repeats the design for both the original examples in this chapter and for this upcoming interface configuration example.|Figure 20-5 repeats the design for both the original examples in this chapter and for this upcoming interface configuration example.
|
Figure 20-5 Area Design Used in the Upcoming OSPF Interface Config Example Example 20-2 shows a single network command: network 10.0.0.0 0.255.255.255 area 0.|Figure 20-5 Area Design Used in the Upcoming OSPF Interface Config Example Example 20-2 shows a single network command: network 10.0.0.0 0.255.255.255 area 0.
|
Example 20-12 follows the steps in the migration checklist, beginning with the removal of the previous configuration using the no network 10.0.0.0 0.255.255.255 area 0 command.|Example 20-12 follows the steps in the migration checklist, beginning with the removal of the previous configuration using the no network 10.0.0.0 0.255.255.255 area 0 command.
|
The example then shows the addition of the ip ospf 1 area 0 command on each of the five interfaces on Router R1, enabling OSPF process 1 on the interface and placing each interface into area 0.|The example then shows the addition of the ip ospf 1 area 0 command on each of the five interfaces on Router R1, enabling OSPF process 1 on the interface and placing each interface into area 0.
|
Example 20-12 OSPF Single-Area Configuration on R1 Using One network Command Example end.|Example 20-12 OSPF Single-Area Configuration on R1 Using One network Command Example end.
|
When reading the example, read from top to bottom, and also consider the details about the failed and recovered neighbor relationships shown in the log messages.|When reading the example, read from top to bottom, and also consider the details about the failed and recovered neighbor relationships shown in the log messages.
Removing the network command disabled OSPF on all interfaces on Router R1, causing all three neighbor relationships to fail.|Removing the network command disabled OSPF on all interfaces on Router R1, causing all three neighbor relationships to fail.
The example then shows the addition of the ip ospf 1 area 0 command on the two LAN subinterfaces, which enables OSPF. Then the example shows the same command added to each of the WAN links in succession, and in each case, the OSPF neighbor available over that WAN link comes up (as noted in the log messages.)|The example then shows the addition of the ip ospf 1 area 0 command on the two LAN subinterfaces, which enables OSPF. Then the example shows the same command added to each of the WAN links in succession, and in each case, the OSPF neighbor available over that WAN link comes up (as noted in the log messages.)
##### Verifying OSPF Interface Configuration
Verifying OSPF Interface Configuration   
__|__
--|--
|
OSPF operates the same way whether you use the new style or old style of configuration.|OSPF operates the same way whether you use the new style or old style of configuration.
|
The OSPF area design works the same, neighbor relationships form the same way, routers negotiate to become the DR and BDR the same way, and so on.|The OSPF area design works the same, neighbor relationships form the same way, routers negotiate to become the DR and BDR the same way, and so on.
However, you can see a few small differences in show command output when using the newer OSPFv2 configuration if you look closely.|However, you can see a few small differences in show command output when using the newer OSPFv2 configuration if you look closely.
|
The show ip protocols command relists most of the routing protocol configuration, so it does list some different details if you use interface configuration versus the network command.|The show ip protocols command relists most of the routing protocol configuration, so it does list some different details if you use interface configuration versus the network command.
|
With the newer-style configuration, the output lists the phrase “Interfaces Configured Explicitly,” with the list of interfaces configured with the new ip ospf process-id area area-id commands, as highlighted in Example 20-13.|With the newer-style configuration, the output lists the phrase “Interfaces Configured Explicitly,” with the list of interfaces configured with the new ip ospf process-id area area-id commands, as highlighted in Example 20-13.
The example first shows the relevant parts of the show ip protocols command when using interface configuration on Router R1, and then lists the same portions of the command from when R1 used network commands.|The example first shows the relevant parts of the show ip protocols command when using interface configuration on Router R1, and then lists the same portions of the command from when R1 used network commands.
|
Example 20-13 Differences in show ip protocols Output: Old- and New-Style OSPFv2 Example end.|Example 20-13 Differences in show ip protocols Output: Old- and New-Style OSPFv2 Example end.
|
Another small piece of different output exists in the show ip ospf interface [interface] command.|Another small piece of different output exists in the show ip ospf interface [interface] command.
|
The command lists details about OSPF settings for the interface(s) on which OSPF is enabled.|The command lists details about OSPF settings for the interface(s) on which OSPF is enabled.
The output also makes a subtle reference to whether that interface was enabled for OSPF with the old or new configuration style.|The output also makes a subtle reference to whether that interface was enabled for OSPF with the old or new configuration style.
Example 20-14 also begins with output based on interface configuration on Router R1, followed by the output that would exist if R1 still used the old-style network command.|Example 20-14 also begins with output based on interface configuration on Router R1, followed by the output that would exist if R1 still used the old-style network command.
|
Example 20-14 Differences in show ip ospf interface Output with OSPFv2 Interface Example end.|Example 20-14 Differences in show ip ospf interface Output with OSPFv2 Interface Example end.
|
Other than these small differences in a few show commands, the rest of the commands show nothing different depending on the style of configuration.|Other than these small differences in a few show commands, the rest of the commands show nothing different depending on the style of configuration.
For instance, the show ip ospf interface brief command does not change depending on the configuration style, nor do the show ip ospf database, show ip ospf neighbor, or show ip route commands.|For instance, the show ip ospf interface brief command does not change depending on the configuration style, nor do the show ip ospf database, show ip ospf neighbor, or show ip route commands.
### Additional OSPFv2 Features
Additional OSPFv2 Features   
__|__
--|--
|
This final major section of the chapter discusses some very popular but optional OSPFv2 configuration features, as listed here in their order of appearance:|This final major section of the chapter discusses some very popular but optional OSPFv2 configuration features, as listed here in their order of appearance:
###### Passive interfaces
Passive interfaces   
###### Default routes
Default routes   
###### Metrics
Metrics   
###### Load balancing
Load balancing   
#### OSPF Passive Interfaces
OSPF Passive Interfaces   
__|__
--|--
|
Once OSPF has been enabled on an interface, the router tries to discover neighboring OSPF routers and form a neighbor relationship.|Once OSPF has been enabled on an interface, the router tries to discover neighboring OSPF routers and form a neighbor relationship.
To do so, the router sends OSPF Hello messages on a regular time interval (called the Hello Interval).|To do so, the router sends OSPF Hello messages on a regular time interval (called the Hello Interval).
The router also listens for incoming Hello messages from potential neighbors.|The router also listens for incoming Hello messages from potential neighbors.
|
Sometimes, a router does not need to form neighbor relationships with neighbors on an interface.|Sometimes, a router does not need to form neighbor relationships with neighbors on an interface.
Often, no other routers exist on a particular link, so the router has no need to keep sending those repetitive OSPF Hello messages.|Often, no other routers exist on a particular link, so the router has no need to keep sending those repetitive OSPF Hello messages.
In such cases, an engineer can make the interface passive, which means|In such cases, an engineer can make the interface passive, which means
###### OSPF continues to advertise about the subnet that is connected to the interface.
OSPF continues to advertise about the subnet that is connected to the interface.   
###### OSPF no longer sends OSPF Hellos on the interface.
OSPF no longer sends OSPF Hellos on the interface.   
###### OSPF no longer processes any received Hellos on the interface.
OSPF no longer processes any received Hellos on the interface.   
__|__
--|--
|
The result of enabling OSPF on an interface but then making it passive is that OSPF still advertises about the connected subnet, but OSPF also does not form neighbor relationships over the interface.|The result of enabling OSPF on an interface but then making it passive is that OSPF still advertises about the connected subnet, but OSPF also does not form neighbor relationships over the interface.
|
To configure an interface as passive, two options exist.|To configure an interface as passive, two options exist.
First, you can add the following command to the configuration of the OSPF process, in router configuration mode:|First, you can add the following command to the configuration of the OSPF process, in router configuration mode:
|
passive-interface type number Alternately, the configuration can change the default setting so that all interfaces are passive by default and then add a no passive-interface command for all interfaces that need to not be passive:|passive-interface type number Alternately, the configuration can change the default setting so that all interfaces are passive by default and then add a no passive-interface command for all interfaces that need to not be passive:
|
passive-interface default no passive-interface type number For example, in the sample internetwork in Figure 20-2 (and in Figure 20-5), Router R1, on the left side of the figure, has a LAN interface configured for VLAN trunking.|passive-interface default no passive-interface type number For example, in the sample internetwork in Figure 20-2 (and in Figure 20-5), Router R1, on the left side of the figure, has a LAN interface configured for VLAN trunking.
The only router connected to both VLANs is Router R1, so R1 will never discover an OSPF neighbor on these subnets.|The only router connected to both VLANs is Router R1, so R1 will never discover an OSPF neighbor on these subnets.
Example 20-15 shows two alternative configurations to make the two LAN subinterfaces passive to OSPF.|Example 20-15 shows two alternative configurations to make the two LAN subinterfaces passive to OSPF.
|
Example 20-15 Configuring Passive Interfaces on R1 from Figure 20-5 Example end.|Example 20-15 Configuring Passive Interfaces on R1 from Figure 20-5 Example end.
|
In real internetworks, the choice of configuration style reduces to which option requires the least number of commands.|In real internetworks, the choice of configuration style reduces to which option requires the least number of commands.
For example, a router with 20 interfaces, 18 of which are passive to OSPF, has far fewer configuration commands when using the passive-interface default command to change the default to passive.|For example, a router with 20 interfaces, 18 of which are passive to OSPF, has far fewer configuration commands when using the passive-interface default command to change the default to passive.
If only two of those 20 interfaces need to be passive, use the default setting, in which all interfaces are not passive, to keep the configuration shorter.|If only two of those 20 interfaces need to be passive, use the default setting, in which all interfaces are not passive, to keep the configuration shorter.
|
Interestingly, OSPF makes it a bit of a challenge to use show commands to find whether or not an interface is passive.|Interestingly, OSPF makes it a bit of a challenge to use show commands to find whether or not an interface is passive.
The show running-config command lists the configuration directly, but if you cannot get into enable mode to use this command, note these two facts:|The show running-config command lists the configuration directly, but if you cannot get into enable mode to use this command, note these two facts:
|
The show ip ospf interface brief command lists all interfaces on which OSPF is enabled, including passive interfaces.|The show ip ospf interface brief command lists all interfaces on which OSPF is enabled, including passive interfaces.
|
The show ip ospf interface command lists a single line that mentions that the interface is passive.|The show ip ospf interface command lists a single line that mentions that the interface is passive.
|
Example 20-16 shows these two commands on Router R1, based on the configuration shown in the top of Example 20-15.|Example 20-16 shows these two commands on Router R1, based on the configuration shown in the top of Example 20-15.
Note that subinterfaces G0/0.1 and G0/0.2 both show up in the output of show ip ospf interface brief.|Note that subinterfaces G0/0.1 and G0/0.2 both show up in the output of show ip ospf interface brief.
|
Example 20-16 Displaying Passive Interfaces Example end.|Example 20-16 Displaying Passive Interfaces Example end.
#### OSPF Default Routes
OSPF Default Routes   
__|__
--|--
|
Chapter 16, “Configuring IPv4 Addressing and Static Routes,” showed some of the uses and benefits of default routes, with examples of static default routes.|Chapter 16, “Configuring IPv4 Addressing and Static Routes,” showed some of the uses and benefits of default routes, with examples of static default routes.
For those exact same reasons, networks can use OSPF to advertise default routes.|For those exact same reasons, networks can use OSPF to advertise default routes.
|
The most classic case for using a routing protocol to advertise a default route has to do with an enterprise’s connection to the Internet.|The most classic case for using a routing protocol to advertise a default route has to do with an enterprise’s connection to the Internet.
As a strategy, the enterprise engineer uses these design goals:|As a strategy, the enterprise engineer uses these design goals:
###### All routers learn specific (nondefault) routes for subnets inside the company; a default
All routers learn specific (nondefault) routes for subnets inside the company; a default   
__|__
--|--
|
route is not needed when forwarding packets to these destinations.|route is not needed when forwarding packets to these destinations.
###### One router connects to the Internet, and it has a default route that points toward the
One router connects to the Internet, and it has a default route that points toward the   
__|__
--|--
|
Internet.|Internet.
###### All routers should dynamically learn a default route, used for all traffic going to the
All routers should dynamically learn a default route, used for all traffic going to the   
__|__
--|--
|
Internet, so that all packets destined to locations in the Internet go to the one router connected to the Internet.|Internet, so that all packets destined to locations in the Internet go to the one router connected to the Internet.
|
Figure 20-6 shows the idea of how OSPF advertises the default route, with the specific OSPF configuration.|Figure 20-6 shows the idea of how OSPF advertises the default route, with the specific OSPF configuration.
In this case, a company connects to an ISP with its Router R1. That router has a static default route (destination 0.0.0.0, mask 0.0.0.0) with a next-hop address of the ISP router.|In this case, a company connects to an ISP with its Router R1. That router has a static default route (destination 0.0.0.0, mask 0.0.0.0) with a next-hop address of the ISP router.
Then the use of the OSPF default-information originate command (Step 2)|Then the use of the OSPF default-information originate command (Step 2)
|
makes the router advertise a default route using OSPF to the remote routers (B1 and B2).|makes the router advertise a default route using OSPF to the remote routers (B1 and B2).
|
Figure 20-6 Using OSPF to Create and Flood a Default Route Figure 20-7 shows the default routes that result from OSPF’s advertisements in Figure 20-6.|Figure 20-6 Using OSPF to Create and Flood a Default Route Figure 20-7 shows the default routes that result from OSPF’s advertisements in Figure 20-6.
|
On the far left, the branch routers all have OSPF-learned default routes, pointing to R1.|On the far left, the branch routers all have OSPF-learned default routes, pointing to R1.
|
R1 itself also needs a default route, pointing to the ISP router, so that R1 can forward all Internet-bound traffic to the ISP.|R1 itself also needs a default route, pointing to the ISP router, so that R1 can forward all Internet-bound traffic to the ISP.
|
Finally, this feature gives the engineer control over when the router originates this default route.|Finally, this feature gives the engineer control over when the router originates this default route.
First, R1 needs a default route, either defined as a static default route, learned from the ISP with DHCP or learned from the ISP with a routing protocol like eBGP. The OSPF subcommand default-information originate then tells OSPF on R1 to advertise a default route when its own default route is working and to advertise the default route as down when its own default route fails.|First, R1 needs a default route, either defined as a static default route, learned from the ISP with DHCP or learned from the ISP with a routing protocol like eBGP. The OSPF subcommand default-information originate then tells OSPF on R1 to advertise a default route when its own default route is working and to advertise the default route as down when its own default route fails.
|
Figure 20-7 Default Routes Resulting from the default-information originate Command NOTE Interestingly, the default-information originate always router subcommand tells the router to always advertise the default route, no matter whether the router’s default route is working or not.|Figure 20-7 Default Routes Resulting from the default-information originate Command NOTE Interestingly, the default-information originate always router subcommand tells the router to always advertise the default route, no matter whether the router’s default route is working or not.
|
Example 20-17 shows details of the default route on both R1 and branch router B1 from Figure 20-7.|Example 20-17 shows details of the default route on both R1 and branch router B1 from Figure 20-7.
R1 then creates a static default route with the ISP router’s IP address of 192.0.2.1 as the next-hop address, as highlighted in the output of the show ip route static command output.|R1 then creates a static default route with the ISP router’s IP address of 192.0.2.1 as the next-hop address, as highlighted in the output of the show ip route static command output.
|
Example 20-17 Default Routes on Routers R1 and B1 Example end.|Example 20-17 Default Routes on Routers R1 and B1 Example end.
|
Keeping the focus on the command on Router R1, note that R1 indeed has a default route—|Keeping the focus on the command on Router R1, note that R1 indeed has a default route—
|
that is, a route to 0.0.0.0/0.|that is, a route to 0.0.0.0/0.
The “Gateway of last resort,” which refers to the default route currently used by the router, points to next-hop IP address 192.0.2.1, which is the ISP router’s IP address. (Refer to Figure 20-7 for the particulars.)|The “Gateway of last resort,” which refers to the default route currently used by the router, points to next-hop IP address 192.0.2.1, which is the ISP router’s IP address. (Refer to Figure 20-7 for the particulars.)
|
Next look to the bottom half of the example and router B1’s OSPF-learned default route.|Next look to the bottom half of the example and router B1’s OSPF-learned default route.
B1 lists a route for 0.0.0.0/0 as well.|B1 lists a route for 0.0.0.0/0 as well.
The next-hop router in this case is 10.1.12.1, which is Router R1’s IP address on the WAN link.|The next-hop router in this case is 10.1.12.1, which is Router R1’s IP address on the WAN link.
The code on the far left is O1E2, meaning an OSPF-learned route, which is a default route, and is specifically an external OSPF route.|The code on the far left is O1E2, meaning an OSPF-learned route, which is a default route, and is specifically an external OSPF route.
Finally, B1’s gateway of last resort setting uses that one OSPF-learned default route, with next-hop router|Finally, B1’s gateway of last resort setting uses that one OSPF-learned default route, with next-hop router
###### 10.1.12.1.
10.1.12.1.   
#### OSPF Metrics Cost
OSPF Metrics Cost   
__|__
--|--
|
The section “Calculating the Best Routes with SPF” in Chapter 19 discussed how SPF calculates the metric for each route, choosing the route with the best metric for each destination subnet.|The section “Calculating the Best Routes with SPF” in Chapter 19 discussed how SPF calculates the metric for each route, choosing the route with the best metric for each destination subnet.
OSPF routers can influence that choice by changing the OSPF interface cost on any and all interfaces.|OSPF routers can influence that choice by changing the OSPF interface cost on any and all interfaces.
|
Cisco routers allow three different ways to change the OSPF interface cost:|Cisco routers allow three different ways to change the OSPF interface cost:
###### Directly, using the interface subcommand ip ospf cost x.
Directly, using the interface subcommand ip ospf cost x.   
###### Using the default calculation per interface, and changing the interface bandwidth setting,
Using the default calculation per interface, and changing the interface bandwidth setting,   
__|__
--|--
|
which changes the calculated value.|which changes the calculated value.
###### Using the default calculation per interface, and changing the OSPF reference bandwidth
Using the default calculation per interface, and changing the OSPF reference bandwidth   
__|__
--|--
|
setting, which changes the calculated value.|setting, which changes the calculated value.
##### Setting the Cost Directly
Setting the Cost Directly   
__|__
--|--
|
Setting the cost directly requires a simple configuration command, as shown in Example 20-18.|Setting the cost directly requires a simple configuration command, as shown in Example 20-18.
The example sets the cost of two interfaces on Router R1. (This example uses the Figure 20-2 design, as configured in Examples 20-2 and 20-3.) The show ip ospf interface brief command that follows details the cost of each interface.|The example sets the cost of two interfaces on Router R1. (This example uses the Figure 20-2 design, as configured in Examples 20-2 and 20-3.) The show ip ospf interface brief command that follows details the cost of each interface.
Note that the show command confirms the cost settings.|Note that the show command confirms the cost settings.
|
Example 20-18 Confirming OSPF Interface Costs Example end.|Example 20-18 Confirming OSPF Interface Costs Example end.
|
The output also shows a cost value of 1 for the other Gigabit interfaces, which is the default OSPF cost for any interface faster than 100 Mbps.|The output also shows a cost value of 1 for the other Gigabit interfaces, which is the default OSPF cost for any interface faster than 100 Mbps.
The next topic discusses how IOS determines the default cost values.|The next topic discusses how IOS determines the default cost values.
##### Setting the Cost Based on Interface and Reference Bandwidth
Setting the Cost Based on Interface and Reference Bandwidth   
__|__
--|--
|
Routers use a per-interface bandwidth setting to describe the speed of the interface.|Routers use a per-interface bandwidth setting to describe the speed of the interface.
Note that the interface bandwidth setting does not influence the actual transmission speed.|Note that the interface bandwidth setting does not influence the actual transmission speed.
|
Instead, the interface bandwidth acts as a configurable setting to represent the speed of the interface, with the option to configure the bandwidth to match the actual transmission speed…or not.|Instead, the interface bandwidth acts as a configurable setting to represent the speed of the interface, with the option to configure the bandwidth to match the actual transmission speed…or not.
To support this logic, IOS sets a default interface bandwidth value that matches the physical transmission speed when possible, but also allows the configuration of the interface bandwidth using bandwidth speed interface subcommand.|To support this logic, IOS sets a default interface bandwidth value that matches the physical transmission speed when possible, but also allows the configuration of the interface bandwidth using bandwidth speed interface subcommand.
|
OSPF (as well as other IOS features) uses the interface bandwidth to make decisions, with OSPF using the interface bandwidth in its calculation of the default OSPF cost for each interface.|OSPF (as well as other IOS features) uses the interface bandwidth to make decisions, with OSPF using the interface bandwidth in its calculation of the default OSPF cost for each interface.
IOS uses the following formula to choose an interface’s OSPF cost if the cost for cases in which the ip ospf cost command is not configured on the interface.|IOS uses the following formula to choose an interface’s OSPF cost if the cost for cases in which the ip ospf cost command is not configured on the interface.
IOS puts the interface’s bandwidth in the denominator and an OSPF setting called the reference bandwidth in the numerator:|IOS puts the interface’s bandwidth in the denominator and an OSPF setting called the reference bandwidth in the numerator:
|
Reference_bandwidth / Interface_bandwidth Note that while you can change both the interface bandwidth and reference bandwidth via configuration, because several IOS features make use of the bandwidth setting, you should avoid changing the interface bandwidth as a means to influence the default OSPF cost.|Reference_bandwidth / Interface_bandwidth Note that while you can change both the interface bandwidth and reference bandwidth via configuration, because several IOS features make use of the bandwidth setting, you should avoid changing the interface bandwidth as a means to influence the default OSPF cost.
|
That being said, many enterprises do use default cost settings while influencing the default by changing the OSPF reference bandwidth while leaving the interface bandwidth as an accurate representation of link speed.|That being said, many enterprises do use default cost settings while influencing the default by changing the OSPF reference bandwidth while leaving the interface bandwidth as an accurate representation of link speed.
Cisco chose the IOS default reference bandwidth setting decades ago in an era with much slower links.|Cisco chose the IOS default reference bandwidth setting decades ago in an era with much slower links.
As a result, any interface with an interface bandwidth of 100 Mbps or faster ties with a calculated OSPF cost of 1 when using the default reference bandwidth.|As a result, any interface with an interface bandwidth of 100 Mbps or faster ties with a calculated OSPF cost of 1 when using the default reference bandwidth.
So, when relying on the default OSPF cost calculation, it helps to configure the reference bandwidth to another value.|So, when relying on the default OSPF cost calculation, it helps to configure the reference bandwidth to another value.
|
To see the issue, consider Table 20-3, which lists several types of interfaces, the default interface bandwidth on those interfaces, and the OSPF cost calculated with the default OSPF reference bandwidth of 100 MBps (that is, 100,000 Kbps). (OSPF rounds up for these calculations, resulting in a lowest possible OSPF interface cost of 1.)|To see the issue, consider Table 20-3, which lists several types of interfaces, the default interface bandwidth on those interfaces, and the OSPF cost calculated with the default OSPF reference bandwidth of 100 MBps (that is, 100,000 Kbps). (OSPF rounds up for these calculations, resulting in a lowest possible OSPF interface cost of 1.)
|
Table 20-3 Faster Interfaces with Equal OSPF Costs Table end.|Table 20-3 Faster Interfaces with Equal OSPF Costs Table end.
|
As you can see from the table, with a default reference bandwidth, all interfaces from Fast Ethernet’s 100 Mbps and faster tie with their default OSPF cost.|As you can see from the table, with a default reference bandwidth, all interfaces from Fast Ethernet’s 100 Mbps and faster tie with their default OSPF cost.
As a result, OSPF would treat a 100-Mbps link as having the same cost as a 10- or 100-Gbps link, which is probably not the right basis for choosing routes.|As a result, OSPF would treat a 100-Mbps link as having the same cost as a 10- or 100-Gbps link, which is probably not the right basis for choosing routes.
|
You can still use OSPF’s default cost calculation (and many do) just by changing the reference bandwidth with the auto-cost reference-bandwidth speed OSPF mode subcommand.|You can still use OSPF’s default cost calculation (and many do) just by changing the reference bandwidth with the auto-cost reference-bandwidth speed OSPF mode subcommand.
|
This command sets a value in a unit of megabits per second (Mbps).|This command sets a value in a unit of megabits per second (Mbps).
Set the reference bandwidth value to a value at least as much as the fastest link speed in the network, but preferably higher, in anticipation of adding even faster links in the future.|Set the reference bandwidth value to a value at least as much as the fastest link speed in the network, but preferably higher, in anticipation of adding even faster links in the future.
|
For instance, in an enterprise whose fastest links are 10 Gbps (10,000 Mbps), you could set all routers to use auto-cost reference-bandwidth 10000, meaning 10,000 Mbps or 10 Gbps.|For instance, in an enterprise whose fastest links are 10 Gbps (10,000 Mbps), you could set all routers to use auto-cost reference-bandwidth 10000, meaning 10,000 Mbps or 10 Gbps.
|
In that case, by default, a 10-Gbps link would have an OSPF cost of 1, while a 1-Gbps link would have a cost of 10, and a 100-MBps link a cost of 100.|In that case, by default, a 10-Gbps link would have an OSPF cost of 1, while a 1-Gbps link would have a cost of 10, and a 100-MBps link a cost of 100.
|
Better still, in that same enterprise, use a reference bandwidth of a faster speed than the fastest interface in the network, to allow room for higher speeds.|Better still, in that same enterprise, use a reference bandwidth of a faster speed than the fastest interface in the network, to allow room for higher speeds.
For instance, in that same enterprise, whose fastest link is 10 Gbps, set the reference bandwidth to 40 Gbps or even 100 Gbps to be ready for future upgrades to use 40-Gbps links, or even 100-Gbps links.|For instance, in that same enterprise, whose fastest link is 10 Gbps, set the reference bandwidth to 40 Gbps or even 100 Gbps to be ready for future upgrades to use 40-Gbps links, or even 100-Gbps links.
|
(For example, use the auto-cost reference-bandwidth 100000 command, meaning 100,000 Mbps or 100 Gbps.) That causes 100-Gbps links to have an OSPF cost of 1, 40-Gbps links to have a cost of 4, 10-Gbps links to have a cost of 10, and 1-Gbps links to have a cost of 100.|(For example, use the auto-cost reference-bandwidth 100000 command, meaning 100,000 Mbps or 100 Gbps.) That causes 100-Gbps links to have an OSPF cost of 1, 40-Gbps links to have a cost of 4, 10-Gbps links to have a cost of 10, and 1-Gbps links to have a cost of 100.
|
NOTE Cisco recommends making the OSPF reference bandwidth setting the same on all OSPF routers in an enterprise network.|NOTE Cisco recommends making the OSPF reference bandwidth setting the same on all OSPF routers in an enterprise network.
|
For convenient study, the following list summarizes the rules for how a router sets its OSPF interface costs:|For convenient study, the following list summarizes the rules for how a router sets its OSPF interface costs:
|
1. Set the cost explicitly, using the ip ospf cost x interface subcommand, to a value between 1 and 65,535, inclusive.|1. Set the cost explicitly, using the ip ospf cost x interface subcommand, to a value between 1 and 65,535, inclusive.
|
2. Although it should be avoided, change the interface bandwidth with the bandwidth speed command, with speed being a number in kilobits per second (Kbps).|2. Although it should be avoided, change the interface bandwidth with the bandwidth speed command, with speed being a number in kilobits per second (Kbps).
|
3. Change the reference bandwidth, using router OSPF subcommand auto-cost reference-bandwidth ref-bw, with a unit of megabits per second (Mbps).|3. Change the reference bandwidth, using router OSPF subcommand auto-cost reference-bandwidth ref-bw, with a unit of megabits per second (Mbps).
#### OSPF Load Balancing
OSPF Load Balancing   
__|__
--|--
|
When a router uses SPF to calculate the metric for each of several routes to reach one subnet, one route may have the lowest metric, so OSPF puts that route in the routing table.|When a router uses SPF to calculate the metric for each of several routes to reach one subnet, one route may have the lowest metric, so OSPF puts that route in the routing table.
|
However, when the metrics tie for multiple routes to the same subnet, the router can put multiple equal-cost routes in the routing table (the default is four different routes) based on the setting of the maximum-paths number router subcommand.|However, when the metrics tie for multiple routes to the same subnet, the router can put multiple equal-cost routes in the routing table (the default is four different routes) based on the setting of the maximum-paths number router subcommand.
For example, if an internetwork has six possible paths between some parts of the network, and the engineer wants all routes to be used, the routers can be configured with the maximum-paths 6 subcommand under router ospf.|For example, if an internetwork has six possible paths between some parts of the network, and the engineer wants all routes to be used, the routers can be configured with the maximum-paths 6 subcommand under router ospf.
|
The more challenging concept relates to how the routers use those multiple routes.|The more challenging concept relates to how the routers use those multiple routes.
A router could load balance the packets on a per-packet basis.|A router could load balance the packets on a per-packet basis.
For example, if the router has three equal-cost OSPF routes for the same subnet in the routing table, the router could send the one packet over the first route, the next packet over the second route, the next packet over the third route, and then start over with the first route for the next packet.|For example, if the router has three equal-cost OSPF routes for the same subnet in the routing table, the router could send the one packet over the first route, the next packet over the second route, the next packet over the third route, and then start over with the first route for the next packet.
Note that perpacket load balancing is generally a poor choice because it causes the most overhead work on the router.|Note that perpacket load balancing is generally a poor choice because it causes the most overhead work on the router.
Alternatively, using the default (and better) method, the load balancing could be on a per-destination IP address basis.|Alternatively, using the default (and better) method, the load balancing could be on a per-destination IP address basis.
|
Note that the default setting of maximum-paths varies by router platform.|Note that the default setting of maximum-paths varies by router platform.
### Chapter Review
Chapter Review   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|One key to doing well on the exams is to perform repetitive spaced review sessions.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.
Refer to the “Your Study Plan” element for more details.|Refer to the “Your Study Plan” element for more details.
Table 20-4 outlines the key review elements and where you can find them.|Table 20-4 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 20-4 Chapter Review Tracking Table end.|Table 20-4 Chapter Review Tracking Table end.
|
Review All the Key Topics Table 20-5 Key Topics for Chapter 20 Table end.|Review All the Key Topics Table 20-5 Key Topics for Chapter 20 Table end.
|
Table 20-6 Chapter 20 Configuration Command Reference Table end.|Table 20-6 Chapter 20 Configuration Command Reference Table end.
|
Table 20-7 Chapter 20 EXEC Command Reference Table end.|Table 20-7 Chapter 20 EXEC Command Reference Table end.
|
Command Description show ip ospf neighbor [type number]|Command Description show ip ospf neighbor [type number]
|
Lists brief output about neighbors, identified by neighbor router ID, including current state, with one line per neighbor;|Lists brief output about neighbors, identified by neighbor router ID, including current state, with one line per neighbor;
|
optionally, limits the output to neighbors on the listed interface.|optionally, limits the output to neighbors on the listed interface.
|
show ip ospf neighbor neighbor-ID Lists the same output as the show ip ospf neighbor detail command, but only for the listed neighbor (by neighbor RID).|show ip ospf neighbor neighbor-ID Lists the same output as the show ip ospf neighbor detail command, but only for the listed neighbor (by neighbor RID).
|
show ip ospf database Lists a summary of the LSAs in the database, with one line of output per LSA. It is organized by LSA type (first type 1, then type 2, and so on).|show ip ospf database Lists a summary of the LSAs in the database, with one line of output per LSA. It is organized by LSA type (first type 1, then type 2, and so on).
|
show ip route Lists all IPv4 routes.|show ip route Lists all IPv4 routes.
|
show ip route ospf Lists routes in the routing table learned by OSPF.|show ip route ospf Lists routes in the routing table learned by OSPF.
|
show ip route ip-address mask Shows a detailed description of the route for the listed subnet/mask.|show ip route ip-address mask Shows a detailed description of the route for the listed subnet/mask.
|
clear ip ospf process Resets the OSPF process, resetting all neighbor relationships and also causing the process to make a choice of OSPF RID.|clear ip ospf process Resets the OSPF process, resetting all neighbor relationships and also causing the process to make a choice of OSPF RID.
## Chapter 21 OSPF Network Types and Neighbors
Chapter 21 OSPF Network Types and Neighbors   
__|__
--|--
|
Neighbors This chapter covers the following exam topics:|Neighbors This chapter covers the following exam topics:
###### 3.0 IP Connectivity
3.0 IP Connectivity   
###### 3.4 Configure and verify single area OSPFv2
3.4 Configure and verify single area OSPFv2   
###### 3.4.a Neighbor adjacencies
3.4.a Neighbor adjacencies   
###### 3.4.b Point-to-point
3.4.b Point-to-point   
###### 3.4.c Broadcast (DR/BDR selection)
3.4.c Broadcast (DR/BDR selection)   
###### 3.4.d Router ID
3.4.d Router ID   
__|__
--|--
|
Chapter 20, “Implementing OSPF,” discussed the required and most common optional OSPF configuration settings, along with the many verification commands to show how OSPF works with those settings.|Chapter 20, “Implementing OSPF,” discussed the required and most common optional OSPF configuration settings, along with the many verification commands to show how OSPF works with those settings.
This chapter continues with more OSPF implementation topics, both to round out the discussion of OSPF and to focus even more on the specific CCNA 200-301 exam topics.|This chapter continues with more OSPF implementation topics, both to round out the discussion of OSPF and to focus even more on the specific CCNA 200-301 exam topics.
|
The first of two major sections of this chapter focuses on OSPF network types, specifically types point-to-point and broadcast.|The first of two major sections of this chapter focuses on OSPF network types, specifically types point-to-point and broadcast.
The CCNA 200-301 exam topics mention those by name.|The CCNA 200-301 exam topics mention those by name.
Chapter 20 showed how OSPF operates on Ethernet interfaces when using their default network type (broadcast).|Chapter 20 showed how OSPF operates on Ethernet interfaces when using their default network type (broadcast).
This first section of the chapter discusses the meaning of OSPF network types, default settings, how to configure to use other settings, and how OSPF works differently with different settings.|This first section of the chapter discusses the meaning of OSPF network types, default settings, how to configure to use other settings, and how OSPF works differently with different settings.
|
The second major section then focuses on neighbors and neighbor adjacencies as mentioned in yet another of the OSPF exam topics.|The second major section then focuses on neighbors and neighbor adjacencies as mentioned in yet another of the OSPF exam topics.
OSPF routers cannot exchange LSAs with another router unless they first become neighbors.|OSPF routers cannot exchange LSAs with another router unless they first become neighbors.
This second section discusses the various OSPF features that can prevent OSPF routers from becoming neighbors and how you can go about discovering if those bad conditions exist—even if you do not have access to the running configuration.|This second section discusses the various OSPF features that can prevent OSPF routers from becoming neighbors and how you can go about discovering if those bad conditions exist—even if you do not have access to the running configuration.
### “Do I Know This Already?” Quiz
“Do I Know This Already?” Quiz   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.
The letter answers are listed at the bottom of the page following the quiz.|The letter answers are listed at the bottom of the page following the quiz.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.
You can also find both answers and explanations in the PTP testing software.|You can also find both answers and explanations in the PTP testing software.
|
CHAPTER 21 Table 21-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|CHAPTER 21 Table 21-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping
### Foundation Topics
Foundation Topics   
### OSPF Network Types
OSPF Network Types   
__|__
--|--
|
OSPF Neighbor Relationships 4–6 1.|OSPF Neighbor Relationships 4–6 1.
Routers R1 and R2, with router IDs 1.1.1.1 and 2.2.2.2, connect over an Ethernet WAN link.|Routers R1 and R2, with router IDs 1.1.1.1 and 2.2.2.2, connect over an Ethernet WAN link.
If using all default OSPF settings, if the WAN link initializes for both routers at the same time, which of the following answers are true? (Choose two answers.)|If using all default OSPF settings, if the WAN link initializes for both routers at the same time, which of the following answers are true? (Choose two answers.)
|
a. Router R1 will become the DR.|a. Router R1 will become the DR.
|
b. Router R1 will dynamically discover the existence of router R2.|b. Router R1 will dynamically discover the existence of router R2.
|
c. Router R2 will be neither the DR nor the BDR.|c. Router R2 will be neither the DR nor the BDR.
|
d. Router R1’s show ip ospf neighbor command will list R2 with a state of “FULL/DR.”|d. Router R1’s show ip ospf neighbor command will list R2 with a state of “FULL/DR.”
|
2. Routers R1 and R2, with router IDs 1.1.1.1 and 2.2.2.2, connect over an Ethernet WAN link.|2. Routers R1 and R2, with router IDs 1.1.1.1 and 2.2.2.2, connect over an Ethernet WAN link.
The configuration uses all defaults, except giving R1 an interface priority of 11 and changing both routers to use OSPF network type point-to-point.|The configuration uses all defaults, except giving R1 an interface priority of 11 and changing both routers to use OSPF network type point-to-point.
If the WAN link initializes for both routers at the same time, which of the following answers are true?|If the WAN link initializes for both routers at the same time, which of the following answers are true?
|
(Choose two answers.)|(Choose two answers.)
|
a. Router R1 will become the DR.|a. Router R1 will become the DR.
|
b. Router R1 will dynamically discover the existence of router R2.|b. Router R1 will dynamically discover the existence of router R2.
|
c. Router R2 will be neither the DR nor the BDR.|c. Router R2 will be neither the DR nor the BDR.
|
d. Router R2’s show ip ospf neighbor command will list R1 with a state of “FULL/DR.”|d. Router R2’s show ip ospf neighbor command will list R1 with a state of “FULL/DR.”
|
3. Per the command output, with how many routers is router R9 full adjacent over its Gi0/0 interface?|3. Per the command output, with how many routers is router R9 full adjacent over its Gi0/0 interface?
|
R9# show ip ospf interface brief Interface PID Area IP Address/Mask Cost State Nbrs F/C Gi0/0 1 0 10.1.1.1/24 1 DROTH 2/5 a. 7 b. 0 c. 5 d. 2 4.|R9# show ip ospf interface brief Interface PID Area IP Address/Mask Cost State Nbrs F/C Gi0/0 1 0 10.1.1.1/24 1 DROTH 2/5 a. 7 b. 0 c. 5 d. 2 4.
An engineer connects routers R11 and R12 to the same Ethernet LAN and configures them to use OSPFv2.|An engineer connects routers R11 and R12 to the same Ethernet LAN and configures them to use OSPFv2.
Which answers describe a combination of settings that would prevent the two routers from becoming OSPF neighbors? (Choose two answers.)|Which answers describe a combination of settings that would prevent the two routers from becoming OSPF neighbors? (Choose two answers.)
|
a. R11’s interface uses area 11 while R12’s interface uses area 12.|a. R11’s interface uses area 11 while R12’s interface uses area 12.
|
b. R11’s OSPF process uses process ID 11 while R12 uses process ID 12.|b. R11’s OSPF process uses process ID 11 while R12 uses process ID 12.
|
c. R11’s interface uses OSPF priority 11 while R12’s uses OSPF priority 12.|c. R11’s interface uses OSPF priority 11 while R12’s uses OSPF priority 12.
|
d. R11’s interface uses an OSPF Hello timer value of 11 while R12’s uses 12.|d. R11’s interface uses an OSPF Hello timer value of 11 while R12’s uses 12.
|
5. An engineer connects routers R13 and R14 to the same Ethernet LAN and configures them to use OSPFv2.|5. An engineer connects routers R13 and R14 to the same Ethernet LAN and configures them to use OSPFv2.
Which answers describe a combination of settings that would prevent the two routers from becoming OSPF neighbors?|Which answers describe a combination of settings that would prevent the two routers from becoming OSPF neighbors?
|
a. Both routers’ interface IP addresses reside in the same subnet.|a. Both routers’ interface IP addresses reside in the same subnet.
|
b. Both routers’ OSPF process uses process ID 13.|b. Both routers’ OSPF process uses process ID 13.
|
c. Both routers’ OSPF process uses router ID 13.13.13.13.|c. Both routers’ OSPF process uses router ID 13.13.13.13.
|
d. Both routers’ interfaces use an OSPF Dead interval of 40.|d. Both routers’ interfaces use an OSPF Dead interval of 40.
|
6. Router R15 has been a working part of a network that uses OSPFv2.|6. Router R15 has been a working part of a network that uses OSPFv2.
An engineer then issues the shutdown command in OSPF configuration mode on R15.|An engineer then issues the shutdown command in OSPF configuration mode on R15.
Which of the following occurs?|Which of the following occurs?
|
a. R15 empties its IP routing table of all OSPF routes but keeps its LSDB intact.|a. R15 empties its IP routing table of all OSPF routes but keeps its LSDB intact.
|
b. R15 empties its LSDB but keeps OSPF neighbor relationships active.|b. R15 empties its LSDB but keeps OSPF neighbor relationships active.
|
c. R15 keeps OSPF neighbors open but does not accept new OSPF neighbors.|c. R15 keeps OSPF neighbors open but does not accept new OSPF neighbors.
|
d. R15 keeps all OSPF configuration but ceases all OSPF activities (routes, LSDB, neighbors).|d. R15 keeps all OSPF configuration but ceases all OSPF activities (routes, LSDB, neighbors).
|
Foundation Topics OSPF Network Types Two CCNA 200-301 exam topics might be completely misunderstood without taking a closer look at yet more default OSPF settings.|Foundation Topics OSPF Network Types Two CCNA 200-301 exam topics might be completely misunderstood without taking a closer look at yet more default OSPF settings.
In particular, the following exam topics refer to a specific per-interface OSPF setting called the network type—even listing the keywords used to configure the setting in the exam topics:|In particular, the following exam topics refer to a specific per-interface OSPF setting called the network type—even listing the keywords used to configure the setting in the exam topics:
###### 3.4.b: point-to-point
3.4.b: point-to-point   
###### 3.4.c: broadcast (DR/BDR selection)
3.4.c: broadcast (DR/BDR selection)   
__|__
--|--
|
OSPF includes a small number of network types as a setting on each OSPF-enabled interface.|OSPF includes a small number of network types as a setting on each OSPF-enabled interface.
|
The setting tells the router whether or not to dynamically discover OSPF neighbors (versus requiring the static configuration of the neighboring router’s IP address) and whether or not the router should attempt to use a designated router (DR) and backup DR (BDR) in the subnet.|The setting tells the router whether or not to dynamically discover OSPF neighbors (versus requiring the static configuration of the neighboring router’s IP address) and whether or not the router should attempt to use a designated router (DR) and backup DR (BDR) in the subnet.
Of the two OSPF network types included in the CCNA exam topics, both cause routers to dynamically discover neighbors, but one calls for the use of a DR while the other does not.|Of the two OSPF network types included in the CCNA exam topics, both cause routers to dynamically discover neighbors, but one calls for the use of a DR while the other does not.
Table 21-2 summarizes the features of the two OSPF network types mentioned in the exam topics.|Table 21-2 summarizes the features of the two OSPF network types mentioned in the exam topics.
|
Table 21-2 Two OSPF Network Types and Key Behaviors Table end.|Table 21-2 Two OSPF Network Types and Key Behaviors Table end.
|
The rest of this first major section of the chapter explores each type.|The rest of this first major section of the chapter explores each type.
#### The OSPF Broadcast Network Type
The OSPF Broadcast Network Type   
__|__
--|--
|
OSPF defaults to use a broadcast network type on all types of Ethernet interfaces.|OSPF defaults to use a broadcast network type on all types of Ethernet interfaces.
Note that all the Ethernet interfaces in examples in Chapter 20 relied on that default setting.|Note that all the Ethernet interfaces in examples in Chapter 20 relied on that default setting.
|
To see all the details of how the OSPF broadcast network type works, this chapter begins with a different design than the examples in Chapter 20, instead using a single area design that connects four routers to the same subnet, as shown in Figure 21-1.|To see all the details of how the OSPF broadcast network type works, this chapter begins with a different design than the examples in Chapter 20, instead using a single area design that connects four routers to the same subnet, as shown in Figure 21-1.
All links reside in area 0, making the design a single area design.|All links reside in area 0, making the design a single area design.
|
Figure 21-1 The Single Area Design Used in This Chapter To get a sense for how OSPF operates with the broadcast network type, imagine that all four routers use a straightforward OSPF interface configuration like the router R1 configuration shown in Example 21-1.|Figure 21-1 The Single Area Design Used in This Chapter To get a sense for how OSPF operates with the broadcast network type, imagine that all four routers use a straightforward OSPF interface configuration like the router R1 configuration shown in Example 21-1.
Both GigabitEthernet interfaces on all four routers default to use network type broadcast.|Both GigabitEthernet interfaces on all four routers default to use network type broadcast.
Note that the configuration on routers R2, R3, and R4 mirrors R1’s configuration except that they use router IDs 2.2.2.2, 3.3.3.3, and 4.4.4.4, respectively, and they use the IP addresses shown in the figure.|Note that the configuration on routers R2, R3, and R4 mirrors R1’s configuration except that they use router IDs 2.2.2.2, 3.3.3.3, and 4.4.4.4, respectively, and they use the IP addresses shown in the figure.
|
Example 21-1 R1 OSPF Configuration to Match Figure 21-1 Example end.|Example 21-1 R1 OSPF Configuration to Match Figure 21-1 Example end.
|
This simple design gives us a great backdrop from which to observe the results of the broadcast network type on each router.|This simple design gives us a great backdrop from which to observe the results of the broadcast network type on each router.
Both interfaces (G0/0 and G0/1) on each router use the broadcast network type and perform the following actions:|Both interfaces (G0/0 and G0/1) on each router use the broadcast network type and perform the following actions:
###### Attempt to discover neighbors by sending OSPF Hellos to the 224.0.0.5 multicast address
Attempt to discover neighbors by sending OSPF Hellos to the 224.0.0.5 multicast address   
__|__
--|--
|
(an address reserved for sending packets to all OSPF routers in the subnet)|(an address reserved for sending packets to all OSPF routers in the subnet)
###### Attempt to elect a DR and BDR on each subnet
Attempt to elect a DR and BDR on each subnet   
###### On the interface with no other routers on the subnet (G0/1), become the DR
On the interface with no other routers on the subnet (G0/1), become the DR   
###### On the interface with three other routers on the subnet (G0/0), be either DR, BDR, or a
On the interface with three other routers on the subnet (G0/0), be either DR, BDR, or a   
__|__
--|--
|
DROther router|DROther router
###### When sending OSPF messages to the DR or BDR, send the messages to the all-OSPF-DRs
When sending OSPF messages to the DR or BDR, send the messages to the all-OSPF-DRs   
__|__
--|--
|
multicast address 224.0.0.6 Example 21-2 shows some of the results using the show ip ospf neighbor command.|multicast address 224.0.0.6 Example 21-2 shows some of the results using the show ip ospf neighbor command.
Note that R1 lists R2, R3, and R4 as neighbors (based on their 2.2.2.2, 3.3.3.3, and 4.4.4.4 router IDs), confirming that R1 dynamically discovered the other routers.|Note that R1 lists R2, R3, and R4 as neighbors (based on their 2.2.2.2, 3.3.3.3, and 4.4.4.4 router IDs), confirming that R1 dynamically discovered the other routers.
Also, note that the output lists 4.4.4.4 as the DR and 3.3.3.3 as the BDR.|Also, note that the output lists 4.4.4.4 as the DR and 3.3.3.3 as the BDR.
|
Example 21-2 R1’s List of Neighbors Example end.|Example 21-2 R1’s List of Neighbors Example end.
##### Verifying Operations with Network Type Broadcast
Verifying Operations with Network Type Broadcast   
__|__
--|--
|
As discussed in the section “Using Designated Routers on Ethernet Links” in Chapter 19, “Understanding OSPF Concepts,” all discovered routers on the link should become neighbors and at least reach the 2-way state.|As discussed in the section “Using Designated Routers on Ethernet Links” in Chapter 19, “Understanding OSPF Concepts,” all discovered routers on the link should become neighbors and at least reach the 2-way state.
For all neighbor relationships that include the DR and/or BDR, the neighbor relationship should further reach the full state.|For all neighbor relationships that include the DR and/or BDR, the neighbor relationship should further reach the full state.
That section defined the term fully adjacent as a special term that refers to neighbors that reach this full state.|That section defined the term fully adjacent as a special term that refers to neighbors that reach this full state.
|
The design in Figure 21-1, with four routers on the same LAN, provides just enough routers so that one neighbor relationship will remain in a 2-way state and not reach the full state, as a perfectly normal way for OSPF to operate.|The design in Figure 21-1, with four routers on the same LAN, provides just enough routers so that one neighbor relationship will remain in a 2-way state and not reach the full state, as a perfectly normal way for OSPF to operate.
Figure 21-2 shows the current conditions when the show commands in this chapter were gathered, with R4 as the DR, R3 as the BDR, and with R1 and R2 as DROther routers.|Figure 21-2 shows the current conditions when the show commands in this chapter were gathered, with R4 as the DR, R3 as the BDR, and with R1 and R2 as DROther routers.
|
Now consider router R1’s neighbors as listed in Example 21-2.|Now consider router R1’s neighbors as listed in Example 21-2.
R1 has three neighbors, all reachable out its G0/0 interface.|R1 has three neighbors, all reachable out its G0/0 interface.
However, R1’s show ip ospf neighbor command refers to the state of R1’s relationship with the neighbor: 2-way with router 2.2.2.2.|However, R1’s show ip ospf neighbor command refers to the state of R1’s relationship with the neighbor: 2-way with router 2.2.2.2.
Because both R1 and R2 currently serve as DROther routers—that is, they wait ready to become the BDR if either the DR or BDR fails—their neighbor relationship remains in a 2-way state.|Because both R1 and R2 currently serve as DROther routers—that is, they wait ready to become the BDR if either the DR or BDR fails—their neighbor relationship remains in a 2-way state.
|
Figure 21-2 OSPF DR/BDR/DROther Roles in the Network Examining Example 21-2 one last time, R1, as a DROther router itself, has two neighbor relationships that reach a full state: R1’s neighbor adjacency with DR R4 and R1’s neighbor adjacency with BDR R3. But R1 has a total of three neighbors, all reachable off R1’s G0/0 interface.|Figure 21-2 OSPF DR/BDR/DROther Roles in the Network Examining Example 21-2 one last time, R1, as a DROther router itself, has two neighbor relationships that reach a full state: R1’s neighbor adjacency with DR R4 and R1’s neighbor adjacency with BDR R3. But R1 has a total of three neighbors, all reachable off R1’s G0/0 interface.
|
The idea that R1 has three neighbors off its G0/0 interface, with two being fully adjacent, is reflected on the far right of the output of the show ip ospf interface brief command output in Example 21-3.|The idea that R1 has three neighbors off its G0/0 interface, with two being fully adjacent, is reflected on the far right of the output of the show ip ospf interface brief command output in Example 21-3.
It shows “2/3,” meaning two neighbors in the full state off port G0/0, with three total neighbors on that interface.|It shows “2/3,” meaning two neighbors in the full state off port G0/0, with three total neighbors on that interface.
Also, note that this command’s “State” column differs from the show ip ospf neighbor commands, in that the show ip ospf interface brief command lists the local router’s role on the interface (as shown in Figure 21-2), with R1’s G0/1 acting as DR and R1’s G0/0 acting as a DROther router.|Also, note that this command’s “State” column differs from the show ip ospf neighbor commands, in that the show ip ospf interface brief command lists the local router’s role on the interface (as shown in Figure 21-2), with R1’s G0/1 acting as DR and R1’s G0/0 acting as a DROther router.
|
Example 21-3 Router R1 OSPF Interfaces: Local Role and Neighbor Counts Example end.|Example 21-3 Router R1 OSPF Interfaces: Local Role and Neighbor Counts Example end.
|
So far, this topic has described the effect of the OSPF broadcast network type by taking advantage of the default setting on Ethernet interfaces.|So far, this topic has described the effect of the OSPF broadcast network type by taking advantage of the default setting on Ethernet interfaces.
To see the setting, use the show ip ospf interface command, as shown in Example 21-4.|To see the setting, use the show ip ospf interface command, as shown in Example 21-4.
The first highlighted item identifies the network type.|The first highlighted item identifies the network type.
However, this command’s output restates many of the facts seen in both the show ip ospf neighbor and show ip ospf interface brief commands in Examples 21-2 and 21-3, so take the time to browse through all of Example 21-4 and focus on the additional highlights to see those familiar items.|However, this command’s output restates many of the facts seen in both the show ip ospf neighbor and show ip ospf interface brief commands in Examples 21-2 and 21-3, so take the time to browse through all of Example 21-4 and focus on the additional highlights to see those familiar items.
|
Example 21-4 Displaying OSPF Network Type Broadcast Example end.|Example 21-4 Displaying OSPF Network Type Broadcast Example end.
|
Although you would not need to configure an Ethernet interface to use the broadcast network type, some older types of interfaces over the years have used different defaults and with the option to use the broadcast network type.|Although you would not need to configure an Ethernet interface to use the broadcast network type, some older types of interfaces over the years have used different defaults and with the option to use the broadcast network type.
In those cases, the ip ospf network broadcast interface subcommand would configure the setting.|In those cases, the ip ospf network broadcast interface subcommand would configure the setting.
##### Configuring to Influence the DR/BDR Election
Configuring to Influence the DR/BDR Election   
__|__
--|--
|
In some cases, you may want to influence the OSPF DR election.|In some cases, you may want to influence the OSPF DR election.
However, before deciding that makes sense in every case, note that OSPF DR/BDR election rules will not result in a specific router always being the DR, and another always being the BDR, assuming that each is up and working.|However, before deciding that makes sense in every case, note that OSPF DR/BDR election rules will not result in a specific router always being the DR, and another always being the BDR, assuming that each is up and working.
In short, here are the rules once a DR and BDR have been elected:|In short, here are the rules once a DR and BDR have been elected:
###### If the DR fails, the BDR becomes the DR, and a new BDR is elected.
If the DR fails, the BDR becomes the DR, and a new BDR is elected.   
###### When a better router enters the subnet, no preemption of the existing DR or BDR occurs.
When a better router enters the subnet, no preemption of the existing DR or BDR occurs.   
__|__
--|--
|
As a result of these rules, while you can configure a router to be the best (highest priority)|As a result of these rules, while you can configure a router to be the best (highest priority)
|
router to become the DR in an election, doing so only increases that router’s statistical chances of being the DR at a given point in time.|router to become the DR in an election, doing so only increases that router’s statistical chances of being the DR at a given point in time.
If the router fails, other routers will become DR and BDR, and the best router will not be DR again until the current DR and BDR fail.|If the router fails, other routers will become DR and BDR, and the best router will not be DR again until the current DR and BDR fail.
|
NOTE If you have begun to think about STP elections, note that the rules are similar, but with two key differences.|NOTE If you have begun to think about STP elections, note that the rules are similar, but with two key differences.
STP uses a lowest-is-best approach and allows new switches to preempt the existing root switch to become the root.|STP uses a lowest-is-best approach and allows new switches to preempt the existing root switch to become the root.
OSPF uses a highest-is-best approach and does not preempt the DR as just noted.|OSPF uses a highest-is-best approach and does not preempt the DR as just noted.
|
In some cases, you may want to influence the DR/BDR election with two configurable settings, listed here in order of precedence:|In some cases, you may want to influence the DR/BDR election with two configurable settings, listed here in order of precedence:
###### The highest OSPF interface priority: The highest value wins during an election, with values
The highest OSPF interface priority: The highest value wins during an election, with values   
__|__
--|--
|
ranging from 0 to 255.|ranging from 0 to 255.
###### The highest OSPF Router ID: If the priority ties, the election chooses the router with the
The highest OSPF Router ID: If the priority ties, the election chooses the router with the   
__|__
--|--
|
highest OSPF RID.|highest OSPF RID.
|
For example, imagine all four routers in the design shown in Figure 21-1 trying to elect the DR and BDR at the same time—for instance, after a power hit in which all four routers power off and back on again.|For example, imagine all four routers in the design shown in Figure 21-1 trying to elect the DR and BDR at the same time—for instance, after a power hit in which all four routers power off and back on again.
They all participate in the election.|They all participate in the election.
They all tie with default priority values of 1 (see Example 21-4 for R1’s priority in the show ip ospf interface command output.)|They all tie with default priority values of 1 (see Example 21-4 for R1’s priority in the show ip ospf interface command output.)
|
In this case, R4, with the numerically highest RID of 4.4.4.4, wins the election, and R3, with the next highest RID of 3.3.3.3, becomes the BDR.|In this case, R4, with the numerically highest RID of 4.4.4.4, wins the election, and R3, with the next highest RID of 3.3.3.3, becomes the BDR.
|
To influence the election, you could set the various RIDs with your preferred router with the highest RID value.|To influence the election, you could set the various RIDs with your preferred router with the highest RID value.
However, many networks choose OSPF router IDs to help identify the router easily.|However, many networks choose OSPF router IDs to help identify the router easily.
Instead, using the OSPF priority setting makes better sense.|Instead, using the OSPF priority setting makes better sense.
For instance, if an engineer preferred that R1 be the DR, the engineer could add the configuration in Example 21-5 to set R1’s interface priority to 99.|For instance, if an engineer preferred that R1 be the DR, the engineer could add the configuration in Example 21-5 to set R1’s interface priority to 99.
|
Example 21-5 Influencing DR/BDR Election Using OSPF Priority Example end.|Example 21-5 Influencing DR/BDR Election Using OSPF Priority Example end.
|
The configuration shows R1’s interface priority value now as 99, and the show ip ospf interface G0/0 command that follows confirms the setting.|The configuration shows R1’s interface priority value now as 99, and the show ip ospf interface G0/0 command that follows confirms the setting.
However, the last two commands in the example seem to show that the DR and BDR have not changed at all—and that output is indeed correct.|However, the last two commands in the example seem to show that the DR and BDR have not changed at all—and that output is indeed correct.
In the example, note that the show ip ospf neighbor command still lists R4’s state as DR, meaning R4 still acts as the DR, while the show ip ospf interface brief command lists R1’s State (role) as DROTH.|In the example, note that the show ip ospf neighbor command still lists R4’s state as DR, meaning R4 still acts as the DR, while the show ip ospf interface brief command lists R1’s State (role) as DROTH.
|
Just to complete the process, Example 21-6 shows the results after forcing a free election (by failing the LAN switch that sits between the four routers).|Just to complete the process, Example 21-6 shows the results after forcing a free election (by failing the LAN switch that sits between the four routers).
As expected, R1 wins and becomes DR due to its higher priority, with the other three routers tying based on priority.|As expected, R1 wins and becomes DR due to its higher priority, with the other three routers tying based on priority.
|
R4 wins between R2, R3, and R4 due to its higher RID to become the BDR.|R4 wins between R2, R3, and R4 due to its higher RID to become the BDR.
|
Example 21-6 Results of a Completely New DR/BDR Election Example end.|Example 21-6 Results of a Completely New DR/BDR Election Example end.
#### The OSPF Point-to-Point Network Type
The OSPF Point-to-Point Network Type   
__|__
--|--
|
The other OSPF network type mentioned in the CCNA 200-301 exam topics, point-to-point, works well for data links that by their nature have just two routers on the link.|The other OSPF network type mentioned in the CCNA 200-301 exam topics, point-to-point, works well for data links that by their nature have just two routers on the link.
For example, consider the topology in Figure 21-3, which shows router R1 with three WAN links—two Ethernet WAN links and one serial link.|For example, consider the topology in Figure 21-3, which shows router R1 with three WAN links—two Ethernet WAN links and one serial link.
|
Figure 21-3 Sample OSPF Design with Serial and Ethernet WAN First, focus on the serial link itself.|Figure 21-3 Sample OSPF Design with Serial and Ethernet WAN First, focus on the serial link itself.
To review, the jagged line represents a physical link that can at most have two devices using the link, specifically R1 and R4 in this case.|To review, the jagged line represents a physical link that can at most have two devices using the link, specifically R1 and R4 in this case.
The link does not support the ability to add a third router to the link.|The link does not support the ability to add a third router to the link.
As you might guess, the datalink protocols to control a link with at most two devices can work differently than Ethernet.|As you might guess, the datalink protocols to control a link with at most two devices can work differently than Ethernet.
|
For instance, the data-link protocols most often used on the link (HDLC and PPP) do not support data-link broadcasts.|For instance, the data-link protocols most often used on the link (HDLC and PPP) do not support data-link broadcasts.
|
Next, consider the OSPF point-to-point network type: it exists for serial links and other links that use a point-to-point topology.|Next, consider the OSPF point-to-point network type: it exists for serial links and other links that use a point-to-point topology.
These links often do not support data-link broadcasts.|These links often do not support data-link broadcasts.
|
Additionally, with only two devices on the link, using a DR/BDR is not a help, and it actually adds a little extra convergence time.|Additionally, with only two devices on the link, using a DR/BDR is not a help, and it actually adds a little extra convergence time.
Using a network type of point-to-point tells the router to not use a DR/BDR on the link.|Using a network type of point-to-point tells the router to not use a DR/BDR on the link.
|
While you may see some serial links in networks today, the CCNA and CCNP Enterprise exams make no specific mention of serial technology at this point.|While you may see some serial links in networks today, the CCNA and CCNP Enterprise exams make no specific mention of serial technology at this point.
However, you will see other point-to-point links—like some Ethernet WAN links.|However, you will see other point-to-point links—like some Ethernet WAN links.
|
To connect the thoughts, note that all the Ethernet WAN links used in this book happen to use a point-to-point Ethernet WAN service called an Ethernet Private Wire Service or simply an Ethernet Line (E-Line).|To connect the thoughts, note that all the Ethernet WAN links used in this book happen to use a point-to-point Ethernet WAN service called an Ethernet Private Wire Service or simply an Ethernet Line (E-Line).
For that service, the service provider will send Ethernet frames between two devices (routers) connected to the service, but only those two devices.|For that service, the service provider will send Ethernet frames between two devices (routers) connected to the service, but only those two devices.
In other words, an E-line is a point-to-point service in concept.|In other words, an E-line is a point-to-point service in concept.
So while the Ethernet data-link protocol supports broadcast frames, only two devices can exist on the link, and there is no advantage to using a DR/BDR. As a result, many engineers prefer to instead use an OSPF point-topoint network type on Ethernet WAN links that in effect act as a point-to-point link.|So while the Ethernet data-link protocol supports broadcast frames, only two devices can exist on the link, and there is no advantage to using a DR/BDR. As a result, many engineers prefer to instead use an OSPF point-topoint network type on Ethernet WAN links that in effect act as a point-to-point link.
|
Example 21-7 shows the configuration of router R1’s G0/0/0 interface in Figure 21-3 to use OSPF network type point-to-point.|Example 21-7 shows the configuration of router R1’s G0/0/0 interface in Figure 21-3 to use OSPF network type point-to-point.
R2, on the other end of the WAN link, would need the same configuration command on its matching interface.|R2, on the other end of the WAN link, would need the same configuration command on its matching interface.
|
Example 21-7 OSPF Network Type Point-to-Point on an Ethernet WAN Interface on R1 Example end.|Example 21-7 OSPF Network Type Point-to-Point on an Ethernet WAN Interface on R1 Example end.
|
Note the highlighted portions of the show command in Example 21-6.|Note the highlighted portions of the show command in Example 21-6.
The first two highlights note the network type.|The first two highlights note the network type.
The final highlight with two lines notes that R1 has one neighbor on the interface, a neighbor with which it has become fully adjacent per the output.|The final highlight with two lines notes that R1 has one neighbor on the interface, a neighbor with which it has become fully adjacent per the output.
|
Example 21-8 closes this section with a confirmation of some of those facts with two more commands.|Example 21-8 closes this section with a confirmation of some of those facts with two more commands.
Note that the show ip ospf neighbor command on R1 lists router R2 (RID 2.2.2.2)|Note that the show ip ospf neighbor command on R1 lists router R2 (RID 2.2.2.2)
|
with a full state, but with no DR nor BDR designation, instead listing a -.|with a full state, but with no DR nor BDR designation, instead listing a -.
The - acts as a reminder that the link does not use a DR/BDR. The second command, show ip ospf interface brief, shows the state (the local router’s role) as P2P, which is short for point-to-point, with a counter of 1 for the number of fully adjacent neighbors and total number of neighbors.|The - acts as a reminder that the link does not use a DR/BDR. The second command, show ip ospf interface brief, shows the state (the local router’s role) as P2P, which is short for point-to-point, with a counter of 1 for the number of fully adjacent neighbors and total number of neighbors.
|
Example 21-8 OSPF Network Type Point-to-Point on an Ethernet WAN Interface on R1 Example end.|Example 21-8 OSPF Network Type Point-to-Point on an Ethernet WAN Interface on R1 Example end.
|
When using Ethernet WAN links that behave as a point-to-point link, consider using OSPF network type point-to-point rather than using the default broadcast type.|When using Ethernet WAN links that behave as a point-to-point link, consider using OSPF network type point-to-point rather than using the default broadcast type.
### OSPF Neighbor Relationships
OSPF Neighbor Relationships   
__|__
--|--
|
A router’s OSPF configuration enables OSPF on a set of interfaces.|A router’s OSPF configuration enables OSPF on a set of interfaces.
IOS then attempts to discover other neighbors on those interfaces by sending and listening for OSPF Hello messages.|IOS then attempts to discover other neighbors on those interfaces by sending and listening for OSPF Hello messages.
|
However, once discovered, two routers may not become neighbors.|However, once discovered, two routers may not become neighbors.
They must have compatible values for several settings as listed in the Hellos exchanged between the two routers.|They must have compatible values for several settings as listed in the Hellos exchanged between the two routers.
|
This second major section of the chapter examines those reasons.|This second major section of the chapter examines those reasons.
#### OSPF Neighbor Requirements
OSPF Neighbor Requirements   
__|__
--|--
|
After an OSPF router hears a Hello from a new neighbor, the routing protocol examines the information in the Hello and compares that information with the local router’s own settings.|After an OSPF router hears a Hello from a new neighbor, the routing protocol examines the information in the Hello and compares that information with the local router’s own settings.
|
If the settings match, great.|If the settings match, great.
If not, the routers do not become neighbors.|If not, the routers do not become neighbors.
Because there is no formal term for all these items that a routing protocol considers, this book just calls them neighbor requirements.|Because there is no formal term for all these items that a routing protocol considers, this book just calls them neighbor requirements.
Table 21-3 lists the neighbor requirements for OSPF, with some comments about the various issues following the table.|Table 21-3 lists the neighbor requirements for OSPF, with some comments about the various issues following the table.
|
Table 21-3 Neighbor Requirements for OSPF Table end.|Table 21-3 Neighbor Requirements for OSPF Table end.
|
First, consider the meaning of the two rightmost columns.|First, consider the meaning of the two rightmost columns.
The column labeled “Required for OSPF” means that the item must be working correctly for the neighbor relationship to work correctly.|The column labeled “Required for OSPF” means that the item must be working correctly for the neighbor relationship to work correctly.
Note that all the items in this column list a “yes,” meaning that all must be correct for the neighbor relationship to work correctly.|Note that all the items in this column list a “yes,” meaning that all must be correct for the neighbor relationship to work correctly.
The last column heading states “Neighbor Missing if Incorrect.” For items listing a “yes” in this column, if that item is configured incorrectly, the neighbor will not appear in lists of OSPF neighbors—for instance, with the show ip ospf neighbor command.|The last column heading states “Neighbor Missing if Incorrect.” For items listing a “yes” in this column, if that item is configured incorrectly, the neighbor will not appear in lists of OSPF neighbors—for instance, with the show ip ospf neighbor command.
|
Next, focus on the shaded items at the top of the table.|Next, focus on the shaded items at the top of the table.
The symptom that occurs if either of these is a problem is that the show ip ospf neighbor command would not list the other router.|The symptom that occurs if either of these is a problem is that the show ip ospf neighbor command would not list the other router.
For instance, the first item states that the router interfaces must be up and working.|For instance, the first item states that the router interfaces must be up and working.
If the router interface is not working, the router cannot send any OSPF messages and discover any OSPF neighbors on that interface.|If the router interface is not working, the router cannot send any OSPF messages and discover any OSPF neighbors on that interface.
|
The middle section of the table (the unshaded rows) focuses on some OSPF settings.|The middle section of the table (the unshaded rows) focuses on some OSPF settings.
These items must be correct, but if not, they also result in the neighbor not being listed in the output of the show ip ospf neighbor command.|These items must be correct, but if not, they also result in the neighbor not being listed in the output of the show ip ospf neighbor command.
|
As you can see, using the show ip ospf neighbor command can give you a good starting point to troubleshoot OSPF on the exam and in real life.|As you can see, using the show ip ospf neighbor command can give you a good starting point to troubleshoot OSPF on the exam and in real life.
If you see the neighbor you expect to see, great!|If you see the neighbor you expect to see, great!
If not, the table gives you a good list to use for items to investigate.|If not, the table gives you a good list to use for items to investigate.
|
Finally, the last section (shaded) lists a couple of OSPF settings that give a different symptom when incorrect.|Finally, the last section (shaded) lists a couple of OSPF settings that give a different symptom when incorrect.
Again, those two items must be correct for OSPF neighbors to work.|Again, those two items must be correct for OSPF neighbors to work.
|
However, for these two items, when incorrect, a router can list the other router as a neighbor, but the neighbor relationship does not work properly in that the routers do not exchange LSAs as they should.|However, for these two items, when incorrect, a router can list the other router as a neighbor, but the neighbor relationship does not work properly in that the routers do not exchange LSAs as they should.
|
For reference, Table 21-4 relists some of the requirements from Table 21-3, along with the most useful commands with which to find the answers.|For reference, Table 21-4 relists some of the requirements from Table 21-3, along with the most useful commands with which to find the answers.
|
Table 21-4 OSPF Neighbor Requirements and the Best show/debug Commands Table end.|Table 21-4 OSPF Neighbor Requirements and the Best show/debug Commands Table end.
|
The rest of this section looks at some of the items from Table 21-3 in a little more detail.|The rest of this section looks at some of the items from Table 21-3 in a little more detail.
|
NOTE One configuration choice that people sometimes think is an issue, but is not, is the process ID as defined by the router ospf process-id command.|NOTE One configuration choice that people sometimes think is an issue, but is not, is the process ID as defined by the router ospf process-id command.
Neighboring routers can use the same process ID values, or different process ID values, with no impact on whether two routers become OSPF neighbors.|Neighboring routers can use the same process ID values, or different process ID values, with no impact on whether two routers become OSPF neighbors.
#### Issues That Prevent Neighbor Adjacencies
Issues That Prevent Neighbor Adjacencies   
__|__
--|--
|
The next few pages look at three of the topics from Table 21-3 for which, if a problem exists, the router does not become a neighbor (that is, the unshaded parts of the table.).|The next few pages look at three of the topics from Table 21-3 for which, if a problem exists, the router does not become a neighbor (that is, the unshaded parts of the table.).
To show the issues, this section uses the same topology shown earlier in Figure 21-1 but now with some incorrect configuration introduced.|To show the issues, this section uses the same topology shown earlier in Figure 21-1 but now with some incorrect configuration introduced.
In other words, the configuration matches Example 21-1 that began this chapter, but with the following errors introduced:|In other words, the configuration matches Example 21-1 that began this chapter, but with the following errors introduced:
###### R2 has been configured with both LAN interfaces in area 1, whereas the other three routers’
R2 has been configured with both LAN interfaces in area 1, whereas the other three routers’   
__|__
--|--
|
G0/0 interfaces are assigned to area 0.|G0/0 interfaces are assigned to area 0.
###### R3 is using the same RID (1.1.1.1) as R1.
R3 is using the same RID (1.1.1.1) as R1.   
###### R4 has been configured with a Hello/dead timer of 5/20 on its G0/0 interface, instead of
R4 has been configured with a Hello/dead timer of 5/20 on its G0/0 interface, instead of   
__|__
--|--
|
the 10/40 used (by default) on R1, R2, and R3.|the 10/40 used (by default) on R1, R2, and R3.
|
Figure 21-4 shows these same problems for reference.|Figure 21-4 shows these same problems for reference.
|
Figure 21-4 Summary of Problems That Prevent OSPF Neighbors on the Central LAN|Figure 21-4 Summary of Problems That Prevent OSPF Neighbors on the Central LAN
##### Finding Area Mismatches
Finding Area Mismatches   
__|__
--|--
|
To create an area mismatch, the configuration on some router must place the interface into the wrong area per the design.|To create an area mismatch, the configuration on some router must place the interface into the wrong area per the design.
As shown in Figure 21-4, router R2 was configured incorrectly, placing both its interfaces into area 1 instead of area 0.|As shown in Figure 21-4, router R2 was configured incorrectly, placing both its interfaces into area 1 instead of area 0.
Example 21-9 shows the configuration, which uses the correct syntax (and is therefore accepted by the router) but sets the wrong area number.|Example 21-9 shows the configuration, which uses the correct syntax (and is therefore accepted by the router) but sets the wrong area number.
|
Example 21-9 Setting Area 1 on R2’s Interfaces, When They Should Be in Area 0 Example end.|Example 21-9 Setting Area 1 on R2’s Interfaces, When They Should Be in Area 0 Example end.
|
With an area mismatch error, the show ip ospf neighbor command will not list the neighbor.|With an area mismatch error, the show ip ospf neighbor command will not list the neighbor.
|
Because you see nothing in the OSPF neighbor table, to troubleshoot this problem, you need to find the area configuration on each interface on potentially neighboring routers.|Because you see nothing in the OSPF neighbor table, to troubleshoot this problem, you need to find the area configuration on each interface on potentially neighboring routers.
To do so:|To do so:
###### Check the output of show running-config to look for
Check the output of show running-config to look for   
###### ip ospf process-id area area-number interface subcommands
ip ospf process-id area area-number interface subcommands   
###### network commands in OSPF configuration mode
network commands in OSPF configuration mode   
###### Use the show ip ospf interface [brief] command to list the area number
Use the show ip ospf interface [brief] command to list the area number   
##### Finding Duplicate OSPF Router IDs
Finding Duplicate OSPF Router IDs   
__|__
--|--
|
Next, Example 21-10 shows R1 and R3 both trying to use RID 1.1.1.1.|Next, Example 21-10 shows R1 and R3 both trying to use RID 1.1.1.1.
Interestingly, both routers automatically generate a log message for the duplicate OSPF RID problem between R1 and R3; the end of Example 21-10 shows one such message.|Interestingly, both routers automatically generate a log message for the duplicate OSPF RID problem between R1 and R3; the end of Example 21-10 shows one such message.
For the exams, just use the show ip ospf commands on both R3 and R1 to easily list the RID on each router, noting that they both use the same value.|For the exams, just use the show ip ospf commands on both R3 and R1 to easily list the RID on each router, noting that they both use the same value.
|
Example 21-10 Comparing OSPF Router IDs on R1 and R3 Example end.|Example 21-10 Comparing OSPF Router IDs on R1 and R3 Example end.
|
First, focus on the problem: the duplicate RIDs. The first line of the show ip ospf command on the two routers quickly shows the duplicate use of 1.1.1.1.|First, focus on the problem: the duplicate RIDs. The first line of the show ip ospf command on the two routers quickly shows the duplicate use of 1.1.1.1.
To solve the problem, assuming R1 should use 1.1.1.1 and R3 should use another RID (maybe 3.3.3.3), change the RID on R3 and restart the OSPF process.|To solve the problem, assuming R1 should use 1.1.1.1 and R3 should use another RID (maybe 3.3.3.3), change the RID on R3 and restart the OSPF process.
To do so, use the router-id 3.3.3.3 OSPF subcommand and use the EXEC mode command clear ip ospf process. (OSPF will not begin using a new RID value until the process restarts, either via command or reload.)|To do so, use the router-id 3.3.3.3 OSPF subcommand and use the EXEC mode command clear ip ospf process. (OSPF will not begin using a new RID value until the process restarts, either via command or reload.)
##### Finding OSPF Hello and Dead Timer Mismatches
Finding OSPF Hello and Dead Timer Mismatches   
__|__
--|--
|
First, as a reminder from chapters past:|First, as a reminder from chapters past:
###### Hello interval/timer: The per-interface timer that tells a router how often to send OSPF
Hello interval/timer: The per-interface timer that tells a router how often to send OSPF   
__|__
--|--
|
Hello messages on an interface.|Hello messages on an interface.
###### Dead interval/timer: The per-interface timer that tells the router how long to wait without
Dead interval/timer: The per-interface timer that tells the router how long to wait without   
__|__
--|--
|
having received a Hello from a neighbor before believing that neighbor has failed.|having received a Hello from a neighbor before believing that neighbor has failed.
|
(Defaults to four times the Hello timer.)|(Defaults to four times the Hello timer.)
|
Next, consider the problem created on R4, with the configuration of a different Hello timer and dead timer (5 and 20, respectively) as compared with the default settings on R1, R2, and R3 (10 and 40, respectively).|Next, consider the problem created on R4, with the configuration of a different Hello timer and dead timer (5 and 20, respectively) as compared with the default settings on R1, R2, and R3 (10 and 40, respectively).
A Hello or Dead interval mismatch prevents R4 from becoming neighbors with any of the other three OSPF routers.|A Hello or Dead interval mismatch prevents R4 from becoming neighbors with any of the other three OSPF routers.
Routers list their Hello and Dead interval settings in their Hello messages and choose to not become neighbors if the values do not match.|Routers list their Hello and Dead interval settings in their Hello messages and choose to not become neighbors if the values do not match.
As a result, none of the routers become neighbors with router R4 in this case.|As a result, none of the routers become neighbors with router R4 in this case.
|
Example 21-11 shows the easiest way to find the mismatch using the show ip ospf interface command on both R1 and R4. This command lists the Hello and dead timers for each interface, as highlighted in the example.|Example 21-11 shows the easiest way to find the mismatch using the show ip ospf interface command on both R1 and R4. This command lists the Hello and dead timers for each interface, as highlighted in the example.
Note that R1 uses 10 and 40 (Hello and dead), whereas R4 uses 5 and 20.|Note that R1 uses 10 and 40 (Hello and dead), whereas R4 uses 5 and 20.
|
Example 21-11 Finding Mismatched Hello/Dead Timers Example end.|Example 21-11 Finding Mismatched Hello/Dead Timers Example end.
##### Shutting Down the OSPF Process
Shutting Down the OSPF Process   
__|__
--|--
|
Similar to administratively disabling and enabling an interface, IOS also allows the OSPFv2 routing protocol process to be disabled and enabled with the shutdown and no shutdown router mode subcommands, respectively.|Similar to administratively disabling and enabling an interface, IOS also allows the OSPFv2 routing protocol process to be disabled and enabled with the shutdown and no shutdown router mode subcommands, respectively.
When a routing protocol process is shut down, IOS does the following:|When a routing protocol process is shut down, IOS does the following:
###### Brings down all neighbor relationships and clears the OSPF neighbor table
Brings down all neighbor relationships and clears the OSPF neighbor table   
###### Clears the LSDB
Clears the LSDB   
###### Clears the IP routing table of any OSPF-learned routes
Clears the IP routing table of any OSPF-learned routes   
__|__
--|--
|
At the same time, shutting down OSPF does retain some important details about OSPF, in particular:|At the same time, shutting down OSPF does retain some important details about OSPF, in particular:
###### IOS retains all OSPF configuration.
IOS retains all OSPF configuration.   
###### IOS still lists all OSPF-enabled interfaces in the OSPF interface list (show ip ospf
IOS still lists all OSPF-enabled interfaces in the OSPF interface list (show ip ospf   
__|__
--|--
|
interface) but in a DOWN state.|interface) but in a DOWN state.
|
Basically, shutting down the OSPF routing protocol process gives the network engineer a way to stop using the routing protocol on that router without having to remove all the configuration.|Basically, shutting down the OSPF routing protocol process gives the network engineer a way to stop using the routing protocol on that router without having to remove all the configuration.
Once shut down, the show ip ospf interface [brief] command should still list some output, as will the show ip ospf command, but the rest of the commands will list nothing.|Once shut down, the show ip ospf interface [brief] command should still list some output, as will the show ip ospf command, but the rest of the commands will list nothing.
|
Example 21-12 shows an example on Router R5, as shown in Figure 21-5.|Example 21-12 shows an example on Router R5, as shown in Figure 21-5.
R5 is a different router than the one used in earlier examples, but it begins the example with two OSPF neighbors, R2 and R3, with router IDs 2.2.2.2 and 3.3.3.3.|R5 is a different router than the one used in earlier examples, but it begins the example with two OSPF neighbors, R2 and R3, with router IDs 2.2.2.2 and 3.3.3.3.
The example shows the OSPF process being shut down, the neighbors failing, and those two key OSPF show commands:|The example shows the OSPF process being shut down, the neighbors failing, and those two key OSPF show commands:
|
show ip ospf neighbor and show ip ospf interface brief.|show ip ospf neighbor and show ip ospf interface brief.
|
Figure 21-5 Example Network to Demonstrate OSPF Process Shutdown Example 21-12 Shutting Down an OSPF Process, and the Resulting Neighbor States Example end.|Figure 21-5 Example Network to Demonstrate OSPF Process Shutdown Example 21-12 Shutting Down an OSPF Process, and the Resulting Neighbor States Example end.
|
First, before the shutdown, the show ip ospf neighbor command lists two neighbors.|First, before the shutdown, the show ip ospf neighbor command lists two neighbors.
|
After the shutdown, the same command lists no neighbors at all.|After the shutdown, the same command lists no neighbors at all.
Second, the show ip ospf interface brief command does list the interfaces on which OSPF is enabled, on the local router’s own IP addresses.|Second, the show ip ospf interface brief command does list the interfaces on which OSPF is enabled, on the local router’s own IP addresses.
However, it lists a state of DOWN, which is a reference to the local router’s state.|However, it lists a state of DOWN, which is a reference to the local router’s state.
Also, note that the show ip ospf command positively states that the OSPF process is in a shutdown state, while the show ip ospf database command output lists only a heading line, with no LSAs.|Also, note that the show ip ospf command positively states that the OSPF process is in a shutdown state, while the show ip ospf database command output lists only a heading line, with no LSAs.
#### Issues That Allow Adjacencies but Prevent IP Routes
Issues That Allow Adjacencies but Prevent IP Routes   
__|__
--|--
|
The last two issues to discuss in this section have a symptom in which the show ip ospf neighbor command does list a neighbor, but some other problem exists that prevents the eventual addition of OSPF routes to the routing table.|The last two issues to discuss in this section have a symptom in which the show ip ospf neighbor command does list a neighbor, but some other problem exists that prevents the eventual addition of OSPF routes to the routing table.
The two issues: a mismatched MTU setting and a mismatched OSPF network type.|The two issues: a mismatched MTU setting and a mismatched OSPF network type.
##### Mismatched MTU Settings
Mismatched MTU Settings   
__|__
--|--
|
The MTU size defines a per-interface setting used by the router for its Layer 3 forwarding logic, defining the largest network layer packet that the router will forward out each interface.|The MTU size defines a per-interface setting used by the router for its Layer 3 forwarding logic, defining the largest network layer packet that the router will forward out each interface.
|
For instance, the IPv4 MTU size of an interface defines the maximum size IPv4 packet that the router can forward out an interface.|For instance, the IPv4 MTU size of an interface defines the maximum size IPv4 packet that the router can forward out an interface.
|
Routers often use a default MTU size of 1500 bytes, with the ability to set the value as well.|Routers often use a default MTU size of 1500 bytes, with the ability to set the value as well.
|
The ip mtu size interface subcommand defines the IPv4 MTU setting, and the ipv6 mtu size command sets the equivalent for IPv6 packets.|The ip mtu size interface subcommand defines the IPv4 MTU setting, and the ipv6 mtu size command sets the equivalent for IPv6 packets.
|
In an odd twist, two OSPFv2 routers can actually become OSPF neighbors, be listed in the output of the show ip ospf neighbor command, and reach 2-way state, even if they happen to use different IPv4 MTU settings on their interfaces.|In an odd twist, two OSPFv2 routers can actually become OSPF neighbors, be listed in the output of the show ip ospf neighbor command, and reach 2-way state, even if they happen to use different IPv4 MTU settings on their interfaces.
However, they fail to exchange their LSDBs. Eventually, after trying and failing to exchange their LSDBs, the neighbor relationship also fails.|However, they fail to exchange their LSDBs. Eventually, after trying and failing to exchange their LSDBs, the neighbor relationship also fails.
So also keep a watch for MTU mismatches, although they may be unusual and obscure, by looking at the running-config and by using the show interfaces command (which lists the IP MTU).|So also keep a watch for MTU mismatches, although they may be unusual and obscure, by looking at the running-config and by using the show interfaces command (which lists the IP MTU).
##### Mismatched OSPF Network Types
Mismatched OSPF Network Types   
__|__
--|--
|
Earlier in this chapter you read about the OSPF broadcast network type, which uses a DR/BDR, and the OSPF point-to-point network type, which does not.|Earlier in this chapter you read about the OSPF broadcast network type, which uses a DR/BDR, and the OSPF point-to-point network type, which does not.
Interestingly, if you misconfigure network type settings such that one router uses broadcast, and the other uses point-to-point, the following occurs:|Interestingly, if you misconfigure network type settings such that one router uses broadcast, and the other uses point-to-point, the following occurs:
###### The two routers become fully adjacent neighbors (that is, they reach a full state).
The two routers become fully adjacent neighbors (that is, they reach a full state).   
###### They exchange their LSDBs.
They exchange their LSDBs.   
###### They do not add IP routes to the IP routing table.
They do not add IP routes to the IP routing table.   
__|__
--|--
|
The reason for not adding the routes has to do with the details of LSAs and how the use of a DR (or not) changes those LSAs. Basically, the two routers expect different details in the LSAs, and the SPF algorithm notices those differences and cannot trust the LSAs because of those differences.|The reason for not adding the routes has to do with the details of LSAs and how the use of a DR (or not) changes those LSAs. Basically, the two routers expect different details in the LSAs, and the SPF algorithm notices those differences and cannot trust the LSAs because of those differences.
|
For instance, earlier in Example 21-7, the configuration showed router R1 using network type point-to-point on its G0/0/0 interface, with the expectation that router R2 would also use point-to-point on its matching G0/1/0 interface.|For instance, earlier in Example 21-7, the configuration showed router R1 using network type point-to-point on its G0/0/0 interface, with the expectation that router R2 would also use point-to-point on its matching G0/1/0 interface.
Example 21-13 shows some of the results if the engineer neglected to configure R2, leaving it with the default setting of broadcast.|Example 21-13 shows some of the results if the engineer neglected to configure R2, leaving it with the default setting of broadcast.
|
Example 21-13 Shutting Down an OSPF Process, and the Resulting Neighbor States Example end.|Example 21-13 Shutting Down an OSPF Process, and the Resulting Neighbor States Example end.
|
As you can see, both routers list the other as an OSPF neighbor in the full state.|As you can see, both routers list the other as an OSPF neighbor in the full state.
However, R1, with network type point-to-point, does not list a DR or BDR role in the output, while R2 does, which is one clue for this type of problem.|However, R1, with network type point-to-point, does not list a DR or BDR role in the output, while R2 does, which is one clue for this type of problem.
The other comes with noticing that the expected routes are not in the IP routing table.|The other comes with noticing that the expected routes are not in the IP routing table.
### Chapter Review
Chapter Review   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|One key to doing well on the exams is to perform repetitive spaced review sessions.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.
Refer to the “Your Study Plan” element for more details.|Refer to the “Your Study Plan” element for more details.
Table 21-5 outlines the key review elements and where you can find them.|Table 21-5 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 21-5 Chapter Review Tracking Table end.|Table 21-5 Chapter Review Tracking Table end.
|
Review All the Key Topics Command References Tables 21-7 and 21-8 list configuration and verification commands used in this chapter.|Review All the Key Topics Command References Tables 21-7 and 21-8 list configuration and verification commands used in this chapter.
As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.|As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Then repeat the exercise, covering the right column, and try to recall what the command does.
|
Table 21-7 Chapter 21 Configuration Command Reference Table end.|Table 21-7 Chapter 21 Configuration Command Reference Table end.
|
Table 21-8 Chapter 21 show Command Reference Table end.|Table 21-8 Chapter 21 show Command Reference Table end.
|
Keep track of your part review progress with the checklist in Table P6-1.|Keep track of your part review progress with the checklist in Table P6-1.
Details about each task follow the table.|Details about each task follow the table.
|
Table P6-1 Part VI Part Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Do Labs Watch Videos Repeat All DIKTA Questions For this task, answer the “Do I Know This Already?” questions again for the chapters in this part of the book using the PTP software.|Table P6-1 Part VI Part Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Do Labs Watch Videos Repeat All DIKTA Questions For this task, answer the “Do I Know This Already?” questions again for the chapters in this part of the book using the PTP software.
See the section “How to View Only DIKTA Questions by Chapter or Part” in the Introduction to this book to learn how to make the PTP software show you DIKTA questions for this part only.|See the section “How to View Only DIKTA Questions by Chapter or Part” in the Introduction to this book to learn how to make the PTP software show you DIKTA questions for this part only.
|
Answer Part Review Questions For this task, answer the Part Review questions for this part of the book using the PTP software.|Answer Part Review Questions For this task, answer the Part Review questions for this part of the book using the PTP software.
See the section “How to View Part Review Questions” in the Introduction to this book to learn how to make the PTP software show you Part Review questions for this part only.|See the section “How to View Part Review Questions” in the Introduction to this book to learn how to make the PTP software show you Part Review questions for this part only.
|
Review Key Topics Review all Key Topics in all chapters in this part, either by browsing the chapters or by using the Key Topics application on the companion website.|Review Key Topics Review all Key Topics in all chapters in this part, either by browsing the chapters or by using the Key Topics application on the companion website.
|
Do Labs Depending on your chosen lab tool, here are some suggestions for what to do in lab:|Do Labs Depending on your chosen lab tool, here are some suggestions for what to do in lab:
|
Pearson Network Simulator: If you use the full Pearson ICND1 or CCNA simulator, focus more on the configuration scenario and troubleshooting scenario labs associated with the topics in this part of the book.|Pearson Network Simulator: If you use the full Pearson ICND1 or CCNA simulator, focus more on the configuration scenario and troubleshooting scenario labs associated with the topics in this part of the book.
These types of labs include a larger set of topics and work well as Part Review activities. (See the Introduction for some details about how to find which labs are about topics in this part of the book.)|These types of labs include a larger set of topics and work well as Part Review activities. (See the Introduction for some details about how to find which labs are about topics in this part of the book.)
|
Blog: Config Labs: The author’s blog includes a series of configuration-focused labs that you can do on paper, each in 10–15 minutes.|Blog: Config Labs: The author’s blog includes a series of configuration-focused labs that you can do on paper, each in 10–15 minutes.
Review and perform the labs for this part of the book, as found at http://blog.certskills.com.|Review and perform the labs for this part of the book, as found at http://blog.certskills.com.
Then navigate to the Hands-on Config labs.|Then navigate to the Hands-on Config labs.
## Part VI Review
Part VI Review   
__|__
--|--
|
Other: If using other lab tools, here are a few suggestions: Make sure to experiment heavily with VLAN configuration and VLAN trunking configuration.|Other: If using other lab tools, here are a few suggestions: Make sure to experiment heavily with VLAN configuration and VLAN trunking configuration.
|
Watch Videos Chapter 21 recommends one video from the companion website about troubleshooting OSPF neighbors.|Watch Videos Chapter 21 recommends one video from the companion website about troubleshooting OSPF neighbors.
Take a few minutes to watch the video if you haven’t done so already.|Take a few minutes to watch the video if you haven’t done so already.
|
So far, this book has mostly ignored IP version 6 (IPv6).|So far, this book has mostly ignored IP version 6 (IPv6).
This part reverses the trend, collecting all the specific IPv6 topics into four chapters.|This part reverses the trend, collecting all the specific IPv6 topics into four chapters.
|
The chapters in Part VII walk you through the same topics discussed throughout this book for IPv4, often using IPv4 as a point of comparison.|The chapters in Part VII walk you through the same topics discussed throughout this book for IPv4, often using IPv4 as a point of comparison.
Certainly, many details differ when comparing IPv4 and IPv6.|Certainly, many details differ when comparing IPv4 and IPv6.
However, many core concepts about IP addressing, subnetting, routing, and routing protocols remain the same.|However, many core concepts about IP addressing, subnetting, routing, and routing protocols remain the same.
The chapters in this part build on those foundational concepts, adding the specific details about how IPv6 forwards IPv6 packets from one host to another.|The chapters in this part build on those foundational concepts, adding the specific details about how IPv6 forwards IPv6 packets from one host to another.
## Part VII IP Version 6
Part VII IP Version 6   
__|__
--|--
|
Part VII Review|Part VII Review
## Chapter 22 Fundamentals of IP Version 6
Chapter 22 Fundamentals of IP Version 6   
__|__
--|--
|
This chapter covers the following exam topics:|This chapter covers the following exam topics:
###### 1.0 Network Fundamentals
1.0 Network Fundamentals   
###### 1.8 Configure and verify IPv6 addressing and prefix
1.8 Configure and verify IPv6 addressing and prefix   
__|__
--|--
|
IPv4 has been a solid and highly useful part of the growth of TCP/IP and the Internet.|IPv4 has been a solid and highly useful part of the growth of TCP/IP and the Internet.
For most of the long history of the Internet, and for most corporate networks that use TCP/IP, IPv4 is the core protocol that defines addressing and routing.|For most of the long history of the Internet, and for most corporate networks that use TCP/IP, IPv4 is the core protocol that defines addressing and routing.
However, even though IPv4 has many great qualities, it does have some shortcomings, creating the need for a replacement protocol: IP version 6 (IPv6).|However, even though IPv4 has many great qualities, it does have some shortcomings, creating the need for a replacement protocol: IP version 6 (IPv6).
|
IPv6 defines the same general functions as IPv4, but with different methods of implementing those functions.|IPv6 defines the same general functions as IPv4, but with different methods of implementing those functions.
For example, both IPv4 and IPv6 define addressing, the concepts of subnetting larger groups of addresses into smaller groups, headers used to create an IPv4 or IPv6 packet, and the rules for routing those packets.|For example, both IPv4 and IPv6 define addressing, the concepts of subnetting larger groups of addresses into smaller groups, headers used to create an IPv4 or IPv6 packet, and the rules for routing those packets.
At the same time, IPv6 handles the details differently; for example, using a 128-bit IPv6 address rather than the 32-bit IPv4 address.|At the same time, IPv6 handles the details differently; for example, using a 128-bit IPv6 address rather than the 32-bit IPv4 address.
|
This chapter focuses on the core network layer functions of addressing and routing.|This chapter focuses on the core network layer functions of addressing and routing.
The first section of this chapter looks at the big concepts, while the second section looks at the specifics of how to write and type IPv6 addresses.|The first section of this chapter looks at the big concepts, while the second section looks at the specifics of how to write and type IPv6 addresses.
### “Do I Know This Already?” Quiz
“Do I Know This Already?” Quiz   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.
The letter answers are listed at the bottom of the page following the quiz.|The letter answers are listed at the bottom of the page following the quiz.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.
You can also find both answers and explanations in the PTP testing software.|You can also find both answers and explanations in the PTP testing software.
|
Table 22-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Table 22-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping
### Foundation Topics
Foundation Topics   
### Introduction to IPv6
Introduction to IPv6   
__|__
--|--
|
IPv6 Addressing Formats and Conventions 3–6 1.|IPv6 Addressing Formats and Conventions 3–6 1.
Which of the following was a short-term solution to the IPv4 address exhaustion problem?|Which of the following was a short-term solution to the IPv4 address exhaustion problem?
|
a. IP version 6 b.|a. IP version 6 b.
IP version 5 c.|IP version 5 c.
NAT/PAT d.|NAT/PAT d.
ARP CHAPTER 22 2.|ARP CHAPTER 22 2.
A router receives an Ethernet frame that holds an IPv6 packet.|A router receives an Ethernet frame that holds an IPv6 packet.
The router then makes a decision to route the packet out a serial link.|The router then makes a decision to route the packet out a serial link.
Which of the following statements is true about how a router forwards an IPv6 packet?|Which of the following statements is true about how a router forwards an IPv6 packet?
|
a. The router discards the Ethernet data-link header and trailer of the received frame.|a. The router discards the Ethernet data-link header and trailer of the received frame.
|
b. The router makes the forwarding decision based on the packet’s source IPv6 address.|b. The router makes the forwarding decision based on the packet’s source IPv6 address.
|
c. The router keeps the Ethernet header, encapsulating the entire frame inside a new IPv6 packet before sending it over the serial link.|c. The router keeps the Ethernet header, encapsulating the entire frame inside a new IPv6 packet before sending it over the serial link.
|
d. The router uses the IPv4 routing table when choosing where to forward the packet.|d. The router uses the IPv4 routing table when choosing where to forward the packet.
|
3. Which of the following is the shortest valid abbreviation for FE80:0000:0000:0100:|3. Which of the following is the shortest valid abbreviation for FE80:0000:0000:0100:
|
0000:0000:0000:0123?|0000:0000:0000:0123?
|
a. FE80::100::123 b.|a. FE80::100::123 b.
FE8::1::123 c.|FE8::1::123 c.
FE80::100:0:0:0:123:4567 d.|FE80::100:0:0:0:123:4567 d.
FE80:0:0:100::123 4.|FE80:0:0:100::123 4.
Which of the following is the shortest valid abbreviation for 2000:0300:0040:0005:|Which of the following is the shortest valid abbreviation for 2000:0300:0040:0005:
|
6000:0700:0080:0009?|6000:0700:0080:0009?
|
a. 2:3:4:5:6:7:8:9 b. 2000:300:40:5:6000:700:80:9 c. 2000:300:4:5:6000:700:8:9 d. 2000:3:4:5:6:7:8:9 5.|a. 2:3:4:5:6:7:8:9 b. 2000:300:40:5:6000:700:80:9 c. 2000:300:4:5:6000:700:8:9 d. 2000:3:4:5:6:7:8:9 5.
Which of the following is the unabbreviated version of IPv6 address 2001:DB8::200:28?|Which of the following is the unabbreviated version of IPv6 address 2001:DB8::200:28?
|
a. 2001:0DB8:0000:0000:0000:0000:0200:0028 b. 2001:0DB8::0200:0028 c. 2001:0DB8:0:0:0:0:0200:0028 d. 2001:0DB8:0000:0000:0000:0000:200:0028 6.|a. 2001:0DB8:0000:0000:0000:0000:0200:0028 b. 2001:0DB8::0200:0028 c. 2001:0DB8:0:0:0:0:0200:0028 d. 2001:0DB8:0000:0000:0000:0000:200:0028 6.
Which of the following is the prefix for address 2000:0000:0000:0005:6000:0700:|Which of the following is the prefix for address 2000:0000:0000:0005:6000:0700:
|
0080:0009, assuming a mask of /64?|0080:0009, assuming a mask of /64?
|
a. 2000::5::/64 b. 2000::5:0:0:0:0/64 c. 2000:0:0:5::/64 d. 2000:0:0:5:0:0:0:0/64 Foundation Topics Introduction to IPv6 IP version 6 (IPv6) serves as the replacement protocol for IP version 4 (IPv4).|a. 2000::5::/64 b. 2000::5:0:0:0:0/64 c. 2000:0:0:5::/64 d. 2000:0:0:5:0:0:0:0/64 Foundation Topics Introduction to IPv6 IP version 6 (IPv6) serves as the replacement protocol for IP version 4 (IPv4).
|
Unfortunately, that one bold statement creates more questions than it answers.|Unfortunately, that one bold statement creates more questions than it answers.
Why does IPv4 need to be replaced?|Why does IPv4 need to be replaced?
If IPv4 needs to be replaced, when will that happen—and will it happen quickly?|If IPv4 needs to be replaced, when will that happen—and will it happen quickly?
What exactly happens when a company or the Internet replaces IPv4 with IPv6?|What exactly happens when a company or the Internet replaces IPv4 with IPv6?
And the list goes on.|And the list goes on.
|
While this introductory chapter cannot get into every detail of why IPv4 needs to eventually be replaced by IPv6, the clearest and most obvious reason for migrating TCP/IP networks to use IPv6 is growth.|While this introductory chapter cannot get into every detail of why IPv4 needs to eventually be replaced by IPv6, the clearest and most obvious reason for migrating TCP/IP networks to use IPv6 is growth.
IPv4 uses a 32-bit address, which totals to a few billion addresses.|IPv4 uses a 32-bit address, which totals to a few billion addresses.
|
Interestingly, that seemingly large number of addresses is too small.|Interestingly, that seemingly large number of addresses is too small.
IPv6 increases the address to 128 bits in length.|IPv6 increases the address to 128 bits in length.
For perspective, IPv6 supplies more than 10,000,000,000,000,000,000,000,000,000 times as many addresses as IPv4.|For perspective, IPv6 supplies more than 10,000,000,000,000,000,000,000,000,000 times as many addresses as IPv4.
|
The fact that IPv6 uses a different size address field, with some different addressing rules, means that many other protocols and functions change as well.|The fact that IPv6 uses a different size address field, with some different addressing rules, means that many other protocols and functions change as well.
For example, IPv4 routing—in other words, the packet-forwarding process—relies on an understanding of IPv4 addresses.|For example, IPv4 routing—in other words, the packet-forwarding process—relies on an understanding of IPv4 addresses.
|
To support IPv6 routing, routers must understand IPv6 addresses and routing.|To support IPv6 routing, routers must understand IPv6 addresses and routing.
To dynamically learn routes for IPv6 subnets, routing protocols must support these different IPv6 addressing rules, including rules about how IPv6 creates subnets.|To dynamically learn routes for IPv6 subnets, routing protocols must support these different IPv6 addressing rules, including rules about how IPv6 creates subnets.
As a result, the migration from IPv4 to IPv6 is much more than changing one protocol (IP), but it impacts many protocols.|As a result, the migration from IPv4 to IPv6 is much more than changing one protocol (IP), but it impacts many protocols.
|
This first section of the chapter discusses some of the reasons for the change from IPv4 to IPv6, along with the protocols that must change as a result.|This first section of the chapter discusses some of the reasons for the change from IPv4 to IPv6, along with the protocols that must change as a result.
#### The Historical Reasons for IPv6
The Historical Reasons for IPv6   
__|__
--|--
|
In the last 40+ years, the Internet has gone from its infancy to being a huge influence in the world.|In the last 40+ years, the Internet has gone from its infancy to being a huge influence in the world.
It first grew through research at universities, from the ARPANET beginnings of the Internet in the late 1960s into the 1970s.|It first grew through research at universities, from the ARPANET beginnings of the Internet in the late 1960s into the 1970s.
The Internet kept growing fast in the 1980s, with the Internet’s fast growth still primarily driven by research and the universities that joined in that research.|The Internet kept growing fast in the 1980s, with the Internet’s fast growth still primarily driven by research and the universities that joined in that research.
By the early 1990s, the Internet began to transform to allow commerce, allowing people to sell services and products over the Internet, which drove yet another steep spike upward in the growth of the Internet.|By the early 1990s, the Internet began to transform to allow commerce, allowing people to sell services and products over the Internet, which drove yet another steep spike upward in the growth of the Internet.
Eventually, fixed Internet access (primarily through dial, digital subscriber line [DSL], and cable) became common, followed by the pervasive use of the Internet from mobile devices like smartphones.|Eventually, fixed Internet access (primarily through dial, digital subscriber line [DSL], and cable) became common, followed by the pervasive use of the Internet from mobile devices like smartphones.
Figure 22-1 shows some of these major milestones with general dates.|Figure 22-1 shows some of these major milestones with general dates.
|
The incredible growth of the Internet over a fairly long time created a big problem for public IPv4 addresses: the world was running out of addresses.|The incredible growth of the Internet over a fairly long time created a big problem for public IPv4 addresses: the world was running out of addresses.
For instance, in 2011, IANA allocated the final /8 address blocks (the same size as a Class A network), allocating one final /8 block to each of the five Regional Internet Registries (RIR). At that point, RIRs could no Answers to the “Do I Know This Already?” quiz:|For instance, in 2011, IANA allocated the final /8 address blocks (the same size as a Class A network), allocating one final /8 block to each of the five Regional Internet Registries (RIR). At that point, RIRs could no Answers to the “Do I Know This Already?” quiz:
|
1 C 2 A 3 D 4 B 5 A 6 C longer receive new allocations of public addresses from IANA to then turn around and assign smaller address blocks to companies or ISPs.|1 C 2 A 3 D 4 B 5 A 6 C longer receive new allocations of public addresses from IANA to then turn around and assign smaller address blocks to companies or ISPs.
|
Figure 22-1 Some Major Events in the Growth of the Internet At that point in 2011, each of the five RIRs still had public addresses to allocate or assign.|Figure 22-1 Some Major Events in the Growth of the Internet At that point in 2011, each of the five RIRs still had public addresses to allocate or assign.
|
However, that same year, APNIC (Asia Pacific) became the first RIR to exhaust its available IPv4 address allocation.|However, that same year, APNIC (Asia Pacific) became the first RIR to exhaust its available IPv4 address allocation.
In late 2015, ARIN (North America) announced that it had exhausted its supply.|In late 2015, ARIN (North America) announced that it had exhausted its supply.
When we were revising this chapter in 2019, IANA considered all RIRs except AFRINIC to have exhausted their supply of IPv4 addresses, with AFRINIC expected to run out of IPv4 address during the year 2019.|When we were revising this chapter in 2019, IANA considered all RIRs except AFRINIC to have exhausted their supply of IPv4 addresses, with AFRINIC expected to run out of IPv4 address during the year 2019.
|
These events are significant in that the day has finally come in which new companies can attempt to connect to the Internet, but they can no longer simply use IPv4, ignoring IPv6.|These events are significant in that the day has finally come in which new companies can attempt to connect to the Internet, but they can no longer simply use IPv4, ignoring IPv6.
|
Their only option will be IPv6 because IPv4 has no public addresses left.|Their only option will be IPv6 because IPv4 has no public addresses left.
|
NOTE You can track ARIN’s progress through this interesting transition in the history of the Internet at its IPv4 address depletion site: http://teamarin.net/category/ipv4-depletion/.|NOTE You can track ARIN’s progress through this interesting transition in the history of the Internet at its IPv4 address depletion site: http://teamarin.net/category/ipv4-depletion/.
|
You can also see a summary report at http://ipv4.potaroo.net.|You can also see a summary report at http://ipv4.potaroo.net.
|
Even though the press has rightfully made a big deal about running out of IPv4 addresses, those who care about the Internet knew about this potential problem since the late 1980s.|Even though the press has rightfully made a big deal about running out of IPv4 addresses, those who care about the Internet knew about this potential problem since the late 1980s.
|
The problem, generally called the IPv4 address exhaustion problem, could literally have caused the huge growth of the Internet in the 1990s to have come to a screeching halt!|The problem, generally called the IPv4 address exhaustion problem, could literally have caused the huge growth of the Internet in the 1990s to have come to a screeching halt!
|
Something had to be done.|Something had to be done.
|
The IETF came up with several short-term solutions to make IPv4 addresses last longer, and one long-term solution: IPv6.|The IETF came up with several short-term solutions to make IPv4 addresses last longer, and one long-term solution: IPv6.
However, several other tools like Network Address Translation (NAT) and classless interdomain routing (CIDR) helped extend IPv4’s life another couple of decades.|However, several other tools like Network Address Translation (NAT) and classless interdomain routing (CIDR) helped extend IPv4’s life another couple of decades.
IPv6 creates a more permanent and long-lasting solution, replacing IPv4, with a new IPv6 header and new IPv6 addresses.|IPv6 creates a more permanent and long-lasting solution, replacing IPv4, with a new IPv6 header and new IPv6 addresses.
The address size supports a huge number of addresses, solving the address shortage problem for generations (we hope).|The address size supports a huge number of addresses, solving the address shortage problem for generations (we hope).
Figure 22-2 shows some of the major address exhaustion timing.|Figure 22-2 shows some of the major address exhaustion timing.
|
The rest of this first section examines IPv6, comparing it to IPv4, focusing on the common features of the two protocols.|The rest of this first section examines IPv6, comparing it to IPv4, focusing on the common features of the two protocols.
In particular, this section compares the protocols (including addresses), routing, routing protocols, and miscellaneous other related topics.|In particular, this section compares the protocols (including addresses), routing, routing protocols, and miscellaneous other related topics.
|
NOTE You might wonder why the next version of IP is not called IP version 5.|NOTE You might wonder why the next version of IP is not called IP version 5.
There was an earlier effort to create a new version of IP, and it was numbered version 5.|There was an earlier effort to create a new version of IP, and it was numbered version 5.
IPv5 did not progress to the standards stage.|IPv5 did not progress to the standards stage.
However, to prevent any issues, because version 5 had been used in some documents, the next effort to update IP was numbered as version 6.|However, to prevent any issues, because version 5 had been used in some documents, the next effort to update IP was numbered as version 6.
|
Figure 22-2 Timeline for IPv4 Address Exhaustion and Short-/Long-Term Solutions|Figure 22-2 Timeline for IPv4 Address Exhaustion and Short-/Long-Term Solutions
#### The IPv6 Protocols
The IPv6 Protocols   
__|__
--|--
|
The primary purpose of the core IPv6 protocol mirrors the same purpose of the IPv4 protocol.|The primary purpose of the core IPv6 protocol mirrors the same purpose of the IPv4 protocol.
|
That core IPv6 protocol, as defined in RFC 2460, defines a packet concept, addresses for those packets, and the role of hosts and routers.|That core IPv6 protocol, as defined in RFC 2460, defines a packet concept, addresses for those packets, and the role of hosts and routers.
These rules allow the devices to forward packets sourced by hosts, through multiple routers, so that they arrive at the correct destination host. (IPv4 defines those same concepts for IPv4 back in RFC 791.)|These rules allow the devices to forward packets sourced by hosts, through multiple routers, so that they arrive at the correct destination host. (IPv4 defines those same concepts for IPv4 back in RFC 791.)
|
However, because IPv6 impacts so many other functions in a TCP/IP network, many more RFCs must define details of IPv6.|However, because IPv6 impacts so many other functions in a TCP/IP network, many more RFCs must define details of IPv6.
Some other RFCs define how to migrate from IPv4 to IPv6.|Some other RFCs define how to migrate from IPv4 to IPv6.
Others define new versions of familiar protocols or replace old protocols with new ones.|Others define new versions of familiar protocols or replace old protocols with new ones.
For example:|For example:
|
Older OSPF Version 2 Upgraded to OSPF Version 3: The older Open Shortest Path First (OSPF) version 2 works for IPv4, but not for IPv6, so a newer version, OSPF version 3, was created to support IPv6. (Note: OSPFv3 was later upgraded to support advertising both IPv4 and IPv6 routes.)|Older OSPF Version 2 Upgraded to OSPF Version 3: The older Open Shortest Path First (OSPF) version 2 works for IPv4, but not for IPv6, so a newer version, OSPF version 3, was created to support IPv6. (Note: OSPFv3 was later upgraded to support advertising both IPv4 and IPv6 routes.)
|
ICMP Upgraded to ICMP Version 6: Internet Control Message Protocol (ICMP) worked well with IPv4 but needed to be changed to support IPv6.|ICMP Upgraded to ICMP Version 6: Internet Control Message Protocol (ICMP) worked well with IPv4 but needed to be changed to support IPv6.
The new name is ICMPv6.|The new name is ICMPv6.
|
ARP Replaced by Neighbor Discovery Protocol: For IPv4, Address Resolution Protocol (ARP) discovers the MAC address used by neighbors.|ARP Replaced by Neighbor Discovery Protocol: For IPv4, Address Resolution Protocol (ARP) discovers the MAC address used by neighbors.
IPv6 replaces ARP with a more general Neighbor Discovery Protocol (NDP).|IPv6 replaces ARP with a more general Neighbor Discovery Protocol (NDP).
|
NOTE If you go to any website that lists the RFCs, like http://www.rfc-editor.org, you can find almost 300 RFCs that have IPv6 in the title.|NOTE If you go to any website that lists the RFCs, like http://www.rfc-editor.org, you can find almost 300 RFCs that have IPv6 in the title.
|
Although the term IPv6, when used broadly, includes many protocols, the one specific protocol called IPv6 defines the new 128-bit IPv6 address.|Although the term IPv6, when used broadly, includes many protocols, the one specific protocol called IPv6 defines the new 128-bit IPv6 address.
Of course, writing these addresses in binary would be a problem—they probably would not even fit on the width of a piece of paper!|Of course, writing these addresses in binary would be a problem—they probably would not even fit on the width of a piece of paper!
IPv6 defines a shorter hexadecimal format, requiring at most 32 hexadecimal digits (one hex digit per 4 bits), with methods to abbreviate the hexadecimal addresses as well.|IPv6 defines a shorter hexadecimal format, requiring at most 32 hexadecimal digits (one hex digit per 4 bits), with methods to abbreviate the hexadecimal addresses as well.
|
For example, all of the following are IPv6 addresses, each with 32 or fewer hex digits:|For example, all of the following are IPv6 addresses, each with 32 or fewer hex digits:
|
2345:1111:2222:3333:4444:5555:6666:AAAA 2000:1:2:3:4:5:6:A FE80::1 The upcoming section “IPv6 Addressing Formats and Conventions” discusses the specifics of how to represent IPv6 addresses, including how to legally abbreviate the hex address values.|2345:1111:2222:3333:4444:5555:6666:AAAA 2000:1:2:3:4:5:6:A FE80::1 The upcoming section “IPv6 Addressing Formats and Conventions” discusses the specifics of how to represent IPv6 addresses, including how to legally abbreviate the hex address values.
|
Like IPv4, IPv6 defines a header, with places to hold both the source and destination address fields.|Like IPv4, IPv6 defines a header, with places to hold both the source and destination address fields.
Compared to IPv4, the IPv6 header does make some other changes besides simply making the address fields larger.|Compared to IPv4, the IPv6 header does make some other changes besides simply making the address fields larger.
However, even though the IPv6 header is larger than an IPv4 header, the IPv6 header is actually simpler (on purpose), to reduce the work done each time a router must route an IPv6 packet.|However, even though the IPv6 header is larger than an IPv4 header, the IPv6 header is actually simpler (on purpose), to reduce the work done each time a router must route an IPv6 packet.
Figure 22-3 shows the required 40-byte part of the IPv6 header.|Figure 22-3 shows the required 40-byte part of the IPv6 header.
|
Figure 22-3 IPv6 Header|Figure 22-3 IPv6 Header
#### IPv6 Routing
IPv6 Routing   
__|__
--|--
|
As with many functions of IPv6, IPv6 routing looks just like IPv4 routing from a general perspective, with the differences being clear only once you look at the specifics.|As with many functions of IPv6, IPv6 routing looks just like IPv4 routing from a general perspective, with the differences being clear only once you look at the specifics.
Keeping the discussion general for now, IPv6 uses these ideas the same way as IPv4:|Keeping the discussion general for now, IPv6 uses these ideas the same way as IPv4:
###### To be able to build and send IPv6 packets out an interface, end-user devices need an IPv6
To be able to build and send IPv6 packets out an interface, end-user devices need an IPv6   
__|__
--|--
|
address on that interface.|address on that interface.
###### End-user hosts need to know the IPv6 address of a default router, to which the host sends
End-user hosts need to know the IPv6 address of a default router, to which the host sends   
__|__
--|--
|
IPv6 packets if the host is in a different subnet.|IPv6 packets if the host is in a different subnet.
###### IPv6 routers de-encapsulate and re-encapsulate each IPv6 packet when routing the packet.
IPv6 routers de-encapsulate and re-encapsulate each IPv6 packet when routing the packet.   
###### IPv6 routers make routing decisions by comparing the IPv6 packet’s destination address
IPv6 routers make routing decisions by comparing the IPv6 packet’s destination address   
__|__
--|--
|
to the router’s IPv6 routing table; the matched route lists directions of where to send the IPv6 packet next.|to the router’s IPv6 routing table; the matched route lists directions of where to send the IPv6 packet next.
|
NOTE You could take the preceding list and replace every instance of IPv6 with IPv4, and all the statements would be true of IPv4 as well.|NOTE You could take the preceding list and replace every instance of IPv6 with IPv4, and all the statements would be true of IPv4 as well.
|
While the list shows some concepts that should be familiar from IPv4, the next few figures show the concepts with an example.|While the list shows some concepts that should be familiar from IPv4, the next few figures show the concepts with an example.
First, Figure 22-4 shows a few settings on a host.|First, Figure 22-4 shows a few settings on a host.
|
The host (PC1) has an address of 2345::1.|The host (PC1) has an address of 2345::1.
PC1 also knows its default gateway of 2345::2.|PC1 also knows its default gateway of 2345::2.
|
(Both values are valid abbreviations for real IPv6 addresses.) To send an IPv6 packet to host PC2, on another IPv6 subnet, PC1 creates an IPv6 packet and sends it to R1, PC1’s default gateway.|(Both values are valid abbreviations for real IPv6 addresses.) To send an IPv6 packet to host PC2, on another IPv6 subnet, PC1 creates an IPv6 packet and sends it to R1, PC1’s default gateway.
|
Eth.|Eth.
|
Address = 2345::1 GW = 2345::2 2345::2 2345:1:2:3::2 IPv6 Packet Eth.|Address = 2345::1 GW = 2345::2 2345::2 2345:1:2:3::2 IPv6 Packet Eth.
|
Figure 22-4 IPv6 Host Building and Sending an IPv6 Packet The router (R1) has many small tasks to do when forwarding this IPv6 packet, but for now, focus on the work R1 does related to encapsulation.|Figure 22-4 IPv6 Host Building and Sending an IPv6 Packet The router (R1) has many small tasks to do when forwarding this IPv6 packet, but for now, focus on the work R1 does related to encapsulation.
As seen in Step 1 of Figure 22-5, R1 receives the incoming data-link frame and extracts (de-encapsulates) the IPv6 packet from inside the frame, discarding the original data-link header and trailer.|As seen in Step 1 of Figure 22-5, R1 receives the incoming data-link frame and extracts (de-encapsulates) the IPv6 packet from inside the frame, discarding the original data-link header and trailer.
At Step 2, once R1 knows to forward the IPv6 packet to R2, R1 adds a correct outgoing data-link header and trailer to the IPv6 packet, encapsulating the IPv6 packet.|At Step 2, once R1 knows to forward the IPv6 packet to R2, R1 adds a correct outgoing data-link header and trailer to the IPv6 packet, encapsulating the IPv6 packet.
|
Figure 22-5 IPv6 Router Performing Routine Encapsulation Tasks When Routing IPv6 When a router like R1 de-encapsulates the packet from the data-link frame, it must also decide what type of packet sits inside the frame.|Figure 22-5 IPv6 Router Performing Routine Encapsulation Tasks When Routing IPv6 When a router like R1 de-encapsulates the packet from the data-link frame, it must also decide what type of packet sits inside the frame.
To do so, the router must look at a protocol type field in the data-link header, which identifies the type of packet inside the data-link frame.|To do so, the router must look at a protocol type field in the data-link header, which identifies the type of packet inside the data-link frame.
Today, most data-link frames carry either an IPv4 packet or an IPv6 packet.|Today, most data-link frames carry either an IPv4 packet or an IPv6 packet.
|
To route an IPv6 packet, a router must use its IPv6 routing table instead of the IPv4 routing table.|To route an IPv6 packet, a router must use its IPv6 routing table instead of the IPv4 routing table.
The router must look at the packet’s destination IPv6 address and compare that address to the router’s current IPv6 routing table.|The router must look at the packet’s destination IPv6 address and compare that address to the router’s current IPv6 routing table.
The router uses the forwarding instructions in the matched IPv6 route to forward the IPv6 packet.|The router uses the forwarding instructions in the matched IPv6 route to forward the IPv6 packet.
Figure 22-6 shows the overall process.|Figure 22-6 shows the overall process.
|
Figure 22-6 Comparing an IPv6 Packet to R1’s IPv6 Routing Table Note that again, the process works like IPv4, except that the IPv6 packet lists IPv6 addresses, and the IPv6 routing table lists routing information for IPv6 subnets (called prefixes).|Figure 22-6 Comparing an IPv6 Packet to R1’s IPv6 Routing Table Note that again, the process works like IPv4, except that the IPv6 packet lists IPv6 addresses, and the IPv6 routing table lists routing information for IPv6 subnets (called prefixes).
|
Finally, in most enterprise networks, the routers will route both IPv4 and IPv6 packets at the same time.|Finally, in most enterprise networks, the routers will route both IPv4 and IPv6 packets at the same time.
That is, your company will not decide to adopt IPv6, and then late one weekend night turn off all IPv4 and enable IPv6 on every device.|That is, your company will not decide to adopt IPv6, and then late one weekend night turn off all IPv4 and enable IPv6 on every device.
Instead, IPv6 allows for a slow migration, during which some or all routers forward both IPv4 and IPv6 packets. (The migration strategy of running both IPv4 and IPv6 is called dual stack.) All you have to do is configure the router to route IPv6 packets, in addition to the existing configuration for routing IPv4 packets.|Instead, IPv6 allows for a slow migration, during which some or all routers forward both IPv4 and IPv6 packets. (The migration strategy of running both IPv4 and IPv6 is called dual stack.) All you have to do is configure the router to route IPv6 packets, in addition to the existing configuration for routing IPv4 packets.
#### IPv6 Routing Protocols
IPv6 Routing Protocols   
__|__
--|--
|
IPv6 routers need to learn routes for all the possible IPv6 prefixes (subnets).|IPv6 routers need to learn routes for all the possible IPv6 prefixes (subnets).
Just like with IPv4, IPv6 routers use routing protocols, with familiar names, and generally speaking, with familiar functions.|Just like with IPv4, IPv6 routers use routing protocols, with familiar names, and generally speaking, with familiar functions.
|
None of the IPv4 routing protocols could be used to advertise IPv6 routes originally.|None of the IPv4 routing protocols could be used to advertise IPv6 routes originally.
They all required some kind of update to add messages, protocols, and rules to support IPv6.|They all required some kind of update to add messages, protocols, and rules to support IPv6.
|
Over time, Routing Information Protocol (RIP), Open Shortest Path First (OSPF), Enhanced Interior Gateway Routing Protocol (EIGRP), and Border Gateway Protocol (BGP) were all updated to support IPv6.|Over time, Routing Information Protocol (RIP), Open Shortest Path First (OSPF), Enhanced Interior Gateway Routing Protocol (EIGRP), and Border Gateway Protocol (BGP) were all updated to support IPv6.
Table 22-2 lists the names of these routing protocols, with a few comments.|Table 22-2 lists the names of these routing protocols, with a few comments.
|
Table 22-2 IPv6 Routing Protocols Table end.|Table 22-2 IPv6 Routing Protocols Table end.
|
In addition, these routing protocols also follow the same interior gateway protocol (IGP) and exterior gateway protocol (EGP) conventions as their IPv4 cousins.|In addition, these routing protocols also follow the same interior gateway protocol (IGP) and exterior gateway protocol (EGP) conventions as their IPv4 cousins.
RIPng, EIGRPv6, and OSPFv3 act as interior gateway protocols, advertising IPv6 routes inside an enterprise.|RIPng, EIGRPv6, and OSPFv3 act as interior gateway protocols, advertising IPv6 routes inside an enterprise.
|
As you can see from this introduction, IPv6 uses many of the same big ideas as IPv4.|As you can see from this introduction, IPv6 uses many of the same big ideas as IPv4.
Both define headers with a source and destination address.|Both define headers with a source and destination address.
Both define the routing of packets, with the routing process discarding old data-link headers and trailers when forwarding the packets.|Both define the routing of packets, with the routing process discarding old data-link headers and trailers when forwarding the packets.
And routers use the same general process to make a routing decision, comparing the packet’s destination IP address to the routing table.|And routers use the same general process to make a routing decision, comparing the packet’s destination IP address to the routing table.
|
The big differences between IPv4 and IPv6 revolve around the bigger IPv6 addresses.|The big differences between IPv4 and IPv6 revolve around the bigger IPv6 addresses.
The next topic begins looking at the specifics of these IPv6 addresses.|The next topic begins looking at the specifics of these IPv6 addresses.
### IPv6 Addressing Formats and Conventions
IPv6 Addressing Formats and Conventions   
__|__
--|--
|
The CCNA exam requires some fundamental skills in working with IPv4 addresses.|The CCNA exam requires some fundamental skills in working with IPv4 addresses.
For example, you need to be able to interpret IPv4 addresses, like 172.21.73.14.|For example, you need to be able to interpret IPv4 addresses, like 172.21.73.14.
You need to be able to work with prefix-style masks, like /25, and interpret what that means when used with a particular IPv4 address.|You need to be able to work with prefix-style masks, like /25, and interpret what that means when used with a particular IPv4 address.
And you need to be able to take an address and mask, like 172.21.73.14/25, and find the subnet ID.|And you need to be able to take an address and mask, like 172.21.73.14/25, and find the subnet ID.
|
This second major section of this chapter discusses these same ideas for IPv6 addresses.|This second major section of this chapter discusses these same ideas for IPv6 addresses.
In particular, this section looks at|In particular, this section looks at
###### How to write and interpret unabbreviated 32-digit IPv6 addresses
How to write and interpret unabbreviated 32-digit IPv6 addresses   
###### How to abbreviate IPv6 addresses and how to interpret abbreviated addresses
How to abbreviate IPv6 addresses and how to interpret abbreviated addresses   
###### How to interpret the IPv6 prefix length mask
How to interpret the IPv6 prefix length mask   
###### How to find the IPv6 prefix (subnet ID), based on an address and prefix length mask
How to find the IPv6 prefix (subnet ID), based on an address and prefix length mask   
__|__
--|--
|
The biggest challenge with these tasks lies in the sheer size of the numbers.|The biggest challenge with these tasks lies in the sheer size of the numbers.
Thankfully, the math to find the subnet ID—often a challenge for IPv4—is easier for IPv6, at least to the depth discussed in this book.|Thankfully, the math to find the subnet ID—often a challenge for IPv4—is easier for IPv6, at least to the depth discussed in this book.
#### Representing Full \(Unabbreviated\) IPv6 Addresses
Representing Full \(Unabbreviated\) IPv6 Addresses   
__|__
--|--
|
IPv6 uses a convenient hexadecimal (hex) format for addresses.|IPv6 uses a convenient hexadecimal (hex) format for addresses.
To make it more readable, IPv6 uses a format with eight sets of four hex digits, with each set of four digits separated by a colon.|To make it more readable, IPv6 uses a format with eight sets of four hex digits, with each set of four digits separated by a colon.
For example:|For example:
|
2340:1111:AAAA:0001:1234:5678:9ABC:1234 NOTE For convenience, the author uses the term quartet for one set of four hex digits, with eight quartets in each IPv6 address.|2340:1111:AAAA:0001:1234:5678:9ABC:1234 NOTE For convenience, the author uses the term quartet for one set of four hex digits, with eight quartets in each IPv6 address.
Note that the IPv6 RFCs do not use the term quartet.|Note that the IPv6 RFCs do not use the term quartet.
|
IPv6 addresses also have a binary format as well, but thankfully, most of the time you do not need to look at the binary version of the addresses.|IPv6 addresses also have a binary format as well, but thankfully, most of the time you do not need to look at the binary version of the addresses.
However, in those cases, converting from hex to binary is relatively easy.|However, in those cases, converting from hex to binary is relatively easy.
Just change each hex digit to the equivalent 4-bit value listed in Table 22-3.|Just change each hex digit to the equivalent 4-bit value listed in Table 22-3.
|
Table 22-3 Hexadecimal/Binary Conversion Chart Table end.|Table 22-3 Hexadecimal/Binary Conversion Chart Table end.
#### Abbreviating and Expanding IPv6 Addresses
Abbreviating and Expanding IPv6 Addresses   
__|__
--|--
|
IPv6 also defines ways to abbreviate or shorten how you write or type an IPv6 address.|IPv6 also defines ways to abbreviate or shorten how you write or type an IPv6 address.
|
Why?|Why?
Although using a 32-digit hex number works much better than working with a 128-bit binary number, 32 hex digits are still a lot of digits to remember, recognize in command output, and type on a command line.|Although using a 32-digit hex number works much better than working with a 128-bit binary number, 32 hex digits are still a lot of digits to remember, recognize in command output, and type on a command line.
The IPv6 address abbreviation rules let you shorten these numbers.|The IPv6 address abbreviation rules let you shorten these numbers.
|
Computers and routers typically use the shortest abbreviation, even if you type all 32 hex digits of the address.|Computers and routers typically use the shortest abbreviation, even if you type all 32 hex digits of the address.
So even if you would prefer to use the longer unabbreviated version of the IPv6 address, you need to be ready to interpret the meaning of an abbreviated IPv6 address as listed by a router or host.|So even if you would prefer to use the longer unabbreviated version of the IPv6 address, you need to be ready to interpret the meaning of an abbreviated IPv6 address as listed by a router or host.
This section first looks at abbreviating addresses and then at expanding addresses.|This section first looks at abbreviating addresses and then at expanding addresses.
##### Abbreviating IPv6 Addresses
Abbreviating IPv6 Addresses   
__|__
--|--
|
Two basic rules let you, or any computer, shorten or abbreviate an IPv6 address:|Two basic rules let you, or any computer, shorten or abbreviate an IPv6 address:
|
1. Inside each quartet of four hex digits, remove the leading 0s (0s on the left side of the quartet) in the three positions on the left. (Note: at this step, a quartet of 0000 will leave a single 0.)|1. Inside each quartet of four hex digits, remove the leading 0s (0s on the left side of the quartet) in the three positions on the left. (Note: at this step, a quartet of 0000 will leave a single 0.)
|
2. Find any string of two or more consecutive quartets of all hex 0s, and replace that set of quartets with a double colon (::).|2. Find any string of two or more consecutive quartets of all hex 0s, and replace that set of quartets with a double colon (::).
The :: means “two or more quartets of all 0s.”|The :: means “two or more quartets of all 0s.”
|
However, you can use :: only once in a single address because otherwise the exact IPv6 might not be clear.|However, you can use :: only once in a single address because otherwise the exact IPv6 might not be clear.
|
For example, consider the following IPv6 address.|For example, consider the following IPv6 address.
The bold digits represent digits in which the address could be abbreviated.|The bold digits represent digits in which the address could be abbreviated.
|
FE00:0000:0000:0001:0000:0000:0000:0056 Applying the first rule, you would look at all eight quartets independently.|FE00:0000:0000:0001:0000:0000:0000:0056 Applying the first rule, you would look at all eight quartets independently.
In each, remove all the leading 0s.|In each, remove all the leading 0s.
Note that five of the quartets have four 0s, so for these, remove only three 0s, leaving the following value:|Note that five of the quartets have four 0s, so for these, remove only three 0s, leaving the following value:
|
FE00:0:0:1:0:0:0:56 While this abbreviation is valid, the address can be abbreviated more, using the second rule.|FE00:0:0:1:0:0:0:56 While this abbreviation is valid, the address can be abbreviated more, using the second rule.
|
In this case, two instances exist where more than one quartet in a row has only a 0.|In this case, two instances exist where more than one quartet in a row has only a 0.
Pick the longest such sequence, and replace it with ::, giving you the shortest legal abbreviation:|Pick the longest such sequence, and replace it with ::, giving you the shortest legal abbreviation:
|
FE00:0:0:1::56 While FE00:0:0:1::56 is indeed the shortest abbreviation, this example happens to make it easier to see the two most common mistakes when abbreviating IPv6 addresses.|FE00:0:0:1::56 While FE00:0:0:1::56 is indeed the shortest abbreviation, this example happens to make it easier to see the two most common mistakes when abbreviating IPv6 addresses.
First, never remove trailing 0s in a quartet (0s on the right side of the quartet).|First, never remove trailing 0s in a quartet (0s on the right side of the quartet).
In this case, the first quartet of FE00 cannot be shortened at all because the two 0s trail.|In this case, the first quartet of FE00 cannot be shortened at all because the two 0s trail.
So, the following address, which begins now with only FE in the first quartet, is not a correct abbreviation of the original IPv6 address:|So, the following address, which begins now with only FE in the first quartet, is not a correct abbreviation of the original IPv6 address:
|
FE:0:0:1::56 The second common mistake is to replace all series of all 0 quartets with a double colon.|FE:0:0:1::56 The second common mistake is to replace all series of all 0 quartets with a double colon.
For example, the following abbreviation would be incorrect for the original IPv6 address listed in this topic:|For example, the following abbreviation would be incorrect for the original IPv6 address listed in this topic:
|
FE00::1::56 The reason this abbreviation is incorrect is that now you do not know how many quartets of all 0s to substitute into each :: to find the original unabbreviated address.|FE00::1::56 The reason this abbreviation is incorrect is that now you do not know how many quartets of all 0s to substitute into each :: to find the original unabbreviated address.
##### Expanding Abbreviated IPv6 Addresses
Expanding Abbreviated IPv6 Addresses   
__|__
--|--
|
To expand an IPv6 address back into its full unabbreviated 32-digit number, use two similar rules.|To expand an IPv6 address back into its full unabbreviated 32-digit number, use two similar rules.
The rules basically reverse the logic of the previous two rules:|The rules basically reverse the logic of the previous two rules:
|
1. In each quartet, add leading 0s as needed until the quartet has four hex digits.|1. In each quartet, add leading 0s as needed until the quartet has four hex digits.
|
2. If a double colon (::) exists, count the quartets currently shown; the total should be less than 8.|2. If a double colon (::) exists, count the quartets currently shown; the total should be less than 8.
Replace the :: with multiple quartets of 0000 so that eight total quartets exist.|Replace the :: with multiple quartets of 0000 so that eight total quartets exist.
|
The best way to get comfortable with these addresses and abbreviations is to do some yourself.|The best way to get comfortable with these addresses and abbreviations is to do some yourself.
|
Table 22-4 lists some practice problems, with the full 32-digit IPv6 address on the left and the best abbreviation on the right.|Table 22-4 lists some practice problems, with the full 32-digit IPv6 address on the left and the best abbreviation on the right.
The table gives you either the expanded or abbreviated address, and you need to supply the opposite value.|The table gives you either the expanded or abbreviated address, and you need to supply the opposite value.
The answers sit at the end of the chapter, in the section “Answers to Earlier Practice Problems.”|The answers sit at the end of the chapter, in the section “Answers to Earlier Practice Problems.”
|
Table 22-4 IPv6 Address Abbreviation and Expansion Practice Table end.|Table 22-4 IPv6 Address Abbreviation and Expansion Practice Table end.
#### Representing the Prefix Length of an Address
Representing the Prefix Length of an Address   
__|__
--|--
|
IPv6 uses a mask concept, called the prefix length, similar to IPv4 subnet masks.|IPv6 uses a mask concept, called the prefix length, similar to IPv4 subnet masks.
Similar to the IPv4 prefix-style mask, the IPv6 prefix length is written as a /, followed by a decimal number.|Similar to the IPv4 prefix-style mask, the IPv6 prefix length is written as a /, followed by a decimal number.
The prefix length defines how many bits of the IPv6 address define the IPv6 prefix, which is basically the same concept as the IPv4 subnet ID.|The prefix length defines how many bits of the IPv6 address define the IPv6 prefix, which is basically the same concept as the IPv4 subnet ID.
|
When writing an IPv6 address and prefix length in documentation, you can choose to leave a space before the /, or not, as shown in the next two examples.|When writing an IPv6 address and prefix length in documentation, you can choose to leave a space before the /, or not, as shown in the next two examples.
|
2222:1111:0:1:A:B:C:D/64 2222:1111:0:1:A:B:C:D /64 Finally, note that the prefix length is a number of bits, so with IPv6, the legal value range is from 0 through 128, inclusive.|2222:1111:0:1:A:B:C:D/64 2222:1111:0:1:A:B:C:D /64 Finally, note that the prefix length is a number of bits, so with IPv6, the legal value range is from 0 through 128, inclusive.
#### Calculating the IPv6 Prefix \(Subnet ID\)
Calculating the IPv6 Prefix \(Subnet ID\)   
__|__
--|--
|
With IPv4, you can take an IP address and the associated subnet mask, and calculate the subnet ID. With IPv6 subnetting, you can take an IPv6 address and the associated prefix length, and calculate the IPv6 equivalent of the subnet ID: an IPv6 prefix.|With IPv4, you can take an IP address and the associated subnet mask, and calculate the subnet ID. With IPv6 subnetting, you can take an IPv6 address and the associated prefix length, and calculate the IPv6 equivalent of the subnet ID: an IPv6 prefix.
|
Like with different IPv4 subnet masks, some IPv6 prefix lengths make for an easy math problem to find the IPv6 prefix, while some prefix lengths make the math more difficult.|Like with different IPv4 subnet masks, some IPv6 prefix lengths make for an easy math problem to find the IPv6 prefix, while some prefix lengths make the math more difficult.
This section looks at the easier cases, mainly because the size of the IPv6 address space lets us all choose to use IPv6 prefix lengths that make the math much easier.|This section looks at the easier cases, mainly because the size of the IPv6 address space lets us all choose to use IPv6 prefix lengths that make the math much easier.
#### Finding the IPv6 Prefix
Finding the IPv6 Prefix   
__|__
--|--
|
In IPv6, a prefix represents a group of IPv6 addresses.|In IPv6, a prefix represents a group of IPv6 addresses.
For now, this section focuses on the math, and only the math, for finding the number that represents that prefix.|For now, this section focuses on the math, and only the math, for finding the number that represents that prefix.
Chapter 23, “IPv6 Addressing and Subnetting,” then starts putting more meaning behind the actual numbers.|Chapter 23, “IPv6 Addressing and Subnetting,” then starts putting more meaning behind the actual numbers.
|
Each IPv6 prefix, or subnet if you prefer, has a number that represents the group.|Each IPv6 prefix, or subnet if you prefer, has a number that represents the group.
Per the IPv6 RFCs, the number itself is also called the prefix, but many people just call it a subnet number or subnet ID, using the same terms as IPv4.|Per the IPv6 RFCs, the number itself is also called the prefix, but many people just call it a subnet number or subnet ID, using the same terms as IPv4.
|
As with IPv4, you can start with an IPv6 address and prefix length, and find the prefix, with the same general rules that you use in IPv4.|As with IPv4, you can start with an IPv6 address and prefix length, and find the prefix, with the same general rules that you use in IPv4.
If the prefix length is /P, use these rules:|If the prefix length is /P, use these rules:
|
1. Copy the first P bits.|1. Copy the first P bits.
|
2. Change the rest of the bits to 0.|2. Change the rest of the bits to 0.
|
When using a prefix length that happens to be a multiple of 4, you do not have to think in terms of bits, but in terms of hex digits.|When using a prefix length that happens to be a multiple of 4, you do not have to think in terms of bits, but in terms of hex digits.
A prefix length that is a multiple of 4 means that each hex digit is either copied or changed to hex 0.|A prefix length that is a multiple of 4 means that each hex digit is either copied or changed to hex 0.
Just for completeness, if the prefix length is indeed a multiple of 4, the process becomes 1.|Just for completeness, if the prefix length is indeed a multiple of 4, the process becomes 1.
Identify the number of hex digits in the prefix by dividing the prefix length (which is in bits) by 4.|Identify the number of hex digits in the prefix by dividing the prefix length (which is in bits) by 4.
|
2. Copy the hex digits determined to be in the prefix per the first step.|2. Copy the hex digits determined to be in the prefix per the first step.
|
3. Change the rest of the hex digits to 0.|3. Change the rest of the hex digits to 0.
|
Figure 22-7 shows an example, with a prefix length of 64.|Figure 22-7 shows an example, with a prefix length of 64.
In this case, Step 1 looks at the /64 prefix length and calculates that the prefix has 16 hex digits.|In this case, Step 1 looks at the /64 prefix length and calculates that the prefix has 16 hex digits.
Step 2 copies the first 16 digits of the IPv6 address, while Step 3 records hex 0s for the rest of the digits.|Step 2 copies the first 16 digits of the IPv6 address, while Step 3 records hex 0s for the rest of the digits.
|
Figure 22-7 Creating the IPv6 Prefix from an Address/Length After you find the IPv6 prefix, you should also be ready to abbreviate the IPv6 prefix using the same rules you use to abbreviate IPv6 addresses.|Figure 22-7 Creating the IPv6 Prefix from an Address/Length After you find the IPv6 prefix, you should also be ready to abbreviate the IPv6 prefix using the same rules you use to abbreviate IPv6 addresses.
However, you should pay extra attention to the end of the prefix because it often has several octets of all 0 values.|However, you should pay extra attention to the end of the prefix because it often has several octets of all 0 values.
As a result, the abbreviation typically ends with two colons (::).|As a result, the abbreviation typically ends with two colons (::).
|
For example, consider the following IPv6 address that is assigned to a host on a LAN:|For example, consider the following IPv6 address that is assigned to a host on a LAN:
|
2000:1234:5678:9ABC:1234:5678:9ABC:1111/64 This example shows an IPv6 address that itself cannot be abbreviated.|2000:1234:5678:9ABC:1234:5678:9ABC:1111/64 This example shows an IPv6 address that itself cannot be abbreviated.
After you calculate the prefix for the subnet in which the address resides, by zeroing out the last 64 bits (16 digits)|After you calculate the prefix for the subnet in which the address resides, by zeroing out the last 64 bits (16 digits)
|
of the address, you find the following prefix value:|of the address, you find the following prefix value:
|
2000:1234:5678:9ABC:0000:0000:0000:0000/64 This value can be abbreviated, with four quartets of all 0s at the end, as follows:|2000:1234:5678:9ABC:0000:0000:0000:0000/64 This value can be abbreviated, with four quartets of all 0s at the end, as follows:
|
2000:1234:5678:9ABC::/64 To get better at the math, take some time to work through finding the prefix for several practice problems, as listed in Table 22-5.|2000:1234:5678:9ABC::/64 To get better at the math, take some time to work through finding the prefix for several practice problems, as listed in Table 22-5.
The answers sit at the end of the chapter, in the section “Answers to Earlier Practice Problems.”|The answers sit at the end of the chapter, in the section “Answers to Earlier Practice Problems.”
|
Table 22-5 Finding the IPv6 Prefix from an Address/Length Value Table end.|Table 22-5 Finding the IPv6 Prefix from an Address/Length Value Table end.
#### Working with More-Difficult IPv6 Prefix Lengths
Working with More-Difficult IPv6 Prefix Lengths   
__|__
--|--
|
Some prefix lengths make the math to find the prefix very easy, some mostly easy, and some require you to work in binary.|Some prefix lengths make the math to find the prefix very easy, some mostly easy, and some require you to work in binary.
If the prefix length is a multiple of 16, the process of copying part of the address copies entire quartets.|If the prefix length is a multiple of 16, the process of copying part of the address copies entire quartets.
If the prefix length is not a multiple of 16 but is a multiple of 4, at least the boundary sits at the edge of a hex digit, so you can avoid working in binary.|If the prefix length is not a multiple of 16 but is a multiple of 4, at least the boundary sits at the edge of a hex digit, so you can avoid working in binary.
|
Although the /64 prefix length is by far the most common prefix length, you should be ready to find the prefix when using a prefix length that is any multiple of 4.|Although the /64 prefix length is by far the most common prefix length, you should be ready to find the prefix when using a prefix length that is any multiple of 4.
For example, consider the following IPv6 address and prefix length:|For example, consider the following IPv6 address and prefix length:
|
2000:1234:5678:9ABC:1234:5678:9ABC:1111/56 Because this example uses a /56 prefix length, the prefix includes the first 56 bits, or first 14 complete hex digits, of the address.|2000:1234:5678:9ABC:1234:5678:9ABC:1111/56 Because this example uses a /56 prefix length, the prefix includes the first 56 bits, or first 14 complete hex digits, of the address.
The rest of the hex digits will be 0, resulting in the following prefix:|The rest of the hex digits will be 0, resulting in the following prefix:
|
2000:1234:5678:9A00:0000:0000:0000:0000/56 This value can be abbreviated, with four quartets of all 0s at the end, as follows:|2000:1234:5678:9A00:0000:0000:0000:0000/56 This value can be abbreviated, with four quartets of all 0s at the end, as follows:
|
2000:1234:5678:9A00::/56 This example shows an easy place to make a mistake.|2000:1234:5678:9A00::/56 This example shows an easy place to make a mistake.
Sometimes, people look at the /56 and think of that as the first 14 hex digits, which is correct.|Sometimes, people look at the /56 and think of that as the first 14 hex digits, which is correct.
However, they then copy the first 14 hex digits and add a double colon, showing the following:|However, they then copy the first 14 hex digits and add a double colon, showing the following:
|
2000:1234:5678:9A::/56 This abbreviation is not correct because it removed the trailing “00” at the end of the fourth quartet.|2000:1234:5678:9A::/56 This abbreviation is not correct because it removed the trailing “00” at the end of the fourth quartet.
If you expanded the abbreviated value, it would begin with 2000:1234:5678:009A, not 2000:1234:5678:9A00.|If you expanded the abbreviated value, it would begin with 2000:1234:5678:009A, not 2000:1234:5678:9A00.
So, be careful when abbreviating when the boundary is not at the edge of a quartet.|So, be careful when abbreviating when the boundary is not at the edge of a quartet.
|
Once again, some extra practice can help.|Once again, some extra practice can help.
Table 22-6 uses examples that have a prefix length that is a multiple of 4, but is not on a quartet boundary, just to get some extra practice.|Table 22-6 uses examples that have a prefix length that is a multiple of 4, but is not on a quartet boundary, just to get some extra practice.
The answers sit at the end of the chapter, in the section “Answers to Earlier Practice Problems.”|The answers sit at the end of the chapter, in the section “Answers to Earlier Practice Problems.”
|
Table 22-6 Finding the IPv6 Prefix from an Address/Length Value Table end.|Table 22-6 Finding the IPv6 Prefix from an Address/Length Value Table end.
### Chapter Review
Chapter Review   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|One key to doing well on the exams is to perform repetitive spaced review sessions.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.
Refer to the “Your Study Plan” element for more details.|Refer to the “Your Study Plan” element for more details.
Table 22-7 outlines the key review elements and where you can find them.|Table 22-7 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 22-7 Chapter Review Tracking Table end.|Table 22-7 Chapter Review Tracking Table end.
|
Table 22-8 Key Topics for Chapter 22 Table end.|Table 22-8 Key Topics for Chapter 22 Table end.
|
Key Terms You Should Know IPv4 address exhaustion, IP version 6 (IPv6), OSPF version 3 (OSPFv3), EIGRP version 6 (EIGRPv6), prefix, prefix length, quartet Additional Practice for This Chapter’s Processes For additional practice with IPv6 abbreviations, you may do the same set of practice problems have two options to use:|Key Terms You Should Know IPv4 address exhaustion, IP version 6 (IPv6), OSPF version 3 (OSPFv3), EIGRP version 6 (EIGRPv6), prefix, prefix length, quartet Additional Practice for This Chapter’s Processes For additional practice with IPv6 abbreviations, you may do the same set of practice problems have two options to use:
|
PDF: Navigate to the companion website and open the PDF for Appendix G.|PDF: Navigate to the companion website and open the PDF for Appendix G.
|
Application: Navigate to the companion website and use these applications:|Application: Navigate to the companion website and use these applications:
|
“Practice Exercise: Abbreviating and Expanding Addresses”|“Practice Exercise: Abbreviating and Expanding Addresses”
|
“Practice Exercise: Calculating the IPv6 Prefix”|“Practice Exercise: Calculating the IPv6 Prefix”
|
“Practice Exercise: Calculating the IPv6 Prefix Round 2”|“Practice Exercise: Calculating the IPv6 Prefix Round 2”
|
Answers to Earlier Practice Problems This chapter includes practice problems spread around different locations in the chapter.|Answers to Earlier Practice Problems This chapter includes practice problems spread around different locations in the chapter.
The answers are located in Tables 22-9, 22-10, and 22-11.|The answers are located in Tables 22-9, 22-10, and 22-11.
|
Table 22-9 Answers to Questions in the Earlier Table 22-4 Table end.|Table 22-9 Answers to Questions in the Earlier Table 22-4 Table end.
|
Table 22-10 Answers to Questions in the Earlier Table 22-5 Table end.|Table 22-10 Answers to Questions in the Earlier Table 22-5 Table end.
|
Table 22-11 Answers to Questions in the Earlier Table 22-6 Table end.|Table 22-11 Answers to Questions in the Earlier Table 22-6 Table end.
## Chapter 23 IPv6 Addressing and Subnetting
Chapter 23 IPv6 Addressing and Subnetting   
__|__
--|--
|
This chapter covers the following exam topics:|This chapter covers the following exam topics:
###### 1.0 Network Fundamentals
1.0 Network Fundamentals   
###### 1.8 Configure and verify IPv6 addressing and prefix
1.8 Configure and verify IPv6 addressing and prefix   
###### 1.9 Compare and contrast IPv6 address types
1.9 Compare and contrast IPv6 address types   
###### 1.9.a Global unicast
1.9.a Global unicast   
###### 1.9.b Unique local
1.9.b Unique local   
__|__
--|--
|
IPv4 organizes the address space in a couple of ways.|IPv4 organizes the address space in a couple of ways.
First, IPv4 splits addresses by class, with Classes A, B, and C defining unicast IPv4 addresses. (The term unicast refers to the fact that each address is used by only one interface.) Then, within the Class A, B, and C address range, the Internet Assigned Numbers Authority (IANA) and the Internet Corporation for Assigned Names and Numbers (ICANN) reserve most of the addresses as public IPv4 addresses, with a few reserved as private IPv4 addresses.|First, IPv4 splits addresses by class, with Classes A, B, and C defining unicast IPv4 addresses. (The term unicast refers to the fact that each address is used by only one interface.) Then, within the Class A, B, and C address range, the Internet Assigned Numbers Authority (IANA) and the Internet Corporation for Assigned Names and Numbers (ICANN) reserve most of the addresses as public IPv4 addresses, with a few reserved as private IPv4 addresses.
|
IPv6 does not use any concept like the classful network concept used by IPv4.|IPv6 does not use any concept like the classful network concept used by IPv4.
However, IANA does still reserve some IPv6 address ranges for specific purposes, even with some address ranges that serve as both public IPv6 addresses and private IPv6 addresses.|However, IANA does still reserve some IPv6 address ranges for specific purposes, even with some address ranges that serve as both public IPv6 addresses and private IPv6 addresses.
IANA also attempts to take a practical approach to reserving ranges of the entire IPv6 address space for different purposes, using the wisdom gained from several decades of fast growth in the IPv4 Internet.|IANA also attempts to take a practical approach to reserving ranges of the entire IPv6 address space for different purposes, using the wisdom gained from several decades of fast growth in the IPv4 Internet.
|
This chapter has two major sections.|This chapter has two major sections.
The first examines global unicast addresses, which serve as public IPv6 addresses.|The first examines global unicast addresses, which serve as public IPv6 addresses.
The second major section looks at unique local addresses, which serve as private IPv6 addresses.|The second major section looks at unique local addresses, which serve as private IPv6 addresses.
### “Do I Know This Already?” Quiz
“Do I Know This Already?” Quiz   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.
The letter answers are listed at the bottom of the page following the quiz.|The letter answers are listed at the bottom of the page following the quiz.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.
You can also find both answers and explanations in the PTP testing software.|You can also find both answers and explanations in the PTP testing software.
|
Table 23-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Table 23-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping
### Foundation Topics
Foundation Topics   
### Global Unicast Addressing Concepts
Global Unicast Addressing Concepts   
__|__
--|--
|
Unique Local Unicast Addresses 5 CHAPTER 23 1.|Unique Local Unicast Addresses 5 CHAPTER 23 1.
Which of the following IPv6 addresses appears to be a unique local unicast address, based on its first few hex digits?|Which of the following IPv6 addresses appears to be a unique local unicast address, based on its first few hex digits?
|
a. 3123:1:3:5::1 b.|a. 3123:1:3:5::1 b.
FE80::1234:56FF:FE78:9ABC c.|FE80::1234:56FF:FE78:9ABC c.
FDAD::1 d.|FDAD::1 d.
FF00::5 2.|FF00::5 2.
Which of the following IPv6 addresses appears to be a global unicast address, based on its first few hex digits?|Which of the following IPv6 addresses appears to be a global unicast address, based on its first few hex digits?
|
a. 3123:1:3:5::1 b.|a. 3123:1:3:5::1 b.
FE80::1234:56FF:FE78:9ABC c.|FE80::1234:56FF:FE78:9ABC c.
FDAD::1 d.|FDAD::1 d.
FF00::5 3.|FF00::5 3.
When subnetting an IPv6 address block, an engineer shows a drawing that breaks the address structure into three pieces.|When subnetting an IPv6 address block, an engineer shows a drawing that breaks the address structure into three pieces.
Comparing this concept to a three-part IPv4 address structure, which part of the IPv6 address structure is most like the IPv4 network part of the address?|Comparing this concept to a three-part IPv4 address structure, which part of the IPv6 address structure is most like the IPv4 network part of the address?
|
a. Subnet b.|a. Subnet b.
Interface ID c.|Interface ID c.
Network d.|Network d.
Global routing prefix e.|Global routing prefix e.
Subnet router anycast 4.|Subnet router anycast 4.
When subnetting an IPv6 address block, an engineer shows a drawing that breaks the address structure into three pieces.|When subnetting an IPv6 address block, an engineer shows a drawing that breaks the address structure into three pieces.
Assuming that all subnets use the same prefix length, which of the following answers lists the name of the field on the far right side of the address?|Assuming that all subnets use the same prefix length, which of the following answers lists the name of the field on the far right side of the address?
|
a. Subnet b.|a. Subnet b.
Interface ID c.|Interface ID c.
Network d.|Network d.
Global routing prefix e.|Global routing prefix e.
Subnet router anycast 5.|Subnet router anycast 5.
For the IPv6 address FD00:1234:5678:9ABC:DEF1:2345:6789:ABCD, which part of the address is considered the global ID of the unique local address?|For the IPv6 address FD00:1234:5678:9ABC:DEF1:2345:6789:ABCD, which part of the address is considered the global ID of the unique local address?
|
a. None; this address has no global ID.|a. None; this address has no global ID.
|
b. 00:1234:5678:9ABC c.|b. 00:1234:5678:9ABC c.
DEF1:2345:6789:ABCD d. 00:1234:5678 e.|DEF1:2345:6789:ABCD d. 00:1234:5678 e.
FD00 Foundation Topics Global Unicast Addressing Concepts This first major section of the chapter focuses on one type of unicast IPv6 addresses: global unicast addresses.|FD00 Foundation Topics Global Unicast Addressing Concepts This first major section of the chapter focuses on one type of unicast IPv6 addresses: global unicast addresses.
As it turns out, many of the general concepts and processes behind these global unicast IPv6 addresses follow the original intent for public IPv4 addresses.|As it turns out, many of the general concepts and processes behind these global unicast IPv6 addresses follow the original intent for public IPv4 addresses.
So, this section begins with a review of some IPv4 concepts, followed by the details of how a company can use global unicast addresses.|So, this section begins with a review of some IPv4 concepts, followed by the details of how a company can use global unicast addresses.
|
This first section also discusses IPv6 subnetting and the entire process of taking a block of global unicast addresses and creating subnets for one company.|This first section also discusses IPv6 subnetting and the entire process of taking a block of global unicast addresses and creating subnets for one company.
This process takes a globally unique global routing prefix, creates IPv6 subnets, and assigns IPv6 addresses from within each subnet, much like with IPv4.|This process takes a globally unique global routing prefix, creates IPv6 subnets, and assigns IPv6 addresses from within each subnet, much like with IPv4.
#### Public and Private IPv6 Addresses
Public and Private IPv6 Addresses   
__|__
--|--
|
In the history of IPv4 addressing, the world started out with a plan that gave every single host a globally unique public IPv4 address.|In the history of IPv4 addressing, the world started out with a plan that gave every single host a globally unique public IPv4 address.
However, as discussed in several places already, the IPv4 address space had too few addresses.|However, as discussed in several places already, the IPv4 address space had too few addresses.
So, in the 1990s, companies started using addresses from the private IPv4 address range, as defined in RFC 1918.|So, in the 1990s, companies started using addresses from the private IPv4 address range, as defined in RFC 1918.
These companies either simply did not connect to the Internet, or to connect to the Internet, they used Network Address Translation (NAT), sharing a few public globally unique IPv4 addresses for all host connections into the Internet.|These companies either simply did not connect to the Internet, or to connect to the Internet, they used Network Address Translation (NAT), sharing a few public globally unique IPv4 addresses for all host connections into the Internet.
|
IPv6 allows two similar options of public and private unicast addressing, beginning with global unicast addresses as the public IPv6 address space.|IPv6 allows two similar options of public and private unicast addressing, beginning with global unicast addresses as the public IPv6 address space.
Similar to public IPv4 addresses, IPv6 global unicast addresses rely on an administrative process that assigns each company a unique IPv6 address block.|Similar to public IPv4 addresses, IPv6 global unicast addresses rely on an administrative process that assigns each company a unique IPv6 address block.
Each company then subnets this IPv6 address block and only uses addresses from within that block.|Each company then subnets this IPv6 address block and only uses addresses from within that block.
The result: that company uses addresses that are unique across the globe as well.|The result: that company uses addresses that are unique across the globe as well.
|
The second IPv6 option uses unique local IPv6 addresses, which work more like the IPv4 private addresses.|The second IPv6 option uses unique local IPv6 addresses, which work more like the IPv4 private addresses.
Companies that do not plan to connect to the Internet and companies that plan to use IPv6 NAT can use these private unique local addresses.|Companies that do not plan to connect to the Internet and companies that plan to use IPv6 NAT can use these private unique local addresses.
The process also works similarly to IPv4: The engineer can read the details in an RFC, pick some numbers, and start assigning IPv6 addresses without having to register with IANA or any other authority.|The process also works similarly to IPv4: The engineer can read the details in an RFC, pick some numbers, and start assigning IPv6 addresses without having to register with IANA or any other authority.
|
The following lists summarizes the comparisons between global unicast addresses and unique local addresses:|The following lists summarizes the comparisons between global unicast addresses and unique local addresses:
|
Global unicast: Addresses that work like public IPv4 addresses.|Global unicast: Addresses that work like public IPv4 addresses.
The organization that needs IPv6 addresses asks for a registered IPv6 address block, which is assigned as a global routing prefix.|The organization that needs IPv6 addresses asks for a registered IPv6 address block, which is assigned as a global routing prefix.
After that, only that organization uses the addresses inside that block of addresses—that is, the addresses that begin with the assigned prefix.|After that, only that organization uses the addresses inside that block of addresses—that is, the addresses that begin with the assigned prefix.
|
Unique local: Works somewhat like private IPv4 addresses, with the possibility that multiple organizations use the exact same addresses, and with no requirement for registering with any numbering authority.|Unique local: Works somewhat like private IPv4 addresses, with the possibility that multiple organizations use the exact same addresses, and with no requirement for registering with any numbering authority.
|
Answers to the “Do I Know This Already?” quiz:|Answers to the “Do I Know This Already?” quiz:
|
1 C 2 A 3 D 4 B 5 D The rest of this first major section of the chapter examines global unicast addresses in more detail, while the second major section of the chapter examines unique local addresses.|1 C 2 A 3 D 4 B 5 D The rest of this first major section of the chapter examines global unicast addresses in more detail, while the second major section of the chapter examines unique local addresses.
#### The IPv6 Global Routing Prefix
The IPv6 Global Routing Prefix   
__|__
--|--
|
IPv6 global unicast addresses allow IPv6 to work more like the original design of the IPv4 Internet.|IPv6 global unicast addresses allow IPv6 to work more like the original design of the IPv4 Internet.
Each organization asks for a block of IPv6 addresses, which no one else can use.|Each organization asks for a block of IPv6 addresses, which no one else can use.
|
That organization further subdivides the address block into smaller chunks, called subnets.|That organization further subdivides the address block into smaller chunks, called subnets.
|
Finally, to choose what IPv6 address to use for any host, the engineer chooses an address from the right subnet.|Finally, to choose what IPv6 address to use for any host, the engineer chooses an address from the right subnet.
|
That reserved block of IPv6 addresses—a set of addresses that only one company can use—|That reserved block of IPv6 addresses—a set of addresses that only one company can use—
|
is called a global routing prefix.|is called a global routing prefix.
Each organization that wants to connect to the Internet and use IPv6 global unicast addresses should ask for and receive a global routing prefix.|Each organization that wants to connect to the Internet and use IPv6 global unicast addresses should ask for and receive a global routing prefix.
Very generally, you can think of the global routing prefix like an IPv4 Class A, B, or C network number from the range of public IPv4 addresses.|Very generally, you can think of the global routing prefix like an IPv4 Class A, B, or C network number from the range of public IPv4 addresses.
|
The term global routing prefix might not make you think of a block of IPv6 addresses at first.|The term global routing prefix might not make you think of a block of IPv6 addresses at first.
The term actually refers to the idea that Internet routers can have one route that refers to all the addresses inside the address block, without a need to have routes for smaller parts of that block.|The term actually refers to the idea that Internet routers can have one route that refers to all the addresses inside the address block, without a need to have routes for smaller parts of that block.
For example, Figure 23-1 shows three companies, with three different IPv6 global routing prefixes; the router on the right (R4) has one IPv6 route for each global routing prefix.|For example, Figure 23-1 shows three companies, with three different IPv6 global routing prefixes; the router on the right (R4) has one IPv6 route for each global routing prefix.
|
Figure 23-1 Three Global Routing Prefixes, with One Route per Prefix The global routing prefix sets those IPv6 addresses apart for use by that one company, just like a public IPv4 network or CIDR address block does in IPv4.|Figure 23-1 Three Global Routing Prefixes, with One Route per Prefix The global routing prefix sets those IPv6 addresses apart for use by that one company, just like a public IPv4 network or CIDR address block does in IPv4.
All IPv6 addresses inside that company should begin with that global routing prefix, to avoid using other companies’|All IPv6 addresses inside that company should begin with that global routing prefix, to avoid using other companies’
|
IPv6 addresses.|IPv6 addresses.
No other companies should use IPv6 addresses with that same prefix.|No other companies should use IPv6 addresses with that same prefix.
And thankfully, IPv6 has plenty of space to allow all companies to have a global routing prefix, with plenty of addresses.|And thankfully, IPv6 has plenty of space to allow all companies to have a global routing prefix, with plenty of addresses.
|
Both the IPv6 and IPv4 address assignment processes rely on the same organizations:|Both the IPv6 and IPv4 address assignment processes rely on the same organizations:
|
IANA (along with ICANN), the Regional Internet Registries (RIR), and ISPs. For example, an imaginary company, Company1, received the assignment of a global routing prefix.|IANA (along with ICANN), the Regional Internet Registries (RIR), and ISPs. For example, an imaginary company, Company1, received the assignment of a global routing prefix.
The prefix means “All addresses whose first 12 hex digits are 2001:0DB8:1111,” as represented by prefix 2001:0DB8:1111::/48.|The prefix means “All addresses whose first 12 hex digits are 2001:0DB8:1111,” as represented by prefix 2001:0DB8:1111::/48.
To receive that assignment, the process shown in Figure 23-2 happened.|To receive that assignment, the process shown in Figure 23-2 happened.
|
Figure 23-2 Prefix Assignment with IANA, RIRs, and ISPs The event timeline in the figure uses a left-to-right flow; in other words, the event on the far left must happen first.|Figure 23-2 Prefix Assignment with IANA, RIRs, and ISPs The event timeline in the figure uses a left-to-right flow; in other words, the event on the far left must happen first.
Following the flow from left to right in the figure:|Following the flow from left to right in the figure:
|
1. IANA allocates ARIN prefix 2001::/16: ARIN (the RIR for North America) asks IANA for the allocation of a large block of addresses.|1. IANA allocates ARIN prefix 2001::/16: ARIN (the RIR for North America) asks IANA for the allocation of a large block of addresses.
In this imaginary example, IANA gives ARIN a prefix of “all addresses that begin 2001,” or 2001::/16.|In this imaginary example, IANA gives ARIN a prefix of “all addresses that begin 2001,” or 2001::/16.
|
2. ARIN allocates NA-ISP1 prefix 2001:0DB8::/32: NA-ISP1, an imaginary ISP based in North America, asks ARIN for a new IPv6 prefix.|2. ARIN allocates NA-ISP1 prefix 2001:0DB8::/32: NA-ISP1, an imaginary ISP based in North America, asks ARIN for a new IPv6 prefix.
ARIN takes a subset of its 2001::/16 prefix, specifically all addresses that begin with the 32 bits (8 hex digits) 2001:0DB8, and allocates it to the ISP.|ARIN takes a subset of its 2001::/16 prefix, specifically all addresses that begin with the 32 bits (8 hex digits) 2001:0DB8, and allocates it to the ISP.
|
3. NA-ISP1 assigns Company 1 2001:0DB8:1111::/48: Company 1 decides to start supporting IPv6, so it goes to its ISP, NA-ISP1, to ask for a block of global unicast addresses.|3. NA-ISP1 assigns Company 1 2001:0DB8:1111::/48: Company 1 decides to start supporting IPv6, so it goes to its ISP, NA-ISP1, to ask for a block of global unicast addresses.
NA-ISP1 assigns Company 1 a “small” piece of NA-ISP1’s address block, in this case the addresses that begin with the 48 bits (12 hex digits) of 2001:0DB8:1111 (2001:0DB8:1111::/48).|NA-ISP1 assigns Company 1 a “small” piece of NA-ISP1’s address block, in this case the addresses that begin with the 48 bits (12 hex digits) of 2001:0DB8:1111 (2001:0DB8:1111::/48).
|
NOTE If you do not plan to connect to the Internet using IPv6 for a while and just want to experiment, you do not need to ask for an IPv6 global routing prefix to be assigned.|NOTE If you do not plan to connect to the Internet using IPv6 for a while and just want to experiment, you do not need to ask for an IPv6 global routing prefix to be assigned.
Just make up IPv6 addresses and configure your devices, or use unique local addresses as discussed toward the end of this chapter.|Just make up IPv6 addresses and configure your devices, or use unique local addresses as discussed toward the end of this chapter.
#### Address Ranges for Global Unicast Addresses
Address Ranges for Global Unicast Addresses   
__|__
--|--
|
Global unicast addresses make up the majority of the IPv6 address space.|Global unicast addresses make up the majority of the IPv6 address space.
However, unlike IPv4, the rules for which IPv6 addresses fall into which category are purposefully more flexible than they were with IPv4 and the rules for IPv4 Classes A, B, C, D, and E.|However, unlike IPv4, the rules for which IPv6 addresses fall into which category are purposefully more flexible than they were with IPv4 and the rules for IPv4 Classes A, B, C, D, and E.
|
Originally, IANA reserved all IPv6 addresses that begin with hex 2 or 3 as global unicast addresses. (This address range can be written succinctly as prefix 2000::/3.)|Originally, IANA reserved all IPv6 addresses that begin with hex 2 or 3 as global unicast addresses. (This address range can be written succinctly as prefix 2000::/3.)
|
Later IANA made the global unicast address range wider, basically to include all IPv6 addresses not otherwise allocated for other purposes.|Later IANA made the global unicast address range wider, basically to include all IPv6 addresses not otherwise allocated for other purposes.
For example, the unique local unicast addresses, discussed later in this chapter, all start with hex FD. So, while global unicast addresses would not include any addresses that begin with FD, any address ranges that are not specifically reserved, for now, are considered to be global unicast addresses.|For example, the unique local unicast addresses, discussed later in this chapter, all start with hex FD. So, while global unicast addresses would not include any addresses that begin with FD, any address ranges that are not specifically reserved, for now, are considered to be global unicast addresses.
|
Finally, just because an amazingly enormous number of addresses sit within the global unicast address range, IANA does not assign prefixes from all over the address range.|Finally, just because an amazingly enormous number of addresses sit within the global unicast address range, IANA does not assign prefixes from all over the address range.
IPv4 has survived well for more than 30 years with an admittedly too-small address size because IANA has adopted good practices to conserve the IPv4 address space.|IPv4 has survived well for more than 30 years with an admittedly too-small address size because IANA has adopted good practices to conserve the IPv4 address space.
By making smart and practical choices in assigning IPv6 addresses, the IPv6 address space could last much longer than IPv4.|By making smart and practical choices in assigning IPv6 addresses, the IPv6 address space could last much longer than IPv4.
|
Table 23-2 lists the address prefixes discussed in this book and their purpose.|Table 23-2 lists the address prefixes discussed in this book and their purpose.
|
Table 23-2 Some Types of IPv6 Addresses and Their First Hex Digit(s)|Table 23-2 Some Types of IPv6 Addresses and Their First Hex Digit(s)
|
Table end.|Table end.
#### IPv6 Subnetting Using Global Unicast Addresses
IPv6 Subnetting Using Global Unicast Addresses   
__|__
--|--
|
After an enterprise has a block of reserved global unicast addresses—in other words, a global routing prefix—the company needs to subdivide that large address block into subnets.|After an enterprise has a block of reserved global unicast addresses—in other words, a global routing prefix—the company needs to subdivide that large address block into subnets.
|
Subnetting IPv6 addresses works generally like IPv4, but with mostly simpler math (hoorah!).|Subnetting IPv6 addresses works generally like IPv4, but with mostly simpler math (hoorah!).
|
Because of the absolutely large number of addresses available, most everyone uses the easiest possible IPv6 prefix length: /64.|Because of the absolutely large number of addresses available, most everyone uses the easiest possible IPv6 prefix length: /64.
Using /64 as the prefix length for all subnets makes the IPv6 subnetting math just as easy as using a /24 mask for all IPv4 subnets.|Using /64 as the prefix length for all subnets makes the IPv6 subnetting math just as easy as using a /24 mask for all IPv4 subnets.
In addition, the dynamic IPv6 address assignment process works better with a /64 prefix length as well; so in practice, and in this book, expect IPv6 designs to use a /64 prefix length.|In addition, the dynamic IPv6 address assignment process works better with a /64 prefix length as well; so in practice, and in this book, expect IPv6 designs to use a /64 prefix length.
|
This section does walk you through the different parts of IPv6 subnetting, while mostly using examples that use a /64 prefix length.|This section does walk you through the different parts of IPv6 subnetting, while mostly using examples that use a /64 prefix length.
The discussion defines the rules about which addresses should be in the same subnet and which addresses need to be in different subnets.|The discussion defines the rules about which addresses should be in the same subnet and which addresses need to be in different subnets.
|
Plus this section looks at how to analyze the global routing prefix and associated prefix length to find all the IPv6 prefixes (subnet IDs) and the addresses in each subnet.|Plus this section looks at how to analyze the global routing prefix and associated prefix length to find all the IPv6 prefixes (subnet IDs) and the addresses in each subnet.
|
NOTE If the IPv4 subnetting concepts are a little vague, you might want to reread Chapter 11, “Perspectives on IPv4 Subnetting,” which discusses the subnetting concepts for IPv4.|NOTE If the IPv4 subnetting concepts are a little vague, you might want to reread Chapter 11, “Perspectives on IPv4 Subnetting,” which discusses the subnetting concepts for IPv4.
##### Deciding Where IPv6 Subnets Are Needed
Deciding Where IPv6 Subnets Are Needed   
__|__
--|--
|
First, IPv6 and IPv4 both use the same concepts about where a subnet is needed: one for each VLAN and one for each point-to-point WAN connection (serial and Ethernet).|First, IPv6 and IPv4 both use the same concepts about where a subnet is needed: one for each VLAN and one for each point-to-point WAN connection (serial and Ethernet).
Figure 23-3 shows an example of the idea, using the small enterprise internetwork of Company 1.|Figure 23-3 shows an example of the idea, using the small enterprise internetwork of Company 1.
|
Company 1 has two LANs, with a point-to-point serial link connecting the sites.|Company 1 has two LANs, with a point-to-point serial link connecting the sites.
It also has an Ethernet WAN link connected to an ISP. Using the same logic you would use for IPv4, Company 1 needs four IPv6 subnets.|It also has an Ethernet WAN link connected to an ISP. Using the same logic you would use for IPv4, Company 1 needs four IPv6 subnets.
|
Figure 23-3 Locations for IPv6 Subnets|Figure 23-3 Locations for IPv6 Subnets
##### The Mechanics of Subnetting IPv6 Global Unicast Addresses
The Mechanics of Subnetting IPv6 Global Unicast Addresses   
__|__
--|--
|
To understand how to subnet your one large block of IPv6 addresses, you need to understand some of the theory and mechanisms IPv6 uses.|To understand how to subnet your one large block of IPv6 addresses, you need to understand some of the theory and mechanisms IPv6 uses.
To learn those details, it can help to compare IPv6 with some similar concepts from IPv4.|To learn those details, it can help to compare IPv6 with some similar concepts from IPv4.
|
With IPv4, without subnetting, an address has two parts: a network part and a host part.|With IPv4, without subnetting, an address has two parts: a network part and a host part.
|
Class A, B, and C rules define the length of the network part, with the host part making up the rest of the 32-bit IPv4 address, as shown in Figure 23-4.|Class A, B, and C rules define the length of the network part, with the host part making up the rest of the 32-bit IPv4 address, as shown in Figure 23-4.
|
Figure 23-4 Classful View of Unsubnetted IPv4 Networks To subnet an IPv4 Class A, B, or C network, the network engineer for the enterprise makes some choices.|Figure 23-4 Classful View of Unsubnetted IPv4 Networks To subnet an IPv4 Class A, B, or C network, the network engineer for the enterprise makes some choices.
Conceptually, the engineer creates a three-part view of the addresses, adding a subnet field in the center while shortening the host field. (Many people call this “borrowing host bits.”) The size of the network part stays locked per the Class A, B, and C rules, with the line between the subnet and host part being flexible, based on the choice of subnet mask.|Conceptually, the engineer creates a three-part view of the addresses, adding a subnet field in the center while shortening the host field. (Many people call this “borrowing host bits.”) The size of the network part stays locked per the Class A, B, and C rules, with the line between the subnet and host part being flexible, based on the choice of subnet mask.
Figure 23-5 shows the idea for a subnetted Class B network.|Figure 23-5 shows the idea for a subnetted Class B network.
|
Figure 23-5 Classful View of Subnetted IPv4 Networks IPv6 uses a similar concept, with the details in Figure 23-6.|Figure 23-5 Classful View of Subnetted IPv4 Networks IPv6 uses a similar concept, with the details in Figure 23-6.
The structure shows three major parts, beginning with the global routing prefix, which is the initial value that must be the same in all IPv6 addresses inside the enterprise.|The structure shows three major parts, beginning with the global routing prefix, which is the initial value that must be the same in all IPv6 addresses inside the enterprise.
The address ends with the interface ID, which acts like the IPv4 host field.|The address ends with the interface ID, which acts like the IPv4 host field.
The subnet field sits between the two other fields, used as a way to number and identify subnets, much like the subnet field in IPv4 addresses.|The subnet field sits between the two other fields, used as a way to number and identify subnets, much like the subnet field in IPv4 addresses.
|
Figure 23-6 Structure of Subnetted IPv6 Global Unicast Addresses First, just think about the general idea with IPv6, comparing Figure 23-6 to Figure 23-5.|Figure 23-6 Structure of Subnetted IPv6 Global Unicast Addresses First, just think about the general idea with IPv6, comparing Figure 23-6 to Figure 23-5.
The IPv6 global routing prefix (the prefix/length assigned by the RIR or ISP) acts like the IPv4 network part of the address structure.|The IPv6 global routing prefix (the prefix/length assigned by the RIR or ISP) acts like the IPv4 network part of the address structure.
The IPv6 subnet part acts like the IPv4 subnet part.|The IPv6 subnet part acts like the IPv4 subnet part.
|
And the right side of the IPv6, formally called the interface ID (short for interface identifier), acts like the IPv4 host field.|And the right side of the IPv6, formally called the interface ID (short for interface identifier), acts like the IPv4 host field.
|
Now focus on the IPv6 global routing prefix and its prefix length.|Now focus on the IPv6 global routing prefix and its prefix length.
Unlike IPv4, IPv6 has no concept of address classes, so no preset rules determine the prefix length of the global routing prefix.|Unlike IPv4, IPv6 has no concept of address classes, so no preset rules determine the prefix length of the global routing prefix.
However, when a company applies to an ISP, RIR, or any other organization that can assign a global routing prefix, that assignment includes both the prefix and the prefix length.|However, when a company applies to an ISP, RIR, or any other organization that can assign a global routing prefix, that assignment includes both the prefix and the prefix length.
After a company receives a global routing prefix and that prefix length, the length of the prefix typically does not change over time and is basically locked. (Note that the prefix length of the global routing prefix is often between /32 and /48, or possibly as long as /56.)|After a company receives a global routing prefix and that prefix length, the length of the prefix typically does not change over time and is basically locked. (Note that the prefix length of the global routing prefix is often between /32 and /48, or possibly as long as /56.)
|
Next, look to the right side of Figure 23-6 to the interface ID field.|Next, look to the right side of Figure 23-6 to the interface ID field.
For several reasons that become more obvious the more you learn about IPv6, this field is often 64 bits long.|For several reasons that become more obvious the more you learn about IPv6, this field is often 64 bits long.
Does it have to be 64 bits long?|Does it have to be 64 bits long?
No. However, using a 64-bit interface ID field works well in real networks, and there are no reasons to avoid using a 64-bit interface ID field.|No. However, using a 64-bit interface ID field works well in real networks, and there are no reasons to avoid using a 64-bit interface ID field.
|
Finally, look to the subnet field in the center of Figure 23-6.|Finally, look to the subnet field in the center of Figure 23-6.
Similar to IPv4, this field creates a place with which to number IPv6 subnets.|Similar to IPv4, this field creates a place with which to number IPv6 subnets.
The length of the subnet field is based on the other two facts: the length of the global routing prefix and the length of the interface ID. And with the commonly used 64-bit interface ID field, the subnet field is typically 64–P bits, with P being the length of the global routing prefix.|The length of the subnet field is based on the other two facts: the length of the global routing prefix and the length of the interface ID. And with the commonly used 64-bit interface ID field, the subnet field is typically 64–P bits, with P being the length of the global routing prefix.
|
Next, consider the structure of a specific global unicast IPv6 address, 2001:0DB8:1111:0001:0000:0000:0000:0001, as seen in Figure 23-7.|Next, consider the structure of a specific global unicast IPv6 address, 2001:0DB8:1111:0001:0000:0000:0000:0001, as seen in Figure 23-7.
In this case:|In this case:
###### The company was assigned prefix 2001:0DB8:1111, with prefix length /48.
The company was assigned prefix 2001:0DB8:1111, with prefix length /48.   
###### The company uses the usual 64-bit interface ID.
The company uses the usual 64-bit interface ID.   
###### The company has a subnet field of 16 bits, allowing for 216 IPv6 subnets.
The company has a subnet field of 16 bits, allowing for 216 IPv6 subnets.   
__|__
--|--
|
Figure 23-7 Address Structure for Company 1 Example The example in Figure 23-7, along with a little math, shows one reason why so many companies use a /64 prefix length for all subnets.|Figure 23-7 Address Structure for Company 1 Example The example in Figure 23-7, along with a little math, shows one reason why so many companies use a /64 prefix length for all subnets.
With this structure, Company 1 can support 216 possible subnets (65,536).|With this structure, Company 1 can support 216 possible subnets (65,536).
Few companies need that many subnets.|Few companies need that many subnets.
Then, each subnet supports over 1018 addresses per subnet (264, minus some reserved values).|Then, each subnet supports over 1018 addresses per subnet (264, minus some reserved values).
So, for both subnets and hosts, the address structure supports far more than are needed.|So, for both subnets and hosts, the address structure supports far more than are needed.
Plus, the /64 prefix length for all subnets makes the math simple because it cuts the 128-bit IPv6 address in half.|Plus, the /64 prefix length for all subnets makes the math simple because it cuts the 128-bit IPv6 address in half.
##### Listing the IPv6 Subnet Identifier
Listing the IPv6 Subnet Identifier   
__|__
--|--
|
Like with IPv4, IPv6 needs to identify each IPv6 subnet with some kind of a subnet identifier, or subnet ID. Figure 23-7 lists the informal names for this number (subnet ID) and the more formal name (prefix ID). Routers then list the IPv6 subnet ID in routing tables, along with the prefix length.|Like with IPv4, IPv6 needs to identify each IPv6 subnet with some kind of a subnet identifier, or subnet ID. Figure 23-7 lists the informal names for this number (subnet ID) and the more formal name (prefix ID). Routers then list the IPv6 subnet ID in routing tables, along with the prefix length.
|
Chapter 22, “Fundamentals of IP Version 6,” already discussed how to find the subnet ID, given an IPv6 address and prefix length.|Chapter 22, “Fundamentals of IP Version 6,” already discussed how to find the subnet ID, given an IPv6 address and prefix length.
The math works the same way when working with global unicast addresses, as well as the unique local addresses discussed later in the chapter.|The math works the same way when working with global unicast addresses, as well as the unique local addresses discussed later in the chapter.
|
Chapter 28, “Securing Wireless Networks,” has already discussed the math, but for completeness, note that the subnet ID shown in Figure 23-7 would be 2001:DB8:1111:1::/64|Chapter 28, “Securing Wireless Networks,” has already discussed the math, but for completeness, note that the subnet ID shown in Figure 23-7 would be 2001:DB8:1111:1::/64
##### List All IPv6 Subnets
List All IPv6 Subnets   
__|__
--|--
|
With IPv4, if you choose to use a single subnet mask for all subnets, you can sit and write down all the subnets of a Class A, B, or C network using that one subnet mask.|With IPv4, if you choose to use a single subnet mask for all subnets, you can sit and write down all the subnets of a Class A, B, or C network using that one subnet mask.
With IPv6, the same ideas apply.|With IPv6, the same ideas apply.
If you plan to use a single prefix length for all subnets, you can start with the global routing prefix and write down all the IPv6 subnet IDs as well.|If you plan to use a single prefix length for all subnets, you can start with the global routing prefix and write down all the IPv6 subnet IDs as well.
|
To find all the subnet IDs, you simply need to find all the unique values that will fit inside the subnet part of the IPv6 address, basically following these rules:|To find all the subnet IDs, you simply need to find all the unique values that will fit inside the subnet part of the IPv6 address, basically following these rules:
###### All subnet IDs begin with the global routing prefix.
All subnet IDs begin with the global routing prefix.   
###### Use a different value in the subnet field to identify each different subnet.
Use a different value in the subnet field to identify each different subnet.   
###### All subnet IDs have all 0s in the interface ID.
All subnet IDs have all 0s in the interface ID.   
__|__
--|--
|
As an example, take the IPv6 design shown in Figure 23-7, and think about all the subnet IDs. First, all subnets will use the commonly used /64 prefix length.|As an example, take the IPv6 design shown in Figure 23-7, and think about all the subnet IDs. First, all subnets will use the commonly used /64 prefix length.
This company uses a global routing prefix of 2001:0DB8:1111::/48, which defines the first 12 hex digits of all the subnet IDs. To find all the possible IPv6 subnet IDs, think of all the combinations of unique values in the fourth quartet and then represent the last four quartets of all 0s with a :: symbol.|This company uses a global routing prefix of 2001:0DB8:1111::/48, which defines the first 12 hex digits of all the subnet IDs. To find all the possible IPv6 subnet IDs, think of all the combinations of unique values in the fourth quartet and then represent the last four quartets of all 0s with a :: symbol.
|
Figure 23-8 shows the beginning of just such a list.|Figure 23-8 shows the beginning of just such a list.
|
Figure 23-8 First 16 Possible Subnets with a 16-bit Subnet Field in This Example The example allows for 65,536 subnets, so clearly the example will not list all the possible subnets.|Figure 23-8 First 16 Possible Subnets with a 16-bit Subnet Field in This Example The example allows for 65,536 subnets, so clearly the example will not list all the possible subnets.
However, in that fourth quartet, all combinations of hex values would be allowed.|However, in that fourth quartet, all combinations of hex values would be allowed.
|
NOTE The IPv6 subnet ID, more formally called the subnet router anycast address, is reserved and should not be used as an IPv6 address for any host.|NOTE The IPv6 subnet ID, more formally called the subnet router anycast address, is reserved and should not be used as an IPv6 address for any host.
##### Assign Subnets to the Internetwork Topology
Assign Subnets to the Internetwork Topology   
__|__
--|--
|
After an engineer lists all the possible subnet IDs (based on the subnet design), the next step is to choose which subnet ID to use for each link that needs an IPv6 subnet.|After an engineer lists all the possible subnet IDs (based on the subnet design), the next step is to choose which subnet ID to use for each link that needs an IPv6 subnet.
Just like with IPv4, each VLAN, each serial link, each Ethernet WAN link, and many other data-link instances need an IPv6 subnet.|Just like with IPv4, each VLAN, each serial link, each Ethernet WAN link, and many other data-link instances need an IPv6 subnet.
|
Figure 23-9 shows an example using Company 1 again.|Figure 23-9 shows an example using Company 1 again.
The figure uses the four subnets from Figure 23-8 that have check marks beside them.|The figure uses the four subnets from Figure 23-8 that have check marks beside them.
The check marks are just a reminder to not use those four subnets in other locations.|The check marks are just a reminder to not use those four subnets in other locations.
|
Figure 23-9 Subnets in Company 1, with Global Routing Prefix of 2001:0DB8:1111::/48|Figure 23-9 Subnets in Company 1, with Global Routing Prefix of 2001:0DB8:1111::/48
#### Assigning Addresses to Hosts in a Subnet
Assigning Addresses to Hosts in a Subnet   
__|__
--|--
|
Now that the engineer has planned which IPv6 subnet will be used in each location, the individual IPv6 addressing can be planned and implemented.|Now that the engineer has planned which IPv6 subnet will be used in each location, the individual IPv6 addressing can be planned and implemented.
Each address must be unique, in that no other host interface uses the same IPv6 address.|Each address must be unique, in that no other host interface uses the same IPv6 address.
Also, the hosts cannot use the subnet ID itself.|Also, the hosts cannot use the subnet ID itself.
|
The process of assigning IPv6 addresses to interfaces works similarly to IPv4.|The process of assigning IPv6 addresses to interfaces works similarly to IPv4.
Addresses can be configured statically, along with the prefix length, default router, and Domain Name System (DNS) IPv6 addresses.|Addresses can be configured statically, along with the prefix length, default router, and Domain Name System (DNS) IPv6 addresses.
Alternatively, hosts can learn these same settings dynamically, using either Dynamic Host Configuration Protocol (DHCP) or a built-in IPv6 mechanism called Stateless Address Autoconfiguration (SLAAC).|Alternatively, hosts can learn these same settings dynamically, using either Dynamic Host Configuration Protocol (DHCP) or a built-in IPv6 mechanism called Stateless Address Autoconfiguration (SLAAC).
|
For example, Figure 23-10 shows some static IP addresses that could be chosen for the router interfaces based on the subnet choices shown in Figure 23-9.|For example, Figure 23-10 shows some static IP addresses that could be chosen for the router interfaces based on the subnet choices shown in Figure 23-9.
In each case, the router interfaces use an interface ID that is a relatively low number, easily remembered.|In each case, the router interfaces use an interface ID that is a relatively low number, easily remembered.
|
Figure 23-10 Example Static IPv6 Addresses Based on the Subnet Design of Figure 23-9 This chapter puts off the details of how to configure the IPv6 addresses until Chapter 24, “Implementing IPv6 Addressing on Routers.”|Figure 23-10 Example Static IPv6 Addresses Based on the Subnet Design of Figure 23-9 This chapter puts off the details of how to configure the IPv6 addresses until Chapter 24, “Implementing IPv6 Addressing on Routers.”
### Unique Local Unicast Addresses
Unique Local Unicast Addresses   
__|__
--|--
|
Unique local unicast addresses act as private IPv6 addresses.|Unique local unicast addresses act as private IPv6 addresses.
These addresses have many similarities with global unicast addresses, particularly in how to subnet.|These addresses have many similarities with global unicast addresses, particularly in how to subnet.
The biggest difference lies in the literal number (unique local addresses begin with hex FD) and with the administrative process: the unique local prefixes are not registered with any numbering authority and can be used by multiple organizations.|The biggest difference lies in the literal number (unique local addresses begin with hex FD) and with the administrative process: the unique local prefixes are not registered with any numbering authority and can be used by multiple organizations.
|
Although the network engineer creates unique local addresses without any registration or assignment process, the addresses still need to follow some rules, as follows:|Although the network engineer creates unique local addresses without any registration or assignment process, the addresses still need to follow some rules, as follows:
###### Use FD as the first two hex digits.
Use FD as the first two hex digits.   
###### Choose a unique 40-bit global ID.
Choose a unique 40-bit global ID.   
###### Append the global ID to FD to create a 48-bit prefix, used as the prefix for all your
Append the global ID to FD to create a 48-bit prefix, used as the prefix for all your   
__|__
--|--
|
addresses.|addresses.
###### Use the next 16 bits as a subnet field.
Use the next 16 bits as a subnet field.   
###### Note that the structure leaves a convenient 64-bit interface ID field.
Note that the structure leaves a convenient 64-bit interface ID field.   
__|__
--|--
|
Figure 23-11 shows the format of these unique local unicast addresses.|Figure 23-11 shows the format of these unique local unicast addresses.
|
Figure 23-11 IPv6 Unique Local Unicast Address Format NOTE Just to be completely exact, IANA actually reserves prefix FC00::/7, and not FD00::/8, for these addresses.|Figure 23-11 IPv6 Unique Local Unicast Address Format NOTE Just to be completely exact, IANA actually reserves prefix FC00::/7, and not FD00::/8, for these addresses.
FC00::/7 includes all addresses that begin with hex FC and FD. However, an RFC (4193) requires the eighth bit of these addresses to be set to 1, which means that in practice today, the unique local addresses all begin with their first two digits as FD.|FC00::/7 includes all addresses that begin with hex FC and FD. However, an RFC (4193) requires the eighth bit of these addresses to be set to 1, which means that in practice today, the unique local addresses all begin with their first two digits as FD.
#### Subnetting with Unique Local IPv6 Addresses
Subnetting with Unique Local IPv6 Addresses   
__|__
--|--
|
Subnetting using unique local addresses works just like subnetting with global unicast addresses with a 48-bit global routing prefix.|Subnetting using unique local addresses works just like subnetting with global unicast addresses with a 48-bit global routing prefix.
The only difference is that with global unicasts, you start by asking for a global routing prefix to be assigned to your company, and that global routing prefix might or might not have a /48 prefix length.|The only difference is that with global unicasts, you start by asking for a global routing prefix to be assigned to your company, and that global routing prefix might or might not have a /48 prefix length.
With unique local, you create that prefix locally, and the prefix begins with /48, with the first 8 bits set and the next 40 bits randomly chosen.|With unique local, you create that prefix locally, and the prefix begins with /48, with the first 8 bits set and the next 40 bits randomly chosen.
|
The process can be as simple as choosing a 40-bit value as your global ID. These 40 bits require 10 hex digits, so you can even avoid thinking in binary and just make up a unique 10-hex-digit value and add hex FD to the front.|The process can be as simple as choosing a 40-bit value as your global ID. These 40 bits require 10 hex digits, so you can even avoid thinking in binary and just make up a unique 10-hex-digit value and add hex FD to the front.
For example, imagine you chose a 10-hex-digit value of hex 00 0001 0001, prepend a hex FD, making the entire prefix be FD00:0001:0001::/48, or FD00:1:1::/48 when abbreviated.|For example, imagine you chose a 10-hex-digit value of hex 00 0001 0001, prepend a hex FD, making the entire prefix be FD00:0001:0001::/48, or FD00:1:1::/48 when abbreviated.
|
To create subnets, just as you did in the earlier examples with a 48-bit global routing prefix, treat the entire fourth quartet as a subnet field, as shown in Figure 23-11.|To create subnets, just as you did in the earlier examples with a 48-bit global routing prefix, treat the entire fourth quartet as a subnet field, as shown in Figure 23-11.
|
Figure 23-12 shows an example subnetting plan using unique local addresses.|Figure 23-12 shows an example subnetting plan using unique local addresses.
The example repeats the same topology shown earlier in Figure 23-9; that figure showed subnetting with a global unicast prefix.|The example repeats the same topology shown earlier in Figure 23-9; that figure showed subnetting with a global unicast prefix.
This example uses the exact same numbers for the fourth quartet’s subnet field, simply replacing the 48-bit global unicast prefix with this new local unique prefix of FD00:1:1.|This example uses the exact same numbers for the fourth quartet’s subnet field, simply replacing the 48-bit global unicast prefix with this new local unique prefix of FD00:1:1.
|
Figure 23-12 Subnetting Using Unique Local Addresses|Figure 23-12 Subnetting Using Unique Local Addresses
#### The Need for Globally Unique Local Addresses
The Need for Globally Unique Local Addresses   
__|__
--|--
|
The example in Figure 23-12 shows an easy-to-remember prefix of FD00:1:1::/48.|The example in Figure 23-12 shows an easy-to-remember prefix of FD00:1:1::/48.
Clearly, I made up the easy-to-remember global ID in this example.|Clearly, I made up the easy-to-remember global ID in this example.
What global ID would you choose for your company?|What global ID would you choose for your company?
Would you pick a number that you could not abbreviate and make it shorter?|Would you pick a number that you could not abbreviate and make it shorter?
If you had to pick the IPv6 prefix for your unique local addresses from the options in the following list, which would you pick for your company?|If you had to pick the IPv6 prefix for your unique local addresses from the options in the following list, which would you pick for your company?
###### FDE9:81BE:A059::/48
FDE9:81BE:A059::/48   
###### FDF0:E1D2:C3B4::/48
FDF0:E1D2:C3B4::/48   
###### FD00:1:1::/48
FD00:1:1::/48   
__|__
--|--
|
Given freedom to choose, most people would pick an easy-to-remember, short-to-type prefix, like FD00:1:1::/48.|Given freedom to choose, most people would pick an easy-to-remember, short-to-type prefix, like FD00:1:1::/48.
And in a lab or other small network used for testing, making up an easy-to-use number is reasonable.|And in a lab or other small network used for testing, making up an easy-to-use number is reasonable.
However, for use in real corporate networks, you should not just make up any global ID you like; you should try to follow the unique local address rules that strive to help make your addresses unique in the universe—even without registering a prefix with an ISP or RIR.|However, for use in real corporate networks, you should not just make up any global ID you like; you should try to follow the unique local address rules that strive to help make your addresses unique in the universe—even without registering a prefix with an ISP or RIR.
|
RFC 4193 defines unique local addresses, and that RFC stresses the importance of choosing your global ID in a way to make it statistically unlikely to be used by other companies.|RFC 4193 defines unique local addresses, and that RFC stresses the importance of choosing your global ID in a way to make it statistically unlikely to be used by other companies.
What is the result of unique global IDs at every company?|What is the result of unique global IDs at every company?
Making all these unique local addresses unique across the globe.|Making all these unique local addresses unique across the globe.
So, if you do plan on using unique local addresses in a real network, plan on using the random number generator logic listed in RFC 4193 to create your prefix.|So, if you do plan on using unique local addresses in a real network, plan on using the random number generator logic listed in RFC 4193 to create your prefix.
|
One of the big reasons to attempt to use a unique prefix, rather than everyone using the same easy-to-remember prefixes, is to be ready for the day that your company merges with or buys another company.|One of the big reasons to attempt to use a unique prefix, rather than everyone using the same easy-to-remember prefixes, is to be ready for the day that your company merges with or buys another company.
Today, with IPv4, a high percentage of companies use private IPv4 network 10.0.0.0.|Today, with IPv4, a high percentage of companies use private IPv4 network 10.0.0.0.
When they merge their networks, the fact that both use network 10.0.0.0 makes the network merger more painful than if the companies had used different private IPv4 networks.|When they merge their networks, the fact that both use network 10.0.0.0 makes the network merger more painful than if the companies had used different private IPv4 networks.
With IPv6 unique local addresses, if both companies did the right thing and randomly chose a prefix, they will most likely be using completely different prefixes, making the merger much simpler.|With IPv6 unique local addresses, if both companies did the right thing and randomly chose a prefix, they will most likely be using completely different prefixes, making the merger much simpler.
However, companies that take the seemingly easy way out and choose an easy-to-remember prefix like FD00:1:1 greatly increase their risk of requiring extra effort when merging with another company that also chose to use that same prefix.|However, companies that take the seemingly easy way out and choose an easy-to-remember prefix like FD00:1:1 greatly increase their risk of requiring extra effort when merging with another company that also chose to use that same prefix.
### Chapter Review
Chapter Review   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|One key to doing well on the exams is to perform repetitive spaced review sessions.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.
Refer to the “Your Study Plan” element for more details.|Refer to the “Your Study Plan” element for more details.
Table 23-3 outlines the key review elements and where you can find them.|Table 23-3 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 23-3 Chapter Review Tracking Table end.|Table 23-3 Chapter Review Tracking Table end.
|
Review All the Key Topics Key Terms You Should Know global unicast address, global routing prefix, unique local address, subnet ID (prefix ID), subnet router anycast address|Review All the Key Topics Key Terms You Should Know global unicast address, global routing prefix, unique local address, subnet ID (prefix ID), subnet router anycast address
## Chapter 24 Implementing IPv6 Addressing on Routers
Chapter 24 Implementing IPv6 Addressing on Routers   
__|__
--|--
|
Routers This chapter covers the following exam topics:|Routers This chapter covers the following exam topics:
###### 1.0 Network Fundamentals
1.0 Network Fundamentals   
###### 1.9 Compare and contrast IPv6 address types
1.9 Compare and contrast IPv6 address types   
###### 1.9.a Global unicast
1.9.a Global unicast   
###### 1.9.b Unique local
1.9.b Unique local   
###### 1.9.c Link local
1.9.c Link local   
###### 1.9.d Anycast
1.9.d Anycast   
###### 1.9.e Multicast
1.9.e Multicast   
###### 1.9.f Modified EUI 64
1.9.f Modified EUI 64   
__|__
--|--
|
With IPv4 addressing, some devices, like servers and routers, typically use static predefined IPv4 addresses.|With IPv4 addressing, some devices, like servers and routers, typically use static predefined IPv4 addresses.
End-user devices do not mind if their address changes from time to time, and they typically learn an IPv4 address dynamically using DHCP. IPv6 uses the same approach, with servers, routers, and other devices in the control of the IT group often using predefined IPv6 addresses, and with end-user devices using dynamically learned IPv6 addresses.|End-user devices do not mind if their address changes from time to time, and they typically learn an IPv4 address dynamically using DHCP. IPv6 uses the same approach, with servers, routers, and other devices in the control of the IT group often using predefined IPv6 addresses, and with end-user devices using dynamically learned IPv6 addresses.
|
This chapter focuses on IPv6 address configuration on routers.|This chapter focuses on IPv6 address configuration on routers.
The chapter begins with the more obvious IPv6 addressing configuration, with features that mirror IPv4 features, showing how to configure interfaces with IPv6 addresses and view that configuration with show commands.|The chapter begins with the more obvious IPv6 addressing configuration, with features that mirror IPv4 features, showing how to configure interfaces with IPv6 addresses and view that configuration with show commands.
The second half of the chapter introduces new IPv6 addressing concepts, showing some other addresses used by routers when doing different tasks.|The second half of the chapter introduces new IPv6 addressing concepts, showing some other addresses used by routers when doing different tasks.
### “Do I Know This Already?” Quiz
“Do I Know This Already?” Quiz   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.
The letter answers are listed at the bottom of the page following the quiz.|The letter answers are listed at the bottom of the page following the quiz.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.
You can also find both answers and explanations in the PTP testing software.|You can also find both answers and explanations in the PTP testing software.
|
Table 24-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Table 24-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping
### Foundation Topics
Foundation Topics   
### Implementing Unicast IPv6 Addresses on Routers
Implementing Unicast IPv6 Addresses on Routers   
__|__
--|--
|
Special Addresses Used by Routers 4–5 CHAPTER 24 1.|Special Addresses Used by Routers 4–5 CHAPTER 24 1.
Router R1 has an interface named Gigabit Ethernet 0/1, whose MAC address has been set to 0200.0001.000A.|Router R1 has an interface named Gigabit Ethernet 0/1, whose MAC address has been set to 0200.0001.000A.
Which of the following commands, added in R1’s Gigabit Ethernet 0/1 configuration mode, gives this router’s G0/1 interface a unicast IPv6 address of 2001:1:1:1:1:200:1:A, with a /64 prefix length?|Which of the following commands, added in R1’s Gigabit Ethernet 0/1 configuration mode, gives this router’s G0/1 interface a unicast IPv6 address of 2001:1:1:1:1:200:1:A, with a /64 prefix length?
|
a. ipv6 address 2001:1:1:1:1:200:1:A/64 b. ipv6 address 2001:1:1:1:1:200:1:A/64 eui-64 c. ipv6 address 2001:1:1:1:1:200:1:A /64 eui-64 d. ipv6 address 2001:1:1:1:1:200:1:A /64 e.|a. ipv6 address 2001:1:1:1:1:200:1:A/64 b. ipv6 address 2001:1:1:1:1:200:1:A/64 eui-64 c. ipv6 address 2001:1:1:1:1:200:1:A /64 eui-64 d. ipv6 address 2001:1:1:1:1:200:1:A /64 e.
None of the other answers are correct.|None of the other answers are correct.
|
2. Router R1 has an interface named Gigabit Ethernet 0/1, whose MAC address has been set to 5055.4444.3333.|2. Router R1 has an interface named Gigabit Ethernet 0/1, whose MAC address has been set to 5055.4444.3333.
This interface has been configured with the ipv6 address 2000:1:1:1::/64 eui-64 subcommand.|This interface has been configured with the ipv6 address 2000:1:1:1::/64 eui-64 subcommand.
What unicast address will this interface use?|What unicast address will this interface use?
|
a. 2000:1:1:1:52FF:FE55:4444:3333 b. 2000:1:1:1:5255:44FF:FE44:3333 c. 2000:1:1:1:5255:4444:33FF:FE33 d. 2000:1:1:1:200:FF:FE00:0 3.|a. 2000:1:1:1:52FF:FE55:4444:3333 b. 2000:1:1:1:5255:44FF:FE44:3333 c. 2000:1:1:1:5255:4444:33FF:FE33 d. 2000:1:1:1:200:FF:FE00:0 3.
Router R1 currently supports IPv4, routing packets in and out all its interfaces.|Router R1 currently supports IPv4, routing packets in and out all its interfaces.
R1’s configuration needs to be migrated to support dual-stack operation, routing both IPv4 and IPv6.|R1’s configuration needs to be migrated to support dual-stack operation, routing both IPv4 and IPv6.
Which of the following tasks must be performed before the router can also support routing IPv6 packets? (Choose two answers.)|Which of the following tasks must be performed before the router can also support routing IPv6 packets? (Choose two answers.)
|
a. Enable IPv6 on each interface using an ipv6 address interface subcommand.|a. Enable IPv6 on each interface using an ipv6 address interface subcommand.
|
b. Enable support for both versions with the ip versions 4 6 global command.|b. Enable support for both versions with the ip versions 4 6 global command.
|
c. Additionally enable IPv6 routing using the ipv6 unicast-routing global command.|c. Additionally enable IPv6 routing using the ipv6 unicast-routing global command.
|
d. Migrate to dual-stack routing using the ip routing dual-stack global command.|d. Migrate to dual-stack routing using the ip routing dual-stack global command.
|
4. Router R1 has an interface named Gigabit Ethernet 0/1, whose MAC address has been set to 0200.0001.000A.|4. Router R1 has an interface named Gigabit Ethernet 0/1, whose MAC address has been set to 0200.0001.000A.
The interface is then configured with the ipv6 address 2001:1:1:1:200:FF:FE01:B/64 interface subcommand; no other ipv6 address commands are configured on the interface.|The interface is then configured with the ipv6 address 2001:1:1:1:200:FF:FE01:B/64 interface subcommand; no other ipv6 address commands are configured on the interface.
Which of the following answers lists the linklocal address used on the interface?|Which of the following answers lists the linklocal address used on the interface?
|
a. FE80::FF:FE01:A b.|a. FE80::FF:FE01:A b.
FE80::FF:FE01:B c.|FE80::FF:FE01:B c.
FE80::200:FF:FE01:A d.|FE80::200:FF:FE01:A d.
FE80::200:FF:FE01:B 5.|FE80::200:FF:FE01:B 5.
Which of the following multicast addresses is defined as the address for sending packets to only the IPv6 routers on the local link?|Which of the following multicast addresses is defined as the address for sending packets to only the IPv6 routers on the local link?
|
a. FF02::1 b.|a. FF02::1 b.
FF02::2 c.|FF02::2 c.
FF02::5 d.|FF02::5 d.
FF02::A Foundation Topics Implementing Unicast IPv6 Addresses on Routers Every company bases its enterprise network on one or more protocol models, or protocol stacks.|FF02::A Foundation Topics Implementing Unicast IPv6 Addresses on Routers Every company bases its enterprise network on one or more protocol models, or protocol stacks.
In the earlier days of networking, enterprise networks used one or more protocol stacks from different vendors, as shown on the left of Figure 24-1.|In the earlier days of networking, enterprise networks used one or more protocol stacks from different vendors, as shown on the left of Figure 24-1.
Over time, companies added TCP/IP (based on IPv4) to the mix.|Over time, companies added TCP/IP (based on IPv4) to the mix.
Eventually, companies migrated fully to TCP/IP as the only protocol stack in use.|Eventually, companies migrated fully to TCP/IP as the only protocol stack in use.
|
Figure 24-1 Migration of Enterprise Networks to Use TCP/IP Stack Only, IPv4 The emergence of IPv6 requires that IPv6 be implemented in end-user hosts, servers, routers, and other devices.|Figure 24-1 Migration of Enterprise Networks to Use TCP/IP Stack Only, IPv4 The emergence of IPv6 requires that IPv6 be implemented in end-user hosts, servers, routers, and other devices.
However, corporations cannot just migrate all devices from IPv4 to IPv6 over one weekend.|However, corporations cannot just migrate all devices from IPv4 to IPv6 over one weekend.
Instead, what will likely occur is some kind of long-term migration and coexistence, in which for a large number of years, most corporate networks again use multiple protocol stacks—one based on IPv4 and one based on IPv6.|Instead, what will likely occur is some kind of long-term migration and coexistence, in which for a large number of years, most corporate networks again use multiple protocol stacks—one based on IPv4 and one based on IPv6.
|
Eventually, over time, we might all see the day when enterprise networks run only IPv6, without any IPv4 remaining, but that day might take awhile.|Eventually, over time, we might all see the day when enterprise networks run only IPv6, without any IPv4 remaining, but that day might take awhile.
Figure 24-2 shows the progression, just to make the point, but who knows how long it will take?|Figure 24-2 shows the progression, just to make the point, but who knows how long it will take?
|
One way to add IPv6 support to an established IPv4-based enterprise internetwork is to implement a dual-stack strategy.|One way to add IPv6 support to an established IPv4-based enterprise internetwork is to implement a dual-stack strategy.
To do so, the routers can be configured to route IPv6 packets, with IPv6 addresses on their interfaces, with a similar model to how routers support IPv4.|To do so, the routers can be configured to route IPv6 packets, with IPv6 addresses on their interfaces, with a similar model to how routers support IPv4.
Then hosts can implement IPv6 when ready, running both IPv4 and IPv6 (dual stacks).|Then hosts can implement IPv6 when ready, running both IPv4 and IPv6 (dual stacks).
|
The first major section of this chapter shows how to configure and verify unicast IPv6 addresses on routers.|The first major section of this chapter shows how to configure and verify unicast IPv6 addresses on routers.
|
Figure 24-2 Possible Path Through Dual-Stack (IPv4 and IPv6) over a Long Period|Figure 24-2 Possible Path Through Dual-Stack (IPv4 and IPv6) over a Long Period
#### Static Unicast Address Configuration
Static Unicast Address Configuration   
__|__
--|--
|
Cisco routers give us two options for static configuration of IPv6 addresses.|Cisco routers give us two options for static configuration of IPv6 addresses.
In one case, you configure the full 128-bit address, while in the other, you configure a 64-bit prefix and let the router derive the second half of the address (the interface ID). The next few pages show how to configure both options and how the router chooses the second half of the IPv6 address.|In one case, you configure the full 128-bit address, while in the other, you configure a 64-bit prefix and let the router derive the second half of the address (the interface ID). The next few pages show how to configure both options and how the router chooses the second half of the IPv6 address.
##### Configuring the Full 128-Bit Address
Configuring the Full 128-Bit Address   
__|__
--|--
|
To statically configure the full 128-bit unicast address—either global unicast or unique local—the router needs an ipv6 address address/prefix-length interface subcommand on each interface.|To statically configure the full 128-bit unicast address—either global unicast or unique local—the router needs an ipv6 address address/prefix-length interface subcommand on each interface.
The address can be an abbreviated IPv6 address or the full 32-digit hex address.|The address can be an abbreviated IPv6 address or the full 32-digit hex address.
The command includes the prefix length value, at the end, with no space between the address and prefix length.|The command includes the prefix length value, at the end, with no space between the address and prefix length.
|
The configuration of the router interface IPv6 address really is that simple.|The configuration of the router interface IPv6 address really is that simple.
Figure 24-3, along with Examples 24-1 and 24-2, shows a basic example.|Figure 24-3, along with Examples 24-1 and 24-2, shows a basic example.
The figure shows the global unicast IPv6 address used by two different routers, on two interfaces each.|The figure shows the global unicast IPv6 address used by two different routers, on two interfaces each.
As usual, all subnets use a /64 prefix length.|As usual, all subnets use a /64 prefix length.
|
Figure 24-3 Sample 128-bit IPv6 Addresses to Be Configured on Cisco Router Interfaces Example 24-1 Configuring Static IPv6 Addresses on R1 Example end.|Figure 24-3 Sample 128-bit IPv6 Addresses to Be Configured on Cisco Router Interfaces Example 24-1 Configuring Static IPv6 Addresses on R1 Example end.
|
Example 24-2 Configuring Static IPv6 Addresses on R2 Example end.|Example 24-2 Configuring Static IPv6 Addresses on R2 Example end.
|
NOTE The configuration on R1 in Example 24-1 uses both abbreviated and unabbreviated addresses, and both lowercase and uppercase hex digits, showing that all are allowed.|NOTE The configuration on R1 in Example 24-1 uses both abbreviated and unabbreviated addresses, and both lowercase and uppercase hex digits, showing that all are allowed.
Router show commands list the abbreviated value with uppercase hex digits.|Router show commands list the abbreviated value with uppercase hex digits.
##### Enabling IPv6 Routing
Enabling IPv6 Routing   
__|__
--|--
|
While the configurations shown in Examples 24-1 and 24-2 focus on the IPv6 address configuration, they also include an important but often overlooked step when configuring IPv6 on Cisco routers: IPv6 routing needs to be enabled.|While the configurations shown in Examples 24-1 and 24-2 focus on the IPv6 address configuration, they also include an important but often overlooked step when configuring IPv6 on Cisco routers: IPv6 routing needs to be enabled.
On Cisco routers, IPv4 routing is enabled by default, but IPv6 routing is not enabled by default.|On Cisco routers, IPv4 routing is enabled by default, but IPv6 routing is not enabled by default.
The solution takes only a single command—ipv6 unicast-routing—which enables IPv6 routing on the router.|The solution takes only a single command—ipv6 unicast-routing—which enables IPv6 routing on the router.
|
A router must enable IPv6 globally (ipv6 unicast-routing) and enable IPv6 on the interface (ipv6 address) before the router will attempt to route IPv6 packets in and out an interface.|A router must enable IPv6 globally (ipv6 unicast-routing) and enable IPv6 on the interface (ipv6 address) before the router will attempt to route IPv6 packets in and out an interface.
|
If you omit the ipv6 unicast-routing command but configure interface IPv6 addresses, the router will not route any received IPv6 packets, but the router will act as an IPv6 host.|If you omit the ipv6 unicast-routing command but configure interface IPv6 addresses, the router will not route any received IPv6 packets, but the router will act as an IPv6 host.
If you include the ipv6 unicast-routing command but omit all the interface IPv6 addresses, the router will be ready to route IPv6 packets but have no interfaces that have IPv6 enabled, effectively disabling IPv6 routing.|If you include the ipv6 unicast-routing command but omit all the interface IPv6 addresses, the router will be ready to route IPv6 packets but have no interfaces that have IPv6 enabled, effectively disabling IPv6 routing.
##### Verifying the IPv6 Address Configuration
Verifying the IPv6 Address Configuration   
__|__
--|--
|
IPv6 uses many show commands that mimic the syntax of IPv4 show commands.|IPv6 uses many show commands that mimic the syntax of IPv4 show commands.
For example:|For example:
###### The show ipv6 interface brief command gives you interface IPv6 address info, but not
The show ipv6 interface brief command gives you interface IPv6 address info, but not   
__|__
--|--
|
prefix length info, similar to the IPv4 show ip interface brief command.|prefix length info, similar to the IPv4 show ip interface brief command.
###### The show ipv6 interface command gives the details of IPv6 interface settings, much like
The show ipv6 interface command gives the details of IPv6 interface settings, much like   
__|__
--|--
|
the show ip interface command does for IPv4.|the show ip interface command does for IPv4.
|
The one notable difference in the most common commands is that the show interfaces command still lists the IPv4 address and mask but tells us nothing about IPv6.|The one notable difference in the most common commands is that the show interfaces command still lists the IPv4 address and mask but tells us nothing about IPv6.
So, to see IPv6 interface addresses, use commands that begin with show ipv6.|So, to see IPv6 interface addresses, use commands that begin with show ipv6.
Example 24-3 lists a few samples from Router R1, with the explanations following.|Example 24-3 lists a few samples from Router R1, with the explanations following.
|
Example 24-3 Verifying Static IPv6 Addresses on Router R1 Example end.|Example 24-3 Verifying Static IPv6 Addresses on Router R1 Example end.
|
First, focus on the output of the two show ipv6 interface commands at the top of the example, which lists interface G0/0, showing output about that interface only.|First, focus on the output of the two show ipv6 interface commands at the top of the example, which lists interface G0/0, showing output about that interface only.
Note that the output lists the configured IPv6 address and prefix length, as well as the IPv6 subnet (2001:DB8:1111:1::/64), which the router calculated based on the IPv6 address.|Note that the output lists the configured IPv6 address and prefix length, as well as the IPv6 subnet (2001:DB8:1111:1::/64), which the router calculated based on the IPv6 address.
|
The end of the example lists the output of the show ipv6 interface brief command.|The end of the example lists the output of the show ipv6 interface brief command.
Similar to the IPv4-focused show ip interface brief command, this command lists IPv6 addresses, but not the prefix length or prefixes.|Similar to the IPv4-focused show ip interface brief command, this command lists IPv6 addresses, but not the prefix length or prefixes.
This command also lists all interfaces on the router, whether or not IPv6 is enabled on the interfaces.|This command also lists all interfaces on the router, whether or not IPv6 is enabled on the interfaces.
For example, in this case, the only two interfaces on R1 that have an IPv6 address are G0/0 and G0/0/0, as configured earlier in Example 24-1.|For example, in this case, the only two interfaces on R1 that have an IPv6 address are G0/0 and G0/0/0, as configured earlier in Example 24-1.
|
Beyond the IPv6 addresses on the interfaces, the router also adds IPv6 connected routes to the IPv6 routing table off each interface.|Beyond the IPv6 addresses on the interfaces, the router also adds IPv6 connected routes to the IPv6 routing table off each interface.
Just as with IPv4, the router keeps these connected routes in the IPv6 routing table only when the interface is in a working (up/up) state.|Just as with IPv4, the router keeps these connected routes in the IPv6 routing table only when the interface is in a working (up/up) state.
But if the interface has an IPv6 unicast address configured, and the interface is working, the router adds the connected routes.|But if the interface has an IPv6 unicast address configured, and the interface is working, the router adds the connected routes.
Example 24-4 shows the connected IPv6 on Router R1 from Figure 24-3.|Example 24-4 shows the connected IPv6 on Router R1 from Figure 24-3.
|
Example 24-4 Displaying Connected IPv6 Routes on Router R1 Example end.|Example 24-4 Displaying Connected IPv6 Routes on Router R1 Example end.
##### Generating a Unique Interface ID Using Modified EUI-64
Generating a Unique Interface ID Using Modified EUI-64   
__|__
--|--
|
IPv6 follows the same general model as IPv4 regarding which types of devices typically use static, predefined addresses and which use dynamically learned address.|IPv6 follows the same general model as IPv4 regarding which types of devices typically use static, predefined addresses and which use dynamically learned address.
For example, routers inside an enterprise use static IPv4 addresses, while end-user devices typically learn their IPv4 address using DHCP. With IPv6, routers also typically use static IPv6 addresses, while user devices use DHCP or Stateless Address Auto Configuration (SLAAC) to dynamically learn their IPv6 address.|For example, routers inside an enterprise use static IPv4 addresses, while end-user devices typically learn their IPv4 address using DHCP. With IPv6, routers also typically use static IPv6 addresses, while user devices use DHCP or Stateless Address Auto Configuration (SLAAC) to dynamically learn their IPv6 address.
|
Even though engineers typically choose to use stable and predictable IPv6 interface addresses, IOS supports two different methods to configure a stable address.|Even though engineers typically choose to use stable and predictable IPv6 interface addresses, IOS supports two different methods to configure a stable address.
One method uses the ipv6 address command to define the entire 128-bit address, as shown in Examples 24-1 and 24-2.|One method uses the ipv6 address command to define the entire 128-bit address, as shown in Examples 24-1 and 24-2.
The other method uses this same ipv6 address command, but the command configures only the 64-bit IPv6 prefix for the interface and lets the router automatically generate a unique interface ID.|The other method uses this same ipv6 address command, but the command configures only the 64-bit IPv6 prefix for the interface and lets the router automatically generate a unique interface ID.
|
This second method uses rules called modified EUI-64 (extended unique identifier).|This second method uses rules called modified EUI-64 (extended unique identifier).
Often, in the context of IPv6 addressing, people refer to modified EUI-64 as just EUI-64; there is no other term or concept about EUI-64 that you need to know for IPv6.|Often, in the context of IPv6 addressing, people refer to modified EUI-64 as just EUI-64; there is no other term or concept about EUI-64 that you need to know for IPv6.
The configuration that uses EUI-64 includes a keyword to tell the router to use EUI-64 rules, along with the 64-bit prefix.|The configuration that uses EUI-64 includes a keyword to tell the router to use EUI-64 rules, along with the 64-bit prefix.
|
The router then uses EUI-64 rules to create the interface ID part of the address, as follows:|The router then uses EUI-64 rules to create the interface ID part of the address, as follows:
|
1. Split the 6-byte (12-hex-digit) MAC address in two halves (6 hex digits each).|1. Split the 6-byte (12-hex-digit) MAC address in two halves (6 hex digits each).
|
2. Insert FFFE in between the two, making the interface ID now have a total of 16 hex digits (64 bits).|2. Insert FFFE in between the two, making the interface ID now have a total of 16 hex digits (64 bits).
|
3. Invert the seventh bit of the interface ID.|3. Invert the seventh bit of the interface ID.
|
Figure 24-4 shows the major pieces of how the address is formed.|Figure 24-4 shows the major pieces of how the address is formed.
|
Figure 24-4 IPv6 Address Format with Interface ID and EUI-64 NOTE You can find a video about the EUI-64 process on the companion website, in the Chapter Review section for this chapter.|Figure 24-4 IPv6 Address Format with Interface ID and EUI-64 NOTE You can find a video about the EUI-64 process on the companion website, in the Chapter Review section for this chapter.
|
Although this process might seem a bit convoluted, it works.|Although this process might seem a bit convoluted, it works.
Also, with a little practice, you can look at an IPv6 address and quickly notice the FFFE in the middle of the interface ID and then easily find the two halves of the corresponding interface’s MAC address.|Also, with a little practice, you can look at an IPv6 address and quickly notice the FFFE in the middle of the interface ID and then easily find the two halves of the corresponding interface’s MAC address.
But you need to be ready to do the same math, in this case to predict the EUI-64 formatted IPv6 address on an interface.|But you need to be ready to do the same math, in this case to predict the EUI-64 formatted IPv6 address on an interface.
|
For example, if you ignore the final step of inverting the seventh bit, the rest of the steps just require that you move the pieces around.|For example, if you ignore the final step of inverting the seventh bit, the rest of the steps just require that you move the pieces around.
Figure 24-5 shows two examples, just so you see the process.|Figure 24-5 shows two examples, just so you see the process.
|
Figure 24-5 Two Examples of Most of the EUI-64 Interface ID Process Both examples follow the same process.|Figure 24-5 Two Examples of Most of the EUI-64 Interface ID Process Both examples follow the same process.
Each starts with the MAC address, breaking it into two halves (Step 2).|Each starts with the MAC address, breaking it into two halves (Step 2).
The third step inserts FFFE in the middle, and the fourth step inserts a colon every four hex digits, keeping with IPv6 conventions.|The third step inserts FFFE in the middle, and the fourth step inserts a colon every four hex digits, keeping with IPv6 conventions.
|
While the examples in Figure 24-5 show most of the steps, they omit the final step.|While the examples in Figure 24-5 show most of the steps, they omit the final step.
The final step requires that you convert the first byte (first two hex digits) from hex to binary, invert the seventh of the 8 bits, and convert the bits back to hex.|The final step requires that you convert the first byte (first two hex digits) from hex to binary, invert the seventh of the 8 bits, and convert the bits back to hex.
Inverting a bit means that if the bit is a 0, make it a 1; if it is a 1, make it a 0.|Inverting a bit means that if the bit is a 0, make it a 1; if it is a 1, make it a 0.
Most of the time, with IPv6 addresses, the original bit will be 0 and will be inverted to a 1.|Most of the time, with IPv6 addresses, the original bit will be 0 and will be inverted to a 1.
|
For example, Figure 24-6 completes the two examples from Figure 24-5, focusing only on the first two hex digits.|For example, Figure 24-6 completes the two examples from Figure 24-5, focusing only on the first two hex digits.
The examples show each pair of hex digits (Step 1) and the binary equivalent (Step 2).|The examples show each pair of hex digits (Step 1) and the binary equivalent (Step 2).
Step 3 shows a copy of those same 8 bits, except the seventh bit is inverted;|Step 3 shows a copy of those same 8 bits, except the seventh bit is inverted;
|
the example on the left inverts from 0 to 1, and the example on the right inverts from 1 to 0.|the example on the left inverts from 0 to 1, and the example on the right inverts from 1 to 0.
Finally, the bits are converted back to hex at Step 4.|Finally, the bits are converted back to hex at Step 4.
|
Figure 24-6 Inverting the Seventh Bit of an EUI-64 Interface ID Field NOTE If you do not remember how to do hex-to-binary conversions, take a few moments to review the process.|Figure 24-6 Inverting the Seventh Bit of an EUI-64 Interface ID Field NOTE If you do not remember how to do hex-to-binary conversions, take a few moments to review the process.
If you memorize the 16 hex values for digits 0 through F, with the corresponding binary values, the conversion can be easy.|If you memorize the 16 hex values for digits 0 through F, with the corresponding binary values, the conversion can be easy.
If you do not have those handy in your memory, take a few moments to look at Table A-2 in Appendix A, “Numeric Reference Tables.”|If you do not have those handy in your memory, take a few moments to look at Table A-2 in Appendix A, “Numeric Reference Tables.”
|
For those of you who prefer the decimal shortcuts, with a little memorization you can do the bit-flip math without doing any hex-binary conversions.|For those of you who prefer the decimal shortcuts, with a little memorization you can do the bit-flip math without doing any hex-binary conversions.
First, note that the process to invert the seventh bit, when working with a hexadecimal IPv6 address, flips the third of 4 bits in a single hex digit.|First, note that the process to invert the seventh bit, when working with a hexadecimal IPv6 address, flips the third of 4 bits in a single hex digit.
With only 16 single hex digits, you could memorize what each hex digit becomes if its third bit is inverted, and you can easily memorize those values with a visual process.|With only 16 single hex digits, you could memorize what each hex digit becomes if its third bit is inverted, and you can easily memorize those values with a visual process.
|
If you want to try to memorize the values, it helps to work through the following process a few times, so grab a piece of scratch paper.|If you want to try to memorize the values, it helps to work through the following process a few times, so grab a piece of scratch paper.
Then write the 16 single hex digits as shown on the left side of Figure 24-7.|Then write the 16 single hex digits as shown on the left side of Figure 24-7.
That is, write them in eight rows of two numbers each, with the spacing as directed in the figure.|That is, write them in eight rows of two numbers each, with the spacing as directed in the figure.
|
Next, start at the top of the lists and draw arrow lines between two numbers in the same column on the top left (0 and 2).|Next, start at the top of the lists and draw arrow lines between two numbers in the same column on the top left (0 and 2).
Then move down the left-side column, connecting the next two digits (4 and 6) with an arrow line, then 8 and A, and then C and E.|Then move down the left-side column, connecting the next two digits (4 and 6) with an arrow line, then 8 and A, and then C and E.
Repeat the process on the right, re-creating the right side of Figure 24-7.|Repeat the process on the right, re-creating the right side of Figure 24-7.
|
Figure 24-7 A Mnemonic Device to Help Memorize Bit Inversion Shortcut The figure you drew (and the right side of Figure 24-7) shows the hex digits which, when you invert their third bit, convert to the other.|Figure 24-7 A Mnemonic Device to Help Memorize Bit Inversion Shortcut The figure you drew (and the right side of Figure 24-7) shows the hex digits which, when you invert their third bit, convert to the other.
That is, 0 converts to 2; 2 converts to 0; 1 converts to 3; 3 converts to 1; 4 converts to 6; 6 converts to 4; and so on.|That is, 0 converts to 2; 2 converts to 0; 1 converts to 3; 3 converts to 1; 4 converts to 6; 6 converts to 4; and so on.
So, on the exam, if you can remember the pattern to redraw Figure 24-7, you could avoid doing binary/hexadecimal conversion.|So, on the exam, if you can remember the pattern to redraw Figure 24-7, you could avoid doing binary/hexadecimal conversion.
Use whichever approach makes you more comfortable.|Use whichever approach makes you more comfortable.
|
As usual, the best way to get comfortable with forming these EUI-64 interface IDs is to calculate some yourself.|As usual, the best way to get comfortable with forming these EUI-64 interface IDs is to calculate some yourself.
Table 24-2 lists some practice problems, with an IPv6 64-bit prefix in the first column and the MAC address in the second column.|Table 24-2 lists some practice problems, with an IPv6 64-bit prefix in the first column and the MAC address in the second column.
Your job is to calculate the full (unabbreviated) IPv6 address using EUI-64 rules.|Your job is to calculate the full (unabbreviated) IPv6 address using EUI-64 rules.
The answers are at the end of the chapter, in the section “Answers to Earlier Practice Problems.”|The answers are at the end of the chapter, in the section “Answers to Earlier Practice Problems.”
|
Table 24-2 IPv6 EUI-64 Address Creation Practice Table end.|Table 24-2 IPv6 EUI-64 Address Creation Practice Table end.
|
Configuring a router interface to use the EUI-64 format uses the ipv6 address address/|Configuring a router interface to use the EUI-64 format uses the ipv6 address address/
|
prefix-length eui-64 interface subcommand.|prefix-length eui-64 interface subcommand.
The eui-64 keyword tells the router to find the interface MAC address and do the EUI-64 conversion math to find the interface ID.|The eui-64 keyword tells the router to find the interface MAC address and do the EUI-64 conversion math to find the interface ID.
|
Example 24-5 shows a revised configuration on Router R1, as compared to the earlier Example 24-1.|Example 24-5 shows a revised configuration on Router R1, as compared to the earlier Example 24-1.
In this case, R1 uses EUI-64 formatting for its IPv6 addresses.|In this case, R1 uses EUI-64 formatting for its IPv6 addresses.
|
Example 24-5 Configuring R1’s IPv6 Interfaces Using EUI-64 Example end.|Example 24-5 Configuring R1’s IPv6 Interfaces Using EUI-64 Example end.
|
The example uses only Ethernet interfaces, all of which have a universal MAC address to use to create their EUI-64 interface IDs. However, in this case, the configuration includes the mac-address command under R1’s G0/0 interface, which causes IOS to use the configured MAC address instead of the universal (burned-in) MAC address.|The example uses only Ethernet interfaces, all of which have a universal MAC address to use to create their EUI-64 interface IDs. However, in this case, the configuration includes the mac-address command under R1’s G0/0 interface, which causes IOS to use the configured MAC address instead of the universal (burned-in) MAC address.
Interface G0/0/0 defaults to use its universal MAC address.|Interface G0/0/0 defaults to use its universal MAC address.
Following that math:|Following that math:
|
G0/0 – MAC 0201.AA00.0001 – Interface ID 0001.AAFF.FE00.0001 G0/0 – MAC 30F7.0D29.8568 – Interface ID 32F7.0DFF.FE29.8568 Also, be aware that for interfaces that do not have a MAC address, like serial interfaces, the router uses the MAC of the lowest-numbered router interface that does have a MAC.|G0/0 – MAC 0201.AA00.0001 – Interface ID 0001.AAFF.FE00.0001 G0/0 – MAC 30F7.0D29.8568 – Interface ID 32F7.0DFF.FE29.8568 Also, be aware that for interfaces that do not have a MAC address, like serial interfaces, the router uses the MAC of the lowest-numbered router interface that does have a MAC.
|
NOTE When you use EUI-64, the address value in the ipv6 address command should be the prefix, not the full 128-bit IPv6 address.|NOTE When you use EUI-64, the address value in the ipv6 address command should be the prefix, not the full 128-bit IPv6 address.
However, if you mistakenly type the full address and still use the eui-64 keyword, IOS accepts the command and converts the address to the matching prefix before putting the command into the running config file.|However, if you mistakenly type the full address and still use the eui-64 keyword, IOS accepts the command and converts the address to the matching prefix before putting the command into the running config file.
For example, IOS converts ipv6 address 2000:1:1:1::1/64 eui-64 to ipv6 address 2000:1:1:1::/64 eui-64.|For example, IOS converts ipv6 address 2000:1:1:1::1/64 eui-64 to ipv6 address 2000:1:1:1::/64 eui-64.
#### Dynamic Unicast Address Configuration
Dynamic Unicast Address Configuration   
__|__
--|--
|
In most cases, network engineers will configure the IPv6 addresses of router interfaces so that the addresses do not change until the engineer changes the router configuration.|In most cases, network engineers will configure the IPv6 addresses of router interfaces so that the addresses do not change until the engineer changes the router configuration.
|
However, routers can be configured to use dynamically learned IPv6 addresses.|However, routers can be configured to use dynamically learned IPv6 addresses.
These can be useful for routers connecting to the Internet through some types of Internet access technologies, like DSL and cable modems.|These can be useful for routers connecting to the Internet through some types of Internet access technologies, like DSL and cable modems.
|
Cisco routers support two ways for the router interface to dynamically learn an IPv6 address to use:|Cisco routers support two ways for the router interface to dynamically learn an IPv6 address to use:
###### Stateful DHCP
Stateful DHCP   
###### Stateless Address Autoconfiguration (SLAAC)
Stateless Address Autoconfiguration (SLAAC)   
__|__
--|--
|
Both methods use the familiar ipv6 address command.|Both methods use the familiar ipv6 address command.
Of course, neither option configures the actual IPv6 address; instead, the commands configure a keyword that tells the router which method to use to learn its IPv6 address.|Of course, neither option configures the actual IPv6 address; instead, the commands configure a keyword that tells the router which method to use to learn its IPv6 address.
Example 24-6 shows the configuration, with one interface using stateful DHCP and one using SLAAC.|Example 24-6 shows the configuration, with one interface using stateful DHCP and one using SLAAC.
|
Example 24-6 Router Configuration to Learn IPv6 Addresses with DHCP and SLAAC Example end.|Example 24-6 Router Configuration to Learn IPv6 Addresses with DHCP and SLAAC Example end.
### Special Addresses Used by Routers
Special Addresses Used by Routers   
__|__
--|--
|
IPv6 configuration on a router begins with the simple steps discussed in the first part of this chapter.|IPv6 configuration on a router begins with the simple steps discussed in the first part of this chapter.
After you configure the ipv6 unicast-routing global configuration command, to enable the function of IPv6 routing, the addition of a unicast IPv6 address on an interface causes the router to do the following:|After you configure the ipv6 unicast-routing global configuration command, to enable the function of IPv6 routing, the addition of a unicast IPv6 address on an interface causes the router to do the following:
###### Gives the interface a unicast IPv6 address
Gives the interface a unicast IPv6 address   
###### Enables the routing of IPv6 packets in/out that interface
Enables the routing of IPv6 packets in/out that interface   
###### Defines the IPv6 prefix (subnet) that exists off that interface
Defines the IPv6 prefix (subnet) that exists off that interface   
###### Tells the router to add a connected IPv6 route for that prefix, to the IPv6 routing table,
Tells the router to add a connected IPv6 route for that prefix, to the IPv6 routing table,   
__|__
--|--
|
when that interface is up/up NOTE In fact, if you pause and look at the list again, the same ideas happen for IPv4 when you configure an IPv4 address on a router interface.|when that interface is up/up NOTE In fact, if you pause and look at the list again, the same ideas happen for IPv4 when you configure an IPv4 address on a router interface.
|
While all the IPv6 features in this list work much like similar features in IPv4, IPv6 also has a number of additional functions not seen in IPv4.|While all the IPv6 features in this list work much like similar features in IPv4, IPv6 also has a number of additional functions not seen in IPv4.
Often, these additional functions use other IPv6 addresses, many of which are multicast addresses.|Often, these additional functions use other IPv6 addresses, many of which are multicast addresses.
This second major section of the chapter examines the additional IPv6 addresses seen on routers, with a brief description of how they are used.|This second major section of the chapter examines the additional IPv6 addresses seen on routers, with a brief description of how they are used.
#### Link-Local Addresses
Link-Local Addresses   
__|__
--|--
|
IPv6 uses link-local addresses as a special kind of unicast IPv6 address.|IPv6 uses link-local addresses as a special kind of unicast IPv6 address.
These addresses are not used for normal IPv6 packet flows that contain data for applications.|These addresses are not used for normal IPv6 packet flows that contain data for applications.
Instead, these addresses are used by some overhead protocols and for routing.|Instead, these addresses are used by some overhead protocols and for routing.
This next topic first looks at how IPv6 uses link-local addresses and then how routers create link-local addresses.|This next topic first looks at how IPv6 uses link-local addresses and then how routers create link-local addresses.
##### Link-Local Address Concepts
Link-Local Address Concepts   
__|__
--|--
|
IPv6 defines rules so that packets sent to any link-local address should not be forwarded by any router to another subnet.|IPv6 defines rules so that packets sent to any link-local address should not be forwarded by any router to another subnet.
As a result, several IPv6 protocols make use of link-local addresses when the protocol’s messages need to stay within the local LAN. For example, Neighbor Discovery Protocol (NDP), which replaces the functions of IPv4’s ARP, uses linklocal addresses.|As a result, several IPv6 protocols make use of link-local addresses when the protocol’s messages need to stay within the local LAN. For example, Neighbor Discovery Protocol (NDP), which replaces the functions of IPv4’s ARP, uses linklocal addresses.
|
Routers also use link-local addresses as the next-hop IP addresses in IPv6 routes, as shown in Figure 24-8.|Routers also use link-local addresses as the next-hop IP addresses in IPv6 routes, as shown in Figure 24-8.
IPv6 hosts also use a default router (default gateway) concept, like IPv4, but instead of the router address being in the same subnet, hosts refer to the router’s link-local address.|IPv6 hosts also use a default router (default gateway) concept, like IPv4, but instead of the router address being in the same subnet, hosts refer to the router’s link-local address.
The show ipv6 route command lists the link-local address of the neighboring router, rather than the global unicast or unique local unicast address.|The show ipv6 route command lists the link-local address of the neighboring router, rather than the global unicast or unique local unicast address.
|
Figure 24-8 IPv6 Using Link-Local Addresses as the Next-Hop Address Following are some key facts about link-local addresses:|Figure 24-8 IPv6 Using Link-Local Addresses as the Next-Hop Address Following are some key facts about link-local addresses:
|
Unicast (not multicast): Link-local addresses represent a single host, and packets sent to a link-local address should be processed by only that one IPv6 host.|Unicast (not multicast): Link-local addresses represent a single host, and packets sent to a link-local address should be processed by only that one IPv6 host.
|
Forwarding scope is the local link only: Packets sent to a link-local address do not leave the local data link because routers do not forward packets with link-local destination addresses.|Forwarding scope is the local link only: Packets sent to a link-local address do not leave the local data link because routers do not forward packets with link-local destination addresses.
|
Automatically generated: Every IPv6 host interface (and router interface) can create its own link-local address automatically, solving some initialization problems for hosts before they learn a dynamically learned global unicast address.|Automatically generated: Every IPv6 host interface (and router interface) can create its own link-local address automatically, solving some initialization problems for hosts before they learn a dynamically learned global unicast address.
|
Common uses: Link-local addresses are used for some overhead protocols that stay local to one subnet and as the next-hop address for IPv6 routes.|Common uses: Link-local addresses are used for some overhead protocols that stay local to one subnet and as the next-hop address for IPv6 routes.
##### Creating Link-Local Addresses on Routers
Creating Link-Local Addresses on Routers   
__|__
--|--
|
IPv6 hosts and routers can calculate their own link-local address, for each interface, using some basic rules.|IPv6 hosts and routers can calculate their own link-local address, for each interface, using some basic rules.
First, all link-local addresses start with the same prefix, as shown on the left side of Figure 24-9.|First, all link-local addresses start with the same prefix, as shown on the left side of Figure 24-9.
By definition, the first 10 bits must match prefix FE80::/10, meaning that the first three hex digits will be either FE8, FE9, FEA, or FEB. However, when following the RFC, the next 54 bits should be binary 0, so the link-local address should always start with FE80:0000:0000:0000 as the first four unabbreviated quartets.|By definition, the first 10 bits must match prefix FE80::/10, meaning that the first three hex digits will be either FE8, FE9, FEA, or FEB. However, when following the RFC, the next 54 bits should be binary 0, so the link-local address should always start with FE80:0000:0000:0000 as the first four unabbreviated quartets.
|
Figure 24-9 Link-Local Address Format The second half of the link-local address, in practice, can be formed using EUI-64 rules, can be randomly generated, or even configured.|Figure 24-9 Link-Local Address Format The second half of the link-local address, in practice, can be formed using EUI-64 rules, can be randomly generated, or even configured.
Cisco routers use the EUI-64 format to create the interface ID (see the earlier section “Generating a Unique Interface ID Using Modified EUI-64”).|Cisco routers use the EUI-64 format to create the interface ID (see the earlier section “Generating a Unique Interface ID Using Modified EUI-64”).
As a result, a router’s complete link-local address should be unique because the MAC address that feeds into the EUI-64 process should be unique.|As a result, a router’s complete link-local address should be unique because the MAC address that feeds into the EUI-64 process should be unique.
|
Alternately, some OSs create their link-local addresses by randomly generating the interface ID. For example, Microsoft OSs use a somewhat random process to choose the interface ID and change it over time in an attempt to prevent some forms of attacks.|Alternately, some OSs create their link-local addresses by randomly generating the interface ID. For example, Microsoft OSs use a somewhat random process to choose the interface ID and change it over time in an attempt to prevent some forms of attacks.
|
IOS creates a link-local address for any interface that has configured at least one other unicast address using the ipv6 address command (global unicast or unique local).|IOS creates a link-local address for any interface that has configured at least one other unicast address using the ipv6 address command (global unicast or unique local).
To see the link-local address, just use the usual commands that also list the unicast IPv6 address: show ipv6 interface and show ipv6 interface brief.|To see the link-local address, just use the usual commands that also list the unicast IPv6 address: show ipv6 interface and show ipv6 interface brief.
Note that Example 24-7 shows an example from Router R1 just after it was configured as shown in Example 24-5 (with the eui-64 keyword on the ipv6 address commands).|Note that Example 24-7 shows an example from Router R1 just after it was configured as shown in Example 24-5 (with the eui-64 keyword on the ipv6 address commands).
|
Example 24-7 Comparing Link-Local Addresses with EUI-Generated Unicast Addresses Example end.|Example 24-7 Comparing Link-Local Addresses with EUI-Generated Unicast Addresses Example end.
|
First, examine the two pairs of highlighted entries in the example.|First, examine the two pairs of highlighted entries in the example.
For each of the two interfaces that have a global unicast address (G0/0 and G0/0/0), the output lists the global unicast, which happens to begin with 2001 in this case.|For each of the two interfaces that have a global unicast address (G0/0 and G0/0/0), the output lists the global unicast, which happens to begin with 2001 in this case.
At the same time, the output also lists the link-local address for each interface, beginning with FE80.|At the same time, the output also lists the link-local address for each interface, beginning with FE80.
|
Next, focus on the two addresses listed under interface G0/0.|Next, focus on the two addresses listed under interface G0/0.
If you look closely at the second half of the two addresses listed for interface G0/0, you will see that both addresses have the same interface ID value.|If you look closely at the second half of the two addresses listed for interface G0/0, you will see that both addresses have the same interface ID value.
The global unicast address was configured in this case with the ipv6 address 2001:DB8:1111:1::/64 eui-64 command, so the router used EUI-64 logic to form both the global unicast address and the link-local address.|The global unicast address was configured in this case with the ipv6 address 2001:DB8:1111:1::/64 eui-64 command, so the router used EUI-64 logic to form both the global unicast address and the link-local address.
The interface MAC address in this case is 0201.AA00.0001, so the router calculates an interface ID portion of both addresses as 0001:AAFF:FE00:0001 (unabbreviated).|The interface MAC address in this case is 0201.AA00.0001, so the router calculates an interface ID portion of both addresses as 0001:AAFF:FE00:0001 (unabbreviated).
After abbreviation, Router R1’s linklocal address on interface G0/0 becomes FE80::AAFF:FE00:1.|After abbreviation, Router R1’s linklocal address on interface G0/0 becomes FE80::AAFF:FE00:1.
|
IOS can either automatically create the link-local address, or it can be configured.|IOS can either automatically create the link-local address, or it can be configured.
IOS chooses the link-local address for the interface based on the following rules:|IOS chooses the link-local address for the interface based on the following rules:
###### If configured, the router uses the value in the ipv6 address address link-local interface
If configured, the router uses the value in the ipv6 address address link-local interface   
__|__
--|--
|
subcommand.|subcommand.
Note that the configured link-local address must be from the correct address range for link-local addresses; that is, an address from prefix FE80::/10.|Note that the configured link-local address must be from the correct address range for link-local addresses; that is, an address from prefix FE80::/10.
In other words, the address must begin with FE8, FE9, FEA, or FEB.|In other words, the address must begin with FE8, FE9, FEA, or FEB.
###### If not configured, the IOS calculates the link-local address using EUI-64 rules, as discussed
If not configured, the IOS calculates the link-local address using EUI-64 rules, as discussed   
__|__
--|--
|
and demonstrated in and around Example 24-7.|and demonstrated in and around Example 24-7.
The calculation uses EUI-64 rules even if the interface unicast address does not use EUI-64.|The calculation uses EUI-64 rules even if the interface unicast address does not use EUI-64.
##### Routing IPv6 with Only Link-Local Addresses on an Interface
Routing IPv6 with Only Link-Local Addresses on an Interface   
__|__
--|--
|
This chapter has shown four variations on the ipv6 address command so far.|This chapter has shown four variations on the ipv6 address command so far.
To review:|To review:
|
ipv6 address address/prefix-length: Static configuration of a specific address ipv6 address prefix/prefix-length eui-64: Static configuration of a specific prefix and prefix length, with the router calculating the interface ID using EUI-64 rules ipv6 address dhcp: Dynamic learning on the address and prefix length using DHCP ipv6 address autoconfig: Dynamic learning of the prefix and prefix length, with the router calculating the interface ID using EUI-64 rules (SLAAC)|ipv6 address address/prefix-length: Static configuration of a specific address ipv6 address prefix/prefix-length eui-64: Static configuration of a specific prefix and prefix length, with the router calculating the interface ID using EUI-64 rules ipv6 address dhcp: Dynamic learning on the address and prefix length using DHCP ipv6 address autoconfig: Dynamic learning of the prefix and prefix length, with the router calculating the interface ID using EUI-64 rules (SLAAC)
|
This next short topic completes the list with the following command:|This next short topic completes the list with the following command:
|
ipv6 enable: Enables IPv6 processing and adds a link-local address, but adds no other unicast IPv6 addresses.|ipv6 enable: Enables IPv6 processing and adds a link-local address, but adds no other unicast IPv6 addresses.
|
The purpose of the ipv6 enable command will not make sense until you realize that some links, particularly WAN links, do not need a global unicast address.|The purpose of the ipv6 enable command will not make sense until you realize that some links, particularly WAN links, do not need a global unicast address.
Using the backdrop of Figure 24-10, think about the destination of packets sent by hosts like PC1 and PC2. When PC1 sends PC2 an IPv6 packet, the packet holds PC1’s and PC2’s IPv6 addresses and never contains the WAN link’s IPv6 addresses.|Using the backdrop of Figure 24-10, think about the destination of packets sent by hosts like PC1 and PC2. When PC1 sends PC2 an IPv6 packet, the packet holds PC1’s and PC2’s IPv6 addresses and never contains the WAN link’s IPv6 addresses.
PC1 and PC2 may need to know the routers’ LAN IPv6 addresses, to use as their default gateway, but the hosts do not need to know the routers’|PC1 and PC2 may need to know the routers’ LAN IPv6 addresses, to use as their default gateway, but the hosts do not need to know the routers’
|
WAN interface addresses.|WAN interface addresses.
|
Figure 24-10 Typical Use of the ipv6 enable Command Additionally, the routers do not need to have global unicast (or unique local) addresses on the WAN links for routing to work.|Figure 24-10 Typical Use of the ipv6 enable Command Additionally, the routers do not need to have global unicast (or unique local) addresses on the WAN links for routing to work.
IPv6 routing protocols use link-local addresses as the next-hop address when dynamically building IPv6 routes.|IPv6 routing protocols use link-local addresses as the next-hop address when dynamically building IPv6 routes.
Additionally, static routes, as discussed in Chapter 25, “Implementing IPv6 Routing,” can use link-local addresses for the next-hop address.|Additionally, static routes, as discussed in Chapter 25, “Implementing IPv6 Routing,” can use link-local addresses for the next-hop address.
|
In short, creating a WAN link with no global unicast (or unique local) addresses works.|In short, creating a WAN link with no global unicast (or unique local) addresses works.
As a result, you would not even need to assign an IPv6 subnet to each WAN link.|As a result, you would not even need to assign an IPv6 subnet to each WAN link.
Then to configure the WAN interfaces, use the ipv6 enable command, enabling IPv6 and giving each interface a generated link-local IPv6 address.|Then to configure the WAN interfaces, use the ipv6 enable command, enabling IPv6 and giving each interface a generated link-local IPv6 address.
|
To use the command, just configure the ipv6 enable command on the interfaces on both ends of the WAN link.|To use the command, just configure the ipv6 enable command on the interfaces on both ends of the WAN link.
##### IPv6 Multicast Addresses
IPv6 Multicast Addresses   
__|__
--|--
|
IPv6 uses multicast IPv6 addresses for several purposes.|IPv6 uses multicast IPv6 addresses for several purposes.
Like IPv4, IPv6 includes a range of multicast addresses that can be used by multicast applications, with many of the same fundamental concepts as IPv4 multicasts.|Like IPv4, IPv6 includes a range of multicast addresses that can be used by multicast applications, with many of the same fundamental concepts as IPv4 multicasts.
For instance, IANA defines the range FF30::/12 (all IPv6 addresses that begin with FF3) as the range of addresses to be used for some types of multicast applications.|For instance, IANA defines the range FF30::/12 (all IPv6 addresses that begin with FF3) as the range of addresses to be used for some types of multicast applications.
|
Additionally, different IPv6 RFCs reserve multicast addresses for specific purposes.|Additionally, different IPv6 RFCs reserve multicast addresses for specific purposes.
For instance, OSPFv3 uses FF02::5 and FF02::6 as the all-OSPF-routers and all-DR-Routers multicast addresses, respectively, similar to how OSPFv2 uses IPv4 addresses 224.0.0.5 and 224.0.0.6 for the equivalent purposes.|For instance, OSPFv3 uses FF02::5 and FF02::6 as the all-OSPF-routers and all-DR-Routers multicast addresses, respectively, similar to how OSPFv2 uses IPv4 addresses 224.0.0.5 and 224.0.0.6 for the equivalent purposes.
|
This next section focuses on IPv6 multicast addresses reserved for use with different protocols.|This next section focuses on IPv6 multicast addresses reserved for use with different protocols.
|
The first, link-local multicast addresses, are multicast addresses useful for communicating over a single link.|The first, link-local multicast addresses, are multicast addresses useful for communicating over a single link.
The other type is a special overhead multicast address calculated for each host, called the solicited-node multicast address.|The other type is a special overhead multicast address calculated for each host, called the solicited-node multicast address.
##### Reserved Multicast Addresses
Reserved Multicast Addresses   
__|__
--|--
|
Stop for a moment and think about some of the control plane protocols discussed throughout this book so far.|Stop for a moment and think about some of the control plane protocols discussed throughout this book so far.
Some of those IPv4 control plane protocols used IPv4 broadcasts, meaning that the packet destination address was either 255.255.255.255 (the address for all hosts in the local LAN) or the subnet broadcast address (the address for all hosts in that specific subnet).|Some of those IPv4 control plane protocols used IPv4 broadcasts, meaning that the packet destination address was either 255.255.255.255 (the address for all hosts in the local LAN) or the subnet broadcast address (the address for all hosts in that specific subnet).
Those broadcast packets were then sent as Ethernet broadcast frames, destined to the Ethernet broadcast address of FFFF.FFFF.FFFF.|Those broadcast packets were then sent as Ethernet broadcast frames, destined to the Ethernet broadcast address of FFFF.FFFF.FFFF.
|
While useful, the IPv4 approach of IPv4 broadcast and LAN broadcast requires every host in the VLAN to process the broadcast frame, even if only one other device needed to think about the message.|While useful, the IPv4 approach of IPv4 broadcast and LAN broadcast requires every host in the VLAN to process the broadcast frame, even if only one other device needed to think about the message.
Also, each host has to process the frame, then packet, read the type of message, and so on, before ignoring the task.|Also, each host has to process the frame, then packet, read the type of message, and so on, before ignoring the task.
For example, an IPv4 ARP Request—an IPv4 and LAN broadcast—requires a host to process the Ethernet, IP, and ARP details of the message before deciding whether to reply or not.|For example, an IPv4 ARP Request—an IPv4 and LAN broadcast—requires a host to process the Ethernet, IP, and ARP details of the message before deciding whether to reply or not.
|
IPv6, instead of using Layer 3 and Layer 2 broadcasts, instead uses Layer 3 multicast addresses, which in turn cause Ethernet frames to use Ethernet multicast addresses.|IPv6, instead of using Layer 3 and Layer 2 broadcasts, instead uses Layer 3 multicast addresses, which in turn cause Ethernet frames to use Ethernet multicast addresses.
As a result:|As a result:
###### All the hosts that should receive the message receive the message, which is necessary for
All the hosts that should receive the message receive the message, which is necessary for   
__|__
--|--
|
the protocols to work.|the protocols to work.
However…|However…
###### …Hosts that do not need to process the message can make that choice with much less
…Hosts that do not need to process the message can make that choice with much less   
__|__
--|--
|
processing as compared to IPv4.|processing as compared to IPv4.
|
For instance, OSPFv3 uses IPv6 multicast addresses FF02::5 and FF02::6.|For instance, OSPFv3 uses IPv6 multicast addresses FF02::5 and FF02::6.
In a subnet, the OSPFv3 routers will listen for packets sent to those addresses.|In a subnet, the OSPFv3 routers will listen for packets sent to those addresses.
However, all the endpoint hosts do not use OSPFv3 and should ignore those OSPFv3 messages.|However, all the endpoint hosts do not use OSPFv3 and should ignore those OSPFv3 messages.
If a host receives a packet with FF02::5 as the destination IPv6 address, the host can ignore the packet because the host knows it does not care about packets sent to that multicast address.|If a host receives a packet with FF02::5 as the destination IPv6 address, the host can ignore the packet because the host knows it does not care about packets sent to that multicast address.
That check takes much less time than the equivalent checks with IPv4.|That check takes much less time than the equivalent checks with IPv4.
|
Table 24-3 lists the most common reserved IPv6 multicast addresses.|Table 24-3 lists the most common reserved IPv6 multicast addresses.
|
Table 24-3 Key IPv6 Local-Scope Multicast Addresses Table end.|Table 24-3 Key IPv6 Local-Scope Multicast Addresses Table end.
|
NOTE An Internet search of “IPv6 Multicast Address Space Registry” will show the IANA page that lists all the reserved values and the RFC that defines the use of each address.|NOTE An Internet search of “IPv6 Multicast Address Space Registry” will show the IANA page that lists all the reserved values and the RFC that defines the use of each address.
|
Example 24-8 repeats the output of the show ipv6 interface command to show the multicast addresses used by Router R1 on its G0/0 interface.|Example 24-8 repeats the output of the show ipv6 interface command to show the multicast addresses used by Router R1 on its G0/0 interface.
In this case, the highlighted lines show the all-nodes address (FF02::1), all-routers (FF02::2), and two for OSPFv3 (FF02::5 and FF02::6).|In this case, the highlighted lines show the all-nodes address (FF02::1), all-routers (FF02::2), and two for OSPFv3 (FF02::5 and FF02::6).
Note that the IPv6 multicast addresses that the router interface is listening for and processing are listed under the heading “Joined group address(es):” at the top of the highlighted section of the output.|Note that the IPv6 multicast addresses that the router interface is listening for and processing are listed under the heading “Joined group address(es):” at the top of the highlighted section of the output.
|
Example 24-8 Verifying Static IPv6 Addresses on Router R1 Example end.|Example 24-8 Verifying Static IPv6 Addresses on Router R1 Example end.
##### Multicast Address Scopes
Multicast Address Scopes   
__|__
--|--
|
IPv6 RFC 4291 defines IPv6 addressing including the ideas of IPv6 address scope.|IPv6 RFC 4291 defines IPv6 addressing including the ideas of IPv6 address scope.
Each scope defines a different set of rules about whether routers should or should not forward a packet, and how far routers should forward packets, based on those scopes.|Each scope defines a different set of rules about whether routers should or should not forward a packet, and how far routers should forward packets, based on those scopes.
|
For instance, you read earlier in this chapter about the link-local address on an interface—a unicast IPv6 address—but with a link-local scope.|For instance, you read earlier in this chapter about the link-local address on an interface—a unicast IPv6 address—but with a link-local scope.
The scope definition called “link-local”|The scope definition called “link-local”
|
dictates that packets sent to a link-local unicast address should remain on the link and not be forwarded by any router.|dictates that packets sent to a link-local unicast address should remain on the link and not be forwarded by any router.
|
Most of the scope discussion in RFC 4291 applies to multicast addresses, using the term multicast scope.|Most of the scope discussion in RFC 4291 applies to multicast addresses, using the term multicast scope.
Per that RFC, the fourth digit of the multicast address identifies the scope, as noted in Table 24-4.|Per that RFC, the fourth digit of the multicast address identifies the scope, as noted in Table 24-4.
|
Table 24-4 IPv6 Multicast Scope Terms Table end.|Table 24-4 IPv6 Multicast Scope Terms Table end.
|
Breaking down the concepts a little further, packets sent to a multicast address with a linklocal scope should stay on the local link, that is, the local subnet.|Breaking down the concepts a little further, packets sent to a multicast address with a linklocal scope should stay on the local link, that is, the local subnet.
Hosts know they can process a link-local packet if received, as do routers.|Hosts know they can process a link-local packet if received, as do routers.
However, routers know to not route the packet to other subnets because of the scope.|However, routers know to not route the packet to other subnets because of the scope.
Packets with an organization-local scope should be routed inside the organization but not out to the Internet or over a link to another company. (Note that routers can predict the boundaries of some scopes, like link-local, but they need configuration to know the boundaries of other scopes, for instance, organizationlocal.)|Packets with an organization-local scope should be routed inside the organization but not out to the Internet or over a link to another company. (Note that routers can predict the boundaries of some scopes, like link-local, but they need configuration to know the boundaries of other scopes, for instance, organizationlocal.)
|
Comparing a few of the scopes in terms of where the packets can flow, the higher the value in the fourth hex digit, the further away from the sending host the scope allows the packet to be forwarded.|Comparing a few of the scopes in terms of where the packets can flow, the higher the value in the fourth hex digit, the further away from the sending host the scope allows the packet to be forwarded.
Table 24-4 shows that progression top to bottom, while Figure 24-11 shows an example with three scopes: link-local, site-local, and organization-local.|Table 24-4 shows that progression top to bottom, while Figure 24-11 shows an example with three scopes: link-local, site-local, and organization-local.
In the figure, site-local messages do not cross the WAN, and organization-local messages do not leave the organization over the link to the Internet.|In the figure, site-local messages do not cross the WAN, and organization-local messages do not leave the organization over the link to the Internet.
|
Figure 24-11 IPv6 Multicast Scopes Finally, the term link-local has a couple of common uses in IPv6 and can be confusing as a result.|Figure 24-11 IPv6 Multicast Scopes Finally, the term link-local has a couple of common uses in IPv6 and can be confusing as a result.
The following descriptions should clarify the different uses of the term:|The following descriptions should clarify the different uses of the term:
|
Link-local address: An IPv6 address that begins FE80.|Link-local address: An IPv6 address that begins FE80.
This serves as a unicast address for an interface to which devices apply a link-local scope.|This serves as a unicast address for an interface to which devices apply a link-local scope.
Devices often create their own linklocal addresses using EUI-64 rules.|Devices often create their own linklocal addresses using EUI-64 rules.
A more complete term for comparison would be linklocal unicast address.|A more complete term for comparison would be linklocal unicast address.
|
Link-local multicast address: An IPv6 address that begins with FF02.|Link-local multicast address: An IPv6 address that begins with FF02.
This serves as a reserved multicast address to which devices apply a link-local scope.|This serves as a reserved multicast address to which devices apply a link-local scope.
|
Link-local scope: A reference to the scope itself, rather than an address.|Link-local scope: A reference to the scope itself, rather than an address.
This scope defines that routers should not forward packets sent to an address in this scope.|This scope defines that routers should not forward packets sent to an address in this scope.
##### Solicited-Node Multicast Addresses
Solicited-Node Multicast Addresses   
__|__
--|--
|
IPv6 Neighbor Discovery Protocol (NDP) replaces IPv4 ARP, as discussed in Chapter 25.|IPv6 Neighbor Discovery Protocol (NDP) replaces IPv4 ARP, as discussed in Chapter 25.
|
NDP improves the MAC-discovery process by sending IPv6 multicast packets that can be processed by the correct host but discarded with less processing by the rest of the hosts in the subnet.|NDP improves the MAC-discovery process by sending IPv6 multicast packets that can be processed by the correct host but discarded with less processing by the rest of the hosts in the subnet.
The process uses the solicited-node multicast address associated with the unicast IPv6 address.|The process uses the solicited-node multicast address associated with the unicast IPv6 address.
|
Figure 24-12 shows how to determine the solicited node multicast address associated with a unicast address.|Figure 24-12 shows how to determine the solicited node multicast address associated with a unicast address.
Start with the predefined /104 prefix (26 hex digits) shown in Figure 24-12.|Start with the predefined /104 prefix (26 hex digits) shown in Figure 24-12.
In other words, all the solicited-node multicast addresses begin with the abbreviated FF02::1:FF. In the last 24 bits (6 hex digits), copy the last 6 hex digits of the unicast address into the solicited-node address.|In other words, all the solicited-node multicast addresses begin with the abbreviated FF02::1:FF. In the last 24 bits (6 hex digits), copy the last 6 hex digits of the unicast address into the solicited-node address.
|
Figure 24-12 Solicited-Node Multicast Address Format Note that a host or router calculates a matching solicited node multicast address for every unicast address on an interface.|Figure 24-12 Solicited-Node Multicast Address Format Note that a host or router calculates a matching solicited node multicast address for every unicast address on an interface.
Example 24-9 shows an example, in which the router interface has a unicast address of 2001:DB8:1111:1::1/64, and a link-local address of FE80::AA:AAAA. As a result, the interface has two solicited node multicast addresses, shown at the end of the output.|Example 24-9 shows an example, in which the router interface has a unicast address of 2001:DB8:1111:1::1/64, and a link-local address of FE80::AA:AAAA. As a result, the interface has two solicited node multicast addresses, shown at the end of the output.
|
Example 24-9 Verifying Static IPv6 Addresses on Router R1 Example end.|Example 24-9 Verifying Static IPv6 Addresses on Router R1 Example end.
|
Note that in this case, R1’s global unicast address ends with 00:0001 (unabbreviated), resulting in an unabbreviated solicited node multicast address of FF02:0000:0000:0000:0000:|Note that in this case, R1’s global unicast address ends with 00:0001 (unabbreviated), resulting in an unabbreviated solicited node multicast address of FF02:0000:0000:0000:0000:
|
0001:FF00:00001.|0001:FF00:00001.
This value begins with the 26-hex-digit prefix shown in Figure 24-12, followed by 00:0001.|This value begins with the 26-hex-digit prefix shown in Figure 24-12, followed by 00:0001.
The solicited node multicast address corresponding to link-local address FE80::AA:AAAA ends in AA:AAAA and is shown in the last line of the example.|The solicited node multicast address corresponding to link-local address FE80::AA:AAAA ends in AA:AAAA and is shown in the last line of the example.
#### Miscellaneous IPv6 Addresses
Miscellaneous IPv6 Addresses   
__|__
--|--
|
Together, this chapter and the preceding chapter have introduced most of the IPv6 addressing concepts included in this book.|Together, this chapter and the preceding chapter have introduced most of the IPv6 addressing concepts included in this book.
This short topic mentions a few remaining IPv6 addressing ideas and summarizes the topics for easy study.|This short topic mentions a few remaining IPv6 addressing ideas and summarizes the topics for easy study.
|
First, all IPv6 hosts can use two additional special addresses:|First, all IPv6 hosts can use two additional special addresses:
###### The unknown (unspecified) IPv6 address, ::, or all 0s
The unknown (unspecified) IPv6 address, ::, or all 0s   
###### The loopback IPv6 address, ::1, or 127 binary 0s with a single 1
The loopback IPv6 address, ::1, or 127 binary 0s with a single 1   
__|__
--|--
|
A host can use the unknown address (::) when its own IPv6 address is not yet known or when the host wonders if its own IPv6 address might have problems.|A host can use the unknown address (::) when its own IPv6 address is not yet known or when the host wonders if its own IPv6 address might have problems.
For example, hosts use the unknown address during the early stages of dynamically discovering their IPv6 address.|For example, hosts use the unknown address during the early stages of dynamically discovering their IPv6 address.
|
When a host does not yet know what IPv6 address to use, it can use the :: address as its source IPv6 address.|When a host does not yet know what IPv6 address to use, it can use the :: address as its source IPv6 address.
|
The IPv6 loopback address gives each IPv6 host a way to test its own protocol stack.|The IPv6 loopback address gives each IPv6 host a way to test its own protocol stack.
Just like the IPv4 127.0.0.1 loopback address, packets sent to ::1 do not leave the host but are instead simply delivered down the stack to IPv6 and back up the stack to the application on the local host.|Just like the IPv4 127.0.0.1 loopback address, packets sent to ::1 do not leave the host but are instead simply delivered down the stack to IPv6 and back up the stack to the application on the local host.
#### Anycast Addresses
Anycast Addresses   
__|__
--|--
|
Imagine that routers collectively need to implement some service.|Imagine that routers collectively need to implement some service.
Rather than have one router supply that service, that service works best when implemented on several routers.|Rather than have one router supply that service, that service works best when implemented on several routers.
But the hosts that use the service need to contact only the nearest such service, and the network wants to hide all these details from the hosts.|But the hosts that use the service need to contact only the nearest such service, and the network wants to hide all these details from the hosts.
Hosts can send just one packet to an IPv6 address, and the routers will forward the packet to the nearest router that supports that service by virtue of supporting that destination IPv6 address.|Hosts can send just one packet to an IPv6 address, and the routers will forward the packet to the nearest router that supports that service by virtue of supporting that destination IPv6 address.
|
IPv6 anycast addresses provide that exact function.|IPv6 anycast addresses provide that exact function.
The any part of the name refers to the fact that any instances of the service can be used.|The any part of the name refers to the fact that any instances of the service can be used.
Figure 24-13 shows this big concept, with two major steps:|Figure 24-13 shows this big concept, with two major steps:
|
Step 1.|Step 1.
Two routers configure the exact same IPv6 address, designated as an anycast address, to support some service.|Two routers configure the exact same IPv6 address, designated as an anycast address, to support some service.
|
Step 2.|Step 2.
In the future, when any router receives a packet for that anycast address, the other routers simply route the packet to the nearest router that supports the address.|In the future, when any router receives a packet for that anycast address, the other routers simply route the packet to the nearest router that supports the address.
|
Figure 24-13 IPv6 Anycast Addresses To make this anycast process work, the routers implementing the anycast address must be configured and then advertise a route for the anycast address.|Figure 24-13 IPv6 Anycast Addresses To make this anycast process work, the routers implementing the anycast address must be configured and then advertise a route for the anycast address.
The addresses do not come from a special reserved range of addresses; instead, they are from the unicast address range.|The addresses do not come from a special reserved range of addresses; instead, they are from the unicast address range.
|
Often, the address is configured with a /128 prefix so that the routers advertise a host route for that one anycast address.|Often, the address is configured with a /128 prefix so that the routers advertise a host route for that one anycast address.
At that point, the routing protocol advertises the route just like any other IPv6 route; the other routers cannot tell the difference.|At that point, the routing protocol advertises the route just like any other IPv6 route; the other routers cannot tell the difference.
|
Example 24-10 shows a sample configuration on a router.|Example 24-10 shows a sample configuration on a router.
Note that the actual address (2001:1:1:2::99) looks like any other unicast address; the value can be chosen like any other IPv6 unicast addresses.|Note that the actual address (2001:1:1:2::99) looks like any other unicast address; the value can be chosen like any other IPv6 unicast addresses.
However, note the different anycast keyword on the ipv6 address command, telling the local router that the address has a special purpose as an anycast address.|However, note the different anycast keyword on the ipv6 address command, telling the local router that the address has a special purpose as an anycast address.
Finally, note that the show ipv6 interface command does identify the address as an anycast address, but the show ipv6 interface brief command does not.|Finally, note that the show ipv6 interface command does identify the address as an anycast address, but the show ipv6 interface brief command does not.
|
Example 24-10 Configuring and Verifying IPv6 Anycast Addresses Example end.|Example 24-10 Configuring and Verifying IPv6 Anycast Addresses Example end.
|
NOTE The subnet router anycast address is one special anycast address in each subnet.|NOTE The subnet router anycast address is one special anycast address in each subnet.
|
It is reserved for use by routers as a way to send a packet to any router on the subnet.|It is reserved for use by routers as a way to send a packet to any router on the subnet.
The address’s value in each subnet is the same number as the subnet ID; that is, the address has the same prefix value as the other addresses and all binary 0s in the interface ID.|The address’s value in each subnet is the same number as the subnet ID; that is, the address has the same prefix value as the other addresses and all binary 0s in the interface ID.
#### IPv6 Addressing Configuration Summary
IPv6 Addressing Configuration Summary   
__|__
--|--
|
This chapter completes the discussion of various IPv6 address types, while showing how to enable IPv6 on interfaces.|This chapter completes the discussion of various IPv6 address types, while showing how to enable IPv6 on interfaces.
Many implementations will use the ipv6 address command on each router LAN interface, and either that same command or the ipv6 enable command on the WAN interfaces.|Many implementations will use the ipv6 address command on each router LAN interface, and either that same command or the ipv6 enable command on the WAN interfaces.
For exam prep, Table 24-5 summarizes the various commands and the automatically generated IPv6 addresses in one place for review and study.|For exam prep, Table 24-5 summarizes the various commands and the automatically generated IPv6 addresses in one place for review and study.
|
Table 24-5 Summary of IPv6 Address Types and the Commands That Create Them Table end.|Table 24-5 Summary of IPv6 Address Types and the Commands That Create Them Table end.
### Chapter Review
Chapter Review   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|One key to doing well on the exams is to perform repetitive spaced review sessions.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.
Refer to the “Your Study Plan” element for more details.|Refer to the “Your Study Plan” element for more details.
Table 24-6 outlines the key review elements and where you can find them.|Table 24-6 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 24-6 Chapter Review Tracking Table end.|Table 24-6 Chapter Review Tracking Table end.
|
Review All the Key Topics Key Terms You Should Know anycast address, dual stacks, EUI-64, link-local address, link-local scope, link-local multicast address, site-local scope, organization-local scope, interface-local scope, IPv6 address scope, solicited-node multicast address, all-nodes multicast address, all-routers multicast address, subnet-router anycast address Additional Practice for This Chapter’s Processes For additional practice with IPv6 abbreviations, you may do the same set of practice problems using your choice of tools:|Review All the Key Topics Key Terms You Should Know anycast address, dual stacks, EUI-64, link-local address, link-local scope, link-local multicast address, site-local scope, organization-local scope, interface-local scope, IPv6 address scope, solicited-node multicast address, all-nodes multicast address, all-routers multicast address, subnet-router anycast address Additional Practice for This Chapter’s Processes For additional practice with IPv6 abbreviations, you may do the same set of practice problems using your choice of tools:
|
For additional practice with calculating IPv6 address using EUI-64 rules and finding the solicited-node multicast address based on a unicast address, use the exercises in Appendix options to use:|For additional practice with calculating IPv6 address using EUI-64 rules and finding the solicited-node multicast address based on a unicast address, use the exercises in Appendix options to use:
|
PDF: Navigate to the companion website and open the PDF for Appendix H.|PDF: Navigate to the companion website and open the PDF for Appendix H.
|
Application: Navigate to the companion website and open the application “Practice Exercise: EUI-64 and Solicited Node Multicast Problems”|Application: Navigate to the companion website and open the application “Practice Exercise: EUI-64 and Solicited Node Multicast Problems”
|
Additionally, you can create your own problems using any real router or simulator: Get into the router CLI, into configuration mode, and configure the mac-address address and ipv6 address prefix/64 eui-64 command.|Additionally, you can create your own problems using any real router or simulator: Get into the router CLI, into configuration mode, and configure the mac-address address and ipv6 address prefix/64 eui-64 command.
Then predict the IPv6 unicast address, link-local address, and solicited-node multicast address; finally, check your predictions against the show ipv6 interface command.|Then predict the IPv6 unicast address, link-local address, and solicited-node multicast address; finally, check your predictions against the show ipv6 interface command.
|
Command References Tables 24-8 and 24-9 list configuration and verification commands used in this chapter.|Command References Tables 24-8 and 24-9 list configuration and verification commands used in this chapter.
As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.|As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Then repeat the exercise, covering the right column, and try to recall what the command does.
|
Table 24-8 Chapter 24 Configuration Command Reference Table end.|Table 24-8 Chapter 24 Configuration Command Reference Table end.
|
Table 24-9 Chapter 24 EXEC Command Reference Table end.|Table 24-9 Chapter 24 EXEC Command Reference Table end.
|
Answers to Earlier Practice Problems Table 24-2, earlier in this chapter, listed several practice problems in which you needed to calculate the IPv6 address based on EUI-64 rules.|Answers to Earlier Practice Problems Table 24-2, earlier in this chapter, listed several practice problems in which you needed to calculate the IPv6 address based on EUI-64 rules.
Table 24-10 lists the answers to those problems.|Table 24-10 lists the answers to those problems.
|
Table 24-10 Answers to IPv6 EUI-64 Address Creation Practice Table end.|Table 24-10 Answers to IPv6 EUI-64 Address Creation Practice Table end.
## Chapter 25 Implementing IPv6 Routing
Chapter 25 Implementing IPv6 Routing   
###### 3.0 IP Connectivity
3.0 IP Connectivity   
###### 3.3 Configure and verify IPv4 and IPv6 static routing
3.3 Configure and verify IPv4 and IPv6 static routing   
###### 3.3.a Default route
3.3.a Default route   
###### 3.3.b Network route
3.3.b Network route   
###### 3.3.c Host route
3.3.c Host route   
###### 3.3.d Floating static
3.3.d Floating static   
__|__
--|--
|
This last chapter in Part VII of the book completes the materials about IPv6 by examining three major topics.|This last chapter in Part VII of the book completes the materials about IPv6 by examining three major topics.
The first section examines IPv6 connected and local routes, similar to IPv4, showing how a router adds both connected and local routes based on each interface IPv6 address.|The first section examines IPv6 connected and local routes, similar to IPv4, showing how a router adds both connected and local routes based on each interface IPv6 address.
The second major section of this chapter then looks at how to configure static IPv6 routes by typing in commands, in this case using the ipv6 route command instead of IPv4’s ip route command.|The second major section of this chapter then looks at how to configure static IPv6 routes by typing in commands, in this case using the ipv6 route command instead of IPv4’s ip route command.
The final major section examines the Neighbor Discovery Protocol (NDP).|The final major section examines the Neighbor Discovery Protocol (NDP).
### “Do I Know This Already?” Quiz
“Do I Know This Already?” Quiz   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.
The letter answers are listed at the bottom of the page following the quiz.|The letter answers are listed at the bottom of the page following the quiz.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.
You can also find both answers and explanations in the PTP testing software.|You can also find both answers and explanations in the PTP testing software.
|
Table 25-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Table 25-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping
### Foundation Topics
Foundation Topics   
### Connected and Local IPv6 Routes
Connected and Local IPv6 Routes   
__|__
--|--
|
Static IPv6 Routes 3–6 The Neighbor Discovery Protocol 7–8 Refer to the following figure for questions 1, 3, and 4.|Static IPv6 Routes 3–6 The Neighbor Discovery Protocol 7–8 Refer to the following figure for questions 1, 3, and 4.
|
2000:1:2:56::6 S0/1/1 R5 R6 G0/1 Subnet 2000:1:2:3:: /64 FE80::FF:FE00:6 G0/0 S0/1/0 2000:1:2:56::5 FE80::FF:FE00:5 CHAPTER 25 1.|2000:1:2:56::6 S0/1/1 R5 R6 G0/1 Subnet 2000:1:2:3:: /64 FE80::FF:FE00:6 G0/0 S0/1/0 2000:1:2:56::5 FE80::FF:FE00:5 CHAPTER 25 1.
A router has been configured with the ipv6 address 2000:1:2:3::1/64 command on its G0/1 interface as shown in the figure.|A router has been configured with the ipv6 address 2000:1:2:3::1/64 command on its G0/1 interface as shown in the figure.
The router creates a link-local address of FE80::FF:FE00:1 as well.|The router creates a link-local address of FE80::FF:FE00:1 as well.
The interface is working.|The interface is working.
Which of the following routes will the router add to its IPv6 routing table? (Choose two answers.)|Which of the following routes will the router add to its IPv6 routing table? (Choose two answers.)
|
a. A route for 2000:1:2:3::/64 b.|a. A route for 2000:1:2:3::/64 b.
A route for FE80::FF:FE00:1/64 c.|A route for FE80::FF:FE00:1/64 c.
A route for 2000:1:2:3::1/128 d.|A route for 2000:1:2:3::1/128 d.
A route for FE80::FF:FE00:1/128 2.|A route for FE80::FF:FE00:1/128 2.
A router has been configured with the ipv6 address 3111:1:1:1::1/64 command on its G0/1 interface and ipv6 address 3222:2:2:2::1/64 on its G0/2 interface.|A router has been configured with the ipv6 address 3111:1:1:1::1/64 command on its G0/1 interface and ipv6 address 3222:2:2:2::1/64 on its G0/2 interface.
Both interfaces are working.|Both interfaces are working.
Which of the following routes would you expect to see in the output of the show ipv6 route connected command? (Choose two answers.)|Which of the following routes would you expect to see in the output of the show ipv6 route connected command? (Choose two answers.)
|
a. A route for 3111:1:1:1::/64 b.|a. A route for 3111:1:1:1::/64 b.
A route for 3111:1:1:1::1/64 c.|A route for 3111:1:1:1::1/64 c.
A route for 3222:2:2:2::/64 d.|A route for 3222:2:2:2::/64 d.
A route for 3222:2:2:2::2/128 3.|A route for 3222:2:2:2::2/128 3.
An engineer needs to add a static IPv6 route for prefix 2000:1:2:3::/64 to Router R5’s configuration, in the figure shown with question 1.|An engineer needs to add a static IPv6 route for prefix 2000:1:2:3::/64 to Router R5’s configuration, in the figure shown with question 1.
Which of the following answers shows a valid static IPv6 route for that subnet, on Router R5?|Which of the following answers shows a valid static IPv6 route for that subnet, on Router R5?
|
a. ipv6 route 2000:1:2:3::/64 S0/1/1 b. ipv6 route 2000:1:2:3::/64 S0/1/0 c. ip route 2000:1:2:3::/64 S0/1/1 d. ip route 2000:1:2:3::/64 S0/1/0 4.|a. ipv6 route 2000:1:2:3::/64 S0/1/1 b. ipv6 route 2000:1:2:3::/64 S0/1/0 c. ip route 2000:1:2:3::/64 S0/1/1 d. ip route 2000:1:2:3::/64 S0/1/0 4.
An engineer needs to add a static IPv6 route for prefix 2000:1:2:3::/64 to Router R5 in the figure shown with question 1.|An engineer needs to add a static IPv6 route for prefix 2000:1:2:3::/64 to Router R5 in the figure shown with question 1.
Which of the following answers shows a valid static IPv6 route for that subnet on Router R5?|Which of the following answers shows a valid static IPv6 route for that subnet on Router R5?
|
a. ipv6 route 2000:1:2:3::/64 2000:1:2:56::5 b. ipv6 route 2000:1:2:3::/64 2000:1:2:56::6 c. ipv6 route 2000:1:2:3::/64 FE80::FF:FE00:5 d. ipv6 route 2000:1:2:3::/64 FE80::FF:FE00:6 5.|a. ipv6 route 2000:1:2:3::/64 2000:1:2:56::5 b. ipv6 route 2000:1:2:3::/64 2000:1:2:56::6 c. ipv6 route 2000:1:2:3::/64 FE80::FF:FE00:5 d. ipv6 route 2000:1:2:3::/64 FE80::FF:FE00:6 5.
An engineer types the command ipv6 route 2001:DB8:8:8::/64 2001:DB8:9:9::9 129 in configuration mode of Router R1 and presses Enter.|An engineer types the command ipv6 route 2001:DB8:8:8::/64 2001:DB8:9:9::9 129 in configuration mode of Router R1 and presses Enter.
Later, a show ipv6 route command does not list any route for subnet 2001:DB8:8:8::/64.|Later, a show ipv6 route command does not list any route for subnet 2001:DB8:8:8::/64.
Which of the following could have caused the route to not be in the IPv6 routing table?|Which of the following could have caused the route to not be in the IPv6 routing table?
|
a. The command should be using a next-hop link-local address instead of a global unicast.|a. The command should be using a next-hop link-local address instead of a global unicast.
|
b. The command is missing an outgoing interface parameter, so IOS rejected the ipv6 route command.|b. The command is missing an outgoing interface parameter, so IOS rejected the ipv6 route command.
|
c. The router has no routes that match 2001:DB8:9:9::9.|c. The router has no routes that match 2001:DB8:9:9::9.
|
d. A route for 2001:DB8:8:8::/64 with administrative distance 110 already exists.|d. A route for 2001:DB8:8:8::/64 with administrative distance 110 already exists.
|
6. The command output shows two routes from the longer output of the show ipv6 route command.|6. The command output shows two routes from the longer output of the show ipv6 route command.
Which answers are true about the output? (Choose two answers.)|Which answers are true about the output? (Choose two answers.)
|
R1# show ipv6 route static !|R1# show ipv6 route static !
Legend omitted for brevity S 2001:DB8:2:2::/64 [1/0]|Legend omitted for brevity S 2001:DB8:2:2::/64 [1/0]
|
via 2001:DB8:4:4::4 S ::/0 [1/0]|via 2001:DB8:4:4::4 S ::/0 [1/0]
|
via Serial0/0/1, directly connected a.|via Serial0/0/1, directly connected a.
The route to ::/0 is added because of an ipv6 route global command.|The route to ::/0 is added because of an ipv6 route global command.
|
b. The administrative distance of the route to 2001:DB8:2:2::/64 is 1.|b. The administrative distance of the route to 2001:DB8:2:2::/64 is 1.
|
c. The route to ::/0 is added because of an ipv6 address interface subcommand.|c. The route to ::/0 is added because of an ipv6 address interface subcommand.
|
d. The route to 2001:DB8:2:2::/64 is added because of an IPv6 routing protocol.|d. The route to 2001:DB8:2:2::/64 is added because of an IPv6 routing protocol.
|
7. PC1, PC2, and Router R1 all connect to the same VLAN and IPv6 subnet.|7. PC1, PC2, and Router R1 all connect to the same VLAN and IPv6 subnet.
PC1 wants to send its first IPv6 packet to PC2. What protocol or message will PC1 use to discover the MAC address to which PC1 should send the Ethernet frame that encapsulates this IPv6 packet?|PC1 wants to send its first IPv6 packet to PC2. What protocol or message will PC1 use to discover the MAC address to which PC1 should send the Ethernet frame that encapsulates this IPv6 packet?
|
a. ARP b.|a. ARP b.
NDP NS c.|NDP NS c.
NDP RS d.|NDP RS d.
SLAAC 8.|SLAAC 8.
Which of the following pieces of information does a router supply in an NDP Router Advertisement (RA) message? (Choose two answers.)|Which of the following pieces of information does a router supply in an NDP Router Advertisement (RA) message? (Choose two answers.)
|
a. Router IPv6 address b.|a. Router IPv6 address b.
Host name of the router c.|Host name of the router c.
IPv6 prefix(es) on the link d.|IPv6 prefix(es) on the link d.
IPv6 address of DHCP server Foundation Topics Connected and Local IPv6 Routes A Cisco router adds IPv6 routes to its IPv6 routing table for several reasons.|IPv6 address of DHCP server Foundation Topics Connected and Local IPv6 Routes A Cisco router adds IPv6 routes to its IPv6 routing table for several reasons.
Many of you could predict those reasons at this point in your reading, in part because the logic mirrors the logic routers use for IPv4.|Many of you could predict those reasons at this point in your reading, in part because the logic mirrors the logic routers use for IPv4.
Specifically, a router adds IPv6 routes based on the following:|Specifically, a router adds IPv6 routes based on the following:
###### The configuration of IPv6 addresses on working interfaces (connected and local routes)
The configuration of IPv6 addresses on working interfaces (connected and local routes)   
###### The direct configuration of a static route (static routes)
The direct configuration of a static route (static routes)   
###### The configuration of a routing protocol, like OSPFv3, on routers that share the same data
The configuration of a routing protocol, like OSPFv3, on routers that share the same data   
__|__
--|--
|
link (dynamic routes)|link (dynamic routes)
|
The first two sections of this chapter examine the first of these two topics, with discussions of IPv6 routing protocols now residing in the CCNP Enterprise exams.|The first two sections of this chapter examine the first of these two topics, with discussions of IPv6 routing protocols now residing in the CCNP Enterprise exams.
#### Rules for Connected and Local Routes
Rules for Connected and Local Routes   
__|__
--|--
|
Routers add and remove connected routes and local routes, based on the interface configuration and the interface state.|Routers add and remove connected routes and local routes, based on the interface configuration and the interface state.
First, the router looks for any configured unicast addresses on any interfaces by looking for the ipv6 address command.|First, the router looks for any configured unicast addresses on any interfaces by looking for the ipv6 address command.
Then, if the interface is working—if the interface has a “line status is up, protocol status is up” notice in the output of the show interfaces command—the router adds both a connected and local route.|Then, if the interface is working—if the interface has a “line status is up, protocol status is up” notice in the output of the show interfaces command—the router adds both a connected and local route.
|
NOTE Routers do not create connected or local IPv6 routes for link-local addresses.|NOTE Routers do not create connected or local IPv6 routes for link-local addresses.
|
The connected and local routes themselves follow the same general logic as with IPv4.|The connected and local routes themselves follow the same general logic as with IPv4.
The connected route represents the subnet connected to the interface, whereas the local route is a host route for only the specific IPv6 address configured on the interface.|The connected route represents the subnet connected to the interface, whereas the local route is a host route for only the specific IPv6 address configured on the interface.
|
As an example, consider a router, with a working interface, configured with the ipv6 address 2000:1:1:1::1/64 command.|As an example, consider a router, with a working interface, configured with the ipv6 address 2000:1:1:1::1/64 command.
The router will calculate the subnet ID based on this address and prefix length, and it will place a connected route for that subnet (2000:1:1:1::/64) into the routing table.|The router will calculate the subnet ID based on this address and prefix length, and it will place a connected route for that subnet (2000:1:1:1::/64) into the routing table.
The router also takes the listed IPv6 address and creates a host route for that address, with a /128 prefix length. (With IPv4, host routes have a /32 prefix length, while IPv6 uses a /128 prefix length, meaning “exactly this one address.”)|The router also takes the listed IPv6 address and creates a host route for that address, with a /128 prefix length. (With IPv4, host routes have a /32 prefix length, while IPv6 uses a /128 prefix length, meaning “exactly this one address.”)
|
The following list summarizes the rules about how routers create routes based on the configuration of an interface IPv6 unicast address, for easier review and study:|The following list summarizes the rules about how routers create routes based on the configuration of an interface IPv6 unicast address, for easier review and study:
|
1. Routers create IPv6 routes based on each unicast IPv6 address on an interface, as configured with the ipv6 address command, as follows:|1. Routers create IPv6 routes based on each unicast IPv6 address on an interface, as configured with the ipv6 address command, as follows:
|
A. The router creates a route for the subnet (a connected route).|A. The router creates a route for the subnet (a connected route).
|
B. The router creates a host route (/128 prefix length) for the router IPv6 address (a local route).|B. The router creates a host route (/128 prefix length) for the router IPv6 address (a local route).
|
2. Routers do not create routes based on the link-local addresses associated with the interface.|2. Routers do not create routes based on the link-local addresses associated with the interface.
|
3. Routers remove the connected and local routes for an interface if the interface fails, and they re-add these routes when the interface is again in a working (up/up) state.|3. Routers remove the connected and local routes for an interface if the interface fails, and they re-add these routes when the interface is again in a working (up/up) state.
#### Example of Connected IPv6 Routes
Example of Connected IPv6 Routes   
__|__
--|--
|
While the concept of connected and local IPv6 routes works much like IPv4 routes, seeing a few examples can certainly help.|While the concept of connected and local IPv6 routes works much like IPv4 routes, seeing a few examples can certainly help.
To show some sample routes, Figure 25-1 gives the details of one sample internetwork used in this chapter.|To show some sample routes, Figure 25-1 gives the details of one sample internetwork used in this chapter.
The figure shows the IPv6 subnet IDs. The upcoming examples focus on the connected and local routes on Router R1.|The figure shows the IPv6 subnet IDs. The upcoming examples focus on the connected and local routes on Router R1.
|
Figure 25-1 Sample Network Used to Show Connected and Local Routes To clarify the notes in Figure 25-1, note that the figure shows IPv6 prefixes (subnets), with a shorthand notation for the interface IPv6 addresses.|Figure 25-1 Sample Network Used to Show Connected and Local Routes To clarify the notes in Figure 25-1, note that the figure shows IPv6 prefixes (subnets), with a shorthand notation for the interface IPv6 addresses.
The figure shows only the abbreviated interface ID portion of each interface address near each interface.|The figure shows only the abbreviated interface ID portion of each interface address near each interface.
For example, R1’s G0/0 interface address would begin with subnet ID value 2001:DB8:1111:1, added to ::1, for 2001:DB8:1111:1::1.|For example, R1’s G0/0 interface address would begin with subnet ID value 2001:DB8:1111:1, added to ::1, for 2001:DB8:1111:1::1.
|
Now on to the example of connected routes.|Now on to the example of connected routes.
To begin, consider the configuration of Router R1 from Figure 25-1, as shown in Example 25-1.|To begin, consider the configuration of Router R1 from Figure 25-1, as shown in Example 25-1.
The excerpt from the show running-config command on R1 shows three interfaces, all of which are working.|The excerpt from the show running-config command on R1 shows three interfaces, all of which are working.
Also note that no static route or routing protocol configuration exists.|Also note that no static route or routing protocol configuration exists.
|
Example 25-1 IPv6 Addressing Configuration on Router R1 Example end.|Example 25-1 IPv6 Addressing Configuration on Router R1 Example end.
|
Answers to the “Do I Know This Already?” quiz:|Answers to the “Do I Know This Already?” quiz:
|
1 A, C 2 A, C 3 A 4 B 5 C 6 A, B 7 B 8 A, C Based on Figure 25-1 and Example 25-1, R1 should have three connected IPv6 routes, as highlighted in Example 25-2.|1 A, C 2 A, C 3 A 4 B 5 C 6 A, B 7 B 8 A, C Based on Figure 25-1 and Example 25-1, R1 should have three connected IPv6 routes, as highlighted in Example 25-2.
|
Example 25-2 Routes on Router R1 Before Adding Static Routes or Routing Protocols Example end.|Example 25-2 Routes on Router R1 Before Adding Static Routes or Routing Protocols Example end.
|
All three highlighted routes show the same basic kinds of information, so for discussion, focus on the first pair of highlighted lines, which detail the connected route for subnet 2001:DB8:1111:1::/64.|All three highlighted routes show the same basic kinds of information, so for discussion, focus on the first pair of highlighted lines, which detail the connected route for subnet 2001:DB8:1111:1::/64.
The first pair of highlighted lines state: The route is a “directly connected” route; the interface ID is GigabitEthernet0/0; and the prefix/length is 2001:DB8:1111:1::/64.|The first pair of highlighted lines state: The route is a “directly connected” route; the interface ID is GigabitEthernet0/0; and the prefix/length is 2001:DB8:1111:1::/64.
At the far left, the code letter “C” identifies the route as a connected route (per the legend above).|At the far left, the code letter “C” identifies the route as a connected route (per the legend above).
Also note that the numbers in brackets mirror the same ideas as IPv4’s show ip route command: The first number represents the administrative distance, and the second is the metric.|Also note that the numbers in brackets mirror the same ideas as IPv4’s show ip route command: The first number represents the administrative distance, and the second is the metric.
#### Examples of Local IPv6 Routes
Examples of Local IPv6 Routes   
__|__
--|--
|
Continuing this same example, three local routes should exist on R1 for the same three interfaces as the connected routes.|Continuing this same example, three local routes should exist on R1 for the same three interfaces as the connected routes.
Indeed, that is the case, with one extra local route for other purposes.|Indeed, that is the case, with one extra local route for other purposes.
Example 25-3 shows only the local routes, as listed by the show ipv6 route local command, with highlights of one particular local route for discussion.|Example 25-3 shows only the local routes, as listed by the show ipv6 route local command, with highlights of one particular local route for discussion.
|
Example 25-3 Local IPv6 Routes on Router R1 Example end.|Example 25-3 Local IPv6 Routes on Router R1 Example end.
|
For the highlighted local route, look for a couple of quick facts.|For the highlighted local route, look for a couple of quick facts.
First, look back to R1’s configuration in Example 25-1, and note R1’s IPv6 address on its G0/0 interface.|First, look back to R1’s configuration in Example 25-1, and note R1’s IPv6 address on its G0/0 interface.
This local route lists the exact same address.|This local route lists the exact same address.
Also note the /128 prefix length, meaning this route matches packets sent to that address (2001:DB8:1111:1::1), and only that address.|Also note the /128 prefix length, meaning this route matches packets sent to that address (2001:DB8:1111:1::1), and only that address.
|
NOTE While the show ipv6 route local command shows all local IPv6 routes, the show ipv6 route connected command shows all connected routes.|NOTE While the show ipv6 route local command shows all local IPv6 routes, the show ipv6 route connected command shows all connected routes.
### Static IPv6 Routes
Static IPv6 Routes   
__|__
--|--
|
While routers automatically add connected and local routes based on the interface configuration, static routes require direct configuration with the ipv6 route command.|While routers automatically add connected and local routes based on the interface configuration, static routes require direct configuration with the ipv6 route command.
Simply put, someone configures the command, and the router places the details from the command into a route in the IPv6 routing table.|Simply put, someone configures the command, and the router places the details from the command into a route in the IPv6 routing table.
|
The ipv6 route command follows the same general logic as does IPv4’s ip route command, as discussed in Chapter 16, “Configuring IPv4 Addressing and Static Routes.” For IPv4, the ip route command starts by listing the subnet ID and mask, so for IPv6, the ipv6 route command begins with the prefix and prefix length.|The ipv6 route command follows the same general logic as does IPv4’s ip route command, as discussed in Chapter 16, “Configuring IPv4 Addressing and Static Routes.” For IPv4, the ip route command starts by listing the subnet ID and mask, so for IPv6, the ipv6 route command begins with the prefix and prefix length.
Then the respective commands list the directions of how this router should forward packets toward that destination subnet or prefix by listing the outgoing interface or the address of the next-hop router.|Then the respective commands list the directions of how this router should forward packets toward that destination subnet or prefix by listing the outgoing interface or the address of the next-hop router.
|
Figure 25-2 shows the concepts behind a single ipv6 route command, demonstrating the concepts behind a static route on Router R1 for the subnet on the right (subnet 2, or 2001:DB8:1111:2::/64).|Figure 25-2 shows the concepts behind a single ipv6 route command, demonstrating the concepts behind a static route on Router R1 for the subnet on the right (subnet 2, or 2001:DB8:1111:2::/64).
A static route on R1, for this subnet, will begin with ipv6 route 2001:DB8:1111:2::/64, followed by either the outgoing interface (S0/0/0) or the next-hop IPv6 address, or both.|A static route on R1, for this subnet, will begin with ipv6 route 2001:DB8:1111:2::/64, followed by either the outgoing interface (S0/0/0) or the next-hop IPv6 address, or both.
|
Now that you understand the big ideas with IPv6 static routes, the next few pages walk you through a series of examples.|Now that you understand the big ideas with IPv6 static routes, the next few pages walk you through a series of examples.
In particular, the examples look at configuring static routes with an outgoing interface, then with a next-hop global unicast address, and then with a next-hop link-local address.|In particular, the examples look at configuring static routes with an outgoing interface, then with a next-hop global unicast address, and then with a next-hop link-local address.
This section ends with a discussion of static IPv6 default routes.|This section ends with a discussion of static IPv6 default routes.
|
Figure 25-2 Logic Behind IPv6 Static Route Commands (IPv6 Route)|Figure 25-2 Logic Behind IPv6 Static Route Commands (IPv6 Route)
#### Static Routes Using the Outgoing Interface
Static Routes Using the Outgoing Interface   
__|__
--|--
|
This first IPv6 static route example uses the outgoing interface option.|This first IPv6 static route example uses the outgoing interface option.
As a reminder, for both IPv4 and IPv6 static routes, when the command references an interface, the interface is a local interface.|As a reminder, for both IPv4 and IPv6 static routes, when the command references an interface, the interface is a local interface.
That is, it is an interface on the router where the command is added.|That is, it is an interface on the router where the command is added.
In this case, as shown in Figure 25-2, R1’s ipv6 route command would use interface S0/0/0, as shown in Example 25-4.|In this case, as shown in Figure 25-2, R1’s ipv6 route command would use interface S0/0/0, as shown in Example 25-4.
|
Example 25-4 Static IPv6 Routes on Router R1 Example end.|Example 25-4 Static IPv6 Routes on Router R1 Example end.
|
While Example 25-4 shows the correct syntax of the route, if using static routes throughout this internetwork, more static routes are needed.|While Example 25-4 shows the correct syntax of the route, if using static routes throughout this internetwork, more static routes are needed.
For example, to support traffic between hosts A and B, R1 is now prepared.|For example, to support traffic between hosts A and B, R1 is now prepared.
Host A will forward all its IPv6 packets to its default router (R1), and R1 can now route those packets out S0/0/0 to R2 next.|Host A will forward all its IPv6 packets to its default router (R1), and R1 can now route those packets out S0/0/0 to R2 next.
However, Router R2 does not yet have a route back to host A’s subnet, subnet 1 (2001:DB8:1111:1::/64), so a complete solution requires more routes.|However, Router R2 does not yet have a route back to host A’s subnet, subnet 1 (2001:DB8:1111:1::/64), so a complete solution requires more routes.
|
Example 25-5 solves this problem by giving Router R2 a static route for subnet 1 (2001:DB8:1111:1::/64).|Example 25-5 solves this problem by giving Router R2 a static route for subnet 1 (2001:DB8:1111:1::/64).
After this route is added, hosts A and B should be able to ping each other.|After this route is added, hosts A and B should be able to ping each other.
|
Example 25-5 Static IPv6 Routes on Router R2 Example end.|Example 25-5 Static IPv6 Routes on Router R2 Example end.
|
Many options exist for verifying the existence of the static route and testing whether hosts can use the route. ping and traceroute can test connectivity.|Many options exist for verifying the existence of the static route and testing whether hosts can use the route. ping and traceroute can test connectivity.
From the router command line, the show ipv6 route command will list all the IPv6 routes.|From the router command line, the show ipv6 route command will list all the IPv6 routes.
The shorter output of the show ipv6 route static command, which lists only static routes, could also be used; Example 25-6 shows that output, with the legend omitted.|The shorter output of the show ipv6 route static command, which lists only static routes, could also be used; Example 25-6 shows that output, with the legend omitted.
|
Example 25-6 Verification of Static Routes Only on R1 Example end.|Example 25-6 Verification of Static Routes Only on R1 Example end.
|
This command lists many facts about the one static route on R1. First, the code “S” in the left column does identify the route as a static route. (However, the later phrase “directly connected”|This command lists many facts about the one static route on R1. First, the code “S” in the left column does identify the route as a static route. (However, the later phrase “directly connected”
|
might mislead you to think this is a connected route; trust the “S” code.) Note that the prefix (2001:DB8:1111:2::/64) matches the configuration (in Example 25-4), as does the outgoing interface (S0/0/0).|might mislead you to think this is a connected route; trust the “S” code.) Note that the prefix (2001:DB8:1111:2::/64) matches the configuration (in Example 25-4), as does the outgoing interface (S0/0/0).
|
While this command lists basic information about each static route, it does not state whether this route would be used when forwarding packets to a particular destination.|While this command lists basic information about each static route, it does not state whether this route would be used when forwarding packets to a particular destination.
For example, if host A sent an IPv6 packet to host B (2001:DB8:1111:2::22), would R1 use this static route?|For example, if host A sent an IPv6 packet to host B (2001:DB8:1111:2::22), would R1 use this static route?
As it turns out, R1 would use that route, as confirmed by the show ipv6 route 2001:DB8:1111:2::22 command.|As it turns out, R1 would use that route, as confirmed by the show ipv6 route 2001:DB8:1111:2::22 command.
This command asks the router to list the route that the router would use when forwarding packets to that particular address.|This command asks the router to list the route that the router would use when forwarding packets to that particular address.
Example 25-7 shows an example.|Example 25-7 shows an example.
|
Example 25-7 Displaying the Route R1 Uses to Forward to Host B Example end.|Example 25-7 Displaying the Route R1 Uses to Forward to Host B Example end.
#### Static Routes Using Next-Hop IPv6 Address
Static Routes Using Next-Hop IPv6 Address   
__|__
--|--
|
The previous example used a serial WAN link on purpose.|The previous example used a serial WAN link on purpose.
With a point-to-point WAN link, the ipv6 route command can use the outgoing interface style of configuration Static IPv6 routes that refer to a next-hop address have two options: the unicast address on the neighboring router (global unicast or unique local) or the link-local address of that same neighboring router.|With a point-to-point WAN link, the ipv6 route command can use the outgoing interface style of configuration Static IPv6 routes that refer to a next-hop address have two options: the unicast address on the neighboring router (global unicast or unique local) or the link-local address of that same neighboring router.
Figure 25-3 spells out those two options with an updated version of Figure 25-2, this time showing Router R2’s global unicast as well as R2’s link-local address.|Figure 25-3 spells out those two options with an updated version of Figure 25-2, this time showing Router R2’s global unicast as well as R2’s link-local address.
|
Figure 25-3 Using Unicast or Link-Local as the Next-Hop Address for Static Routes The next few pages walk you through examples, first with a global unicast as a next-hop and then with a link-local as a next-hop.|Figure 25-3 Using Unicast or Link-Local as the Next-Hop Address for Static Routes The next few pages walk you through examples, first with a global unicast as a next-hop and then with a link-local as a next-hop.
##### Example Static Route with a Global Unicast Next-Hop Address
Example Static Route with a Global Unicast Next-Hop Address   
__|__
--|--
|
This example uses the internetwork shown in Figure 25-3, but with the earlier static routes removed.|This example uses the internetwork shown in Figure 25-3, but with the earlier static routes removed.
That is, both routers have only connected and local routes to begin the example.|That is, both routers have only connected and local routes to begin the example.
|
In Example 25-8, both R1 and R2 add static routes that refer to the neighbor’s global unicast address.|In Example 25-8, both R1 and R2 add static routes that refer to the neighbor’s global unicast address.
R1 adds a route for subnet 2 (on the right), while R2 adds a route for subnet 1 (on the left).|R1 adds a route for subnet 2 (on the right), while R2 adds a route for subnet 1 (on the left).
Note that the example shows routes in both directions so that the two hosts can send packets to each other.|Note that the example shows routes in both directions so that the two hosts can send packets to each other.
|
Example 25-8 Static IPv6 Routes Using Global Unicast Addresses Example end.|Example 25-8 Static IPv6 Routes Using Global Unicast Addresses Example end.
|
The ipv6 route command itself is relatively straightforward.|The ipv6 route command itself is relatively straightforward.
Focus on R1’s route, which matches the logic shown in Figure 25-3.|Focus on R1’s route, which matches the logic shown in Figure 25-3.
The command lists subnet 2 (2001:DB8:1111:2::/64).|The command lists subnet 2 (2001:DB8:1111:2::/64).
|
It then lists R2’s global unicast address (ending in 4::2).|It then lists R2’s global unicast address (ending in 4::2).
|
The verification commands on R1, as shown in Example 25-9, list the usual information.|The verification commands on R1, as shown in Example 25-9, list the usual information.
|
Example 25-9 shows two commands, first listing R1’s only static route (the one configured in Example 25-8).|Example 25-9 shows two commands, first listing R1’s only static route (the one configured in Example 25-8).
The end of the example lists the show ipv6 route 2001:DB8:1111:2::22 command, which lists the route R1 uses when forwarding packets to Host B, proving that R1 uses this new static route when forwarding packets to that host.|The end of the example lists the show ipv6 route 2001:DB8:1111:2::22 command, which lists the route R1 uses when forwarding packets to Host B, proving that R1 uses this new static route when forwarding packets to that host.
|
Example 25-9 Verification of Static Routes to a Next-Hop Global Unicast Address Example end.|Example 25-9 Verification of Static Routes to a Next-Hop Global Unicast Address Example end.
##### Example Static Route with a Link-Local Next-Hop Address
Example Static Route with a Link-Local Next-Hop Address   
__|__
--|--
|
Static routes that refer to a neighbor’s link-local address work a little like both of the preceding two styles of static routes.|Static routes that refer to a neighbor’s link-local address work a little like both of the preceding two styles of static routes.
First, the ipv6 route command refers to a next-hop address, namely a link-local address.|First, the ipv6 route command refers to a next-hop address, namely a link-local address.
However, the command must also refer to the router’s local outgoing interface.|However, the command must also refer to the router’s local outgoing interface.
Why both?|Why both?
The ipv6 route command cannot simply refer to a link-local next-hop address by itself because the link-local address does not, by itself, tell the local router which outgoing interface to use.|The ipv6 route command cannot simply refer to a link-local next-hop address by itself because the link-local address does not, by itself, tell the local router which outgoing interface to use.
|
Interestingly, when the ipv6 route command refers to a global unicast next-hop address, the router can deduce the outgoing interface.|Interestingly, when the ipv6 route command refers to a global unicast next-hop address, the router can deduce the outgoing interface.
For example, the earlier example on R1, as shown in Example 25-8, shows R1 with a static IPv6 route with a next-hop IPv6 address of 2001:DB8:1111:4::2.|For example, the earlier example on R1, as shown in Example 25-8, shows R1 with a static IPv6 route with a next-hop IPv6 address of 2001:DB8:1111:4::2.
R1 can look at its IPv6 routing table, see its connected route that includes this 2001:DB8:1111:4::2 address, and see a connected route off R1’s S0/0/0.|R1 can look at its IPv6 routing table, see its connected route that includes this 2001:DB8:1111:4::2 address, and see a connected route off R1’s S0/0/0.
As a result, with a next-hop global unicast address, R1 can deduce the correct outgoing interface (R1’s S0/0/0).|As a result, with a next-hop global unicast address, R1 can deduce the correct outgoing interface (R1’s S0/0/0).
|
With a link-local next-hop address, a router cannot work through this same logic, so the outgoing interface must also be configured.|With a link-local next-hop address, a router cannot work through this same logic, so the outgoing interface must also be configured.
Example 25-10 shows the configuration of static routes on R1 and R2, replacements for the two routes previously configured in Example 25-8.|Example 25-10 shows the configuration of static routes on R1 and R2, replacements for the two routes previously configured in Example 25-8.
|
Example 25-10 Static IPv6 Routes Using Link-Local Neighbor Addresses Example end.|Example 25-10 Static IPv6 Routes Using Link-Local Neighbor Addresses Example end.
|
Example 25-11 verifies the configuration in Example 25-10 by repeating the show ipv6 route static and show ipv6 route 2001:DB8:1111:2::22 commands used in Example 25-9.|Example 25-11 verifies the configuration in Example 25-10 by repeating the show ipv6 route static and show ipv6 route 2001:DB8:1111:2::22 commands used in Example 25-9.
|
Note that the output from both commands differs slightly in regard to the forwarding details.|Note that the output from both commands differs slightly in regard to the forwarding details.
Because the new commands list both the next-hop address and outgoing interface, the show commands also list both the next-hop (link-local) address and the outgoing interface.|Because the new commands list both the next-hop address and outgoing interface, the show commands also list both the next-hop (link-local) address and the outgoing interface.
|
If you refer back to Example 25-9, you will see only a next-hop address listed.|If you refer back to Example 25-9, you will see only a next-hop address listed.
|
Example 25-11 Verification of Static Routes to a Next-Hop Link-Local Address Example end.|Example 25-11 Verification of Static Routes to a Next-Hop Link-Local Address Example end.
##### Static Routes over Ethernet Links
Static Routes over Ethernet Links   
__|__
--|--
|
You might have wondered why the chapter shows examples with a serial link, knowing that most networks use fewer and fewer serial links today.|You might have wondered why the chapter shows examples with a serial link, knowing that most networks use fewer and fewer serial links today.
Using serial links in the examples avoids one complication when defining static routes that use Ethernet interfaces (LAN or WAN). The next example discusses the issues and shows configuration options for static routes when the outgoing interface is an Ethernet interface.|Using serial links in the examples avoids one complication when defining static routes that use Ethernet interfaces (LAN or WAN). The next example discusses the issues and shows configuration options for static routes when the outgoing interface is an Ethernet interface.
|
To configure a static route that uses an Ethernet interface, the ipv6 route command’s forwarding parameters should always include a next-hop IPv6 address.|To configure a static route that uses an Ethernet interface, the ipv6 route command’s forwarding parameters should always include a next-hop IPv6 address.
IOS allows you to configure the ipv6 route command using only the outgoing-interface parameter, without listing a next-hop address.|IOS allows you to configure the ipv6 route command using only the outgoing-interface parameter, without listing a next-hop address.
The router will accept the command; however, if that outgoing interface happens to be an Ethernet interface, the router cannot successfully forward IPv6 packets using the route.|The router will accept the command; however, if that outgoing interface happens to be an Ethernet interface, the router cannot successfully forward IPv6 packets using the route.
|
To configure the ipv6 route correctly when directing packets out an Ethernet interface, the configuration should use one of these styles:|To configure the ipv6 route correctly when directing packets out an Ethernet interface, the configuration should use one of these styles:
###### Refer to the next-hop global unicast address (or unique local address) only
Refer to the next-hop global unicast address (or unique local address) only   
###### Refer to both the outgoing interface and next-hop global unicast address (or unique local
Refer to both the outgoing interface and next-hop global unicast address (or unique local   
__|__
--|--
|
address)|address)
###### Refer to both the outgoing interface and next-hop link-local address
Refer to both the outgoing interface and next-hop link-local address   
__|__
--|--
|
Example 25-12 shows a sample configuration from routers R1 and R3 in Figure 25-4.|Example 25-12 shows a sample configuration from routers R1 and R3 in Figure 25-4.
The top part of the figure shows the details for R1’s route to the subnet on the right side of the figure, with the details labeled with an “A.” The bottom half shows the details for R3’s route to the LAN subnet on the left of the figure, labeled with a “B.”.|The top part of the figure shows the details for R1’s route to the subnet on the right side of the figure, with the details labeled with an “A.” The bottom half shows the details for R3’s route to the LAN subnet on the left of the figure, labeled with a “B.”.
|
Figure 25-4 Network Details for IPv6 Static Routes on an Ethernet Interface Example 25-12 Static IPv6 Routes with an Ethernet WAN Interface Example end.|Figure 25-4 Network Details for IPv6 Static Routes on an Ethernet Interface Example 25-12 Static IPv6 Routes with an Ethernet WAN Interface Example end.
#### Static Default Routes
Static Default Routes   
__|__
--|--
|
IPv6 supports a default route concept, similar to IPv4.|IPv6 supports a default route concept, similar to IPv4.
The default route tells the router what to do with an IPv6 packet when the packet matches no other IPv6 route.|The default route tells the router what to do with an IPv6 packet when the packet matches no other IPv6 route.
The logic is pretty basic:|The logic is pretty basic:
###### With no default route, the router discards the IPv6 packet.
With no default route, the router discards the IPv6 packet.   
###### With a default route, the router forwards the IPv6 packet based on the default route.
With a default route, the router forwards the IPv6 packet based on the default route.   
__|__
--|--
|
Default routes can be particularly useful in a couple of network design cases.|Default routes can be particularly useful in a couple of network design cases.
For example, with an enterprise network design that uses a single router at each branch office, with one WAN link to each branch, the branch routers have only one possible path over which to forward packets.|For example, with an enterprise network design that uses a single router at each branch office, with one WAN link to each branch, the branch routers have only one possible path over which to forward packets.
In a large network, when using a routing protocol, the branch router could learn thousands of routes—all of which point back toward the core of the network over that one WAN link.|In a large network, when using a routing protocol, the branch router could learn thousands of routes—all of which point back toward the core of the network over that one WAN link.
|
Branch routers could use default routes instead of a routing protocol.|Branch routers could use default routes instead of a routing protocol.
The branch router would forward all traffic to the core of the network.|The branch router would forward all traffic to the core of the network.
Figure 25-5 shows just such an example, with two sample branch routers on the right and a core site router on the left.|Figure 25-5 shows just such an example, with two sample branch routers on the right and a core site router on the left.
|
Figure 25-5 Using Static Default Routes at Branches to Forward Back to the Core To configure a static default route, use the same rules already discussed in this section of the chapter, but use a specific value to note the route as a default route: ::/0.|Figure 25-5 Using Static Default Routes at Branches to Forward Back to the Core To configure a static default route, use the same rules already discussed in this section of the chapter, but use a specific value to note the route as a default route: ::/0.
Taken literally, the double colon (::) is the IPv6 abbreviation for all 0s, and the /0 means the prefix length is 0.|Taken literally, the double colon (::) is the IPv6 abbreviation for all 0s, and the /0 means the prefix length is 0.
|
This idea mirrors the IPv4 convention to refer to the default route as 0.0.0.0/0.|This idea mirrors the IPv4 convention to refer to the default route as 0.0.0.0/0.
Otherwise, just configure the ipv6 route command as normal.|Otherwise, just configure the ipv6 route command as normal.
|
Example 25-13 shows one such sample static default route on Router B1 from Figure 25-5.|Example 25-13 shows one such sample static default route on Router B1 from Figure 25-5.
|
This example uses the outgoing interface option.|This example uses the outgoing interface option.
|
Example 25-13 Static Default Route for Branch Router B1 Example end.|Example 25-13 Static Default Route for Branch Router B1 Example end.
|
With IPv6, the router displays the default a little more cleanly than with IPv4.|With IPv6, the router displays the default a little more cleanly than with IPv4.
The show ipv6 route command simply includes the route in the output of the command, along with the other routes.|The show ipv6 route command simply includes the route in the output of the command, along with the other routes.
Example 25-14 shows an example, with “::/0” listed to denote this route as the default route.|Example 25-14 shows an example, with “::/0” listed to denote this route as the default route.
|
Example 25-14 Router B1’s Static Default Route (Using Outgoing Interface)|Example 25-14 Router B1’s Static Default Route (Using Outgoing Interface)
|
Example end.|Example end.
#### Static IPv6 Host Routes
Static IPv6 Host Routes   
__|__
--|--
|
Both IPv4 and IPv6 allow the definition of static host routes—that is, a route to a single host IP address.|Both IPv4 and IPv6 allow the definition of static host routes—that is, a route to a single host IP address.
With IPv4, those routes use a /32 mask, which identifies a single IPv4 address in the ip route command; with IPv6, a /128 mask identifies that single host in the ipv6 route command.|With IPv4, those routes use a /32 mask, which identifies a single IPv4 address in the ip route command; with IPv6, a /128 mask identifies that single host in the ipv6 route command.
|
A host route follows the same rules as a route for any other IPv6 subnet.|A host route follows the same rules as a route for any other IPv6 subnet.
For instance, if you refer back to Figure 25-3, host B sits on the right side of the figure.|For instance, if you refer back to Figure 25-3, host B sits on the right side of the figure.
Earlier examples showed R1’s static routes for the subnet in which host B resides—for example, the routes for Router R1 in Examples 25-8 and 25-10.|Earlier examples showed R1’s static routes for the subnet in which host B resides—for example, the routes for Router R1 in Examples 25-8 and 25-10.
To create a host route on R1, referring to host B’s specific IPv6 address, just change those commands to refer to host B’s entire IPv6 address (2001:DB8:1111:2::22), with prefix length /128.|To create a host route on R1, referring to host B’s specific IPv6 address, just change those commands to refer to host B’s entire IPv6 address (2001:DB8:1111:2::22), with prefix length /128.
|
Example 25-15 shows two sample host routes on Router R1. Both define a host route to host B’s IPv6 address as seen in Figure 25-3.|Example 25-15 shows two sample host routes on Router R1. Both define a host route to host B’s IPv6 address as seen in Figure 25-3.
One route uses Router R2’s link-local address as the next-hop address, and one route uses R2’s global unicast address as the next-hop address.|One route uses Router R2’s link-local address as the next-hop address, and one route uses R2’s global unicast address as the next-hop address.
|
Example 25-15 Static Host IPv6 Routes on R1, for Host B Example end.|Example 25-15 Static Host IPv6 Routes on R1, for Host B Example end.
#### Floating Static IPv6 Routes
Floating Static IPv6 Routes   
__|__
--|--
|
Next, consider the case in which a static route competes with other static routes or routes learned by a routing protocol.|Next, consider the case in which a static route competes with other static routes or routes learned by a routing protocol.
For example, consider the topology shown in Figure 25-6, which shows a branch office with two WAN links: one very fast Gigabit Ethernet link and one rather slow (but cheap) T1. In this design, the network uses OSPFv3 to learn IPv6 routes over the primary link, learning a route for subnet 2001:DB8:1111:7::/64.|For example, consider the topology shown in Figure 25-6, which shows a branch office with two WAN links: one very fast Gigabit Ethernet link and one rather slow (but cheap) T1. In this design, the network uses OSPFv3 to learn IPv6 routes over the primary link, learning a route for subnet 2001:DB8:1111:7::/64.
R1 also defines a static route over the backup link to that exact same subnet, so R1 must choose whether to use the static route or the OSPF-learned route.|R1 also defines a static route over the backup link to that exact same subnet, so R1 must choose whether to use the static route or the OSPF-learned route.
|
Figure 25-6 Using a Floating Static Route to Key Subnet 2001:DB8:1111:7::/64 IOS considers static routes better than OSPF-learned routes by default due to administrative distance.|Figure 25-6 Using a Floating Static Route to Key Subnet 2001:DB8:1111:7::/64 IOS considers static routes better than OSPF-learned routes by default due to administrative distance.
IOS uses the same administrative distance concept and default values for IPv6 as it does for IPv4.|IOS uses the same administrative distance concept and default values for IPv6 as it does for IPv4.
As a result, a static IPv6 route over the lower path would be given an administrative distance of 1, and an OSPFv3-learned route over the top path would be given an administrative distance of 110.|As a result, a static IPv6 route over the lower path would be given an administrative distance of 1, and an OSPFv3-learned route over the top path would be given an administrative distance of 110.
R1 would use the lower path to reach subnet 2001:DB8:1111:7::/64 in this case, which is not the intended design.|R1 would use the lower path to reach subnet 2001:DB8:1111:7::/64 in this case, which is not the intended design.
Instead, the engineer prefers to use the OSPF-learned routes over the much-faster primary link and use the static route over the backup link only as needed when the primary link fails.|Instead, the engineer prefers to use the OSPF-learned routes over the much-faster primary link and use the static route over the backup link only as needed when the primary link fails.
|
To instead prefer the OSPF routes, the configuration would need to change the administrative distance settings and use what many networkers call a floating static route.|To instead prefer the OSPF routes, the configuration would need to change the administrative distance settings and use what many networkers call a floating static route.
Like an IPv4 floating static route, an IPv6 floating static route floats or moves into and out of the IPv6 routing table depending on whether the better (lower) administrative distance route learned by the routing protocol happens to exist currently.|Like an IPv4 floating static route, an IPv6 floating static route floats or moves into and out of the IPv6 routing table depending on whether the better (lower) administrative distance route learned by the routing protocol happens to exist currently.
Basically, the router ignores the static route during times when the better routing protocol route is known.|Basically, the router ignores the static route during times when the better routing protocol route is known.
|
To implement an IPv6 floating static route, just override the default administrative distance on the static route, making the value larger than the default administrative distance of the routing protocol.|To implement an IPv6 floating static route, just override the default administrative distance on the static route, making the value larger than the default administrative distance of the routing protocol.
For example, the ipv6 route 2001:db8:1111:7::/64 2001:db8:1111:9::3 130 command on R1 would do exactly that, setting the static route’s administrative distance to 130.|For example, the ipv6 route 2001:db8:1111:7::/64 2001:db8:1111:9::3 130 command on R1 would do exactly that, setting the static route’s administrative distance to 130.
As long as the primary link (G0/0) stays up, and OSPFv3 on R1 learns a route for 2001:db8:1111:7::/64 with OSPF’s default administrative distance of 110, R1 ignores the static route whose administrative distance is explicitly configured as 130.|As long as the primary link (G0/0) stays up, and OSPFv3 on R1 learns a route for 2001:db8:1111:7::/64 with OSPF’s default administrative distance of 110, R1 ignores the static route whose administrative distance is explicitly configured as 130.
|
Finally, note that both the show ipv6 route and show ipv6 route 2001:db8:1111:7::/64 commands list the administrative distance.|Finally, note that both the show ipv6 route and show ipv6 route 2001:db8:1111:7::/64 commands list the administrative distance.
Example 25-16 shows a sample matching this most recent example.|Example 25-16 shows a sample matching this most recent example.
Note that in this case, the static route is in use in the IPv6 routing table.|Note that in this case, the static route is in use in the IPv6 routing table.
|
Example 25-16 Displaying the Administrative Distance of the Static Route Example end.|Example 25-16 Displaying the Administrative Distance of the Static Route Example end.
|
Table 25-2 lists some of the default administrative distance values used with IPv6.|Table 25-2 lists some of the default administrative distance values used with IPv6.
|
Table 25-2 IOS Defaults for Administrative Distance Table end.|Table 25-2 IOS Defaults for Administrative Distance Table end.
#### Troubleshooting Static IPv6 Routes
Troubleshooting Static IPv6 Routes   
__|__
--|--
|
IPv6 static routes have the same potential issues and mistakes as do static IPv4 routes, as discussed in Chapter 16.|IPv6 static routes have the same potential issues and mistakes as do static IPv4 routes, as discussed in Chapter 16.
However, IPv6 static routes do have a few small differences.|However, IPv6 static routes do have a few small differences.
This last part of the static route content in the chapter looks at troubleshooting IPv6 static routes, reviewing many of the same troubleshooting rules applied to IPv4 static routes, while focusing on the details specific to IPv6.|This last part of the static route content in the chapter looks at troubleshooting IPv6 static routes, reviewing many of the same troubleshooting rules applied to IPv4 static routes, while focusing on the details specific to IPv6.
|
This topic breaks static route troubleshooting into two perspectives: cases in which the route is in the routing table but is incorrect, and cases in which the route is not in the routing table.|This topic breaks static route troubleshooting into two perspectives: cases in which the route is in the routing table but is incorrect, and cases in which the route is not in the routing table.
##### Troubleshooting Incorrect Static Routes That Appear in the IPv6 Routing Table
Troubleshooting Incorrect Static Routes That Appear in the IPv6 Routing Table   
__|__
--|--
|
A static route is only as good as the input typed into the ipv6 route command.|A static route is only as good as the input typed into the ipv6 route command.
IOS checks the syntax of the command, of course.|IOS checks the syntax of the command, of course.
However, IOS cannot tell if you choose the incorrect outgoing interface, incorrect next-hop address, or incorrect prefix/prefix-length in a static route.|However, IOS cannot tell if you choose the incorrect outgoing interface, incorrect next-hop address, or incorrect prefix/prefix-length in a static route.
If the parameters pass the syntax checks, IOS places the ipv6 route command into the running-config file.|If the parameters pass the syntax checks, IOS places the ipv6 route command into the running-config file.
Then, if no other problem exists (as discussed at the next heading), IOS puts the route into the IP routing table—even though the route may not work because of the poorly chosen parameters.|Then, if no other problem exists (as discussed at the next heading), IOS puts the route into the IP routing table—even though the route may not work because of the poorly chosen parameters.
|
For instance, an exam question might show a figure with Router R1 having an address of 2001:1:1:1::1 and neighboring Router R2 with an address of 2001:1:1:1::2.|For instance, an exam question might show a figure with Router R1 having an address of 2001:1:1:1::1 and neighboring Router R2 with an address of 2001:1:1:1::2.
If R1 lists a static route with the command ipv6 route 3333::/64 2001:1:1:1::1, the command would be accepted by IOS with correct syntax, but it would not be effective as a route.|If R1 lists a static route with the command ipv6 route 3333::/64 2001:1:1:1::1, the command would be accepted by IOS with correct syntax, but it would not be effective as a route.
Note that the command lists R1’s address as the next-hop address, and R1 cannot use its own IPv6 address as a next-hop address.|Note that the command lists R1’s address as the next-hop address, and R1 cannot use its own IPv6 address as a next-hop address.
IOS does not prevent the configuration of the command, however; it allows the command and adds the route to the IPv6 routing table, but the route cannot possibly forward packets correctly.|IOS does not prevent the configuration of the command, however; it allows the command and adds the route to the IPv6 routing table, but the route cannot possibly forward packets correctly.
|
When you see an exam question that has static routes, and you see them in the output of show ipv6 route, remember that the routes may have incorrect parameters.|When you see an exam question that has static routes, and you see them in the output of show ipv6 route, remember that the routes may have incorrect parameters.
Check for these types of mistakes:|Check for these types of mistakes:
|
Step 1.|Step 1.
Prefix/Length: Does the ipv6 route command reference the correct subnet ID (prefix) and mask (prefix length)?|Prefix/Length: Does the ipv6 route command reference the correct subnet ID (prefix) and mask (prefix length)?
|
Step 2.|Step 2.
If using a next-hop IPv6 address that is a link-local address:|If using a next-hop IPv6 address that is a link-local address:
|
A. Is the link-local address an address on the correct neighboring router? (It should be an address on another router on a shared link.)|A. Is the link-local address an address on the correct neighboring router? (It should be an address on another router on a shared link.)
|
B. Does the ipv6 route command also refer to the correct outgoing interface on the local router?|B. Does the ipv6 route command also refer to the correct outgoing interface on the local router?
|
Step 3.|Step 3.
If using a next-hop IPv6 address that is a global unicast or unique local address, is the address the correct unicast address of the neighboring router?|If using a next-hop IPv6 address that is a global unicast or unique local address, is the address the correct unicast address of the neighboring router?
|
Step 4.|Step 4.
If referencing an outgoing interface, does the ipv6 route command reference the interface on the local router (that is, the same router where the static route is configured)?|If referencing an outgoing interface, does the ipv6 route command reference the interface on the local router (that is, the same router where the static route is configured)?
|
This troubleshooting checklist works through the various cases in which IOS would accept the configuration of the static IPv6 route, but the route would not work because of the incorrect parameters in context.|This troubleshooting checklist works through the various cases in which IOS would accept the configuration of the static IPv6 route, but the route would not work because of the incorrect parameters in context.
It helps to see a few examples.|It helps to see a few examples.
Figure 25-7 shows a sample network to use for the examples; all the examples focus on routes added to Router R1, for the subnet on the far right.|Figure 25-7 shows a sample network to use for the examples; all the examples focus on routes added to Router R1, for the subnet on the far right.
|
Figure 25-7 Sample Topology for Incorrect IPv6 Route Examples Example 25-17 shows five ipv6 route commands.|Figure 25-7 Sample Topology for Incorrect IPv6 Route Examples Example 25-17 shows five ipv6 route commands.
All have correct syntax, but all have one incorrect value; that is, the route will not work because of the types of problems in the troubleshooting checklist.|All have correct syntax, but all have one incorrect value; that is, the route will not work because of the types of problems in the troubleshooting checklist.
Look for the short comment at the end of each configuration command to see why each is incorrect.|Look for the short comment at the end of each configuration command to see why each is incorrect.
|
Example 25-17 IPv6 route Commands with Correct Syntax but Incorrect Ideas Example end.|Example 25-17 IPv6 route Commands with Correct Syntax but Incorrect Ideas Example end.
|
All these incorrect examples have correct syntax and would be added to R1’s IPv6 routing table if configured on R1. However, all have flaws.|All these incorrect examples have correct syntax and would be added to R1’s IPv6 routing table if configured on R1. However, all have flaws.
Working through the examples in order:|Working through the examples in order:
|
Step 1.|Step 1.
The prefix (2001:DB8:9:33::) has a typo in the fourth quartet (33 instead of 3).|The prefix (2001:DB8:9:33::) has a typo in the fourth quartet (33 instead of 3).
|
Step 2A.|Step 2A.
The figure shows R2’s G0/1 with link-local address FE80::2, but the command uses FE80::AAA9.|The figure shows R2’s G0/1 with link-local address FE80::2, but the command uses FE80::AAA9.
|
Step 2B.|Step 2B.
The command uses the correct link-local address on R2’s address on the common link (FE80::2 per the figure), but it omits the outgoing interface of R1’s G0/2 interface. (See the next example for more detail.)|The command uses the correct link-local address on R2’s address on the common link (FE80::2 per the figure), but it omits the outgoing interface of R1’s G0/2 interface. (See the next example for more detail.)
|
Step 3.|Step 3.
The figure shows the subnet in the center as 2001:DB8:9:2::/64, with R1 using the ::1 address and R2 using ::2.|The figure shows the subnet in the center as 2001:DB8:9:2::/64, with R1 using the ::1 address and R2 using ::2.
For the fourth command, R1’s command should use R2’s address 2001:DB8:9:2::2, but it uses R1’s own 2001:DB8:9:2::1 address instead.|For the fourth command, R1’s command should use R2’s address 2001:DB8:9:2::2, but it uses R1’s own 2001:DB8:9:2::1 address instead.
|
Step 4.|Step 4.
As a command on R1, the outgoing interface references R1’s own interfaces.|As a command on R1, the outgoing interface references R1’s own interfaces.
R1’s G0/1 is the interface on the left, whereas R1 should use its G0/2 interface on the right when forwarding packets to subnet 2001:DB8:9:3::/64.|R1’s G0/1 is the interface on the left, whereas R1 should use its G0/2 interface on the right when forwarding packets to subnet 2001:DB8:9:3::/64.
|
The key takeaway for this section is to know that a route in the IPv6 routing table may be incorrect due to poor choices for the parameters.|The key takeaway for this section is to know that a route in the IPv6 routing table may be incorrect due to poor choices for the parameters.
The parameters should always include the neighboring router’s IPv6 addresses, but the local router’s interface type/number, and in all cases, the correct prefix/length.|The parameters should always include the neighboring router’s IPv6 addresses, but the local router’s interface type/number, and in all cases, the correct prefix/length.
The fact that a route is in the IPv6 routing table, particularly a static route, does not mean it is a correct route.|The fact that a route is in the IPv6 routing table, particularly a static route, does not mean it is a correct route.
|
Note that of the five example commands in Example 25-17, IOS would accept all of them except the third one.|Note that of the five example commands in Example 25-17, IOS would accept all of them except the third one.
IOS can notice the case of omitting the outgoing interface if the nexthop address is a link-local address.|IOS can notice the case of omitting the outgoing interface if the nexthop address is a link-local address.
Example 25-18 shows a sample of the error message from IOS.|Example 25-18 shows a sample of the error message from IOS.
|
Example 25-18 IOS Rejects the ipv6 route Command with Link-Local and No Outgoing Example end.|Example 25-18 IOS Rejects the ipv6 route Command with Link-Local and No Outgoing Example end.
##### The Static Route Does Not Appear in the IPv6 Routing Table
The Static Route Does Not Appear in the IPv6 Routing Table   
__|__
--|--
|
The preceding few pages focused on IPv6 static routes that show up in the IPv6 routing table but unfortunately have incorrect parameters.|The preceding few pages focused on IPv6 static routes that show up in the IPv6 routing table but unfortunately have incorrect parameters.
The next page looks at IPv6 routes that have correct parameters, but IOS does not place them into the IPv6 routing table.|The next page looks at IPv6 routes that have correct parameters, but IOS does not place them into the IPv6 routing table.
|
When you add an ipv6 route command to the configuration, and the syntax is correct, IOS considers that route to be added to the IPv6 routing table.|When you add an ipv6 route command to the configuration, and the syntax is correct, IOS considers that route to be added to the IPv6 routing table.
IOS makes the following checks before adding the route; note that IOS uses this same kind of logic for IPv4 static routes:|IOS makes the following checks before adding the route; note that IOS uses this same kind of logic for IPv4 static routes:
###### For ipv6 route commands that list an outgoing interface, that interface must be in an
For ipv6 route commands that list an outgoing interface, that interface must be in an   
__|__
--|--
|
up/up state.|up/up state.
###### For ipv6 route commands that list a global unicast or unique local next-hop IP address
For ipv6 route commands that list a global unicast or unique local next-hop IP address   
__|__
--|--
|
(that is, not a link-local address), the local router must have a route to reach that next-hop address.|(that is, not a link-local address), the local router must have a route to reach that next-hop address.
###### If another IPv6 route exists for that exact same prefix/prefix-length, the static route must
If another IPv6 route exists for that exact same prefix/prefix-length, the static route must   
__|__
--|--
|
have a better (lower) administrative distance.|have a better (lower) administrative distance.
### The Neighbor Discovery Protocol
The Neighbor Discovery Protocol   
__|__
--|--
|
Similar to ICMP for IPv4, IPv6 defines the ICMP protocol for IPv6 (ICMPv6).|Similar to ICMP for IPv4, IPv6 defines the ICMP protocol for IPv6 (ICMPv6).
However, ICMPv6 reaches further than ICMPv4, pulling in functions done by other miscellaneous protocols in IPv4.|However, ICMPv6 reaches further than ICMPv4, pulling in functions done by other miscellaneous protocols in IPv4.
For instance, with IPv4, ARP works as a separate protocol; with IPv6, the Neighbor Discovery Protocol (NDP), a part of ICMPv6, performs the same functions.|For instance, with IPv4, ARP works as a separate protocol; with IPv6, the Neighbor Discovery Protocol (NDP), a part of ICMPv6, performs the same functions.
|
As it turns out, routers play a key role in several NDP protocol functions, so this final major section of the chapter explains a few of the functions of the NDP protocol (RFC 4861).|As it turns out, routers play a key role in several NDP protocol functions, so this final major section of the chapter explains a few of the functions of the NDP protocol (RFC 4861).
|
Some of those NDP functions are Neighbor MAC Discovery: An IPv6 LAN-based host will need to learn the MAC address of other hosts in the same subnet.|Some of those NDP functions are Neighbor MAC Discovery: An IPv6 LAN-based host will need to learn the MAC address of other hosts in the same subnet.
NDP replaces IPv4’s ARP, providing messages that replace the ARP Request and Reply messages.|NDP replaces IPv4’s ARP, providing messages that replace the ARP Request and Reply messages.
|
Router Discovery: Hosts learn the IPv6 addresses of the available IPv6 routers in the same subnet.|Router Discovery: Hosts learn the IPv6 addresses of the available IPv6 routers in the same subnet.
|
SLAAC: When using Stateless Address Auto Configuration (SLAAC), the host uses NDP messages to learn the subnet (prefix) used on the link plus the prefix length.|SLAAC: When using Stateless Address Auto Configuration (SLAAC), the host uses NDP messages to learn the subnet (prefix) used on the link plus the prefix length.
|
DAD: Before using an IPv6 address, hosts use NDP to perform a Duplicate Address Detection (DAD) process, to ensure no other host uses the same IPv6 address before attempting to use it.|DAD: Before using an IPv6 address, hosts use NDP to perform a Duplicate Address Detection (DAD) process, to ensure no other host uses the same IPv6 address before attempting to use it.
#### Discovering Neighbor Link Addresses with NDP NS and NA
Discovering Neighbor Link Addresses with NDP NS and NA   
__|__
--|--
|
NDP replaces IPv4 ARP using a pair of matched solicitation and advertisement messages: the Neighbor Solicitation (NS) and Neighbor Advertisement (NA) messages.|NDP replaces IPv4 ARP using a pair of matched solicitation and advertisement messages: the Neighbor Solicitation (NS) and Neighbor Advertisement (NA) messages.
Basically, the NS acts like an IPv4 ARP request, asking the host with a particular unicast IPv6 address to send back a reply.|Basically, the NS acts like an IPv4 ARP request, asking the host with a particular unicast IPv6 address to send back a reply.
The NA message acts like an IPv4 ARP Reply, listing that host’s MAC address.|The NA message acts like an IPv4 ARP Reply, listing that host’s MAC address.
|
The process of sending the NS and NA messages follows the same general process with IPv4 ARP: the NS message asks for information, and the NA supplies the information, as summarized in this list:|The process of sending the NS and NA messages follows the same general process with IPv4 ARP: the NS message asks for information, and the NA supplies the information, as summarized in this list:
|
Neighbor Solicitation (NS): This message asks the host with a particular IPv6 address (the target address) to reply with an NA message that lists its MAC address.|Neighbor Solicitation (NS): This message asks the host with a particular IPv6 address (the target address) to reply with an NA message that lists its MAC address.
The NS message is sent to the solicited-node multicast address associated with the target address, so the message is processed only by hosts whose last six hex digits match the address that is being queried.|The NS message is sent to the solicited-node multicast address associated with the target address, so the message is processed only by hosts whose last six hex digits match the address that is being queried.
|
Neighbor Advertisement (NA): This message lists the sender’s IPv6 and MAC addresses.|Neighbor Advertisement (NA): This message lists the sender’s IPv6 and MAC addresses.
|
It can be sent in reply to an NS message, and if so, the packet is sent to the IPv6 unicast address of the host that sent the original NS message.|It can be sent in reply to an NS message, and if so, the packet is sent to the IPv6 unicast address of the host that sent the original NS message.
A host can also send an unsolicited NA, announcing its IPv6 and MAC addresses, in which case the message is sent to the all-|A host can also send an unsolicited NA, announcing its IPv6 and MAC addresses, in which case the message is sent to the all-
|
IPv6-hosts local-scope multicast address FF02::1.|IPv6-hosts local-scope multicast address FF02::1.
|
NOTE With NDP, the word neighbor refers to the fact that the devices will be on the same data link—for example, the same VLAN.|NOTE With NDP, the word neighbor refers to the fact that the devices will be on the same data link—for example, the same VLAN.
|
Figure 25-8 shows an example of how a host (PC1) uses an NS message to learn the MAC address used by another host.|Figure 25-8 shows an example of how a host (PC1) uses an NS message to learn the MAC address used by another host.
The NS message lists a target IPv6 unicast address, with the implied question: “What is your link address?” The NA message, in this example sent back to the original host that asked the question, lists that link address.|The NS message lists a target IPv6 unicast address, with the implied question: “What is your link address?” The NA message, in this example sent back to the original host that asked the question, lists that link address.
|
Figure 25-8 Example NDP NS/NA Process to Find the Neighbor’s Link Addresses At Step 1 of this particular example, PC1 sends the solicitation to find PC2’s MAC address.|Figure 25-8 Example NDP NS/NA Process to Find the Neighbor’s Link Addresses At Step 1 of this particular example, PC1 sends the solicitation to find PC2’s MAC address.
|
PC1 first looks in its NDP neighbor table, the equivalent of the IPv4 ARP cache, and does not find the MAC address for IPv6 address 2001:DB8:1111:1::22.|PC1 first looks in its NDP neighbor table, the equivalent of the IPv4 ARP cache, and does not find the MAC address for IPv6 address 2001:DB8:1111:1::22.
So, at Step 1, PC1 sends the NDP NS message to the matching solicited-node multicast address for 2001:DB8:1111:1::22 or FF02::1:FF00:22.|So, at Step 1, PC1 sends the NDP NS message to the matching solicited-node multicast address for 2001:DB8:1111:1::22 or FF02::1:FF00:22.
Only IPv6 hosts whose address ends with 00:0022 will listen for this solicited-node multicast address.|Only IPv6 hosts whose address ends with 00:0022 will listen for this solicited-node multicast address.
As a result, only a small subset of hosts on this link will process the received NDP NS message.|As a result, only a small subset of hosts on this link will process the received NDP NS message.
|
At Step 2, PC2 reacts to the received NS message.|At Step 2, PC2 reacts to the received NS message.
PC2 sends back an NA message in reply, listing PC2’s MAC address.|PC2 sends back an NA message in reply, listing PC2’s MAC address.
PC1 records PC2’s MAC address in PC1’s NDP neighbor table.|PC1 records PC2’s MAC address in PC1’s NDP neighbor table.
|
Example 25-19 shows an example of the IPv6 neighbor table on Router R3, as seen originally back in Figure 25-1.|Example 25-19 shows an example of the IPv6 neighbor table on Router R3, as seen originally back in Figure 25-1.
In this case, R3 has learned the MAC addresses of Router R1’s WAN interface (G0/1/0)—both its global unicast address as well as the link-local address on that same interface.|In this case, R3 has learned the MAC addresses of Router R1’s WAN interface (G0/1/0)—both its global unicast address as well as the link-local address on that same interface.
|
Example 25-19 IPv6 Neighbor Table on Router R3 Example end.|Example 25-19 IPv6 Neighbor Table on Router R3 Example end.
|
NOTE To view a host’s NDP neighbor table, use these commands: (Windows) netsh interface ipv6 show neighbors; (Linux) ip -6 neighbor show; (Mac OS) ndp -an.|NOTE To view a host’s NDP neighbor table, use these commands: (Windows) netsh interface ipv6 show neighbors; (Linux) ip -6 neighbor show; (Mac OS) ndp -an.
#### Discovering Routers with NDP RS and RA
Discovering Routers with NDP RS and RA   
__|__
--|--
|
IPv4 hosts use the concept of an IPv4 default gateway or default router.|IPv4 hosts use the concept of an IPv4 default gateway or default router.
When the host needs to send a packet to some IPv4 subnet other than the local subnet, the host sends the IPv4 packet to the default router, expecting the router to be able to route the packet to the destination.|When the host needs to send a packet to some IPv4 subnet other than the local subnet, the host sends the IPv4 packet to the default router, expecting the router to be able to route the packet to the destination.
Note that hosts either statically set the IP address of their default gateway or learn it from a server called a Dynamic Host Configuration Protocol (DHCP) server.|Note that hosts either statically set the IP address of their default gateway or learn it from a server called a Dynamic Host Configuration Protocol (DHCP) server.
|
IPv6 uses the same concept of a default gateway, but it improves the method for hosts to learn the identity of possible default gateways using NDP. NDP defines two messages that allow any host to discover all routers in the subnet:|IPv6 uses the same concept of a default gateway, but it improves the method for hosts to learn the identity of possible default gateways using NDP. NDP defines two messages that allow any host to discover all routers in the subnet:
|
Router Solicitation (RS): This message is sent to the “all-IPv6-routers” local-scope multicast address of FF02::2 so that the message asks all routers, on the local link only, to identify themselves.|Router Solicitation (RS): This message is sent to the “all-IPv6-routers” local-scope multicast address of FF02::2 so that the message asks all routers, on the local link only, to identify themselves.
|
Router Advertisement (RA): This message, sent by the router, lists many facts, including the link-local IPv6 address of the router.|Router Advertisement (RA): This message, sent by the router, lists many facts, including the link-local IPv6 address of the router.
When sent in response to an RS message, it flows back to either the unicast address of the host that sent the RS or to the all-IPv6-hosts address FF02::1.|When sent in response to an RS message, it flows back to either the unicast address of the host that sent the RS or to the all-IPv6-hosts address FF02::1.
Routers also send RA messages without being asked, sent to the all-IPv6-|Routers also send RA messages without being asked, sent to the all-IPv6-
|
hosts local-scope multicast address of FF02::1.|hosts local-scope multicast address of FF02::1.
|
For example, Figure 25-9 shows how host PC1 can learn R1’s link-local address.|For example, Figure 25-9 shows how host PC1 can learn R1’s link-local address.
The process is indeed simple, with PC1 first asking and R1 replying.|The process is indeed simple, with PC1 first asking and R1 replying.
|
Figure 25-9 Example NDP RS/RA Process to Find the Default Routers NOTE IPv6 allows multiple prefixes and multiple default routers to be listed in the RA message; Figure 25-9 just shows one of each for simplicity’s sake.|Figure 25-9 Example NDP RS/RA Process to Find the Default Routers NOTE IPv6 allows multiple prefixes and multiple default routers to be listed in the RA message; Figure 25-9 just shows one of each for simplicity’s sake.
|
IPv6 does not use broadcasts, but it does use multicasts.|IPv6 does not use broadcasts, but it does use multicasts.
In this case, the RS message flows to the all-routers multicast address (FF02::2) so that all routers will receive the message.|In this case, the RS message flows to the all-routers multicast address (FF02::2) so that all routers will receive the message.
It has the same good effect as a broadcast with IPv4, without the negatives of a broadcast.|It has the same good effect as a broadcast with IPv4, without the negatives of a broadcast.
In this case, only IPv6 routers will spend any CPU cycles processing the RS message, and IPv6 hosts will ignore the message.|In this case, only IPv6 routers will spend any CPU cycles processing the RS message, and IPv6 hosts will ignore the message.
The RA message can flow either to the unicast IPv6 address of PC1 or to the all-nodes FF02::1 address.|The RA message can flow either to the unicast IPv6 address of PC1 or to the all-nodes FF02::1 address.
|
Note that while Figure 25-9 shows how a host can ask to learn about any routers, routers also periodically send unsolicited RA messages, even without an incoming RS. When routers send these periodic RA messages, they basically advertise details about IPv6 on the link.|Note that while Figure 25-9 shows how a host can ask to learn about any routers, routers also periodically send unsolicited RA messages, even without an incoming RS. When routers send these periodic RA messages, they basically advertise details about IPv6 on the link.
In this case, the RA messages flow to the FF02::1 all-nodes IPv6 multicast address.|In this case, the RA messages flow to the FF02::1 all-nodes IPv6 multicast address.
#### Using SLAAC with NDP RS and RA
Using SLAAC with NDP RS and RA   
__|__
--|--
|
Both IPv4 and IPv6 support the idea of dynamic address assignment for hosts via the Dynamic Host Configuration Protocol (DHCP). To find an address to use with DHCP, the DHCP client sends messages to a DHCP server, and the server assigns a currently unused address in the correct subnet for the endpoint host to use.|Both IPv4 and IPv6 support the idea of dynamic address assignment for hosts via the Dynamic Host Configuration Protocol (DHCP). To find an address to use with DHCP, the DHCP client sends messages to a DHCP server, and the server assigns a currently unused address in the correct subnet for the endpoint host to use.
The process relies on DHCP client functions in each device and a DHCP server configured and working in the network.|The process relies on DHCP client functions in each device and a DHCP server configured and working in the network.
|
IPv6 supports an alternative method for IPv6 hosts to dynamically choose an unused IPv6 address to use—a process that does not require a server like a DHCP server.|IPv6 supports an alternative method for IPv6 hosts to dynamically choose an unused IPv6 address to use—a process that does not require a server like a DHCP server.
The process goes by the name Stateless Address Autoconfiguration (SLAAC). SLAAC uses a simple three-step process that begins by learning the prefix/length as shown in the figure.|The process goes by the name Stateless Address Autoconfiguration (SLAAC). SLAAC uses a simple three-step process that begins by learning the prefix/length as shown in the figure.
The steps are as follows:|The steps are as follows:
|
1. Learn the IPv6 prefix used on the link, from any router, using NDP RS/RA messages.|1. Learn the IPv6 prefix used on the link, from any router, using NDP RS/RA messages.
|
2. Build an address from the prefix plus an interface ID, chosen either by using EUI-64 rules or as a random value.|2. Build an address from the prefix plus an interface ID, chosen either by using EUI-64 rules or as a random value.
|
3. Before using the address, first use DAD to make sure that no other host is already using the same address.|3. Before using the address, first use DAD to make sure that no other host is already using the same address.
|
Figure 25-10 shows the structure of an IPv6 address created with SLACC using Steps 1 and 2 in the process, with the next topic detailing the third step (DAD).|Figure 25-10 shows the structure of an IPv6 address created with SLACC using Steps 1 and 2 in the process, with the next topic detailing the third step (DAD).
|
Figure 25-10 Host IPv6 Address Formation Using SLAAC|Figure 25-10 Host IPv6 Address Formation Using SLAAC
#### Discovering Duplicate Addresses Using NDP NS and NA
Discovering Duplicate Addresses Using NDP NS and NA   
__|__
--|--
|
IPv6 uses the Duplicate Address Detection (DAD) process before using a unicast address to make sure that no other node on that link is already using the address.|IPv6 uses the Duplicate Address Detection (DAD) process before using a unicast address to make sure that no other node on that link is already using the address.
Hosts use DAD not only at the end of the SLAAC process, but also any time that a host interface initializes, no matter whether using SLAAC, DHCP, or static address configuration.|Hosts use DAD not only at the end of the SLAAC process, but also any time that a host interface initializes, no matter whether using SLAAC, DHCP, or static address configuration.
When performing DAD, if another host already uses that address, the first host simply does not use the address until the problem is resolved.|When performing DAD, if another host already uses that address, the first host simply does not use the address until the problem is resolved.
|
The term DAD refers to the function, but the function uses NDP NS and NA messages.|The term DAD refers to the function, but the function uses NDP NS and NA messages.
|
Basically, a host sends an NS message for its own IPv6 address.|Basically, a host sends an NS message for its own IPv6 address.
No other host should be using that address, so no other host should send an NDP NA in reply.|No other host should be using that address, so no other host should send an NDP NA in reply.
However, if another host already uses that address, that host will reply with an NA, identifying a duplicate use of the address.|However, if another host already uses that address, that host will reply with an NA, identifying a duplicate use of the address.
|
Figure 25-11 shows an example.|Figure 25-11 shows an example.
PC1 initializes and does a DAD check, but PC2 happens to already be working and already be using the address.|PC1 initializes and does a DAD check, but PC2 happens to already be working and already be using the address.
The figure shows the following steps:|The figure shows the following steps:
|
1. PC1, before using address 2001:DB8:1111:1::11, must use DAD.|1. PC1, before using address 2001:DB8:1111:1::11, must use DAD.
|
2. PC1 sends an NS message, listing the address PC1 now wants to use (2001:DB8:1111:1::11) as the target.|2. PC1 sends an NS message, listing the address PC1 now wants to use (2001:DB8:1111:1::11) as the target.
|
3. PC2 receives the NS, sees what PC2 already uses as its own address, and sends back an NA.|3. PC2 receives the NS, sees what PC2 already uses as its own address, and sends back an NA.
|
4. PC1, on receiving the NA message for its own IPv6 address, realizes a duplicate address exists.|4. PC1, on receiving the NA message for its own IPv6 address, realizes a duplicate address exists.
|
Figure 25-11 Example Duplicate Address Detection (DAD) with NDP NS/NA Hosts do the DAD check for each of their unicast addresses, link-local addresses included, both when the address is first used and each time the host’s interface comes up.|Figure 25-11 Example Duplicate Address Detection (DAD) with NDP NS/NA Hosts do the DAD check for each of their unicast addresses, link-local addresses included, both when the address is first used and each time the host’s interface comes up.
#### NDP Summary
NDP Summary   
__|__
--|--
|
This chapter explains some of the more important functions performed by NDP. NDP does more than what is listed in this chapter, and the protocol allows for addition of other functions, so NDP might continue to grow over time.|This chapter explains some of the more important functions performed by NDP. NDP does more than what is listed in this chapter, and the protocol allows for addition of other functions, so NDP might continue to grow over time.
For now, use Table 25-3 as a study reference for the four NDP features discussed here.|For now, use Table 25-3 as a study reference for the four NDP features discussed here.
|
Table 25-3 NDP Function Summary Table end.|Table 25-3 NDP Function Summary Table end.
### Chapter Review
Chapter Review   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|One key to doing well on the exams is to perform repetitive spaced review sessions.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.
Refer to the “Your Study Plan” element for more details.|Refer to the “Your Study Plan” element for more details.
Table 25-4 outlines the key review elements and where you can find them.|Table 25-4 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 25-4 Chapter Review Tracking Table end.|Table 25-4 Chapter Review Tracking Table end.
|
Review All the Key Topics Key Terms You Should Know IPv6 host route, local route, IPv6 local route, IPv6 administrative distance, IPv6 multicast scope Command References Tables 25-6 and 25-7 list configuration and verification commands used in this chapter.|Review All the Key Topics Key Terms You Should Know IPv6 host route, local route, IPv6 local route, IPv6 administrative distance, IPv6 multicast scope Command References Tables 25-6 and 25-7 list configuration and verification commands used in this chapter.
As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.|As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Then repeat the exercise, covering the right column, and try to recall what the command does.
|
Table 25-6 Chapter 25 Configuration Command Reference Table end.|Table 25-6 Chapter 25 Configuration Command Reference Table end.
|
Table 25-7 Chapter 25 EXEC Command Reference Table end.|Table 25-7 Chapter 25 EXEC Command Reference Table end.
|
Keep track of your part review progress with the checklist in Table P7-1.|Keep track of your part review progress with the checklist in Table P7-1.
Details on each task follow the table.|Details on each task follow the table.
|
Table P7-1 Part VII Part Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Do Labs Watch Videos Repeat All DIKTA Questions For this task, use the PCPT software to answer the “Do I Know This Already?” questions again for the chapters in this part of the book.|Table P7-1 Part VII Part Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Do Labs Watch Videos Repeat All DIKTA Questions For this task, use the PCPT software to answer the “Do I Know This Already?” questions again for the chapters in this part of the book.
|
Answer Part Review Questions For this task, use PTP to answer the Part Review questions for this part of the book.|Answer Part Review Questions For this task, use PTP to answer the Part Review questions for this part of the book.
|
Review Key Topics Review all key topics in all chapters in this part, either by browsing the chapters or using the Key Topics application on the companion website.|Review Key Topics Review all key topics in all chapters in this part, either by browsing the chapters or using the Key Topics application on the companion website.
|
Do Labs Depending on your chosen lab tool, here are some suggestions for what to do in lab:|Do Labs Depending on your chosen lab tool, here are some suggestions for what to do in lab:
|
Pearson Network Simulator: If you use the full Pearson simulator, focus more on the configuration scenario and troubleshooting scenario labs associated with the topics in this part of the book.|Pearson Network Simulator: If you use the full Pearson simulator, focus more on the configuration scenario and troubleshooting scenario labs associated with the topics in this part of the book.
These types of labs include a larger set of topics and work well as Part Review activities. (See the Introduction for some details about how to find which labs are about topics in this part of the book.)|These types of labs include a larger set of topics and work well as Part Review activities. (See the Introduction for some details about how to find which labs are about topics in this part of the book.)
|
Blog: Config Labs: The author’s blog includes a series of configuration-focused labs that you can do on paper, each in 10–15 minutes.|Blog: Config Labs: The author’s blog includes a series of configuration-focused labs that you can do on paper, each in 10–15 minutes.
Review and perform the labs for this part of the book, as found at http://blog.certskills.com.|Review and perform the labs for this part of the book, as found at http://blog.certskills.com.
Then navigate to the Hands-on Config labs.|Then navigate to the Hands-on Config labs.
## Part VII Review
Part VII Review   
__|__
--|--
|
Other: If using other lab tools, here are a few suggestions: Configure IPv6 addresses on interfaces, and before using any show commands, predict the connected and local routes that should be added to the IPv6 routing table, and predict the link-local (unicast)|Other: If using other lab tools, here are a few suggestions: Configure IPv6 addresses on interfaces, and before using any show commands, predict the connected and local routes that should be added to the IPv6 routing table, and predict the link-local (unicast)
|
address and various multicast addresses you expect to see in the output of the show ipv6 interfaces command.|address and various multicast addresses you expect to see in the output of the show ipv6 interfaces command.
|
Watch Videos Chapter 24 mentions that the companion website’s section for Chapter 24 review includes a video about the EUI-64 address generation process, so consider using the video as a review.|Watch Videos Chapter 24 mentions that the companion website’s section for Chapter 24 review includes a video about the EUI-64 address generation process, so consider using the video as a review.
|
This book began with an overview of the fundamentals of LANs, WANs, and IP routing.|This book began with an overview of the fundamentals of LANs, WANs, and IP routing.
It then described Ethernet LANs (wired LANs) in some depth over the course of seven chapters.|It then described Ethernet LANs (wired LANs) in some depth over the course of seven chapters.
|
The book then meandered through many chapters exploring the many concepts of IPv4 and IPv6 addressing, routing, and how to implement those features in Cisco devices.|The book then meandered through many chapters exploring the many concepts of IPv4 and IPv6 addressing, routing, and how to implement those features in Cisco devices.
|
This final part of Volume 1 turns our attention back to the LAN, not to wired Ethernet LANs, but to IEEE 802.11 wireless LANs—in other words, Wi-Fi. The four chapters in this part of the book lay down the foundations of how wireless LANs work and then show how to implement wireless LANs using Cisco devices.|This final part of Volume 1 turns our attention back to the LAN, not to wired Ethernet LANs, but to IEEE 802.11 wireless LANs—in other words, Wi-Fi. The four chapters in this part of the book lay down the foundations of how wireless LANs work and then show how to implement wireless LANs using Cisco devices.
|
Building wireless LANs requires some thought because the endpoints that use the LAN do not sit in one place and connect via a known cable and known switch port.|Building wireless LANs requires some thought because the endpoints that use the LAN do not sit in one place and connect via a known cable and known switch port.
To explain those details, Chapter 26 begins with the basics of how a wireless client can connect to the wireless network through a wireless access point (AP). After you learn the foundations in Chapter 26, Chapter 27 takes an architectural view of wireless LANs to discuss how you might build a wireless LAN for an enterprise, which requires much different thinking than, for instance, building a wireless LAN for your home.|To explain those details, Chapter 26 begins with the basics of how a wireless client can connect to the wireless network through a wireless access point (AP). After you learn the foundations in Chapter 26, Chapter 27 takes an architectural view of wireless LANs to discuss how you might build a wireless LAN for an enterprise, which requires much different thinking than, for instance, building a wireless LAN for your home.
|
Chapter 28 completes the three concepts-focused wireless LAN chapters by working through the alphabet soup that is wireless LAN security.|Chapter 28 completes the three concepts-focused wireless LAN chapters by working through the alphabet soup that is wireless LAN security.
The fact that wireless LAN clients come and go means that the LAN may be under constant attack as an easy place for an attacker to gain access to the network, so wireless LANs must use effective security.|The fact that wireless LAN clients come and go means that the LAN may be under constant attack as an easy place for an attacker to gain access to the network, so wireless LANs must use effective security.
Finally, Chapter 29 closes by showing how to configure an enterprise wireless LAN using Cisco APs and the Cisco Wireless LAN Controller (WLC) from the WLC’s graphical interface.|Finally, Chapter 29 closes by showing how to configure an enterprise wireless LAN using Cisco APs and the Cisco Wireless LAN Controller (WLC) from the WLC’s graphical interface.
## Part VIII Wireless LANs
Part VIII Wireless LANs   
__|__
--|--
|
Part VIII Review|Part VIII Review
## Chapter 26 Fundamentals of Wireless Networks
Chapter 26 Fundamentals of Wireless Networks   
__|__
--|--
|
Networks This chapter covers the following exam topics:|Networks This chapter covers the following exam topics:
###### 1.0 Network Fundamentals
1.0 Network Fundamentals   
###### 1.1 Explain the role and function of network components
1.1 Explain the role and function of network components   
###### 1.1.d Access Points
1.1.d Access Points   
###### 1.11 Describe wireless principles
1.11 Describe wireless principles   
###### 1.11.a Nonoverlapping Wi-Fi channels
1.11.a Nonoverlapping Wi-Fi channels   
###### 1.11.b SSID
1.11.b SSID   
###### 1.11.c RF
1.11.c RF   
__|__
--|--
|
Wireless communication usually involves a data exchange between two devices.|Wireless communication usually involves a data exchange between two devices.
A wireless LAN goes even further; many devices can participate in sharing the medium for data exchanges.|A wireless LAN goes even further; many devices can participate in sharing the medium for data exchanges.
Wireless LANs must transmit a signal over radio frequencies (RF) to move data from one device to another.|Wireless LANs must transmit a signal over radio frequencies (RF) to move data from one device to another.
Transmitters and receivers can be fixed in consistent locations, or they can be mobile and free to move around.|Transmitters and receivers can be fixed in consistent locations, or they can be mobile and free to move around.
This chapter explains the topologies that can be used to control access to the wireless medium and provide data exchange between devices.|This chapter explains the topologies that can be used to control access to the wireless medium and provide data exchange between devices.
### “Do I Know This Already?” Quiz
“Do I Know This Already?” Quiz   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.
The letter answers are listed at the bottom of the page following the quiz.|The letter answers are listed at the bottom of the page following the quiz.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.
You can also find both answers and explanations in the PTP testing software.|You can also find both answers and explanations in the PTP testing software.
|
Table 26-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Table 26-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping
### Foundation Topics
Foundation Topics   
### Comparing Wired and Wireless Networks
Comparing Wired and Wireless Networks   
### Wireless LAN Topologies
Wireless LAN Topologies   
__|__
--|--
|
Other Wireless Topologies 5–6 Wireless Bands and Channels 7–8 CHAPTER 26 1.|Other Wireless Topologies 5–6 Wireless Bands and Channels 7–8 CHAPTER 26 1.
Wired Ethernet and Wi-Fi are based on which two IEEE standards, respectively?|Wired Ethernet and Wi-Fi are based on which two IEEE standards, respectively?
|
a. 802.1, 802.3 b. 802.3, 802.1 c. 802.3, 802.11 d. 802.11, 802.3 2.|a. 802.1, 802.3 b. 802.3, 802.1 c. 802.3, 802.11 d. 802.11, 802.3 2.
Devices using a wireless LAN must operate in which one of the following modes?|Devices using a wireless LAN must operate in which one of the following modes?
|
a. Round-robin access b.|a. Round-robin access b.
Half duplex c.|Half duplex c.
Full duplex d.|Full duplex d.
None of these answers 3.|None of these answers 3.
An access point is set up to offer wireless coverage in an office.|An access point is set up to offer wireless coverage in an office.
Which one of the following is the correct 802.11 term for the resulting standalone network?|Which one of the following is the correct 802.11 term for the resulting standalone network?
|
a. BSA b.|a. BSA b.
BSD c.|BSD c.
BSS d.|BSS d.
IBSS 4.|IBSS 4.
Which one of the following is used to uniquely identify an AP and the basic service set it maintains with its associated wireless clients?|Which one of the following is used to uniquely identify an AP and the basic service set it maintains with its associated wireless clients?
|
a. SSID b.|a. SSID b.
BSSID c.|BSSID c.
Ethernet MAC address d.|Ethernet MAC address d.
Radio MAC address 5.|Radio MAC address 5.
Which one of the following can be used to provide wireless connectivity to a nonwireless device?|Which one of the following can be used to provide wireless connectivity to a nonwireless device?
|
a. Wireless repeater b.|a. Wireless repeater b.
Workgroup bridge c.|Workgroup bridge c.
Transparent bridge d.|Transparent bridge d.
Adaptive bridge 6.|Adaptive bridge 6.
Which one of the following is not needed in a Cisco outdoor mesh network?|Which one of the following is not needed in a Cisco outdoor mesh network?
|
a. A BSS function b.|a. A BSS function b.
Ethernet cabling to each AP c.|Ethernet cabling to each AP c.
A workgroup bridge d.|A workgroup bridge d.
A backhaul network 7.|A backhaul network 7.
Which of the following are frequency bands commonly used for Wi-Fi?|Which of the following are frequency bands commonly used for Wi-Fi?
|
a. 2.5 KHz b. 2.5 MHz c. 5 MHz d. 2.5 GHz e. 5 GHz 8.|a. 2.5 KHz b. 2.5 MHz c. 5 MHz d. 2.5 GHz e. 5 GHz 8.
Which of the following are considered to be nonoverlapping channels?|Which of the following are considered to be nonoverlapping channels?
|
a. Channels 1, 2, and 3 in the 2.4-GHz band b.|a. Channels 1, 2, and 3 in the 2.4-GHz band b.
Channels 1, 5, and 10 in the 2.4-GHz band c.|Channels 1, 5, and 10 in the 2.4-GHz band c.
Channels 1, 6, and 11 in the 2.4-GHz band d.|Channels 1, 6, and 11 in the 2.4-GHz band d.
Channels 40, 44, and 48 in the 5-GHz band Foundation Topics Comparing Wired and Wireless Networks In a wired network, any two devices that need to communicate with each other must be connected by a wire. (That was obvious!) The “wire” might contain strands of metal or fiberoptic material that run continuously from one end to the other.|Channels 40, 44, and 48 in the 5-GHz band Foundation Topics Comparing Wired and Wireless Networks In a wired network, any two devices that need to communicate with each other must be connected by a wire. (That was obvious!) The “wire” might contain strands of metal or fiberoptic material that run continuously from one end to the other.
Data that passes over the wire is bounded by the physical properties of the wire.|Data that passes over the wire is bounded by the physical properties of the wire.
In fact, the IEEE 802.3 set of standards defines strict guidelines for the Ethernet wire itself, in addition to how devices may connect, send, and receive data over the wire.|In fact, the IEEE 802.3 set of standards defines strict guidelines for the Ethernet wire itself, in addition to how devices may connect, send, and receive data over the wire.
|
Wired connections have been engineered with tight constraints and have few variables that might prevent successful communication.|Wired connections have been engineered with tight constraints and have few variables that might prevent successful communication.
Even the type and size of the wire strands, the number of twists the strands must make around each other over a distance, and the maximum length of the wire must adhere to the standard.|Even the type and size of the wire strands, the number of twists the strands must make around each other over a distance, and the maximum length of the wire must adhere to the standard.
|
Therefore, a wired network is essentially a bounded medium; data must travel over whatever path the wire or cable takes between two devices.|Therefore, a wired network is essentially a bounded medium; data must travel over whatever path the wire or cable takes between two devices.
If the cable goes around a corner or lies in a coil, the electrical signals used to carry the data must also go around a corner or around a coil.|If the cable goes around a corner or lies in a coil, the electrical signals used to carry the data must also go around a corner or around a coil.
Because only two devices may connect to a wire, only those two devices may send or transmit data.|Because only two devices may connect to a wire, only those two devices may send or transmit data.
Even better: the two devices may transmit data to each other simultaneously because they each have a private, direct path to each other.|Even better: the two devices may transmit data to each other simultaneously because they each have a private, direct path to each other.
|
Wired networks also have some shortcomings.|Wired networks also have some shortcomings.
When a device is connected by a wire, it cannot move around very easily or very far.|When a device is connected by a wire, it cannot move around very easily or very far.
Before a device can connect to a wired network, it must have a connector that is compatible with the one on the end of the wire.|Before a device can connect to a wired network, it must have a connector that is compatible with the one on the end of the wire.
As devices get smaller and more mobile, it just is not practical to connect them to a wire.|As devices get smaller and more mobile, it just is not practical to connect them to a wire.
|
As its name implies, a wireless network removes the need to be tethered to a wire or cable.|As its name implies, a wireless network removes the need to be tethered to a wire or cable.
|
Convenience and mobility become paramount, enabling users to move around at will while staying connected to the network.|Convenience and mobility become paramount, enabling users to move around at will while staying connected to the network.
A user can (and often does) bring along many different wireless devices that can all connect to the network easily and seamlessly.|A user can (and often does) bring along many different wireless devices that can all connect to the network easily and seamlessly.
|
Wireless data must travel through free space, without the constraints and protection of a wire.|Wireless data must travel through free space, without the constraints and protection of a wire.
In the free space environment, many variables can affect the data and its delivery.|In the free space environment, many variables can affect the data and its delivery.
To minimize the variables, wireless engineering efforts must focus on two things:|To minimize the variables, wireless engineering efforts must focus on two things:
###### Wireless devices must adhere to a common standard (IEEE 802.11).
Wireless devices must adhere to a common standard (IEEE 802.11).   
###### Wireless coverage must exist in the area where devices are expected to use it.
Wireless coverage must exist in the area where devices are expected to use it.   
__|__
--|--
|
As you study for the CCNA 200-301 exam, keep in mind that the exam is geared more toward a functional view of wireless technology.|As you study for the CCNA 200-301 exam, keep in mind that the exam is geared more toward a functional view of wireless technology.
More detailed topics like RF characteristics, antenna performance, and so on are reserved for the Implementing Cisco Enterprise Network Core Technologies ENCOR 300-401 exam.|More detailed topics like RF characteristics, antenna performance, and so on are reserved for the Implementing Cisco Enterprise Network Core Technologies ENCOR 300-401 exam.
|
Wireless LAN Topologies Wireless communication takes place over free space through the use of radio frequency (RF) signals.|Wireless LAN Topologies Wireless communication takes place over free space through the use of radio frequency (RF) signals.
The theory behind RF signals can be complex, and is described further in the “RF Overview” section in this chapter.|The theory behind RF signals can be complex, and is described further in the “RF Overview” section in this chapter.
For now, just assume that one device, the transmitter, sends RF signals to another device, the receiver.|For now, just assume that one device, the transmitter, sends RF signals to another device, the receiver.
As Figure 26-1 shows, the transmitter can contact the receiver at any and all times, as long as both devices are tuned to the same frequency (or channel) and use the same scheme to carry the data between them.|As Figure 26-1 shows, the transmitter can contact the receiver at any and all times, as long as both devices are tuned to the same frequency (or channel) and use the same scheme to carry the data between them.
That all sounds simple, except that it is not really practical.|That all sounds simple, except that it is not really practical.
|
Figure 26-1 Unidirectional Communication To fully leverage wireless communication, data should travel in both directions, as shown in Figure 26-2.|Figure 26-1 Unidirectional Communication To fully leverage wireless communication, data should travel in both directions, as shown in Figure 26-2.
Sometimes Device A needs to send data to Device B, while Device B would like to take a turn to send at other times.|Sometimes Device A needs to send data to Device B, while Device B would like to take a turn to send at other times.
|
Figure 26-2 Bidirectional Communication Because the two devices are using the same channel, two phrases in the preceding sentence become vitally important: take a turn and send at other times.|Figure 26-2 Bidirectional Communication Because the two devices are using the same channel, two phrases in the preceding sentence become vitally important: take a turn and send at other times.
With wireless communication, if multiple signals are received at the same time, they can interfere with each other.|With wireless communication, if multiple signals are received at the same time, they can interfere with each other.
The likelihood of interference increases as the number of wireless devices grows.|The likelihood of interference increases as the number of wireless devices grows.
For example, Figure 26-3 shows four devices tuned to the same channel and what might happen if some or all of them transmit at the same time.|For example, Figure 26-3 shows four devices tuned to the same channel and what might happen if some or all of them transmit at the same time.
|
Figure 26-3 Interference from Simultaneous Transmissions All this talk about waiting turns and avoiding interference might remind you of a traditional (nonswitched) Ethernet LAN, where multiple hosts can connect to a shared media and share a common bandwidth.|Figure 26-3 Interference from Simultaneous Transmissions All this talk about waiting turns and avoiding interference might remind you of a traditional (nonswitched) Ethernet LAN, where multiple hosts can connect to a shared media and share a common bandwidth.
To use the media effectively, all the hosts must operate in half-duplex mode so that they try to avoid colliding with other transmissions already in progress.|To use the media effectively, all the hosts must operate in half-duplex mode so that they try to avoid colliding with other transmissions already in progress.
The side effect is that no host can transmit and receive at the same time on a shared medium.|The side effect is that no host can transmit and receive at the same time on a shared medium.
|
A wireless LAN is similar.|A wireless LAN is similar.
Because multiple hosts can share the same channel, they also share the “airtime” or access to that channel at any given time.|Because multiple hosts can share the same channel, they also share the “airtime” or access to that channel at any given time.
Therefore, to keep everything clean, only one device should transmit at any given time.|Therefore, to keep everything clean, only one device should transmit at any given time.
To contend for use of the channel, devices based on the 802.11 standard have to determine whether the channel is clear and available before transmitting anything.|To contend for use of the channel, devices based on the 802.11 standard have to determine whether the channel is clear and available before transmitting anything.
|
NOTE IEEE 802.11 WLANs are always half duplex because transmissions between stations use the same frequency or channel.|NOTE IEEE 802.11 WLANs are always half duplex because transmissions between stations use the same frequency or channel.
Only one station can transmit at any time; otherwise, collisions occur.|Only one station can transmit at any time; otherwise, collisions occur.
To achieve full-duplex mode, one station’s transmission would have to occur on one frequency while it receives over a different frequency—much like full-duplex Ethernet links work.|To achieve full-duplex mode, one station’s transmission would have to occur on one frequency while it receives over a different frequency—much like full-duplex Ethernet links work.
Although this is certainly possible and practical, the 802.11 standard does not permit full-duplex operation.|Although this is certainly possible and practical, the 802.11 standard does not permit full-duplex operation.
Some amendments to the standard do provide a means for multiple devices to transmit on the same channel at the same time, but this is beyond the scope of this book.|Some amendments to the standard do provide a means for multiple devices to transmit on the same channel at the same time, but this is beyond the scope of this book.
|
At the most basic level, there is no inherent organization to a wireless medium or any inherent control over the number of devices that can transmit and receive frames.|At the most basic level, there is no inherent organization to a wireless medium or any inherent control over the number of devices that can transmit and receive frames.
Any device that has a wireless network adapter can power up at any time and try to communicate.|Any device that has a wireless network adapter can power up at any time and try to communicate.
At a minimum, a wireless network should have a way to make sure that every device using a channel can support a common set of parameters.|At a minimum, a wireless network should have a way to make sure that every device using a channel can support a common set of parameters.
Beyond that, there should be a way to control which devices (and users) are allowed to use the wireless medium and the methods that are used to secure the wireless transmissions.|Beyond that, there should be a way to control which devices (and users) are allowed to use the wireless medium and the methods that are used to secure the wireless transmissions.
#### Basic Service Set
Basic Service Set   
__|__
--|--
|
The solution is to make every wireless service area a closed group of mobile devices that forms around a fixed device; before a device can participate, it must advertise its capabilities and then be granted permission to join.|The solution is to make every wireless service area a closed group of mobile devices that forms around a fixed device; before a device can participate, it must advertise its capabilities and then be granted permission to join.
The 802.11 standard calls this a basic service set (BSS). At the heart of every BSS is a wireless access point (AP), as shown in Figure 26-4.|The 802.11 standard calls this a basic service set (BSS). At the heart of every BSS is a wireless access point (AP), as shown in Figure 26-4.
The AP operates in infrastructure mode, which means it offers the services that are necessary to form the infrastructure of a wireless network.|The AP operates in infrastructure mode, which means it offers the services that are necessary to form the infrastructure of a wireless network.
The AP also establishes its BSS over a single wireless channel.|The AP also establishes its BSS over a single wireless channel.
The AP and the members of the BSS must all use the same channel to communicate properly.|The AP and the members of the BSS must all use the same channel to communicate properly.
|
Because the operation of a BSS hinges on the AP, the BSS is bounded by the area where the AP’s signal is usable.|Because the operation of a BSS hinges on the AP, the BSS is bounded by the area where the AP’s signal is usable.
This is known as the basic service area (BSA) or cell.|This is known as the basic service area (BSA) or cell.
In Figure 26-4, the cell is shown as a simple shaded circular area that centers around the AP itself.|In Figure 26-4, the cell is shown as a simple shaded circular area that centers around the AP itself.
Cells can Answers to the “Do I Know This Already?” quiz:|Cells can Answers to the “Do I Know This Already?” quiz:
|
1 C 2 B 3 C 4 B 5 B 6 B 7 D, E 8 C, D have other shapes too, depending on the antenna that is connected to the AP and on the physical surroundings that might affect the AP’s signals.|1 C 2 B 3 C 4 B 5 B 6 B 7 D, E 8 C, D have other shapes too, depending on the antenna that is connected to the AP and on the physical surroundings that might affect the AP’s signals.
|
The AP serves as a single point of contact for every device that wants to use the BSS. It advertises the existence of the BSS so that devices can find it and try to join.|The AP serves as a single point of contact for every device that wants to use the BSS. It advertises the existence of the BSS so that devices can find it and try to join.
To do that, the AP uses a unique BSS identifier (BSSID) that is based on the AP’s own radio MAC address.|To do that, the AP uses a unique BSS identifier (BSSID) that is based on the AP’s own radio MAC address.
|
NOTE Recall that wired Ethernet devices each have a unique MAC address to send frames from a source to a destination over a Layer 2 network.|NOTE Recall that wired Ethernet devices each have a unique MAC address to send frames from a source to a destination over a Layer 2 network.
Wireless devices must also have unique MAC addresses to send wireless frames at Layer 2 over the air.|Wireless devices must also have unique MAC addresses to send wireless frames at Layer 2 over the air.
|
BSS AP SSID: “MyNetwork”|BSS AP SSID: “MyNetwork”
|
BSSID:|BSSID:
|
d4:20:6d:90:ad:20 Figure 26-4 802.11 Basic Service Set In addition, the AP advertises the wireless network with a Service Set Identifier (SSID), which is a text string containing a logical name.|d4:20:6d:90:ad:20 Figure 26-4 802.11 Basic Service Set In addition, the AP advertises the wireless network with a Service Set Identifier (SSID), which is a text string containing a logical name.
Think of the BSSID as a machine-readable name tag that uniquely identifies the BSS ambassador (the AP), and the SSID as a nonunique, human-readable name tag that identifies the wireless service.|Think of the BSSID as a machine-readable name tag that uniquely identifies the BSS ambassador (the AP), and the SSID as a nonunique, human-readable name tag that identifies the wireless service.
|
Membership with the BSS is called an association.|Membership with the BSS is called an association.
A wireless device must send an association request to the AP and the AP must either grant or deny the request.|A wireless device must send an association request to the AP and the AP must either grant or deny the request.
Once associated, a device becomes a client, or an 802.11 station (STA), of the BSS. What then?|Once associated, a device becomes a client, or an 802.11 station (STA), of the BSS. What then?
As long as a wireless client remains associated with a BSS, most communications to and from the client must pass through the AP, as indicated in Figure 26-5.|As long as a wireless client remains associated with a BSS, most communications to and from the client must pass through the AP, as indicated in Figure 26-5.
By using the BSSID as a source or destination address, data frames can be relayed to or from the AP.|By using the BSSID as a source or destination address, data frames can be relayed to or from the AP.
|
You might be wondering why all client traffic has to traverse the AP at all.|You might be wondering why all client traffic has to traverse the AP at all.
Why can two clients not simply transmit data frames directly to each other and bypass the middleman?|Why can two clients not simply transmit data frames directly to each other and bypass the middleman?
If clients are allowed to communicate directly, then the whole idea of organizing and managing a BSS is moot.|If clients are allowed to communicate directly, then the whole idea of organizing and managing a BSS is moot.
By sending data through the AP first, the BSS remains stable and under control.|By sending data through the AP first, the BSS remains stable and under control.
|
NOTE Even though data frames are meant to pass through an AP, keep in mind that other devices in the same general area that are listening on the same channel can overhear the transmissions.|NOTE Even though data frames are meant to pass through an AP, keep in mind that other devices in the same general area that are listening on the same channel can overhear the transmissions.
After all, wireless frames are not contained within a wire that connects a device to an AP. Instead, the frames are freely available over the air to anyone that is within range to receive them.|After all, wireless frames are not contained within a wire that connects a device to an AP. Instead, the frames are freely available over the air to anyone that is within range to receive them.
If the frames are unencrypted, then anyone may inspect their contents.|If the frames are unencrypted, then anyone may inspect their contents.
|
Only the BSSID value contained within the frames indicates that the intended sender or recipient is the AP.|Only the BSSID value contained within the frames indicates that the intended sender or recipient is the AP.
|
Figure 26-5 Traffic Flows Within a BSS|Figure 26-5 Traffic Flows Within a BSS
#### Distribution System
Distribution System   
__|__
--|--
|
Notice that a BSS involves a single AP and no explicit connection into a regular Ethernet network.|Notice that a BSS involves a single AP and no explicit connection into a regular Ethernet network.
|
In that setting, the AP and its associated clients make up a standalone network.|In that setting, the AP and its associated clients make up a standalone network.
But the AP’s role at the center of the BSS does not just stop with managing the BSS; sooner or later, wireless clients will need to communicate with other devices that are not members of the BSS. Fortunately, an AP can also uplink into an Ethernet network because it has both wireless and wired capabilities.|But the AP’s role at the center of the BSS does not just stop with managing the BSS; sooner or later, wireless clients will need to communicate with other devices that are not members of the BSS. Fortunately, an AP can also uplink into an Ethernet network because it has both wireless and wired capabilities.
The 802.11 standard refers to the upstream wired Ethernet as the distribution system (DS) for the wireless BSS, as shown in Figure 26-6.|The 802.11 standard refers to the upstream wired Ethernet as the distribution system (DS) for the wireless BSS, as shown in Figure 26-6.
|
You can think of an AP as a translational bridge, where frames from two dissimilar media (wireless and wired) are translated and then bridged at Layer 2.|You can think of an AP as a translational bridge, where frames from two dissimilar media (wireless and wired) are translated and then bridged at Layer 2.
In simple terms, the AP is in charge of mapping a virtual local-area network (VLAN) to an SSID. In Figure 26-6, the AP maps VLAN 10 to the wireless LAN using SSID “MyNetwork.” Clients associated with the “MyNetwork” SSID will appear to be connected to VLAN 10.|In simple terms, the AP is in charge of mapping a virtual local-area network (VLAN) to an SSID. In Figure 26-6, the AP maps VLAN 10 to the wireless LAN using SSID “MyNetwork.” Clients associated with the “MyNetwork” SSID will appear to be connected to VLAN 10.
|
Figure 26-6 Distribution System Supporting a BSS This concept can be extended so that multiple VLANs are mapped to multiple SSIDs. To do this, the AP must be connected to the switch by a trunk link that carries the VLANs. In Figure 26-7, VLANs 10, 20, and 30 are trunked to the AP over the DS. The AP uses the 802.1Q tag to map the VLAN numbers to the appropriate SSIDs. For example, VLAN 10 is mapped to SSID “MyNetwork,” VLAN 20 is mapped to SSID “YourNetwork,” and VLAN 30 to SSID “Guest.”|Figure 26-6 Distribution System Supporting a BSS This concept can be extended so that multiple VLANs are mapped to multiple SSIDs. To do this, the AP must be connected to the switch by a trunk link that carries the VLANs. In Figure 26-7, VLANs 10, 20, and 30 are trunked to the AP over the DS. The AP uses the 802.1Q tag to map the VLAN numbers to the appropriate SSIDs. For example, VLAN 10 is mapped to SSID “MyNetwork,” VLAN 20 is mapped to SSID “YourNetwork,” and VLAN 30 to SSID “Guest.”
|
In effect, when an AP uses multiple SSIDs, it is trunking VLANs over the air, and over the same channel, to wireless clients.|In effect, when an AP uses multiple SSIDs, it is trunking VLANs over the air, and over the same channel, to wireless clients.
The clients must use the appropriate SSID that has been mapped to the respective VLAN when the AP was configured.|The clients must use the appropriate SSID that has been mapped to the respective VLAN when the AP was configured.
The AP then appears as multiple logical APs—one per BSS—with a unique BSSID for each.|The AP then appears as multiple logical APs—one per BSS—with a unique BSSID for each.
With Cisco APs, this is usually accomplished by incrementing the last digit of the radio’s MAC address for each SSID.|With Cisco APs, this is usually accomplished by incrementing the last digit of the radio’s MAC address for each SSID.
|
Even though an AP can advertise and support multiple logical wireless networks, each of the SSIDs covers the same geographic area.|Even though an AP can advertise and support multiple logical wireless networks, each of the SSIDs covers the same geographic area.
The reason is that the AP uses the same transmitter, receiver, antennas, and channel for every SSID that it supports.|The reason is that the AP uses the same transmitter, receiver, antennas, and channel for every SSID that it supports.
Beware of one misconception though: multiple SSIDs can give an illusion of scale.|Beware of one misconception though: multiple SSIDs can give an illusion of scale.
Even though wireless clients can be distributed across many SSIDs, all of those clients must share the same AP’s hardware and must contend for airtime on the same channel.|Even though wireless clients can be distributed across many SSIDs, all of those clients must share the same AP’s hardware and must contend for airtime on the same channel.
|
Figure 26-7 Supporting Multiple SSIDs on One AP|Figure 26-7 Supporting Multiple SSIDs on One AP
#### Extended Service Set
Extended Service Set   
__|__
--|--
|
Normally, one AP cannot cover the entire area where clients might be located.|Normally, one AP cannot cover the entire area where clients might be located.
For example, you might need wireless coverage throughout an entire floor of a business, hotel, hospital, or other large building.|For example, you might need wireless coverage throughout an entire floor of a business, hotel, hospital, or other large building.
To cover more area than a single AP’s cell can cover, you simply need to add more APs and spread them out geographically.|To cover more area than a single AP’s cell can cover, you simply need to add more APs and spread them out geographically.
|
When APs are placed at different geographic locations, they can all be interconnected by a switched infrastructure.|When APs are placed at different geographic locations, they can all be interconnected by a switched infrastructure.
The 802.11 standard calls this an extended service set (ESS), as shown in Figure 26-8.|The 802.11 standard calls this an extended service set (ESS), as shown in Figure 26-8.
|
The idea is to make multiple APs cooperate so that the wireless service is consistent and seamless from the client’s perspective.|The idea is to make multiple APs cooperate so that the wireless service is consistent and seamless from the client’s perspective.
Ideally, any SSIDs that are defined on one AP should be defined on all the APs in an ESS; otherwise, it would be very cumbersome and inconvenient for a client to be reconfigured each time it moves into a different AP’s cell.|Ideally, any SSIDs that are defined on one AP should be defined on all the APs in an ESS; otherwise, it would be very cumbersome and inconvenient for a client to be reconfigured each time it moves into a different AP’s cell.
|
Notice that each cell in Figure 26-8 has a unique BSSID, but both cells share one common SSID. Regardless of a client’s location within the ESS, the SSID will remain the same but the client can always distinguish one AP from another.|Notice that each cell in Figure 26-8 has a unique BSSID, but both cells share one common SSID. Regardless of a client’s location within the ESS, the SSID will remain the same but the client can always distinguish one AP from another.
|
In an ESS, a wireless client can associate with one AP while it is physically located near that AP. If the client later moves to a different location, it can associate with a different nearby AP automatically.|In an ESS, a wireless client can associate with one AP while it is physically located near that AP. If the client later moves to a different location, it can associate with a different nearby AP automatically.
Passing from one AP to another is called roaming.|Passing from one AP to another is called roaming.
Keep in mind that each AP offers its own BSS on its own channel, to prevent interference between the APs. As a client device roams from one AP to another, it must scan the available channels to find a new AP (and BSS) to roam toward.|Keep in mind that each AP offers its own BSS on its own channel, to prevent interference between the APs. As a client device roams from one AP to another, it must scan the available channels to find a new AP (and BSS) to roam toward.
In effect, the client is roaming from BSS to BSS, and from channel to channel.|In effect, the client is roaming from BSS to BSS, and from channel to channel.
|
Figure 26-8 Scaling Wireless Coverage with an 802.11 Extended Service Set|Figure 26-8 Scaling Wireless Coverage with an 802.11 Extended Service Set
#### Independent Basic Service Set
Independent Basic Service Set   
__|__
--|--
|
Usually a wireless network leverages APs for organization, control, and scalability.|Usually a wireless network leverages APs for organization, control, and scalability.
|
Sometimes that is not possible or convenient in an impromptu situation.|Sometimes that is not possible or convenient in an impromptu situation.
For example, two people who want to exchange electronic documents at a meeting might not be able to find a BSS available or might want to avoid having to authenticate to a production network.|For example, two people who want to exchange electronic documents at a meeting might not be able to find a BSS available or might want to avoid having to authenticate to a production network.
In addition, many personal printers have the capability to print documents wirelessly, without relying on a regular BSS or AP.|In addition, many personal printers have the capability to print documents wirelessly, without relying on a regular BSS or AP.
|
The 802.11 standard allows two or more wireless clients to communicate directly with each other, with no other means of network connectivity.|The 802.11 standard allows two or more wireless clients to communicate directly with each other, with no other means of network connectivity.
This is known as an ad hoc wireless network, or an independent basic service set (IBSS), as shown in Figure 26-9.|This is known as an ad hoc wireless network, or an independent basic service set (IBSS), as shown in Figure 26-9.
For this to work, one of the devices must take the lead and begin advertising a network name and the necessary radio parameters, much like an AP would do.|For this to work, one of the devices must take the lead and begin advertising a network name and the necessary radio parameters, much like an AP would do.
Any other device can then join as needed.|Any other device can then join as needed.
|
IBSSs are meant to be organized in an impromptu, distributed fashion; therefore, they do not scale well beyond eight to ten devices.|IBSSs are meant to be organized in an impromptu, distributed fashion; therefore, they do not scale well beyond eight to ten devices.
|
IBSS Figure 26-9 802.11 Independent Basic Service Set|IBSS Figure 26-9 802.11 Independent Basic Service Set
### Other Wireless Topologies
Other Wireless Topologies   
__|__
--|--
|
Wireless APs can be configured to operate in noninfrastructure modes when a normal BSS cannot provide the functionality that is needed.|Wireless APs can be configured to operate in noninfrastructure modes when a normal BSS cannot provide the functionality that is needed.
The following sections cover the most common modes.|The following sections cover the most common modes.
#### Repeater
Repeater   
__|__
--|--
|
Normally, each AP in a wireless network has a wired connection back to the DS or switched infrastructure.|Normally, each AP in a wireless network has a wired connection back to the DS or switched infrastructure.
To extend wireless coverage beyond a normal AP’s cell footprint, additional APs and their wired connections can be added.|To extend wireless coverage beyond a normal AP’s cell footprint, additional APs and their wired connections can be added.
In some scenarios, it is not possible to run a wired connection to a new AP because the cable distance is too great to support Ethernet communication.|In some scenarios, it is not possible to run a wired connection to a new AP because the cable distance is too great to support Ethernet communication.
|
In that case, you can add an additional AP that is configured for repeater mode.|In that case, you can add an additional AP that is configured for repeater mode.
A wireless repeater takes the signal it receives and repeats or retransmits it in a new cell area around the repeater.|A wireless repeater takes the signal it receives and repeats or retransmits it in a new cell area around the repeater.
The idea is to move the repeater out away from the AP so that it is still within range of both the AP and the distant client, as shown in Figure 26-10.|The idea is to move the repeater out away from the AP so that it is still within range of both the AP and the distant client, as shown in Figure 26-10.
|
Figure 26-10 Extending the Range of an AP with a Wireless Repeater If the repeater has a single transmitter and receiver, it must operate on the same channel that the AP is using.|Figure 26-10 Extending the Range of an AP with a Wireless Repeater If the repeater has a single transmitter and receiver, it must operate on the same channel that the AP is using.
That can create the possibility that the AP’s signal will be received and retransmitted by the repeater, only to be received again by the AP—halving the effective throughput because the channel will be kept busy twice as long as before.|That can create the possibility that the AP’s signal will be received and retransmitted by the repeater, only to be received again by the AP—halving the effective throughput because the channel will be kept busy twice as long as before.
As a remedy, some repeaters can use two transmitters and receivers to keep the original and repeated signals isolated on different channels.|As a remedy, some repeaters can use two transmitters and receivers to keep the original and repeated signals isolated on different channels.
One transmitter and receiver pair is dedicated to signals in the AP’s cell, while the other pair is dedicated to signals in the repeater’s own cell.|One transmitter and receiver pair is dedicated to signals in the AP’s cell, while the other pair is dedicated to signals in the repeater’s own cell.
#### Workgroup Bridge
Workgroup Bridge   
__|__
--|--
|
Suppose you have a device that supports a wired Ethernet link but is not capable of having a wireless connection.|Suppose you have a device that supports a wired Ethernet link but is not capable of having a wireless connection.
For example, some mobile medical devices might be designed with only a wired connection.|For example, some mobile medical devices might be designed with only a wired connection.
While it is possible to plug the device into an Ethernet connection when needed, a wireless connection would be much more practical.|While it is possible to plug the device into an Ethernet connection when needed, a wireless connection would be much more practical.
You can use a workgroup bridge (WGB) to connect the device’s wired network adapter to a wireless network.|You can use a workgroup bridge (WGB) to connect the device’s wired network adapter to a wireless network.
|
Rather than providing a BSS for wireless service, a WGB becomes a wireless client of a BSS.|Rather than providing a BSS for wireless service, a WGB becomes a wireless client of a BSS.
|
In effect, the WGB acts as an external wireless network adapter for a device that has none.|In effect, the WGB acts as an external wireless network adapter for a device that has none.
|
In Figure 26-11, an AP provides a BSS; Client A is a regular wireless client, while Client B is associated with the AP through a WGB.|In Figure 26-11, an AP provides a BSS; Client A is a regular wireless client, while Client B is associated with the AP through a WGB.
|
Figure 26-11 Nonwireless Device Connecting Through a Workgroup Bridge You might encounter two types of workgroup bridges:|Figure 26-11 Nonwireless Device Connecting Through a Workgroup Bridge You might encounter two types of workgroup bridges:
###### Universal workgroup bridge (uWGB): A single wired device can be bridged to a wireless
Universal workgroup bridge (uWGB): A single wired device can be bridged to a wireless   
__|__
--|--
|
network.|network.
###### Workgroup bridge (WGB): A Cisco-proprietary implementation that allows multiple
Workgroup bridge (WGB): A Cisco-proprietary implementation that allows multiple   
__|__
--|--
|
wired devices to be bridged to a wireless network.|wired devices to be bridged to a wireless network.
#### Outdoor Bridge
Outdoor Bridge   
__|__
--|--
|
An AP can be configured to act as a bridge to form a single wireless link from one LAN to another over a long distance.|An AP can be configured to act as a bridge to form a single wireless link from one LAN to another over a long distance.
Outdoor bridged links are commonly used for connectivity between buildings or between cities.|Outdoor bridged links are commonly used for connectivity between buildings or between cities.
|
If the LANs at two locations need to be bridged, a point-to-point bridged link can be used.|If the LANs at two locations need to be bridged, a point-to-point bridged link can be used.
|
One AP configured in bridge mode is needed on each end of the wireless link.|One AP configured in bridge mode is needed on each end of the wireless link.
Special purpose antennas are normally used with the bridges to focus their signals in one direction—|Special purpose antennas are normally used with the bridges to focus their signals in one direction—
|
toward the antenna of the AP at the far end of the link.|toward the antenna of the AP at the far end of the link.
This maximizes the link distance, as shown in Figure 26-12.|This maximizes the link distance, as shown in Figure 26-12.
|
Figure 26-12 Point-to-Point Outdoor Bridge Sometimes the LANs at multiple sites need to be bridged together.|Figure 26-12 Point-to-Point Outdoor Bridge Sometimes the LANs at multiple sites need to be bridged together.
A point-to-multipoint bridged link allows a central site to be bridged to several other sites.|A point-to-multipoint bridged link allows a central site to be bridged to several other sites.
The central site bridge is connected to an omnidirectional antenna, such that its signal is transmitted equally in all directions so that it can reach the other sites simultaneously.|The central site bridge is connected to an omnidirectional antenna, such that its signal is transmitted equally in all directions so that it can reach the other sites simultaneously.
The bridges at each of the other sites can be connected to a directional antenna aimed at the central site.|The bridges at each of the other sites can be connected to a directional antenna aimed at the central site.
Figure 26-13 shows the point-to-multipoint scenario.|Figure 26-13 shows the point-to-multipoint scenario.
|
Figure 26-13 Point-to-Multipoint Outdoor Bridge|Figure 26-13 Point-to-Multipoint Outdoor Bridge
#### Mesh Network
Mesh Network   
__|__
--|--
|
To provide wireless coverage over a very large area, it is not always practical to run Ethernet cabling to every AP that would be needed.|To provide wireless coverage over a very large area, it is not always practical to run Ethernet cabling to every AP that would be needed.
Instead, you could use multiple APs configured in mesh mode.|Instead, you could use multiple APs configured in mesh mode.
In a mesh topology, wireless traffic is bridged from AP to AP, in a daisy-chain fashion, using another wireless channel.|In a mesh topology, wireless traffic is bridged from AP to AP, in a daisy-chain fashion, using another wireless channel.
|
Mesh APs can leverage dual radios—one using a channel in one range of frequencies and one a different range.|Mesh APs can leverage dual radios—one using a channel in one range of frequencies and one a different range.
Each mesh AP usually maintains a BSS on one channel, with which wireless clients can associate.|Each mesh AP usually maintains a BSS on one channel, with which wireless clients can associate.
Client traffic is then usually bridged from AP to AP over other channels as a backhaul network.|Client traffic is then usually bridged from AP to AP over other channels as a backhaul network.
At the edge of the mesh network, the backhaul traffic is bridged to the wired LAN infrastructure.|At the edge of the mesh network, the backhaul traffic is bridged to the wired LAN infrastructure.
Figure 26-14 shows a typical mesh network.|Figure 26-14 shows a typical mesh network.
With Cisco APs, you can build a mesh network indoors or outdoors.|With Cisco APs, you can build a mesh network indoors or outdoors.
The mesh network runs its own dynamic routing protocol to work out the best path for backhaul traffic to take across the mesh APs.|The mesh network runs its own dynamic routing protocol to work out the best path for backhaul traffic to take across the mesh APs.
|
Figure 26-14 Typical Wireless Mesh Network|Figure 26-14 Typical Wireless Mesh Network
### RF Overview
RF Overview   
__|__
--|--
|
To send data across a wired link, an electrical signal is applied at one end and carried to the other end.|To send data across a wired link, an electrical signal is applied at one end and carried to the other end.
The wire itself is continuous and conductive, so the signal can propagate rather easily.|The wire itself is continuous and conductive, so the signal can propagate rather easily.
A wireless link has no physical strands of anything to carry the signal along.|A wireless link has no physical strands of anything to carry the signal along.
|
How, then, can an electrical signal be sent across the air, or free space?|How, then, can an electrical signal be sent across the air, or free space?
Consider a simple analogy of two people standing far apart.|Consider a simple analogy of two people standing far apart.
One person wants to signal something to the other.|One person wants to signal something to the other.
|
They are connected by a long and somewhat loose rope; the rope represents free space.|They are connected by a long and somewhat loose rope; the rope represents free space.
The sender at one end decides to lift his end of the rope high and hold it there so that the other end of the rope will also rise and notify the partner.|The sender at one end decides to lift his end of the rope high and hold it there so that the other end of the rope will also rise and notify the partner.
After all, if the rope were a wire, he knows that he could apply a steady voltage at one end of the wire and it would appear at the other end.|After all, if the rope were a wire, he knows that he could apply a steady voltage at one end of the wire and it would appear at the other end.
Figure 26-15 shows the end result; the rope falls back down after a tiny distance, and the receiver never notices a change.|Figure 26-15 shows the end result; the rope falls back down after a tiny distance, and the receiver never notices a change.
|
Figure 26-15 Failed Attempt to Pass a Message Down a Rope The sender tries a different strategy.|Figure 26-15 Failed Attempt to Pass a Message Down a Rope The sender tries a different strategy.
He cannot push the rope, but when he begins to wave it up and down in a steady, regular motion, a curious thing happens.|He cannot push the rope, but when he begins to wave it up and down in a steady, regular motion, a curious thing happens.
A continuous wave pattern appears along the entire length of the rope, as shown in Figure 26-16.|A continuous wave pattern appears along the entire length of the rope, as shown in Figure 26-16.
In fact, the waves (each representing one up and down cycle of the sender’s arm) actually travel from the sender to the receiver.|In fact, the waves (each representing one up and down cycle of the sender’s arm) actually travel from the sender to the receiver.
|
Figure 26-16 Sending a Continuous Wave Down a Rope In free space, a similar principle occurs.|Figure 26-16 Sending a Continuous Wave Down a Rope In free space, a similar principle occurs.
The sender (a transmitter) can send an alternating current into a section of wire (an antenna), which sets up moving electric and magnetic fields that propagate out and away as traveling waves.|The sender (a transmitter) can send an alternating current into a section of wire (an antenna), which sets up moving electric and magnetic fields that propagate out and away as traveling waves.
The electric and magnetic fields travel along together and are always at right angles to each other, as shown in Figure 26-17.|The electric and magnetic fields travel along together and are always at right angles to each other, as shown in Figure 26-17.
The signal must keep changing, or alternating, by cycling up and down, to keep the electric and magnetic fields cycling and pushing ever outward.|The signal must keep changing, or alternating, by cycling up and down, to keep the electric and magnetic fields cycling and pushing ever outward.
|
Figure 26-17 Traveling Electric and Magnetic Waves Electromagnetic waves do not travel in a straight line.|Figure 26-17 Traveling Electric and Magnetic Waves Electromagnetic waves do not travel in a straight line.
Instead, they travel by expanding in all directions away from the antenna.|Instead, they travel by expanding in all directions away from the antenna.
To get a visual image, think of dropping a pebble into a pond when the surface is still.|To get a visual image, think of dropping a pebble into a pond when the surface is still.
Where it drops in, the pebble sets the water’s surface into a cyclic motion.|Where it drops in, the pebble sets the water’s surface into a cyclic motion.
The waves that result begin small and expand outward, only to be replaced by new waves.|The waves that result begin small and expand outward, only to be replaced by new waves.
In free space, the electromagnetic waves expand outward in all three dimensions.|In free space, the electromagnetic waves expand outward in all three dimensions.
|
Figure 26-18 shows a simple idealistic antenna that is a single point at the end of a wire.|Figure 26-18 shows a simple idealistic antenna that is a single point at the end of a wire.
The waves produced expand outward in a spherical shape.|The waves produced expand outward in a spherical shape.
The waves will eventually reach the receiver, in addition to many other locations in other directions.|The waves will eventually reach the receiver, in addition to many other locations in other directions.
|
Figure 26-18 Wave Propagation with an Idealistic Antenna At the receiving end of a wireless link, the process is reversed.|Figure 26-18 Wave Propagation with an Idealistic Antenna At the receiving end of a wireless link, the process is reversed.
As the electromagnetic waves reach the receiver’s antenna, they induce an electrical signal.|As the electromagnetic waves reach the receiver’s antenna, they induce an electrical signal.
If everything works right, the received signal will be a reasonable copy of the original transmitted signal.|If everything works right, the received signal will be a reasonable copy of the original transmitted signal.
|
The electromagnetic waves involved in a wireless link can be measured and described in several ways.|The electromagnetic waves involved in a wireless link can be measured and described in several ways.
One fundamental property is the frequency of the wave, or the number of times the signal makes one complete up and down cycle in 1 second.|One fundamental property is the frequency of the wave, or the number of times the signal makes one complete up and down cycle in 1 second.
Figure 26-19 shows how a cycle of a wave can be identified.|Figure 26-19 shows how a cycle of a wave can be identified.
A cycle can begin as the signal rises from the center line, falls through the center line, and rises again to meet the center line.|A cycle can begin as the signal rises from the center line, falls through the center line, and rises again to meet the center line.
A cycle can also be measured from the center of one peak to the center of the next peak.|A cycle can also be measured from the center of one peak to the center of the next peak.
No matter where you start measuring a cycle, the signal must make a complete sequence back to its starting position where it is ready to repeat the same cyclic pattern.|No matter where you start measuring a cycle, the signal must make a complete sequence back to its starting position where it is ready to repeat the same cyclic pattern.
|
Figure 26-19 Cycles Within a Wave In Figure 26-19, suppose that 1 second has elapsed, as shown.|Figure 26-19 Cycles Within a Wave In Figure 26-19, suppose that 1 second has elapsed, as shown.
During that 1 second, the signal progressed through four complete cycles.|During that 1 second, the signal progressed through four complete cycles.
Therefore, its frequency is 4 cycles/second or 4 hertz.|Therefore, its frequency is 4 cycles/second or 4 hertz.
A hertz (Hz) is the most commonly used frequency unit and is nothing other than one cycle per second.|A hertz (Hz) is the most commonly used frequency unit and is nothing other than one cycle per second.
|
Frequency can vary over a very wide range.|Frequency can vary over a very wide range.
As frequency increases by orders of magnitude, the numbers can become quite large.|As frequency increases by orders of magnitude, the numbers can become quite large.
To keep things simple, the frequency unit name can be modified to denote an increasing number of zeros, as listed in Table 26-2.|To keep things simple, the frequency unit name can be modified to denote an increasing number of zeros, as listed in Table 26-2.
|
Table 26-2 Frequency Unit Names Table end.|Table 26-2 Frequency Unit Names Table end.
|
Figure 26-20 shows a simple representation of the continuous frequency spectrum ranging from 0 Hz to 1022 (or 1 followed by 22 zeros) Hz. At the low end of the spectrum are frequencies that are too low to be heard by the human ear, followed by audible sounds.|Figure 26-20 shows a simple representation of the continuous frequency spectrum ranging from 0 Hz to 1022 (or 1 followed by 22 zeros) Hz. At the low end of the spectrum are frequencies that are too low to be heard by the human ear, followed by audible sounds.
The highest range of frequencies contains light, followed by X, gamma, and cosmic rays.|The highest range of frequencies contains light, followed by X, gamma, and cosmic rays.
|
Figure 26-20 Continuous Frequency Spectrum The frequency range from around 3 kHz to 300 GHz is commonly called radio frequency (RF). It includes many different types of radio communication, including low-frequency radio, AM radio, shortwave radio, television, FM radio, microwave, and radar.|Figure 26-20 Continuous Frequency Spectrum The frequency range from around 3 kHz to 300 GHz is commonly called radio frequency (RF). It includes many different types of radio communication, including low-frequency radio, AM radio, shortwave radio, television, FM radio, microwave, and radar.
The microwave category also contains the two main frequency ranges that are used for wireless LAN communication: 2.4 and 5 GHz.|The microwave category also contains the two main frequency ranges that are used for wireless LAN communication: 2.4 and 5 GHz.
#### Wireless Bands and Channels
Wireless Bands and Channels   
__|__
--|--
|
Because a range of frequencies might be used for the same purpose, it is customary to refer to the range as a band of frequencies.|Because a range of frequencies might be used for the same purpose, it is customary to refer to the range as a band of frequencies.
For example, the range from 530 kHz to around 1710 kHz is used by AM radio stations; therefore, it is commonly called the AM band or the AM broadcast band.|For example, the range from 530 kHz to around 1710 kHz is used by AM radio stations; therefore, it is commonly called the AM band or the AM broadcast band.
|
One of the two main frequency ranges used for wireless LAN communication lies between|One of the two main frequency ranges used for wireless LAN communication lies between
###### 2.400 and 2.4835 GHz. This is usually called the 2.4-GHz band, even though it does not
2.400 and 2.4835 GHz. This is usually called the 2.4-GHz band, even though it does not   
__|__
--|--
|
encompass the entire range between 2.4 and 2.5 GHz. It is much more convenient to refer to the band name instead of the specific range of frequencies included.|encompass the entire range between 2.4 and 2.5 GHz. It is much more convenient to refer to the band name instead of the specific range of frequencies included.
|
The other wireless LAN range is usually called the 5-GHz band because it lies between|The other wireless LAN range is usually called the 5-GHz band because it lies between
###### 5.150 and 5.825 GHz. The 5-GHz band actually contains the following four separate and distinct
5.150 and 5.825 GHz. The 5-GHz band actually contains the following four separate and distinct   
__|__
--|--
|
bands:|bands:
###### 5.150 to 5.250 GHz
5.150 to 5.250 GHz   
###### 5.250 to 5.350 GHz
5.250 to 5.350 GHz   
###### 5.470 to 5.725 GHz
5.470 to 5.725 GHz   
###### 5.725 to 5.825 GHz
5.725 to 5.825 GHz   
__|__
--|--
|
TIP You might have noticed that most of the 5-GHz bands are contiguous except for a gap between 5.350 and 5.470.|TIP You might have noticed that most of the 5-GHz bands are contiguous except for a gap between 5.350 and 5.470.
At the time of this writing, this gap exists and cannot be used for wireless LANs. However, some governmental agencies have moved to reclaim the frequencies and repurpose them for wireless LANs. Efforts are also underway to add 5.825 through|At the time of this writing, this gap exists and cannot be used for wireless LANs. However, some governmental agencies have moved to reclaim the frequencies and repurpose them for wireless LANs. Efforts are also underway to add 5.825 through
###### 5.925 GHz.
5.925 GHz.   
__|__
--|--
|
It is interesting that the 5-GHz band can contain several smaller bands.|It is interesting that the 5-GHz band can contain several smaller bands.
Remember that the term band is simply a relative term that is used for convenience.|Remember that the term band is simply a relative term that is used for convenience.
Do not worry about memorizing the band names or exact frequency ranges; just be aware of the two main bands at 2.4 and 5 GHz.|Do not worry about memorizing the band names or exact frequency ranges; just be aware of the two main bands at 2.4 and 5 GHz.
|
A frequency band contains a continuous range of frequencies.|A frequency band contains a continuous range of frequencies.
If two devices require a single frequency for a wireless link between them, which frequency can they use?|If two devices require a single frequency for a wireless link between them, which frequency can they use?
Beyond that, how many unique frequencies can be used within a band?|Beyond that, how many unique frequencies can be used within a band?
To keep everything orderly and compatible, bands are usually divided into a number of distinct channels.|To keep everything orderly and compatible, bands are usually divided into a number of distinct channels.
Each channel is known by a channel number and is assigned to a specific frequency.|Each channel is known by a channel number and is assigned to a specific frequency.
As long as the channels are defined by a national or international standards body, they can be used consistently in all locations.|As long as the channels are defined by a national or international standards body, they can be used consistently in all locations.
Figures 26-21 and 26-22 show the channel layout for the 2.4 and 5 GHz bands, respectively.|Figures 26-21 and 26-22 show the channel layout for the 2.4 and 5 GHz bands, respectively.
|
Figure 26-21 Channel Layout in the 2.4-GHz Band Figure 26-22 Channel Layout in the 5-GHz Band You might assume that an AP can use any channel number without affecting any APs that use other channel numbers.|Figure 26-21 Channel Layout in the 2.4-GHz Band Figure 26-22 Channel Layout in the 5-GHz Band You might assume that an AP can use any channel number without affecting any APs that use other channel numbers.
In the 5-GHz band, this is the case because each channel is allocated a frequency range that does not encroach on or overlap the frequencies allocated for any other channel.|In the 5-GHz band, this is the case because each channel is allocated a frequency range that does not encroach on or overlap the frequencies allocated for any other channel.
In other words, the 5-GHz band consists of nonoverlapping channels.|In other words, the 5-GHz band consists of nonoverlapping channels.
|
The same is not true of the 2.4-GHz band.|The same is not true of the 2.4-GHz band.
Each of its channels is much too wide to avoid overlapping the next lower or upper channel number.|Each of its channels is much too wide to avoid overlapping the next lower or upper channel number.
In fact, each channel covers the frequency range that is allocated to more than four consecutive channels!|In fact, each channel covers the frequency range that is allocated to more than four consecutive channels!
Notice the width of the channel spacing in Figure 26-21 as compared to the width of one of the shaded signals centered on channels 1, 6, and 11.|Notice the width of the channel spacing in Figure 26-21 as compared to the width of one of the shaded signals centered on channels 1, 6, and 11.
The only way to avoid any overlap between adjacent channels is to configure APs to use only channels 1, 6, and 11.|The only way to avoid any overlap between adjacent channels is to configure APs to use only channels 1, 6, and 11.
Even though there are 14 channels available to use, you should always strive for nonoverlapping channels in your network.|Even though there are 14 channels available to use, you should always strive for nonoverlapping channels in your network.
#### APs and Wireless Standards
APs and Wireless Standards   
__|__
--|--
|
It might be obvious that wireless devices and APs should all be capable of operating on the same band.|It might be obvious that wireless devices and APs should all be capable of operating on the same band.
For example, a 5-GHz wireless phone can communicate only with an AP that offers Wi-Fi service on 5-GHz channels.|For example, a 5-GHz wireless phone can communicate only with an AP that offers Wi-Fi service on 5-GHz channels.
In addition, the devices and APs must also share a compatibility with the parts of the 802.11 standard they support.|In addition, the devices and APs must also share a compatibility with the parts of the 802.11 standard they support.
|
As the IEEE 802.11 Wi-Fi standard evolves and develops, new amendments with new functionality get proposed.|As the IEEE 802.11 Wi-Fi standard evolves and develops, new amendments with new functionality get proposed.
These amendments are known by “802.11” followed by a one- or two-letter suffix until they are accepted and rolled up into the next generation of the complete 802.11 standard.|These amendments are known by “802.11” followed by a one- or two-letter suffix until they are accepted and rolled up into the next generation of the complete 802.11 standard.
Even then, it is common to see the amendment suffixes still used to distinguish specific functions.|Even then, it is common to see the amendment suffixes still used to distinguish specific functions.
|
You should be aware of several amendments that define important characteristics such as data rates, methods used to transmit and receive data, and so on.|You should be aware of several amendments that define important characteristics such as data rates, methods used to transmit and receive data, and so on.
For the CCNA 200-301 exam, you should know which band each of the amendments listed in Table 26-3 uses.|For the CCNA 200-301 exam, you should know which band each of the amendments listed in Table 26-3 uses.
The ENCOR 300-401 exam goes further into the data rates and modulation and coding schemes used by each.|The ENCOR 300-401 exam goes further into the data rates and modulation and coding schemes used by each.
|
Table 26-3 Basic Characteristics of Some IEEE 802.11 Amendments Table end.|Table 26-3 Basic Characteristics of Some IEEE 802.11 Amendments Table end.
|
The 802.11 amendments are not mutually exclusive.|The 802.11 amendments are not mutually exclusive.
Wireless client devices and APs can be compatible with one or more amendments; however, a client and an AP can communicate only if they both support and agree to use the same amendment.|Wireless client devices and APs can be compatible with one or more amendments; however, a client and an AP can communicate only if they both support and agree to use the same amendment.
When you look at the specifications for a wireless device, you may find supported amendments listed in a single string, separated by slashes.|When you look at the specifications for a wireless device, you may find supported amendments listed in a single string, separated by slashes.
For example, a device that supports 802.11b/g will support both 802.11b and 802.11g.|For example, a device that supports 802.11b/g will support both 802.11b and 802.11g.
One that supports b/g/a/n/ac will support 802.11b, 802.11g, 802.11n, and 802.11ac.|One that supports b/g/a/n/ac will support 802.11b, 802.11g, 802.11n, and 802.11ac.
You should become familiar with Table 26-3 so that you can know which bands a device can use based on its 802.11 amendment support.|You should become familiar with Table 26-3 so that you can know which bands a device can use based on its 802.11 amendment support.
|
If a device can operate on both bands, how does it decide which band to use?|If a device can operate on both bands, how does it decide which band to use?
APs can usually operate on both bands simultaneously to support any clients that might be present on each band.|APs can usually operate on both bands simultaneously to support any clients that might be present on each band.
However, wireless clients typically associate with an AP on one band at a time, while scanning for potential APs on both bands.|However, wireless clients typically associate with an AP on one band at a time, while scanning for potential APs on both bands.
The band used to connect to an AP is chosen according to the operating system, wireless adapter driver, and other internal configuration.|The band used to connect to an AP is chosen according to the operating system, wireless adapter driver, and other internal configuration.
|
A wireless client can initiate an association with an AP on one band and then switch to the other band if the signal conditions are better there.|A wireless client can initiate an association with an AP on one band and then switch to the other band if the signal conditions are better there.
|
NOTE Cisco APs have dual radios (sets of transmitters and receivers) to support BSSs on one 2.4-GHz channel and other BSSs on one 5-GHz channel simultaneously.|NOTE Cisco APs have dual radios (sets of transmitters and receivers) to support BSSs on one 2.4-GHz channel and other BSSs on one 5-GHz channel simultaneously.
Some models also have two 5-GHz radios that can be configured to operate BSSs on two different channels at the same time, providing wireless coverage to higher densities of users that are located in the same vicinity.|Some models also have two 5-GHz radios that can be configured to operate BSSs on two different channels at the same time, providing wireless coverage to higher densities of users that are located in the same vicinity.
|
You can configure a Cisco AP to operate on a specific channel number.|You can configure a Cisco AP to operate on a specific channel number.
As the number of APs grows, manual channel assignment can become a difficult task.|As the number of APs grows, manual channel assignment can become a difficult task.
Fortunately, Cisco wireless architectures can automatically and dynamically assign each AP to an appropriate channel.|Fortunately, Cisco wireless architectures can automatically and dynamically assign each AP to an appropriate channel.
|
The architecture is covered in Chapter 27, “Analyzing Cisco Wireless Architectures,”|The architecture is covered in Chapter 27, “Analyzing Cisco Wireless Architectures,”
|
while dynamic channel assignment is covered on the ENCOR 300-401 exam.|while dynamic channel assignment is covered on the ENCOR 300-401 exam.
|
In open space, RF signals propagate or reach further on the 2.4-GHz band than on the 5-GHz band.|In open space, RF signals propagate or reach further on the 2.4-GHz band than on the 5-GHz band.
They also tend to penetrate indoor walls and objects easier at 2.4 GHz than 5 GHz.|They also tend to penetrate indoor walls and objects easier at 2.4 GHz than 5 GHz.
|
However, the 2.4-GHz band is commonly more crowded with wireless devices.|However, the 2.4-GHz band is commonly more crowded with wireless devices.
Remember that only three nonoverlapping channels are available, so the chances of other neighboring APs using the same channels is greater.|Remember that only three nonoverlapping channels are available, so the chances of other neighboring APs using the same channels is greater.
In contrast, the 5-GHz band has many more channels available to use, making channels less crowded and experiencing less interference.|In contrast, the 5-GHz band has many more channels available to use, making channels less crowded and experiencing less interference.
### Chapter Review
Chapter Review   
__|__
--|--
|
Review this chapter’s material using either the tools in the book or the interactive tools for the same material found on the book’s companion website.|Review this chapter’s material using either the tools in the book or the interactive tools for the same material found on the book’s companion website.
Table 26-4 outlines the key review elements and where you can find them.|Table 26-4 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 26-4 Chapter Review Tracking Table end.|Table 26-4 Chapter Review Tracking Table end.
|
Review All the Key Topics Key Terms You Should Know access point (AP), ad hoc network, Band, basic service set (BSS), Basic Service Set Identifier (BSSID), channel, cell, distribution system (DS), extended service set (ESS), independent basic service set (IBSS), infrastructure mode, mesh network, nonoverlapping channels, pointto-|Review All the Key Topics Key Terms You Should Know access point (AP), ad hoc network, Band, basic service set (BSS), Basic Service Set Identifier (BSSID), channel, cell, distribution system (DS), extended service set (ESS), independent basic service set (IBSS), infrastructure mode, mesh network, nonoverlapping channels, pointto-
|
point bridge, repeater, roaming, Service Set Identifier (SSID), station (STA), workgroup bridge (WGB)|point bridge, repeater, roaming, Service Set Identifier (SSID), station (STA), workgroup bridge (WGB)
## Chapter 27 Analyzing Cisco Wireless Architectures
Chapter 27 Analyzing Cisco Wireless Architectures   
__|__
--|--
|
Architectures This chapter covers the following exam topics:|Architectures This chapter covers the following exam topics:
###### 2.0 Network Access
2.0 Network Access   
###### 2.6 Compare Cisco Wireless Architectures and AP modes
2.6 Compare Cisco Wireless Architectures and AP modes   
__|__
--|--
|
In Chapter 26, “Fundamentals of Wireless Networks,” you learned about how a single access point (AP) can provide a basic service set (BSS) for a cell area and how multiple APs can be connected to form an extended service set (ESS) for a larger network.|In Chapter 26, “Fundamentals of Wireless Networks,” you learned about how a single access point (AP) can provide a basic service set (BSS) for a cell area and how multiple APs can be connected to form an extended service set (ESS) for a larger network.
In this chapter, you learn more about different approaches or architectures that allow APs to be networked together for an enterprise.|In this chapter, you learn more about different approaches or architectures that allow APs to be networked together for an enterprise.
You also learn how some architectures are more scalable than others and how to manage each type of wireless network architecture.|You also learn how some architectures are more scalable than others and how to manage each type of wireless network architecture.
|
As you work through this chapter, think about how each architecture can be applied to specific environments—how easy it would be to manage, deploy, and troubleshoot the network, how the APs can be controlled, and how data would move through the network.|As you work through this chapter, think about how each architecture can be applied to specific environments—how easy it would be to manage, deploy, and troubleshoot the network, how the APs can be controlled, and how data would move through the network.
### “Do I Know This Already?” Quiz
“Do I Know This Already?” Quiz   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.
The letter answers are listed at the bottom of the page following the quiz.|The letter answers are listed at the bottom of the page following the quiz.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.
You can also find both answers and explanations in the PTP testing software.|You can also find both answers and explanations in the PTP testing software.
|
Table 27-1 ”Do I Know This Already?” Section-to-Question Mapping|Table 27-1 ”Do I Know This Already?” Section-to-Question Mapping
### Foundation Topics
Foundation Topics   
### Autonomous AP Architecture
Autonomous AP Architecture   
### Cloud-based AP Architecture
Cloud-based AP Architecture   
### Split-MAC Architectures
Split-MAC Architectures   
### Comparing Wireless LAN Controller Deployments
Comparing Wireless LAN Controller Deployments   
#### Cisco AP Modes
Cisco AP Modes   
__|__
--|--
|
1. Which one of the following terms best describes a Cisco wireless access point that operates in a standalone, independent manner?|1. Which one of the following terms best describes a Cisco wireless access point that operates in a standalone, independent manner?
|
a. Autonomous AP b.|a. Autonomous AP b.
Independent AP c.|Independent AP c.
Lightweight AP d.|Lightweight AP d.
Embedded AP CHAPTER 27 2.|Embedded AP CHAPTER 27 2.
The Cisco Meraki cloud-based APs are most accurately described by which one of the following statements?|The Cisco Meraki cloud-based APs are most accurately described by which one of the following statements?
|
a. Autonomous APs joined to a WLC b.|a. Autonomous APs joined to a WLC b.
Autonomous APs centrally managed c.|Autonomous APs centrally managed c.
Lightweight APs joined to a WLC d.|Lightweight APs joined to a WLC d.
Lightweight APs centrally managed 3.|Lightweight APs centrally managed 3.
A lightweight access point is said to participate in which one of the following architectures?|A lightweight access point is said to participate in which one of the following architectures?
|
a. Light-MAC b.|a. Light-MAC b.
Tunnel-MAC c.|Tunnel-MAC c.
Split-MAC d.|Split-MAC d.
Big-MAC 4.|Big-MAC 4.
How does a lightweight access point communicate with a wireless LAN controller?|How does a lightweight access point communicate with a wireless LAN controller?
|
a. Through an IPsec tunnel b.|a. Through an IPsec tunnel b.
Through a CAPWAP tunnel c.|Through a CAPWAP tunnel c.
Through a GRE tunnel d.|Through a GRE tunnel d.
Directly over Layer 2 5.|Directly over Layer 2 5.
Which one of the following is not needed for a lightweight AP in default local mode to be able to support three SSIDs that are bound to three VLANs?|Which one of the following is not needed for a lightweight AP in default local mode to be able to support three SSIDs that are bound to three VLANs?
|
a. A trunk link carrying three VLANs b.|a. A trunk link carrying three VLANs b.
An access link bound to a single VLAN c.|An access link bound to a single VLAN c.
A WLC connected to three VLANs d.|A WLC connected to three VLANs d.
A CAPWAP tunnel to a WLC 6.|A CAPWAP tunnel to a WLC 6.
Which one of the following WLC deployment models would be best for a large enterprise with around 3000 lightweight APs?|Which one of the following WLC deployment models would be best for a large enterprise with around 3000 lightweight APs?
|
a. Cisco Mobility Express b.|a. Cisco Mobility Express b.
Embedded c.|Embedded c.
Unified d.|Unified d.
Cloud-based 7.|Cloud-based 7.
If a lightweight AP provides at least one BSS for wireless clients, which one of the following modes does it use?|If a lightweight AP provides at least one BSS for wireless clients, which one of the following modes does it use?
|
a. Local b.|a. Local b.
Normal c.|Normal c.
Monitor d.|Monitor d.
Client 8.|Client 8.
Regarding lightweight AP modes, which one of the following is true?|Regarding lightweight AP modes, which one of the following is true?
|
a. An AP can operate in multiple modes at the same time.|a. An AP can operate in multiple modes at the same time.
|
b. An AP only has one possible mode of operation.|b. An AP only has one possible mode of operation.
|
c. The Run mode is the default mode.|c. The Run mode is the default mode.
|
d. The SE-Connect mode is used for spectrum analysis.|d. The SE-Connect mode is used for spectrum analysis.
|
Foundation Topics Autonomous AP Architecture An access point’s primary function is to bridge wireless data from the air to a normal wired network.|Foundation Topics Autonomous AP Architecture An access point’s primary function is to bridge wireless data from the air to a normal wired network.
An AP can accept “connections” from a number of wireless clients so that they become members of the LAN, as if the same clients were using wired connections.|An AP can accept “connections” from a number of wireless clients so that they become members of the LAN, as if the same clients were using wired connections.
|
APs act as the central point of access (hence the AP name), controlling client access to the wireless LAN. An autonomous AP is self-contained; it is equipped with both wired and wireless hardware so that the wireless client associations can be terminated onto a wired connection locally at the AP. The APs and their data connections must be distributed across the coverage area and across the network.|APs act as the central point of access (hence the AP name), controlling client access to the wireless LAN. An autonomous AP is self-contained; it is equipped with both wired and wireless hardware so that the wireless client associations can be terminated onto a wired connection locally at the AP. The APs and their data connections must be distributed across the coverage area and across the network.
|
Autonomous APs offer one or more fully functional, standalone basic service sets (BSSs).|Autonomous APs offer one or more fully functional, standalone basic service sets (BSSs).
|
They are also a natural extension of a switched network, connecting wireless service set identifiers (SSIDs) to wired virtual LANs (VLANs) at the access layer.|They are also a natural extension of a switched network, connecting wireless service set identifiers (SSIDs) to wired virtual LANs (VLANs) at the access layer.
Figure 27-1 shows the basic architecture; even though only four APs are shown across the bottom, a typical enterprise network could consist of hundreds or thousands of APs.|Figure 27-1 shows the basic architecture; even though only four APs are shown across the bottom, a typical enterprise network could consist of hundreds or thousands of APs.
|
Figure 27-1 Wireless Network Architecture with Autonomous APs 27 What exactly does an autonomous AP need to become a part of the network?|Figure 27-1 Wireless Network Architecture with Autonomous APs 27 What exactly does an autonomous AP need to become a part of the network?
The wireless network in Figure 27-1 consists of two SSIDs: wlan100 and wlan200.|The wireless network in Figure 27-1 consists of two SSIDs: wlan100 and wlan200.
These correspond to wired VLANs 100 and 200, respectively.|These correspond to wired VLANs 100 and 200, respectively.
As shown by the shaded links, the VLANs must be trunked from the distribution layer switch (where routing commonly takes place) to the access layer, where they are extended further over a trunk link to the AP.|As shown by the shaded links, the VLANs must be trunked from the distribution layer switch (where routing commonly takes place) to the access layer, where they are extended further over a trunk link to the AP.
|
An autonomous AP offers a short and simple path for data to travel between the wireless and wired networks.|An autonomous AP offers a short and simple path for data to travel between the wireless and wired networks.
Data has to travel only through the AP to reach the network on the other side.|Data has to travel only through the AP to reach the network on the other side.
Two wireless users that are associated to the same autonomous AP can reach each other through the AP without having to pass up into the wired network.|Two wireless users that are associated to the same autonomous AP can reach each other through the AP without having to pass up into the wired network.
As you work through the wireless architectures discussed in the rest of the chapter, notice the data path that is required for each.|As you work through the wireless architectures discussed in the rest of the chapter, notice the data path that is required for each.
|
An autonomous AP must also be configured with a management IP address (10.10.10.10 in Figure 27-1) so that you can remotely manage it.|An autonomous AP must also be configured with a management IP address (10.10.10.10 in Figure 27-1) so that you can remotely manage it.
After all, you will want to configure SSIDs, VLANs, and many RF parameters like the channel and transmit power to be used.|After all, you will want to configure SSIDs, VLANs, and many RF parameters like the channel and transmit power to be used.
The management address is not normally part of any of the data VLANs, so a dedicated management VLAN (i.e., VLAN 10) must be added to the trunk links to reach the AP. Each AP must be configured and maintained individually unless you leverage a management platform such as Cisco Prime Infrastructure or Cisco DNA Center.|The management address is not normally part of any of the data VLANs, so a dedicated management VLAN (i.e., VLAN 10) must be added to the trunk links to reach the AP. Each AP must be configured and maintained individually unless you leverage a management platform such as Cisco Prime Infrastructure or Cisco DNA Center.
|
Because the data and management VLANs may need to reach every autonomous AP, the network configuration and efficiency can become cumbersome as the network scales.|Because the data and management VLANs may need to reach every autonomous AP, the network configuration and efficiency can become cumbersome as the network scales.
For example, you will likely want to offer the same SSID on many APs so that wireless clients can associate with that SSID in most any location or while roaming between any two APs.|For example, you will likely want to offer the same SSID on many APs so that wireless clients can associate with that SSID in most any location or while roaming between any two APs.
|
You might also want to extend the corresponding VLAN (and IP subnet) to each and every AP so that clients do not have to request a new IP address for each new association.|You might also want to extend the corresponding VLAN (and IP subnet) to each and every AP so that clients do not have to request a new IP address for each new association.
|
Because SSIDs and their VLANs must be extended at Layer 2, you should consider how they are extended throughout the switched network.|Because SSIDs and their VLANs must be extended at Layer 2, you should consider how they are extended throughout the switched network.
The shaded links in Figure 27-2 show an example of a single VLAN’s extent in the data plane.|The shaded links in Figure 27-2 show an example of a single VLAN’s extent in the data plane.
Working top to bottom, follow VLAN 100 as it reaches through the network.|Working top to bottom, follow VLAN 100 as it reaches through the network.
VLAN 100 is routed within the distribution layer and must be carried over trunk links to the access layer switches and then to each autonomous AP. In effect, VLAN 100 must extend end to end across the whole infrastructure—something that is usually considered to be a bad practice.|VLAN 100 is routed within the distribution layer and must be carried over trunk links to the access layer switches and then to each autonomous AP. In effect, VLAN 100 must extend end to end across the whole infrastructure—something that is usually considered to be a bad practice.
|
That might sound straightforward until you have to add a new VLAN and configure every switch and AP in your network to carry and support it.|That might sound straightforward until you have to add a new VLAN and configure every switch and AP in your network to carry and support it.
Even worse, suppose your network has redundant links between each layer of switches.|Even worse, suppose your network has redundant links between each layer of switches.
The Spanning Tree Protocol (STP) running on each switch becomes a vital ingredient to prevent bridging loops from forming and corrupting the network.|The Spanning Tree Protocol (STP) running on each switch becomes a vital ingredient to prevent bridging loops from forming and corrupting the network.
For these reasons, client roaming across autonomous APs is typically limited to the Layer 2 domain, or the extent of a single VLAN. As the wireless network expands, the infrastructure becomes more difficult to configure correctly and becomes less efficient.|For these reasons, client roaming across autonomous APs is typically limited to the Layer 2 domain, or the extent of a single VLAN. As the wireless network expands, the infrastructure becomes more difficult to configure correctly and becomes less efficient.
|
Figure 27-2 Extent of a Data VLAN in a Network of Autonomous APs Cloud-based AP Architecture Recall that an autonomous AP needs quite a bit of configuration and management.|Figure 27-2 Extent of a Data VLAN in a Network of Autonomous APs Cloud-based AP Architecture Recall that an autonomous AP needs quite a bit of configuration and management.
To help manage more and more autonomous APs as the wireless network grows, you could place an AP management platform such as Cisco Prime Infrastructure in a central location within the enterprise.|To help manage more and more autonomous APs as the wireless network grows, you could place an AP management platform such as Cisco Prime Infrastructure in a central location within the enterprise.
The management platform would need to be purchased, configured, and maintained too.|The management platform would need to be purchased, configured, and maintained too.
|
A simpler approach is a cloud-based AP architecture, where the AP management function is pushed out of the enterprise and into the Internet cloud.|A simpler approach is a cloud-based AP architecture, where the AP management function is pushed out of the enterprise and into the Internet cloud.
Cisco Meraki is cloud-based and offers centralized management of wireless, switched, and security networks built from Meraki products.|Cisco Meraki is cloud-based and offers centralized management of wireless, switched, and security networks built from Meraki products.
For example, through the cloud networking service, you can configure and manage APs, monitor wireless performance and activity, generate reports, and so on.|For example, through the cloud networking service, you can configure and manage APs, monitor wireless performance and activity, generate reports, and so on.
|
Cisco Meraki APs can be deployed automatically, once you register with the Meraki cloud.|Cisco Meraki APs can be deployed automatically, once you register with the Meraki cloud.
|
Each AP will contact the cloud when it powers up and will self-configure.|Each AP will contact the cloud when it powers up and will self-configure.
From that point on, you can manage the AP through the Meraki cloud dashboard.|From that point on, you can manage the AP through the Meraki cloud dashboard.
|
Figure 27-3 illustrates the basic cloud-based architecture.|Figure 27-3 illustrates the basic cloud-based architecture.
Notice that the network is arranged identically to that of the autonomous AP network.|Notice that the network is arranged identically to that of the autonomous AP network.
The reason is that the APs in a cloud-based network are all autonomous, too.|The reason is that the APs in a cloud-based network are all autonomous, too.
The most visible difference is that all of the APs are managed, controlled, and monitored centrally from the cloud.|The most visible difference is that all of the APs are managed, controlled, and monitored centrally from the cloud.
|
Figure 27-3 Cisco Meraki Cloud-Based Wireless Network Architecture From the cloud, you can push out code upgrades and configuration changes to the APs in the enterprise.|Figure 27-3 Cisco Meraki Cloud-Based Wireless Network Architecture From the cloud, you can push out code upgrades and configuration changes to the APs in the enterprise.
The Cisco Meraki cloud also adds the intelligence needed to automatically instruct each AP on which channel and transmit power level to use.|The Cisco Meraki cloud also adds the intelligence needed to automatically instruct each AP on which channel and transmit power level to use.
It can also collect information from all of the APs about things such as RF interference, rogue or unexpected wireless devices that were overheard, and wireless usage statistics.|It can also collect information from all of the APs about things such as RF interference, rogue or unexpected wireless devices that were overheard, and wireless usage statistics.
|
Finally, there are a couple of things you should observe about the cloud-based architecture.|Finally, there are a couple of things you should observe about the cloud-based architecture.
|
The data path from the wireless network to the wired network is very short; the autonomous AP links the two networks.|The data path from the wireless network to the wired network is very short; the autonomous AP links the two networks.
Data to and from wireless clients does not have to travel up into the cloud and back; the cloud is used to bring management functions into the data plane.|Data to and from wireless clients does not have to travel up into the cloud and back; the cloud is used to bring management functions into the data plane.
|
Also, notice that the network in Figure 27-3 consists of two distinct paths—one for data traffic and another for management traffic, corresponding to the following two functions:|Also, notice that the network in Figure 27-3 consists of two distinct paths—one for data traffic and another for management traffic, corresponding to the following two functions:
###### A control plane: Traffic used to control, configure, manage, and monitor the AP itself
A control plane: Traffic used to control, configure, manage, and monitor the AP itself   
###### A data plane: End-user traffic passing through the AP
A data plane: End-user traffic passing through the AP   
__|__
--|--
|
This division will become important in the following sections as other types of architecture are discussed.|This division will become important in the following sections as other types of architecture are discussed.
|
Split-MAC Architectures Because autonomous APs are…well, autonomous, managing their RF operation can be quite difficult.|Split-MAC Architectures Because autonomous APs are…well, autonomous, managing their RF operation can be quite difficult.
As a network administrator, you are in charge of selecting and configuring the channel used by each AP and detecting and dealing with any rogue APs that might be interfering.|As a network administrator, you are in charge of selecting and configuring the channel used by each AP and detecting and dealing with any rogue APs that might be interfering.
|
You must also manage things such as the transmit power level to make sure that the wireless coverage is sufficient, it does not overlap too much, and there aren’t any coverage holes—even when an AP’s radio fails.|You must also manage things such as the transmit power level to make sure that the wireless coverage is sufficient, it does not overlap too much, and there aren’t any coverage holes—even when an AP’s radio fails.
|
Managing wireless network security can also be difficult.|Managing wireless network security can also be difficult.
Each autonomous AP handles its own security policies, with no central point of entry between the wireless and wired networks.|Each autonomous AP handles its own security policies, with no central point of entry between the wireless and wired networks.
|
That means there is no convenient place to monitor traffic for things such as intrusion detection and prevention, quality of service, bandwidth policing, and so on.|That means there is no convenient place to monitor traffic for things such as intrusion detection and prevention, quality of service, bandwidth policing, and so on.
|
To overcome the limitations of distributed autonomous APs, many of the functions found within autonomous APs have to be shifted toward some central location.|To overcome the limitations of distributed autonomous APs, many of the functions found within autonomous APs have to be shifted toward some central location.
In Figure 27-4, most of the activities performed by an autonomous AP on the left are broken up into two groups—management functions on the top and real-time processes on the bottom.|In Figure 27-4, most of the activities performed by an autonomous AP on the left are broken up into two groups—management functions on the top and real-time processes on the bottom.
|
Figure 27-4 Autonomous Versus Lightweight Access Point The real-time processes involve sending and receiving 802.11 frames, beacons, and probe messages. 802.11 data encryption is also handled in real time, on a per-packet basis.|Figure 27-4 Autonomous Versus Lightweight Access Point The real-time processes involve sending and receiving 802.11 frames, beacons, and probe messages. 802.11 data encryption is also handled in real time, on a per-packet basis.
The AP must interact with wireless clients on some low level, known as the Media Access Control (MAC) layer.|The AP must interact with wireless clients on some low level, known as the Media Access Control (MAC) layer.
These functions must stay with the AP hardware, closest to the clients.|These functions must stay with the AP hardware, closest to the clients.
|
The management functions are not integral to handling frames over the RF channels, but are things that should be centrally administered.|The management functions are not integral to handling frames over the RF channels, but are things that should be centrally administered.
Therefore, those functions can be moved to a centrally located platform away from the AP.|Therefore, those functions can be moved to a centrally located platform away from the AP.
|
27 When the functions of an autonomous AP are divided, the AP hardware is known as a lightweight access point, and performs only the real-time 802.11 operation.|27 When the functions of an autonomous AP are divided, the AP hardware is known as a lightweight access point, and performs only the real-time 802.11 operation.
The lightweight AP gets its name because the code image and the local intelligence are stripped down, or lightweight, compared to the traditional autonomous AP.|The lightweight AP gets its name because the code image and the local intelligence are stripped down, or lightweight, compared to the traditional autonomous AP.
|
The management functions are usually performed on a wireless LAN controller (WLC), which controls many lightweight APs. This is shown in the bottom right portion of Figure 27-4.|The management functions are usually performed on a wireless LAN controller (WLC), which controls many lightweight APs. This is shown in the bottom right portion of Figure 27-4.
Notice that the AP is left with duties in Layers 1 and 2, where frames are moved into and out of the RF domain.|Notice that the AP is left with duties in Layers 1 and 2, where frames are moved into and out of the RF domain.
The AP becomes totally dependent on the WLC for every other WLAN function, such as authenticating users, managing security policies, and even selecting RF channels and output power.|The AP becomes totally dependent on the WLC for every other WLAN function, such as authenticating users, managing security policies, and even selecting RF channels and output power.
|
NOTE Remember that a lightweight AP cannot normally operate on its own; it is very dependent on a WLC somewhere in the network.|NOTE Remember that a lightweight AP cannot normally operate on its own; it is very dependent on a WLC somewhere in the network.
The only exception is the FlexConnect architecture, which is discussed later in this chapter.|The only exception is the FlexConnect architecture, which is discussed later in this chapter.
|
The lightweight AP-WLC division of labor is known as a split-MAC architecture, where the normal MAC operations are pulled apart into two distinct locations.|The lightweight AP-WLC division of labor is known as a split-MAC architecture, where the normal MAC operations are pulled apart into two distinct locations.
This occurs for every AP in the network; each one must boot and bind itself to a WLC to support wireless clients.|This occurs for every AP in the network; each one must boot and bind itself to a WLC to support wireless clients.
|
The WLC becomes the central hub that supports a number of APs scattered about in the network.|The WLC becomes the central hub that supports a number of APs scattered about in the network.
|
How does a lightweight AP bind with a WLC to form a complete working access point?|How does a lightweight AP bind with a WLC to form a complete working access point?
The two devices must use a tunneling protocol between them, to carry 802.11-related messages and also client data.|The two devices must use a tunneling protocol between them, to carry 802.11-related messages and also client data.
Remember that the AP and WLC can be located on the same VLAN or IP subnet, but they do not have to be.|Remember that the AP and WLC can be located on the same VLAN or IP subnet, but they do not have to be.
Instead, they can be located on two entirely different IP subnets in two entirely different locations.|Instead, they can be located on two entirely different IP subnets in two entirely different locations.
|
The Control and Provisioning of Wireless Access Points (CAPWAP) tunneling protocol makes this all possible by encapsulating the data between the LAP and WLC within new IP packets.|The Control and Provisioning of Wireless Access Points (CAPWAP) tunneling protocol makes this all possible by encapsulating the data between the LAP and WLC within new IP packets.
The tunneled data can then be switched or routed across the campus network.|The tunneled data can then be switched or routed across the campus network.
As Figure 27-5 shows, the CAPWAP relationship actually consists of two separate tunnels, as follows:|As Figure 27-5 shows, the CAPWAP relationship actually consists of two separate tunnels, as follows:
###### CAPWAP control messages: Carries exchanges that are used to configure the AP and
CAPWAP control messages: Carries exchanges that are used to configure the AP and   
__|__
--|--
|
manage its operation.|manage its operation.
The control messages are authenticated and encrypted, so the AP is securely controlled by only the appropriate WLC, then transported over the control tunnel.|The control messages are authenticated and encrypted, so the AP is securely controlled by only the appropriate WLC, then transported over the control tunnel.
###### CAPWAP data: Used for packets traveling to and from wireless clients that are associated
CAPWAP data: Used for packets traveling to and from wireless clients that are associated   
__|__
--|--
|
with the AP. Data packets are transported over the data tunnel but are not encrypted by default.|with the AP. Data packets are transported over the data tunnel but are not encrypted by default.
When data encryption is enabled for an AP, packets are protected with Datagram Transport Layer Security (DTLS).|When data encryption is enabled for an AP, packets are protected with Datagram Transport Layer Security (DTLS).
|
NOTE CAPWAP is defined in RFCs 5415, 5416, 5417, and 5418.|NOTE CAPWAP is defined in RFCs 5415, 5416, 5417, and 5418.
CAPWAP is based on the Lightweight Access Point Protocol (LWAPP), which was a legacy Cisco proprietary solution.|CAPWAP is based on the Lightweight Access Point Protocol (LWAPP), which was a legacy Cisco proprietary solution.
|
Figure 27-5 Linking a Lightweight AP and WLC with CAPWAP Every AP and WLC must also authenticate each other with digital certificates.|Figure 27-5 Linking a Lightweight AP and WLC with CAPWAP Every AP and WLC must also authenticate each other with digital certificates.
An X.509 certificate is preinstalled in each device when it is purchased.|An X.509 certificate is preinstalled in each device when it is purchased.
By using certificates behind the scenes, every device is properly authenticated before becoming part of the wireless network.|By using certificates behind the scenes, every device is properly authenticated before becoming part of the wireless network.
|
This process helps assure that no one can add an unauthorized AP to your network.|This process helps assure that no one can add an unauthorized AP to your network.
|
The CAPWAP tunneling allows the AP and WLC to be separated geographically and logically.|The CAPWAP tunneling allows the AP and WLC to be separated geographically and logically.
|
It also breaks the dependence on Layer 2 connectivity between them.|It also breaks the dependence on Layer 2 connectivity between them.
For example, Figure 27-6 uses shaded areas to show the extent of VLAN 100.|For example, Figure 27-6 uses shaded areas to show the extent of VLAN 100.
Notice how VLAN 100 exists at the WLC and in the air as SSID 100, near the wireless clients—but not in between the AP and the WLC. Instead, traffic to and from clients associated with SSID 100 is transported across the network infrastructure encapsulated inside the CAPWAP data tunnel.|Notice how VLAN 100 exists at the WLC and in the air as SSID 100, near the wireless clients—but not in between the AP and the WLC. Instead, traffic to and from clients associated with SSID 100 is transported across the network infrastructure encapsulated inside the CAPWAP data tunnel.
The tunnel exists between the IP address of the WLC and the IP address of the AP, which allows all of the tunneled packets to be routed at Layer 3.|The tunnel exists between the IP address of the WLC and the IP address of the AP, which allows all of the tunneled packets to be routed at Layer 3.
|
Also, notice how the AP is known by only a single IP address: 10.10.10.10.|Also, notice how the AP is known by only a single IP address: 10.10.10.10.
Because the AP sits on the access layer where its CAPWAP tunnels terminate, it can use one IP address for both management and tunneling.|Because the AP sits on the access layer where its CAPWAP tunnels terminate, it can use one IP address for both management and tunneling.
No trunk link is needed because all of the VLANs it supports are encapsulated and tunneled as Layer 3 IP packets, rather than individual Layer 2 VLANs.|No trunk link is needed because all of the VLANs it supports are encapsulated and tunneled as Layer 3 IP packets, rather than individual Layer 2 VLANs.
|
As the wireless network grows, the WLC simply builds more CAPWAP tunnels to reach more APs. Figure 27-7 depicts a network with four APs. Each AP has a control and a data tunnel back to the centralized WLC. SSID 100 can exist on every AP, and VLAN 100 can reach every AP through the network of tunnels.|As the wireless network grows, the WLC simply builds more CAPWAP tunnels to reach more APs. Figure 27-7 depicts a network with four APs. Each AP has a control and a data tunnel back to the centralized WLC. SSID 100 can exist on every AP, and VLAN 100 can reach every AP through the network of tunnels.
|
Figure 27-6 Extent of VLAN 100 in a Cisco Wireless Network Figure 27-7 Using CAPWAP Tunnels to Connect APs to One Central WLC Once CAPWAP tunnels are built from a WLC to one or more lightweight APs, the WLC can begin offering a variety of additional functions.|Figure 27-6 Extent of VLAN 100 in a Cisco Wireless Network Figure 27-7 Using CAPWAP Tunnels to Connect APs to One Central WLC Once CAPWAP tunnels are built from a WLC to one or more lightweight APs, the WLC can begin offering a variety of additional functions.
Think of all the puzzles and shortcomings that were discussed for the traditional autonomous WLAN architecture as you read over the following list of WLC activities:|Think of all the puzzles and shortcomings that were discussed for the traditional autonomous WLAN architecture as you read over the following list of WLC activities:
###### Dynamic channel assignment: The WLC can automatically choose and configure the RF
Dynamic channel assignment: The WLC can automatically choose and configure the RF   
__|__
--|--
|
channel used by each AP, based on other active access points in the area.|channel used by each AP, based on other active access points in the area.
###### Transmit power optimization: The WLC can automatically set the transmit power of
Transmit power optimization: The WLC can automatically set the transmit power of   
__|__
--|--
|
each AP based on the coverage area needed.|each AP based on the coverage area needed.
###### Self-healing wireless coverage: If an AP radio dies, the coverage hole can be “healed” by
Self-healing wireless coverage: If an AP radio dies, the coverage hole can be “healed” by   
__|__
--|--
|
turning up the transmit power of surrounding APs automatically.|turning up the transmit power of surrounding APs automatically.
###### Flexible client roaming: Clients can roam between APs with very fast roaming times.
Flexible client roaming: Clients can roam between APs with very fast roaming times.   
###### Dynamic client load balancing: If two or more APs are positioned to cover the same geographic
Dynamic client load balancing: If two or more APs are positioned to cover the same geographic   
__|__
--|--
|
area, the WLC can associate clients with the least used AP. This distributes the client load across the APs.|area, the WLC can associate clients with the least used AP. This distributes the client load across the APs.
###### RF monitoring: The WLC manages each AP so that it scans channels to monitor the RF
RF monitoring: The WLC manages each AP so that it scans channels to monitor the RF   
__|__
--|--
|
usage.|usage.
By listening to a channel, the WLC can remotely gather information about RF interference, noise, signals from neighboring APs, and signals from rogue APs or ad hoc clients.|By listening to a channel, the WLC can remotely gather information about RF interference, noise, signals from neighboring APs, and signals from rogue APs or ad hoc clients.
###### Security management: The WLC can authenticate clients from a central service and can
Security management: The WLC can authenticate clients from a central service and can   
__|__
--|--
|
require wireless clients to obtain an IP address from a trusted DHCP server before allowing them to associate and access the WLAN.|require wireless clients to obtain an IP address from a trusted DHCP server before allowing them to associate and access the WLAN.
###### Wireless intrusion protection system: Leveraging its central location, the WLC can
Wireless intrusion protection system: Leveraging its central location, the WLC can   
__|__
--|--
|
monitor client data to detect and prevent malicious activity.|monitor client data to detect and prevent malicious activity.
|
Comparing Wireless LAN Controller Deployments Suppose you want to deploy a WLC to support multiple lightweight APs in your network.|Comparing Wireless LAN Controller Deployments Suppose you want to deploy a WLC to support multiple lightweight APs in your network.
|
Where should you put the WLC? The split-MAC concept can be applied to several different network architectures.|Where should you put the WLC? The split-MAC concept can be applied to several different network architectures.
Each architecture places the WLC in a different location within the network—a choice that also affects how many WLCs might be needed to support the number of APs required.|Each architecture places the WLC in a different location within the network—a choice that also affects how many WLCs might be needed to support the number of APs required.
|
One approach is to locate the WLC in a central location so that you can maximize the number of APs joined to it.|One approach is to locate the WLC in a central location so that you can maximize the number of APs joined to it.
This is usually called a unified or centralized WLC deployment, which tends to follow the concept that most of the resources users need to reach are located in a central location such as a data center or the Internet.|This is usually called a unified or centralized WLC deployment, which tends to follow the concept that most of the resources users need to reach are located in a central location such as a data center or the Internet.
Traffic to and from wireless users would travel over CAPWAP tunnels that reach into the center of the network, near the core, as shown in Figure 27-8.|Traffic to and from wireless users would travel over CAPWAP tunnels that reach into the center of the network, near the core, as shown in Figure 27-8.
A centralized WLC also provides a convenient place to enforce security policies that affect all wireless users.|A centralized WLC also provides a convenient place to enforce security policies that affect all wireless users.
|
Figure 27-8 WLC Location in a Unified Deployment Figure 27-8 shows four APs joined to a single WLC. Your network might have more APs—|Figure 27-8 WLC Location in a Unified Deployment Figure 27-8 shows four APs joined to a single WLC. Your network might have more APs—
|
many, many more.|many, many more.
A large enterprise network might have thousands of APs connected to its access layer.|A large enterprise network might have thousands of APs connected to its access layer.
Scalability then becomes an important factor in the centralized design.|Scalability then becomes an important factor in the centralized design.
Typical unified WLCs can support a maximum of 6000 APs. If you have more APs than the maximum, you will need to add more WLCs to the design, each located centrally.|Typical unified WLCs can support a maximum of 6000 APs. If you have more APs than the maximum, you will need to add more WLCs to the design, each located centrally.
|
A WLC can also be located in a central position in the network, inside a data center in a private cloud, as shown in Figure 27-9.|A WLC can also be located in a central position in the network, inside a data center in a private cloud, as shown in Figure 27-9.
This is known as a cloud-based WLC deployment, where the WLC exists as a virtual machine rather than a physical device.|This is known as a cloud-based WLC deployment, where the WLC exists as a virtual machine rather than a physical device.
If the cloud computing platform already exists, then deploying a cloud-based WLC becomes straightforward.|If the cloud computing platform already exists, then deploying a cloud-based WLC becomes straightforward.
|
Such a controller can typically support up to 3000 APs. If your wireless network scales beyond that, then additional WLCs can be added as more virtual machines.|Such a controller can typically support up to 3000 APs. If your wireless network scales beyond that, then additional WLCs can be added as more virtual machines.
|
Figure 27-9 WLC Location in a Cloud-based Deployment For small campuses or distributed branch locations, where the number of APs is relatively small in each, the WLC can be co-located with a stack of switches, as shown in Figure 27-10.|Figure 27-9 WLC Location in a Cloud-based Deployment For small campuses or distributed branch locations, where the number of APs is relatively small in each, the WLC can be co-located with a stack of switches, as shown in Figure 27-10.
|
This is known as an embedded WLC deployment because the controller is embedded within the switching hardware.|This is known as an embedded WLC deployment because the controller is embedded within the switching hardware.
Typical Cisco embedded WLCs can support up to 200 APs. The APs do not necessarily have to be connected to the switches that host the WLC; APs connected to other switches in other locations can join the embedded WLC too.|Typical Cisco embedded WLCs can support up to 200 APs. The APs do not necessarily have to be connected to the switches that host the WLC; APs connected to other switches in other locations can join the embedded WLC too.
As the number of APs grows, additional WLCs can be added by embedding them in other switch stacks at the site.|As the number of APs grows, additional WLCs can be added by embedding them in other switch stacks at the site.
|
Figure 27-10 WLC Location in an Embedded Deployment Finally, in small-scale environments, such as small, midsize, or multisite branch locations, you might not want to invest in dedicated WLCs at all.|Figure 27-10 WLC Location in an Embedded Deployment Finally, in small-scale environments, such as small, midsize, or multisite branch locations, you might not want to invest in dedicated WLCs at all.
In this case, the WLC function can be co-located with an AP that is installed at the branch site.|In this case, the WLC function can be co-located with an AP that is installed at the branch site.
This is known as a Cisco Mobility Express WLC deployment, as shown in Figure 27-11.|This is known as a Cisco Mobility Express WLC deployment, as shown in Figure 27-11.
The AP that hosts the WLC forms a CAPWAP tunnel with the WLC, along with any other APs at the same location.|The AP that hosts the WLC forms a CAPWAP tunnel with the WLC, along with any other APs at the same location.
A Mobility Express WLC can support up to 100 APs.|A Mobility Express WLC can support up to 100 APs.
|
Figure 27-11 WLC Location in a Mobility Express Deployment See Table 27-2 for a summary of WLC deployment models, WLC locations, and a typical maximum number of APs and clients that each one supports.|Figure 27-11 WLC Location in a Mobility Express Deployment See Table 27-2 for a summary of WLC deployment models, WLC locations, and a typical maximum number of APs and clients that each one supports.
|
Table 27-2 Summary of WLC Deployment Models Table end.|Table 27-2 Summary of WLC Deployment Models Table end.
|
27 Cisco AP Modes Many Cisco APs can operate in either autonomous or lightweight mode, depending on which code image is loaded and run.|27 Cisco AP Modes Many Cisco APs can operate in either autonomous or lightweight mode, depending on which code image is loaded and run.
From the WLC, you can also configure a lightweight AP to operate in one of the following special-purpose modes:|From the WLC, you can also configure a lightweight AP to operate in one of the following special-purpose modes:
###### Local: The default lightweight mode that offers one or more functioning BSSs on a specific
Local: The default lightweight mode that offers one or more functioning BSSs on a specific   
__|__
--|--
|
channel.|channel.
During times that it is not transmitting, the AP will scan the other channels to measure the level of noise, measure interference, discover rogue devices, and match against intrusion detection system (IDS) events.|During times that it is not transmitting, the AP will scan the other channels to measure the level of noise, measure interference, discover rogue devices, and match against intrusion detection system (IDS) events.
###### Monitor: The AP does not transmit at all, but its receiver is enabled to act as a dedicated
Monitor: The AP does not transmit at all, but its receiver is enabled to act as a dedicated   
__|__
--|--
|
sensor.|sensor.
The AP checks for IDS events, detects rogue access points, and determines the position of stations through location-based services.|The AP checks for IDS events, detects rogue access points, and determines the position of stations through location-based services.
###### FlexConnect: An AP at a remote site can locally switch traffic between an SSID and a
FlexConnect: An AP at a remote site can locally switch traffic between an SSID and a   
__|__
--|--
|
VLAN if its CAPWAP tunnel to the WLC is down and if it is configured to do so.|VLAN if its CAPWAP tunnel to the WLC is down and if it is configured to do so.
###### Sniffer: An AP dedicates its radios to receiving 802.11 traffic from other sources, much
Sniffer: An AP dedicates its radios to receiving 802.11 traffic from other sources, much   
__|__
--|--
|
like a sniffer or packet capture device.|like a sniffer or packet capture device.
The captured traffic is then forwarded to a PC running network analyzer software such as Wildpackets OmniPeek or WireShark, where it can be analyzed further.|The captured traffic is then forwarded to a PC running network analyzer software such as Wildpackets OmniPeek or WireShark, where it can be analyzed further.
###### Rogue detector: An AP dedicates itself to detecting rogue devices by correlating MAC
Rogue detector: An AP dedicates itself to detecting rogue devices by correlating MAC   
__|__
--|--
|
addresses heard on the wired network with those heard over the air.|addresses heard on the wired network with those heard over the air.
Rogue devices are those that appear on both networks.|Rogue devices are those that appear on both networks.
###### Bridge: An AP becomes a dedicated bridge (point-to-point or point-to-multipoint)
Bridge: An AP becomes a dedicated bridge (point-to-point or point-to-multipoint)   
__|__
--|--
|
between two networks.|between two networks.
Two APs in bridge mode can be used to link two locations separated by a distance.|Two APs in bridge mode can be used to link two locations separated by a distance.
Multiple APs in bridge mode can form an indoor or outdoor mesh network.|Multiple APs in bridge mode can form an indoor or outdoor mesh network.
###### Flex+Bridge: FlexConnect operation is enabled on a mesh AP.
Flex+Bridge: FlexConnect operation is enabled on a mesh AP.   
###### SE-Connect: The AP dedicates its radios to spectrum analysis on all wireless channels.
SE-Connect: The AP dedicates its radios to spectrum analysis on all wireless channels.   
__|__
--|--
|
You can remotely connect a PC running software such as MetaGeek Chanalyzer or Cisco Spectrum Expert to the AP to collect and analyze the spectrum analysis data to discover sources of interference.|You can remotely connect a PC running software such as MetaGeek Chanalyzer or Cisco Spectrum Expert to the AP to collect and analyze the spectrum analysis data to discover sources of interference.
|
NOTE Remember that a lightweight AP is normally in local mode when it is providing BSSs and allowing client devices to associate to wireless LANs. When an AP is configured to operate in one of the other modes, local mode (and the BSSs) is disabled.|NOTE Remember that a lightweight AP is normally in local mode when it is providing BSSs and allowing client devices to associate to wireless LANs. When an AP is configured to operate in one of the other modes, local mode (and the BSSs) is disabled.
### Chapter Review
Chapter Review   
__|__
--|--
|
Review this chapter’s material using either the tools in the book or the interactive tools for the same material found on the book’s companion website.|Review this chapter’s material using either the tools in the book or the interactive tools for the same material found on the book’s companion website.
Table 27-3 outlines the key review elements and where you can find them.|Table 27-3 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 27-3 Chapter Review Tracking Table end.|Table 27-3 Chapter Review Tracking Table end.
|
Review All the Key Topics Review the most important topics in this chapter, noted with the Key Topic icon in the outer margin of the page.|Review All the Key Topics Review the most important topics in this chapter, noted with the Key Topic icon in the outer margin of the page.
Table 27-4 lists a reference of these key topics and the page numbers on which each is found.|Table 27-4 lists a reference of these key topics and the page numbers on which each is found.
|
Key Terms You Should Know autonomous AP, CAPWAP, centralized WLC deployment, cloud-based AP, cloud-based WLC deployment, embedded WLC deployment, lightweight AP, local mode, Media Access Control (MAC) layer, Mobility Express WLC deployment, split-MAC architecture, unified WLC deployment, wireless LAN controller (WLC)|Key Terms You Should Know autonomous AP, CAPWAP, centralized WLC deployment, cloud-based AP, cloud-based WLC deployment, embedded WLC deployment, lightweight AP, local mode, Media Access Control (MAC) layer, Mobility Express WLC deployment, split-MAC architecture, unified WLC deployment, wireless LAN controller (WLC)
## Chapter 28 Securing Wireless Networks
Chapter 28 Securing Wireless Networks   
__|__
--|--
|
This chapter covers the following exam topics:|This chapter covers the following exam topics:
###### 1.0 Network Fundamentals
1.0 Network Fundamentals   
###### 1.11 Describe wireless principles
1.11 Describe wireless principles   
###### 1.11.d Encryption
1.11.d Encryption   
###### 5.0 Security Fundamentals
5.0 Security Fundamentals   
###### 5.9 Describe wireless security protocols (WPA, WPA2, and WPA3)
5.9 Describe wireless security protocols (WPA, WPA2, and WPA3)   
__|__
--|--
|
As you know by now, wireless networks are complex.|As you know by now, wireless networks are complex.
Many technologies and protocols work behind the scenes to give end users a stable, yet mobile, connection to a wired network infrastructure.|Many technologies and protocols work behind the scenes to give end users a stable, yet mobile, connection to a wired network infrastructure.
|
From the user’s perspective, a wireless connection should seem no different than a wired connection.|From the user’s perspective, a wireless connection should seem no different than a wired connection.
A wired connection can give users a sense of security; data traveling over a wire is probably not going to be overheard by others.|A wired connection can give users a sense of security; data traveling over a wire is probably not going to be overheard by others.
A wireless connection is inherently different; data traveling over the air can be overheard by anyone within range.|A wireless connection is inherently different; data traveling over the air can be overheard by anyone within range.
|
Therefore, securing a wireless network becomes just as important as any other aspect.|Therefore, securing a wireless network becomes just as important as any other aspect.
A comprehensive approach to wireless security focuses on the following areas:|A comprehensive approach to wireless security focuses on the following areas:
###### Identifying the endpoints of a wireless connection
Identifying the endpoints of a wireless connection   
###### Identifying the end user
Identifying the end user   
###### Protecting the wireless data from eavesdroppers
Protecting the wireless data from eavesdroppers   
###### Protecting the wireless data from tampering
Protecting the wireless data from tampering   
__|__
--|--
|
The identification process is performed through various authentication schemes.|The identification process is performed through various authentication schemes.
Protecting wireless data involves security functions like encryption and frame authentication.|Protecting wireless data involves security functions like encryption and frame authentication.
|
This chapter covers many of the methods you can use to secure a wireless network.|This chapter covers many of the methods you can use to secure a wireless network.
Be warned: wireless security can be a confusing topic because it is filled with many acronyms.|Be warned: wireless security can be a confusing topic because it is filled with many acronyms.
|
Some of the acronyms rhyme like words from a children’s book.|Some of the acronyms rhyme like words from a children’s book.
In fact, this chapter is a story about WEP, PSK, TKIP, MIC, AES, EAP, EAP-FAST, EAP-TLS, LEAP, PEAP, WPA, WPA2, WPA3, CCMP, GCMP, and on and on it goes.|In fact, this chapter is a story about WEP, PSK, TKIP, MIC, AES, EAP, EAP-FAST, EAP-TLS, LEAP, PEAP, WPA, WPA2, WPA3, CCMP, GCMP, and on and on it goes.
When you finish with this chapter, though, you will come away with a clearer view of what these terms mean and how they all fit together.|When you finish with this chapter, though, you will come away with a clearer view of what these terms mean and how they all fit together.
You might even be ready to configure a wireless LAN with effective security.|You might even be ready to configure a wireless LAN with effective security.
### “Do I Know This Already?” Quiz
“Do I Know This Already?” Quiz   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.
The letter answers are listed at the bottom of the page following the quiz.|The letter answers are listed at the bottom of the page following the quiz.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.
You can also find both answers and explanations in the PTP testing software.|You can also find both answers and explanations in the PTP testing software.
|
CHAPTER 28 Table 28-1 “Do I Know This Already?” Section-to-Question Mapping|CHAPTER 28 Table 28-1 “Do I Know This Already?” Section-to-Question Mapping
### Foundation Topics
Foundation Topics   
### Anatomy of a Secure Connection
Anatomy of a Secure Connection   
__|__
--|--
|
Wireless Client Authentication Methods 3–4 Wireless Privacy and Integrity Methods 5–6 WPA, WPA2, and WPA3 7–8 1.|Wireless Client Authentication Methods 3–4 Wireless Privacy and Integrity Methods 5–6 WPA, WPA2, and WPA3 7–8 1.
Which of the following are necessary components of a secure wireless connection?|Which of the following are necessary components of a secure wireless connection?
|
(Choose all that apply.)|(Choose all that apply.)
|
a. Encryption b.|a. Encryption b.
MIC c.|MIC c.
Authentication d.|Authentication d.
All of these answers are correct.|All of these answers are correct.
|
2. Which one of the following is used to protect the integrity of data in a wireless frame?|2. Which one of the following is used to protect the integrity of data in a wireless frame?
|
a. WIPS b.|a. WIPS b.
WEP c.|WEP c.
MIC d.|MIC d.
EAP 3.|EAP 3.
Which one of the following is a wireless encryption method that has been found to be vulnerable and is not recommended for use?|Which one of the following is a wireless encryption method that has been found to be vulnerable and is not recommended for use?
|
a. AES b.|a. AES b.
WPA c.|WPA c.
EAP d.|EAP d.
WEP 4.|WEP 4.
Which one of the following is used as the authentication framework when 802.1x is used on a WLAN?|Which one of the following is used as the authentication framework when 802.1x is used on a WLAN?
|
a. Open authentication b.|a. Open authentication b.
WEP c.|WEP c.
EAP d.|EAP d.
WPA 5.|WPA 5.
Suppose you would like to select a method to protect the privacy and integrity of wireless data.|Suppose you would like to select a method to protect the privacy and integrity of wireless data.
Which one of the following methods should you avoid because it has been deprecated ?|Which one of the following methods should you avoid because it has been deprecated ?
|
a. TKIP b.|a. TKIP b.
CCMP c.|CCMP c.
GCMP d.|GCMP d.
EAP 6.|EAP 6.
Which one of the following is the data encryption and integrity method used by WPA2?|Which one of the following is the data encryption and integrity method used by WPA2?
|
a. WEP b.|a. WEP b.
TKIP c.|TKIP c.
CCMP d.|CCMP d.
WPA 7.|WPA 7.
The Wi-Fi Alliance offers which of the following certifications for wireless devices that correctly implement security standards? (Choose all that apply.)|The Wi-Fi Alliance offers which of the following certifications for wireless devices that correctly implement security standards? (Choose all that apply.)
|
a. WEP b.|a. WEP b.
WPA2 c. 802.11 d.|WPA2 c. 802.11 d.
AES 8.|AES 8.
A pre-shared key is used in which of the following wireless security configurations?|A pre-shared key is used in which of the following wireless security configurations?
|
(Choose all that apply.)|(Choose all that apply.)
|
a. WPA2 personal mode b.|a. WPA2 personal mode b.
WPA2 enterprise mode c.|WPA2 enterprise mode c.
WPA3 personal mode d.|WPA3 personal mode d.
WPA3 enterprise mode Foundation Topics Anatomy of a Secure Connection In the previous chapters of this book, you learned about wireless clients forming associations with wireless access points (APs) and passing data back and forth across the air.|WPA3 enterprise mode Foundation Topics Anatomy of a Secure Connection In the previous chapters of this book, you learned about wireless clients forming associations with wireless access points (APs) and passing data back and forth across the air.
|
As long as all clients and APs conform to the 802.11 standard, they can all coexist—even on the same channel.|As long as all clients and APs conform to the 802.11 standard, they can all coexist—even on the same channel.
Not every 802.11 device is friendly and trustworthy, however.|Not every 802.11 device is friendly and trustworthy, however.
Sometimes it is easy to forget that transmitted frames do not just go directly from the sender to the receiver, as in a wired or switched connection.|Sometimes it is easy to forget that transmitted frames do not just go directly from the sender to the receiver, as in a wired or switched connection.
Instead, they travel according to the transmitter’s antenna pattern, potentially reaching any receiver that is within range.|Instead, they travel according to the transmitter’s antenna pattern, potentially reaching any receiver that is within range.
|
Consider the scenario in Figure 28-1.|Consider the scenario in Figure 28-1.
The wireless client opens a session with some remote entity and shares a confidential password.|The wireless client opens a session with some remote entity and shares a confidential password.
Because two untrusted users are also located within range of the client’s signal, they may also learn the password by capturing frames that have been sent on the channel.|Because two untrusted users are also located within range of the client’s signal, they may also learn the password by capturing frames that have been sent on the channel.
The convenience of wireless communication also makes it easy for transmissions to be overheard and exploited by malicious users.|The convenience of wireless communication also makes it easy for transmissions to be overheard and exploited by malicious users.
|
If data is sent through open space, how can it be secured so that it stays private and intact?|If data is sent through open space, how can it be secured so that it stays private and intact?
|
The 802.11 standard offers a framework of wireless security mechanisms that can be used to add trust, privacy, and integrity to a wireless network.|The 802.11 standard offers a framework of wireless security mechanisms that can be used to add trust, privacy, and integrity to a wireless network.
The following sections give an overview of the wireless security framework.|The following sections give an overview of the wireless security framework.
|
Figure 28-1 Wireless Transmissions Reaching Unintended Recipients|Figure 28-1 Wireless Transmissions Reaching Unintended Recipients
#### Authentication
Authentication   
__|__
--|--
|
To use a wireless network, clients must first discover a basic service set (BSS) and then request permission to associate with it.|To use a wireless network, clients must first discover a basic service set (BSS) and then request permission to associate with it.
Clients should be authenticated by some means before they can become functioning members of the wireless LAN. Why?|Clients should be authenticated by some means before they can become functioning members of the wireless LAN. Why?
|
Suppose that your wireless network connects to corporate resources where confidential information can be accessed.|Suppose that your wireless network connects to corporate resources where confidential information can be accessed.
In that case, only devices known to be trusted and expected should be given access.|In that case, only devices known to be trusted and expected should be given access.
Guest users, if they are permitted at all, should be allowed to join a different guest WLAN where they can access nonconfidential or public resources.|Guest users, if they are permitted at all, should be allowed to join a different guest WLAN where they can access nonconfidential or public resources.
Rogue clients, which are not expected or welcomed, should not be permitted to associate at all.|Rogue clients, which are not expected or welcomed, should not be permitted to associate at all.
After all, they are not affiliated with the corporate network and are likely to be unknown devices that happen to be within range of your network.|After all, they are not affiliated with the corporate network and are likely to be unknown devices that happen to be within range of your network.
|
To control access, wireless networks can authenticate the client devices before they are allowed to associate.|To control access, wireless networks can authenticate the client devices before they are allowed to associate.
Potential clients must identify themselves by presenting some form of credentials to the APs. Figure 28-2 shows the basic client authentication process.|Potential clients must identify themselves by presenting some form of credentials to the APs. Figure 28-2 shows the basic client authentication process.
|
Wireless authentication can take many forms.|Wireless authentication can take many forms.
Some methods require only a static text string that is common across all trusted clients and APs. The text string is stored on the client device and presented directly to the AP when needed.|Some methods require only a static text string that is common across all trusted clients and APs. The text string is stored on the client device and presented directly to the AP when needed.
What might happen if the device was stolen or lost?|What might happen if the device was stolen or lost?
Most likely, any user who possessed the device could still authenticate to the network.|Most likely, any user who possessed the device could still authenticate to the network.
Other more stringent authentication methods require interaction with a corporate user database.|Other more stringent authentication methods require interaction with a corporate user database.
In those cases, the end user must enter a valid username and password—|In those cases, the end user must enter a valid username and password—
|
something that would not be known to a thief or an imposter.|something that would not be known to a thief or an imposter.
|
Who are you?|Who are you?
|
I am Joe User.|I am Joe User.
|
Ok.|Ok.
|
Figure 28-2 Authenticating a Wireless Client If you have ever joined a wireless network, you might have focused on authenticating your device or yourself, while implicitly trusting the nearest AP. For example, if you turn on your wireless device and find a wireless network that is available at your workplace, you probably join it without hesitating.|Figure 28-2 Authenticating a Wireless Client If you have ever joined a wireless network, you might have focused on authenticating your device or yourself, while implicitly trusting the nearest AP. For example, if you turn on your wireless device and find a wireless network that is available at your workplace, you probably join it without hesitating.
The same is true for wireless networks in an airport, a hotel, a hot spot, or in your home—you expect the AP that is advertising the SSID to be owned and operated by the entity where you are located.|The same is true for wireless networks in an airport, a hotel, a hot spot, or in your home—you expect the AP that is advertising the SSID to be owned and operated by the entity where you are located.
But how can you be sure?|But how can you be sure?
|
Normally, the only piece of information you have is the SSID being broadcast or advertised by an AP. If the SSID looks familiar, you will likely choose to join it.|Normally, the only piece of information you have is the SSID being broadcast or advertised by an AP. If the SSID looks familiar, you will likely choose to join it.
Perhaps your computer is configured to automatically connect to a known SSID so that it associates without your intervention.|Perhaps your computer is configured to automatically connect to a known SSID so that it associates without your intervention.
Either way, you might unwittingly join the same SSID even if it was being advertised by an imposter.|Either way, you might unwittingly join the same SSID even if it was being advertised by an imposter.
|
Some common attacks focus on a malicious user pretending to be an AP. The fake AP can send beacons, answer probes, and associate clients just like the real AP it is impersonating.|Some common attacks focus on a malicious user pretending to be an AP. The fake AP can send beacons, answer probes, and associate clients just like the real AP it is impersonating.
|
Once a client associates with the fake AP, the attacker can easily intercept all communication to and from the client from its central position.|Once a client associates with the fake AP, the attacker can easily intercept all communication to and from the client from its central position.
A fake AP could also send spoofed management frames to disassociate or deauthenticate legitimate and active clients, just to disrupt normal network operation.|A fake AP could also send spoofed management frames to disassociate or deauthenticate legitimate and active clients, just to disrupt normal network operation.
|
To prevent this type of man-in-the-middle attack, the client should authenticate the AP before the client itself is authenticated.|To prevent this type of man-in-the-middle attack, the client should authenticate the AP before the client itself is authenticated.
Figure 28-3 shows a simple scenario.|Figure 28-3 shows a simple scenario.
Even further, any management frames received by a client should be authenticated too, as proof that they were sent by a legitimate and expected AP.|Even further, any management frames received by a client should be authenticated too, as proof that they were sent by a legitimate and expected AP.
|
Who are you?|Who are you?
|
I am AP-1.|I am AP-1.
|
These are my management frames.|These are my management frames.
|
Ok.|Ok.
|
Figure 28-3 Authenticating a Wireless AP Answers to the “Do I Know This Already?” quiz:|Figure 28-3 Authenticating a Wireless AP Answers to the “Do I Know This Already?” quiz:
|
1 D 2 C 3 D 4 C 5 A 6 C 7 B 8 A, C|1 D 2 C 3 D 4 C 5 A 6 C 7 B 8 A, C
#### Message Privacy
Message Privacy   
__|__
--|--
|
Suppose that the client in Figure 28-3 must authenticate before joining the wireless network.|Suppose that the client in Figure 28-3 must authenticate before joining the wireless network.
|
It might also authenticate the AP and its management frames after it associates but before it is itself authenticated.|It might also authenticate the AP and its management frames after it associates but before it is itself authenticated.
The client’s relationship with the AP might become much more trusted, but data passing to and from the client is still available to eavesdroppers on the same channel.|The client’s relationship with the AP might become much more trusted, but data passing to and from the client is still available to eavesdroppers on the same channel.
|
To protect data privacy on a wireless network, the data should be encrypted for its journey through free space.|To protect data privacy on a wireless network, the data should be encrypted for its journey through free space.
This is accomplished by encrypting the data payload in each wireless frame just prior to being transmitted, then decrypting it as it is received.|This is accomplished by encrypting the data payload in each wireless frame just prior to being transmitted, then decrypting it as it is received.
The idea is to use an encryption method that the transmitter and receiver share, so the data can be encrypted and decrypted successfully.|The idea is to use an encryption method that the transmitter and receiver share, so the data can be encrypted and decrypted successfully.
|
In wireless networks, each WLAN may support only one authentication and encryption scheme, so all clients must use the same encryption method when they associate.|In wireless networks, each WLAN may support only one authentication and encryption scheme, so all clients must use the same encryption method when they associate.
You might think that having one encryption method in common would allow every client to eavesdrop on every other client.|You might think that having one encryption method in common would allow every client to eavesdrop on every other client.
That is not necessarily the case because the AP should securely negotiate a unique encryption key to use for each associated client.|That is not necessarily the case because the AP should securely negotiate a unique encryption key to use for each associated client.
|
Ideally, the AP and a client are the only two devices that have the encryption keys in common so that they can understand each other’s data.|Ideally, the AP and a client are the only two devices that have the encryption keys in common so that they can understand each other’s data.
No other device should know about or be able to use the same keys to eavesdrop and decrypt the data.|No other device should know about or be able to use the same keys to eavesdrop and decrypt the data.
In Figure 28-4, the client’s confidential password information has been encrypted before being transmitted.|In Figure 28-4, the client’s confidential password information has been encrypted before being transmitted.
The AP can decrypt it successfully before forwarding it onto the wired network, but other wireless devices cannot.|The AP can decrypt it successfully before forwarding it onto the wired network, but other wireless devices cannot.
|
Figure 28-4 Encrypting Wireless Data to Protect Data Privacy The AP also maintains a “group key” that it uses when it needs to send encrypted data to all clients in its cell at one time.|Figure 28-4 Encrypting Wireless Data to Protect Data Privacy The AP also maintains a “group key” that it uses when it needs to send encrypted data to all clients in its cell at one time.
Each of the associated clients uses the same group key to decrypt the data.|Each of the associated clients uses the same group key to decrypt the data.
#### Message Integrity
Message Integrity   
__|__
--|--
|
Encrypting data obscures it from view while it is traveling over a public or untrusted network.|Encrypting data obscures it from view while it is traveling over a public or untrusted network.
|
The intended recipient should be able to decrypt the message and recover the original contents, but what if someone managed to alter the contents along the way?|The intended recipient should be able to decrypt the message and recover the original contents, but what if someone managed to alter the contents along the way?
The recipient would have a very difficult time discovering that the original data had been modified.|The recipient would have a very difficult time discovering that the original data had been modified.
|
A message integrity check (MIC) is a security tool that can protect against data tampering.|A message integrity check (MIC) is a security tool that can protect against data tampering.
|
You can think of a MIC as a way for the sender to add a secret stamp inside the encrypted data frame.|You can think of a MIC as a way for the sender to add a secret stamp inside the encrypted data frame.
The stamp is based on the contents of the data bits to be transmitted.|The stamp is based on the contents of the data bits to be transmitted.
Once the recipient decrypts the frame, it can compare the secret stamp to its own idea of what the stamp should be, based on the data bits that were received.|Once the recipient decrypts the frame, it can compare the secret stamp to its own idea of what the stamp should be, based on the data bits that were received.
If the two stamps are identical, the recipient can safely assume that the data has not been tampered with.|If the two stamps are identical, the recipient can safely assume that the data has not been tampered with.
Figure 28-5 shows the MIC process.|Figure 28-5 shows the MIC process.
|
Figure 28-5 Checking Message Integrity over a Wireless Network|Figure 28-5 Checking Message Integrity over a Wireless Network
### Wireless Client Authentication Methods
Wireless Client Authentication Methods   
__|__
--|--
|
You can use many different methods to authenticate wireless clients as they try to associate with the network.|You can use many different methods to authenticate wireless clients as they try to associate with the network.
The methods have been introduced over time and have evolved as security weaknesses have been exposed and wireless hardware has advanced.|The methods have been introduced over time and have evolved as security weaknesses have been exposed and wireless hardware has advanced.
This section covers the most common authentication methods you might encounter.|This section covers the most common authentication methods you might encounter.
#### Open Authentication
Open Authentication   
__|__
--|--
|
The original 802.11 standard offered only two choices to authenticate a client: open authentication and WEP.|The original 802.11 standard offered only two choices to authenticate a client: open authentication and WEP.
|
Open authentication is true to its name; it offers open access to a WLAN. The only requirement is that a client must use an 802.11 authentication request before it attempts to associate with an AP. No other credentials are needed.|Open authentication is true to its name; it offers open access to a WLAN. The only requirement is that a client must use an 802.11 authentication request before it attempts to associate with an AP. No other credentials are needed.
|
When would you want to use open authentication?|When would you want to use open authentication?
After all, it does not sound very secure because it is not.|After all, it does not sound very secure because it is not.
With no challenge, any 802.11 client may authenticate to access the network.|With no challenge, any 802.11 client may authenticate to access the network.
|
That is, in fact, the whole purpose of open authentication—to validate that a client is a valid 802.11 device by authenticating the wireless hardware and the protocol.|That is, in fact, the whole purpose of open authentication—to validate that a client is a valid 802.11 device by authenticating the wireless hardware and the protocol.
Authenticating the user’s identity is handled as a true security process through other means.|Authenticating the user’s identity is handled as a true security process through other means.
|
You have probably seen a WLAN with open authentication when you have visited a public location.|You have probably seen a WLAN with open authentication when you have visited a public location.
If any client screening is used at all, it comes in the form of web authentication.|If any client screening is used at all, it comes in the form of web authentication.
A client can associate right away but must open a web browser to see and accept the terms for use and enter basic credentials.|A client can associate right away but must open a web browser to see and accept the terms for use and enter basic credentials.
From that point, network access is opened up for the client.|From that point, network access is opened up for the client.
|
Most client operating systems flag such networks to warn you that your wireless data will not be secured in any way if you join.|Most client operating systems flag such networks to warn you that your wireless data will not be secured in any way if you join.
#### WEP
WEP   
__|__
--|--
|
As you might expect, open authentication offers nothing that can obscure or encrypt the data being sent between a client and an AP. As an alternative, the 802.11 standard has traditionally defined Wired Equivalent Privacy (WEP) as a method to make a wireless link more like or equivalent to a wired connection.|As you might expect, open authentication offers nothing that can obscure or encrypt the data being sent between a client and an AP. As an alternative, the 802.11 standard has traditionally defined Wired Equivalent Privacy (WEP) as a method to make a wireless link more like or equivalent to a wired connection.
|
WEP uses the RC4 cipher algorithm to make every wireless data frame private and hidden from eavesdroppers.|WEP uses the RC4 cipher algorithm to make every wireless data frame private and hidden from eavesdroppers.
The same algorithm encrypts data at the sender and decrypts it at the receiver.|The same algorithm encrypts data at the sender and decrypts it at the receiver.
The algorithm uses a string of bits as a key, commonly called a WEP key, to derive other encryption keys—one per wireless frame.|The algorithm uses a string of bits as a key, commonly called a WEP key, to derive other encryption keys—one per wireless frame.
As long as the sender and receiver have an identical key, one can decrypt what the other encrypts.|As long as the sender and receiver have an identical key, one can decrypt what the other encrypts.
|
WEP is known as a shared-key security method.|WEP is known as a shared-key security method.
The same key must be shared between the sender and receiver ahead of time, so that each can derive other mutually agreeable encryption keys.|The same key must be shared between the sender and receiver ahead of time, so that each can derive other mutually agreeable encryption keys.
In fact, every potential client and AP must share the same key ahead of time so that any client can associate with the AP.|In fact, every potential client and AP must share the same key ahead of time so that any client can associate with the AP.
|
The WEP key can also be used as an optional authentication method as well as an encryption tool.|The WEP key can also be used as an optional authentication method as well as an encryption tool.
Unless a client can use the correct WEP key, it cannot associate with an AP. The AP tests the client’s knowledge of the WEP key by sending it a random challenge phrase.|Unless a client can use the correct WEP key, it cannot associate with an AP. The AP tests the client’s knowledge of the WEP key by sending it a random challenge phrase.
|
The client encrypts the challenge phrase with WEP and returns the result to the AP. The AP can compare the client’s encryption with its own to see whether the two WEP keys yield identical results.|The client encrypts the challenge phrase with WEP and returns the result to the AP. The AP can compare the client’s encryption with its own to see whether the two WEP keys yield identical results.
|
WEP keys can be either 40 or 104 bits long, represented by a string of 10 or 26 hex digits.|WEP keys can be either 40 or 104 bits long, represented by a string of 10 or 26 hex digits.
|
As a rule of thumb, longer keys offer more unique bits for the algorithm, resulting in more robust encryption.|As a rule of thumb, longer keys offer more unique bits for the algorithm, resulting in more robust encryption.
Except in WEP’s case, that is.|Except in WEP’s case, that is.
Because WEP was defined in the original 802.11 standard in 1999, every wireless adapter was built with encryption hardware specific to WEP. In 2001, a number of weaknesses were discovered and revealed, so work began to find better wireless security methods.|Because WEP was defined in the original 802.11 standard in 1999, every wireless adapter was built with encryption hardware specific to WEP. In 2001, a number of weaknesses were discovered and revealed, so work began to find better wireless security methods.
By 2004, the 802.11i amendment was ratified and WEP was officially deprecated.|By 2004, the 802.11i amendment was ratified and WEP was officially deprecated.
Both WEP encryption and WEP shared-key authentication are widely considered to be weak methods to secure a wireless LAN.|Both WEP encryption and WEP shared-key authentication are widely considered to be weak methods to secure a wireless LAN.
#### 802.1x/EAP
802.1x/EAP   
__|__
--|--
|
With only open authentication and WEP available in the original 802.11 standard, a more secure authentication method was needed.|With only open authentication and WEP available in the original 802.11 standard, a more secure authentication method was needed.
Client authentication generally involves some sort of challenge, a response, and then a decision to grant access.|Client authentication generally involves some sort of challenge, a response, and then a decision to grant access.
Behind the scenes, it can also involve an exchange of session or encryption keys, in addition to other parameters needed for client access.|Behind the scenes, it can also involve an exchange of session or encryption keys, in addition to other parameters needed for client access.
Each authentication method might have unique requirements as a unique way to pass information between the client and the AP.|Each authentication method might have unique requirements as a unique way to pass information between the client and the AP.
|
Rather than build additional authentication methods into the 802.11 standard, a more flexible and scalable authentication framework, the Extensible Authentication Protocol (EAP), was chosen.|Rather than build additional authentication methods into the 802.11 standard, a more flexible and scalable authentication framework, the Extensible Authentication Protocol (EAP), was chosen.
As its name implies, EAP is extensible and does not consist of any one authentication method.|As its name implies, EAP is extensible and does not consist of any one authentication method.
Instead, EAP defines a set of common functions that actual authentication methods can use to authenticate users.|Instead, EAP defines a set of common functions that actual authentication methods can use to authenticate users.
As you read through this section, notice how many authentication methods have EAP in their names.|As you read through this section, notice how many authentication methods have EAP in their names.
Each method is unique and different, but each one follows the EAP framework.|Each method is unique and different, but each one follows the EAP framework.
|
EAP has another interesting quality: it can integrate with the IEEE 802.1x port-based access control standard.|EAP has another interesting quality: it can integrate with the IEEE 802.1x port-based access control standard.
When 802.1x is enabled, it limits access to a network media until a client authenticates.|When 802.1x is enabled, it limits access to a network media until a client authenticates.
This means that a wireless client might be able to associate with an AP but will not be able to pass data to any other part of the network until it successfully authenticates.|This means that a wireless client might be able to associate with an AP but will not be able to pass data to any other part of the network until it successfully authenticates.
|
With open and WEP authentication, wireless clients are authenticated locally at the AP without further intervention.|With open and WEP authentication, wireless clients are authenticated locally at the AP without further intervention.
The scenario changes with 802.1x; the client uses open authentication to associate with the AP, and then the actual client authentication process occurs at a dedicated authentication server.|The scenario changes with 802.1x; the client uses open authentication to associate with the AP, and then the actual client authentication process occurs at a dedicated authentication server.
Figure 28-6 shows the three-party 802.1x arrangement that consists of the following entities:|Figure 28-6 shows the three-party 802.1x arrangement that consists of the following entities:
###### Supplicant: The client device that is requesting access
Supplicant: The client device that is requesting access   
###### Authenticator: The network device that provides access to the network (usually a wireless
Authenticator: The network device that provides access to the network (usually a wireless   
__|__
--|--
|
LAN controller [WLC])|LAN controller [WLC])
###### Authentication server (AS): The device that takes user or client credentials and permits
Authentication server (AS): The device that takes user or client credentials and permits   
__|__
--|--
|
or denies network access based on a user database and policies (usually a RADIUS server)|or denies network access based on a user database and policies (usually a RADIUS server)
|
AP WLC Supplicant Authenticator Authentication Server (AS)|AP WLC Supplicant Authenticator Authentication Server (AS)
|
802.11 Open Authentication EAP-Based Authentication Figure 28-6 802.1x Client Authentication Roles The wireless LAN controller becomes a middleman in the client authentication process, controlling user access with 802.1x and communicating with the authentication server using the EAP framework.|802.11 Open Authentication EAP-Based Authentication Figure 28-6 802.1x Client Authentication Roles The wireless LAN controller becomes a middleman in the client authentication process, controlling user access with 802.1x and communicating with the authentication server using the EAP framework.
|
The following sections provide an overview of several common EAP-based authentication methods.|The following sections provide an overview of several common EAP-based authentication methods.
The goal here is to become aware of the many methods without trying to memorize them all.|The goal here is to become aware of the many methods without trying to memorize them all.
In fact, even when you configure user authentication on a wireless LAN, you will not have to select a specific method.|In fact, even when you configure user authentication on a wireless LAN, you will not have to select a specific method.
Instead, you select 802.1x on the WLC so that it is ready to handle a variety of EAP methods.|Instead, you select 802.1x on the WLC so that it is ready to handle a variety of EAP methods.
It is then up to the client and the authentication server to use a compatible method.|It is then up to the client and the authentication server to use a compatible method.
You will learn more about configuring security on a wireless LAN in Chapter 29, “Building a Wireless LAN.”|You will learn more about configuring security on a wireless LAN in Chapter 29, “Building a Wireless LAN.”
##### LEAP
LEAP   
__|__
--|--
|
As an early attempt to address the weaknesses in WEP, Cisco developed a proprietary wireless authentication method called Lightweight EAP (LEAP). To authenticate, the client must supply username and password credentials.|As an early attempt to address the weaknesses in WEP, Cisco developed a proprietary wireless authentication method called Lightweight EAP (LEAP). To authenticate, the client must supply username and password credentials.
Both the authentication server and the client exchange challenge messages that are then encrypted and returned.|Both the authentication server and the client exchange challenge messages that are then encrypted and returned.
This provides mutual authentication; as long as the messages can be decrypted successfully, the client and the AS have essentially authenticated each other.|This provides mutual authentication; as long as the messages can be decrypted successfully, the client and the AS have essentially authenticated each other.
|
At the time, WEP-based hardware was still widely used.|At the time, WEP-based hardware was still widely used.
Therefore, LEAP attempted to overcome WEP weaknesses by using dynamic WEP keys that changed frequently.|Therefore, LEAP attempted to overcome WEP weaknesses by using dynamic WEP keys that changed frequently.
Nevertheless, the method used to encrypt the challenge messages was found to be vulnerable, so LEAP has since been deprecated.|Nevertheless, the method used to encrypt the challenge messages was found to be vulnerable, so LEAP has since been deprecated.
Even though wireless clients and controllers still offer LEAP, you should not use it.|Even though wireless clients and controllers still offer LEAP, you should not use it.
##### EAP-FAST
EAP-FAST   
__|__
--|--
|
Cisco developed a more secure method called EAP Flexible Authentication by Secure Tunneling (EAP-FAST). Authentication credentials are protected by passing a protected access credential (PAC) between the AS and the supplicant.|Cisco developed a more secure method called EAP Flexible Authentication by Secure Tunneling (EAP-FAST). Authentication credentials are protected by passing a protected access credential (PAC) between the AS and the supplicant.
The PAC is a form of shared secret that is generated by the AS and used for mutual authentication.|The PAC is a form of shared secret that is generated by the AS and used for mutual authentication.
EAP-FAST is a sequence of three phases:|EAP-FAST is a sequence of three phases:
###### Phase 0: The PAC is generated or provisioned and installed on the client.
Phase 0: The PAC is generated or provisioned and installed on the client.   
###### Phase 1: After the supplicant and AS have authenticated each other, they negotiate a
Phase 1: After the supplicant and AS have authenticated each other, they negotiate a   
__|__
--|--
|
Transport Layer Security (TLS) tunnel.|Transport Layer Security (TLS) tunnel.
###### Phase 2: The end user can then be authenticated through the TLS tunnel for additional
Phase 2: The end user can then be authenticated through the TLS tunnel for additional   
__|__
--|--
|
security.|security.
|
Notice that two separate authentication processes occur in EAP-FAST—one between the AS and the supplicant and another with the end user.|Notice that two separate authentication processes occur in EAP-FAST—one between the AS and the supplicant and another with the end user.
These occur in a nested fashion, as an outer authentication (outside the TLS tunnel) and an inner authentication (inside the TLS tunnel).|These occur in a nested fashion, as an outer authentication (outside the TLS tunnel) and an inner authentication (inside the TLS tunnel).
|
Like other EAP-based methods, a RADIUS server is required.|Like other EAP-based methods, a RADIUS server is required.
However, the RADIUS server must also operate as an EAP-FAST server to be able to generate PACs, one per user.|However, the RADIUS server must also operate as an EAP-FAST server to be able to generate PACs, one per user.
##### PEAP
PEAP   
__|__
--|--
|
Like EAP-FAST, the Protected EAP (PEAP) method uses an inner and outer authentication;|Like EAP-FAST, the Protected EAP (PEAP) method uses an inner and outer authentication;
|
however, the AS presents a digital certificate to authenticate itself with the supplicant in the outer authentication.|however, the AS presents a digital certificate to authenticate itself with the supplicant in the outer authentication.
If the supplicant is satisfied with the identity of the AS, the two will build a TLS tunnel to be used for the inner client authentication and encryption key exchange.|If the supplicant is satisfied with the identity of the AS, the two will build a TLS tunnel to be used for the inner client authentication and encryption key exchange.
|
The digital certificate of the AS consists of data in a standard format that identifies the owner and is “signed” or validated by a third party.|The digital certificate of the AS consists of data in a standard format that identifies the owner and is “signed” or validated by a third party.
The third party is known as a certificate authority (CA) and is known and trusted by both the AS and the supplicants.|The third party is known as a certificate authority (CA) and is known and trusted by both the AS and the supplicants.
The supplicant must also possess the CA certificate just so that it can validate the one it receives from the AS. The certificate is also used to pass a public key, in plain view, which can be used to help decrypt messages from the AS.|The supplicant must also possess the CA certificate just so that it can validate the one it receives from the AS. The certificate is also used to pass a public key, in plain view, which can be used to help decrypt messages from the AS.
|
Notice that only the AS has a certificate for PEAP. That means the supplicant can readily authenticate the AS. The client does not have or use a certificate of its own, so it must be authenticated within the TLS tunnel using one of the following two methods:|Notice that only the AS has a certificate for PEAP. That means the supplicant can readily authenticate the AS. The client does not have or use a certificate of its own, so it must be authenticated within the TLS tunnel using one of the following two methods:
###### MSCHAPv2: Microsoft Challenge Authentication Protocol version 2
MSCHAPv2: Microsoft Challenge Authentication Protocol version 2   
###### GTC: Generic Token Card; a hardware device that generates one-time passwords for the
GTC: Generic Token Card; a hardware device that generates one-time passwords for the   
__|__
--|--
|
user or a manually generated password|user or a manually generated password
##### EAP-TLS
EAP-TLS   
__|__
--|--
|
PEAP leverages a digital certificate on the AS as a robust method to authenticate the RADIUS server.|PEAP leverages a digital certificate on the AS as a robust method to authenticate the RADIUS server.
It is easy to obtain and install a certificate on a single server, but the clients are left to identify themselves through other means.|It is easy to obtain and install a certificate on a single server, but the clients are left to identify themselves through other means.
EAP Transport Layer Security (EAPTLS)|EAP Transport Layer Security (EAPTLS)
|
goes one step further by requiring certificates on the AS and on every client device.|goes one step further by requiring certificates on the AS and on every client device.
|
With EAP-TLS, the AS and the supplicant exchange certificates and can authenticate each other.|With EAP-TLS, the AS and the supplicant exchange certificates and can authenticate each other.
A TLS tunnel is built afterward so that encryption key material can be securely exchanged.|A TLS tunnel is built afterward so that encryption key material can be securely exchanged.
|
EAP-TLS is considered to be the most secure wireless authentication method available;|EAP-TLS is considered to be the most secure wireless authentication method available;
|
however, implementing it can sometimes be complex.|however, implementing it can sometimes be complex.
Along with the AS, each wireless client must obtain and install a certificate.|Along with the AS, each wireless client must obtain and install a certificate.
Manually installing certificates on hundreds or thousands of clients can be impractical.|Manually installing certificates on hundreds or thousands of clients can be impractical.
Instead, you would need to implement a Public Key Infrastructure (PKI) that could supply certificates securely and efficiently and revoke them when a client or user should no longer have access to the network.|Instead, you would need to implement a Public Key Infrastructure (PKI) that could supply certificates securely and efficiently and revoke them when a client or user should no longer have access to the network.
This usually involves setting up your own CA or building a trust relationship with a third-party CA that can supply certificates to your clients.|This usually involves setting up your own CA or building a trust relationship with a third-party CA that can supply certificates to your clients.
|
NOTE EAP-TLS is practical only if the wireless clients can accept and use digital certificates.|NOTE EAP-TLS is practical only if the wireless clients can accept and use digital certificates.
|
Many wireless devices, such as communicators, medical devices, and RFID tags, have an underlying operating system that cannot interface with a CA or use certificates.|Many wireless devices, such as communicators, medical devices, and RFID tags, have an underlying operating system that cannot interface with a CA or use certificates.
### Wireless Privacy and Integrity Methods
Wireless Privacy and Integrity Methods   
__|__
--|--
|
The original 802.11 standard supported only one method to secure wireless data from eavesdroppers:|The original 802.11 standard supported only one method to secure wireless data from eavesdroppers:
|
WEP. As you have learned in this chapter, WEP has been compromised, deprecated, and can no longer be recommended.|WEP. As you have learned in this chapter, WEP has been compromised, deprecated, and can no longer be recommended.
What other options are available to encrypt data and protect its integrity as it travels through free space?|What other options are available to encrypt data and protect its integrity as it travels through free space?
#### TKIP
TKIP   
__|__
--|--
|
During the time when WEP was embedded in wireless client and AP hardware, yet was known to be vulnerable, the Temporal Key Integrity Protocol (TKIP) was developed.|During the time when WEP was embedded in wireless client and AP hardware, yet was known to be vulnerable, the Temporal Key Integrity Protocol (TKIP) was developed.
|
TKIP adds the following security features using legacy hardware and the underlying WEP encryption:|TKIP adds the following security features using legacy hardware and the underlying WEP encryption:
###### MIC: This efficient algorithm adds a hash value to each frame as a message integrity
MIC: This efficient algorithm adds a hash value to each frame as a message integrity   
__|__
--|--
|
check to prevent tampering; commonly called “Michael” as an informal reference to MIC.|check to prevent tampering; commonly called “Michael” as an informal reference to MIC.
###### Time stamp: A time stamp is added into the MIC to prevent replay attacks that attempt
Time stamp: A time stamp is added into the MIC to prevent replay attacks that attempt   
__|__
--|--
|
to reuse or replay frames that have already been sent.|to reuse or replay frames that have already been sent.
###### Sender’s MAC address: The MIC also includes the sender’s MAC address as evidence of
Sender’s MAC address: The MIC also includes the sender’s MAC address as evidence of   
__|__
--|--
|
the frame source.|the frame source.
###### TKIP sequence counter: This feature provides a record of frames sent by a unique MAC
TKIP sequence counter: This feature provides a record of frames sent by a unique MAC   
__|__
--|--
|
address, to prevent frames from being replayed as an attack.|address, to prevent frames from being replayed as an attack.
###### Key mixing algorithm: This algorithm computes a unique 128-bit WEP key for each
Key mixing algorithm: This algorithm computes a unique 128-bit WEP key for each   
__|__
--|--
|
frame.|frame.
###### Longer initialization vector (IV): The IV size is doubled from 24 to 48 bits, making it virtually
Longer initialization vector (IV): The IV size is doubled from 24 to 48 bits, making it virtually   
__|__
--|--
|
impossible to exhaust all WEP keys by brute-force calculation.|impossible to exhaust all WEP keys by brute-force calculation.
|
TKIP became a reasonably secure stopgap security method, buying time until the 802.11i standard could be ratified.|TKIP became a reasonably secure stopgap security method, buying time until the 802.11i standard could be ratified.
Some attacks have been created against TKIP, so it, too, should be avoided if a better method is available.|Some attacks have been created against TKIP, so it, too, should be avoided if a better method is available.
In fact, TKIP was deprecated in the 802.11-2012 standard.|In fact, TKIP was deprecated in the 802.11-2012 standard.
#### CCMP
CCMP   
__|__
--|--
|
The Counter/CBC-MAC Protocol (CCMP) is considered to be more secure than TKIP.|The Counter/CBC-MAC Protocol (CCMP) is considered to be more secure than TKIP.
|
CCMP consists of two algorithms:|CCMP consists of two algorithms:
###### AES counter mode encryption
AES counter mode encryption   
###### Cipher Block Chaining Message Authentication Code (CBC-MAC) used as a message
Cipher Block Chaining Message Authentication Code (CBC-MAC) used as a message   
__|__
--|--
|
integrity check (MIC)|integrity check (MIC)
|
The Advanced Encryption Standard (AES) is the current encryption algorithm adopted by U.S.|The Advanced Encryption Standard (AES) is the current encryption algorithm adopted by U.S.
National Institute of Standards and Technology (NIST) and the U.S. government, and widely used around the world.|National Institute of Standards and Technology (NIST) and the U.S. government, and widely used around the world.
In other words, AES is open, publicly accessible, and represents the most secure encryption method available today.|In other words, AES is open, publicly accessible, and represents the most secure encryption method available today.
|
Before CCMP can be used to secure a wireless network, the client devices and APs must support the AES counter mode and CBC-MAC in hardware.|Before CCMP can be used to secure a wireless network, the client devices and APs must support the AES counter mode and CBC-MAC in hardware.
CCMP cannot be used on legacy devices that support only WEP or TKIP. How can you know if a device supports CCMP?|CCMP cannot be used on legacy devices that support only WEP or TKIP. How can you know if a device supports CCMP?
|
Look for the WPA2 designation, which is described in the following section.|Look for the WPA2 designation, which is described in the following section.
#### GCMP
GCMP   
__|__
--|--
|
The Galois/Counter Mode Protocol (GCMP) is a robust authenticated encryption suite that is more secure and more efficient than CCMP. GCMP consists of two algorithms:|The Galois/Counter Mode Protocol (GCMP) is a robust authenticated encryption suite that is more secure and more efficient than CCMP. GCMP consists of two algorithms:
###### AES counter mode encryption
AES counter mode encryption   
###### Galois Message Authentication Code (GMAC) used as a message integrity check (MIC)
Galois Message Authentication Code (GMAC) used as a message integrity check (MIC)   
__|__
--|--
|
GCMP is used in WPA3, which is described in the following section.|GCMP is used in WPA3, which is described in the following section.
### WPA, WPA2, and WPA3
WPA, WPA2, and WPA3   
__|__
--|--
|
This chapter covers a variety of authentication methods and encryption and message integrity algorithms.|This chapter covers a variety of authentication methods and encryption and message integrity algorithms.
When it comes time to configure a WLAN with wireless security, should you try to select some combination of schemes based on which one is best or which one is not deprecated?|When it comes time to configure a WLAN with wireless security, should you try to select some combination of schemes based on which one is best or which one is not deprecated?
Which authentication methods are compatible with which encryption algorithms?|Which authentication methods are compatible with which encryption algorithms?
|
The Wi-Fi Alliance (http://wi-fi.org), a nonprofit wireless industry association, has worked out straightforward ways to do that through its Wi-Fi Protected Access (WPA) industry certifications.|The Wi-Fi Alliance (http://wi-fi.org), a nonprofit wireless industry association, has worked out straightforward ways to do that through its Wi-Fi Protected Access (WPA) industry certifications.
To date, there are three different versions: WPA, WPA2, and WPA3. Wireless products are tested in authorized testing labs against stringent criteria that represent correct implementation of a standard.|To date, there are three different versions: WPA, WPA2, and WPA3. Wireless products are tested in authorized testing labs against stringent criteria that represent correct implementation of a standard.
As long as the Wi-Fi Alliance has certified a wireless client device and an AP and its associated WLC for the same WPA version, they should be compatible and offer the same security components.|As long as the Wi-Fi Alliance has certified a wireless client device and an AP and its associated WLC for the same WPA version, they should be compatible and offer the same security components.
|
The Wi-Fi Alliance introduced its first generation WPA certification (known simply as WPA and not WPA1) while the IEEE 802.11i amendment for best practice security methods was still being developed.|The Wi-Fi Alliance introduced its first generation WPA certification (known simply as WPA and not WPA1) while the IEEE 802.11i amendment for best practice security methods was still being developed.
WPA was based on parts of 802.11i and included 802.1x authentication, TKIP, and a method for dynamic encryption key management.|WPA was based on parts of 802.11i and included 802.1x authentication, TKIP, and a method for dynamic encryption key management.
|
Once 802.11i was ratified and published, the Wi-Fi Alliance included it in full in its WPA Version 2 (WPA2) certification.|Once 802.11i was ratified and published, the Wi-Fi Alliance included it in full in its WPA Version 2 (WPA2) certification.
WPA2 is based around the superior AES CCMP algorithms, rather than the deprecated TKIP from WPA. It should be obvious that WPA2 was meant as a replacement for WPA.|WPA2 is based around the superior AES CCMP algorithms, rather than the deprecated TKIP from WPA. It should be obvious that WPA2 was meant as a replacement for WPA.
|
In 2018, the Wi-Fi Alliance introduced WPA Version 3 (WPA3) as a future replacement for WPA2, adding several important and superior security mechanisms.|In 2018, the Wi-Fi Alliance introduced WPA Version 3 (WPA3) as a future replacement for WPA2, adding several important and superior security mechanisms.
WPA3 leverages stronger encryption by AES with the Galois/Counter Mode Protocol (GCMP). It also uses Protected Management Frames (PMF) to secure important 802.11 management frames between APs and clients, to prevent malicious activity that might spoof or tamper with a BSS’s operation.|WPA3 leverages stronger encryption by AES with the Galois/Counter Mode Protocol (GCMP). It also uses Protected Management Frames (PMF) to secure important 802.11 management frames between APs and clients, to prevent malicious activity that might spoof or tamper with a BSS’s operation.
|
Table 28-2 summarizes the basic differences between WPA, WPA2, and WPA3. Each successive version is meant to replace prior versions by offering better security features.|Table 28-2 summarizes the basic differences between WPA, WPA2, and WPA3. Each successive version is meant to replace prior versions by offering better security features.
You should avoid using WPA and use WPA2 instead—at least until WPA3 becomes widely available on wireless client devices, APs, and WLCs.|You should avoid using WPA and use WPA2 instead—at least until WPA3 becomes widely available on wireless client devices, APs, and WLCs.
|
Table 28-2 Comparing WPA, WPA2, and WPA3 Table end.|Table 28-2 Comparing WPA, WPA2, and WPA3 Table end.
|
1 WPA3 includes other features beyond WPA and WPA2, such as Simultaneous Authentication of Equals (SAE), Forward secrecy, and Protected management frames (PMF).|1 WPA3 includes other features beyond WPA and WPA2, such as Simultaneous Authentication of Equals (SAE), Forward secrecy, and Protected management frames (PMF).
|
Notice that all three WPA versions support two client authentication modes: a pre-shared key (PSK) or 802.1x, based on the scale of the deployment.|Notice that all three WPA versions support two client authentication modes: a pre-shared key (PSK) or 802.1x, based on the scale of the deployment.
These are also known as personal mode and enterprise mode, respectively.|These are also known as personal mode and enterprise mode, respectively.
With personal mode, a key string must be shared or configured on every client and AP before the clients can connect to the wireless network.|With personal mode, a key string must be shared or configured on every client and AP before the clients can connect to the wireless network.
The pre-shared key is normally kept confidential so that unauthorized users have no knowledge of it.|The pre-shared key is normally kept confidential so that unauthorized users have no knowledge of it.
The key string is never sent over the air.|The key string is never sent over the air.
Instead, clients and APs work through a four-way handshake procedure that uses the pre-shared key string to construct and exchange encryption key material that can be openly exchanged.|Instead, clients and APs work through a four-way handshake procedure that uses the pre-shared key string to construct and exchange encryption key material that can be openly exchanged.
Once that process is successful, the AP can authenticate the client and the two can secure data frames that are sent over the air.|Once that process is successful, the AP can authenticate the client and the two can secure data frames that are sent over the air.
|
With WPA-Personal and WPA2-Personal modes, a malicious user can eavesdrop and capture the four-way handshake between a client and an AP. That user can then use a dictionary attack to automate guessing the pre-shared key.|With WPA-Personal and WPA2-Personal modes, a malicious user can eavesdrop and capture the four-way handshake between a client and an AP. That user can then use a dictionary attack to automate guessing the pre-shared key.
If he is successful, he can then decrypt the wireless data or even join the network posing as a legitimate user.|If he is successful, he can then decrypt the wireless data or even join the network posing as a legitimate user.
|
WPA3-Personal avoids such an attack by strengthening the key exchange between clients and APs through a method known as Simultaneous Authentication of Equals (SAE). Rather than a client authenticating against a server or AP, the client and AP can initiate the authentication process equally and even simultaneously.|WPA3-Personal avoids such an attack by strengthening the key exchange between clients and APs through a method known as Simultaneous Authentication of Equals (SAE). Rather than a client authenticating against a server or AP, the client and AP can initiate the authentication process equally and even simultaneously.
|
Even if a password or key is compromised, WPA3-Personal offers forward secrecy, which prevents attackers from being able to use a key to unencrypt data that has already been transmitted over the air.|Even if a password or key is compromised, WPA3-Personal offers forward secrecy, which prevents attackers from being able to use a key to unencrypt data that has already been transmitted over the air.
|
NOTE The Personal mode of any WPA version is usually easy to deploy in a small environment or with clients that are embedded in certain devices because a simple text key string is all that is needed to authenticate the clients.|NOTE The Personal mode of any WPA version is usually easy to deploy in a small environment or with clients that are embedded in certain devices because a simple text key string is all that is needed to authenticate the clients.
Be aware that every device using the WLAN must be configured with an identical pre-shared key.|Be aware that every device using the WLAN must be configured with an identical pre-shared key.
If you ever need to update or change the key, you must touch every device to do so.|If you ever need to update or change the key, you must touch every device to do so.
As well, the pre-shared key should remain a well kept secret; you should never divulge the pre-shared key to any unauthorized person.|As well, the pre-shared key should remain a well kept secret; you should never divulge the pre-shared key to any unauthorized person.
|
Notice from Table 28-2 that WPA, WPA2, and WPA3 also support 802.1x or enterprise authentication.|Notice from Table 28-2 that WPA, WPA2, and WPA3 also support 802.1x or enterprise authentication.
This implies EAP-based authentication, but the WPA versions do not require any specific EAP method.|This implies EAP-based authentication, but the WPA versions do not require any specific EAP method.
Instead, the Wi-Fi Alliance certifies interoperability with wellknown EAP methods like EAP-TLS, PEAP, EAP-TTLS, and EAP-SIM. Enterprise authentication is more complex to deploy than personal mode because authentication servers must be set up and configured as a critical enterprise resource.|Instead, the Wi-Fi Alliance certifies interoperability with wellknown EAP methods like EAP-TLS, PEAP, EAP-TTLS, and EAP-SIM. Enterprise authentication is more complex to deploy than personal mode because authentication servers must be set up and configured as a critical enterprise resource.
|
NOTE The Wi-Fi Alliance has made wireless security configuration straightforward and consistent through its WPA, WPA2, and WPA3 certifications.|NOTE The Wi-Fi Alliance has made wireless security configuration straightforward and consistent through its WPA, WPA2, and WPA3 certifications.
Each version is meant to replace its predecessors because of improved security mechanisms.|Each version is meant to replace its predecessors because of improved security mechanisms.
You should always select the highest WPA version that the clients and wireless infrastructure in your environment will support.|You should always select the highest WPA version that the clients and wireless infrastructure in your environment will support.
### Chapter Review
Chapter Review   
__|__
--|--
|
At this point in the chapter, you might still be a little overwhelmed with the number of acronyms and security terms to learn and keep straight in your mind.|At this point in the chapter, you might still be a little overwhelmed with the number of acronyms and security terms to learn and keep straight in your mind.
Spend some time reviewing Table 28-3, which lists all of the topics described in this chapter.|Spend some time reviewing Table 28-3, which lists all of the topics described in this chapter.
The table is organized in a way that should help you remember how the acronyms and functions are grouped together.|The table is organized in a way that should help you remember how the acronyms and functions are grouped together.
|
Remember that an effective wireless security strategy includes a method to authenticate clients and a method to provide data privacy and integrity.|Remember that an effective wireless security strategy includes a method to authenticate clients and a method to provide data privacy and integrity.
These two types of methods are listed in the leftmost column.|These two types of methods are listed in the leftmost column.
Work your way to the right to remember what types of authentication and privacy/integrity are available.|Work your way to the right to remember what types of authentication and privacy/integrity are available.
The table also expands the name of each acronym as a memory tool.|The table also expands the name of each acronym as a memory tool.
|
Also remember that WPA, WPA2, and WPA3 simplify wireless network configuration and compatibility because they limit which authentication and privacy/integrity methods can be used.|Also remember that WPA, WPA2, and WPA3 simplify wireless network configuration and compatibility because they limit which authentication and privacy/integrity methods can be used.
|
Table 28-3 Review of Wireless Security Mechanisms and Options Table end.|Table 28-3 Review of Wireless Security Mechanisms and Options Table end.
|
You should also review this chapter’s material using either the tools in the book or the interactive tools for the same material found on the book’s companion website.|You should also review this chapter’s material using either the tools in the book or the interactive tools for the same material found on the book’s companion website.
Table 28-4 outlines the key review elements and where you can find them.|Table 28-4 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 28-4 Chapter Review Tracking Table end.|Table 28-4 Chapter Review Tracking Table end.
|
Review All the Key Topics Review the most important topics in this chapter, noted with the Key Topic icon in the outer margin of the page.|Review All the Key Topics Review the most important topics in this chapter, noted with the Key Topic icon in the outer margin of the page.
Table 28-5 lists a reference of these key topics and the page numbers on which each is found.|Table 28-5 lists a reference of these key topics and the page numbers on which each is found.
|
Key Terms You Should Know 802.1x, authentication server (AS), authenticator, certificate authority (CA), Counter/CBCMAC Protocol (CCMP), EAP Flexible Authentication by Secure Tunneling (EAP-FAST), EAP Transport Layer Security (EAP-TLS), enterprise mode, Extensible Authentication Protocol (EAP), forward secrecy, Galois/Counter Mode Protocol (GCMP), Lightweight EAP (LEAP), message integrity check (MIC), open authentication, personal mode, protected access credential (PAC), Protected EAP (PEAP), Protected Management Frame (PMF), Public Key Infrastructure (PKI), RADIUS server, Simultaneous Authentication of Equals (SAE), supplicant, Temporal Key Integrity Protocol (TKIP), Wired Equivalent Privacy (WEP), Wi-Fi Protected Access (WPA), WPA Version 2 (WPA2), WPA Version 3 (WPA3)|Key Terms You Should Know 802.1x, authentication server (AS), authenticator, certificate authority (CA), Counter/CBCMAC Protocol (CCMP), EAP Flexible Authentication by Secure Tunneling (EAP-FAST), EAP Transport Layer Security (EAP-TLS), enterprise mode, Extensible Authentication Protocol (EAP), forward secrecy, Galois/Counter Mode Protocol (GCMP), Lightweight EAP (LEAP), message integrity check (MIC), open authentication, personal mode, protected access credential (PAC), Protected EAP (PEAP), Protected Management Frame (PMF), Public Key Infrastructure (PKI), RADIUS server, Simultaneous Authentication of Equals (SAE), supplicant, Temporal Key Integrity Protocol (TKIP), Wired Equivalent Privacy (WEP), Wi-Fi Protected Access (WPA), WPA Version 2 (WPA2), WPA Version 3 (WPA3)
## Chapter 29 Building a Wireless LAN
Chapter 29 Building a Wireless LAN   
__|__
--|--
|
This chapter covers the following exam topics:|This chapter covers the following exam topics:
###### 2.0 Network Access
2.0 Network Access   
###### 2.7 Describe physical infrastructure connections of WLAN components (AP, WLC,
2.7 Describe physical infrastructure connections of WLAN components (AP, WLC,   
__|__
--|--
|
access/trunk ports, and LAG)|access/trunk ports, and LAG)
###### 2.8 Describe AP and WLC management access connections (Telnet, SSH, HTTP, HTTPS,
2.8 Describe AP and WLC management access connections (Telnet, SSH, HTTP, HTTPS,   
__|__
--|--
|
console, and TACACS+/RADIUS)|console, and TACACS+/RADIUS)
###### 2.9 Configure the components of a wireless LAN access for client connectivity using GUI
2.9 Configure the components of a wireless LAN access for client connectivity using GUI   
__|__
--|--
|
only, such as WLAN creation, security settings, QoS profiles, and advanced WLAN settings|only, such as WLAN creation, security settings, QoS profiles, and advanced WLAN settings
###### 5.0 Security Fundamentals
5.0 Security Fundamentals   
###### 5.10 Configure WLAN using WPA2 PSK using the GUI
5.10 Configure WLAN using WPA2 PSK using the GUI   
__|__
--|--
|
In Chapters 26 through 28, you learned about the fundamentals of wireless networks.|In Chapters 26 through 28, you learned about the fundamentals of wireless networks.
As a CCNA, you will also need to know how to apply that knowledge toward building a functioning network with APs and a WLC.|As a CCNA, you will also need to know how to apply that knowledge toward building a functioning network with APs and a WLC.
|
In addition, based on the concepts you learned in Chapter 28, “Securing Wireless Networks,”|In addition, based on the concepts you learned in Chapter 28, “Securing Wireless Networks,”
|
you will be able to configure the WLAN to use WPA2-Personal.|you will be able to configure the WLAN to use WPA2-Personal.
### “Do I Know This Already?” Quiz
“Do I Know This Already?” Quiz   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.
The letter answers are listed at the bottom of the page following the quiz.|The letter answers are listed at the bottom of the page following the quiz.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.
You can also find both answers and explanations in the PTP testing software.|You can also find both answers and explanations in the PTP testing software.
|
Table 29-1 “Do I Know This Already?” Section-to-Question Mapping|Table 29-1 “Do I Know This Already?” Section-to-Question Mapping
### Foundation Topics
Foundation Topics   
### Connecting a Cisco AP
Connecting a Cisco AP   
### Accessing a Cisco WLC
Accessing a Cisco WLC   
### Connecting a Cisco WLC
Connecting a Cisco WLC   
__|__
--|--
|
Configuring a WLAN 6–8 CHAPTER 29 1.|Configuring a WLAN 6–8 CHAPTER 29 1.
Suppose you need to connect a lightweight AP to a network.|Suppose you need to connect a lightweight AP to a network.
Which one of the following link types would be necessary?|Which one of the following link types would be necessary?
|
a. Access mode link b.|a. Access mode link b.
Trunk mode link c.|Trunk mode link c.
LAG mode link d.|LAG mode link d.
EtherChannel link 2.|EtherChannel link 2.
An autonomous AP will be configured to support three WLANs that correspond to three VLANs. The AP will connect to the network over which one of the following?|An autonomous AP will be configured to support three WLANs that correspond to three VLANs. The AP will connect to the network over which one of the following?
|
a. Access mode link b.|a. Access mode link b.
Trunk mode link c.|Trunk mode link c.
LAG mode link d.|LAG mode link d.
EtherChannel link 3.|EtherChannel link 3.
Suppose you would like to connect to a WLC to configure a new WLAN on it.|Suppose you would like to connect to a WLC to configure a new WLAN on it.
Which one of the following is a valid method to use?|Which one of the following is a valid method to use?
|
a. SSH b.|a. SSH b.
HTTPS c.|HTTPS c.
HTTP d.|HTTP d.
All of these answers are correct.|All of these answers are correct.
|
4. Which one of the following correctly describes the single logical link formed by bundling all of a controller’s distribution system ports together?|4. Which one of the following correctly describes the single logical link formed by bundling all of a controller’s distribution system ports together?
|
a. PHY b.|a. PHY b.
DSP c.|DSP c.
LAG d.|LAG d.
GEC 5.|GEC 5.
Which one of the following controller interfaces maps a WLAN to a VLAN?|Which one of the following controller interfaces maps a WLAN to a VLAN?
|
a. Bridge interface b.|a. Bridge interface b.
Virtual interface c.|Virtual interface c.
WLAN interface d.|WLAN interface d.
Dynamic interface 6.|Dynamic interface 6.
Which two of the following things are bound together when a new WLAN is created?|Which two of the following things are bound together when a new WLAN is created?
|
a. VLAN b.|a. VLAN b.
AP c.|AP c.
Controller interface d.|Controller interface d.
SSID 7.|SSID 7.
What is the maximum number of WLANs you can configure on a Cisco wireless controller?|What is the maximum number of WLANs you can configure on a Cisco wireless controller?
|
a. 8 b. 16 c. 512 d. 1024 8.|a. 8 b. 16 c. 512 d. 1024 8.
Which of the following parameters are necessary when creating a new WLAN with the controller GUI? (Choose all that apply.)|Which of the following parameters are necessary when creating a new WLAN with the controller GUI? (Choose all that apply.)
|
a. SSID b.|a. SSID b.
VLAN number c.|VLAN number c.
Interface d.|Interface d.
BSSID e.|BSSID e.
IP subnet Foundation Topics Connecting a Cisco AP A Cisco wireless network can consist of autonomous APs or lightweight APs that are coupled with one or more wireless LAN controllers.|IP subnet Foundation Topics Connecting a Cisco AP A Cisco wireless network can consist of autonomous APs or lightweight APs that are coupled with one or more wireless LAN controllers.
Both types of APs are covered in Chapter 27, “Analyzing Cisco Wireless Architectures,” from a functional perspective.|Both types of APs are covered in Chapter 27, “Analyzing Cisco Wireless Architectures,” from a functional perspective.
You should also understand how to connect the wired side of each type of AP so that it can pass traffic between the appropriate VLANs and WLANs.|You should also understand how to connect the wired side of each type of AP so that it can pass traffic between the appropriate VLANs and WLANs.
|
Recall that an autonomous AP is a standalone device; nothing else is needed to forward Ethernet frames from a wired VLAN to a wireless LAN, and vice versa.|Recall that an autonomous AP is a standalone device; nothing else is needed to forward Ethernet frames from a wired VLAN to a wireless LAN, and vice versa.
In effect, the AP maps each VLAN to a WLAN and BSS. The autonomous AP has a single wired Ethernet interface, as shown in the left portion of Figure 29-1, which means that multiple VLANs must be brought to it over a trunk link.|In effect, the AP maps each VLAN to a WLAN and BSS. The autonomous AP has a single wired Ethernet interface, as shown in the left portion of Figure 29-1, which means that multiple VLANs must be brought to it over a trunk link.
|
NOTE A switch port providing a wired connection to an AP must be configured to support either access or trunk mode.|NOTE A switch port providing a wired connection to an AP must be configured to support either access or trunk mode.
In trunk mode, 802.1Q encapsulation tags each frame according to the VLAN number it came from.|In trunk mode, 802.1Q encapsulation tags each frame according to the VLAN number it came from.
The wireless side of an AP inherently trunks 802.11 frames by marking them with the BSSID of the WLAN where they belong.|The wireless side of an AP inherently trunks 802.11 frames by marking them with the BSSID of the WLAN where they belong.
|
A lightweight AP also has a single wired Ethernet interface; however, it must be paired with a WLC to be fully functional.|A lightweight AP also has a single wired Ethernet interface; however, it must be paired with a WLC to be fully functional.
Wired VLANs that terminate at the WLC can be mapped to WLANs that emerge at the AP. Even though multiple VLANs are being extended from the WLC to the AP, they are all carried over the CAPWAP tunnel between the two.|Wired VLANs that terminate at the WLC can be mapped to WLANs that emerge at the AP. Even though multiple VLANs are being extended from the WLC to the AP, they are all carried over the CAPWAP tunnel between the two.
That means the AP needs only an access link to connect to the network infrastructure and terminate its end of the tunnel, as shown in the right portion of Figure 29-1.|That means the AP needs only an access link to connect to the network infrastructure and terminate its end of the tunnel, as shown in the right portion of Figure 29-1.
|
Figure 29-1 Comparing Connections to Autonomous and Lightweight APs To configure and manage Cisco APs, you can connect a serial console cable from your PC to the console port on the AP. Once the AP is operational and has an IP address, you can also use Telnet or SSH to connect to its CLI over the wired network.|Figure 29-1 Comparing Connections to Autonomous and Lightweight APs To configure and manage Cisco APs, you can connect a serial console cable from your PC to the console port on the AP. Once the AP is operational and has an IP address, you can also use Telnet or SSH to connect to its CLI over the wired network.
Autonomous APs support browser-based management sessions via HTTP and HTTPS. You can manage lightweight APs from a browser session to the WLC.|Autonomous APs support browser-based management sessions via HTTP and HTTPS. You can manage lightweight APs from a browser session to the WLC.
|
Accessing a Cisco WLC To connect and configure a WLC, you will need to open a web browser to the WLC’s management address with either HTTP or HTTPS. This can be done only after the WLC has an initial configuration and a management IP address assigned to its management interface.|Accessing a Cisco WLC To connect and configure a WLC, you will need to open a web browser to the WLC’s management address with either HTTP or HTTPS. This can be done only after the WLC has an initial configuration and a management IP address assigned to its management interface.
The web-based GUI provides an effective way to monitor, configure, and troubleshoot a wireless network.|The web-based GUI provides an effective way to monitor, configure, and troubleshoot a wireless network.
You can also connect to a WLC with an SSH session, where you can use its CLI to monitor, configure, and debug activity.|You can also connect to a WLC with an SSH session, where you can use its CLI to monitor, configure, and debug activity.
|
Both the web-based GUI and the CLI require management users to log in.|Both the web-based GUI and the CLI require management users to log in.
Users can be authenticated against an internal list of local usernames or against an authentication, authorization, and accounting (AAA) server, such as TACACS+ or RADIUS.|Users can be authenticated against an internal list of local usernames or against an authentication, authorization, and accounting (AAA) server, such as TACACS+ or RADIUS.
|
When you first open a web browser to the management address, you will see the initial login screen.|When you first open a web browser to the management address, you will see the initial login screen.
Click on the Login button, as shown in Figure 29-2; then enter your user credentials as you are prompted for them.|Click on the Login button, as shown in Figure 29-2; then enter your user credentials as you are prompted for them.
|
Figure 29-2 Accessing a WLC with a Web Browser NOTE The CCNA exam objectives focus on using the WLC GUI to configure a WLAN and a security suite.|Figure 29-2 Accessing a WLC with a Web Browser NOTE The CCNA exam objectives focus on using the WLC GUI to configure a WLAN and a security suite.
Therefore, the examples in this section assume that someone has already entered an initial configuration to give the WLC a working IP address for management.|Therefore, the examples in this section assume that someone has already entered an initial configuration to give the WLC a working IP address for management.
|
When you are successfully logged in, the WLC will display a monitoring dashboard similar to the one shown in Figure 29-3.|When you are successfully logged in, the WLC will display a monitoring dashboard similar to the one shown in Figure 29-3.
You will not be able to make any configuration changes there, so you must click on the Advanced link in the upper-right corner.|You will not be able to make any configuration changes there, so you must click on the Advanced link in the upper-right corner.
This will bring up the full WLC GUI, as shown in Figure 29-4.|This will bring up the full WLC GUI, as shown in Figure 29-4.
|
Notice the tabs across the top of the screen in Figure 29-4.|Notice the tabs across the top of the screen in Figure 29-4.
You can select categories of functions from among Monitor, WLANs, Controller, Wireless, Security, and so on.|You can select categories of functions from among Monitor, WLANs, Controller, Wireless, Security, and so on.
As you select one of these categories, the vertical list of functions at the left side of the screen will change accordingly.|As you select one of these categories, the vertical list of functions at the left side of the screen will change accordingly.
You can expand the list entries if needed and select one to work on.|You can expand the list entries if needed and select one to work on.
The main screen area will display all of the relevant fields and options you can edit as you make configuration changes.|The main screen area will display all of the relevant fields and options you can edit as you make configuration changes.
You will get a feel for which tabs and list items you should use as you work through the remainder of the chapter.|You will get a feel for which tabs and list items you should use as you work through the remainder of the chapter.
|
Figure 29-3 Accessing the Advanced Configuration Interface Figure 29-4 The Advanced WLC Configuration GUI Connecting a Cisco WLC Connecting a Cisco wireless LAN controller to the network is not quite as straightforward because it has several different types of connections.|Figure 29-3 Accessing the Advanced Configuration Interface Figure 29-4 The Advanced WLC Configuration GUI Connecting a Cisco WLC Connecting a Cisco wireless LAN controller to the network is not quite as straightforward because it has several different types of connections.
From your work with Cisco routers and switches, you probably know that the terms interface and port are usually interchangeable.|From your work with Cisco routers and switches, you probably know that the terms interface and port are usually interchangeable.
|
For example, switches can come in 48-port models, and you apply configuration changes to the corresponding interfaces.|For example, switches can come in 48-port models, and you apply configuration changes to the corresponding interfaces.
Cisco wireless controllers differ a bit; ports and interfaces refer to different concepts.|Cisco wireless controllers differ a bit; ports and interfaces refer to different concepts.
|
Controller ports are physical connections made to an external wired or switched network, whereas interfaces are logical connections made internally within the controller.|Controller ports are physical connections made to an external wired or switched network, whereas interfaces are logical connections made internally within the controller.
The following sections explain each connection type in more detail.|The following sections explain each connection type in more detail.
You will learn more about configuring ports and interfaces in the “Configuring a WLAN” section later in the chapter.|You will learn more about configuring ports and interfaces in the “Configuring a WLAN” section later in the chapter.
#### Using WLC Ports
Using WLC Ports   
__|__
--|--
|
You can connect several different types of controller ports to your network, as shown in Figure 29-5 and discussed in the following list:|You can connect several different types of controller ports to your network, as shown in Figure 29-5 and discussed in the following list:
###### Service port: Used for out-of-band management, system recovery, and initial boot functions;
Service port: Used for out-of-band management, system recovery, and initial boot functions;   
__|__
--|--
|
always connects to a switch port in access mode|always connects to a switch port in access mode
###### Distribution system port: Used for all normal AP and management traffic; usually connects
Distribution system port: Used for all normal AP and management traffic; usually connects   
__|__
--|--
|
to a switch port in 802.1Q trunk mode|to a switch port in 802.1Q trunk mode
###### Console port: Used for out-of-band management, system recovery, and initial boot functions;
Console port: Used for out-of-band management, system recovery, and initial boot functions;   
__|__
--|--
|
asynchronous connection to a terminal emulator (9600 baud, 8 data bits, 1 stop bit, by default)|asynchronous connection to a terminal emulator (9600 baud, 8 data bits, 1 stop bit, by default)
###### Redundancy port: Used to connect to a peer controller for high availability (HA).
Redundancy port: Used to connect to a peer controller for high availability (HA).   
__|__
--|--
|
Figure 29-5 Cisco Wireless LAN Controller Ports Controllers can have a single service port that must be connected to a switched network.|Figure 29-5 Cisco Wireless LAN Controller Ports Controllers can have a single service port that must be connected to a switched network.
|
Usually, the service port is assigned to a management VLAN so that you can access the controller with SSH or a web browser to perform initial configuration or for maintenance.|Usually, the service port is assigned to a management VLAN so that you can access the controller with SSH or a web browser to perform initial configuration or for maintenance.
|
Notice that the service port supports only a single VLAN, so the corresponding switch port must be configured for access mode only.|Notice that the service port supports only a single VLAN, so the corresponding switch port must be configured for access mode only.
|
Controllers also have multiple distribution system ports that you must connect to the network.|Controllers also have multiple distribution system ports that you must connect to the network.
|
These ports carry most of the data coming to and going from the controller.|These ports carry most of the data coming to and going from the controller.
For example, the CAPWAP tunnels (control and data) that extend to each of a controller’s APs pass across the distribution system ports.|For example, the CAPWAP tunnels (control and data) that extend to each of a controller’s APs pass across the distribution system ports.
Client data also passes from wireless LANs to wired VLANs over the ports.|Client data also passes from wireless LANs to wired VLANs over the ports.
In addition, any management traffic using a web browser, SSH, Simple Network Management Protocol (SNMP), Trivial File Transfer Protocol (TFTP), and so on, normally reaches the controller in-band through the ports.|In addition, any management traffic using a web browser, SSH, Simple Network Management Protocol (SNMP), Trivial File Transfer Protocol (TFTP), and so on, normally reaches the controller in-band through the ports.
|
NOTE You might be thinking that distribution system ports is an odd name for what appear to be regular data ports.|NOTE You might be thinking that distribution system ports is an odd name for what appear to be regular data ports.
Recall from the section titled “Wireless LAN Topologies”|Recall from the section titled “Wireless LAN Topologies”
|
in Chapter 26, “Fundamentals of Wireless Networks,” that the wired network that connects APs together is called the distribution system (DS). With the split MAC architecture, the point where APs touch the DS is moved upstream to the WLC instead.|in Chapter 26, “Fundamentals of Wireless Networks,” that the wired network that connects APs together is called the distribution system (DS). With the split MAC architecture, the point where APs touch the DS is moved upstream to the WLC instead.
|
Because the distribution system ports must carry data that is associated with many different VLANs, VLAN tags and numbers become very important.|Because the distribution system ports must carry data that is associated with many different VLANs, VLAN tags and numbers become very important.
For that reason, the distribution system ports always operate in 802.1Q trunking mode.|For that reason, the distribution system ports always operate in 802.1Q trunking mode.
When you connect the ports to a switch, you should also configure the switch ports for unconditional 802.1Q trunk mode.|When you connect the ports to a switch, you should also configure the switch ports for unconditional 802.1Q trunk mode.
|
The distribution system ports can operate independently, each one transporting multiple VLANs to a unique group of internal controller interfaces.|The distribution system ports can operate independently, each one transporting multiple VLANs to a unique group of internal controller interfaces.
For resiliency, you can configure distribution system ports in redundant pairs.|For resiliency, you can configure distribution system ports in redundant pairs.
One port is primarily used; if it fails, a backup port is used instead.|One port is primarily used; if it fails, a backup port is used instead.
|
To get the most use out of each distribution system port, you can configure all of them to operate as a single logical group, much like an EtherChannel or port-channel on a switch.|To get the most use out of each distribution system port, you can configure all of them to operate as a single logical group, much like an EtherChannel or port-channel on a switch.
|
Controller distribution system ports can be configured as a link aggregation group (LAG)|Controller distribution system ports can be configured as a link aggregation group (LAG)
|
such that they are bundled together to act as one larger link.|such that they are bundled together to act as one larger link.
In Figure 29-5, the four distribution system ports are configured as a LAG. With a LAG configuration, traffic can be load-balanced across the individual ports that make up the LAG. In addition, LAG offers resiliency; if one individual port fails, traffic will be redirected to the remaining working ports instead.|In Figure 29-5, the four distribution system ports are configured as a LAG. With a LAG configuration, traffic can be load-balanced across the individual ports that make up the LAG. In addition, LAG offers resiliency; if one individual port fails, traffic will be redirected to the remaining working ports instead.
|
NOTE Be aware that even though the LAG acts as a traditional EtherChannel, Cisco WLCs do not support any link aggregation negotiation protocol, like LACP or PaGP, at all.|NOTE Be aware that even though the LAG acts as a traditional EtherChannel, Cisco WLCs do not support any link aggregation negotiation protocol, like LACP or PaGP, at all.
Therefore, you must configure the switch ports as an unconditional or always-on EtherChannel.|Therefore, you must configure the switch ports as an unconditional or always-on EtherChannel.
#### Using WLC Interfaces
Using WLC Interfaces   
__|__
--|--
|
Through its distribution system ports, a controller can connect to multiple VLANs on the switched network.|Through its distribution system ports, a controller can connect to multiple VLANs on the switched network.
Internally, the controller must somehow map those wired VLANs to equivalent logical wireless networks.|Internally, the controller must somehow map those wired VLANs to equivalent logical wireless networks.
For example, suppose that VLAN 10 is set aside for wireless users in the Engineering division of a company.|For example, suppose that VLAN 10 is set aside for wireless users in the Engineering division of a company.
That VLAN must be connected to a unique wireless LAN that exists on a controller and its associated APs. The wireless LAN must then be extended to every client that associates with the Service Set Identifier (SSID)|That VLAN must be connected to a unique wireless LAN that exists on a controller and its associated APs. The wireless LAN must then be extended to every client that associates with the Service Set Identifier (SSID)
|
“Engineering.”|“Engineering.”
|
Cisco wireless controllers provide the necessary connectivity through internal logical interfaces, which must be configured with an IP address, subnet mask, default gateway, and a Dynamic Host Configuration Protocol (DHCP) server.|Cisco wireless controllers provide the necessary connectivity through internal logical interfaces, which must be configured with an IP address, subnet mask, default gateway, and a Dynamic Host Configuration Protocol (DHCP) server.
Each interface is then assigned to a physical port and a VLAN ID. You can think of an interface as a Layer 3 termination on a VLAN.|Each interface is then assigned to a physical port and a VLAN ID. You can think of an interface as a Layer 3 termination on a VLAN.
|
Cisco controllers support the following interface types, also shown in Figure 29-6.|Cisco controllers support the following interface types, also shown in Figure 29-6.
###### Management interface: Used for normal management traffic, such as RADIUS user
Management interface: Used for normal management traffic, such as RADIUS user   
__|__
--|--
|
authentication, WLC-to-WLC communication, web-based and SSH sessions, SNMP, Network Time Protocol (NTP), syslog, and so on.|authentication, WLC-to-WLC communication, web-based and SSH sessions, SNMP, Network Time Protocol (NTP), syslog, and so on.
The management interface is also used to terminate CAPWAP tunnels between the controller and its APs.|The management interface is also used to terminate CAPWAP tunnels between the controller and its APs.
###### Redundancy management: The management IP address of a redundant WLC that is part
Redundancy management: The management IP address of a redundant WLC that is part   
__|__
--|--
|
of a high availability pair of controllers.|of a high availability pair of controllers.
The active WLC uses the management interface address, while the standby WLC uses the redundancy management address.|The active WLC uses the management interface address, while the standby WLC uses the redundancy management address.
###### Virtual interface: IP address facing wireless clients when the controller is relaying client
Virtual interface: IP address facing wireless clients when the controller is relaying client   
__|__
--|--
|
DHCP requests, performing client web authentication, and supporting client mobility.|DHCP requests, performing client web authentication, and supporting client mobility.
###### Service port interface: Bound to the service port and used for out-of-band management.
Service port interface: Bound to the service port and used for out-of-band management.   
###### Dynamic interface: Used to connect a VLAN to a WLAN.
Dynamic interface: Used to connect a VLAN to a WLAN.   
__|__
--|--
|
Figure 29-6 Cisco Wireless LAN Controller Interfaces The management interface faces the switched network, where management users and APs are located.|Figure 29-6 Cisco Wireless LAN Controller Interfaces The management interface faces the switched network, where management users and APs are located.
Management traffic will usually consist of protocols like HTTPS, SSH, SNMP, NTP, TFTP, and so on.|Management traffic will usually consist of protocols like HTTPS, SSH, SNMP, NTP, TFTP, and so on.
In addition, management interface traffic consists of CAPWAP packets that carry control and data tunnels to and from the APs.|In addition, management interface traffic consists of CAPWAP packets that carry control and data tunnels to and from the APs.
|
The virtual interface is used only for certain client-facing operations.|The virtual interface is used only for certain client-facing operations.
For example, when a wireless client issues a request to obtain an IP address, the controller can relay the request on to an actual DHCP server that can provide the appropriate IP address.|For example, when a wireless client issues a request to obtain an IP address, the controller can relay the request on to an actual DHCP server that can provide the appropriate IP address.
From the client’s perspective, the DHCP server appears to be the controller’s virtual interface address.|From the client’s perspective, the DHCP server appears to be the controller’s virtual interface address.
Clients may see the virtual interface’s address, but that address is never used when the controller communicates with other devices on the switched network.|Clients may see the virtual interface’s address, but that address is never used when the controller communicates with other devices on the switched network.
|
Because the virtual interface is used only for some client management functions, you should configure it with a unique, nonroutable address.|Because the virtual interface is used only for some client management functions, you should configure it with a unique, nonroutable address.
For example, you might use 10.1.1.1 because it is within a private address space defined in RFC 1918.|For example, you might use 10.1.1.1 because it is within a private address space defined in RFC 1918.
|
NOTE Traditionally, many people have assigned IP address 1.1.1.1 to the virtual interface.|NOTE Traditionally, many people have assigned IP address 1.1.1.1 to the virtual interface.
|
Although it is a unique address, it is routable and already in use elsewhere on the Internet.|Although it is a unique address, it is routable and already in use elsewhere on the Internet.
|
A better practice is to use an IP address from the RFC 1918 private address space that is unused or reserved, such as 192.168.1.1.|A better practice is to use an IP address from the RFC 1918 private address space that is unused or reserved, such as 192.168.1.1.
You could also use a reserved address from RFC 5737 (192.0.2.0/24) that is set aside for documentation purposes and is never used.|You could also use a reserved address from RFC 5737 (192.0.2.0/24) that is set aside for documentation purposes and is never used.
|
The virtual interface address is also used to support client mobility.|The virtual interface address is also used to support client mobility.
For that reason, every controller that exists in the same mobility group should be configured with a virtual address that is identical to the others.|For that reason, every controller that exists in the same mobility group should be configured with a virtual address that is identical to the others.
By using one common virtual address, all the controllers will appear to operate as a cluster as clients roam from controller to controller.|By using one common virtual address, all the controllers will appear to operate as a cluster as clients roam from controller to controller.
|
Dynamic interfaces map WLANs to VLANs, making the logical connections between wireless and wired networks.|Dynamic interfaces map WLANs to VLANs, making the logical connections between wireless and wired networks.
You will configure one dynamic interface for each wireless LAN that is offered by the controller’s APs and then map the interface to the WLAN. Each dynamic interface must also be configured with its own IP address and can act as a DHCP relay for wireless clients.|You will configure one dynamic interface for each wireless LAN that is offered by the controller’s APs and then map the interface to the WLAN. Each dynamic interface must also be configured with its own IP address and can act as a DHCP relay for wireless clients.
To filter traffic passing through a dynamic interface, you can configure an optional access list.|To filter traffic passing through a dynamic interface, you can configure an optional access list.
### Configuring a WLAN
Configuring a WLAN   
__|__
--|--
|
A wireless LAN controller and an access point work in concert to provide network connectivity to wireless clients.|A wireless LAN controller and an access point work in concert to provide network connectivity to wireless clients.
From a wireless perspective, the AP advertises a Service Set Identifier (SSID) for the client to join.|From a wireless perspective, the AP advertises a Service Set Identifier (SSID) for the client to join.
From a wired perspective, the controller connects to a virtual LAN (VLAN) through one of its dynamic interfaces.|From a wired perspective, the controller connects to a virtual LAN (VLAN) through one of its dynamic interfaces.
To complete the path between the SSID and the VLAN, as illustrated in Figure 29-7, you must first define a WLAN on the controller.|To complete the path between the SSID and the VLAN, as illustrated in Figure 29-7, you must first define a WLAN on the controller.
|
NOTE Two of the CCNA exam objectives involve configuring a WLAN for client connectivity with WPA2 and a PSK using only the controller GUI. As you work through this section, you will find that it presents a complete WLAN example that is based on the topology shown in Figure 29-7 using the WPA2-Personal (PSK) security model.|NOTE Two of the CCNA exam objectives involve configuring a WLAN for client connectivity with WPA2 and a PSK using only the controller GUI. As you work through this section, you will find that it presents a complete WLAN example that is based on the topology shown in Figure 29-7 using the WPA2-Personal (PSK) security model.
|
Figure 29-7 Connecting Wired and Wireless Networks with a WLAN The controller will bind the WLAN to one of its interfaces and then push the WLAN configuration out to all of its APs by default.|Figure 29-7 Connecting Wired and Wireless Networks with a WLAN The controller will bind the WLAN to one of its interfaces and then push the WLAN configuration out to all of its APs by default.
From that point on, wireless clients will be able to learn about the new WLAN by receiving its beacons and will be able to probe and join the new BSS.|From that point on, wireless clients will be able to learn about the new WLAN by receiving its beacons and will be able to probe and join the new BSS.
|
Like VLANs, you can use WLANs to segregate wireless users and their traffic into logical networks.|Like VLANs, you can use WLANs to segregate wireless users and their traffic into logical networks.
Users associated with one WLAN cannot cross over into another one unless their traffic is bridged or routed from one VLAN to another through the wired network infrastructure.|Users associated with one WLAN cannot cross over into another one unless their traffic is bridged or routed from one VLAN to another through the wired network infrastructure.
|
Before you begin to create new WLANs, it is usually wise to plan your wireless network first.|Before you begin to create new WLANs, it is usually wise to plan your wireless network first.
In a large enterprise, you might have to support a wide variety of wireless devices, user communities, security policies, and so on.|In a large enterprise, you might have to support a wide variety of wireless devices, user communities, security policies, and so on.
You might be tempted to create a new WLAN for every occasion, just to keep groups of users isolated from each other or to support different types of devices.|You might be tempted to create a new WLAN for every occasion, just to keep groups of users isolated from each other or to support different types of devices.
Although that is an appealing strategy, you should be aware of two limitations:|Although that is an appealing strategy, you should be aware of two limitations:
###### Cisco controllers support a maximum of 512 WLANs, but only 16 of them can be actively
Cisco controllers support a maximum of 512 WLANs, but only 16 of them can be actively   
__|__
--|--
|
configured on an AP.|configured on an AP.
###### Advertising each WLAN to potential wireless clients uses up valuable airtime.
Advertising each WLAN to potential wireless clients uses up valuable airtime.   
__|__
--|--
|
Every AP must broadcast beacon management frames at regular intervals to advertise the existence of a BSS. Because each WLAN is bound to a BSS, each WLAN must be advertised with its own beacons.|Every AP must broadcast beacon management frames at regular intervals to advertise the existence of a BSS. Because each WLAN is bound to a BSS, each WLAN must be advertised with its own beacons.
Beacons are normally sent 10 times per second, or once every 100 ms, at the lowest mandatory data rate.|Beacons are normally sent 10 times per second, or once every 100 ms, at the lowest mandatory data rate.
The more WLANs you have created, the more beacons you will need to announce them.|The more WLANs you have created, the more beacons you will need to announce them.
|
Even further, the lower the mandatory data rate, the more time each beacon will take to be transmitted.|Even further, the lower the mandatory data rate, the more time each beacon will take to be transmitted.
The end result is this: if you create too many WLANs, a channel can be starved of any usable airtime.|The end result is this: if you create too many WLANs, a channel can be starved of any usable airtime.
Clients will have a hard time transmitting their own data because the channel is overly busy with beacon transmissions coming from the AP. As a rule of thumb, always limit the number of WLANs to five or fewer; a maximum of three WLANs is best.|Clients will have a hard time transmitting their own data because the channel is overly busy with beacon transmissions coming from the AP. As a rule of thumb, always limit the number of WLANs to five or fewer; a maximum of three WLANs is best.
|
By default, a controller has a limited initial configuration, so no WLANs are defined.|By default, a controller has a limited initial configuration, so no WLANs are defined.
Before you create a new WLAN, think about the following parameters it will need to have:|Before you create a new WLAN, think about the following parameters it will need to have:
###### SSID string
SSID string   
###### Controller interface and VLAN number
Controller interface and VLAN number   
###### Type of wireless security needed
Type of wireless security needed   
__|__
--|--
|
As you work through this section, you will create the appropriate dynamic controller interface to support the new WLAN; then you will enter the necessary WLAN parameters.|As you work through this section, you will create the appropriate dynamic controller interface to support the new WLAN; then you will enter the necessary WLAN parameters.
Each configuration step is performed using a web browser session that is connected to the WLC’s management IP address.|Each configuration step is performed using a web browser session that is connected to the WLC’s management IP address.
#### Step 1. Configure a RADIUS Server
Step 1. Configure a RADIUS Server   
__|__
--|--
|
If your new WLAN will use a security scheme that requires a RADIUS server, such as WPA2-Enterprise or WPA3-Enterprise, you will need to define the server first.|If your new WLAN will use a security scheme that requires a RADIUS server, such as WPA2-Enterprise or WPA3-Enterprise, you will need to define the server first.
Select Security > AAA > RADIUS > Authentication to see a list of servers that have already been configured, as shown in Figure 29-8.|Select Security > AAA > RADIUS > Authentication to see a list of servers that have already been configured, as shown in Figure 29-8.
If multiple servers are defined, the controller will try them in sequential order.|If multiple servers are defined, the controller will try them in sequential order.
Click New to create a new server.|Click New to create a new server.
|
Next, enter the server’s IP address, shared secret key, and port number, as shown in Figure 29-9.|Next, enter the server’s IP address, shared secret key, and port number, as shown in Figure 29-9.
Because the controller already had two other RADIUS servers configured, the server at 192.168.200.30 will be index number 3.|Because the controller already had two other RADIUS servers configured, the server at 192.168.200.30 will be index number 3.
Be sure to set the server status to Enabled so that the controller can begin using it.|Be sure to set the server status to Enabled so that the controller can begin using it.
At the bottom of the page, you can select the type of user that will be authenticated with the server.|At the bottom of the page, you can select the type of user that will be authenticated with the server.
Check Network User to authenticate wireless clients or Management to authenticate wireless administrators that will access the controller’s management functions.|Check Network User to authenticate wireless clients or Management to authenticate wireless administrators that will access the controller’s management functions.
Click Apply to complete the server configuration.|Click Apply to complete the server configuration.
|
Figure 29-8 Displaying the List of RADIUS Authentication Servers Figure 29-9 Configuring a New RADIUS Server|Figure 29-8 Displaying the List of RADIUS Authentication Servers Figure 29-9 Configuring a New RADIUS Server
#### Step 2. Create a Dynamic Interface
Step 2. Create a Dynamic Interface   
__|__
--|--
|
In the “Using WLC Interfaces” section of this chapter, you learned about the different types of controller interfaces.|In the “Using WLC Interfaces” section of this chapter, you learned about the different types of controller interfaces.
A dynamic interface is used to connect the controller to a VLAN on the wired network.|A dynamic interface is used to connect the controller to a VLAN on the wired network.
When you create a WLAN, you will bind the dynamic interface (and VLAN) to a wireless network.|When you create a WLAN, you will bind the dynamic interface (and VLAN) to a wireless network.
|
To create a new dynamic interface, navigate to Controller > Interfaces.|To create a new dynamic interface, navigate to Controller > Interfaces.
You should see a list of all the controller interfaces that are currently configured.|You should see a list of all the controller interfaces that are currently configured.
In Figure 29-10, two interfaces named “management” and “virtual” already exist.|In Figure 29-10, two interfaces named “management” and “virtual” already exist.
Click the New button to define a new interface.|Click the New button to define a new interface.
Enter a name for the interface and the VLAN number it will be bound to.|Enter a name for the interface and the VLAN number it will be bound to.
In Figure 29-11, the interface named Engineering is mapped to wired VLAN 100.|In Figure 29-11, the interface named Engineering is mapped to wired VLAN 100.
Click the Apply button.|Click the Apply button.
|
Figure 29-10 Displaying a List of Dynamic Interfaces Figure 29-11 Defining a Dynamic Interface Name and VLAN ID Next, enter the IP address, subnet mask, and gateway address for the interface.|Figure 29-10 Displaying a List of Dynamic Interfaces Figure 29-11 Defining a Dynamic Interface Name and VLAN ID Next, enter the IP address, subnet mask, and gateway address for the interface.
You should also define primary and secondary DHCP server addresses that the controller will use when it relays DHCP requests from clients that are bound to the interface.|You should also define primary and secondary DHCP server addresses that the controller will use when it relays DHCP requests from clients that are bound to the interface.
Figure 29-12 shows how the interface named Engineering has been configured with IP address 192.168.100.10, subnet mask 255.255.255.0, gateway 192.168.100.1, and DHCP servers 192.168.1.17 and 192.168.1.18.|Figure 29-12 shows how the interface named Engineering has been configured with IP address 192.168.100.10, subnet mask 255.255.255.0, gateway 192.168.100.1, and DHCP servers 192.168.1.17 and 192.168.1.18.
Click the Apply button to complete the interface configuration and return to the list of interfaces.|Click the Apply button to complete the interface configuration and return to the list of interfaces.
|
Figure 29-12 Editing the Dynamic Interface Parameters|Figure 29-12 Editing the Dynamic Interface Parameters
#### Step 3. Create a New WLAN
Step 3. Create a New WLAN   
__|__
--|--
|
You can display a list of the currently defined WLANs by selecting WLANs from the top menu bar.|You can display a list of the currently defined WLANs by selecting WLANs from the top menu bar.
In Figure 29-13, the controller does not have any WLANs already defined.|In Figure 29-13, the controller does not have any WLANs already defined.
You can create a new WLAN by selecting Create New from the drop-down menu and then clicking the Go button.|You can create a new WLAN by selecting Create New from the drop-down menu and then clicking the Go button.
|
Figure 29-13 Displaying a List of WLANs Next, enter a descriptive name as the profile name and the SSID text string.|Figure 29-13 Displaying a List of WLANs Next, enter a descriptive name as the profile name and the SSID text string.
In Figure 29-14, the profile name and SSID are identical, just to keep things straightforward.|In Figure 29-14, the profile name and SSID are identical, just to keep things straightforward.
The ID number is used as an index into the list of WLANs that are defined on the controller.|The ID number is used as an index into the list of WLANs that are defined on the controller.
The ID number becomes useful when you use templates in Prime Infrastructure (PI) to configure WLANs on multiple controllers at the same time.|The ID number becomes useful when you use templates in Prime Infrastructure (PI) to configure WLANs on multiple controllers at the same time.
|
NOTE WLAN templates are applied to specific WLAN ID numbers on controllers.|NOTE WLAN templates are applied to specific WLAN ID numbers on controllers.
The WLAN ID is only locally significant and is not passed between controllers.|The WLAN ID is only locally significant and is not passed between controllers.
As a rule, you should keep the sequence of WLAN names and IDs consistent across multiple controllers so that any configuration templates you use in the future will be applied to the same WLANs on each controller.|As a rule, you should keep the sequence of WLAN names and IDs consistent across multiple controllers so that any configuration templates you use in the future will be applied to the same WLANs on each controller.
|
Figure 29-14 Creating a New WLAN Click the Apply button to create the new WLAN. The next page will allow you to edit four categories of parameters, corresponding to the tabs across the top as shown in Figure 29-15.|Figure 29-14 Creating a New WLAN Click the Apply button to create the new WLAN. The next page will allow you to edit four categories of parameters, corresponding to the tabs across the top as shown in Figure 29-15.
|
By default, the General tab is selected.|By default, the General tab is selected.
|
Figure 29-15 Configuring the General WLAN Parameters You can control whether the WLAN is enabled or disabled with the Status check box.|Figure 29-15 Configuring the General WLAN Parameters You can control whether the WLAN is enabled or disabled with the Status check box.
Even though the General page shows a specific security policy for the WLAN (the default WPA2 with 802.1x), you can make changes in a later step through the Security tab.|Even though the General page shows a specific security policy for the WLAN (the default WPA2 with 802.1x), you can make changes in a later step through the Security tab.
|
Under Radio Policy, select the type of radio that will offer the WLAN. By default, the WLAN will be offered on all radios that are joined with the controller.|Under Radio Policy, select the type of radio that will offer the WLAN. By default, the WLAN will be offered on all radios that are joined with the controller.
You can select a more specific policy with 802.11a only, 802.11a/g only, 802.11g only, or 802.11b/g only.|You can select a more specific policy with 802.11a only, 802.11a/g only, 802.11g only, or 802.11b/g only.
For example, if you are creating a new WLAN for devices that have only a 2.4-GHz radio, it probably does not make sense to advertise the WLAN on both 2.4- and 5-GHz AP radios.|For example, if you are creating a new WLAN for devices that have only a 2.4-GHz radio, it probably does not make sense to advertise the WLAN on both 2.4- and 5-GHz AP radios.
|
Next, select which of the controller’s dynamic interfaces will be bound to the WLAN. By default, the management interface is selected.|Next, select which of the controller’s dynamic interfaces will be bound to the WLAN. By default, the management interface is selected.
The drop-down list contains all the interface names that are available.|The drop-down list contains all the interface names that are available.
In Figure 29-15, the new engineering WLAN will be bound to the Engineering interface.|In Figure 29-15, the new engineering WLAN will be bound to the Engineering interface.
|
Finally, use the Broadcast SSID check box to select whether the APs should broadcast the SSID name in the beacons they transmit.|Finally, use the Broadcast SSID check box to select whether the APs should broadcast the SSID name in the beacons they transmit.
Broadcasting SSIDs is usually more convenient for users because their devices can learn and display the SSID names automatically.|Broadcasting SSIDs is usually more convenient for users because their devices can learn and display the SSID names automatically.
In fact, most devices actually need the SSID in the beacons to understand that the AP is still available for that SSID. Hiding the SSID name, by not broadcasting it, does not really provide any worthwhile security.|In fact, most devices actually need the SSID in the beacons to understand that the AP is still available for that SSID. Hiding the SSID name, by not broadcasting it, does not really provide any worthwhile security.
Instead, it just prevents user devices from discovering an SSID and trying to use it as a default network.|Instead, it just prevents user devices from discovering an SSID and trying to use it as a default network.
#### Configuring WLAN Security
Configuring WLAN Security   
__|__
--|--
|
Select the Security tab to configure the security settings.|Select the Security tab to configure the security settings.
By default, the Layer 2 Security tab is selected.|By default, the Layer 2 Security tab is selected.
From the Layer 2 Security drop-down menu, select the appropriate security scheme to use.|From the Layer 2 Security drop-down menu, select the appropriate security scheme to use.
Table 29-2 lists the types that are available.|Table 29-2 lists the types that are available.
|
Table 29-2 Layer 2 WLAN Security Type Table end.|Table 29-2 Layer 2 WLAN Security Type Table end.
|
As you select a security type, be sure to remember which choices are types that have been deprecated or proven to be weak, and avoid them if possible.|As you select a security type, be sure to remember which choices are types that have been deprecated or proven to be weak, and avoid them if possible.
Further down the screen, you can select which specific WPA, WPA2, and WPA3 methods to support on the WLAN. You can select more than one, if you need to support different types of wireless clients that require several security methods.|Further down the screen, you can select which specific WPA, WPA2, and WPA3 methods to support on the WLAN. You can select more than one, if you need to support different types of wireless clients that require several security methods.
|
In Figure 29-16, WPA+WPA2 has been selected from the pull-down menu; then only WPA2 and AES encryption have been selected.|In Figure 29-16, WPA+WPA2 has been selected from the pull-down menu; then only WPA2 and AES encryption have been selected.
WPA and TKIP have been avoided because they are legacy, deprecated methods.|WPA and TKIP have been avoided because they are legacy, deprecated methods.
Under the Authentication Key Management section, you can select the authentication methods the WLAN will use.|Under the Authentication Key Management section, you can select the authentication methods the WLAN will use.
Only PSK has been selected in the figure, so the WLAN will allow only WPA2-Personal with pre-shared key authentication.|Only PSK has been selected in the figure, so the WLAN will allow only WPA2-Personal with pre-shared key authentication.
|
Figure 29-16 Configuring Layer 2 WLAN Security To use WPA2-Enterprise, the 802.1X option would be selected.|Figure 29-16 Configuring Layer 2 WLAN Security To use WPA2-Enterprise, the 802.1X option would be selected.
In that case, 802.1x and EAP would be used to authenticate wireless clients against one or more RADIUS servers.|In that case, 802.1x and EAP would be used to authenticate wireless clients against one or more RADIUS servers.
The controller would use servers from the global list you have defined under Security > AAA >|The controller would use servers from the global list you have defined under Security > AAA >
|
RADIUS > Authentication, as described in the “Step 1.|RADIUS > Authentication, as described in the “Step 1.
Configure a RADIUS Server” section in this chapter.|Configure a RADIUS Server” section in this chapter.
To specify which servers the WLAN should use, you would select the Security tab and then the AAA Servers tab in the WLAN edit screen.|To specify which servers the WLAN should use, you would select the Security tab and then the AAA Servers tab in the WLAN edit screen.
You can identify up to six specific RADIUS servers in the WLAN configuration.|You can identify up to six specific RADIUS servers in the WLAN configuration.
Beside each server, select a specific server IP address from the drop-down menu of globally defined servers.|Beside each server, select a specific server IP address from the drop-down menu of globally defined servers.
The servers are tried in sequential order until one of them responds.|The servers are tried in sequential order until one of them responds.
Although the example in this chapter uses WPA2-Personal, Figure 29-17 shows what a WLAN configured for WPA2-Enterprise might look like, with servers 1 through 3 being set to 192.168.200.28, 192.168.200.29, and 192.168.200.30, respectively.|Although the example in this chapter uses WPA2-Personal, Figure 29-17 shows what a WLAN configured for WPA2-Enterprise might look like, with servers 1 through 3 being set to 192.168.200.28, 192.168.200.29, and 192.168.200.30, respectively.
|
By default, a controller will contact a RADIUS server from its management interface.|By default, a controller will contact a RADIUS server from its management interface.
You can override this behavior by checking the box next to Radius Server Overwrite Interface so that the controller sources RADIUS requests from the dynamic interface that is associated with the WLAN.|You can override this behavior by checking the box next to Radius Server Overwrite Interface so that the controller sources RADIUS requests from the dynamic interface that is associated with the WLAN.
|
Figure 29-17 Selecting RADIUS Servers for WLAN Authentication|Figure 29-17 Selecting RADIUS Servers for WLAN Authentication
#### Configuring WLAN QoS
Configuring WLAN QoS   
__|__
--|--
|
Select the QoS tab to configure quality of service settings for the WLAN, as shown in Figure 29-18.|Select the QoS tab to configure quality of service settings for the WLAN, as shown in Figure 29-18.
By default, the controller will consider all frames in the WLAN to be normal data, to be handled in a “best effort” manner.|By default, the controller will consider all frames in the WLAN to be normal data, to be handled in a “best effort” manner.
You can set the Quality of Service (QoS) dropdown menu to classify all frames in one of the following ways:|You can set the Quality of Service (QoS) dropdown menu to classify all frames in one of the following ways:
###### Platinum (voice)
Platinum (voice)   
###### Gold (video)
Gold (video)   
###### Silver (best effort)
Silver (best effort)   
###### Bronze (background).
Bronze (background).   
__|__
--|--
|
Figure 29-18 Configuring QoS Settings You can also set the Wi-Fi Multimedia (WMM) policy, call admission control (CAC) policies, and bandwidth parameters on the QoS page.|Figure 29-18 Configuring QoS Settings You can also set the Wi-Fi Multimedia (WMM) policy, call admission control (CAC) policies, and bandwidth parameters on the QoS page.
You can learn more about QoS in the|You can learn more about QoS in the
#### Configuring Advanced WLAN Settings
Configuring Advanced WLAN Settings   
__|__
--|--
|
Finally, you can select the Advanced tab to configure a variety of advanced WLAN settings.|Finally, you can select the Advanced tab to configure a variety of advanced WLAN settings.
|
From the page shown in Figure 29-19, you can enable functions such as coverage hole detection, peer-to-peer blocking, client exclusion, client load limits, and so on.|From the page shown in Figure 29-19, you can enable functions such as coverage hole detection, peer-to-peer blocking, client exclusion, client load limits, and so on.
|
Figure 29-19 Configuring Advanced WLAN Settings Although most of the advanced settings are beyond the scope of the CCNA objectives, you should be aware of a few defaults that might affect your wireless clients.|Figure 29-19 Configuring Advanced WLAN Settings Although most of the advanced settings are beyond the scope of the CCNA objectives, you should be aware of a few defaults that might affect your wireless clients.
|
By default, client sessions with the WLAN are limited to 1800 seconds (30 minutes).|By default, client sessions with the WLAN are limited to 1800 seconds (30 minutes).
Once that session time expires, a client will be required to reauthenticate.|Once that session time expires, a client will be required to reauthenticate.
This setting is controlled by the Enable Session Timeout check box and the Timeout field.|This setting is controlled by the Enable Session Timeout check box and the Timeout field.
|
A controller maintains a set of security policies that are used to detect potentially malicious wireless clients.|A controller maintains a set of security policies that are used to detect potentially malicious wireless clients.
If a client exhibits a certain behavior, the controller can exclude it from the WLAN for a period of time.|If a client exhibits a certain behavior, the controller can exclude it from the WLAN for a period of time.
By default, all clients are subject to the policies configured under Security > Wireless Protection Policies > Client Exclusion Policies.|By default, all clients are subject to the policies configured under Security > Wireless Protection Policies > Client Exclusion Policies.
These policies include excessive 802.11 association failures, 802.11 authentication failures, 802.1x authentication failures, web authentication failures, and IP address theft or reuse.|These policies include excessive 802.11 association failures, 802.11 authentication failures, 802.1x authentication failures, web authentication failures, and IP address theft or reuse.
Offending clients will be automatically excluded or blocked for 60 seconds, as a deterrent to attacks on the wireless network.|Offending clients will be automatically excluded or blocked for 60 seconds, as a deterrent to attacks on the wireless network.
|
NOTE Is 60 seconds really enough time to deter an attack coming from a wireless client?|NOTE Is 60 seconds really enough time to deter an attack coming from a wireless client?
|
In the case of a brute-force attack, where passwords are guessed from a dictionary of possibilities, 60 seconds is enough to disrupt and delay an attacker’s progress.|In the case of a brute-force attack, where passwords are guessed from a dictionary of possibilities, 60 seconds is enough to disrupt and delay an attacker’s progress.
What might have taken 2 minutes to find a matching password without an exclusion policy would take 15 years with one.|What might have taken 2 minutes to find a matching password without an exclusion policy would take 15 years with one.
#### Finalizing WLAN Configuration
Finalizing WLAN Configuration   
__|__
--|--
|
When you are satisfied with the settings in each of the WLAN configuration tabs, click the Apply button in the upper-right corner of the WLAN Edit screen.|When you are satisfied with the settings in each of the WLAN configuration tabs, click the Apply button in the upper-right corner of the WLAN Edit screen.
The WLAN will be created and added to the controller configuration.|The WLAN will be created and added to the controller configuration.
In Figure 29-20, the Engineering WLAN has been added as WLAN ID 1 and is enabled for use.|In Figure 29-20, the Engineering WLAN has been added as WLAN ID 1 and is enabled for use.
|
Figure 29-20 Displaying WLANs Configured on a Controller Be aware that, by default, a controller will not allow management traffic that is initiated from a WLAN. That means you (or anybody else) cannot access the controller GUI or CLI from a wireless device that is associated to the WLAN. This is considered to be a good security practice because the controller is kept isolated from networks that might be easily accessible or where someone might eavesdrop on the management session traffic.|Figure 29-20 Displaying WLANs Configured on a Controller Be aware that, by default, a controller will not allow management traffic that is initiated from a WLAN. That means you (or anybody else) cannot access the controller GUI or CLI from a wireless device that is associated to the WLAN. This is considered to be a good security practice because the controller is kept isolated from networks that might be easily accessible or where someone might eavesdrop on the management session traffic.
Instead, you can access the controller through its wired interfaces.|Instead, you can access the controller through its wired interfaces.
|
You can change the default behavior on a global basis (all WLANs) by selecting the Management tab and then selecting Mgmt Via Wireless, as shown in Figure 29-21.|You can change the default behavior on a global basis (all WLANs) by selecting the Management tab and then selecting Mgmt Via Wireless, as shown in Figure 29-21.
Check the box to allow management sessions from any WLAN that is configured on the controller.|Check the box to allow management sessions from any WLAN that is configured on the controller.
|
Figure 29-21 Configuring Management Access from Wireless Networks|Figure 29-21 Configuring Management Access from Wireless Networks
### Chapter Review
Chapter Review   
__|__
--|--
|
Review this chapter’s material using either the tools in the book or the interactive tools for the same material found on the book’s companion website.|Review this chapter’s material using either the tools in the book or the interactive tools for the same material found on the book’s companion website.
Table 29-3 outlines the key review elements and where you can find them.|Table 29-3 outlines the key review elements and where you can find them.
To better track your study progress, record when you completed these activities in the second column.|To better track your study progress, record when you completed these activities in the second column.
|
Table 29-3 Chapter Review Tracking Table end.|Table 29-3 Chapter Review Tracking Table end.
|
Review All the Key Topics Review the most important topics in this chapter, noted with the Key Topic icon in the outer margin of the page.|Review All the Key Topics Review the most important topics in this chapter, noted with the Key Topic icon in the outer margin of the page.
Table 29-4 lists a reference of these key topics and the page numbers on which each is found.|Table 29-4 lists a reference of these key topics and the page numbers on which each is found.
## Part VIII Review
Part VIII Review   
__|__
--|--
|
Keep track of your part review progress with the checklist in Table P8-1.|Keep track of your part review progress with the checklist in Table P8-1.
Details on each task follow the table.|Details on each task follow the table.
|
Table P8-1 Part VIII Part Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Repeat All DIKTA Questions For this task, use the PCPT software to answer the “Do I Know This Already?” questions again for the chapters in this part of the book.|Table P8-1 Part VIII Part Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Repeat All DIKTA Questions For this task, use the PCPT software to answer the “Do I Know This Already?” questions again for the chapters in this part of the book.
|
Answer Part Review Questions For this task, use PTP to answer the Part Review questions for this part of the book.|Answer Part Review Questions For this task, use PTP to answer the Part Review questions for this part of the book.
|
Review Key Topics Review all key topics in all chapters in this part, either by browsing the chapters or using the Key Topics application on the companion website.|Review Key Topics Review all key topics in all chapters in this part, either by browsing the chapters or using the Key Topics application on the companion website.
## Part IX Appendixes
Part IX Appendixes   
__|__
--|--
|
Glossary Appendix A Numeric Reference Tables Appendix B Exam Updates Appendix C Answers to the “Do I Know This Already?” Quizzes APPENDIX A Numeric Reference Tables This appendix provides several useful reference tables that list numbers used throughout this book.|Glossary Appendix A Numeric Reference Tables Appendix B Exam Updates Appendix C Answers to the “Do I Know This Already?” Quizzes APPENDIX A Numeric Reference Tables This appendix provides several useful reference tables that list numbers used throughout this book.
Specifically:|Specifically:
|
Table A-1: A decimal-binary cross reference, useful when converting from decimal to binary and vice versa.|Table A-1: A decimal-binary cross reference, useful when converting from decimal to binary and vice versa.
|
|